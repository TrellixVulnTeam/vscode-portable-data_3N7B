var uR=Object.defineProperty;var c=(h,A)=>uR(h,"name",{value:A,configurable:!0});(()=>{var __webpack_modules__={879:(h,A)=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.ByteStream=void 0;class O{constructor(M){this.bytes=M,this.byteIndexCurrent=0}hasMoreBytes(){return this.byteIndexCurrent<this.bytes.length}readBytes(M){const B=this.byteIndexCurrent;return this.byteIndexCurrent+=M,this.bytes.slice(B,this.byteIndexCurrent)}readByte(){let M=this.bytes[this.byteIndexCurrent];return this.byteIndexCurrent++,M}readString(M){let B=[];const q=this.byteIndexCurrent+M;let V=this.byteIndexCurrent;for(;V<q;){const N=this.bytes[V++];if(N===0)break;let v=0,R=0;for((N&128)==0?(v=N,R=0):(N&224)==192?(v=N&31,R=1):(N&240)==224?(v=N&15,R=2):(N&248)==240&&(v=N&15,R=3);R>0;)v=v<<6|this.bytes[V++]&63,R--;B.push(String.fromCodePoint(v))}return this.byteIndexCurrent=q,B.join("")}}c(O,"ByteStream"),A.ByteStream=O},7106:(h,A)=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.ChunkSize=A.HeaderSizeInBytes=A.FileNameMaxLength=void 0,A.FileNameMaxLength=99,A.HeaderSizeInBytes=500,A.ChunkSize=512},5759:(h,A,O)=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.TarFile=void 0;const I=O(879),M=O(7106),B=O(4108),q=O(3335);class V{constructor(v){this.entries=v}static fromBytes(v){const R=new I.ByteStream(v),T=[],_=M.ChunkSize;let F=0;for(;R.hasMoreBytes()==!0;){const P=R.readBytes(_);let Z=!0;for(let ie=0;ie<P.length;ie++)if(P[ie]!=0){Z=!1;break}if(Z==!0){if(F++,F==2)break}else{F=0;const ie=B.TarFileEntry.fromBytes(P,R);T.push(ie)}}let j=new V(T);return j.consolidateLongPathEntries(),j}consolidateLongPathEntries(){var v;const R=q.TarFileTypeFlag.Instances().LongFilePath.name,T=this.entries;for(let _=0;_<T.length;_++){const F=T[_];if(((v=F.header.typeFlag)===null||v===void 0?void 0:v.name)==R){const j=T[_+1];j.header.fileName=F.dataAsBytes.reduce((P,Z)=>P+=String.fromCharCode(Z),""),j.header.fileName=j.header.fileName.replace(/\0/g,""),T.splice(_,1),_--}}}}c(V,"TarFile"),A.TarFile=V},4108:(h,A,O)=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.TarFileEntry=void 0;const I=O(7106),M=O(2895);class B{constructor(V,N){this.header=V,this.dataAsBytes=N}static fromBytes(V,N){const v=I.ChunkSize,R=M.TarFileEntryHeader.fromBytes(V),T=R.fileSizeInBytes,F=Math.ceil(T/v)*v,j=N.readBytes(F).slice(0,T);return new B(R,j)}}c(B,"TarFileEntry"),A.TarFileEntry=B},2895:(h,A,O)=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.TarFileEntryHeader=void 0;const I=O(879),M=O(3335);class B{constructor(V,N,v,R,T,_,F,j,P,Z,ie,Ce,K,Q,Y,C){this.fileName=V,this.fileMode=N,this.userIDOfOwner=v,this.userIDOfGroup=R,this.fileSizeInBytes=T,this.timeModifiedInUnixFormat=_,this.checksum=F,this.typeFlag=j,this.nameOfLinkedFile=P,this.uStarIndicator=Z,this.uStarVersion=ie,this.userNameOfOwner=Ce,this.groupNameOfOwner=K,this.deviceNumberMajor=Q,this.deviceNumberMinor=Y,this.filenamePrefix=C,this.fullFileName=C.length?C.endsWith("/")?C+V:C+"/"+V:V}static fromBytes(V){const N=new I.ByteStream(V),v=N.readString(100).trim(),R=N.readString(8),T=N.readString(8),_=N.readString(8),F=N.readString(12),j=N.readBytes(12),P=N.readString(8),Z=N.readString(1),ie=N.readString(100),Ce=N.readString(6),K=N.readString(2),Q=N.readString(32),Y=N.readString(32),C=N.readString(8),G=N.readString(8),H=N.readString(155),ue=N.readBytes(12),le=parseInt(F.trim(),8),ce=parseInt(P,8),ve=M.TarFileTypeFlag.Instances()._All,De="_"+Z,Ue=ve[De];return new B(v,R,T,_,le,j,ce,Ue,ie,Ce,K,Q,Y,C,G,H)}}c(B,"TarFileEntryHeader"),A.TarFileEntryHeader=B},3335:(h,A)=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.TarFileTypeFlag=void 0;class O{constructor(B,q){this.value=B,this.id="_"+this.value,this.name=q}static Instances(){return O._instances==null&&(O._instances=new I),O._instances}}c(O,"TarFileTypeFlag"),A.TarFileTypeFlag=O;class I{constructor(){this.Normal=new O("0","Normal"),this.HardLink=new O("1","Hard Link"),this.SymbolicLink=new O("2","Symbolic Link"),this.CharacterSpecial=new O("3","Character Special"),this.BlockSpecial=new O("4","Block Special"),this.Directory=new O("5","Directory"),this.FIFO=new O("6","FIFO"),this.ContiguousFile=new O("7","Contiguous File"),this.LongFilePath=new O("L","././@LongLink"),this._All=[this.Normal,this.HardLink,this.SymbolicLink,this.CharacterSpecial,this.BlockSpecial,this.Directory,this.FIFO,this.ContiguousFile,this.LongFilePath];for(let B=0;B<this._All.length;B++){const q=this._All[B];this._All[q.id]=q}}}c(I,"TarFileTypeFlag_Instances")},5790:(h,A,O)=>{"use strict";var I;I={value:!0},A.t9=I=I=I=void 0;const M=O(5759);I={enumerable:!0,get:function(){return M.TarFile}};const B=O(4108);I={enumerable:!0,get:function(){return B.TarFileEntry}};const q=O(2895);I={enumerable:!0,get:function(){return q.TarFileEntryHeader}},A.t9=V=>M.TarFile.fromBytes(V)},3672:(h,A)=>{"use strict";var O=c(function(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof I!="undefined")return I;throw new Error("unable to locate global object")},"getGlobal"),I=O();h.exports=A=I.fetch,I.fetch&&(A.default=I.fetch.bind(I)),A.Headers=I.Headers,A.Request=I.Request,A.Response=I.Response},9742:(h,A)=>{"use strict";A.byteLength=v,A.toByteArray=T,A.fromByteArray=j;for(var O=[],I=[],M=typeof Uint8Array!="undefined"?Uint8Array:Array,B="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",q=0,V=B.length;q<V;++q)O[q]=B[q],I[B.charCodeAt(q)]=q;I["-".charCodeAt(0)]=62,I["_".charCodeAt(0)]=63;function N(P){var Z=P.length;if(Z%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var ie=P.indexOf("=");ie===-1&&(ie=Z);var Ce=ie===Z?0:4-ie%4;return[ie,Ce]}c(N,"getLens");function v(P){var Z=N(P),ie=Z[0],Ce=Z[1];return(ie+Ce)*3/4-Ce}c(v,"byteLength");function R(P,Z,ie){return(Z+ie)*3/4-ie}c(R,"_byteLength");function T(P){var Z,ie=N(P),Ce=ie[0],K=ie[1],Q=new M(R(P,Ce,K)),Y=0,C=K>0?Ce-4:Ce,G;for(G=0;G<C;G+=4)Z=I[P.charCodeAt(G)]<<18|I[P.charCodeAt(G+1)]<<12|I[P.charCodeAt(G+2)]<<6|I[P.charCodeAt(G+3)],Q[Y++]=Z>>16&255,Q[Y++]=Z>>8&255,Q[Y++]=Z&255;return K===2&&(Z=I[P.charCodeAt(G)]<<2|I[P.charCodeAt(G+1)]>>4,Q[Y++]=Z&255),K===1&&(Z=I[P.charCodeAt(G)]<<10|I[P.charCodeAt(G+1)]<<4|I[P.charCodeAt(G+2)]>>2,Q[Y++]=Z>>8&255,Q[Y++]=Z&255),Q}c(T,"toByteArray");function _(P){return O[P>>18&63]+O[P>>12&63]+O[P>>6&63]+O[P&63]}c(_,"tripletToBase64");function F(P,Z,ie){for(var Ce,K=[],Q=Z;Q<ie;Q+=3)Ce=(P[Q]<<16&16711680)+(P[Q+1]<<8&65280)+(P[Q+2]&255),K.push(_(Ce));return K.join("")}c(F,"encodeChunk");function j(P){for(var Z,ie=P.length,Ce=ie%3,K=[],Q=16383,Y=0,C=ie-Ce;Y<C;Y+=Q)K.push(F(P,Y,Y+Q>C?C:Y+Q));return Ce===1?(Z=P[ie-1],K.push(O[Z>>2]+O[Z<<4&63]+"==")):Ce===2&&(Z=(P[ie-2]<<8)+P[ie-1],K.push(O[Z>>10]+O[Z>>4&63]+O[Z<<2&63]+"=")),K.join("")}c(j,"fromByteArray")},5186:(h,A,O)=>{var I=O(3698),M=O(2505),B=O(6417),q=Function.bind,V=q.bind(q);function N(F,j,P){var Z=V(B,null).apply(null,P?[j,P]:[j]);F.api={remove:Z},F.remove=Z,["before","error","after","wrap"].forEach(function(ie){var Ce=P?[j,ie,P]:[j,ie];F[ie]=F.api[ie]=V(M,null).apply(null,Ce)})}c(N,"bindApi");function v(){var F="h",j={registry:{}},P=I.bind(null,j,F);return N(P,j,F),P}c(v,"HookSingular");function R(){var F={registry:{}},j=I.bind(null,F);return N(j,F),j}c(R,"HookCollection");var T=!1;function _(){return T||(console.warn('[before-after-hook]: "Hook()" repurposing warning, use "Hook.Collection()". Read more: https://git.io/upgrade-before-after-hook-to-1.4'),T=!0),R()}c(_,"Hook"),_.Singular=v.bind(),_.Collection=R.bind(),h.exports=_,h.exports.Hook=_,h.exports.Singular=_.Singular,h.exports.Collection=_.Collection},2505:h=>{h.exports=A;function A(O,I,M,B){var q=B;O.registry[M]||(O.registry[M]=[]),I==="before"&&(B=c(function(V,N){return Promise.resolve().then(q.bind(null,N)).then(V.bind(null,N))},"hook")),I==="after"&&(B=c(function(V,N){var v;return Promise.resolve().then(V.bind(null,N)).then(function(R){return v=R,q(v,N)}).then(function(){return v})},"hook")),I==="error"&&(B=c(function(V,N){return Promise.resolve().then(V.bind(null,N)).catch(function(v){return q(v,N)})},"hook")),O.registry[M].push({hook:B,orig:q})}c(A,"addHook")},3698:h=>{h.exports=A;function A(O,I,M,B){if(typeof M!="function")throw new Error("method for before hook must be a function");return B||(B={}),Array.isArray(I)?I.reverse().reduce(function(q,V){return A.bind(null,O,V,q,B)},M)():Promise.resolve().then(function(){return O.registry[I]?O.registry[I].reduce(function(q,V){return V.hook.bind(null,q,B)},M)():M(B)})}c(A,"register")},6417:h=>{h.exports=A;function A(O,I,M){if(!!O.registry[I]){var B=O.registry[I].map(function(q){return q.orig}).indexOf(M);B!==-1&&O.registry[I].splice(B,1)}}c(A,"removeHook")},6744:(h,A,O)=>{"use strict";const I=O(3349),M=O(7529),B=O(8050),q=O(4339),V=c((N,v={})=>{let R=[];if(Array.isArray(N))for(let T of N){let _=V.create(T,v);Array.isArray(_)?R.push(..._):R.push(_)}else R=[].concat(V.create(N,v));return v&&v.expand===!0&&v.nodupes===!0&&(R=[...new Set(R)]),R},"braces");V.parse=(N,v={})=>q(N,v),V.stringify=(N,v={})=>I(typeof N=="string"?V.parse(N,v):N,v),V.compile=(N,v={})=>(typeof N=="string"&&(N=V.parse(N,v)),M(N,v)),V.expand=(N,v={})=>{typeof N=="string"&&(N=V.parse(N,v));let R=B(N,v);return v.noempty===!0&&(R=R.filter(Boolean)),v.nodupes===!0&&(R=[...new Set(R)]),R},V.create=(N,v={})=>N===""||N.length<3?[N]:v.expand!==!0?V.compile(N,v):V.expand(N,v),h.exports=V},7529:(h,A,O)=>{"use strict";const I=O(2664),M=O(3083),B=c((q,V={})=>{let N=c((v,R={})=>{let T=M.isInvalidBrace(R),_=v.invalid===!0&&V.escapeInvalid===!0,F=T===!0||_===!0,j=V.escapeInvalid===!0?"\\":"",P="";if(v.isOpen===!0||v.isClose===!0)return j+v.value;if(v.type==="open")return F?j+v.value:"(";if(v.type==="close")return F?j+v.value:")";if(v.type==="comma")return v.prev.type==="comma"?"":F?v.value:"|";if(v.value)return v.value;if(v.nodes&&v.ranges>0){let Z=M.reduce(v.nodes),ie=I(...Z,{...V,wrap:!1,toRegex:!0});if(ie.length!==0)return Z.length>1&&ie.length>1?`(${ie})`:ie}if(v.nodes)for(let Z of v.nodes)P+=N(Z,v);return P},"walk");return N(q)},"compile");h.exports=B},6611:h=>{"use strict";h.exports={MAX_LENGTH:1024*64,CHAR_0:"0",CHAR_9:"9",CHAR_UPPERCASE_A:"A",CHAR_LOWERCASE_A:"a",CHAR_UPPERCASE_Z:"Z",CHAR_LOWERCASE_Z:"z",CHAR_LEFT_PARENTHESES:"(",CHAR_RIGHT_PARENTHESES:")",CHAR_ASTERISK:"*",CHAR_AMPERSAND:"&",CHAR_AT:"@",CHAR_BACKSLASH:"\\",CHAR_BACKTICK:"`",CHAR_CARRIAGE_RETURN:"\r",CHAR_CIRCUMFLEX_ACCENT:"^",CHAR_COLON:":",CHAR_COMMA:",",CHAR_DOLLAR:"$",CHAR_DOT:".",CHAR_DOUBLE_QUOTE:'"',CHAR_EQUAL:"=",CHAR_EXCLAMATION_MARK:"!",CHAR_FORM_FEED:"\f",CHAR_FORWARD_SLASH:"/",CHAR_HASH:"#",CHAR_HYPHEN_MINUS:"-",CHAR_LEFT_ANGLE_BRACKET:"<",CHAR_LEFT_CURLY_BRACE:"{",CHAR_LEFT_SQUARE_BRACKET:"[",CHAR_LINE_FEED:`
`,CHAR_NO_BREAK_SPACE:"\xA0",CHAR_PERCENT:"%",CHAR_PLUS:"+",CHAR_QUESTION_MARK:"?",CHAR_RIGHT_ANGLE_BRACKET:">",CHAR_RIGHT_CURLY_BRACE:"}",CHAR_RIGHT_SQUARE_BRACKET:"]",CHAR_SEMICOLON:";",CHAR_SINGLE_QUOTE:"'",CHAR_SPACE:" ",CHAR_TAB:"	",CHAR_UNDERSCORE:"_",CHAR_VERTICAL_LINE:"|",CHAR_ZERO_WIDTH_NOBREAK_SPACE:"\uFEFF"}},8050:(h,A,O)=>{"use strict";const I=O(2664),M=O(3349),B=O(3083),q=c((N="",v="",R=!1)=>{let T=[];if(N=[].concat(N),v=[].concat(v),!v.length)return N;if(!N.length)return R?B.flatten(v).map(_=>`{${_}}`):v;for(let _ of N)if(Array.isArray(_))for(let F of _)T.push(q(F,v,R));else for(let F of v)R===!0&&typeof F=="string"&&(F=`{${F}}`),T.push(Array.isArray(F)?q(_,F,R):_+F);return B.flatten(T)},"append"),V=c((N,v={})=>{let R=v.rangeLimit===void 0?1e3:v.rangeLimit,T=c((_,F={})=>{_.queue=[];let j=F,P=F.queue;for(;j.type!=="brace"&&j.type!=="root"&&j.parent;)j=j.parent,P=j.queue;if(_.invalid||_.dollar){P.push(q(P.pop(),M(_,v)));return}if(_.type==="brace"&&_.invalid!==!0&&_.nodes.length===2){P.push(q(P.pop(),["{}"]));return}if(_.nodes&&_.ranges>0){let K=B.reduce(_.nodes);if(B.exceedsLimit(...K,v.step,R))throw new RangeError("expanded array length exceeds range limit. Use options.rangeLimit to increase or disable the limit.");let Q=I(...K,v);Q.length===0&&(Q=M(_,v)),P.push(q(P.pop(),Q)),_.nodes=[];return}let Z=B.encloseBrace(_),ie=_.queue,Ce=_;for(;Ce.type!=="brace"&&Ce.type!=="root"&&Ce.parent;)Ce=Ce.parent,ie=Ce.queue;for(let K=0;K<_.nodes.length;K++){let Q=_.nodes[K];if(Q.type==="comma"&&_.type==="brace"){K===1&&ie.push(""),ie.push("");continue}if(Q.type==="close"){P.push(q(P.pop(),ie,Z));continue}if(Q.value&&Q.type!=="open"){ie.push(q(ie.pop(),Q.value));continue}Q.nodes&&T(Q,_)}return ie},"walk");return B.flatten(T(N))},"expand");h.exports=V},4339:(h,A,O)=>{"use strict";const I=O(3349),{MAX_LENGTH:M,CHAR_BACKSLASH:B,CHAR_BACKTICK:q,CHAR_COMMA:V,CHAR_DOT:N,CHAR_LEFT_PARENTHESES:v,CHAR_RIGHT_PARENTHESES:R,CHAR_LEFT_CURLY_BRACE:T,CHAR_RIGHT_CURLY_BRACE:_,CHAR_LEFT_SQUARE_BRACKET:F,CHAR_RIGHT_SQUARE_BRACKET:j,CHAR_DOUBLE_QUOTE:P,CHAR_SINGLE_QUOTE:Z,CHAR_NO_BREAK_SPACE:ie,CHAR_ZERO_WIDTH_NOBREAK_SPACE:Ce}=O(6611),K=c((Q,Y={})=>{if(typeof Q!="string")throw new TypeError("Expected a string");let C=Y||{},G=typeof C.maxLength=="number"?Math.min(M,C.maxLength):M;if(Q.length>G)throw new SyntaxError(`Input length (${Q.length}), exceeds max characters (${G})`);let H={type:"root",input:Q,nodes:[]},ue=[H],le=H,ce=H,ve=0,De=Q.length,Ue=0,qe=0,_e,rt={};const lt=c(()=>Q[Ue++],"advance"),Ke=c(Se=>{if(Se.type==="text"&&ce.type==="dot"&&(ce.type="text"),ce&&ce.type==="text"&&Se.type==="text"){ce.value+=Se.value;return}return le.nodes.push(Se),Se.parent=le,Se.prev=ce,ce=Se,Se},"push");for(Ke({type:"bos"});Ue<De;)if(le=ue[ue.length-1],_e=lt(),!(_e===Ce||_e===ie)){if(_e===B){Ke({type:"text",value:(Y.keepEscaping?_e:"")+lt()});continue}if(_e===j){Ke({type:"text",value:"\\"+_e});continue}if(_e===F){ve++;let Se=!0,he;for(;Ue<De&&(he=lt());){if(_e+=he,he===F){ve++;continue}if(he===B){_e+=lt();continue}if(he===j&&(ve--,ve===0))break}Ke({type:"text",value:_e});continue}if(_e===v){le=Ke({type:"paren",nodes:[]}),ue.push(le),Ke({type:"text",value:_e});continue}if(_e===R){if(le.type!=="paren"){Ke({type:"text",value:_e});continue}le=ue.pop(),Ke({type:"text",value:_e}),le=ue[ue.length-1];continue}if(_e===P||_e===Z||_e===q){let Se=_e,he;for(Y.keepQuotes!==!0&&(_e="");Ue<De&&(he=lt());){if(he===B){_e+=he+lt();continue}if(he===Se){Y.keepQuotes===!0&&(_e+=he);break}_e+=he}Ke({type:"text",value:_e});continue}if(_e===T){qe++;let Se=ce.value&&ce.value.slice(-1)==="$"||le.dollar===!0;le=Ke({type:"brace",open:!0,close:!1,dollar:Se,depth:qe,commas:0,ranges:0,nodes:[]}),ue.push(le),Ke({type:"open",value:_e});continue}if(_e===_){if(le.type!=="brace"){Ke({type:"text",value:_e});continue}let Se="close";le=ue.pop(),le.close=!0,Ke({type:Se,value:_e}),qe--,le=ue[ue.length-1];continue}if(_e===V&&qe>0){if(le.ranges>0){le.ranges=0;let Se=le.nodes.shift();le.nodes=[Se,{type:"text",value:I(le)}]}Ke({type:"comma",value:_e}),le.commas++;continue}if(_e===N&&qe>0&&le.commas===0){let Se=le.nodes;if(qe===0||Se.length===0){Ke({type:"text",value:_e});continue}if(ce.type==="dot"){if(le.range=[],ce.value+=_e,ce.type="range",le.nodes.length!==3&&le.nodes.length!==5){le.invalid=!0,le.ranges=0,ce.type="text";continue}le.ranges++,le.args=[];continue}if(ce.type==="range"){Se.pop();let he=Se[Se.length-1];he.value+=ce.value+_e,ce=he,le.ranges--;continue}Ke({type:"dot",value:_e});continue}Ke({type:"text",value:_e})}do if(le=ue.pop(),le.type!=="root"){le.nodes.forEach(nt=>{nt.nodes||(nt.type==="open"&&(nt.isOpen=!0),nt.type==="close"&&(nt.isClose=!0),nt.nodes||(nt.type="text"),nt.invalid=!0)});let Se=ue[ue.length-1],he=Se.nodes.indexOf(le);Se.nodes.splice(he,1,...le.nodes)}while(ue.length>0);return Ke({type:"eos"}),H},"parse");h.exports=K},3349:(h,A,O)=>{"use strict";const I=O(3083);h.exports=(M,B={})=>{let q=c((V,N={})=>{let v=B.escapeInvalid&&I.isInvalidBrace(N),R=V.invalid===!0&&B.escapeInvalid===!0,T="";if(V.value)return(v||R)&&I.isOpenOrClose(V)?"\\"+V.value:V.value;if(V.value)return V.value;if(V.nodes)for(let _ of V.nodes)T+=q(_);return T},"stringify");return q(M)}},3083:(h,A)=>{"use strict";A.isInteger=O=>typeof O=="number"?Number.isInteger(O):typeof O=="string"&&O.trim()!==""?Number.isInteger(Number(O)):!1,A.find=(O,I)=>O.nodes.find(M=>M.type===I),A.exceedsLimit=(O,I,M=1,B)=>B===!1||!A.isInteger(O)||!A.isInteger(I)?!1:(Number(I)-Number(O))/Number(M)>=B,A.escapeNode=(O,I=0,M)=>{let B=O.nodes[I];!B||(M&&B.type===M||B.type==="open"||B.type==="close")&&B.escaped!==!0&&(B.value="\\"+B.value,B.escaped=!0)},A.encloseBrace=O=>O.type!=="brace"?!1:O.commas>>0+O.ranges>>0==0?(O.invalid=!0,!0):!1,A.isInvalidBrace=O=>O.type!=="brace"?!1:O.invalid===!0||O.dollar?!0:O.commas>>0+O.ranges>>0==0||O.open!==!0||O.close!==!0?(O.invalid=!0,!0):!1,A.isOpenOrClose=O=>O.type==="open"||O.type==="close"?!0:O.open===!0||O.close===!0,A.reduce=O=>O.reduce((I,M)=>(M.type==="text"&&I.push(M.value),M.type==="range"&&(M.type="text"),I),[]),A.flatten=(...O)=>{const I=[],M=c(B=>{for(let q=0;q<B.length;q++){let V=B[q];Array.isArray(V)?M(V,I):V!==void 0&&I.push(V)}return I},"flat");return M(O),I}},8764:(h,A,O)=>{"use strict";/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */const I=O(9742),M=O(645),B=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;A.Buffer=v,A.SlowBuffer=Q,A.INSPECT_MAX_BYTES=50;const q=2147483647;A.kMaxLength=q,v.TYPED_ARRAY_SUPPORT=V(),!v.TYPED_ARRAY_SUPPORT&&typeof console!="undefined"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function V(){try{const k=new Uint8Array(1),m={foo:function(){return 42}};return Object.setPrototypeOf(m,Uint8Array.prototype),Object.setPrototypeOf(k,m),k.foo()===42}catch(k){return!1}}c(V,"typedArraySupport"),Object.defineProperty(v.prototype,"parent",{enumerable:!0,get:function(){if(!!v.isBuffer(this))return this.buffer}}),Object.defineProperty(v.prototype,"offset",{enumerable:!0,get:function(){if(!!v.isBuffer(this))return this.byteOffset}});function N(k){if(k>q)throw new RangeError('The value "'+k+'" is invalid for option "size"');const m=new Uint8Array(k);return Object.setPrototypeOf(m,v.prototype),m}c(N,"createBuffer");function v(k,m,w){if(typeof k=="number"){if(typeof m=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return F(k)}return R(k,m,w)}c(v,"Buffer"),v.poolSize=8192;function R(k,m,w){if(typeof k=="string")return j(k,m);if(ArrayBuffer.isView(k))return Z(k);if(k==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof k);if(Ae(k,ArrayBuffer)||k&&Ae(k.buffer,ArrayBuffer)||typeof SharedArrayBuffer!="undefined"&&(Ae(k,SharedArrayBuffer)||k&&Ae(k.buffer,SharedArrayBuffer)))return ie(k,m,w);if(typeof k=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const U=k.valueOf&&k.valueOf();if(U!=null&&U!==k)return v.from(U,m,w);const X=Ce(k);if(X)return X;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof k[Symbol.toPrimitive]=="function")return v.from(k[Symbol.toPrimitive]("string"),m,w);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof k)}c(R,"from"),v.from=function(k,m,w){return R(k,m,w)},Object.setPrototypeOf(v.prototype,Uint8Array.prototype),Object.setPrototypeOf(v,Uint8Array);function T(k){if(typeof k!="number")throw new TypeError('"size" argument must be of type number');if(k<0)throw new RangeError('The value "'+k+'" is invalid for option "size"')}c(T,"assertSize");function _(k,m,w){return T(k),k<=0?N(k):m!==void 0?typeof w=="string"?N(k).fill(m,w):N(k).fill(m):N(k)}c(_,"alloc"),v.alloc=function(k,m,w){return _(k,m,w)};function F(k){return T(k),N(k<0?0:K(k)|0)}c(F,"allocUnsafe"),v.allocUnsafe=function(k){return F(k)},v.allocUnsafeSlow=function(k){return F(k)};function j(k,m){if((typeof m!="string"||m==="")&&(m="utf8"),!v.isEncoding(m))throw new TypeError("Unknown encoding: "+m);const w=Y(k,m)|0;let U=N(w);const X=U.write(k,m);return X!==w&&(U=U.slice(0,X)),U}c(j,"fromString");function P(k){const m=k.length<0?0:K(k.length)|0,w=N(m);for(let U=0;U<m;U+=1)w[U]=k[U]&255;return w}c(P,"fromArrayLike");function Z(k){if(Ae(k,Uint8Array)){const m=new Uint8Array(k);return ie(m.buffer,m.byteOffset,m.byteLength)}return P(k)}c(Z,"fromArrayView");function ie(k,m,w){if(m<0||k.byteLength<m)throw new RangeError('"offset" is outside of buffer bounds');if(k.byteLength<m+(w||0))throw new RangeError('"length" is outside of buffer bounds');let U;return m===void 0&&w===void 0?U=new Uint8Array(k):w===void 0?U=new Uint8Array(k,m):U=new Uint8Array(k,m,w),Object.setPrototypeOf(U,v.prototype),U}c(ie,"fromArrayBuffer");function Ce(k){if(v.isBuffer(k)){const m=K(k.length)|0,w=N(m);return w.length===0||k.copy(w,0,0,m),w}if(k.length!==void 0)return typeof k.length!="number"||Oe(k.length)?N(0):P(k);if(k.type==="Buffer"&&Array.isArray(k.data))return P(k.data)}c(Ce,"fromObject");function K(k){if(k>=q)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+q.toString(16)+" bytes");return k|0}c(K,"checked");function Q(k){return+k!=k&&(k=0),v.alloc(+k)}c(Q,"SlowBuffer"),v.isBuffer=c(function(m){return m!=null&&m._isBuffer===!0&&m!==v.prototype},"isBuffer"),v.compare=c(function(m,w){if(Ae(m,Uint8Array)&&(m=v.from(m,m.offset,m.byteLength)),Ae(w,Uint8Array)&&(w=v.from(w,w.offset,w.byteLength)),!v.isBuffer(m)||!v.isBuffer(w))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(m===w)return 0;let U=m.length,X=w.length;for(let se=0,ye=Math.min(U,X);se<ye;++se)if(m[se]!==w[se]){U=m[se],X=w[se];break}return U<X?-1:X<U?1:0},"compare"),v.isEncoding=c(function(m){switch(String(m).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},"isEncoding"),v.concat=c(function(m,w){if(!Array.isArray(m))throw new TypeError('"list" argument must be an Array of Buffers');if(m.length===0)return v.alloc(0);let U;if(w===void 0)for(w=0,U=0;U<m.length;++U)w+=m[U].length;const X=v.allocUnsafe(w);let se=0;for(U=0;U<m.length;++U){let ye=m[U];if(Ae(ye,Uint8Array))se+ye.length>X.length?(v.isBuffer(ye)||(ye=v.from(ye)),ye.copy(X,se)):Uint8Array.prototype.set.call(X,ye,se);else if(v.isBuffer(ye))ye.copy(X,se);else throw new TypeError('"list" argument must be an Array of Buffers');se+=ye.length}return X},"concat");function Y(k,m){if(v.isBuffer(k))return k.length;if(ArrayBuffer.isView(k)||Ae(k,ArrayBuffer))return k.byteLength;if(typeof k!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof k);const w=k.length,U=arguments.length>2&&arguments[2]===!0;if(!U&&w===0)return 0;let X=!1;for(;;)switch(m){case"ascii":case"latin1":case"binary":return w;case"utf8":case"utf-8":return Ve(k).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return w*2;case"hex":return w>>>1;case"base64":return Ie(k).length;default:if(X)return U?-1:Ve(k).length;m=(""+m).toLowerCase(),X=!0}}c(Y,"byteLength"),v.byteLength=Y;function C(k,m,w){let U=!1;if((m===void 0||m<0)&&(m=0),m>this.length||((w===void 0||w>this.length)&&(w=this.length),w<=0)||(w>>>=0,m>>>=0,w<=m))return"";for(k||(k="utf8");;)switch(k){case"hex":return he(this,m,w);case"utf8":case"utf-8":return _e(this,m,w);case"ascii":return Ke(this,m,w);case"latin1":case"binary":return Se(this,m,w);case"base64":return qe(this,m,w);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return nt(this,m,w);default:if(U)throw new TypeError("Unknown encoding: "+k);k=(k+"").toLowerCase(),U=!0}}c(C,"slowToString"),v.prototype._isBuffer=!0;function G(k,m,w){const U=k[m];k[m]=k[w],k[w]=U}c(G,"swap"),v.prototype.swap16=c(function(){const m=this.length;if(m%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let w=0;w<m;w+=2)G(this,w,w+1);return this},"swap16"),v.prototype.swap32=c(function(){const m=this.length;if(m%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let w=0;w<m;w+=4)G(this,w,w+3),G(this,w+1,w+2);return this},"swap32"),v.prototype.swap64=c(function(){const m=this.length;if(m%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let w=0;w<m;w+=8)G(this,w,w+7),G(this,w+1,w+6),G(this,w+2,w+5),G(this,w+3,w+4);return this},"swap64"),v.prototype.toString=c(function(){const m=this.length;return m===0?"":arguments.length===0?_e(this,0,m):C.apply(this,arguments)},"toString"),v.prototype.toLocaleString=v.prototype.toString,v.prototype.equals=c(function(m){if(!v.isBuffer(m))throw new TypeError("Argument must be a Buffer");return this===m?!0:v.compare(this,m)===0},"equals"),v.prototype.inspect=c(function(){let m="";const w=A.INSPECT_MAX_BYTES;return m=this.toString("hex",0,w).replace(/(.{2})/g,"$1 ").trim(),this.length>w&&(m+=" ... "),"<Buffer "+m+">"},"inspect"),B&&(v.prototype[B]=v.prototype.inspect),v.prototype.compare=c(function(m,w,U,X,se){if(Ae(m,Uint8Array)&&(m=v.from(m,m.offset,m.byteLength)),!v.isBuffer(m))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof m);if(w===void 0&&(w=0),U===void 0&&(U=m?m.length:0),X===void 0&&(X=0),se===void 0&&(se=this.length),w<0||U>m.length||X<0||se>this.length)throw new RangeError("out of range index");if(X>=se&&w>=U)return 0;if(X>=se)return-1;if(w>=U)return 1;if(w>>>=0,U>>>=0,X>>>=0,se>>>=0,this===m)return 0;let ye=se-X,ft=U-w;const zt=Math.min(ye,ft),Mt=this.slice(X,se),jt=m.slice(w,U);for(let dt=0;dt<zt;++dt)if(Mt[dt]!==jt[dt]){ye=Mt[dt],ft=jt[dt];break}return ye<ft?-1:ft<ye?1:0},"compare");function H(k,m,w,U,X){if(k.length===0)return-1;if(typeof w=="string"?(U=w,w=0):w>2147483647?w=2147483647:w<-2147483648&&(w=-2147483648),w=+w,Oe(w)&&(w=X?0:k.length-1),w<0&&(w=k.length+w),w>=k.length){if(X)return-1;w=k.length-1}else if(w<0)if(X)w=0;else return-1;if(typeof m=="string"&&(m=v.from(m,U)),v.isBuffer(m))return m.length===0?-1:ue(k,m,w,U,X);if(typeof m=="number")return m=m&255,typeof Uint8Array.prototype.indexOf=="function"?X?Uint8Array.prototype.indexOf.call(k,m,w):Uint8Array.prototype.lastIndexOf.call(k,m,w):ue(k,[m],w,U,X);throw new TypeError("val must be string, number or Buffer")}c(H,"bidirectionalIndexOf");function ue(k,m,w,U,X){let se=1,ye=k.length,ft=m.length;if(U!==void 0&&(U=String(U).toLowerCase(),U==="ucs2"||U==="ucs-2"||U==="utf16le"||U==="utf-16le")){if(k.length<2||m.length<2)return-1;se=2,ye/=2,ft/=2,w/=2}function zt(jt,dt){return se===1?jt[dt]:jt.readUInt16BE(dt*se)}c(zt,"read");let Mt;if(X){let jt=-1;for(Mt=w;Mt<ye;Mt++)if(zt(k,Mt)===zt(m,jt===-1?0:Mt-jt)){if(jt===-1&&(jt=Mt),Mt-jt+1===ft)return jt*se}else jt!==-1&&(Mt-=Mt-jt),jt=-1}else for(w+ft>ye&&(w=ye-ft),Mt=w;Mt>=0;Mt--){let jt=!0;for(let dt=0;dt<ft;dt++)if(zt(k,Mt+dt)!==zt(m,dt)){jt=!1;break}if(jt)return Mt}return-1}c(ue,"arrayIndexOf"),v.prototype.includes=c(function(m,w,U){return this.indexOf(m,w,U)!==-1},"includes"),v.prototype.indexOf=c(function(m,w,U){return H(this,m,w,U,!0)},"indexOf"),v.prototype.lastIndexOf=c(function(m,w,U){return H(this,m,w,U,!1)},"lastIndexOf");function le(k,m,w,U){w=Number(w)||0;const X=k.length-w;U?(U=Number(U),U>X&&(U=X)):U=X;const se=m.length;U>se/2&&(U=se/2);let ye;for(ye=0;ye<U;++ye){const ft=parseInt(m.substr(ye*2,2),16);if(Oe(ft))return ye;k[w+ye]=ft}return ye}c(le,"hexWrite");function ce(k,m,w,U){return at(Ve(m,k.length-w),k,w,U)}c(ce,"utf8Write");function ve(k,m,w,U){return at(ke(m),k,w,U)}c(ve,"asciiWrite");function De(k,m,w,U){return at(Ie(m),k,w,U)}c(De,"base64Write");function Ue(k,m,w,U){return at(Pn(m,k.length-w),k,w,U)}c(Ue,"ucs2Write"),v.prototype.write=c(function(m,w,U,X){if(w===void 0)X="utf8",U=this.length,w=0;else if(U===void 0&&typeof w=="string")X=w,U=this.length,w=0;else if(isFinite(w))w=w>>>0,isFinite(U)?(U=U>>>0,X===void 0&&(X="utf8")):(X=U,U=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const se=this.length-w;if((U===void 0||U>se)&&(U=se),m.length>0&&(U<0||w<0)||w>this.length)throw new RangeError("Attempt to write outside buffer bounds");X||(X="utf8");let ye=!1;for(;;)switch(X){case"hex":return le(this,m,w,U);case"utf8":case"utf-8":return ce(this,m,w,U);case"ascii":case"latin1":case"binary":return ve(this,m,w,U);case"base64":return De(this,m,w,U);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ue(this,m,w,U);default:if(ye)throw new TypeError("Unknown encoding: "+X);X=(""+X).toLowerCase(),ye=!0}},"write"),v.prototype.toJSON=c(function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},"toJSON");function qe(k,m,w){return m===0&&w===k.length?I.fromByteArray(k):I.fromByteArray(k.slice(m,w))}c(qe,"base64Slice");function _e(k,m,w){w=Math.min(k.length,w);const U=[];let X=m;for(;X<w;){const se=k[X];let ye=null,ft=se>239?4:se>223?3:se>191?2:1;if(X+ft<=w){let zt,Mt,jt,dt;switch(ft){case 1:se<128&&(ye=se);break;case 2:zt=k[X+1],(zt&192)==128&&(dt=(se&31)<<6|zt&63,dt>127&&(ye=dt));break;case 3:zt=k[X+1],Mt=k[X+2],(zt&192)==128&&(Mt&192)==128&&(dt=(se&15)<<12|(zt&63)<<6|Mt&63,dt>2047&&(dt<55296||dt>57343)&&(ye=dt));break;case 4:zt=k[X+1],Mt=k[X+2],jt=k[X+3],(zt&192)==128&&(Mt&192)==128&&(jt&192)==128&&(dt=(se&15)<<18|(zt&63)<<12|(Mt&63)<<6|jt&63,dt>65535&&dt<1114112&&(ye=dt))}}ye===null?(ye=65533,ft=1):ye>65535&&(ye-=65536,U.push(ye>>>10&1023|55296),ye=56320|ye&1023),U.push(ye),X+=ft}return lt(U)}c(_e,"utf8Slice");const rt=4096;function lt(k){const m=k.length;if(m<=rt)return String.fromCharCode.apply(String,k);let w="",U=0;for(;U<m;)w+=String.fromCharCode.apply(String,k.slice(U,U+=rt));return w}c(lt,"decodeCodePointsArray");function Ke(k,m,w){let U="";w=Math.min(k.length,w);for(let X=m;X<w;++X)U+=String.fromCharCode(k[X]&127);return U}c(Ke,"asciiSlice");function Se(k,m,w){let U="";w=Math.min(k.length,w);for(let X=m;X<w;++X)U+=String.fromCharCode(k[X]);return U}c(Se,"latin1Slice");function he(k,m,w){const U=k.length;(!m||m<0)&&(m=0),(!w||w<0||w>U)&&(w=U);let X="";for(let se=m;se<w;++se)X+=Nt[k[se]];return X}c(he,"hexSlice");function nt(k,m,w){const U=k.slice(m,w);let X="";for(let se=0;se<U.length-1;se+=2)X+=String.fromCharCode(U[se]+U[se+1]*256);return X}c(nt,"utf16leSlice"),v.prototype.slice=c(function(m,w){const U=this.length;m=~~m,w=w===void 0?U:~~w,m<0?(m+=U,m<0&&(m=0)):m>U&&(m=U),w<0?(w+=U,w<0&&(w=0)):w>U&&(w=U),w<m&&(w=m);const X=this.subarray(m,w);return Object.setPrototypeOf(X,v.prototype),X},"slice");function Je(k,m,w){if(k%1!=0||k<0)throw new RangeError("offset is not uint");if(k+m>w)throw new RangeError("Trying to access beyond buffer length")}c(Je,"checkOffset"),v.prototype.readUintLE=v.prototype.readUIntLE=c(function(m,w,U){m=m>>>0,w=w>>>0,U||Je(m,w,this.length);let X=this[m],se=1,ye=0;for(;++ye<w&&(se*=256);)X+=this[m+ye]*se;return X},"readUIntLE"),v.prototype.readUintBE=v.prototype.readUIntBE=c(function(m,w,U){m=m>>>0,w=w>>>0,U||Je(m,w,this.length);let X=this[m+--w],se=1;for(;w>0&&(se*=256);)X+=this[m+--w]*se;return X},"readUIntBE"),v.prototype.readUint8=v.prototype.readUInt8=c(function(m,w){return m=m>>>0,w||Je(m,1,this.length),this[m]},"readUInt8"),v.prototype.readUint16LE=v.prototype.readUInt16LE=c(function(m,w){return m=m>>>0,w||Je(m,2,this.length),this[m]|this[m+1]<<8},"readUInt16LE"),v.prototype.readUint16BE=v.prototype.readUInt16BE=c(function(m,w){return m=m>>>0,w||Je(m,2,this.length),this[m]<<8|this[m+1]},"readUInt16BE"),v.prototype.readUint32LE=v.prototype.readUInt32LE=c(function(m,w){return m=m>>>0,w||Je(m,4,this.length),(this[m]|this[m+1]<<8|this[m+2]<<16)+this[m+3]*16777216},"readUInt32LE"),v.prototype.readUint32BE=v.prototype.readUInt32BE=c(function(m,w){return m=m>>>0,w||Je(m,4,this.length),this[m]*16777216+(this[m+1]<<16|this[m+2]<<8|this[m+3])},"readUInt32BE"),v.prototype.readBigUInt64LE=bt(c(function(m){m=m>>>0,It(m,"offset");const w=this[m],U=this[m+7];(w===void 0||U===void 0)&&Jt(m,this.length-8);const X=w+this[++m]*2**8+this[++m]*2**16+this[++m]*2**24,se=this[++m]+this[++m]*2**8+this[++m]*2**16+U*2**24;return BigInt(X)+(BigInt(se)<<BigInt(32))},"readBigUInt64LE")),v.prototype.readBigUInt64BE=bt(c(function(m){m=m>>>0,It(m,"offset");const w=this[m],U=this[m+7];(w===void 0||U===void 0)&&Jt(m,this.length-8);const X=w*2**24+this[++m]*2**16+this[++m]*2**8+this[++m],se=this[++m]*2**24+this[++m]*2**16+this[++m]*2**8+U;return(BigInt(X)<<BigInt(32))+BigInt(se)},"readBigUInt64BE")),v.prototype.readIntLE=c(function(m,w,U){m=m>>>0,w=w>>>0,U||Je(m,w,this.length);let X=this[m],se=1,ye=0;for(;++ye<w&&(se*=256);)X+=this[m+ye]*se;return se*=128,X>=se&&(X-=Math.pow(2,8*w)),X},"readIntLE"),v.prototype.readIntBE=c(function(m,w,U){m=m>>>0,w=w>>>0,U||Je(m,w,this.length);let X=w,se=1,ye=this[m+--X];for(;X>0&&(se*=256);)ye+=this[m+--X]*se;return se*=128,ye>=se&&(ye-=Math.pow(2,8*w)),ye},"readIntBE"),v.prototype.readInt8=c(function(m,w){return m=m>>>0,w||Je(m,1,this.length),this[m]&128?(255-this[m]+1)*-1:this[m]},"readInt8"),v.prototype.readInt16LE=c(function(m,w){m=m>>>0,w||Je(m,2,this.length);const U=this[m]|this[m+1]<<8;return U&32768?U|4294901760:U},"readInt16LE"),v.prototype.readInt16BE=c(function(m,w){m=m>>>0,w||Je(m,2,this.length);const U=this[m+1]|this[m]<<8;return U&32768?U|4294901760:U},"readInt16BE"),v.prototype.readInt32LE=c(function(m,w){return m=m>>>0,w||Je(m,4,this.length),this[m]|this[m+1]<<8|this[m+2]<<16|this[m+3]<<24},"readInt32LE"),v.prototype.readInt32BE=c(function(m,w){return m=m>>>0,w||Je(m,4,this.length),this[m]<<24|this[m+1]<<16|this[m+2]<<8|this[m+3]},"readInt32BE"),v.prototype.readBigInt64LE=bt(c(function(m){m=m>>>0,It(m,"offset");const w=this[m],U=this[m+7];(w===void 0||U===void 0)&&Jt(m,this.length-8);const X=this[m+4]+this[m+5]*2**8+this[m+6]*2**16+(U<<24);return(BigInt(X)<<BigInt(32))+BigInt(w+this[++m]*2**8+this[++m]*2**16+this[++m]*2**24)},"readBigInt64LE")),v.prototype.readBigInt64BE=bt(c(function(m){m=m>>>0,It(m,"offset");const w=this[m],U=this[m+7];(w===void 0||U===void 0)&&Jt(m,this.length-8);const X=(w<<24)+this[++m]*2**16+this[++m]*2**8+this[++m];return(BigInt(X)<<BigInt(32))+BigInt(this[++m]*2**24+this[++m]*2**16+this[++m]*2**8+U)},"readBigInt64BE")),v.prototype.readFloatLE=c(function(m,w){return m=m>>>0,w||Je(m,4,this.length),M.read(this,m,!0,23,4)},"readFloatLE"),v.prototype.readFloatBE=c(function(m,w){return m=m>>>0,w||Je(m,4,this.length),M.read(this,m,!1,23,4)},"readFloatBE"),v.prototype.readDoubleLE=c(function(m,w){return m=m>>>0,w||Je(m,8,this.length),M.read(this,m,!0,52,8)},"readDoubleLE"),v.prototype.readDoubleBE=c(function(m,w){return m=m>>>0,w||Je(m,8,this.length),M.read(this,m,!1,52,8)},"readDoubleBE");function te(k,m,w,U,X,se){if(!v.isBuffer(k))throw new TypeError('"buffer" argument must be a Buffer instance');if(m>X||m<se)throw new RangeError('"value" argument is out of bounds');if(w+U>k.length)throw new RangeError("Index out of range")}c(te,"checkInt"),v.prototype.writeUintLE=v.prototype.writeUIntLE=c(function(m,w,U,X){if(m=+m,w=w>>>0,U=U>>>0,!X){const ft=Math.pow(2,8*U)-1;te(this,m,w,U,ft,0)}let se=1,ye=0;for(this[w]=m&255;++ye<U&&(se*=256);)this[w+ye]=m/se&255;return w+U},"writeUIntLE"),v.prototype.writeUintBE=v.prototype.writeUIntBE=c(function(m,w,U,X){if(m=+m,w=w>>>0,U=U>>>0,!X){const ft=Math.pow(2,8*U)-1;te(this,m,w,U,ft,0)}let se=U-1,ye=1;for(this[w+se]=m&255;--se>=0&&(ye*=256);)this[w+se]=m/ye&255;return w+U},"writeUIntBE"),v.prototype.writeUint8=v.prototype.writeUInt8=c(function(m,w,U){return m=+m,w=w>>>0,U||te(this,m,w,1,255,0),this[w]=m&255,w+1},"writeUInt8"),v.prototype.writeUint16LE=v.prototype.writeUInt16LE=c(function(m,w,U){return m=+m,w=w>>>0,U||te(this,m,w,2,65535,0),this[w]=m&255,this[w+1]=m>>>8,w+2},"writeUInt16LE"),v.prototype.writeUint16BE=v.prototype.writeUInt16BE=c(function(m,w,U){return m=+m,w=w>>>0,U||te(this,m,w,2,65535,0),this[w]=m>>>8,this[w+1]=m&255,w+2},"writeUInt16BE"),v.prototype.writeUint32LE=v.prototype.writeUInt32LE=c(function(m,w,U){return m=+m,w=w>>>0,U||te(this,m,w,4,4294967295,0),this[w+3]=m>>>24,this[w+2]=m>>>16,this[w+1]=m>>>8,this[w]=m&255,w+4},"writeUInt32LE"),v.prototype.writeUint32BE=v.prototype.writeUInt32BE=c(function(m,w,U){return m=+m,w=w>>>0,U||te(this,m,w,4,4294967295,0),this[w]=m>>>24,this[w+1]=m>>>16,this[w+2]=m>>>8,this[w+3]=m&255,w+4},"writeUInt32BE");function gt(k,m,w,U,X){yt(m,U,X,k,w,7);let se=Number(m&BigInt(4294967295));k[w++]=se,se=se>>8,k[w++]=se,se=se>>8,k[w++]=se,se=se>>8,k[w++]=se;let ye=Number(m>>BigInt(32)&BigInt(4294967295));return k[w++]=ye,ye=ye>>8,k[w++]=ye,ye=ye>>8,k[w++]=ye,ye=ye>>8,k[w++]=ye,w}c(gt,"wrtBigUInt64LE");function Ge(k,m,w,U,X){yt(m,U,X,k,w,7);let se=Number(m&BigInt(4294967295));k[w+7]=se,se=se>>8,k[w+6]=se,se=se>>8,k[w+5]=se,se=se>>8,k[w+4]=se;let ye=Number(m>>BigInt(32)&BigInt(4294967295));return k[w+3]=ye,ye=ye>>8,k[w+2]=ye,ye=ye>>8,k[w+1]=ye,ye=ye>>8,k[w]=ye,w+8}c(Ge,"wrtBigUInt64BE"),v.prototype.writeBigUInt64LE=bt(c(function(m,w=0){return gt(this,m,w,BigInt(0),BigInt("0xffffffffffffffff"))},"writeBigUInt64LE")),v.prototype.writeBigUInt64BE=bt(c(function(m,w=0){return Ge(this,m,w,BigInt(0),BigInt("0xffffffffffffffff"))},"writeBigUInt64BE")),v.prototype.writeIntLE=c(function(m,w,U,X){if(m=+m,w=w>>>0,!X){const zt=Math.pow(2,8*U-1);te(this,m,w,U,zt-1,-zt)}let se=0,ye=1,ft=0;for(this[w]=m&255;++se<U&&(ye*=256);)m<0&&ft===0&&this[w+se-1]!==0&&(ft=1),this[w+se]=(m/ye>>0)-ft&255;return w+U},"writeIntLE"),v.prototype.writeIntBE=c(function(m,w,U,X){if(m=+m,w=w>>>0,!X){const zt=Math.pow(2,8*U-1);te(this,m,w,U,zt-1,-zt)}let se=U-1,ye=1,ft=0;for(this[w+se]=m&255;--se>=0&&(ye*=256);)m<0&&ft===0&&this[w+se+1]!==0&&(ft=1),this[w+se]=(m/ye>>0)-ft&255;return w+U},"writeIntBE"),v.prototype.writeInt8=c(function(m,w,U){return m=+m,w=w>>>0,U||te(this,m,w,1,127,-128),m<0&&(m=255+m+1),this[w]=m&255,w+1},"writeInt8"),v.prototype.writeInt16LE=c(function(m,w,U){return m=+m,w=w>>>0,U||te(this,m,w,2,32767,-32768),this[w]=m&255,this[w+1]=m>>>8,w+2},"writeInt16LE"),v.prototype.writeInt16BE=c(function(m,w,U){return m=+m,w=w>>>0,U||te(this,m,w,2,32767,-32768),this[w]=m>>>8,this[w+1]=m&255,w+2},"writeInt16BE"),v.prototype.writeInt32LE=c(function(m,w,U){return m=+m,w=w>>>0,U||te(this,m,w,4,2147483647,-2147483648),this[w]=m&255,this[w+1]=m>>>8,this[w+2]=m>>>16,this[w+3]=m>>>24,w+4},"writeInt32LE"),v.prototype.writeInt32BE=c(function(m,w,U){return m=+m,w=w>>>0,U||te(this,m,w,4,2147483647,-2147483648),m<0&&(m=4294967295+m+1),this[w]=m>>>24,this[w+1]=m>>>16,this[w+2]=m>>>8,this[w+3]=m&255,w+4},"writeInt32BE"),v.prototype.writeBigInt64LE=bt(c(function(m,w=0){return gt(this,m,w,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))},"writeBigInt64LE")),v.prototype.writeBigInt64BE=bt(c(function(m,w=0){return Ge(this,m,w,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))},"writeBigInt64BE"));function ot(k,m,w,U,X,se){if(w+U>k.length)throw new RangeError("Index out of range");if(w<0)throw new RangeError("Index out of range")}c(ot,"checkIEEE754");function fe(k,m,w,U,X){return m=+m,w=w>>>0,X||ot(k,m,w,4,34028234663852886e22,-34028234663852886e22),M.write(k,m,w,U,23,4),w+4}c(fe,"writeFloat"),v.prototype.writeFloatLE=c(function(m,w,U){return fe(this,m,w,!0,U)},"writeFloatLE"),v.prototype.writeFloatBE=c(function(m,w,U){return fe(this,m,w,!1,U)},"writeFloatBE");function de(k,m,w,U,X){return m=+m,w=w>>>0,X||ot(k,m,w,8,17976931348623157e292,-17976931348623157e292),M.write(k,m,w,U,52,8),w+8}c(de,"writeDouble"),v.prototype.writeDoubleLE=c(function(m,w,U){return de(this,m,w,!0,U)},"writeDoubleLE"),v.prototype.writeDoubleBE=c(function(m,w,U){return de(this,m,w,!1,U)},"writeDoubleBE"),v.prototype.copy=c(function(m,w,U,X){if(!v.isBuffer(m))throw new TypeError("argument should be a Buffer");if(U||(U=0),!X&&X!==0&&(X=this.length),w>=m.length&&(w=m.length),w||(w=0),X>0&&X<U&&(X=U),X===U||m.length===0||this.length===0)return 0;if(w<0)throw new RangeError("targetStart out of bounds");if(U<0||U>=this.length)throw new RangeError("Index out of range");if(X<0)throw new RangeError("sourceEnd out of bounds");X>this.length&&(X=this.length),m.length-w<X-U&&(X=m.length-w+U);const se=X-U;return this===m&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(w,U,X):Uint8Array.prototype.set.call(m,this.subarray(U,X),w),se},"copy"),v.prototype.fill=c(function(m,w,U,X){if(typeof m=="string"){if(typeof w=="string"?(X=w,w=0,U=this.length):typeof U=="string"&&(X=U,U=this.length),X!==void 0&&typeof X!="string")throw new TypeError("encoding must be a string");if(typeof X=="string"&&!v.isEncoding(X))throw new TypeError("Unknown encoding: "+X);if(m.length===1){const ye=m.charCodeAt(0);(X==="utf8"&&ye<128||X==="latin1")&&(m=ye)}}else typeof m=="number"?m=m&255:typeof m=="boolean"&&(m=Number(m));if(w<0||this.length<w||this.length<U)throw new RangeError("Out of range index");if(U<=w)return this;w=w>>>0,U=U===void 0?this.length:U>>>0,m||(m=0);let se;if(typeof m=="number")for(se=w;se<U;++se)this[se]=m;else{const ye=v.isBuffer(m)?m:v.from(m,X),ft=ye.length;if(ft===0)throw new TypeError('The value "'+m+'" is invalid for argument "value"');for(se=0;se<U-w;++se)this[se+w]=ye[se%ft]}return this},"fill");const We={};function Qe(k,m,w){We[k]=c(class extends w{constructor(){super();Object.defineProperty(this,"message",{value:m.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${k}]`,this.stack,delete this.name}get code(){return k}set code(X){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:X,writable:!0})}toString(){return`${this.name} [${k}]: ${this.message}`}},"NodeError")}c(Qe,"E"),Qe("ERR_BUFFER_OUT_OF_BOUNDS",function(k){return k?`${k} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Qe("ERR_INVALID_ARG_TYPE",function(k,m){return`The "${k}" argument must be of type number. Received type ${typeof m}`},TypeError),Qe("ERR_OUT_OF_RANGE",function(k,m,w){let U=`The value of "${k}" is out of range.`,X=w;return Number.isInteger(w)&&Math.abs(w)>2**32?X=mt(String(w)):typeof w=="bigint"&&(X=String(w),(w>BigInt(2)**BigInt(32)||w<-(BigInt(2)**BigInt(32)))&&(X=mt(X)),X+="n"),U+=` It must be ${m}. Received ${X}`,U},RangeError);function mt(k){let m="",w=k.length;const U=k[0]==="-"?1:0;for(;w>=U+4;w-=3)m=`_${k.slice(w-3,w)}${m}`;return`${k.slice(0,w)}${m}`}c(mt,"addNumericalSeparator");function Zt(k,m,w){It(m,"offset"),(k[m]===void 0||k[m+w]===void 0)&&Jt(m,k.length-(w+1))}c(Zt,"checkBounds");function yt(k,m,w,U,X,se){if(k>w||k<m){const ye=typeof m=="bigint"?"n":"";let ft;throw se>3?m===0||m===BigInt(0)?ft=`>= 0${ye} and < 2${ye} ** ${(se+1)*8}${ye}`:ft=`>= -(2${ye} ** ${(se+1)*8-1}${ye}) and < 2 ** ${(se+1)*8-1}${ye}`:ft=`>= ${m}${ye} and <= ${w}${ye}`,new We.ERR_OUT_OF_RANGE("value",ft,k)}Zt(U,X,se)}c(yt,"checkIntBI");function It(k,m){if(typeof k!="number")throw new We.ERR_INVALID_ARG_TYPE(m,"number",k)}c(It,"validateNumber");function Jt(k,m,w){throw Math.floor(k)!==k?(It(k,w),new We.ERR_OUT_OF_RANGE(w||"offset","an integer",k)):m<0?new We.ERR_BUFFER_OUT_OF_BOUNDS:new We.ERR_OUT_OF_RANGE(w||"offset",`>= ${w?1:0} and <= ${m}`,k)}c(Jt,"boundsError");const xr=/[^+/0-9A-Za-z-_]/g;function ir(k){if(k=k.split("=")[0],k=k.trim().replace(xr,""),k.length<2)return"";for(;k.length%4!=0;)k=k+"=";return k}c(ir,"base64clean");function Ve(k,m){m=m||1/0;let w;const U=k.length;let X=null;const se=[];for(let ye=0;ye<U;++ye){if(w=k.charCodeAt(ye),w>55295&&w<57344){if(!X){if(w>56319){(m-=3)>-1&&se.push(239,191,189);continue}else if(ye+1===U){(m-=3)>-1&&se.push(239,191,189);continue}X=w;continue}if(w<56320){(m-=3)>-1&&se.push(239,191,189),X=w;continue}w=(X-55296<<10|w-56320)+65536}else X&&(m-=3)>-1&&se.push(239,191,189);if(X=null,w<128){if((m-=1)<0)break;se.push(w)}else if(w<2048){if((m-=2)<0)break;se.push(w>>6|192,w&63|128)}else if(w<65536){if((m-=3)<0)break;se.push(w>>12|224,w>>6&63|128,w&63|128)}else if(w<1114112){if((m-=4)<0)break;se.push(w>>18|240,w>>12&63|128,w>>6&63|128,w&63|128)}else throw new Error("Invalid code point")}return se}c(Ve,"utf8ToBytes");function ke(k){const m=[];for(let w=0;w<k.length;++w)m.push(k.charCodeAt(w)&255);return m}c(ke,"asciiToBytes");function Pn(k,m){let w,U,X;const se=[];for(let ye=0;ye<k.length&&!((m-=2)<0);++ye)w=k.charCodeAt(ye),U=w>>8,X=w%256,se.push(X),se.push(U);return se}c(Pn,"utf16leToBytes");function Ie(k){return I.toByteArray(ir(k))}c(Ie,"base64ToBytes");function at(k,m,w,U){let X;for(X=0;X<U&&!(X+w>=m.length||X>=k.length);++X)m[X+w]=k[X];return X}c(at,"blitBuffer");function Ae(k,m){return k instanceof m||k!=null&&k.constructor!=null&&k.constructor.name!=null&&k.constructor.name===m.name}c(Ae,"isInstance");function Oe(k){return k!==k}c(Oe,"numberIsNaN");const Nt=function(){const k="0123456789abcdef",m=new Array(256);for(let w=0;w<16;++w){const U=w*16;for(let X=0;X<16;++X)m[U+X]=k[w]+k[X]}return m}();function bt(k){return typeof BigInt=="undefined"?At:k}c(bt,"defineBigIntMethod");function At(){throw new Error("BigInt not supported")}c(At,"BufferBigIntNotDefined")},1:(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var Buffer=__webpack_require__(8764).Buffer;const Token=__webpack_require__(3416),strtok3=__webpack_require__(5849),{stringToBytes,tarHeaderChecksumMatches,uint32SyncSafeToken}=__webpack_require__(6188),supported=__webpack_require__(9898),minimumBytes=4100;async function fromStream(h){const A=await strtok3.fromStream(h);try{return await fromTokenizer(A)}finally{await A.close()}}c(fromStream,"fromStream");async function fromBuffer(h){if(!(h instanceof Uint8Array||h instanceof ArrayBuffer||Buffer.isBuffer(h)))throw new TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`Buffer\` or \`ArrayBuffer\`, got \`${typeof h}\``);const A=h instanceof Buffer?h:Buffer.from(h);if(!(A&&A.length>1))return;const O=strtok3.fromBuffer(A);return fromTokenizer(O)}c(fromBuffer,"fromBuffer");function _check(h,A,O){O={offset:0,...O};for(const[I,M]of A.entries())if(O.mask){if(M!==(O.mask[I]&h[I+O.offset]))return!1}else if(M!==h[I+O.offset])return!1;return!0}c(_check,"_check");async function fromTokenizer(h){try{return _fromTokenizer(h)}catch(A){if(!(A instanceof strtok3.EndOfStreamError))throw A}}c(fromTokenizer,"fromTokenizer");async function _fromTokenizer(h){let A=Buffer.alloc(minimumBytes);const O=12,I=c((B,q)=>_check(A,B,q),"check"),M=c((B,q)=>I(stringToBytes(B),q),"checkString");if(h.fileInfo.size||(h.fileInfo.size=Number.MAX_SAFE_INTEGER),await h.peekBuffer(A,{length:O,mayBeLess:!0}),I([66,77]))return{ext:"bmp",mime:"image/bmp"};if(I([11,119]))return{ext:"ac3",mime:"audio/vnd.dolby.dd-raw"};if(I([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(I([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if(I([37,33]))return await h.peekBuffer(A,{length:24,mayBeLess:!0}),M("PS-Adobe-",{offset:2})&&M(" EPSF-",{offset:14})?{ext:"eps",mime:"application/eps"}:{ext:"ps",mime:"application/postscript"};if(I([31,160])||I([31,157]))return{ext:"Z",mime:"application/x-compress"};if(I([255,216,255]))return{ext:"jpg",mime:"image/jpeg"};if(I([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(I([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(I([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(M("ID3")){await h.ignore(6);const B=await h.readToken(uint32SyncSafeToken);return h.position+B>h.fileInfo.size?{ext:"mp3",mime:"audio/mpeg"}:(await h.ignore(B),fromTokenizer(h))}if(M("MP+"))return{ext:"mpc",mime:"audio/x-musepack"};if((A[0]===67||A[0]===70)&&I([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(I([71,73,70]))return{ext:"gif",mime:"image/gif"};if(M("FLIF"))return{ext:"flif",mime:"image/flif"};if(M("8BPS"))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(M("WEBP",{offset:8}))return{ext:"webp",mime:"image/webp"};if(M("MPCK"))return{ext:"mpc",mime:"audio/x-musepack"};if(M("FORM"))return{ext:"aif",mime:"audio/aiff"};if(M("icns",{offset:0}))return{ext:"icns",mime:"image/icns"};if(I([80,75,3,4])){try{for(;h.position+30<h.fileInfo.size;){await h.readBuffer(A,{length:30});const B={compressedSize:A.readUInt32LE(18),uncompressedSize:A.readUInt32LE(22),filenameLength:A.readUInt16LE(26),extraFieldLength:A.readUInt16LE(28)};if(B.filename=await h.readToken(new Token.StringType(B.filenameLength,"utf-8")),await h.ignore(B.extraFieldLength),B.filename==="META-INF/mozilla.rsa")return{ext:"xpi",mime:"application/x-xpinstall"};if(B.filename.endsWith(".rels")||B.filename.endsWith(".xml"))switch(B.filename.split("/")[0]){case"_rels":break;case"word":return{ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"};case"ppt":return{ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"};case"xl":return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};default:break}if(B.filename.startsWith("xl/"))return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};if(B.filename.startsWith("3D/")&&B.filename.endsWith(".model"))return{ext:"3mf",mime:"model/3mf"};if(B.filename==="mimetype"&&B.compressedSize===B.uncompressedSize)switch(await h.readToken(new Token.StringType(B.compressedSize,"utf-8"))){case"application/epub+zip":return{ext:"epub",mime:"application/epub+zip"};case"application/vnd.oasis.opendocument.text":return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};case"application/vnd.oasis.opendocument.spreadsheet":return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};case"application/vnd.oasis.opendocument.presentation":return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"};default:}if(B.compressedSize===0){let q=-1;for(;q<0&&h.position<h.fileInfo.size;)await h.peekBuffer(A,{mayBeLess:!0}),q=A.indexOf("504B0304",0,"hex"),await h.ignore(q>=0?q:A.length)}else await h.ignore(B.compressedSize)}}catch(B){if(!(B instanceof strtok3.EndOfStreamError))throw B}return{ext:"zip",mime:"application/zip"}}if(M("OggS")){await h.ignore(28);const B=Buffer.alloc(8);return await h.readBuffer(B),_check(B,[79,112,117,115,72,101,97,100])?{ext:"opus",mime:"audio/opus"}:_check(B,[128,116,104,101,111,114,97])?{ext:"ogv",mime:"video/ogg"}:_check(B,[1,118,105,100,101,111,0])?{ext:"ogm",mime:"video/ogg"}:_check(B,[127,70,76,65,67])?{ext:"oga",mime:"audio/ogg"}:_check(B,[83,112,101,101,120,32,32])?{ext:"spx",mime:"audio/ogg"}:_check(B,[1,118,111,114,98,105,115])?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"}}if(I([80,75])&&(A[2]===3||A[2]===5||A[2]===7)&&(A[3]===4||A[3]===6||A[3]===8))return{ext:"zip",mime:"application/zip"};if(M("ftyp",{offset:4})&&(A[8]&96)!=0){const B=A.toString("binary",8,12).replace("\0"," ").trim();switch(B){case"avif":return{ext:"avif",mime:"image/avif"};case"mif1":return{ext:"heic",mime:"image/heif"};case"msf1":return{ext:"heic",mime:"image/heif-sequence"};case"heic":case"heix":return{ext:"heic",mime:"image/heic"};case"hevc":case"hevx":return{ext:"heic",mime:"image/heic-sequence"};case"qt":return{ext:"mov",mime:"video/quicktime"};case"M4V":case"M4VH":case"M4VP":return{ext:"m4v",mime:"video/x-m4v"};case"M4P":return{ext:"m4p",mime:"video/mp4"};case"M4B":return{ext:"m4b",mime:"audio/mp4"};case"M4A":return{ext:"m4a",mime:"audio/x-m4a"};case"F4V":return{ext:"f4v",mime:"video/mp4"};case"F4P":return{ext:"f4p",mime:"video/mp4"};case"F4A":return{ext:"f4a",mime:"audio/mp4"};case"F4B":return{ext:"f4b",mime:"audio/mp4"};case"crx":return{ext:"cr3",mime:"image/x-canon-cr3"};default:return B.startsWith("3g")?B.startsWith("3g2")?{ext:"3g2",mime:"video/3gpp2"}:{ext:"3gp",mime:"video/3gpp"}:{ext:"mp4",mime:"video/mp4"}}}if(M("MThd"))return{ext:"mid",mime:"audio/midi"};if(M("wOFF")&&(I([0,1,0,0],{offset:4})||M("OTTO",{offset:4})))return{ext:"woff",mime:"font/woff"};if(M("wOF2")&&(I([0,1,0,0],{offset:4})||M("OTTO",{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(I([212,195,178,161])||I([161,178,195,212]))return{ext:"pcap",mime:"application/vnd.tcpdump.pcap"};if(M("DSD "))return{ext:"dsf",mime:"audio/x-dsf"};if(M("LZIP"))return{ext:"lz",mime:"application/x-lzip"};if(M("fLaC"))return{ext:"flac",mime:"audio/x-flac"};if(I([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(M("wvpk"))return{ext:"wv",mime:"audio/wavpack"};if(M("%PDF")){await h.ignore(1350);const B=10*1024*1024,q=Buffer.alloc(Math.min(B,h.fileInfo.size));return await h.readBuffer(q,{mayBeLess:!0}),q.includes(Buffer.from("AIPrivateData"))?{ext:"ai",mime:"application/postscript"}:{ext:"pdf",mime:"application/pdf"}}if(I([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(I([73,73,42,0]))return M("CR",{offset:8})?{ext:"cr2",mime:"image/x-canon-cr2"}:I([28,0,254,0],{offset:8})||I([31,0,11,0],{offset:8})?{ext:"nef",mime:"image/x-nikon-nef"}:I([8,0,0,0],{offset:4})&&(I([45,0,254,0],{offset:8})||I([39,0,254,0],{offset:8}))?{ext:"dng",mime:"image/x-adobe-dng"}:(A=Buffer.alloc(24),await h.peekBuffer(A),(I([16,251,134,1],{offset:4})||I([8,0,0,0],{offset:4}))&&I([0,254,0,4,0,1,0,0,0,1,0,0,0,3,1],{offset:9})?{ext:"arw",mime:"image/x-sony-arw"}:{ext:"tif",mime:"image/tiff"});if(I([77,77,0,42]))return{ext:"tif",mime:"image/tiff"};if(M("MAC "))return{ext:"ape",mime:"audio/ape"};if(I([26,69,223,163])){async function B(){const R=await h.peekNumber(Token.UINT8);let T=128,_=0;for(;(R&T)==0;)++_,T>>=1;const F=Buffer.alloc(_+1);return await h.readBuffer(F),F}c(B,"readField");async function q(){const R=await B(),T=await B();T[0]^=128>>T.length-1;const _=Math.min(6,T.length);return{id:R.readUIntBE(0,R.length),len:T.readUIntBE(T.length-_,_)}}c(q,"readElement");async function V(R,T){for(;T>0;){const _=await q();if(_.id===17026)return h.readToken(new Token.StringType(_.len,"utf-8"));await h.ignore(_.len),--T}}c(V,"readChildren");const N=await q();switch(await V(1,N.len)){case"webm":return{ext:"webm",mime:"video/webm"};case"matroska":return{ext:"mkv",mime:"video/x-matroska"};default:return}}if(I([82,73,70,70])){if(I([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(I([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/vnd.wave"};if(I([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(M("SQLi"))return{ext:"sqlite",mime:"application/x-sqlite3"};if(I([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(M("Cr24"))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(M("MSCF")||M("ISc("))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(I([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(I([197,208,211,198]))return{ext:"eps",mime:"application/eps"};if(I([40,181,47,253]))return{ext:"zst",mime:"application/zstd"};if(I([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(M("#!AMR"))return{ext:"amr",mime:"audio/amr"};if(M("{\\rtf"))return{ext:"rtf",mime:"application/rtf"};if(I([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(M("IMPM"))return{ext:"it",mime:"audio/x-it"};if(M("-lh0-",{offset:2})||M("-lh1-",{offset:2})||M("-lh2-",{offset:2})||M("-lh3-",{offset:2})||M("-lh4-",{offset:2})||M("-lh5-",{offset:2})||M("-lh6-",{offset:2})||M("-lh7-",{offset:2})||M("-lzs-",{offset:2})||M("-lz4-",{offset:2})||M("-lz5-",{offset:2})||M("-lhd-",{offset:2}))return{ext:"lzh",mime:"application/x-lzh-compressed"};if(I([0,0,1,186])){if(I([33],{offset:4,mask:[241]}))return{ext:"mpg",mime:"video/MP1S"};if(I([68],{offset:4,mask:[196]}))return{ext:"mpg",mime:"video/MP2P"}}if(M("ITSF"))return{ext:"chm",mime:"application/vnd.ms-htmlhelp"};if(I([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(M("<?xml "))return{ext:"xml",mime:"application/xml"};if(I([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(I([82,97,114,33,26,7])&&(A[6]===0||A[6]===1))return{ext:"rar",mime:"application/x-rar-compressed"};if(M("solid "))return{ext:"stl",mime:"model/stl"};if(M("BLENDER"))return{ext:"blend",mime:"application/x-blender"};if(M("!<arch>"))return await h.ignore(8),await h.readToken(new Token.StringType(13,"ascii"))==="debian-binary"?{ext:"deb",mime:"application/x-deb"}:{ext:"ar",mime:"application/x-unix-archive"};if(I([137,80,78,71,13,10,26,10])){await h.ignore(8);async function B(){return{length:await h.readToken(Token.INT32_BE),type:await h.readToken(new Token.StringType(4,"binary"))}}c(B,"readChunkHeader");do{const q=await B();if(q.length<0)return;switch(q.type){case"IDAT":return{ext:"png",mime:"image/png"};case"acTL":return{ext:"apng",mime:"image/apng"};default:await h.ignore(q.length+4)}}while(h.position+8<h.fileInfo.size);return{ext:"png",mime:"image/png"}}if(I([65,82,82,79,87,49,0,0]))return{ext:"arrow",mime:"application/x-apache-arrow"};if(I([103,108,84,70,2,0,0,0]))return{ext:"glb",mime:"model/gltf-binary"};if(I([102,114,101,101],{offset:4})||I([109,100,97,116],{offset:4})||I([109,111,111,118],{offset:4})||I([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(I([73,73,82,79,8,0,0,0,24]))return{ext:"orf",mime:"image/x-olympus-orf"};if(M("gimp xcf "))return{ext:"xcf",mime:"image/x-xcf"};if(I([73,73,85,0,24,0,0,0,136,231,116,216]))return{ext:"rw2",mime:"image/x-panasonic-rw2"};if(I([48,38,178,117,142,102,207,17,166,217])){async function B(){const q=Buffer.alloc(16);return await h.readBuffer(q),{id:q,size:Number(await h.readToken(Token.UINT64_LE))}}for(c(B,"readHeader"),await h.ignore(30);h.position+24<h.fileInfo.size;){const q=await B();let V=q.size-24;if(_check(q.id,[145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101])){const N=Buffer.alloc(16);if(V-=await h.readBuffer(N),_check(N,[64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"audio/x-ms-asf"};if(_check(N,[192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"video/x-ms-asf"};break}await h.ignore(V)}return{ext:"asf",mime:"application/vnd.ms-asf"}}if(I([171,75,84,88,32,49,49,187,13,10,26,10]))return{ext:"ktx",mime:"image/ktx"};if((I([126,16,4])||I([126,24,4]))&&I([48,77,73,69],{offset:4}))return{ext:"mie",mime:"application/x-mie"};if(I([39,10,0,0,0,0,0,0,0,0,0,0],{offset:2}))return{ext:"shp",mime:"application/x-esri-shape"};if(I([0,0,0,12,106,80,32,32,13,10,135,10]))switch(await h.ignore(20),await h.readToken(new Token.StringType(4,"ascii"))){case"jp2 ":return{ext:"jp2",mime:"image/jp2"};case"jpx ":return{ext:"jpx",mime:"image/jpx"};case"jpm ":return{ext:"jpm",mime:"image/jpm"};case"mjp2":return{ext:"mj2",mime:"image/mj2"};default:return}if(I([255,10])||I([0,0,0,12,74,88,76,32,13,10,135,10]))return{ext:"jxl",mime:"image/jxl"};if(I([0,0,1,186])||I([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(I([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(I([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(I([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(I([208,207,17,224,161,177,26,225]))return{ext:"cfb",mime:"application/x-cfb"};if(await h.peekBuffer(A,{length:Math.min(256,h.fileInfo.size),mayBeLess:!0}),M("BEGIN:")){if(M("VCARD",{offset:6}))return{ext:"vcf",mime:"text/vcard"};if(M("VCALENDAR",{offset:6}))return{ext:"ics",mime:"text/calendar"}}if(M("FUJIFILMCCD-RAW"))return{ext:"raf",mime:"image/x-fujifilm-raf"};if(M("Extended Module:"))return{ext:"xm",mime:"audio/x-xm"};if(M("Creative Voice File"))return{ext:"voc",mime:"audio/x-voc"};if(I([4,0,0,0])&&A.length>=16){const B=A.readUInt32LE(12);if(B>12&&A.length>=B+16)try{const q=A.slice(16,B+16).toString();if(JSON.parse(q).files)return{ext:"asar",mime:"application/x-asar"}}catch(q){}}if(I([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(M("SCRM",{offset:44}))return{ext:"s3m",mime:"audio/x-s3m"};if(I([71],{offset:4})&&(I([71],{offset:192})||I([71],{offset:196})))return{ext:"mts",mime:"video/mp2t"};if(I([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(I([68,73,67,77],{offset:128}))return{ext:"dcm",mime:"application/dicom"};if(I([76,0,0,0,1,20,2,0,0,0,0,0,192,0,0,0,0,0,0,70]))return{ext:"lnk",mime:"application/x.ms.shortcut"};if(I([98,111,111,107,0,0,0,0,109,97,114,107,0,0,0,0]))return{ext:"alias",mime:"application/x.apple.alias"};if(I([76,80],{offset:34})&&(I([0,0,1],{offset:8})||I([1,0,2],{offset:8})||I([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(I([6,6,237,245,216,29,70,229,189,49,239,231,254,116,183,29]))return{ext:"indd",mime:"application/x-indesign"};if(await h.peekBuffer(A,{length:Math.min(512,h.fileInfo.size),mayBeLess:!0}),tarHeaderChecksumMatches(A))return{ext:"tar",mime:"application/x-tar"};if(I([255,254,255,14,83,0,107,0,101,0,116,0,99,0,104,0,85,0,112,0,32,0,77,0,111,0,100,0,101,0,108,0]))return{ext:"skp",mime:"application/vnd.sketchup.skp"};if(M("-----BEGIN PGP MESSAGE-----"))return{ext:"pgp",mime:"application/pgp-encrypted"};if(A.length>=2&&I([255,224],{offset:0,mask:[255,224]})){if(I([16],{offset:1,mask:[22]}))return I([8],{offset:1,mask:[8]})?{ext:"aac",mime:"audio/aac"}:{ext:"aac",mime:"audio/aac"};if(I([2],{offset:1,mask:[6]}))return{ext:"mp3",mime:"audio/mpeg"};if(I([4],{offset:1,mask:[6]}))return{ext:"mp2",mime:"audio/mpeg"};if(I([6],{offset:1,mask:[6]}))return{ext:"mp1",mime:"audio/mpeg"}}}c(_fromTokenizer,"_fromTokenizer");const stream=c(readableStream=>new Promise((resolve,reject)=>{const stream=eval("require")("stream");readableStream.on("error",reject),readableStream.once("readable",async()=>{const h=new stream.PassThrough;let A;stream.pipeline?A=stream.pipeline(readableStream,h,()=>{}):A=readableStream.pipe(h);const O=readableStream.read(minimumBytes)||readableStream.read()||Buffer.alloc(0);try{const I=await fromBuffer(O);h.fileType=I}catch(I){reject(I)}resolve(A)})}),"stream"),fileType={fromStream,fromTokenizer,fromBuffer,stream};Object.defineProperty(fileType,"extensions",{get(){return new Set(supported.extensions)}}),Object.defineProperty(fileType,"mimeTypes",{get(){return new Set(supported.mimeTypes)}}),module.exports=fileType},7769:(h,A,O)=>{"use strict";const I=O(6597),M=O(1);async function B(V){const N=await I.fromFile(V);try{return await M.fromTokenizer(N)}finally{await N.close()}}c(B,"fromFile");const q={fromFile:B};Object.assign(q,M),Object.defineProperty(q,"extensions",{get(){return M.extensions}}),Object.defineProperty(q,"mimeTypes",{get(){return M.mimeTypes}}),h.exports=q},9898:h=>{"use strict";h.exports={extensions:["jpg","png","apng","gif","webp","flif","xcf","cr2","cr3","orf","arw","dng","nef","rw2","raf","tif","bmp","icns","jxr","psd","indd","zip","tar","rar","gz","bz2","7z","dmg","mp4","mid","mkv","webm","mov","avi","mpg","mp2","mp3","m4a","oga","ogg","ogv","opus","flac","wav","spx","amr","pdf","epub","exe","swf","rtf","wasm","woff","woff2","eot","ttf","otf","ico","flv","ps","xz","sqlite","nes","crx","xpi","cab","deb","ar","rpm","Z","lz","cfb","mxf","mts","blend","bpg","docx","pptx","xlsx","3gp","3g2","jp2","jpm","jpx","mj2","aif","qcp","odt","ods","odp","xml","mobi","heic","cur","ktx","ape","wv","dcm","ics","glb","pcap","dsf","lnk","alias","voc","ac3","m4v","m4p","m4b","f4v","f4p","f4b","f4a","mie","asf","ogm","ogx","mpc","arrow","shp","aac","mp1","it","s3m","xm","ai","skp","avif","eps","lzh","pgp","asar","stl","chm","3mf","zst","jxl","vcf"],mimeTypes:["image/jpeg","image/png","image/gif","image/webp","image/flif","image/x-xcf","image/x-canon-cr2","image/x-canon-cr3","image/tiff","image/bmp","image/vnd.ms-photo","image/vnd.adobe.photoshop","application/x-indesign","application/epub+zip","application/x-xpinstall","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.presentation","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/zip","application/x-tar","application/x-rar-compressed","application/gzip","application/x-bzip2","application/x-7z-compressed","application/x-apple-diskimage","application/x-apache-arrow","video/mp4","audio/midi","video/x-matroska","video/webm","video/quicktime","video/vnd.avi","audio/vnd.wave","audio/qcelp","audio/x-ms-asf","video/x-ms-asf","application/vnd.ms-asf","video/mpeg","video/3gpp","audio/mpeg","audio/mp4","audio/opus","video/ogg","audio/ogg","application/ogg","audio/x-flac","audio/ape","audio/wavpack","audio/amr","application/pdf","application/x-msdownload","application/x-shockwave-flash","application/rtf","application/wasm","font/woff","font/woff2","application/vnd.ms-fontobject","font/ttf","font/otf","image/x-icon","video/x-flv","application/postscript","application/eps","application/x-xz","application/x-sqlite3","application/x-nintendo-nes-rom","application/x-google-chrome-extension","application/vnd.ms-cab-compressed","application/x-deb","application/x-unix-archive","application/x-rpm","application/x-compress","application/x-lzip","application/x-cfb","application/x-mie","application/mxf","video/mp2t","application/x-blender","image/bpg","image/jp2","image/jpx","image/jpm","image/mj2","audio/aiff","application/xml","application/x-mobipocket-ebook","image/heif","image/heif-sequence","image/heic","image/heic-sequence","image/icns","image/ktx","application/dicom","audio/x-musepack","text/calendar","text/vcard","model/gltf-binary","application/vnd.tcpdump.pcap","audio/x-dsf","application/x.ms.shortcut","application/x.apple.alias","audio/x-voc","audio/vnd.dolby.dd-raw","audio/x-m4a","image/apng","image/x-olympus-orf","image/x-sony-arw","image/x-adobe-dng","image/x-nikon-nef","image/x-panasonic-rw2","image/x-fujifilm-raf","video/x-m4v","video/3gpp2","application/x-esri-shape","audio/aac","audio/x-it","audio/x-s3m","audio/x-xm","video/MP1S","video/MP2P","application/vnd.sketchup.skp","image/avif","application/x-lzh-compressed","application/pgp-encrypted","application/x-asar","model/stl","application/vnd.ms-htmlhelp","model/3mf","image/jxl","application/zstd"]}},6188:(h,A)=>{"use strict";A.stringToBytes=O=>[...O].map(I=>I.charCodeAt(0)),A.tarHeaderChecksumMatches=(O,I=0)=>{const M=parseInt(O.toString("utf8",148,154).replace(/\0.*$/,"").trim(),8);if(isNaN(M))return!1;let B=8*32;for(let q=I;q<I+148;q++)B+=O[q];for(let q=I+156;q<I+512;q++)B+=O[q];return M===B},A.uint32SyncSafeToken={get:(O,I)=>O[I+3]&127|O[I+2]<<7|O[I+1]<<14|O[I]<<21,len:4}},2664:(h,A,O)=>{"use strict";/*!
 * fill-range <https://github.com/jonschlinkert/fill-range>
 *
 * Copyright (c) 2014-present, Jon Schlinkert.
 * Licensed under the MIT License.
 */const I=O(1932),M=O(5702),B=c(C=>C!==null&&typeof C=="object"&&!Array.isArray(C),"isObject"),q=c(C=>G=>C===!0?Number(G):String(G),"transform"),V=c(C=>typeof C=="number"||typeof C=="string"&&C!=="","isValidValue"),N=c(C=>Number.isInteger(+C),"isNumber"),v=c(C=>{let G=`${C}`,H=-1;if(G[0]==="-"&&(G=G.slice(1)),G==="0")return!1;for(;G[++H]==="0";);return H>0},"zeros"),R=c((C,G,H)=>typeof C=="string"||typeof G=="string"?!0:H.stringify===!0,"stringify"),T=c((C,G,H)=>{if(G>0){let ue=C[0]==="-"?"-":"";ue&&(C=C.slice(1)),C=ue+C.padStart(ue?G-1:G,"0")}return H===!1?String(C):C},"pad"),_=c((C,G)=>{let H=C[0]==="-"?"-":"";for(H&&(C=C.slice(1),G--);C.length<G;)C="0"+C;return H?"-"+C:C},"toMaxLen"),F=c((C,G)=>{C.negatives.sort((ve,De)=>ve<De?-1:ve>De?1:0),C.positives.sort((ve,De)=>ve<De?-1:ve>De?1:0);let H=G.capture?"":"?:",ue="",le="",ce;return C.positives.length&&(ue=C.positives.join("|")),C.negatives.length&&(le=`-(${H}${C.negatives.join("|")})`),ue&&le?ce=`${ue}|${le}`:ce=ue||le,G.wrap?`(${H}${ce})`:ce},"toSequence"),j=c((C,G,H,ue)=>{if(H)return M(C,G,{wrap:!1,...ue});let le=String.fromCharCode(C);if(C===G)return le;let ce=String.fromCharCode(G);return`[${le}-${ce}]`},"toRange"),P=c((C,G,H)=>{if(Array.isArray(C)){let ue=H.wrap===!0,le=H.capture?"":"?:";return ue?`(${le}${C.join("|")})`:C.join("|")}return M(C,G,H)},"toRegex"),Z=c((...C)=>new RangeError("Invalid range arguments: "+I.inspect(...C)),"rangeError"),ie=c((C,G,H)=>{if(H.strictRanges===!0)throw Z([C,G]);return[]},"invalidRange"),Ce=c((C,G)=>{if(G.strictRanges===!0)throw new TypeError(`Expected step "${C}" to be a number`);return[]},"invalidStep"),K=c((C,G,H=1,ue={})=>{let le=Number(C),ce=Number(G);if(!Number.isInteger(le)||!Number.isInteger(ce)){if(ue.strictRanges===!0)throw Z([C,G]);return[]}le===0&&(le=0),ce===0&&(ce=0);let ve=le>ce,De=String(C),Ue=String(G),qe=String(H);H=Math.max(Math.abs(H),1);let _e=v(De)||v(Ue)||v(qe),rt=_e?Math.max(De.length,Ue.length,qe.length):0,lt=_e===!1&&R(C,G,ue)===!1,Ke=ue.transform||q(lt);if(ue.toRegex&&H===1)return j(_(C,rt),_(G,rt),!0,ue);let Se={negatives:[],positives:[]},he=c(te=>Se[te<0?"negatives":"positives"].push(Math.abs(te)),"push"),nt=[],Je=0;for(;ve?le>=ce:le<=ce;)ue.toRegex===!0&&H>1?he(le):nt.push(T(Ke(le,Je),rt,lt)),le=ve?le-H:le+H,Je++;return ue.toRegex===!0?H>1?F(Se,ue):P(nt,null,{wrap:!1,...ue}):nt},"fillNumbers"),Q=c((C,G,H=1,ue={})=>{if(!N(C)&&C.length>1||!N(G)&&G.length>1)return ie(C,G,ue);let le=ue.transform||(lt=>String.fromCharCode(lt)),ce=`${C}`.charCodeAt(0),ve=`${G}`.charCodeAt(0),De=ce>ve,Ue=Math.min(ce,ve),qe=Math.max(ce,ve);if(ue.toRegex&&H===1)return j(Ue,qe,!1,ue);let _e=[],rt=0;for(;De?ce>=ve:ce<=ve;)_e.push(le(ce,rt)),ce=De?ce-H:ce+H,rt++;return ue.toRegex===!0?P(_e,null,{wrap:!1,options:ue}):_e},"fillLetters"),Y=c((C,G,H,ue={})=>{if(G==null&&V(C))return[C];if(!V(C)||!V(G))return ie(C,G,ue);if(typeof H=="function")return Y(C,G,1,{transform:H});if(B(H))return Y(C,G,0,H);let le={...ue};return le.capture===!0&&(le.wrap=!0),H=H||le.step||1,N(H)?N(C)&&N(G)?K(C,G,H,le):Q(C,G,Math.max(Math.abs(H),1),le):H!=null&&!B(H)?Ce(H,le):Y(C,G,1,H)},"fill");h.exports=Y},7360:function(h,A){var O,I,M;(function(B,q){I=[],O=q,M=typeof O=="function"?O.apply(A,I):O,M!==void 0&&(h.exports=M)})(this,c(function(){function q(K){var Q={single:function(Y,C,G){if(!Y||(Z(Y)||(Y=Q.getPreparedSearch(Y)),!C))return null;Z(C)||(C=Q.getPrepared(C));var H=G&&G.allowTypo!==void 0?G.allowTypo:K&&K.allowTypo!==void 0?K.allowTypo:!0,ue=H?Q.algorithm:Q.algorithmNoTypo;return ue(Y,C,Y[0])},go:function(Y,C,G){if(!Y)return R;Y=Q.prepareSearch(Y);var H=Y[0],ue=G&&G.threshold||K&&K.threshold||-9007199254740991,le=G&&G.limit||K&&K.limit||9007199254740991,ce=G&&G.allowTypo!==void 0?G.allowTypo:K&&K.allowTypo!==void 0?K.allowTypo:!0,ve=ce?Q.algorithm:Q.algorithmNoTypo,De=0,Ue=0,qe=C.length;if(G&&G.keys)for(var _e=G.scoreFn||j,rt=G.keys,lt=rt.length,Ke=qe-1;Ke>=0;--Ke){for(var Se=C[Ke],he=new Array(lt),nt=lt-1;nt>=0;--nt){var Je=rt[nt],te=P(Se,Je);if(!te){he[nt]=null;continue}Z(te)||(te=Q.getPrepared(te)),he[nt]=ve(Y,te,H)}he.obj=Se;var gt=_e(he);gt!==null&&(gt<ue||(he.score=gt,De<le?(Ce.add(he),++De):(++Ue,gt>Ce.peek().score&&Ce.replaceTop(he))))}else if(G&&G.key)for(var Je=G.key,Ke=qe-1;Ke>=0;--Ke){var Se=C[Ke],te=P(Se,Je);if(!!te){Z(te)||(te=Q.getPrepared(te));var Ge=ve(Y,te,H);Ge!==null&&(Ge.score<ue||(Ge={target:Ge.target,_targetLowerCodes:null,_nextBeginningIndexes:null,score:Ge.score,indexes:Ge.indexes,obj:Se},De<le?(Ce.add(Ge),++De):(++Ue,Ge.score>Ce.peek().score&&Ce.replaceTop(Ge))))}}else for(var Ke=qe-1;Ke>=0;--Ke){var te=C[Ke];if(!!te){Z(te)||(te=Q.getPrepared(te));var Ge=ve(Y,te,H);Ge!==null&&(Ge.score<ue||(De<le?(Ce.add(Ge),++De):(++Ue,Ge.score>Ce.peek().score&&Ce.replaceTop(Ge))))}}if(De===0)return R;for(var ot=new Array(De),Ke=De-1;Ke>=0;--Ke)ot[Ke]=Ce.poll();return ot.total=De+Ue,ot},goAsync:function(Y,C,G){var H=!1,ue=new Promise(function(le,ce){if(!Y)return le(R);Y=Q.prepareSearch(Y);var ve=Y[0],De=ie(),Ue=C.length-1,qe=G&&G.threshold||K&&K.threshold||-9007199254740991,_e=G&&G.limit||K&&K.limit||9007199254740991,rt=G&&G.allowTypo!==void 0?G.allowTypo:K&&K.allowTypo!==void 0?K.allowTypo:!0,lt=rt?Q.algorithm:Q.algorithmNoTypo,Ke=0,Se=0;function he(){if(H)return ce("canceled");var nt=Date.now();if(G&&G.keys)for(var Je=G.scoreFn||j,te=G.keys,gt=te.length;Ue>=0;--Ue){for(var Ge=C[Ue],ot=new Array(gt),fe=gt-1;fe>=0;--fe){var de=te[fe],We=P(Ge,de);if(!We){ot[fe]=null;continue}Z(We)||(We=Q.getPrepared(We)),ot[fe]=lt(Y,We,ve)}ot.obj=Ge;var Qe=Je(ot);if(Qe!==null&&!(Qe<qe)&&(ot.score=Qe,Ke<_e?(De.add(ot),++Ke):(++Se,Qe>De.peek().score&&De.replaceTop(ot)),Ue%1e3==0&&Date.now()-nt>=10)){V?setImmediate(he):setTimeout(he);return}}else if(G&&G.key)for(var de=G.key;Ue>=0;--Ue){var Ge=C[Ue],We=P(Ge,de);if(!!We){Z(We)||(We=Q.getPrepared(We));var mt=lt(Y,We,ve);if(mt!==null&&!(mt.score<qe)&&(mt={target:mt.target,_targetLowerCodes:null,_nextBeginningIndexes:null,score:mt.score,indexes:mt.indexes,obj:Ge},Ke<_e?(De.add(mt),++Ke):(++Se,mt.score>De.peek().score&&De.replaceTop(mt)),Ue%1e3==0&&Date.now()-nt>=10)){V?setImmediate(he):setTimeout(he);return}}}else for(;Ue>=0;--Ue){var We=C[Ue];if(!!We){Z(We)||(We=Q.getPrepared(We));var mt=lt(Y,We,ve);if(mt!==null&&!(mt.score<qe)&&(Ke<_e?(De.add(mt),++Ke):(++Se,mt.score>De.peek().score&&De.replaceTop(mt)),Ue%1e3==0&&Date.now()-nt>=10)){V?setImmediate(he):setTimeout(he);return}}}if(Ke===0)return le(R);for(var Zt=new Array(Ke),yt=Ke-1;yt>=0;--yt)Zt[yt]=De.poll();Zt.total=Ke+Se,le(Zt)}c(he,"step"),V?setImmediate(he):he()});return ue.cancel=function(){H=!0},ue},highlight:function(Y,C,G){if(Y===null)return null;C===void 0&&(C="<b>"),G===void 0&&(G="</b>");for(var H="",ue=0,le=!1,ce=Y.target,ve=ce.length,De=Y.indexes,Ue=0;Ue<ve;++Ue){var qe=ce[Ue];if(De[ue]===Ue){if(++ue,le||(le=!0,H+=C),ue===De.length){H+=qe+G+ce.substr(Ue+1);break}}else le&&(le=!1,H+=G);H+=qe}return H},prepare:function(Y){if(!!Y)return{target:Y,_targetLowerCodes:Q.prepareLowerCodes(Y),_nextBeginningIndexes:null,score:null,indexes:null,obj:null}},prepareSlow:function(Y){if(!!Y)return{target:Y,_targetLowerCodes:Q.prepareLowerCodes(Y),_nextBeginningIndexes:Q.prepareNextBeginningIndexes(Y),score:null,indexes:null,obj:null}},prepareSearch:function(Y){if(!!Y)return Q.prepareLowerCodes(Y)},getPrepared:function(Y){if(Y.length>999)return Q.prepare(Y);var C=N.get(Y);return C!==void 0||(C=Q.prepare(Y),N.set(Y,C)),C},getPreparedSearch:function(Y){if(Y.length>999)return Q.prepareSearch(Y);var C=v.get(Y);return C!==void 0||(C=Q.prepareSearch(Y),v.set(Y,C)),C},algorithm:function(Y,C,G){for(var H=C._targetLowerCodes,ue=Y.length,le=H.length,ce=0,ve=0,De=0,Ue=0;;){var qe=G===H[ve];if(qe){if(T[Ue++]=ve,++ce,ce===ue)break;G=Y[De===0?ce:De===ce?ce+1:De===ce-1?ce-1:ce]}if(++ve,ve>=le)for(;;){if(ce<=1)return null;if(De===0){--ce;var _e=Y[ce];if(G===_e)continue;De=ce}else{if(De===1)return null;--De,ce=De,G=Y[ce+1];var _e=Y[ce];if(G===_e)continue}Ue=ce,ve=T[Ue-1]+1;break}}var ce=0,rt=0,lt=!1,Ke=0,Se=C._nextBeginningIndexes;Se===null&&(Se=C._nextBeginningIndexes=Q.prepareNextBeginningIndexes(C.target));var he=ve=T[0]===0?0:Se[T[0]-1];if(ve!==le)for(;;)if(ve>=le){if(ce<=0){if(++rt,rt>ue-2)break;if(Y[rt]===Y[rt+1])continue;ve=he;continue}--ce;var nt=_[--Ke];ve=Se[nt]}else{var qe=Y[rt===0?ce:rt===ce?ce+1:rt===ce-1?ce-1:ce]===H[ve];if(qe){if(_[Ke++]=ve,++ce,ce===ue){lt=!0;break}++ve}else ve=Se[ve]}{if(lt)var Je=_,te=Ke;else var Je=T,te=Ue;for(var gt=0,Ge=-1,ot=0;ot<ue;++ot){var ve=Je[ot];Ge!==ve-1&&(gt-=ve),Ge=ve}lt?rt!==0&&(gt+=-20):(gt*=1e3,De!==0&&(gt+=-20)),gt-=le-ue,C.score=gt,C.indexes=new Array(te);for(var ot=te-1;ot>=0;--ot)C.indexes[ot]=Je[ot];return C}},algorithmNoTypo:function(Y,C,G){for(var H=C._targetLowerCodes,ue=Y.length,le=H.length,ce=0,ve=0,De=0;;){var Ue=G===H[ve];if(Ue){if(T[De++]=ve,++ce,ce===ue)break;G=Y[ce]}if(++ve,ve>=le)return null}var ce=0,qe=!1,_e=0,rt=C._nextBeginningIndexes;rt===null&&(rt=C._nextBeginningIndexes=Q.prepareNextBeginningIndexes(C.target));var lt=ve=T[0]===0?0:rt[T[0]-1];if(ve!==le)for(;;)if(ve>=le){if(ce<=0)break;--ce;var Ke=_[--_e];ve=rt[Ke]}else{var Ue=Y[ce]===H[ve];if(Ue){if(_[_e++]=ve,++ce,ce===ue){qe=!0;break}++ve}else ve=rt[ve]}{if(qe)var Se=_,he=_e;else var Se=T,he=De;for(var nt=0,Je=-1,te=0;te<ue;++te){var ve=Se[te];Je!==ve-1&&(nt-=ve),Je=ve}qe||(nt*=1e3),nt-=le-ue,C.score=nt,C.indexes=new Array(he);for(var te=he-1;te>=0;--te)C.indexes[te]=Se[te];return C}},prepareLowerCodes:function(Y){for(var C=Y.length,G=[],H=Y.toLowerCase(),ue=0;ue<C;++ue)G[ue]=H.charCodeAt(ue);return G},prepareBeginningIndexes:function(Y){for(var C=Y.length,G=[],H=0,ue=!1,le=!1,ce=0;ce<C;++ce){var ve=Y.charCodeAt(ce),De=ve>=65&&ve<=90,Ue=De||ve>=97&&ve<=122||ve>=48&&ve<=57,qe=De&&!ue||!le||!Ue;ue=De,le=Ue,qe&&(G[H++]=ce)}return G},prepareNextBeginningIndexes:function(Y){for(var C=Y.length,G=Q.prepareBeginningIndexes(Y),H=[],ue=G[0],le=0,ce=0;ce<C;++ce)ue>ce?H[ce]=ue:(ue=G[++le],H[ce]=ue===void 0?C:ue);return H},cleanup:F,new:q};return Q}c(q,"fuzzysortNew");var V=typeof window=="undefined",N=new Map,v=new Map,R=[];R.total=0;var T=[],_=[];function F(){N.clear(),v.clear(),T=[],_=[]}c(F,"cleanup");function j(K){for(var Q=-9007199254740991,Y=K.length-1;Y>=0;--Y){var C=K[Y];if(C!==null){var G=C.score;G>Q&&(Q=G)}}return Q===-9007199254740991?null:Q}c(j,"defaultScoreFn");function P(K,Q){var Y=K[Q];if(Y!==void 0)return Y;var C=Q;Array.isArray(Q)||(C=Q.split("."));for(var G=C.length,H=-1;K&&++H<G;)K=K[C[H]];return K}c(P,"getValue");function Z(K){return typeof K=="object"}c(Z,"isObj");var ie=c(function(){var K=[],Q=0,Y={};function C(){for(var G=0,H=K[G],ue=1;ue<Q;){var le=ue+1;G=ue,le<Q&&K[le].score<K[ue].score&&(G=le),K[G-1>>1]=K[G],ue=1+(G<<1)}for(var ce=G-1>>1;G>0&&H.score<K[ce].score;ce=(G=ce)-1>>1)K[G]=K[ce];K[G]=H}return c(C,"n"),Y.add=function(G){var H=Q;K[Q++]=G;for(var ue=H-1>>1;H>0&&G.score<K[ue].score;ue=(H=ue)-1>>1)K[H]=K[ue];K[H]=G},Y.poll=function(){if(Q!==0){var G=K[0];return K[0]=K[--Q],C(),G}},Y.peek=function(G){if(Q!==0)return K[0]},Y.replaceTop=function(G){K[0]=G,C()},Y},"fastpriorityqueue"),Ce=ie();return q()},"UMD"))},645:(h,A)=>{/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */A.read=function(O,I,M,B,q){var V,N,v=q*8-B-1,R=(1<<v)-1,T=R>>1,_=-7,F=M?q-1:0,j=M?-1:1,P=O[I+F];for(F+=j,V=P&(1<<-_)-1,P>>=-_,_+=v;_>0;V=V*256+O[I+F],F+=j,_-=8);for(N=V&(1<<-_)-1,V>>=-_,_+=B;_>0;N=N*256+O[I+F],F+=j,_-=8);if(V===0)V=1-T;else{if(V===R)return N?NaN:(P?-1:1)*(1/0);N=N+Math.pow(2,B),V=V-T}return(P?-1:1)*N*Math.pow(2,V-B)},A.write=function(O,I,M,B,q,V){var N,v,R,T=V*8-q-1,_=(1<<T)-1,F=_>>1,j=q===23?Math.pow(2,-24)-Math.pow(2,-77):0,P=B?0:V-1,Z=B?1:-1,ie=I<0||I===0&&1/I<0?1:0;for(I=Math.abs(I),isNaN(I)||I===1/0?(v=isNaN(I)?1:0,N=_):(N=Math.floor(Math.log(I)/Math.LN2),I*(R=Math.pow(2,-N))<1&&(N--,R*=2),N+F>=1?I+=j/R:I+=j*Math.pow(2,1-F),I*R>=2&&(N++,R/=2),N+F>=_?(v=0,N=_):N+F>=1?(v=(I*R-1)*Math.pow(2,q),N=N+F):(v=I*Math.pow(2,F-1)*Math.pow(2,q),N=0));q>=8;O[M+P]=v&255,P+=Z,v/=256,q-=8);for(N=N<<q|v,T+=q;T>0;O[M+P]=N&255,P+=Z,N/=256,T-=8);O[M+P-Z]|=ie*128}},9924:h=>{"use strict";/*!
 * is-number <https://github.com/jonschlinkert/is-number>
 *
 * Copyright (c) 2014-present, Jon Schlinkert.
 * Released under the MIT License.
 */h.exports=function(A){return typeof A=="number"?A-A==0:typeof A=="string"&&A.trim()!==""?Number.isFinite?Number.isFinite(+A):isFinite(+A):!1}},2307:(h,A,O)=>{h=O.nmd(h);var I=200,M="__lodash_hash_undefined__",B=1,q=2,V=9007199254740991,N="[object Arguments]",v="[object Array]",R="[object AsyncFunction]",T="[object Boolean]",_="[object Date]",F="[object Error]",j="[object Function]",P="[object GeneratorFunction]",Z="[object Map]",ie="[object Number]",Ce="[object Null]",K="[object Object]",Q="[object Promise]",Y="[object Proxy]",C="[object RegExp]",G="[object Set]",H="[object String]",ue="[object Symbol]",le="[object Undefined]",ce="[object WeakMap]",ve="[object ArrayBuffer]",De="[object DataView]",Ue="[object Float32Array]",qe="[object Float64Array]",_e="[object Int8Array]",rt="[object Int16Array]",lt="[object Int32Array]",Ke="[object Uint8Array]",Se="[object Uint8ClampedArray]",he="[object Uint16Array]",nt="[object Uint32Array]",Je=/[\\^$.*+?()[\]{}|]/g,te=/^\[object .+?Constructor\]$/,gt=/^(?:0|[1-9]\d*)$/,Ge={};Ge[Ue]=Ge[qe]=Ge[_e]=Ge[rt]=Ge[lt]=Ge[Ke]=Ge[Se]=Ge[he]=Ge[nt]=!0,Ge[N]=Ge[v]=Ge[ve]=Ge[T]=Ge[De]=Ge[_]=Ge[F]=Ge[j]=Ge[Z]=Ge[ie]=Ge[K]=Ge[C]=Ge[G]=Ge[H]=Ge[ce]=!1;var ot=typeof O.g=="object"&&O.g&&O.g.Object===Object&&O.g,fe=typeof self=="object"&&self&&self.Object===Object&&self,de=ot||fe||Function("return this")(),We=A&&!A.nodeType&&A,Qe=We&&!0&&h&&!h.nodeType&&h,mt=Qe&&Qe.exports===We,Zt=mt&&ot.process,yt=function(){try{return Zt&&Zt.binding&&Zt.binding("util")}catch(L){}}(),It=yt&&yt.isTypedArray;function Jt(L,J){for(var xe=-1,Ze=L==null?0:L.length,Ut=0,pt=[];++xe<Ze;){var Vt=L[xe];J(Vt,xe,L)&&(pt[Ut++]=Vt)}return pt}c(Jt,"arrayFilter");function xr(L,J){for(var xe=-1,Ze=J.length,Ut=L.length;++xe<Ze;)L[Ut+xe]=J[xe];return L}c(xr,"arrayPush");function ir(L,J){for(var xe=-1,Ze=L==null?0:L.length;++xe<Ze;)if(J(L[xe],xe,L))return!0;return!1}c(ir,"arraySome");function Ve(L,J){for(var xe=-1,Ze=Array(L);++xe<L;)Ze[xe]=J(xe);return Ze}c(Ve,"baseTimes");function ke(L){return function(J){return L(J)}}c(ke,"baseUnary");function Pn(L,J){return L.has(J)}c(Pn,"cacheHas");function Ie(L,J){return L==null?void 0:L[J]}c(Ie,"getValue");function at(L){var J=-1,xe=Array(L.size);return L.forEach(function(Ze,Ut){xe[++J]=[Ut,Ze]}),xe}c(at,"mapToArray");function Ae(L,J){return function(xe){return L(J(xe))}}c(Ae,"overArg");function Oe(L){var J=-1,xe=Array(L.size);return L.forEach(function(Ze){xe[++J]=Ze}),xe}c(Oe,"setToArray");var Nt=Array.prototype,bt=Function.prototype,At=Object.prototype,k=de["__core-js_shared__"],m=bt.toString,w=At.hasOwnProperty,U=function(){var L=/[^.]+$/.exec(k&&k.keys&&k.keys.IE_PROTO||"");return L?"Symbol(src)_1."+L:""}(),X=At.toString,se=RegExp("^"+m.call(w).replace(Je,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ye=mt?de.Buffer:void 0,ft=de.Symbol,zt=de.Uint8Array,Mt=At.propertyIsEnumerable,jt=Nt.splice,dt=ft?ft.toStringTag:void 0,Pi=Object.getOwnPropertySymbols,za=ye?ye.isBuffer:void 0,xu=Ae(Object.keys,Object),gn=Fn(de,"DataView"),Be=Fn(de,"Map"),Fi=Fn(de,"Promise"),Wa=Fn(de,"Set"),qa=Fn(de,"WeakMap"),mn=Fn(Object,"create"),wc=si(gn),ja=si(Be),yc=si(Fi),bc=si(Wa),xc=si(qa),_c=ft?ft.prototype:void 0,Va=_c?_c.valueOf:void 0;function Jr(L){var J=-1,xe=L==null?0:L.length;for(this.clear();++J<xe;){var Ze=L[J];this.set(Ze[0],Ze[1])}}c(Jr,"Hash");function _u(){this.__data__=mn?mn(null):{},this.size=0}c(_u,"hashClear");function Su(L){var J=this.has(L)&&delete this.__data__[L];return this.size-=J?1:0,J}c(Su,"hashDelete");function Cu(L){var J=this.__data__;if(mn){var xe=J[L];return xe===M?void 0:xe}return w.call(J,L)?J[L]:void 0}c(Cu,"hashGet");function Ga(L){var J=this.__data__;return mn?J[L]!==void 0:w.call(J,L)}c(Ga,"hashHas");function Sc(L,J){var xe=this.__data__;return this.size+=this.has(L)?0:1,xe[L]=mn&&J===void 0?M:J,this}c(Sc,"hashSet"),Jr.prototype.clear=_u,Jr.prototype.delete=Su,Jr.prototype.get=Cu,Jr.prototype.has=Ga,Jr.prototype.set=Sc;function vn(L){var J=-1,xe=L==null?0:L.length;for(this.clear();++J<xe;){var Ze=L[J];this.set(Ze[0],Ze[1])}}c(vn,"ListCache");function gp(){this.__data__=[],this.size=0}c(gp,"listCacheClear");function Eu(L){var J=this.__data__,xe=oo(J,L);if(xe<0)return!1;var Ze=J.length-1;return xe==Ze?J.pop():jt.call(J,xe,1),--this.size,!0}c(Eu,"listCacheDelete");function Ru(L){var J=this.__data__,xe=oo(J,L);return xe<0?void 0:J[xe][1]}c(Ru,"listCacheGet");function Au(L){return oo(this.__data__,L)>-1}c(Au,"listCacheHas");function Br(L,J){var xe=this.__data__,Ze=oo(xe,L);return Ze<0?(++this.size,xe.push([L,J])):xe[Ze][1]=J,this}c(Br,"listCacheSet"),vn.prototype.clear=gp,vn.prototype.delete=Eu,vn.prototype.get=Ru,vn.prototype.has=Au,vn.prototype.set=Br;function Ot(L){var J=-1,xe=L==null?0:L.length;for(this.clear();++J<xe;){var Ze=L[J];this.set(Ze[0],Ze[1])}}c(Ot,"MapCache");function Dt(){this.size=0,this.__data__={hash:new Jr,map:new(Be||vn),string:new Jr}}c(Dt,"mapCacheClear");function wn(L){var J=Za(this,L).delete(L);return this.size-=J?1:0,J}c(wn,"mapCacheDelete");function Tu(L){return Za(this,L).get(L)}c(Tu,"mapCacheGet");function ku(L){return Za(this,L).has(L)}c(ku,"mapCacheHas");function Iu(L,J){var xe=Za(this,L),Ze=xe.size;return xe.set(L,J),this.size+=xe.size==Ze?0:1,this}c(Iu,"mapCacheSet"),Ot.prototype.clear=Dt,Ot.prototype.delete=wn,Ot.prototype.get=Tu,Ot.prototype.has=ku,Ot.prototype.set=Iu;function Ka(L){var J=-1,xe=L==null?0:L.length;for(this.__data__=new Ot;++J<xe;)this.add(L[J])}c(Ka,"SetCache");function Cc(L){return this.__data__.set(L,M),this}c(Cc,"setCacheAdd");function Ec(L){return this.__data__.has(L)}c(Ec,"setCacheHas"),Ka.prototype.add=Ka.prototype.push=Cc,Ka.prototype.has=Ec;function yn(L){var J=this.__data__=new vn(L);this.size=J.size}c(yn,"Stack");function Ho(){this.__data__=new vn,this.size=0}c(Ho,"stackClear");function mp(L){var J=this.__data__,xe=J.delete(L);return this.size=J.size,xe}c(mp,"stackDelete");function vp(L){return this.__data__.get(L)}c(vp,"stackGet");function zo(L){return this.__data__.has(L)}c(zo,"stackHas");function Du(L,J){var xe=this.__data__;if(xe instanceof vn){var Ze=xe.__data__;if(!Be||Ze.length<I-1)return Ze.push([L,J]),this.size=++xe.size,this;xe=this.__data__=new Ot(Ze)}return xe.set(L,J),this.size=xe.size,this}c(Du,"stackSet"),yn.prototype.clear=Ho,yn.prototype.delete=mp,yn.prototype.get=vp,yn.prototype.has=zo,yn.prototype.set=Du;function wp(L,J){var xe=Ni(L),Ze=!xe&&Lu(L),Ut=!xe&&!Ze&&Tc(L),pt=!xe&&!Ze&&!Ut&&Ic(L),Vt=xe||Ze||Ut||pt,lr=Vt?Ve(L.length,String):[],wr=lr.length;for(var Xt in L)(J||w.call(L,Xt))&&!(Vt&&(Xt=="length"||Ut&&(Xt=="offset"||Xt=="parent")||pt&&(Xt=="buffer"||Xt=="byteLength"||Xt=="byteOffset")||Ou(Xt,wr)))&&lr.push(Xt);return lr}c(wp,"arrayLikeKeys");function oo(L,J){for(var xe=L.length;xe--;)if(jo(L[xe][0],J))return xe;return-1}c(oo,"assocIndexOf");function yp(L,J,xe){var Ze=J(L);return Ni(L)?Ze:xr(Ze,xe(L))}c(yp,"baseGetAllKeys");function $i(L){return L==null?L===void 0?le:Ce:dt&&dt in Object(L)?qo(L):Uu(L)}c($i,"baseGetTag");function Pu(L){return Mi(L)&&$i(L)==N}c(Pu,"baseIsArguments");function ao(L,J,xe,Ze,Ut){return L===J?!0:L==null||J==null||!Mi(L)&&!Mi(J)?L!==L&&J!==J:bn(L,J,xe,Ze,ao,Ut)}c(ao,"baseIsEqual");function bn(L,J,xe,Ze,Ut,pt){var Vt=Ni(L),lr=Ni(J),wr=Vt?v:Wr(L),Xt=lr?v:Wr(J);wr=wr==N?K:wr,Xt=Xt==N?K:Xt;var _r=wr==K,Zr=Xt==K,ur=wr==Xt;if(ur&&Tc(L)){if(!Tc(J))return!1;Vt=!0,_r=!1}if(ur&&!_r)return pt||(pt=new yn),Vt||Ic(L)?Wo(L,J,xe,Ze,Ut,pt):Mu(L,J,wr,xe,Ze,Ut,pt);if(!(xe&B)){var Xr=_r&&w.call(L,"__wrapped__"),qr=Zr&&w.call(J,"__wrapped__");if(Xr||qr){var en=Xr?L.value():L,$n=qr?J.value():J;return pt||(pt=new yn),Ut(en,$n,xe,Ze,pt)}}return ur?(pt||(pt=new yn),Bu(L,J,xe,Ze,Ut,pt)):!1}c(bn,"baseIsEqualDeep");function Fu(L){if(!Qa(L)||xp(L))return!1;var J=Xa(L)?se:te;return J.test(si(L))}c(Fu,"baseIsNative");function $u(L){return Mi(L)&&so(L.length)&&!!Ge[$i(L)]}c($u,"baseIsTypedArray");function Nu(L){if(!Ac(L))return xu(L);var J=[];for(var xe in Object(L))w.call(L,xe)&&xe!="constructor"&&J.push(xe);return J}c(Nu,"baseKeys");function Wo(L,J,xe,Ze,Ut,pt){var Vt=xe&B,lr=L.length,wr=J.length;if(lr!=wr&&!(Vt&&wr>lr))return!1;var Xt=pt.get(L);if(Xt&&pt.get(J))return Xt==J;var _r=-1,Zr=!0,ur=xe&q?new Ka:void 0;for(pt.set(L,J),pt.set(J,L);++_r<lr;){var Xr=L[_r],qr=J[_r];if(Ze)var en=Vt?Ze(qr,Xr,_r,J,L,pt):Ze(Xr,qr,_r,L,J,pt);if(en!==void 0){if(en)continue;Zr=!1;break}if(ur){if(!ir(J,function($n,ci){if(!Pn(ur,ci)&&(Xr===$n||Ut(Xr,$n,xe,Ze,pt)))return ur.push(ci)})){Zr=!1;break}}else if(!(Xr===qr||Ut(Xr,qr,xe,Ze,pt))){Zr=!1;break}}return pt.delete(L),pt.delete(J),Zr}c(Wo,"equalArrays");function Mu(L,J,xe,Ze,Ut,pt,Vt){switch(xe){case De:if(L.byteLength!=J.byteLength||L.byteOffset!=J.byteOffset)return!1;L=L.buffer,J=J.buffer;case ve:return!(L.byteLength!=J.byteLength||!pt(new zt(L),new zt(J)));case T:case _:case ie:return jo(+L,+J);case F:return L.name==J.name&&L.message==J.message;case C:case H:return L==J+"";case Z:var lr=at;case G:var wr=Ze&B;if(lr||(lr=Oe),L.size!=J.size&&!wr)return!1;var Xt=Vt.get(L);if(Xt)return Xt==J;Ze|=q,Vt.set(L,J);var _r=Wo(lr(L),lr(J),Ze,Ut,pt,Vt);return Vt.delete(L),_r;case ue:if(Va)return Va.call(L)==Va.call(J)}return!1}c(Mu,"equalByTag");function Bu(L,J,xe,Ze,Ut,pt){var Vt=xe&B,lr=ai(L),wr=lr.length,Xt=ai(J),_r=Xt.length;if(wr!=_r&&!Vt)return!1;for(var Zr=wr;Zr--;){var ur=lr[Zr];if(!(Vt?ur in J:w.call(J,ur)))return!1}var Xr=pt.get(L);if(Xr&&pt.get(J))return Xr==J;var qr=!0;pt.set(L,J),pt.set(J,L);for(var en=Vt;++Zr<wr;){ur=lr[Zr];var $n=L[ur],ci=J[ur];if(Ze)var Wu=Vt?Ze(ci,$n,ur,J,L,pt):Ze($n,ci,ur,L,J,pt);if(!(Wu===void 0?$n===ci||Ut($n,ci,xe,Ze,pt):Wu)){qr=!1;break}en||(en=ur=="constructor")}if(qr&&!en){var Ja=L.constructor,es=J.constructor;Ja!=es&&"constructor"in L&&"constructor"in J&&!(typeof Ja=="function"&&Ja instanceof Ja&&typeof es=="function"&&es instanceof es)&&(qr=!1)}return pt.delete(L),pt.delete(J),qr}c(Bu,"equalObjects");function ai(L){return yp(L,zu,bp)}c(ai,"getAllKeys");function Za(L,J){var xe=L.__data__;return Rc(J)?xe[typeof J=="string"?"string":"hash"]:xe.map}c(Za,"getMapData");function Fn(L,J){var xe=Ie(L,J);return Fu(xe)?xe:void 0}c(Fn,"getNative");function qo(L){var J=w.call(L,dt),xe=L[dt];try{L[dt]=void 0;var Ze=!0}catch(pt){}var Ut=X.call(L);return Ze&&(J?L[dt]=xe:delete L[dt]),Ut}c(qo,"getRawTag");var bp=Pi?function(L){return L==null?[]:(L=Object(L),Jt(Pi(L),function(J){return Mt.call(L,J)}))}:Dc,Wr=$i;(gn&&Wr(new gn(new ArrayBuffer(1)))!=De||Be&&Wr(new Be)!=Z||Fi&&Wr(Fi.resolve())!=Q||Wa&&Wr(new Wa)!=G||qa&&Wr(new qa)!=ce)&&(Wr=c(function(L){var J=$i(L),xe=J==K?L.constructor:void 0,Ze=xe?si(xe):"";if(Ze)switch(Ze){case wc:return De;case ja:return Z;case yc:return Q;case bc:return G;case xc:return ce}return J},"getTag"));function Ou(L,J){return J=J==null?V:J,!!J&&(typeof L=="number"||gt.test(L))&&L>-1&&L%1==0&&L<J}c(Ou,"isIndex");function Rc(L){var J=typeof L;return J=="string"||J=="number"||J=="symbol"||J=="boolean"?L!=="__proto__":L===null}c(Rc,"isKeyable");function xp(L){return!!U&&U in L}c(xp,"isMasked");function Ac(L){var J=L&&L.constructor,xe=typeof J=="function"&&J.prototype||At;return L===xe}c(Ac,"isPrototype");function Uu(L){return X.call(L)}c(Uu,"objectToString");function si(L){if(L!=null){try{return m.call(L)}catch(J){}try{return L+""}catch(J){}}return""}c(si,"toSource");function jo(L,J){return L===J||L!==L&&J!==J}c(jo,"eq");var Lu=Pu(function(){return arguments}())?Pu:function(L){return Mi(L)&&w.call(L,"callee")&&!Mt.call(L,"callee")},Ni=Array.isArray;function Hu(L){return L!=null&&so(L.length)&&!Xa(L)}c(Hu,"isArrayLike");var Tc=za||Ya;function kc(L,J){return ao(L,J)}c(kc,"isEqual");function Xa(L){if(!Qa(L))return!1;var J=$i(L);return J==j||J==P||J==R||J==Y}c(Xa,"isFunction");function so(L){return typeof L=="number"&&L>-1&&L%1==0&&L<=V}c(so,"isLength");function Qa(L){var J=typeof L;return L!=null&&(J=="object"||J=="function")}c(Qa,"isObject");function Mi(L){return L!=null&&typeof L=="object"}c(Mi,"isObjectLike");var Ic=It?ke(It):$u;function zu(L){return Hu(L)?wp(L):Nu(L)}c(zu,"keys");function Dc(){return[]}c(Dc,"stubArray");function Ya(){return!1}c(Ya,"stubFalse"),h.exports=kc},850:(h,A,O)=>{"use strict";const I=O(7170),M=O(6744),B=O(9444),q=O(8702),V=c(v=>v===""||v==="./","isEmptyString"),N=c((v,R,T)=>{R=[].concat(R),v=[].concat(v);let _=new Set,F=new Set,j=new Set,P=0,Z=c(K=>{j.add(K.output),T&&T.onResult&&T.onResult(K)},"onResult");for(let K=0;K<R.length;K++){let Q=B(String(R[K]),{...T,onResult:Z},!0),Y=Q.state.negated||Q.state.negatedExtglob;Y&&P++;for(let C of v){let G=Q(C,!0);!(Y?!G.isMatch:G.isMatch)||(Y?_.add(G.output):(_.delete(G.output),F.add(G.output)))}}let Ce=(P===R.length?[...j]:[...F]).filter(K=>!_.has(K));if(T&&Ce.length===0){if(T.failglob===!0)throw new Error(`No matches found for "${R.join(", ")}"`);if(T.nonull===!0||T.nullglob===!0)return T.unescape?R.map(K=>K.replace(/\\/g,"")):R}return Ce},"micromatch");N.match=N,N.matcher=(v,R)=>B(v,R),N.isMatch=(v,R,T)=>B(R,T)(v),N.any=N.isMatch,N.not=(v,R,T={})=>{R=[].concat(R).map(String);let _=new Set,F=[],P=N(v,R,{...T,onResult:c(Z=>{T.onResult&&T.onResult(Z),F.push(Z.output)},"onResult")});for(let Z of F)P.includes(Z)||_.add(Z);return[..._]},N.contains=(v,R,T)=>{if(typeof v!="string")throw new TypeError(`Expected a string: "${I.inspect(v)}"`);if(Array.isArray(R))return R.some(_=>N.contains(v,_,T));if(typeof R=="string"){if(V(v)||V(R))return!1;if(v.includes(R)||v.startsWith("./")&&v.slice(2).includes(R))return!0}return N.isMatch(v,R,{...T,contains:!0})},N.matchKeys=(v,R,T)=>{if(!q.isObject(v))throw new TypeError("Expected the first argument to be an object");let _=N(Object.keys(v),R,T),F={};for(let j of _)F[j]=v[j];return F},N.some=(v,R,T)=>{let _=[].concat(v);for(let F of[].concat(R)){let j=B(String(F),T);if(_.some(P=>j(P)))return!0}return!1},N.every=(v,R,T)=>{let _=[].concat(v);for(let F of[].concat(R)){let j=B(String(F),T);if(!_.every(P=>j(P)))return!1}return!0},N.all=(v,R,T)=>{if(typeof v!="string")throw new TypeError(`Expected a string: "${I.inspect(v)}"`);return[].concat(R).every(_=>B(_,T)(v))},N.capture=(v,R,T)=>{let _=q.isWindows(T),j=B.makeRe(String(v),{...T,capture:!0}).exec(_?q.toPosixSlashes(R):R);if(j)return j.slice(1).map(P=>P===void 0?"":P)},N.makeRe=(...v)=>B.makeRe(...v),N.scan=(...v)=>B.scan(...v),N.parse=(v,R)=>{let T=[];for(let _ of[].concat(v||[]))for(let F of M(String(_),R))T.push(B.parse(F,R));return T},N.braces=(v,R)=>{if(typeof v!="string")throw new TypeError("Expected a string");return R&&R.nobrace===!0||!/\{.*\}/.test(v)?[v]:M(v,R)},N.braceExpand=(v,R)=>{if(typeof v!="string")throw new TypeError("Expected a string");return N.braces(v,{...R,expand:!0})},h.exports=N},447:(h,A,O)=>{var I=O(2479);h.exports=I(M),h.exports.strict=I(B),M.proto=M(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return M(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return B(this)},configurable:!0})});function M(q){var V=c(function(){return V.called?V.value:(V.called=!0,V.value=q.apply(this,arguments))},"f");return V.called=!1,V}c(M,"once");function B(q){var V=c(function(){if(V.called)throw new Error(V.onceError);return V.called=!0,V.value=q.apply(this,arguments)},"f"),N=q.name||"Function wrapped with `once`";return V.onceError=N+" shouldn't be called more than once",V.called=!1,V}c(B,"onceStrict")},6470:(h,A,O)=>{"use strict";var I=O(4155);function M(N){if(typeof N!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(N))}c(M,"assertPath");function B(N,v){for(var R="",T=0,_=-1,F=0,j,P=0;P<=N.length;++P){if(P<N.length)j=N.charCodeAt(P);else{if(j===47)break;j=47}if(j===47){if(!(_===P-1||F===1))if(_!==P-1&&F===2){if(R.length<2||T!==2||R.charCodeAt(R.length-1)!==46||R.charCodeAt(R.length-2)!==46){if(R.length>2){var Z=R.lastIndexOf("/");if(Z!==R.length-1){Z===-1?(R="",T=0):(R=R.slice(0,Z),T=R.length-1-R.lastIndexOf("/")),_=P,F=0;continue}}else if(R.length===2||R.length===1){R="",T=0,_=P,F=0;continue}}v&&(R.length>0?R+="/..":R="..",T=2)}else R.length>0?R+="/"+N.slice(_+1,P):R=N.slice(_+1,P),T=P-_-1;_=P,F=0}else j===46&&F!==-1?++F:F=-1}return R}c(B,"normalizeStringPosix");function q(N,v){var R=v.dir||v.root,T=v.base||(v.name||"")+(v.ext||"");return R?R===v.root?R+T:R+N+T:T}c(q,"_format");var V={resolve:c(function(){for(var v="",R=!1,T,_=arguments.length-1;_>=-1&&!R;_--){var F;_>=0?F=arguments[_]:(T===void 0&&(T=I.cwd()),F=T),M(F),F.length!==0&&(v=F+"/"+v,R=F.charCodeAt(0)===47)}return v=B(v,!R),R?v.length>0?"/"+v:"/":v.length>0?v:"."},"resolve"),normalize:c(function(v){if(M(v),v.length===0)return".";var R=v.charCodeAt(0)===47,T=v.charCodeAt(v.length-1)===47;return v=B(v,!R),v.length===0&&!R&&(v="."),v.length>0&&T&&(v+="/"),R?"/"+v:v},"normalize"),isAbsolute:c(function(v){return M(v),v.length>0&&v.charCodeAt(0)===47},"isAbsolute"),join:c(function(){if(arguments.length===0)return".";for(var v,R=0;R<arguments.length;++R){var T=arguments[R];M(T),T.length>0&&(v===void 0?v=T:v+="/"+T)}return v===void 0?".":V.normalize(v)},"join"),relative:c(function(v,R){if(M(v),M(R),v===R||(v=V.resolve(v),R=V.resolve(R),v===R))return"";for(var T=1;T<v.length&&v.charCodeAt(T)===47;++T);for(var _=v.length,F=_-T,j=1;j<R.length&&R.charCodeAt(j)===47;++j);for(var P=R.length,Z=P-j,ie=F<Z?F:Z,Ce=-1,K=0;K<=ie;++K){if(K===ie){if(Z>ie){if(R.charCodeAt(j+K)===47)return R.slice(j+K+1);if(K===0)return R.slice(j+K)}else F>ie&&(v.charCodeAt(T+K)===47?Ce=K:K===0&&(Ce=0));break}var Q=v.charCodeAt(T+K),Y=R.charCodeAt(j+K);if(Q!==Y)break;Q===47&&(Ce=K)}var C="";for(K=T+Ce+1;K<=_;++K)(K===_||v.charCodeAt(K)===47)&&(C.length===0?C+="..":C+="/..");return C.length>0?C+R.slice(j+Ce):(j+=Ce,R.charCodeAt(j)===47&&++j,R.slice(j))},"relative"),_makeLong:c(function(v){return v},"_makeLong"),dirname:c(function(v){if(M(v),v.length===0)return".";for(var R=v.charCodeAt(0),T=R===47,_=-1,F=!0,j=v.length-1;j>=1;--j)if(R=v.charCodeAt(j),R===47){if(!F){_=j;break}}else F=!1;return _===-1?T?"/":".":T&&_===1?"//":v.slice(0,_)},"dirname"),basename:c(function(v,R){if(R!==void 0&&typeof R!="string")throw new TypeError('"ext" argument must be a string');M(v);var T=0,_=-1,F=!0,j;if(R!==void 0&&R.length>0&&R.length<=v.length){if(R.length===v.length&&R===v)return"";var P=R.length-1,Z=-1;for(j=v.length-1;j>=0;--j){var ie=v.charCodeAt(j);if(ie===47){if(!F){T=j+1;break}}else Z===-1&&(F=!1,Z=j+1),P>=0&&(ie===R.charCodeAt(P)?--P==-1&&(_=j):(P=-1,_=Z))}return T===_?_=Z:_===-1&&(_=v.length),v.slice(T,_)}else{for(j=v.length-1;j>=0;--j)if(v.charCodeAt(j)===47){if(!F){T=j+1;break}}else _===-1&&(F=!1,_=j+1);return _===-1?"":v.slice(T,_)}},"basename"),extname:c(function(v){M(v);for(var R=-1,T=0,_=-1,F=!0,j=0,P=v.length-1;P>=0;--P){var Z=v.charCodeAt(P);if(Z===47){if(!F){T=P+1;break}continue}_===-1&&(F=!1,_=P+1),Z===46?R===-1?R=P:j!==1&&(j=1):R!==-1&&(j=-1)}return R===-1||_===-1||j===0||j===1&&R===_-1&&R===T+1?"":v.slice(R,_)},"extname"),format:c(function(v){if(v===null||typeof v!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof v);return q("/",v)},"format"),parse:c(function(v){M(v);var R={root:"",dir:"",base:"",ext:"",name:""};if(v.length===0)return R;var T=v.charCodeAt(0),_=T===47,F;_?(R.root="/",F=1):F=0;for(var j=-1,P=0,Z=-1,ie=!0,Ce=v.length-1,K=0;Ce>=F;--Ce){if(T=v.charCodeAt(Ce),T===47){if(!ie){P=Ce+1;break}continue}Z===-1&&(ie=!1,Z=Ce+1),T===46?j===-1?j=Ce:K!==1&&(K=1):j!==-1&&(K=-1)}return j===-1||Z===-1||K===0||K===1&&j===Z-1&&j===P+1?Z!==-1&&(P===0&&_?R.base=R.name=v.slice(1,Z):R.base=R.name=v.slice(P,Z)):(P===0&&_?(R.name=v.slice(1,j),R.base=v.slice(1,Z)):(R.name=v.slice(P,j),R.base=v.slice(P,Z)),R.ext=v.slice(j,Z)),P>0?R.dir=v.slice(0,P-1):_&&(R.dir="/"),R},"parse"),sep:"/",delimiter:":",win32:null,posix:null};V.posix=V,h.exports=V},7279:(h,A)=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.EndOfStreamError=A.defaultMessages=void 0,A.defaultMessages="End-Of-Stream";class O extends Error{constructor(){super(A.defaultMessages)}}c(O,"EndOfStreamError"),A.EndOfStreamError=O},5167:(h,A,O)=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.StreamReader=A.EndOfStreamError=void 0;const I=O(7279);var M=O(7279);Object.defineProperty(A,"EndOfStreamError",{enumerable:!0,get:function(){return M.EndOfStreamError}});class B{constructor(){this.resolve=()=>null,this.reject=()=>null,this.promise=new Promise((v,R)=>{this.reject=R,this.resolve=v})}}c(B,"Deferred");const q=1*1024*1024;class V{constructor(v){if(this.s=v,this.request=null,this.endOfStream=!1,this.peekQueue=[],!v.read||!v.once)throw new Error("Expected an instance of stream.Readable");this.s.once("end",()=>this.reject(new I.EndOfStreamError)),this.s.once("error",R=>this.reject(R)),this.s.once("close",()=>this.reject(new Error("Stream closed")))}async peek(v,R,T){const _=await this.read(v,R,T);return this.peekQueue.push(v.subarray(R,R+_)),_}async read(v,R,T){if(T===0)return 0;if(this.peekQueue.length===0&&this.endOfStream)throw new I.EndOfStreamError;let _=T,F=0;for(;this.peekQueue.length>0&&_>0;){const j=this.peekQueue.pop();if(!j)throw new Error("peekData should be defined");const P=Math.min(j.length,_);v.set(j.subarray(0,P),R+F),F+=P,_-=P,P<j.length&&this.peekQueue.push(j.subarray(P))}for(;_>0&&!this.endOfStream;){const j=Math.min(_,q),P=await this._read(v,R+F,j);if(F+=P,P<j)break;_-=P}return F}async _read(v,R,T){if(this.request)throw new Error("Concurrent read operation?");const _=this.s.read(T);return _?(v.set(_,R),_.length):(this.request={buffer:v,offset:R,length:T,deferred:new B},this.s.once("readable",()=>{this.tryRead()}),this.request.deferred.promise)}tryRead(){if(!this.request)throw new Error("this.request should be defined");const v=this.s.read(this.request.length);v?(this.request.buffer.set(v,this.request.offset),this.request.deferred.resolve(v.length),this.request=null):this.s.once("readable",()=>{this.tryRead()})}reject(v){this.endOfStream=!0,this.request&&(this.request.deferred.reject(v),this.request=null)}}c(V,"StreamReader"),A.StreamReader=V},9444:(h,A,O)=>{"use strict";h.exports=O(6087)},1006:(h,A,O)=>{"use strict";const I=O(6470),M="\\\\/",B=`[^${M}]`,q="\\.",V="\\+",N="\\?",v="\\/",R="(?=.)",T="[^/]",_=`(?:${v}|$)`,F=`(?:^|${v})`,j=`${q}{1,2}${_}`,P=`(?!${q})`,Z=`(?!${F}${j})`,ie=`(?!${q}{0,1}${_})`,Ce=`(?!${j})`,K=`[^.${v}]`,Q=`${T}*?`,Y={DOT_LITERAL:q,PLUS_LITERAL:V,QMARK_LITERAL:N,SLASH_LITERAL:v,ONE_CHAR:R,QMARK:T,END_ANCHOR:_,DOTS_SLASH:j,NO_DOT:P,NO_DOTS:Z,NO_DOT_SLASH:ie,NO_DOTS_SLASH:Ce,QMARK_NO_DOT:K,STAR:Q,START_ANCHOR:F},C={...Y,SLASH_LITERAL:`[${M}]`,QMARK:B,STAR:`${B}*?`,DOTS_SLASH:`${q}{1,2}(?:[${M}]|$)`,NO_DOT:`(?!${q})`,NO_DOTS:`(?!(?:^|[${M}])${q}{1,2}(?:[${M}]|$))`,NO_DOT_SLASH:`(?!${q}{0,1}(?:[${M}]|$))`,NO_DOTS_SLASH:`(?!${q}{1,2}(?:[${M}]|$))`,QMARK_NO_DOT:`[^.${M}]`,START_ANCHOR:`(?:^|[${M}])`,END_ANCHOR:`(?:[${M}]|$)`},G={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};h.exports={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:G,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:I.sep,extglobChars(H){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${H.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(H){return H===!0?C:Y}}},3376:(h,A,O)=>{"use strict";const I=O(1006),M=O(8702),{MAX_LENGTH:B,POSIX_REGEX_SOURCE:q,REGEX_NON_SPECIAL_CHARS:V,REGEX_SPECIAL_CHARS_BACKREF:N,REPLACEMENTS:v}=I,R=c((F,j)=>{if(typeof j.expandRange=="function")return j.expandRange(...F,j);F.sort();const P=`[${F.join("-")}]`;try{new RegExp(P)}catch(Z){return F.map(ie=>M.escapeRegex(ie)).join("..")}return P},"expandRange"),T=c((F,j)=>`Missing ${F}: "${j}" - use "\\\\${j}" to match literal characters`,"syntaxError"),_=c((F,j)=>{if(typeof F!="string")throw new TypeError("Expected a string");F=v[F]||F;const P={...j},Z=typeof P.maxLength=="number"?Math.min(B,P.maxLength):B;let ie=F.length;if(ie>Z)throw new SyntaxError(`Input length: ${ie}, exceeds maximum allowed length: ${Z}`);const Ce={type:"bos",value:"",output:P.prepend||""},K=[Ce],Q=P.capture?"":"?:",Y=M.isWindows(j),C=I.globChars(Y),G=I.extglobChars(C),{DOT_LITERAL:H,PLUS_LITERAL:ue,SLASH_LITERAL:le,ONE_CHAR:ce,DOTS_SLASH:ve,NO_DOT:De,NO_DOT_SLASH:Ue,NO_DOTS_SLASH:qe,QMARK:_e,QMARK_NO_DOT:rt,STAR:lt,START_ANCHOR:Ke}=C,Se=c(Ie=>`(${Q}(?:(?!${Ke}${Ie.dot?ve:H}).)*?)`,"globstar"),he=P.dot?"":De,nt=P.dot?_e:rt;let Je=P.bash===!0?Se(P):lt;P.capture&&(Je=`(${Je})`),typeof P.noext=="boolean"&&(P.noextglob=P.noext);const te={input:F,index:-1,start:0,dot:P.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:K};F=M.removePrefix(F,te),ie=F.length;const gt=[],Ge=[],ot=[];let fe=Ce,de;const We=c(()=>te.index===ie-1,"eos"),Qe=te.peek=(Ie=1)=>F[te.index+Ie],mt=te.advance=()=>F[++te.index]||"",Zt=c(()=>F.slice(te.index+1),"remaining"),yt=c((Ie="",at=0)=>{te.consumed+=Ie,te.index+=at},"consume"),It=c(Ie=>{te.output+=Ie.output!=null?Ie.output:Ie.value,yt(Ie.value)},"append"),Jt=c(()=>{let Ie=1;for(;Qe()==="!"&&(Qe(2)!=="("||Qe(3)==="?");)mt(),te.start++,Ie++;return Ie%2==0?!1:(te.negated=!0,te.start++,!0)},"negate"),xr=c(Ie=>{te[Ie]++,ot.push(Ie)},"increment"),ir=c(Ie=>{te[Ie]--,ot.pop()},"decrement"),Ve=c(Ie=>{if(fe.type==="globstar"){const at=te.braces>0&&(Ie.type==="comma"||Ie.type==="brace"),Ae=Ie.extglob===!0||gt.length&&(Ie.type==="pipe"||Ie.type==="paren");Ie.type!=="slash"&&Ie.type!=="paren"&&!at&&!Ae&&(te.output=te.output.slice(0,-fe.output.length),fe.type="star",fe.value="*",fe.output=Je,te.output+=fe.output)}if(gt.length&&Ie.type!=="paren"&&(gt[gt.length-1].inner+=Ie.value),(Ie.value||Ie.output)&&It(Ie),fe&&fe.type==="text"&&Ie.type==="text"){fe.value+=Ie.value,fe.output=(fe.output||"")+Ie.value;return}Ie.prev=fe,K.push(Ie),fe=Ie},"push"),ke=c((Ie,at)=>{const Ae={...G[at],conditions:1,inner:""};Ae.prev=fe,Ae.parens=te.parens,Ae.output=te.output;const Oe=(P.capture?"(":"")+Ae.open;xr("parens"),Ve({type:Ie,value:at,output:te.output?"":ce}),Ve({type:"paren",extglob:!0,value:mt(),output:Oe}),gt.push(Ae)},"extglobOpen"),Pn=c(Ie=>{let at=Ie.close+(P.capture?")":""),Ae;if(Ie.type==="negate"){let Oe=Je;Ie.inner&&Ie.inner.length>1&&Ie.inner.includes("/")&&(Oe=Se(P)),(Oe!==Je||We()||/^\)+$/.test(Zt()))&&(at=Ie.close=`)$))${Oe}`),Ie.inner.includes("*")&&(Ae=Zt())&&/^\.[^\\/.]+$/.test(Ae)&&(at=Ie.close=`)${Ae})${Oe})`),Ie.prev.type==="bos"&&(te.negatedExtglob=!0)}Ve({type:"paren",extglob:!0,value:de,output:at}),ir("parens")},"extglobClose");if(P.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(F)){let Ie=!1,at=F.replace(N,(Ae,Oe,Nt,bt,At,k)=>bt==="\\"?(Ie=!0,Ae):bt==="?"?Oe?Oe+bt+(At?_e.repeat(At.length):""):k===0?nt+(At?_e.repeat(At.length):""):_e.repeat(Nt.length):bt==="."?H.repeat(Nt.length):bt==="*"?Oe?Oe+bt+(At?Je:""):Je:Oe?Ae:`\\${Ae}`);return Ie===!0&&(P.unescape===!0?at=at.replace(/\\/g,""):at=at.replace(/\\+/g,Ae=>Ae.length%2==0?"\\\\":Ae?"\\":"")),at===F&&P.contains===!0?(te.output=F,te):(te.output=M.wrapOutput(at,te,j),te)}for(;!We();){if(de=mt(),de==="\0")continue;if(de==="\\"){const Ae=Qe();if(Ae==="/"&&P.bash!==!0||Ae==="."||Ae===";")continue;if(!Ae){de+="\\",Ve({type:"text",value:de});continue}const Oe=/^\\+/.exec(Zt());let Nt=0;if(Oe&&Oe[0].length>2&&(Nt=Oe[0].length,te.index+=Nt,Nt%2!=0&&(de+="\\")),P.unescape===!0?de=mt():de+=mt(),te.brackets===0){Ve({type:"text",value:de});continue}}if(te.brackets>0&&(de!=="]"||fe.value==="["||fe.value==="[^")){if(P.posix!==!1&&de===":"){const Ae=fe.value.slice(1);if(Ae.includes("[")&&(fe.posix=!0,Ae.includes(":"))){const Oe=fe.value.lastIndexOf("["),Nt=fe.value.slice(0,Oe),bt=fe.value.slice(Oe+2),At=q[bt];if(At){fe.value=Nt+At,te.backtrack=!0,mt(),!Ce.output&&K.indexOf(fe)===1&&(Ce.output=ce);continue}}}(de==="["&&Qe()!==":"||de==="-"&&Qe()==="]")&&(de=`\\${de}`),de==="]"&&(fe.value==="["||fe.value==="[^")&&(de=`\\${de}`),P.posix===!0&&de==="!"&&fe.value==="["&&(de="^"),fe.value+=de,It({value:de});continue}if(te.quotes===1&&de!=='"'){de=M.escapeRegex(de),fe.value+=de,It({value:de});continue}if(de==='"'){te.quotes=te.quotes===1?0:1,P.keepQuotes===!0&&Ve({type:"text",value:de});continue}if(de==="("){xr("parens"),Ve({type:"paren",value:de});continue}if(de===")"){if(te.parens===0&&P.strictBrackets===!0)throw new SyntaxError(T("opening","("));const Ae=gt[gt.length-1];if(Ae&&te.parens===Ae.parens+1){Pn(gt.pop());continue}Ve({type:"paren",value:de,output:te.parens?")":"\\)"}),ir("parens");continue}if(de==="["){if(P.nobracket===!0||!Zt().includes("]")){if(P.nobracket!==!0&&P.strictBrackets===!0)throw new SyntaxError(T("closing","]"));de=`\\${de}`}else xr("brackets");Ve({type:"bracket",value:de});continue}if(de==="]"){if(P.nobracket===!0||fe&&fe.type==="bracket"&&fe.value.length===1){Ve({type:"text",value:de,output:`\\${de}`});continue}if(te.brackets===0){if(P.strictBrackets===!0)throw new SyntaxError(T("opening","["));Ve({type:"text",value:de,output:`\\${de}`});continue}ir("brackets");const Ae=fe.value.slice(1);if(fe.posix!==!0&&Ae[0]==="^"&&!Ae.includes("/")&&(de=`/${de}`),fe.value+=de,It({value:de}),P.literalBrackets===!1||M.hasRegexChars(Ae))continue;const Oe=M.escapeRegex(fe.value);if(te.output=te.output.slice(0,-fe.value.length),P.literalBrackets===!0){te.output+=Oe,fe.value=Oe;continue}fe.value=`(${Q}${Oe}|${fe.value})`,te.output+=fe.value;continue}if(de==="{"&&P.nobrace!==!0){xr("braces");const Ae={type:"brace",value:de,output:"(",outputIndex:te.output.length,tokensIndex:te.tokens.length};Ge.push(Ae),Ve(Ae);continue}if(de==="}"){const Ae=Ge[Ge.length-1];if(P.nobrace===!0||!Ae){Ve({type:"text",value:de,output:de});continue}let Oe=")";if(Ae.dots===!0){const Nt=K.slice(),bt=[];for(let At=Nt.length-1;At>=0&&(K.pop(),Nt[At].type!=="brace");At--)Nt[At].type!=="dots"&&bt.unshift(Nt[At].value);Oe=R(bt,P),te.backtrack=!0}if(Ae.comma!==!0&&Ae.dots!==!0){const Nt=te.output.slice(0,Ae.outputIndex),bt=te.tokens.slice(Ae.tokensIndex);Ae.value=Ae.output="\\{",de=Oe="\\}",te.output=Nt;for(const At of bt)te.output+=At.output||At.value}Ve({type:"brace",value:de,output:Oe}),ir("braces"),Ge.pop();continue}if(de==="|"){gt.length>0&&gt[gt.length-1].conditions++,Ve({type:"text",value:de});continue}if(de===","){let Ae=de;const Oe=Ge[Ge.length-1];Oe&&ot[ot.length-1]==="braces"&&(Oe.comma=!0,Ae="|"),Ve({type:"comma",value:de,output:Ae});continue}if(de==="/"){if(fe.type==="dot"&&te.index===te.start+1){te.start=te.index+1,te.consumed="",te.output="",K.pop(),fe=Ce;continue}Ve({type:"slash",value:de,output:le});continue}if(de==="."){if(te.braces>0&&fe.type==="dot"){fe.value==="."&&(fe.output=H);const Ae=Ge[Ge.length-1];fe.type="dots",fe.output+=de,fe.value+=de,Ae.dots=!0;continue}if(te.braces+te.parens===0&&fe.type!=="bos"&&fe.type!=="slash"){Ve({type:"text",value:de,output:H});continue}Ve({type:"dot",value:de,output:H});continue}if(de==="?"){if(!(fe&&fe.value==="(")&&P.noextglob!==!0&&Qe()==="("&&Qe(2)!=="?"){ke("qmark",de);continue}if(fe&&fe.type==="paren"){const Oe=Qe();let Nt=de;if(Oe==="<"&&!M.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");(fe.value==="("&&!/[!=<:]/.test(Oe)||Oe==="<"&&!/<([!=]|\w+>)/.test(Zt()))&&(Nt=`\\${de}`),Ve({type:"text",value:de,output:Nt});continue}if(P.dot!==!0&&(fe.type==="slash"||fe.type==="bos")){Ve({type:"qmark",value:de,output:rt});continue}Ve({type:"qmark",value:de,output:_e});continue}if(de==="!"){if(P.noextglob!==!0&&Qe()==="("&&(Qe(2)!=="?"||!/[!=<:]/.test(Qe(3)))){ke("negate",de);continue}if(P.nonegate!==!0&&te.index===0){Jt();continue}}if(de==="+"){if(P.noextglob!==!0&&Qe()==="("&&Qe(2)!=="?"){ke("plus",de);continue}if(fe&&fe.value==="("||P.regex===!1){Ve({type:"plus",value:de,output:ue});continue}if(fe&&(fe.type==="bracket"||fe.type==="paren"||fe.type==="brace")||te.parens>0){Ve({type:"plus",value:de});continue}Ve({type:"plus",value:ue});continue}if(de==="@"){if(P.noextglob!==!0&&Qe()==="("&&Qe(2)!=="?"){Ve({type:"at",extglob:!0,value:de,output:""});continue}Ve({type:"text",value:de});continue}if(de!=="*"){(de==="$"||de==="^")&&(de=`\\${de}`);const Ae=V.exec(Zt());Ae&&(de+=Ae[0],te.index+=Ae[0].length),Ve({type:"text",value:de});continue}if(fe&&(fe.type==="globstar"||fe.star===!0)){fe.type="star",fe.star=!0,fe.value+=de,fe.output=Je,te.backtrack=!0,te.globstar=!0,yt(de);continue}let Ie=Zt();if(P.noextglob!==!0&&/^\([^?]/.test(Ie)){ke("star",de);continue}if(fe.type==="star"){if(P.noglobstar===!0){yt(de);continue}const Ae=fe.prev,Oe=Ae.prev,Nt=Ae.type==="slash"||Ae.type==="bos",bt=Oe&&(Oe.type==="star"||Oe.type==="globstar");if(P.bash===!0&&(!Nt||Ie[0]&&Ie[0]!=="/")){Ve({type:"star",value:de,output:""});continue}const At=te.braces>0&&(Ae.type==="comma"||Ae.type==="brace"),k=gt.length&&(Ae.type==="pipe"||Ae.type==="paren");if(!Nt&&Ae.type!=="paren"&&!At&&!k){Ve({type:"star",value:de,output:""});continue}for(;Ie.slice(0,3)==="/**";){const m=F[te.index+4];if(m&&m!=="/")break;Ie=Ie.slice(3),yt("/**",3)}if(Ae.type==="bos"&&We()){fe.type="globstar",fe.value+=de,fe.output=Se(P),te.output=fe.output,te.globstar=!0,yt(de);continue}if(Ae.type==="slash"&&Ae.prev.type!=="bos"&&!bt&&We()){te.output=te.output.slice(0,-(Ae.output+fe.output).length),Ae.output=`(?:${Ae.output}`,fe.type="globstar",fe.output=Se(P)+(P.strictSlashes?")":"|$)"),fe.value+=de,te.globstar=!0,te.output+=Ae.output+fe.output,yt(de);continue}if(Ae.type==="slash"&&Ae.prev.type!=="bos"&&Ie[0]==="/"){const m=Ie[1]!==void 0?"|$":"";te.output=te.output.slice(0,-(Ae.output+fe.output).length),Ae.output=`(?:${Ae.output}`,fe.type="globstar",fe.output=`${Se(P)}${le}|${le}${m})`,fe.value+=de,te.output+=Ae.output+fe.output,te.globstar=!0,yt(de+mt()),Ve({type:"slash",value:"/",output:""});continue}if(Ae.type==="bos"&&Ie[0]==="/"){fe.type="globstar",fe.value+=de,fe.output=`(?:^|${le}|${Se(P)}${le})`,te.output=fe.output,te.globstar=!0,yt(de+mt()),Ve({type:"slash",value:"/",output:""});continue}te.output=te.output.slice(0,-fe.output.length),fe.type="globstar",fe.output=Se(P),fe.value+=de,te.output+=fe.output,te.globstar=!0,yt(de);continue}const at={type:"star",value:de,output:Je};if(P.bash===!0){at.output=".*?",(fe.type==="bos"||fe.type==="slash")&&(at.output=he+at.output),Ve(at);continue}if(fe&&(fe.type==="bracket"||fe.type==="paren")&&P.regex===!0){at.output=de,Ve(at);continue}(te.index===te.start||fe.type==="slash"||fe.type==="dot")&&(fe.type==="dot"?(te.output+=Ue,fe.output+=Ue):P.dot===!0?(te.output+=qe,fe.output+=qe):(te.output+=he,fe.output+=he),Qe()!=="*"&&(te.output+=ce,fe.output+=ce)),Ve(at)}for(;te.brackets>0;){if(P.strictBrackets===!0)throw new SyntaxError(T("closing","]"));te.output=M.escapeLast(te.output,"["),ir("brackets")}for(;te.parens>0;){if(P.strictBrackets===!0)throw new SyntaxError(T("closing",")"));te.output=M.escapeLast(te.output,"("),ir("parens")}for(;te.braces>0;){if(P.strictBrackets===!0)throw new SyntaxError(T("closing","}"));te.output=M.escapeLast(te.output,"{"),ir("braces")}if(P.strictSlashes!==!0&&(fe.type==="star"||fe.type==="bracket")&&Ve({type:"maybe_slash",value:"",output:`${le}?`}),te.backtrack===!0){te.output="";for(const Ie of te.tokens)te.output+=Ie.output!=null?Ie.output:Ie.value,Ie.suffix&&(te.output+=Ie.suffix)}return te},"parse");_.fastpaths=(F,j)=>{const P={...j},Z=typeof P.maxLength=="number"?Math.min(B,P.maxLength):B,ie=F.length;if(ie>Z)throw new SyntaxError(`Input length: ${ie}, exceeds maximum allowed length: ${Z}`);F=v[F]||F;const Ce=M.isWindows(j),{DOT_LITERAL:K,SLASH_LITERAL:Q,ONE_CHAR:Y,DOTS_SLASH:C,NO_DOT:G,NO_DOTS:H,NO_DOTS_SLASH:ue,STAR:le,START_ANCHOR:ce}=I.globChars(Ce),ve=P.dot?H:G,De=P.dot?ue:G,Ue=P.capture?"":"?:",qe={negated:!1,prefix:""};let _e=P.bash===!0?".*?":le;P.capture&&(_e=`(${_e})`);const rt=c(he=>he.noglobstar===!0?_e:`(${Ue}(?:(?!${ce}${he.dot?C:K}).)*?)`,"globstar"),lt=c(he=>{switch(he){case"*":return`${ve}${Y}${_e}`;case".*":return`${K}${Y}${_e}`;case"*.*":return`${ve}${_e}${K}${Y}${_e}`;case"*/*":return`${ve}${_e}${Q}${Y}${De}${_e}`;case"**":return ve+rt(P);case"**/*":return`(?:${ve}${rt(P)}${Q})?${De}${Y}${_e}`;case"**/*.*":return`(?:${ve}${rt(P)}${Q})?${De}${_e}${K}${Y}${_e}`;case"**/.*":return`(?:${ve}${rt(P)}${Q})?${K}${Y}${_e}`;default:{const nt=/^(.*?)\.(\w+)$/.exec(he);if(!nt)return;const Je=lt(nt[1]);return Je?Je+K+nt[2]:void 0}}},"create"),Ke=M.removePrefix(F,qe);let Se=lt(Ke);return Se&&P.strictSlashes!==!0&&(Se+=`${Q}?`),Se},h.exports=_},6087:(h,A,O)=>{"use strict";const I=O(6470),M=O(3921),B=O(3376),q=O(8702),V=O(1006),N=c(R=>R&&typeof R=="object"&&!Array.isArray(R),"isObject"),v=c((R,T,_=!1)=>{if(Array.isArray(R)){const Q=R.map(C=>v(C,T,_));return c(C=>{for(const G of Q){const H=G(C);if(H)return H}return!1},"arrayMatcher")}const F=N(R)&&R.tokens&&R.input;if(R===""||typeof R!="string"&&!F)throw new TypeError("Expected pattern to be a non-empty string");const j=T||{},P=q.isWindows(T),Z=F?v.compileRe(R,T):v.makeRe(R,T,!1,!0),ie=Z.state;delete Z.state;let Ce=c(()=>!1,"isIgnored");if(j.ignore){const Q={...T,ignore:null,onMatch:null,onResult:null};Ce=v(j.ignore,Q,_)}const K=c((Q,Y=!1)=>{const{isMatch:C,match:G,output:H}=v.test(Q,Z,T,{glob:R,posix:P}),ue={glob:R,state:ie,regex:Z,posix:P,input:Q,output:H,match:G,isMatch:C};return typeof j.onResult=="function"&&j.onResult(ue),C===!1?(ue.isMatch=!1,Y?ue:!1):Ce(Q)?(typeof j.onIgnore=="function"&&j.onIgnore(ue),ue.isMatch=!1,Y?ue:!1):(typeof j.onMatch=="function"&&j.onMatch(ue),Y?ue:!0)},"matcher");return _&&(K.state=ie),K},"picomatch");v.test=(R,T,_,{glob:F,posix:j}={})=>{if(typeof R!="string")throw new TypeError("Expected input to be a string");if(R==="")return{isMatch:!1,output:""};const P=_||{},Z=P.format||(j?q.toPosixSlashes:null);let ie=R===F,Ce=ie&&Z?Z(R):R;return ie===!1&&(Ce=Z?Z(R):R,ie=Ce===F),(ie===!1||P.capture===!0)&&(P.matchBase===!0||P.basename===!0?ie=v.matchBase(R,T,_,j):ie=T.exec(Ce)),{isMatch:Boolean(ie),match:ie,output:Ce}},v.matchBase=(R,T,_,F=q.isWindows(_))=>(T instanceof RegExp?T:v.makeRe(T,_)).test(I.basename(R)),v.isMatch=(R,T,_)=>v(T,_)(R),v.parse=(R,T)=>Array.isArray(R)?R.map(_=>v.parse(_,T)):B(R,{...T,fastpaths:!1}),v.scan=(R,T)=>M(R,T),v.compileRe=(R,T,_=!1,F=!1)=>{if(_===!0)return R.output;const j=T||{},P=j.contains?"":"^",Z=j.contains?"":"$";let ie=`${P}(?:${R.output})${Z}`;R&&R.negated===!0&&(ie=`^(?!${ie}).*$`);const Ce=v.toRegex(ie,T);return F===!0&&(Ce.state=R),Ce},v.makeRe=(R,T={},_=!1,F=!1)=>{if(!R||typeof R!="string")throw new TypeError("Expected a non-empty string");let j={negated:!1,fastpaths:!0};return T.fastpaths!==!1&&(R[0]==="."||R[0]==="*")&&(j.output=B.fastpaths(R,T)),j.output||(j=B(R,T)),v.compileRe(j,T,_,F)},v.toRegex=(R,T)=>{try{const _=T||{};return new RegExp(R,_.flags||(_.nocase?"i":""))}catch(_){if(T&&T.debug===!0)throw _;return/$^/}},v.constants=V,h.exports=v},3921:(h,A,O)=>{"use strict";const I=O(8702),{CHAR_ASTERISK:M,CHAR_AT:B,CHAR_BACKWARD_SLASH:q,CHAR_COMMA:V,CHAR_DOT:N,CHAR_EXCLAMATION_MARK:v,CHAR_FORWARD_SLASH:R,CHAR_LEFT_CURLY_BRACE:T,CHAR_LEFT_PARENTHESES:_,CHAR_LEFT_SQUARE_BRACKET:F,CHAR_PLUS:j,CHAR_QUESTION_MARK:P,CHAR_RIGHT_CURLY_BRACE:Z,CHAR_RIGHT_PARENTHESES:ie,CHAR_RIGHT_SQUARE_BRACKET:Ce}=O(1006),K=c(C=>C===R||C===q,"isPathSeparator"),Q=c(C=>{C.isPrefix!==!0&&(C.depth=C.isGlobstar?1/0:1)},"depth"),Y=c((C,G)=>{const H=G||{},ue=C.length-1,le=H.parts===!0||H.scanToEnd===!0,ce=[],ve=[],De=[];let Ue=C,qe=-1,_e=0,rt=0,lt=!1,Ke=!1,Se=!1,he=!1,nt=!1,Je=!1,te=!1,gt=!1,Ge=!1,ot=!1,fe=0,de,We,Qe={value:"",depth:0,isGlob:!1};const mt=c(()=>qe>=ue,"eos"),Zt=c(()=>Ue.charCodeAt(qe+1),"peek"),yt=c(()=>(de=We,Ue.charCodeAt(++qe)),"advance");for(;qe<ue;){We=yt();let Ve;if(We===q){te=Qe.backslashes=!0,We=yt(),We===T&&(Je=!0);continue}if(Je===!0||We===T){for(fe++;mt()!==!0&&(We=yt());){if(We===q){te=Qe.backslashes=!0,yt();continue}if(We===T){fe++;continue}if(Je!==!0&&We===N&&(We=yt())===N){if(lt=Qe.isBrace=!0,Se=Qe.isGlob=!0,ot=!0,le===!0)continue;break}if(Je!==!0&&We===V){if(lt=Qe.isBrace=!0,Se=Qe.isGlob=!0,ot=!0,le===!0)continue;break}if(We===Z&&(fe--,fe===0)){Je=!1,lt=Qe.isBrace=!0,ot=!0;break}}if(le===!0)continue;break}if(We===R){if(ce.push(qe),ve.push(Qe),Qe={value:"",depth:0,isGlob:!1},ot===!0)continue;if(de===N&&qe===_e+1){_e+=2;continue}rt=qe+1;continue}if(H.noext!==!0&&(We===j||We===B||We===M||We===P||We===v)===!0&&Zt()===_){if(Se=Qe.isGlob=!0,he=Qe.isExtglob=!0,ot=!0,We===v&&qe===_e&&(Ge=!0),le===!0){for(;mt()!==!0&&(We=yt());){if(We===q){te=Qe.backslashes=!0,We=yt();continue}if(We===ie){Se=Qe.isGlob=!0,ot=!0;break}}continue}break}if(We===M){if(de===M&&(nt=Qe.isGlobstar=!0),Se=Qe.isGlob=!0,ot=!0,le===!0)continue;break}if(We===P){if(Se=Qe.isGlob=!0,ot=!0,le===!0)continue;break}if(We===F){for(;mt()!==!0&&(Ve=yt());){if(Ve===q){te=Qe.backslashes=!0,yt();continue}if(Ve===Ce){Ke=Qe.isBracket=!0,Se=Qe.isGlob=!0,ot=!0;break}}if(le===!0)continue;break}if(H.nonegate!==!0&&We===v&&qe===_e){gt=Qe.negated=!0,_e++;continue}if(H.noparen!==!0&&We===_){if(Se=Qe.isGlob=!0,le===!0){for(;mt()!==!0&&(We=yt());){if(We===_){te=Qe.backslashes=!0,We=yt();continue}if(We===ie){ot=!0;break}}continue}break}if(Se===!0){if(ot=!0,le===!0)continue;break}}H.noext===!0&&(he=!1,Se=!1);let It=Ue,Jt="",xr="";_e>0&&(Jt=Ue.slice(0,_e),Ue=Ue.slice(_e),rt-=_e),It&&Se===!0&&rt>0?(It=Ue.slice(0,rt),xr=Ue.slice(rt)):Se===!0?(It="",xr=Ue):It=Ue,It&&It!==""&&It!=="/"&&It!==Ue&&K(It.charCodeAt(It.length-1))&&(It=It.slice(0,-1)),H.unescape===!0&&(xr&&(xr=I.removeBackslashes(xr)),It&&te===!0&&(It=I.removeBackslashes(It)));const ir={prefix:Jt,input:C,start:_e,base:It,glob:xr,isBrace:lt,isBracket:Ke,isGlob:Se,isExtglob:he,isGlobstar:nt,negated:gt,negatedExtglob:Ge};if(H.tokens===!0&&(ir.maxDepth=0,K(We)||ve.push(Qe),ir.tokens=ve),H.parts===!0||H.tokens===!0){let Ve;for(let ke=0;ke<ce.length;ke++){const Pn=Ve?Ve+1:_e,Ie=ce[ke],at=C.slice(Pn,Ie);H.tokens&&(ke===0&&_e!==0?(ve[ke].isPrefix=!0,ve[ke].value=Jt):ve[ke].value=at,Q(ve[ke]),ir.maxDepth+=ve[ke].depth),(ke!==0||at!=="")&&De.push(at),Ve=Ie}if(Ve&&Ve+1<C.length){const ke=C.slice(Ve+1);De.push(ke),H.tokens&&(ve[ve.length-1].value=ke,Q(ve[ve.length-1]),ir.maxDepth+=ve[ve.length-1].depth)}ir.slashes=ce,ir.parts=De}return ir},"scan");h.exports=Y},8702:(h,A,O)=>{"use strict";var I=O(4155);const M=O(6470),B=I.platform==="win32",{REGEX_BACKSLASH:q,REGEX_REMOVE_BACKSLASH:V,REGEX_SPECIAL_CHARS:N,REGEX_SPECIAL_CHARS_GLOBAL:v}=O(1006);A.isObject=R=>R!==null&&typeof R=="object"&&!Array.isArray(R),A.hasRegexChars=R=>N.test(R),A.isRegexChar=R=>R.length===1&&A.hasRegexChars(R),A.escapeRegex=R=>R.replace(v,"\\$1"),A.toPosixSlashes=R=>R.replace(q,"/"),A.removeBackslashes=R=>R.replace(V,T=>T==="\\"?"":T),A.supportsLookbehinds=()=>{const R=I.version.slice(1).split(".").map(Number);return R.length===3&&R[0]>=9||R[0]===8&&R[1]>=10},A.isWindows=R=>R&&typeof R.windows=="boolean"?R.windows:B===!0||M.sep==="\\",A.escapeLast=(R,T,_)=>{const F=R.lastIndexOf(T,_);return F===-1?R:R[F-1]==="\\"?A.escapeLast(R,T,F-1):`${R.slice(0,F)}\\${R.slice(F)}`},A.removePrefix=(R,T={})=>{let _=R;return _.startsWith("./")&&(_=_.slice(2),T.prefix="./"),_},A.wrapOutput=(R,T={},_={})=>{const F=_.contains?"":"^",j=_.contains?"":"$";let P=`${F}(?:${R})${j}`;return T.negated===!0&&(P=`(?:^(?!${P}).*$)`),P}},4155:h=>{var A=h.exports={},O,I;function M(){throw new Error("setTimeout has not been defined")}c(M,"defaultSetTimout");function B(){throw new Error("clearTimeout has not been defined")}c(B,"defaultClearTimeout"),function(){try{typeof setTimeout=="function"?O=setTimeout:O=M}catch(Z){O=M}try{typeof clearTimeout=="function"?I=clearTimeout:I=B}catch(Z){I=B}}();function q(Z){if(O===setTimeout)return setTimeout(Z,0);if((O===M||!O)&&setTimeout)return O=setTimeout,setTimeout(Z,0);try{return O(Z,0)}catch(ie){try{return O.call(null,Z,0)}catch(Ce){return O.call(this,Z,0)}}}c(q,"runTimeout");function V(Z){if(I===clearTimeout)return clearTimeout(Z);if((I===B||!I)&&clearTimeout)return I=clearTimeout,clearTimeout(Z);try{return I(Z)}catch(ie){try{return I.call(null,Z)}catch(Ce){return I.call(this,Z)}}}c(V,"runClearTimeout");var N=[],v=!1,R,T=-1;function _(){!v||!R||(v=!1,R.length?N=R.concat(N):T=-1,N.length&&F())}c(_,"cleanUpNextTick");function F(){if(!v){var Z=q(_);v=!0;for(var ie=N.length;ie;){for(R=N,N=[];++T<ie;)R&&R[T].run();T=-1,ie=N.length}R=null,v=!1,V(Z)}}c(F,"drainQueue"),A.nextTick=function(Z){var ie=new Array(arguments.length-1);if(arguments.length>1)for(var Ce=1;Ce<arguments.length;Ce++)ie[Ce-1]=arguments[Ce];N.push(new j(Z,ie)),N.length===1&&!v&&q(F)};function j(Z,ie){this.fun=Z,this.array=ie}c(j,"Item"),j.prototype.run=function(){this.fun.apply(null,this.array)},A.title="browser",A.browser=!0,A.env={},A.argv=[],A.version="",A.versions={};function P(){}c(P,"noop"),A.on=P,A.addListener=P,A.once=P,A.off=P,A.removeListener=P,A.removeAllListeners=P,A.emit=P,A.prependListener=P,A.prependOnceListener=P,A.listeners=function(Z){return[]},A.binding=function(Z){throw new Error("process.binding is not supported")},A.cwd=function(){return"/"},A.chdir=function(Z){throw new Error("process.chdir is not supported")},A.umask=function(){return 0}},842:(h,A,O)=>{"use strict";var I=O(8764).Buffer;Object.defineProperty(A,"__esModule",{value:!0}),A.AbstractTokenizer=void 0;const M=O(5167);class B{constructor(V){this.position=0,this.numBuffer=new Uint8Array(8),this.fileInfo=V||{}}async readToken(V,N=this.position){const v=I.alloc(V.len);if(await this.readBuffer(v,{position:N})<V.len)throw new M.EndOfStreamError;return V.get(v,0)}async peekToken(V,N=this.position){const v=I.alloc(V.len);if(await this.peekBuffer(v,{position:N})<V.len)throw new M.EndOfStreamError;return V.get(v,0)}async readNumber(V){if(await this.readBuffer(this.numBuffer,{length:V.len})<V.len)throw new M.EndOfStreamError;return V.get(this.numBuffer,0)}async peekNumber(V){if(await this.peekBuffer(this.numBuffer,{length:V.len})<V.len)throw new M.EndOfStreamError;return V.get(this.numBuffer,0)}async ignore(V){if(this.fileInfo.size!==void 0){const N=this.fileInfo.size-this.position;if(V>N)return this.position+=N,N}return this.position+=V,V}async close(){}normalizeOptions(V,N){if(N&&N.position!==void 0&&N.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");return N?{mayBeLess:N.mayBeLess===!0,offset:N.offset?N.offset:0,length:N.length?N.length:V.length-(N.offset?N.offset:0),position:N.position?N.position:this.position}:{mayBeLess:!1,offset:0,length:V.length,position:this.position}}}c(B,"AbstractTokenizer"),A.AbstractTokenizer=B},778:(h,A,O)=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.BufferTokenizer=void 0;const I=O(5167),M=O(842);class B extends M.AbstractTokenizer{constructor(V,N){super(N);this.uint8Array=V,this.fileInfo.size=this.fileInfo.size?this.fileInfo.size:V.length}async readBuffer(V,N){if(N&&N.position){if(N.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");this.position=N.position}const v=await this.peekBuffer(V,N);return this.position+=v,v}async peekBuffer(V,N){const v=this.normalizeOptions(V,N),R=Math.min(this.uint8Array.length-v.position,v.length);if(!v.mayBeLess&&R<v.length)throw new I.EndOfStreamError;return V.set(this.uint8Array.subarray(v.position,v.position+R),v.offset),R}async close(){}}c(B,"BufferTokenizer"),A.BufferTokenizer=B},7859:(h,A,O)=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.fromFile=A.FileTokenizer=void 0;const I=O(842),M=O(5167),B=O(7209);class q extends I.AbstractTokenizer{constructor(v,R){super(R);this.fd=v}async readBuffer(v,R){const T=this.normalizeOptions(v,R);this.position=T.position;const _=await B.read(this.fd,v,T.offset,T.length,T.position);if(this.position+=_.bytesRead,_.bytesRead<T.length&&(!R||!R.mayBeLess))throw new M.EndOfStreamError;return _.bytesRead}async peekBuffer(v,R){const T=this.normalizeOptions(v,R),_=await B.read(this.fd,v,T.offset,T.length,T.position);if(!T.mayBeLess&&_.bytesRead<T.length)throw new M.EndOfStreamError;return _.bytesRead}async close(){return B.close(this.fd)}}c(q,"FileTokenizer"),A.FileTokenizer=q;async function V(N){const v=await B.stat(N);if(!v.isFile)throw new Error(`File not a file: ${N}`);const R=await B.open(N,"r");return new q(R,{path:N,size:v.size})}c(V,"fromFile"),A.fromFile=V},7209:(h,A,O)=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.readFile=A.writeFileSync=A.writeFile=A.read=A.open=A.close=A.stat=A.createReadStream=A.pathExists=void 0;const I=O(4059);A.pathExists=I.existsSync,A.createReadStream=I.createReadStream;async function M(T){return new Promise((_,F)=>{I.stat(T,(j,P)=>{j?F(j):_(P)})})}c(M,"stat"),A.stat=M;async function B(T){return new Promise((_,F)=>{I.close(T,j=>{j?F(j):_()})})}c(B,"close"),A.close=B;async function q(T,_){return new Promise((F,j)=>{I.open(T,_,(P,Z)=>{P?j(P):F(Z)})})}c(q,"open"),A.open=q;async function V(T,_,F,j,P){return new Promise((Z,ie)=>{I.read(T,_,F,j,P,(Ce,K,Q)=>{Ce?ie(Ce):Z({bytesRead:K,buffer:Q})})})}c(V,"read"),A.read=V;async function N(T,_){return new Promise((F,j)=>{I.writeFile(T,_,P=>{P?j(P):F()})})}c(N,"writeFile"),A.writeFile=N;function v(T,_){I.writeFileSync(T,_)}c(v,"writeFileSync"),A.writeFileSync=v;async function R(T){return new Promise((_,F)=>{I.readFile(T,(j,P)=>{j?F(j):_(P)})})}c(R,"readFile"),A.readFile=R},599:(h,A,O)=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.ReadStreamTokenizer=void 0;const I=O(842),M=O(5167),B=256e3;class q extends I.AbstractTokenizer{constructor(N,v){super(v);this.streamReader=new M.StreamReader(N)}async getFileInfo(){return this.fileInfo}async readBuffer(N,v){const R=this.normalizeOptions(N,v),T=R.position-this.position;if(T>0)return await this.ignore(T),this.readBuffer(N,v);if(T<0)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");if(R.length===0)return 0;const _=await this.streamReader.read(N,R.offset,R.length);if(this.position+=_,(!v||!v.mayBeLess)&&_<R.length)throw new M.EndOfStreamError;return _}async peekBuffer(N,v){const R=this.normalizeOptions(N,v);let T=0;if(R.position){const _=R.position-this.position;if(_>0){const F=new Uint8Array(R.length+_);return T=await this.peekBuffer(F,{mayBeLess:R.mayBeLess}),N.set(F.subarray(_),R.offset),T-_}else if(_<0)throw new Error("Cannot peek from a negative offset in a stream")}if(R.length>0){try{T=await this.streamReader.peek(N,R.offset,R.length)}catch(_){if(v&&v.mayBeLess&&_ instanceof M.EndOfStreamError)return 0;throw _}if(!R.mayBeLess&&T<R.length)throw new M.EndOfStreamError}return T}async ignore(N){const v=Math.min(B,N),R=new Uint8Array(v);let T=0;for(;T<N;){const _=N-T,F=await this.readBuffer(R,{length:Math.min(v,_)});if(F<0)return F;T+=F}return T}}c(q,"ReadStreamTokenizer"),A.ReadStreamTokenizer=q},5849:(h,A,O)=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.fromBuffer=A.fromStream=A.EndOfStreamError=void 0;const I=O(599),M=O(778);var B=O(5167);Object.defineProperty(A,"EndOfStreamError",{enumerable:!0,get:function(){return B.EndOfStreamError}});function q(N,v){return v=v||{},new I.ReadStreamTokenizer(N,v)}c(q,"fromStream"),A.fromStream=q;function V(N,v){return new M.BufferTokenizer(N,v)}c(V,"fromBuffer"),A.fromBuffer=V},6597:(h,A,O)=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.fromStream=A.fromBuffer=A.EndOfStreamError=A.fromFile=void 0;const I=O(7209),M=O(5849);var B=O(7859);Object.defineProperty(A,"fromFile",{enumerable:!0,get:function(){return B.fromFile}});var q=O(5849);Object.defineProperty(A,"EndOfStreamError",{enumerable:!0,get:function(){return q.EndOfStreamError}}),Object.defineProperty(A,"fromBuffer",{enumerable:!0,get:function(){return q.fromBuffer}});async function V(N,v){if(v=v||{},N.path){const R=await I.stat(N.path);v.path=N.path,v.size=R.size}return M.fromStream(N,v)}c(V,"fromStream"),A.fromStream=V},5702:(h,A,O)=>{"use strict";/*!
 * to-regex-range <https://github.com/micromatch/to-regex-range>
 *
 * Copyright (c) 2015-present, Jon Schlinkert.
 * Released under the MIT License.
 */const I=O(9924),M=c((K,Q,Y)=>{if(I(K)===!1)throw new TypeError("toRegexRange: expected the first argument to be a number");if(Q===void 0||K===Q)return String(K);if(I(Q)===!1)throw new TypeError("toRegexRange: expected the second argument to be a number.");let C={relaxZeros:!0,...Y};typeof C.strictZeros=="boolean"&&(C.relaxZeros=C.strictZeros===!1);let G=String(C.relaxZeros),H=String(C.shorthand),ue=String(C.capture),le=String(C.wrap),ce=K+":"+Q+"="+G+H+ue+le;if(M.cache.hasOwnProperty(ce))return M.cache[ce].result;let ve=Math.min(K,Q),De=Math.max(K,Q);if(Math.abs(ve-De)===1){let lt=K+"|"+Q;return C.capture?`(${lt})`:C.wrap===!1?lt:`(?:${lt})`}let Ue=ie(K)||ie(Q),qe={min:K,max:Q,a:ve,b:De},_e=[],rt=[];if(Ue&&(qe.isPadded=Ue,qe.maxLen=String(qe.max).length),ve<0){let lt=De<0?Math.abs(De):1;rt=N(lt,Math.abs(ve),qe,C),ve=qe.a=0}return De>=0&&(_e=N(ve,De,qe,C)),qe.negatives=rt,qe.positives=_e,qe.result=B(rt,_e,C),C.capture===!0?qe.result=`(${qe.result})`:C.wrap!==!1&&_e.length+rt.length>1&&(qe.result=`(?:${qe.result})`),M.cache[ce]=qe,qe.result},"toRegexRange");function B(K,Q,Y){let C=v(K,Q,"-",!1,Y)||[],G=v(Q,K,"",!1,Y)||[],H=v(K,Q,"-?",!0,Y)||[];return C.concat(H).concat(G).join("|")}c(B,"collatePatterns");function q(K,Q){let Y=1,C=1,G=F(K,Y),H=new Set([Q]);for(;K<=G&&G<=Q;)H.add(G),Y+=1,G=F(K,Y);for(G=j(Q+1,C)-1;K<G&&G<=Q;)H.add(G),C+=1,G=j(Q+1,C)-1;return H=[...H],H.sort(T),H}c(q,"splitToRanges");function V(K,Q,Y){if(K===Q)return{pattern:K,count:[],digits:0};let C=R(K,Q),G=C.length,H="",ue=0;for(let le=0;le<G;le++){let[ce,ve]=C[le];ce===ve?H+=ce:ce!=="0"||ve!=="9"?H+=Z(ce,ve,Y):ue++}return ue&&(H+=Y.shorthand===!0?"\\d":"[0-9]"),{pattern:H,count:[ue],digits:G}}c(V,"rangeToPattern");function N(K,Q,Y,C){let G=q(K,Q),H=[],ue=K,le;for(let ce=0;ce<G.length;ce++){let ve=G[ce],De=V(String(ue),String(ve),C),Ue="";if(!Y.isPadded&&le&&le.pattern===De.pattern){le.count.length>1&&le.count.pop(),le.count.push(De.count[0]),le.string=le.pattern+P(le.count),ue=ve+1;continue}Y.isPadded&&(Ue=Ce(ve,Y,C)),De.string=Ue+De.pattern+P(De.count),H.push(De),ue=ve+1,le=De}return H}c(N,"splitToPatterns");function v(K,Q,Y,C,G){let H=[];for(let ue of K){let{string:le}=ue;!C&&!_(Q,"string",le)&&H.push(Y+le),C&&_(Q,"string",le)&&H.push(Y+le)}return H}c(v,"filterPatterns");function R(K,Q){let Y=[];for(let C=0;C<K.length;C++)Y.push([K[C],Q[C]]);return Y}c(R,"zip");function T(K,Q){return K>Q?1:Q>K?-1:0}c(T,"compare");function _(K,Q,Y){return K.some(C=>C[Q]===Y)}c(_,"contains");function F(K,Q){return Number(String(K).slice(0,-Q)+"9".repeat(Q))}c(F,"countNines");function j(K,Q){return K-K%Math.pow(10,Q)}c(j,"countZeros");function P(K){let[Q=0,Y=""]=K;return Y||Q>1?`{${Q+(Y?","+Y:"")}}`:""}c(P,"toQuantifier");function Z(K,Q,Y){return`[${K}${Q-K==1?"":"-"}${Q}]`}c(Z,"toCharacterClass");function ie(K){return/^-?(0+)\d/.test(K)}c(ie,"hasPadding");function Ce(K,Q,Y){if(!Q.isPadded)return K;let C=Math.abs(Q.maxLen-String(K).length),G=Y.relaxZeros!==!1;switch(C){case 0:return"";case 1:return G?"0?":"0";case 2:return G?"0{0,2}":"00";default:return G?`0{0,${C}}`:`0{${C}}`}}c(Ce,"padZeros"),M.cache={},M.clearCache=()=>M.cache={},h.exports=M},3416:(h,A,O)=>{"use strict";var I=O(8764).Buffer;Object.defineProperty(A,"__esModule",{value:!0}),A.AnsiStringType=A.StringType=A.BufferType=A.Uint8ArrayType=A.IgnoreType=A.Float80_LE=A.Float80_BE=A.Float64_LE=A.Float64_BE=A.Float32_LE=A.Float32_BE=A.Float16_LE=A.Float16_BE=A.INT64_BE=A.UINT64_BE=A.INT64_LE=A.UINT64_LE=A.INT32_LE=A.INT32_BE=A.INT24_BE=A.INT24_LE=A.INT16_LE=A.INT16_BE=A.INT8=A.UINT32_BE=A.UINT32_LE=A.UINT24_BE=A.UINT24_LE=A.UINT16_BE=A.UINT16_LE=A.UINT8=void 0;const M=O(645);function B(T){return new DataView(T.buffer,T.byteOffset)}c(B,"dv"),A.UINT8={len:1,get(T,_){return B(T).getUint8(_)},put(T,_,F){return B(T).setUint8(_,F),_+1}},A.UINT16_LE={len:2,get(T,_){return B(T).getUint16(_,!0)},put(T,_,F){return B(T).setUint16(_,F,!0),_+2}},A.UINT16_BE={len:2,get(T,_){return B(T).getUint16(_)},put(T,_,F){return B(T).setUint16(_,F),_+2}},A.UINT24_LE={len:3,get(T,_){const F=B(T);return F.getUint8(_)+(F.getUint16(_+1,!0)<<8)},put(T,_,F){const j=B(T);return j.setUint8(_,F&255),j.setUint16(_+1,F>>8,!0),_+3}},A.UINT24_BE={len:3,get(T,_){const F=B(T);return(F.getUint16(_)<<8)+F.getUint8(_+2)},put(T,_,F){const j=B(T);return j.setUint16(_,F>>8),j.setUint8(_+2,F&255),_+3}},A.UINT32_LE={len:4,get(T,_){return B(T).getUint32(_,!0)},put(T,_,F){return B(T).setUint32(_,F,!0),_+4}},A.UINT32_BE={len:4,get(T,_){return B(T).getUint32(_)},put(T,_,F){return B(T).setUint32(_,F),_+4}},A.INT8={len:1,get(T,_){return B(T).getInt8(_)},put(T,_,F){return B(T).setInt8(_,F),_+2}},A.INT16_BE={len:2,get(T,_){return B(T).getInt16(_)},put(T,_,F){return B(T).setInt16(_,F),_+2}},A.INT16_LE={len:2,get(T,_){return B(T).getInt16(_,!0)},put(T,_,F){return B(T).setInt16(_,F,!0),_+2}},A.INT24_LE={len:3,get(T,_){const F=A.UINT24_LE.get(T,_);return F>8388607?F-16777216:F},put(T,_,F){const j=B(T);return j.setUint8(_,F&255),j.setUint16(_+1,F>>8,!0),_+3}},A.INT24_BE={len:3,get(T,_){const F=A.UINT24_BE.get(T,_);return F>8388607?F-16777216:F},put(T,_,F){const j=B(T);return j.setUint16(_,F>>8),j.setUint8(_+2,F&255),_+3}},A.INT32_BE={len:4,get(T,_){return B(T).getInt32(_)},put(T,_,F){return B(T).setInt32(_,F),_+4}},A.INT32_LE={len:4,get(T,_){return B(T).getInt32(_,!0)},put(T,_,F){return B(T).setInt32(_,F,!0),_+4}},A.UINT64_LE={len:8,get(T,_){return B(T).getBigUint64(_,!0)},put(T,_,F){return B(T).setBigUint64(_,F,!0),_+8}},A.INT64_LE={len:8,get(T,_){return B(T).getBigInt64(_,!0)},put(T,_,F){return B(T).setBigInt64(_,F,!0),_+8}},A.UINT64_BE={len:8,get(T,_){return B(T).getBigUint64(_)},put(T,_,F){return B(T).setBigUint64(_,F),_+8}},A.INT64_BE={len:8,get(T,_){return B(T).getBigInt64(_)},put(T,_,F){return B(T).setBigInt64(_,F),_+8}},A.Float16_BE={len:2,get(T,_){return M.read(T,_,!1,10,this.len)},put(T,_,F){return M.write(T,F,_,!1,10,this.len),_+this.len}},A.Float16_LE={len:2,get(T,_){return M.read(T,_,!0,10,this.len)},put(T,_,F){return M.write(T,F,_,!0,10,this.len),_+this.len}},A.Float32_BE={len:4,get(T,_){return B(T).getFloat32(_)},put(T,_,F){return B(T).setFloat32(_,F),_+4}},A.Float32_LE={len:4,get(T,_){return B(T).getFloat32(_,!0)},put(T,_,F){return B(T).setFloat32(_,F,!0),_+4}},A.Float64_BE={len:8,get(T,_){return B(T).getFloat64(_)},put(T,_,F){return B(T).setFloat64(_,F),_+8}},A.Float64_LE={len:8,get(T,_){return B(T).getFloat64(_,!0)},put(T,_,F){return B(T).setFloat64(_,F,!0),_+8}},A.Float80_BE={len:10,get(T,_){return M.read(T,_,!1,63,this.len)},put(T,_,F){return M.write(T,F,_,!1,63,this.len),_+this.len}},A.Float80_LE={len:10,get(T,_){return M.read(T,_,!0,63,this.len)},put(T,_,F){return M.write(T,F,_,!0,63,this.len),_+this.len}};class q{constructor(_){this.len=_}get(_,F){}}c(q,"IgnoreType"),A.IgnoreType=q;class V{constructor(_){this.len=_}get(_,F){return _.subarray(F,F+this.len)}}c(V,"Uint8ArrayType"),A.Uint8ArrayType=V;class N{constructor(_){this.len=_}get(_,F){return _.slice(F,F+this.len)}}c(N,"BufferType"),A.BufferType=N;class v{constructor(_,F){this.len=_,this.encoding=F}get(_,F){return I.from(_).toString(this.encoding,F,F+this.len)}}c(v,"StringType"),A.StringType=v;class R{constructor(_){this.len=_}static decode(_,F,j){let P="";for(let Z=F;Z<j;++Z)P+=R.codePointToString(R.singleByteDecoder(_[Z]));return P}static inRange(_,F,j){return F<=_&&_<=j}static codePointToString(_){return _<=65535?String.fromCharCode(_):(_-=65536,String.fromCharCode((_>>10)+55296,(_&1023)+56320))}static singleByteDecoder(_){if(R.inRange(_,0,127))return _;const F=R.windows1252[_-128];if(F===null)throw Error("invaliding encoding");return F}get(_,F=0){return R.decode(_,F,F+this.len)}}c(R,"AnsiStringType"),A.AnsiStringType=R,R.windows1252=[8364,129,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,141,381,143,144,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,157,382,376,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]},5102:()=>{},189:function(h,A,O){"use strict";var I=this&&this.__spreadArrays||function(){for(var v=0,R=0,T=arguments.length;R<T;R++)v+=arguments[R].length;for(var _=Array(v),F=0,R=0;R<T;R++)for(var j=arguments[R],P=0,Z=j.length;P<Z;P++,F++)_[F]=j[P];return _};Object.defineProperty(A,"__esModule",{value:!0}),A.config=A.loadMessageBundle=void 0;var M=O(1926),B=O(800),q=O(800);Object.defineProperty(A,"MessageFormat",{enumerable:!0,get:function(){return q.MessageFormat}}),Object.defineProperty(A,"BundleFormat",{enumerable:!0,get:function(){return q.BundleFormat}});function V(v){return function(R,T){for(var _=[],F=2;F<arguments.length;F++)_[F-2]=arguments[F];if(typeof R=="number")throw new Error("Browser implementation does currently not support externalized strings.");return B.localize.apply(void 0,I([R,T],_))}}c(V,"loadMessageBundle"),A.loadMessageBundle=V;function N(v){return B.setPseudo((v==null?void 0:v.locale.toLowerCase())==="pseudo"),V}c(N,"config"),A.config=N,M.default.install(Object.freeze({loadMessageBundle:V,config:N}))},800:(h,A,O)=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0}),A.config=A.loadMessageBundle=A.localize=A.format=A.setPseudo=A.isPseudo=A.isDefined=A.BundleFormat=A.MessageFormat=void 0;var I=O(1926),M;(function(F){F.file="file",F.bundle="bundle",F.both="both"})(M=A.MessageFormat||(A.MessageFormat={}));var B;(function(F){F.standalone="standalone",F.languagePack="languagePack"})(B=A.BundleFormat||(A.BundleFormat={}));var q;(function(F){function j(P){var Z=P;return Z&&V(Z.key)&&V(Z.comment)}c(j,"is"),F.is=j})(q||(q={}));function V(F){return typeof F!="undefined"}c(V,"isDefined"),A.isDefined=V,A.isPseudo=!1;function N(F){A.isPseudo=F}c(N,"setPseudo"),A.setPseudo=N;function v(F,j){var P;return A.isPseudo&&(F="\uFF3B"+F.replace(/[aouei]/g,"$&$&")+"\uFF3D"),j.length===0?P=F:P=F.replace(/\{(\d+)\}/g,function(Z,ie){var Ce=ie[0],K=j[Ce],Q=Z;return typeof K=="string"?Q=K:(typeof K=="number"||typeof K=="boolean"||K===void 0||K===null)&&(Q=String(K)),Q}),P}c(v,"format"),A.format=v;function R(F,j){for(var P=[],Z=2;Z<arguments.length;Z++)P[Z-2]=arguments[Z];return v(j,P)}c(R,"localize"),A.localize=R;function T(F){return I.default().loadMessageBundle(F)}c(T,"loadMessageBundle"),A.loadMessageBundle=T;function _(F){return I.default().config(F)}c(_,"config"),A.config=_},1926:(h,A)=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0});var O;function I(){if(O===void 0)throw new Error("No runtime abstraction layer installed");return O}c(I,"RAL"),function(M){function B(q){if(q===void 0)throw new Error("No runtime abstraction layer provided");O=q}c(B,"install"),M.install=B}(I||(I={})),A.default=I},6822:(h,A,O)=>{"use strict";h.exports=O(189)},2479:h=>{h.exports=A;function A(O,I){if(O&&I)return A(O)(I);if(typeof O!="function")throw new TypeError("need wrapper function");return Object.keys(O).forEach(function(B){M[B]=O[B]}),M;function M(){for(var B=new Array(arguments.length),q=0;q<B.length;q++)B[q]=arguments[q];var V=O.apply(this,B),N=B[B.length-1];return typeof V=="function"&&V!==N&&Object.keys(N).forEach(function(v){V[v]=N[v]}),V}c(M,"wrapper")}c(A,"wrappy")},1932:()=>{},7170:()=>{},4059:()=>{}},__webpack_module_cache__={};function __webpack_require__(h){var A=__webpack_module_cache__[h];if(A!==void 0)return A.exports;var O=__webpack_module_cache__[h]={id:h,loaded:!1,exports:{}};return __webpack_modules__[h].call(O.exports,O,O.exports,__webpack_require__),O.loaded=!0,O.exports}c(__webpack_require__,"__webpack_require__"),(()=>{__webpack_require__.n=h=>{var A=h&&h.__esModule?()=>h.default:()=>h;return __webpack_require__.d(A,{a:A}),A}})(),(()=>{__webpack_require__.d=(h,A)=>{for(var O in A)__webpack_require__.o(A,O)&&!__webpack_require__.o(h,O)&&Object.defineProperty(h,O,{enumerable:!0,get:A[O]})}})(),(()=>{__webpack_require__.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch(h){if(typeof window=="object")return window}}()})(),(()=>{__webpack_require__.o=(h,A)=>Object.prototype.hasOwnProperty.call(h,A)})(),(()=>{__webpack_require__.r=h=>{typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(h,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(h,"__esModule",{value:!0})}})(),(()=>{__webpack_require__.nmd=h=>(h.paths=[],h.children||(h.children=[]),h)})();var __webpack_exports__={};(()=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{StateKeys:()=>Lo,activate:()=>iR,getOpenActionsService:()=>yu,getState:()=>Ny,isInsiders:()=>By,updateState:()=>hp});const h=require("vscode");var A=__webpack_require__(189),O;(function(t){t.Off="off",t.Auto="auto",t.Always="always"})(O||(O={}));var I;(function(t){t.None="none",t.Latest="latest",t.Match="match",t.TipPlusLatest="tip+latest"})(I||(I={})),function(t){function e(r){return r===t.None||r===t.Latest||r===t.Match||r===t.TipPlusLatest?r:t.None}c(e,"sanitize"),t.sanitize=e}(I||(I={}));var M;(function(t){t.Browse="browse",t.Edit="edit"})(M||(M={})),function(t){function e(n){return n===t.Browse||n===t.Edit?n:t.Edit}c(e,"sanitize"),t.sanitize=e;function r(n){return n===t.Browse?t.Edit:t.Browse}c(r,"toggle"),t.toggle=r}(M||(M={}));var B;(function(t){function e(r,n){return r.display===n.display&&r.index===n.index}c(e,"equals"),t.equals=e})(B||(B={}));var q;(function(t){t.Branch="branch",t.RemoteBranch="remoteBranch",t.PullRequestBranch="pullRequestBranch",t.PullRequestRemoteBranch="pullRequestRemoteBranch",t.Tag="tag",t.Commit="commit"})(q||(q={}));var V;(function(t){const e=new Map([[q.Branch,I.None],[q.RemoteBranch,I.None],[q.PullRequestBranch,I.Match],[q.PullRequestRemoteBranch,I.Match],[q.Commit,I.Match],[q.Tag,I.Match]]),r=new Map([[q.Branch,M.Edit],[q.RemoteBranch,M.Edit],[q.PullRequestBranch,M.Browse],[q.PullRequestRemoteBranch,M.Browse],[q.Commit,M.Browse],[q.Tag,M.Browse]]);function n(o){var a,s;return{display:(a=r.get(o))!=null?a:M.Edit,index:(s=e.get(o))!=null?s:I.None}}c(n,"getDefault"),t.getDefault=n;function i(o){switch(o){case q.Branch:case q.RemoteBranch:return{display:M.Browse,index:I.Latest};case q.PullRequestBranch:case q.PullRequestRemoteBranch:return{display:M.Browse,index:I.Match};case q.Commit:case q.Tag:return{display:M.Browse,index:I.Match};default:return{display:M.Edit,index:I.None}}}c(i,"getIndexDefault"),t.getIndexDefault=i})(V||(V={}));const N=null;var v=__webpack_require__(2307),R=__webpack_require__.n(v);const T="remoteHub",_="modes",F="indexMemento";class j{constructor(){this._onDidChange=new h.EventEmitter,this._onDidChangeAny=new h.EventEmitter,this.memoryState=new Map}static configure(e){P.state=e.workspaceState,e.subscriptions.push(h.workspace.onDidChangeConfiguration(P.onConfigurationChanged,P))}get onDidChange(){return this._onDidChange.event}get onDidChangeAny(){return this._onDidChangeAny.event}onConfigurationChanged(e){if(!e.affectsConfiguration(T)){this._onDidChangeAny.fire(e);return}this._onDidChangeAny.fire(e),this._onDidChange.fire(e)}set state(e){if(this._state=e,this.modes=this._state.get(_),this.modes===void 0&&(this.modes=Object.create(null)),this.memoryState.size!==0){for(const r of this.memoryState.entries())this.modes[r[0]]=r[1];this._state.update(_,this.modes).then(()=>{this.memoryState.clear()},void 0)}this.indexMemento=this._state.get(F),this.indexMemento===void 0&&(this.indexMemento=Object.create(null))}get(e,r,n){return n===void 0?h.workspace.getConfiguration(e===void 0?void 0:T,r).get(e===void 0?T:e):h.workspace.getConfiguration(e===void 0?void 0:T,r).get(e===void 0?T:e,n)}getMode(e,r,n){var i;const o=e.toString();let a=this.modes!==void 0?this.modes[o]:void 0;if(a!==void 0)return{display:M.sanitize(a.display),index:I.sanitize(a.index)};if(a=this.memoryState.get(o),a!==void 0)return a;if(r===q.Branch||r===q.RemoteBranch)switch((i=h.workspace.getConfiguration("remoteHub.richNavigation.indexMode",e))==null?void 0:i.get("branch")){case"none":return{display:M.Edit,index:I.None};case"latest":return{display:M.Browse,index:I.Latest};case"tipPlusLatest":return{display:M.Edit,index:I.TipPlusLatest}}if(!n)return V.getDefault(r)}setMode(e,r){const n=e.toString();return this._state===void 0||this.modes===void 0?(this.memoryState.set(n,r),Promise.resolve()):(this.modes[n]=r,this._state.update(_,this.modes))}getIndexMemento(e){if(this.indexMemento!==void 0)return this.indexMemento[e.toString()]}setIndexMemento(e,r){return this.indexMemento===void 0||this._state===void 0?Promise.resolve():(this.indexMemento[e.toString()]=r,this._state.update(F,this.indexMemento))}getAny(e,r,n){return n===void 0?h.workspace.getConfiguration(void 0,r).get(e):h.workspace.getConfiguration(void 0,r).get(e,n)}changed(e,r,n){var i;return(i=e==null?void 0:e.affectsConfiguration(`${T}.${r}`,n))!=null?i:!0}inspect(e,r){return h.workspace.getConfiguration(e===void 0?void 0:T,r).inspect(e===void 0?T:e)}inspectAny(e,r){return h.workspace.getConfiguration(void 0,r).inspect(e)}async migrate(e,r,n){const i=P.inspect(e);if(i===void 0)return!1;let o=!1;return i.globalValue!==void 0&&(await this.update(r,n.migrationFn!=null?n.migrationFn(i.globalValue):i.globalValue,h.ConfigurationTarget.Global),o=!0),i.workspaceValue!==void 0&&(await this.update(r,n.migrationFn!=null?n.migrationFn(i.workspaceValue):i.workspaceValue,h.ConfigurationTarget.Workspace),o=!0),i.workspaceFolderValue!==void 0&&(await this.update(r,n.migrationFn!=null?n.migrationFn(i.workspaceFolderValue):i.workspaceFolderValue,h.ConfigurationTarget.WorkspaceFolder),o=!0),!o&&n.fallbackValue!==void 0&&(await this.update(r,n.fallbackValue,h.ConfigurationTarget.Global),o=!0),o}async migrateIfMissing(e,r,n){const i=P.inspect(e);if(i===void 0)return;const o=P.inspect(r);i.globalValue!==void 0&&(o===void 0||o.globalValue===void 0)&&await this.update(r,n.migrationFn!=null?n.migrationFn(i.globalValue):i.globalValue,h.ConfigurationTarget.Global),i.workspaceValue!==void 0&&(o===void 0||o.workspaceValue===void 0)&&await this.update(r,n.migrationFn!=null?n.migrationFn(i.workspaceValue):i.workspaceValue,h.ConfigurationTarget.Workspace),i.workspaceFolderValue!==void 0&&(o===void 0||o.workspaceFolderValue===void 0)&&await this.update(r,n.migrationFn!=null?n.migrationFn(i.workspaceFolderValue):i.workspaceFolderValue,h.ConfigurationTarget.WorkspaceFolder)}name(e){return e}update(e,r,n){return h.workspace.getConfiguration(T).update(e,r,n)}updateAny(e,r,n,i){return h.workspace.getConfiguration(void 0,n===h.ConfigurationTarget.Global?void 0:i).update(e,r,n)}updateEffective(e,r){const n=P.inspect(e);return n.workspaceFolderValue!==void 0?r===n.workspaceFolderValue?Promise.resolve(void 0):P.update(e,r,h.ConfigurationTarget.WorkspaceFolder):n.workspaceValue!==void 0?r===n.workspaceValue?Promise.resolve(void 0):P.update(e,r,h.ConfigurationTarget.Workspace):n.globalValue===r||n.globalValue===void 0&&r===n.defaultValue?Promise.resolve(void 0):P.update(e,R()(r,n.defaultValue)?void 0:r,h.ConfigurationTarget.Global)}getUseNewCommitApi(){let e=this.get("experimental.useNewCommitApi");return e===null&&(e=By()),e}}c(j,"Configuration");const P=new j,Z="";var ie;(function(t){t.Off="off",t.Error="error",t.Warn="warn",t.Info="info",t.Debug="debug"})(ie||(ie={}));var Ce;(function(t){t[t.Off=0]="Off",t[t.Error=1]="Error",t[t.Warn=2]="Warn",t[t.Info=3]="Info",t[t.Debug=4]="Debug"})(Ce||(Ce={}));const K="GitHub Repositories",Q="[RemoteHub]",Y=c(class{static configure(t,e){this._isDebugging=t.extensionMode===h.ExtensionMode.Development,this.logLevel=e}static enabled(t){return this.level>=this.toOrderedLevel(t)}static get logLevel(){return this._logLevel}static set logLevel(t){var e,r;this._logLevel=t,this.level=this.toOrderedLevel(t),t===ie.Off?((e=this.output)==null||e.dispose(),this.output=void 0):this.output=(r=this.output)!=null?r:h.window.createOutputChannel(K)}static toOrderedLevel(t){switch(t){case ie.Off:return 0;case ie.Error:return 1;case ie.Warn:return 2;case ie.Info:return 3;case ie.Debug:return 4}}static get isDebugging(){return this._isDebugging}static debug(t,...e){Y.isDebugging&&console.log(this.timestamp,Q,t!=null?t:Z,...e),!(this.output===void 0||this.level<4)&&this.output.appendLine(`${this.timestamp} ${t!=null?t:Z}${this.toLoggableParams(!0,e)}`)}static error(t,e,...r){if(!(this.level<1&&!Y.isDebugging)){if(e===void 0){const n=t instanceof Error?t.stack:void 0;if(n){const i=/.*\s*?at\s(.+?)\s/.exec(n);i!==null&&(e=i[1])}}Y.isDebugging&&console.error(this.timestamp,Q,e!=null?e:Z,...r,t),!(this.output===void 0||this.level<1)&&this.output.appendLine(`${this.timestamp} ${e!=null?e:Z}${this.toLoggableParams(!1,r)}
${String(t)}`)}}static log(t,...e){Y.isDebugging&&console.log(this.timestamp,Q,t!=null?t:Z,...e),!(this.output===void 0||this.level<3)&&this.output.appendLine(`${this.timestamp} ${t!=null?t:Z}${this.toLoggableParams(!1,e)}`)}static warn(t,...e){Y.isDebugging&&console.warn(this.timestamp,Q,t!=null?t:Z,...e),!(this.output===void 0||this.level<2)&&this.output.appendLine(`${this.timestamp} ${t!=null?t:Z}${this.toLoggableParams(!1,e)}`)}static showOutputChannel(){var t;(t=this.output)==null||t.show()}static toLoggable(t,e){if(typeof t!="object")return String(t);if(t instanceof h.Uri)return`Uri(${t.toString(!0)})`;try{return JSON.stringify(t,e)}catch{return"<error>"}}static toLoggableName(t){var e,r,n;let i;if(typeof t=="function"){if(t.prototype===void 0||t.prototype.constructor===void 0)return t.name;i=(e=t.prototype.constructor.name)!=null?e:Z}else i=(n=(r=t.constructor)==null?void 0:r.name)!=null?n:Z;const o=i.indexOf("_");return o===-1?i:i.substr(o+1)}static get timestamp(){const t=new Date;return`[${t.toISOString().replace(/T/," ").replace(/\..+/,Z)}:${`00${t.getUTCMilliseconds()}`.slice(-3)}]`}static toLoggableParams(t,e){if(e.length===0||t&&this.level<4&&!Y.isDebugging)return Z;const r=e.map(n=>this.toLoggable(n)).join(", ");return r.length!==0?` \u2014 ${r}`:Z}},"_Logger");let C=Y;C.level=0,C._logLevel=ie.Off;const G=47;function H(t){if(t===void 0)return;const e=t.path.endsWith("/");return!e&&!t.fragment?t.toString():t.with({path:e?t.path.slice(0,-1):t.path,fragment:""}).toString()}c(H,"asKey");function ue(t){if(t===void 0)return;const e=t.path.endsWith("/");return!e&&!t.query&&!t.fragment?t.toString():t.with({path:e?t.path.slice(0,-1):t.path,query:"",fragment:""}).toString()}c(ue,"asFileKey");function le(t,e){return`${(e==null?void 0:e.excludeScheme)?"":`${t.scheme}-`}${t.authority}${t.path.endsWith("/")?t.path.slice(0,-1):t.path}`}c(le,"asFileStorageKey");function ce(t){const e=t.path;let r=0,n=-1,i=!0;for(let o=e.length-1;o>=0;--o)if(e.charCodeAt(o)===G){if(!i){r=o+1;break}}else n===-1&&(i=!1,n=o+1);return n===-1?"":e.slice(r,n)}c(ce,"basename");function ve(t){const e=t.path;if(e.length===1)return"/";let r,n=-1,i=!0;for(let o=e.length-1;o>=1;--o)if(r=e.charCodeAt(o),r===G){if(!i){n=o;break}}else i=!1;return n===-1?"/":e.slice(0,n)}c(ve,"dirname");function De(t){const e=t.path.lastIndexOf("/");return e===-1?t.with({path:"/"}):t.with({path:t.path.substring(0,e)})}c(De,"getParent");function Ue(t,e){const r=typeof e=="string"?e:e.path;return r.startsWith(t.path)?h.Uri.joinPath(t,r.substr(t.path.length)):h.Uri.joinPath(t,r)}c(Ue,"joinRelativePath");function qe(t,e){return typeof e=="string"?(e.startsWith("/")||(e=`/${e}`),_e(t,e)&&t.path.substr(e.length+(e.endsWith("/")?0:1)).split("/").length===1):_e(t,e)&&t.path.substr(e.path.length+(e.path.endsWith("/")?0:1)).split("/").length===1}c(qe,"isChild");function _e(t,e){return typeof e=="string"?(e.startsWith("/")||(e=`/${e}`),e.length===1||t.path.startsWith(e.endsWith("/")?e:`${e}/`)):e.scheme===t.scheme&&e.authority===t.authority&&(e.path.length===1||t.path.startsWith(e.path.endsWith("/")?e.path:`${e.path}/`))}c(_e,"isDescendent");function rt(t){return t&&typeof t=="object"&&"scheme"in t}c(rt,"isSerializedUri");const lt=c(class{constructor(t){this.storageService=t,this._onDidChange=new h.EventEmitter,this.cache=new Map}get onDidChange(){return this._onDidChange.event}async delete(t){const e=H(t),r=this.cache.has(e);this.cache.delete(e);try{await this.storageService.delete(this.getStorageKey(e))}catch(n){throw C.error(n,`Failed to delete repository metadata for ${e}`),n}!r||setTimeout(()=>this._onDidChange.fire({uri:t}),0)}async get(t){this.assertMatchingScheme(t);const e=H(t),r=this.cache.get(e);if(r!==void 0)return r;let n;try{n=this.fromStorage(await this.storageService.get(this.getStorageKey(e)))}catch(i){throw C.error(i,`Failed to get repository metadata for ${e}`),i}return n?this.cache.set(e,{revision:n}):this.cache.delete(e),{revision:n}}async set(t,e,r,n){this.assertMatchingScheme(t);const i=(await this.get(t)).revision!==e?"revision":void 0,o=H(t);if(r!==void 0&&!this.validate(r))throw new Error(`Metadata validation failed for ${t.toString()}`);const a={revision:e,cachedMetadata:r};this.cache.set(o,a);try{await this.storageService.store(this.getStorageKey(o),this.toStorage(e))}catch(s){throw this.cache.delete(o),C.error(s,`Failed to save repository metadata for ${o}`),s}(n==null?void 0:n.silent)||setTimeout(()=>this._onDidChange.fire({uri:t,reason:i}),0)}refresh(){this.cache.clear()}validate(t){var e,r,n,i,o,a,s,l;return typeof t.version=="number"&&t.version>=lt.schemaVersion&&typeof t.timestamp=="number"&&typeof((e=t.provider)==null?void 0:e.id)=="string"&&typeof t.provider.name=="string"&&typeof t.name=="string"&&t.repo&&typeof t.user=="string"&&typeof t.accessLevel=="number"&&typeof((r=t.HEAD)==null?void 0:r.type)=="number"&&typeof((n=t.HEAD)==null?void 0:n.name)=="string"&&typeof((i=t.HEAD)==null?void 0:i.sha)=="string"&&(typeof((o=t.HEAD.detached)==null?void 0:o.name)=="string"&&typeof((a=t.HEAD.detached)==null?void 0:a.type)=="number"||typeof((s=t.HEAD.branch)==null?void 0:s.name)=="string")&&typeof((l=t.defaultBranch)==null?void 0:l.name)=="string"&&typeof t.defaultBranch.sha=="string"}assertMatchingScheme(t){if(t.scheme!==Dt.scheme)throw new Error(`Uri scheme '${t.scheme}' must match configured scheme '${Dt.scheme}'; uri=${t.toString()}`)}getStorageKey(t){return`metadata/${t}`}fromStorage(t){if(!t)return;const e=JSON.parse(t,(r,n)=>(r==="uri"||r.endsWith("Uri"))&&rt(n)?h.Uri.from(n):n);return e==null?void 0:e.revision}toStorage(t){const e={schemaVersion:lt.storageSchemaVersion,revision:t};return JSON.stringify(e)}},"_MetadataStore");let Ke=lt;Ke.schemaVersion=6,Ke.storageSchemaVersion=1;var Se;(function(t){t[t.Admin=100]="Admin",t[t.Maintain=40]="Maintain",t[t.WriteToPullRequest=31]="WriteToPullRequest",t[t.Write=30]="Write",t[t.Triage=20]="Triage",t[t.Read=10]="Read",t[t.None=0]="None"})(Se||(Se={}));var he;(function(t){t[t.Branch=0]="Branch",t[t.RemoteBranch=1]="RemoteBranch",t[t.Tag=2]="Tag",t[t.Commit=3]="Commit"})(he||(he={}));class nt extends Error{constructor(e,r){super(typeof e=="string"?e:e.message);this.reauthenticate=r;var n;this.original=typeof e!="string"?e:void 0,(n=Error.captureStackTrace)==null||n.call(Error,this,nt)}}c(nt,"InvalidCredentialsError");class Je extends Error{constructor(e,r,n){super(e.message);this.original=e,this.name=r,this.id=n;var i;(i=Error.captureStackTrace)==null||i.call(Error,this,Je)}}c(Je,"PullRequestNotFoundError");class te extends Error{constructor(e,r){super(e.message);this.original=e,this.name=r;var n;(n=Error.captureStackTrace)==null||n.call(Error,this,te)}}c(te,"RepositoryForbiddenError");class gt extends Error{constructor(e,r){super(e.message);this.original=e,this.name=r;var n;(n=Error.captureStackTrace)==null||n.call(Error,this,gt)}}c(gt,"RepositoryNotFoundError");class Ge extends Error{constructor(e,r){super(e.message);this.original=e,this.name=r;var n;(n=Error.captureStackTrace)==null||n.call(Error,this,Ge)}}c(Ge,"RepositoryEmptyError");class ot extends Error{constructor(e){super(e);var r;(r=Error.captureStackTrace)==null||r.call(Error,this,ot)}}c(ot,"DetachedHEADError");class fe extends Error{constructor(e,r){super(e.message);this.original=e,this.duplicate=r;var n;(n=Error.captureStackTrace)==null||n.call(Error,this,fe)}}c(fe,"InvalidBranchNameError");class de extends Error{constructor(e){super(e.message);this.original=e;var r;(r=Error.captureStackTrace)==null||r.call(Error,this,de)}}c(de,"MergeConflictError");class We extends Error{constructor(e){super(e);var r;(r=Error.captureStackTrace)==null||r.call(Error,this,We)}}c(We,"NothingToCommitError");class Qe extends Error{constructor(e=!1){super(e?"Unable to sync the repository":"Unable to fetch the repository");var r;(r=Error.captureStackTrace)==null||r.call(Error,this,Qe)}}c(Qe,"SyncOrFetchError");class mt extends Error{constructor(){super("Sync operation will result in conflicts");var e;(e=Error.captureStackTrace)==null||e.call(Error,this,mt)}}c(mt,"SyncConflictsError");class Zt extends Error{constructor(){super("Failed to create and push commit");var e;(e=Error.captureStackTrace)==null||e.call(Error,this,Zt)}}c(Zt,"CommitFailedError");class yt extends Error{constructor(e){var r;const n=typeof e=="string"?e:Dt.getProviderId(e);super(`No provider registered with ${n}`);this.id=n,(r=Error.captureStackTrace)==null||r.call(Error,this,yt)}}c(yt,"ProviderNotFoundError");const It=/^[0-9a-f]{40}$/i;function Jt(t){return t!==void 0&&It.test(t)}c(Jt,"isSha");const xr=/^[^/](?!.*\/\.)(?!.*\.\.)(?!.*\/\/)(?!.*@\{)[^\000-\037\177 ~^:?*[\\]+[^./]$/;function ir(t){return xr.test(t)}c(ir,"isValidBranchName");function Ve(t){return t===""||t==="~"||t==="HEAD"?t:t.endsWith("^")?`${t.substr(0,7)}^`:t.substr(0,7)}c(Ve,"shortenRef");var ke;(function(t){t[t.Branch=0]="Branch",t[t.Tag=1]="Tag",t[t.Commit=2]="Commit",t[t.PullRequest=3]="PullRequest",t[t.Tree=4]="Tree"})(ke||(ke={}));class Pn{constructor(e,r,n,i,o){this.providerService=e,this.uri=r,this.id=n,this.name=i,this.provider={id:o.id,name:o.name}}get canonicalUri(){return this.providerService.getVirtualCanonicalRootUri(this.uri)}createRelativeUri(e){return this.providerService.createRelativeUri(this.uri,e)}async getMetadata(){const e=await this.providerService.getMetadata(this.uri);if(!e)throw new Error(`Unable to find metadata for ${this.uri.toString()}`);return e}async getIndexMetadata(){return this.providerService.getIndexMetadata(this.uri)}getUriMetadata(){return this.providerService.getVirtualUriMetadata(this.uri)}}c(Pn,"VirtualRepository");var Ie;(function(t){t[t.Repository=0]="Repository",t[t.PullRequest=1]="PullRequest",t[t.Branch=2]="Branch",t[t.Commit=3]="Commit",t[t.File=4]="File",t[t.Tag=5]="Tag"})(Ie||(Ie={}));var at;(function(t){t[t.Clone=-1]="Clone",t[t.Repository=0]="Repository",t[t.PullRequest=1]="PullRequest",t[t.Branch=2]="Branch",t[t.Commit=3]="Commit",t[t.Tag=4]="Tag"})(at||(at={}));var Ae;(function(t){t[t.Open=0]="Open",t[t.Closed=1]="Closed",t[t.Merged=2]="Merged"})(Ae||(Ae={}));var Oe;(function(t){t[t.NotIndexed=0]="NotIndexed",t[t.Indexed=1]="Indexed",t[t.Match=2]="Match",t[t.Active=3]="Active"})(Oe||(Oe={})),function(t){function e(r){return r!==void 0&&(r===t.Indexed||r===t.Match||r===t.Active)}c(e,"hasIndex"),t.hasIndex=e}(Oe||(Oe={}));var Nt;(function(t){function e(r){return r!==void 0&&r.type===3}c(e,"isActive"),t.isActive=e})(Nt||(Nt={}));var bt;(function(t){t[t.Latest=1]="Latest",t[t.SHA=2]="SHA"})(bt||(bt={}));var At;(function(t){function e(r){const n=Dt.decodeAuthority(r).metadata;if(!(n===void 0||n.idx===void 0)){if(n.idx==="latest")return{type:1};if(Jt(n.idx))return{type:2,sha:n.idx}}}c(e,"decode"),t.decode=e})(At||(At={}));function*k(t,e){for(const r of t)yield*e(r)}c(k,"flatMap");function*m(t,e){for(const r of t)e(r)&&(yield r)}c(m,"filter");function*w(t,e){for(const r of t){const n=e(r);n!=null&&(yield n)}}c(w,"filterMap");function U(t,e){for(const r of t)if(e(r))return r}c(U,"find");function X(t,e){let r="";const n=t[Symbol.iterator]();let i=n.next();if(i.done)return r;for(;;){const o=i.value.toString();if(i=n.next(),i.done){r+=o;break}r+=o,r+=e}return r}c(X,"join");function*se(t,e){for(const r of t)yield e(r)}c(se,"map");function ye(t,e){for(const r of t)if(e(r))return!0;return!1}c(ye,"some");function*ft(...t){for(const e of t)for(const r of e)yield r}c(ft,"union");function*zt(t){const e=new Set;for(const r of t)e.has(r)||(e.add(r),yield r)}c(zt,"unique");const Mt="";function jt(...t){if(t.length===1){const e=t[0];return e===void 0?Mt:typeof e=="string"?e:typeof e=="number"||typeof e=="boolean"||e instanceof Error?String(e):e instanceof h.Uri?e.toString():JSON.stringify(e)}return JSON.stringify(t)}c(jt,"defaultResolver");function dt(t){return(e,r,n)=>{let i;if(typeof n.value=="function"?i=n.value:typeof n.get=="function"&&(i=n.get),i===void 0)throw new Error("Not supported");const o=`$serialize$${r}`;n.value=function(...a){const s=a.length===0?o:`${o}$${(t!=null?t:jt)(...a)}`;Object.prototype.hasOwnProperty.call(this,s)||Object.defineProperty(this,s,{configurable:!1,enumerable:!1,writable:!0,value:void 0});let l=this[s];const u=c(()=>i.apply(this,a),"run");return l===void 0?l=u():l=l.then(u,u),this[s]=l,l}}}c(dt,"serialize");function Pi(t){const e=performance.now()*.001;let r=Math.floor(e),n=Math.floor(e%1*1e9);return t!==void 0&&(r=r-t[0],n=n-t[1],n<0&&(r--,n+=1e9)),[r,n]}c(Pi,"hrtime");let za=0;function xu(){return za===Number.MAX_SAFE_INTEGER&&(za=0),++za}c(xu,"getNextInstanceId");const gn=c(class{constructor(t,e,...r){this.context=t,this.instance=`[${xu().toString().padStart(5)}] `;var n,i,o,a,s,l;let u;if(typeof(e==null?void 0:e.log)=="boolean"?u=e.log?{}:void 0:u=(n=e==null?void 0:e.log)!=null?n:{},this.logLevel=(i=e==null?void 0:e.logLevel)!=null?i:ie.Info,this.time=Pi(),u){if(!C.enabled(this.logLevel))return;r.length?Fi(this.logLevel,`${this.instance}${(o=u.prefix)!=null?o:""}${t}${(a=u.message)!=null?a:""}`,...r):Fi(this.logLevel,`${this.instance}${(s=u.prefix)!=null?s:""}${t}${(l=u.message)!=null?l:""}`)}}log(t){this.logCore(this.context,t,!1)}logStep(t,e){(!t||e)&&this.logCore(this.context,e,!1),this.step=t?{time:Pi(),label:t}:void 0}restart(t){this.logCore(this.context,t,!0),this.step=void 0,this.time=Pi()}stop(t){this.restart(t)}logCore(t,e,r){var n,i,o,a,s,l,u;if(!C.enabled(this.logLevel))return;let d="";if(this.step){const[x,y]=Pi(this.step.time),b=x*1e3+Math.floor(y/1e6);d=`${this.step.label?`${this.step.label} took `:""}${b} ms`}if(!r){Fi(this.logLevel,`${this.instance}${(n=e==null?void 0:e.prefix)!=null?n:""}${t}${(i=e==null?void 0:e.message)!=null?i:""}${d?` ${d}`:""}${(o=e==null?void 0:e.suffix)!=null?o:""}`);return}const[p,f]=Pi(this.time),g=p*1e3+Math.floor(f/1e6);Fi(g>500?ie.Warn:this.logLevel,`${this.instance}${(a=e==null?void 0:e.prefix)!=null?a:""}${t}${(s=e==null?void 0:e.message)!=null?s:""}${(l=e==null?void 0:e.took)!=null?l:" took "}${g} ms${d?` (${d})`:""}${(u=e==null?void 0:e.suffix)!=null?u:""}`)}static start(t,e,...r){var n;(n=gn.watches.get(t))==null||n.log(),gn.watches.set(t,new gn(t,e,...r))}static log(t,e){var r;(r=gn.watches.get(t))==null||r.log(e)}static stop(t,e){var r;(r=gn.watches.get(t))==null||r.stop(e),gn.watches.delete(t)}},"_Stopwatch");let Be=gn;Be.watches=new Map;function Fi(t,e,...r){switch(t){case ie.Warn:C.warn(e,...r);break;case ie.Info:C.log(e,...r);break;default:C.debug(e,...r);break}}c(Fi,"log");const Wa=new TextDecoder,qa=new TextEncoder;async function mn(t){const e=typeof t=="string"?qa.encode(t):t;let r;if(globalThis.crypto.subtle)r=await globalThis.crypto.subtle.digest({name:"sha-1"},e);else{const n=new xc;n.update(e),r=n.digest()}return globalThis.btoa(encodeURIComponent(Wa.decode(r)))}c(mn,"sha1");var wc;(function(t){t[t.BLOCK_SIZE=64]="BLOCK_SIZE"})(wc||(wc={}));function ja(t,e,r=32){const n=r-e,i=~((1<<n)-1);return(t<<e|(i&t)>>>n)>>>0}c(ja,"leftRotate");function yc(t,e=0,r=t.byteLength,n=0){for(let i=0;i<r;i++)t[e+i]=n}c(yc,"fill");const bc=c(class{constructor(){this._h0=1732584193,this._h1=4023233417,this._h2=2562383102,this._h3=271733878,this._h4=3285377520,this._buff=new Uint8Array(64+3),this._buffDV=new DataView(this._buff.buffer),this._buffLen=0,this._totalLen=0,this._finished=!1}update(t){const e=this._buff;let r=this._buffLen,n=0;const i=t.byteLength;for(;n<i;){const o=Math.min(64-r,i-n);for(let a=0;a<o;a++)e[r++]=t[n++];r>=64&&(this._step(),r-=64,this._totalLen+=64)}this._buffLen=r}digest(){this._finished||(this._finished=!0,this._totalLen+=this._buffLen,this._wrapUp());const t=new ArrayBuffer(20),e=new DataView(t);return e.setUint32(0,this._h0,!1),e.setUint32(4,this._h1,!1),e.setUint32(8,this._h2,!1),e.setUint32(12,this._h3,!1),e.setUint32(16,this._h4,!1),t}_wrapUp(){this._buff[this._buffLen++]=128,yc(this._buff,this._buffLen),this._buffLen>56&&(this._step(),yc(this._buff));const t=8*this._totalLen;this._buffDV.setUint32(56,Math.floor(t/4294967296),!1),this._buffDV.setUint32(60,t%4294967296,!1),this._step()}_step(){const t=bc._bigBlock32,e=this._buffDV;for(let d=0;d<64;d+=4)t.setUint32(d,e.getUint32(d,!1),!1);for(let d=64;d<320;d+=4)t.setUint32(d,ja(t.getUint32(d-12,!1)^t.getUint32(d-32,!1)^t.getUint32(d-56,!1)^t.getUint32(d-64,!1),1),!1);let r=this._h0,n=this._h1,i=this._h2,o=this._h3,a=this._h4,s,l,u;for(let d=0;d<80;d++)d<20?(s=n&i|~n&o,l=1518500249):d<40?(s=n^i^o,l=1859775393):d<60?(s=n&i|n&o|i&o,l=2400959708):(s=n^i^o,l=3395469782),u=ja(r,5)+s+a+l+t.getUint32(d*4,!1)&4294967295,a=o,o=i,i=ja(n,30),n=r,r=u;this._h0=this._h0+r&4294967295,this._h1=this._h1+n&4294967295,this._h2=this._h2+i&4294967295,this._h3=this._h3+o&4294967295,this._h4=this._h4+a&4294967295}},"_SHA1Computer");let xc=bc;xc._bigBlock32=new DataView(new ArrayBuffer(320));function _c(t){const e=globalThis.atob(t),r=e.length,n=new Uint8Array(r);for(let i=0;i<r;i++)n[i]=e.charCodeAt(i);return n}c(_c,"fromBase64");const{fromCharCode:Va}=String;function Jr(t){let e;if(typeof t=="string")e=t;else{e="";for(let r=0,{length:n}=t;r<n;r++)e+=Va(t[r])}return globalThis.btoa(e)}c(Jr,"toBase64");const _u=new TextDecoder,Su=new TextEncoder,Cu=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];function Ga(t){const e=Su.encode(t),r=new Array(e.length);for(let n=0;n<e.length;++n)r[n]=Cu[e[n]];return r.join("")}c(Ga,"encodeUtf8Hex");function Sc(t){const e=t.match(/(\w{2})/g);if(e===null)return"";const r=new Uint8Array(e.map(n=>parseInt(n,16)));return _u.decode(r)}c(Sc,"decodeUtf8Hex");function vn(t,e){if(t===e)return-1;let r=0;for(;t[r]===e[r];)r++;return r}c(vn,"indexOfDifference");var gp=__webpack_require__(5102),Eu=Object.defineProperty,Ru=Object.getOwnPropertyDescriptor,Au=c((t,e,r,n)=>{for(var i=n>1?void 0:n?Ru(e,r):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&Eu(e,r,i),i},"__decorateClass"),Br;(function(t){t[t.Abort=0]="Abort",t[t.KeepCurrent=1]="KeepCurrent",t[t.DiscardCurrent=2]="DiscardCurrent",t[t.Merge=3]="Merge"})(Br||(Br={}));const Ot=c(class{constructor(t,e){this.metadataStore=t,this.telemetryService=e,this._providers=new Map,this._onDidChangeProviders=new h.EventEmitter,this._repositories=new Map,this._onDidChangeRepositories=new h.EventEmitter,this._onDidChangeRepository=new h.EventEmitter,this._onDidSyncRepository=new h.EventEmitter,this._onDidRefresh=new h.EventEmitter,this._onWillRefresh=new h.EventEmitter,this.pendingMetadataRequests=new Map,this.disposable=h.Disposable.from(h.workspace.onDidChangeWorkspaceFolders(this.onWorkspaceFoldersChanged,this),t.onDidChange(r=>this.onMetadataChanged(r)))}get onDidChangeProviders(){return this._onDidChangeProviders.event}get onDidChangeRepositories(){return this._onDidChangeRepositories.event}get onDidChangeRepository(){return this._onDidChangeRepository.event}get onDidSyncRepository(){return this._onDidSyncRepository.event}get onDidRefresh(){return this._onDidRefresh.event}get onWillRefresh(){return this._onWillRefresh.event}dispose(){this.disposable.dispose(),this._providers.clear(),this._repositories.clear()}onMetadataChanged(t){const e=this._repositories.get(H(t.uri));!e||(C.log(`VirtualProviderService.onMetadataChanged(${t.uri.toString()}, reason=${t.reason}): Firing onDidChangeRepository...`),this._onDidChangeRepository.fire({repository:e,reason:t.reason==="revision"?"HEAD":void 0}))}onWorkspaceFoldersChanged(t){if(t.added.length)for(const e of t.added){const r=H(e.uri);if(e.uri.scheme!==Ot.scheme||this._repositories.has(r))continue;const n=this.getProvider(e.uri);if(!n)continue;this._repositories.set(r,null);const{repo:i,name:o}=this.getVirtualUriMetadata(e.uri),a=new Pn(this,e.uri,i,o,n);this._repositories.set(r,a),this._onDidChangeRepositories.fire({added:[a],removed:[]}),this.telemetryService.sendEvent("repository.opened",{provider:n.id,repositories:this._repositories.size.toString()})}if(t.removed.length)for(const e of t.removed){const r=H(e.uri);if(e.uri.scheme!==Ot.scheme||!this._repositories.has(r))continue;const n=this._repositories.get(r);this._repositories.delete(r),n&&(this._onDidChangeRepositories.fire({added:[],removed:[n]}),this.telemetryService.sendEvent("repository.closed",{repositories:this._repositories.size.toString()}))}bi(jn.HasVirtualFolders,this._repositories.size!==0),bi(jn.VirtualFolderProviders,X(zt(se(this.getRepositories(),e=>e.provider.id)),","))}get hasProviders(){return this._providers.size!==0}get registeredProviders(){return[...se(this._providers.values(),t=>({id:t.id,name:t.name}))]}get repositories(){return[...this.getRepositories()]}register(t,e,r,n,i){var o;if(this._providers.has(t))throw new Error(`Provider '${t}' has already been registered`);const a={id:t,name:e,provider:r,fs:n,index:i};return this._providers.set(t,a),this._onDidChangeProviders.fire({added:[a],removed:[]}),this.telemetryService.sendEvent("provider.registered",{provider:t}),this.onWorkspaceFoldersChanged({added:(o=h.workspace.workspaceFolders)!=null?o:[],removed:[]}),{dispose:()=>{this._providers.delete(t);const s=[];for(const[l,u]of[...this._repositories])(u==null?void 0:u.provider.id)===t&&(this._repositories.delete(l),s.push(u));this._onDidChangeRepositories.fire({added:[],removed:s}),this._onDidChangeProviders.fire({added:[],removed:[a]})}}}refresh(){if(this._providers.size===0)return;const t=[],e=[];for(const r of this._providers.values())t.push(...se(this.getRepositories(r.id),n=>n.uri)),r.index!==void 0&&e.push(r.index);this._onWillRefresh.fire(t),this.metadataStore.refresh(),e.forEach(r=>r.refresh(t)),this._onDidRefresh.fire(t)}getRegisteredProvider(t){const e=this.getProvider(t);return e?{id:e.id,name:e.name}:void 0}getRepository(t,e){const r=h.workspace.getWorkspaceFolder(t);if(!r||r.uri.scheme!==Ot.scheme)return;const n=this._repositories.get(H(r.uri));if(!(e!==void 0&&(n==null?void 0:n.provider.id)!==e))return n!=null?n:void 0}getRepositories(t){return m(this._repositories.values(),e=>e!==null&&(!t||e.provider.id===t))}getOpenUris(t,e){const r=new Map,n=h.workspace.textDocuments;if(n.length===0)return r;for(const i of n)i.uri.scheme===t&&e.some(o=>_e(i.uri,o))&&r.set(H(i.uri),i.uri);return r}hasProvider(t,e){const r=typeof t=="string"?t:Ot.getProviderId(t),n=this._providers.get(r);return e!==void 0&&(n==null?void 0:n.id)!==e?!1:n!==void 0}isReadonly(t){var e;return Boolean((e=this.getProvider(t))==null?void 0:e.provider.isReadonly)}getProvider(t){const e=typeof t=="string"?t:Ot.getProviderId(t);return this._providers.get(e)}getRepositoryProvider(t){var e;const r=(e=this.getProvider(t))==null?void 0:e.provider;if(r)return r;throw new yt(t)}getFileSystemProvider(t){var e;const r=(e=this.getProvider(t))==null?void 0:e.fs;if(r)return r;throw new yt(t)}getRemoteWorkspaceSourceProviders(t){var e,r,n,i;return t?(i=(n=(e=this.getProvider(t))==null?void 0:(r=e.provider).getRemoteWorkspaceSourceProviders)==null?void 0:n.call(r))!=null?i:[]:[...k(this._providers.values(),o=>{var a,s,l;return(l=(s=(a=o.provider).getRemoteWorkspaceSourceProviders)==null?void 0:s.call(a))!=null?l:[]})]}isInWorkspace(t){return this.getVirtualWorkspaceUri(t)!==void 0}getAuthentication(t){const e=this.getProvider(t);if(!e)throw new yt(t);return e==null?void 0:e.provider.getAuthentication(t)}canOpenRemoteUrl(t,e){if(e){const r=this.getProvider(e),n=r==null?void 0:r.provider.canOpenRemoteUrl(t);return n!==void 0?{provider:r,urlType:n}:void 0}for(const r of this._providers.values()){const n=r.provider.canOpenRemoteUrl(t);if(n!==void 0)return{provider:r,urlType:n}}}async createWorkspaceForRemoteUrl(t,e,r=$t.CurrentWindow){var n;const i=this.canOpenRemoteUrl(t,e);return(n=i==null?void 0:i.provider)==null?void 0:n.provider.createWorkspaceForRemoteUrl(t,r)}createProviderUri(t,e,r){return this.getProviderUri(this.getRepositoryProvider(t).createVirtualUri(Ot.baseVirtualWorkspaceUri,e,r))}createRelativeProviderUri(t,e){return this.getProviderUri(this.createRelativeUri(t,e))}createRelativeUri(t,e){const r=this.getProviderRootUri(t);let n=`${r.path}/`;n.endsWith("/")&&(n=n.slice(0,-1));const i=r.with({path:`${r.path}/${e.startsWith("/")?e.substr(1):e}`});return t.scheme===Ot.scheme?this.getVirtualUri(i):i}createRelativeVirtualUri(t,e){return this.getVirtualUri(this.createRelativeUri(t,e))}createVirtualUri(t,e,r){return this.getRepositoryProvider(t).createVirtualUri(Ot.baseVirtualWorkspaceUri,e,r)}async getBestRemoteUri(t,e){const{provider:r,repo:n,ref:i}=this.getVirtualUriMetadata(t);if(e===at.Repository)return this.getRemoteUri(r.id,{repo:n});if(e===at.Clone)return this.getRemoteUri(r.id,{repo:n,clone:!0});if(e===at.PullRequest||e===void 0&&(i==null?void 0:i.type)===ke.PullRequest){if((i==null?void 0:i.type)===ke.PullRequest)return this.getRemoteUri(r.id,{repo:n,pullRequest:{id:i.id}});const{pullRequest:o}=await this.getMetadata(t);if(e===at.PullRequest&&o)return this.getRemoteUri(r.id,{repo:n,pullRequest:{id:o.id}})}if(e===at.Branch||e===void 0&&(i==null?void 0:i.type)===ke.Branch){if((i==null?void 0:i.type)===ke.Branch)return this.getRemoteUri(r.id,{repo:n,branch:i.id});const{HEAD:o}=await this.getMetadata(t);if(o.type===he.Branch||o.type===he.RemoteBranch&&e===at.Branch)return this.getRemoteUri(r.id,{repo:n,branch:o.branch.name})}if(e===at.Tag||e===void 0&&(i==null?void 0:i.type)===ke.Tag){if((i==null?void 0:i.type)===ke.Tag)return this.getRemoteUri(r.id,{repo:n,tag:i.id});const{HEAD:o}=await this.getMetadata(t);if(o.type===he.Tag)return this.getRemoteUri(r.id,{repo:n,tag:o.detached.name})}if(e===at.Commit||e===void 0&&((i==null?void 0:i.type)===ke.Commit||(i==null?void 0:i.type)===ke.Tree&&Jt(i.id))){if((i==null?void 0:i.type)===ke.Commit||(i==null?void 0:i.type)===ke.Tree&&Jt(i.id))return this.getRemoteUri(r.id,{repo:n,sha:i.id});const{HEAD:o}=await this.getMetadata(t);if(e===at.Commit||o.type===he.Commit)return this.getRemoteUri(r.id,{repo:n,sha:o.sha})}if(e===void 0)return this.getRemoteUri(r.id,{repo:n})}getCanonicalUri(t){let{authority:e}=t;const r=e.indexOf(Ot.authoritySeparator);return r!==-1&&(e=e.substr(0,r)),t.with({authority:e})}getRemoteUri(t,e){var r,n;return(n=(r=this.getRepositoryProvider(t)).getRemoteUri)==null?void 0:n.call(r,e)}getProviderUri(t){return t.scheme!==Ot.scheme?t:t.with({scheme:Ot.getProviderId(t)})}getProviderRootUri(t){return t=this.getProviderUri(t),this.getRepositoryProvider(t).getProviderRootUri(t)}getRelativeFilePath(t,e){return e=this.getProviderUri(e!=null?e:t),this.getRepositoryProvider(e).getRelativeFilePath(t,e)}getVirtualUriMetadata(t){return this.getRepositoryProvider(t).getVirtualUriMetadata(t)}getVirtualUri(t){return t.scheme===Ot.scheme?t:t.with({scheme:Ot.scheme})}getVirtualCanonicalRootUri(t){const e=this.getVirtualUri(this.getProviderRootUri(t));let{authority:r}=e;const n=r.indexOf(Ot.authoritySeparator);return n!==-1&&(r=r.substr(0,n)),e.with({authority:r})}getVirtualRootUri(t){return this.getVirtualUri(this.getProviderRootUri(t))}getVirtualWorkspaceUri(t){var e;return(e=h.workspace.getWorkspaceFolder(this.getVirtualUri(t)))==null?void 0:e.uri}createIGitRepository(t,e,r,n){var i,o;return(o=(i=this.getRepositoryProvider(t)).createIGitRepository)==null?void 0:o.call(i,t,e,r,n)}async getCommitOperations(t,e,r){let n;return(r==null?void 0:r.staged)?(n=await e.getStagedChanges(t),n.length===0&&r.staged==="auto"&&(n=await e.getChanges(t))):n=await e.getChanges(t),n.map(o=>{const a=this.getRelativeFilePath(t,o.uri);switch(o.type){case ut.Created:return{type:o.type,path:a,fileType:o.fileType,content:e.readFile(o.uri).then(s=>s!=null?s:new Uint8Array)};case ut.Changed:return{type:o.type,path:a,fileType:o.fileType,content:e.readFile(o.uri).then(s=>s!=null?s:new Uint8Array)};case ut.Deleted:return{type:o.type,path:a,fileType:o.fileType,content:void 0}}})}async getMetadata(t){return{...await this.getMetadataCore(this.getVirtualRootUri(t)),path:this.getRelativeFilePath(t,t)}}async getIndexMetadata(t){const e=this.getProvider(t);return(e==null?void 0:e.index)?e.index.getIndexMetadata(t):void 0}getModeConfig(t,e,r){return P.getMode(this.getVirtualRootUri(t),e,Boolean(r))}async getModeRefType(t,e){return t=this.getVirtualRootUri(t),this.getRepositoryProvider(t).getModeRefType(t,e)}getIndexProvider(t){var e;return(e=this.getProvider(t))==null?void 0:e.index}async getMetadataCore(t){const e=H(t);let r=this.pendingMetadataRequests.get(e);if(r)return r;let{revision:n,cachedMetadata:i}=await this.metadataStore.get(t);if(i!==void 0)return i;const o=this.getProvider(t);if(!o)throw new yt(t);const a=At.decode(t);(a==null?void 0:a.type)===bt.SHA&&(n=a.sha),r=o.provider.createMetadata(t,n),this.pendingMetadataRequests.set(e,r);try{const s=await r;return await this.updateMetadataCore(t,s,{silent:!0}),s}finally{this.pendingMetadataRequests.delete(e)}}async updateMetadata(t,e){const r=new Be(`VirtualProviderService.updateMetadata(${t.toString()})`,{},e.HEAD.sha);try{await this.metadataStore.set(this.getVirtualUri(t),e.HEAD.sha,e)}finally{r.stop()}}updateMetadataCore(t,e,r){return this.metadataStore.set(this.getVirtualUri(t),e.HEAD.sha,e,r)}async clone(t){const e=await this.getBestRemoteUri(t,at.Clone);if(!e)throw new Error("No url found for clone");if(An)return void h.env.openExternal(h.Uri.parse(`${h.env.uriScheme}://vscode.git/clone?url=${encodeURIComponent(e.toString(!0))}`));const r=c(async n=>{try{await n.activate(),await h.commands.executeCommand("git.clone",e.toString(!0))}catch(i){C.error(i,"Unable to clone repository")}},"cloneRepository");if(h.workspace.isTrusted){const n=h.extensions.getExtension("vscode.git");if(n)await r(n);else throw new Error("Git extension not found")}else{const n=h.extensions.onDidChange(async()=>{const o=h.extensions.getExtension("vscode.git");o&&(await r(o),n.dispose())});await h.workspace.requestWorkspaceTrust()||n.dispose()}}createBranch(t,e,r,n){return this.getRepositoryProvider(t).createBranch(t,e,r,n)}createCommit(t,e,r,n){return this.getRepositoryProvider(t).createCommit(t,e,r,n)}createAndPushCommit(t,e,r,n,i){return this.getRepositoryProvider(t).createAndPushCommit(t,e,r,n,i)}createPullRequest(t,e,r,n,i){return this.getRepositoryProvider(t).createPullRequest(t,e,r,n,i)}fetch(t,e){return this.getRepositoryProvider(t).fetch(t,e)}fork(t){return this.getRepositoryProvider(t).fork(t)}getBranches(t,e){return this.getRepositoryProvider(t).getBranches(t,e)}getCommit(t,e){return this.getRepositoryProvider(t).getCommit(t,e)}getCommits(t,e){var r;return(r=this.getRepositoryProvider(t))==null?void 0:r.getCommits(t,e)}compareCommits(t,e){var r;return(r=this.getRepositoryProvider(t))==null?void 0:r.compareCommits(t,e)}getFileContent(t,e,r){return this.getRepositoryProvider(t).getFileContent(t,e,r)}getFork(t){return this.getRepositoryProvider(t).getFork(t)}async getIncomingChanges(t){var e,r,n;return(n=(r=(e=this.getRepositoryProvider(t)).getIncomingChanges)==null?void 0:r.call(e,t))!=null?n:[]}getPullRequest(t,e){return this.getRepositoryProvider(t).getPullRequest(t,e)}getTags(t,e){return this.getRepositoryProvider(t).getTags(t,e)}getSnapshots(t,e){var r,n;return(n=(r=this.getIndexProvider(t))==null?void 0:r.getSnapshots(t,e))!=null?n:Promise.resolve([])}async getTarGz(t){var e,r;return(r=(e=this.getRepositoryProvider(t)).getTarGz)==null?void 0:r.call(e,t)}pushCommit(t,e,r,n){return this.getRepositoryProvider(t).pushCommit(t,e,r,n)}switchTo(t,e,r){return this.getRepositoryProvider(t).switchTo(t,e,r)}async sync(t,e,r){const n=this._repositories.get(H(t));n&&this._onDidSyncRepository.fire({repository:n,syncing:!0});try{const i=this.getProvider(t);if(i===void 0)throw new yt(t);let{to:o,reason:a,...s}=r!=null?r:{};return o===void 0&&i.index&&(o=await i.index.resolveIndexRef(t,a==="user")),await i.provider.sync(t,e,{conflictResolution:0,...s,to:o})}finally{n&&this._onDidSyncRepository.fire({repository:n,syncing:!1})}}stat(t){return this.getFileSystemProvider(t).stat(t)}readDirectory(t){return this.getFileSystemProvider(t).readDirectory(t)}readFile(t){return this.getFileSystemProvider(t).readFile(t)}watch(t,e){return this.getFileSystemProvider(t).watch(t,e)}provideFileSearchResults(t,e,r){return this.getFileSystemProvider(e.folder).provideFileSearchResults(t,e,r)}provideTextSearchResults(t,e,r,n){return this.getFileSystemProvider(e.folder).provideTextSearchResults(t,e,r,n)}static decodeAuthority(t,e){const[r,n]=t.authority.split(Ot.authoritySeparator);let i;if(n)try{const o=JSON.parse(Sc(n));i=e?e(o):o}catch{}return{scheme:r,metadata:i}}static encodeAuthority(t,e){const r=e?`${Ot.authoritySeparator}${Ga(JSON.stringify(e))}`:"";return`${t}${r}`}static getProviderId(t){const{authority:e}=t,r=e.indexOf(Ot.authoritySeparator);return r!==-1?e.substr(0,r):e}static isCanonicalUri(t){return t.authority.indexOf(Ot.authoritySeparator)===-1}},"_VirtualProviderService");let Dt=Ot;Dt.scheme="vscode-vfs",Dt.authoritySeparator="+",Dt.baseVirtualWorkspaceUri=h.Uri.parse(`${Ot.scheme}://`),Au([dt()],Dt.prototype,"getMetadataCore",1);function wn(){}c(wn,"Diff"),wn.prototype={diff:c(function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=n.callback;typeof n=="function"&&(i=n,n={}),this.options=n;var o=this;function a(y){return i?(setTimeout(function(){i(void 0,y)},0),!0):y}c(a,"done"),e=this.castInput(e),r=this.castInput(r),e=this.removeEmpty(this.tokenize(e)),r=this.removeEmpty(this.tokenize(r));var s=r.length,l=e.length,u=1,d=s+l,p=[{newPos:-1,components:[]}],f=this.extractCommon(p[0],r,e,0);if(p[0].newPos+1>=s&&f+1>=l)return a([{value:this.join(r),count:r.length}]);function g(){for(var y=-1*u;y<=u;y+=2){var b=void 0,S=p[y-1],E=p[y+1],D=(E?E.newPos:0)-y;S&&(p[y-1]=void 0);var $=S&&S.newPos+1<s,z=E&&0<=D&&D<l;if(!$&&!z){p[y]=void 0;continue}if(!$||z&&S.newPos<E.newPos?(b=ku(E),o.pushComponent(b.components,void 0,!0)):(b=S,b.newPos++,o.pushComponent(b.components,!0,void 0)),D=o.extractCommon(b,r,e,y),b.newPos+1>=s&&D+1>=l)return a(Tu(o,b.components,r,e,o.useLongestToken));p[y]=b}u++}if(c(g,"execEditLength"),i)c(function y(){setTimeout(function(){if(u>d)return i();g()||y()},0)},"exec")();else for(;u<=d;){var x=g();if(x)return x}},"diff"),pushComponent:c(function(e,r,n){var i=e[e.length-1];i&&i.added===r&&i.removed===n?e[e.length-1]={count:i.count+1,added:r,removed:n}:e.push({count:1,added:r,removed:n})},"pushComponent"),extractCommon:c(function(e,r,n,i){for(var o=r.length,a=n.length,s=e.newPos,l=s-i,u=0;s+1<o&&l+1<a&&this.equals(r[s+1],n[l+1]);)s++,l++,u++;return u&&e.components.push({count:u}),e.newPos=s,l},"extractCommon"),equals:c(function(e,r){return this.options.comparator?this.options.comparator(e,r):e===r||this.options.ignoreCase&&e.toLowerCase()===r.toLowerCase()},"equals"),removeEmpty:c(function(e){for(var r=[],n=0;n<e.length;n++)e[n]&&r.push(e[n]);return r},"removeEmpty"),castInput:c(function(e){return e},"castInput"),tokenize:c(function(e){return e.split("")},"tokenize"),join:c(function(e){return e.join("")},"join")};function Tu(t,e,r,n,i){for(var o=0,a=e.length,s=0,l=0;o<a;o++){var u=e[o];if(u.removed){if(u.value=t.join(n.slice(l,l+u.count)),l+=u.count,o&&e[o-1].added){var p=e[o-1];e[o-1]=e[o],e[o]=p}}else{if(!u.added&&i){var d=r.slice(s,s+u.count);d=d.map(function(g,x){var y=n[l+x];return y.length>g.length?y:g}),u.value=t.join(d)}else u.value=t.join(r.slice(s,s+u.count));s+=u.count,u.added||(l+=u.count)}}var f=e[a-1];return a>1&&typeof f.value=="string"&&(f.added||f.removed)&&t.equals("",f.value)&&(e[a-2].value+=f.value,e.pop()),e}c(Tu,"buildValues");function ku(t){return{newPos:t.newPos,components:t.components.slice(0)}}c(ku,"clonePath");var Iu=new wn;function Ka(t,e,r){return Iu.diff(t,e,r)}c(Ka,"diffChars");function Cc(t,e){if(typeof t=="function")e.callback=t;else if(t)for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}c(Cc,"generateOptions");var Ec=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,yn=/\S/,Ho=new wn;Ho.equals=function(t,e){return this.options.ignoreCase&&(t=t.toLowerCase(),e=e.toLowerCase()),t===e||this.options.ignoreWhitespace&&!yn.test(t)&&!yn.test(e)},Ho.tokenize=function(t){for(var e=t.split(/([^\S\r\n]+|[()[\]{}'"\r\n]|\b)/),r=0;r<e.length-1;r++)!e[r+1]&&e[r+2]&&Ec.test(e[r])&&Ec.test(e[r+2])&&(e[r]+=e[r+2],e.splice(r+1,2),r--);return e};function mp(t,e,r){return r=Cc(r,{ignoreWhitespace:!0}),Ho.diff(t,e,r)}c(mp,"diffWords");function vp(t,e,r){return Ho.diff(t,e,r)}c(vp,"diffWordsWithSpace");var zo=new wn;zo.tokenize=function(t){var e=[],r=t.split(/(\n|\r\n)/);r[r.length-1]||r.pop();for(var n=0;n<r.length;n++){var i=r[n];n%2&&!this.options.newlineIsToken?e[e.length-1]+=i:(this.options.ignoreWhitespace&&(i=i.trim()),e.push(i))}return e};function Du(t,e,r){return zo.diff(t,e,r)}c(Du,"diffLines");function wp(t,e,r){var n=Cc(r,{ignoreWhitespace:!0});return zo.diff(t,e,n)}c(wp,"diffTrimmedLines");var oo=new wn;oo.tokenize=function(t){return t.split(/(\S.+?[.!?])(?=\s+|$)/)};function yp(t,e,r){return oo.diff(t,e,r)}c(yp,"diffSentences");var $i=new wn;$i.tokenize=function(t){return t.split(/([{}:;,]|\s+)/)};function Pu(t,e,r){return $i.diff(t,e,r)}c(Pu,"diffCss");function ao(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ao=c(function(e){return typeof e},"_typeof"):ao=c(function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},"_typeof"),ao(t)}c(ao,"_typeof");function bn(t){return Fu(t)||$u(t)||Nu(t)||Mu()}c(bn,"_toConsumableArray");function Fu(t){if(Array.isArray(t))return Wo(t)}c(Fu,"_arrayWithoutHoles");function $u(t){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(t))return Array.from(t)}c($u,"_iterableToArray");function Nu(t,e){if(!!t){if(typeof t=="string")return Wo(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Wo(t,e)}}c(Nu,"_unsupportedIterableToArray");function Wo(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}c(Wo,"_arrayLikeToArray");function Mu(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}c(Mu,"_nonIterableSpread");var Bu=Object.prototype.toString,ai=new wn;ai.useLongestToken=!0,ai.tokenize=zo.tokenize,ai.castInput=function(t){var e=this.options,r=e.undefinedReplacement,n=e.stringifyReplacer,i=n===void 0?function(o,a){return typeof a=="undefined"?r:a}:n;return typeof t=="string"?t:JSON.stringify(Fn(t,null,null,i),i,"  ")},ai.equals=function(t,e){return wn.prototype.equals.call(ai,t.replace(/,([\r\n])/g,"$1"),e.replace(/,([\r\n])/g,"$1"))};function Za(t,e,r){return ai.diff(t,e,r)}c(Za,"diffJson");function Fn(t,e,r,n,i){e=e||[],r=r||[],n&&(t=n(i,t));var o;for(o=0;o<e.length;o+=1)if(e[o]===t)return r[o];var a;if(Bu.call(t)==="[object Array]"){for(e.push(t),a=new Array(t.length),r.push(a),o=0;o<t.length;o+=1)a[o]=Fn(t[o],e,r,n,i);return e.pop(),r.pop(),a}if(t&&t.toJSON&&(t=t.toJSON()),ao(t)==="object"&&t!==null){e.push(t),a={},r.push(a);var s=[],l;for(l in t)t.hasOwnProperty(l)&&s.push(l);for(s.sort(),o=0;o<s.length;o+=1)l=s[o],a[l]=Fn(t[l],e,r,n,l);e.pop(),r.pop()}else a=t;return a}c(Fn,"canonicalize");var qo=new wn;qo.tokenize=function(t){return t.slice()},qo.join=qo.removeEmpty=function(t){return t};function bp(t,e,r){return qo.diff(t,e,r)}c(bp,"diffArrays");function Wr(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.split(/\r\n|[\n\v\f\r\x85]/),n=t.match(/\r\n|[\n\v\f\r\x85]/g)||[],i=[],o=0;function a(){var u={};for(i.push(u);o<r.length;){var d=r[o];if(/^(\-\-\-|\+\+\+|@@)\s/.test(d))break;var p=/^(?:Index:|diff(?: -r \w+)+)\s+(.+?)\s*$/.exec(d);p&&(u.index=p[1]),o++}for(s(u),s(u),u.hunks=[];o<r.length;){var f=r[o];if(/^(Index:|diff|\-\-\-|\+\+\+)\s/.test(f))break;if(/^@@/.test(f))u.hunks.push(l());else{if(f&&e.strict)throw new Error("Unknown line "+(o+1)+" "+JSON.stringify(f));o++}}}c(a,"parseIndex");function s(u){var d=/^(---|\+\+\+)\s+(.*)$/.exec(r[o]);if(d){var p=d[1]==="---"?"old":"new",f=d[2].split("	",2),g=f[0].replace(/\\\\/g,"\\");/^".*"$/.test(g)&&(g=g.substr(1,g.length-2)),u[p+"FileName"]=g,u[p+"Header"]=(f[1]||"").trim(),o++}}c(s,"parseFileHeader");function l(){var u=o,d=r[o++],p=d.split(/@@ -(\d+)(?:,(\d+))? \+(\d+)(?:,(\d+))? @@/),f={oldStart:+p[1],oldLines:typeof p[2]=="undefined"?1:+p[2],newStart:+p[3],newLines:typeof p[4]=="undefined"?1:+p[4],lines:[],linedelimiters:[]};f.oldLines===0&&(f.oldStart+=1),f.newLines===0&&(f.newStart+=1);for(var g=0,x=0;o<r.length&&!(r[o].indexOf("--- ")===0&&o+2<r.length&&r[o+1].indexOf("+++ ")===0&&r[o+2].indexOf("@@")===0);o++){var y=r[o].length==0&&o!=r.length-1?" ":r[o][0];if(y==="+"||y==="-"||y===" "||y==="\\")f.lines.push(r[o]),f.linedelimiters.push(n[o]||`
`),y==="+"?g++:y==="-"?x++:y===" "&&(g++,x++);else break}if(!g&&f.newLines===1&&(f.newLines=0),!x&&f.oldLines===1&&(f.oldLines=0),e.strict){if(g!==f.newLines)throw new Error("Added line count did not match for hunk at line "+(u+1));if(x!==f.oldLines)throw new Error("Removed line count did not match for hunk at line "+(u+1))}return f}for(c(l,"parseHunk");o<r.length;)a();return i}c(Wr,"parsePatch");function Ou(t,e,r){var n=!0,i=!1,o=!1,a=1;return c(function s(){if(n&&!o){if(i?a++:n=!1,t+a<=r)return a;o=!0}if(!i)return o||(n=!0),e<=t-a?-a++:(i=!0,s())},"iterator")}c(Ou,"distanceIterator");function Rc(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(typeof e=="string"&&(e=Wr(e)),Array.isArray(e)){if(e.length>1)throw new Error("applyPatch only works with a single input.");e=e[0]}var n=t.split(/\r\n|[\n\v\f\r\x85]/),i=t.match(/\r\n|[\n\v\f\r\x85]/g)||[],o=e.hunks,a=r.compareLine||function(Re,Ne,$e,Xe){return Ne===Xe},s=0,l=r.fuzzFactor||0,u=0,d=0,p,f;function g(Re,Ne){for(var $e=0;$e<Re.lines.length;$e++){var Xe=Re.lines[$e],it=Xe.length>0?Xe[0]:" ",ht=Xe.length>0?Xe.substr(1):Xe;if(it===" "||it==="-"){if(!a(Ne+1,n[Ne],it,ht)&&(s++,s>l))return!1;Ne++}}return!0}c(g,"hunkFits");for(var x=0;x<o.length;x++){for(var y=o[x],b=n.length-y.oldLines,S=0,E=d+y.oldStart-1,D=Ou(E,u,b);S!==void 0;S=D())if(g(y,E+S)){y.offset=d+=S;break}if(S===void 0)return!1;u=y.offset+y.oldStart+y.oldLines}for(var $=0,z=0;z<o.length;z++){var re=o[z],ne=re.oldStart+re.offset+$-1;$+=re.newLines-re.oldLines;for(var ee=0;ee<re.lines.length;ee++){var we=re.lines[ee],oe=we.length>0?we[0]:" ",ge=we.length>0?we.substr(1):we,Ee=re.linedelimiters[ee];if(oe===" ")ne++;else if(oe==="-")n.splice(ne,1),i.splice(ne,1);else if(oe==="+")n.splice(ne,0,ge),i.splice(ne,0,Ee),ne++;else if(oe==="\\"){var et=re.lines[ee-1]?re.lines[ee-1][0]:null;et==="+"?p=!0:et==="-"&&(f=!0)}}}if(p)for(;!n[n.length-1];)n.pop(),i.pop();else f&&(n.push(""),i.push(`
`));for(var ae=0;ae<n.length-1;ae++)n[ae]=n[ae]+i[ae];return n.join("")}c(Rc,"applyPatch");function xp(t,e){typeof t=="string"&&(t=Wr(t));var r=0;function n(){var i=t[r++];if(!i)return e.complete();e.loadFile(i,function(o,a){if(o)return e.complete(o);var s=Rc(a,i,e);e.patched(i,s,function(l){if(l)return e.complete(l);n()})})}c(n,"processIndex"),n()}c(xp,"applyPatches");function Ac(t,e,r,n,i,o,a){a||(a={}),typeof a.context=="undefined"&&(a.context=4);var s=Du(r,n,a);s.push({value:"",lines:[]});function l(S){return S.map(function(E){return" "+E})}c(l,"contextLines");for(var u=[],d=0,p=0,f=[],g=1,x=1,y=c(function(E){var D=s[E],$=D.lines||D.value.replace(/\n$/,"").split(`
`);if(D.lines=$,D.added||D.removed){var z;if(!d){var re=s[E-1];d=g,p=x,re&&(f=a.context>0?l(re.lines.slice(-a.context)):[],d-=f.length,p-=f.length)}(z=f).push.apply(z,bn($.map(function(ae){return(D.added?"+":"-")+ae}))),D.added?x+=$.length:g+=$.length}else{if(d)if($.length<=a.context*2&&E<s.length-2){var ne;(ne=f).push.apply(ne,bn(l($)))}else{var ee,we=Math.min($.length,a.context);(ee=f).push.apply(ee,bn(l($.slice(0,we))));var oe={oldStart:d,oldLines:g-d+we,newStart:p,newLines:x-p+we,lines:f};if(E>=s.length-2&&$.length<=a.context){var ge=/\n$/.test(r),Ee=/\n$/.test(n),et=$.length==0&&f.length>oe.oldLines;!ge&&et&&r.length>0&&f.splice(oe.oldLines,0,"\\ No newline at end of file"),(!ge&&!et||!Ee)&&f.push("\\ No newline at end of file")}u.push(oe),d=0,p=0,f=[]}g+=$.length,x+=$.length}},"_loop"),b=0;b<s.length;b++)y(b);return{oldFileName:t,newFileName:e,oldHeader:i,newHeader:o,hunks:u}}c(Ac,"structuredPatch");function Uu(t){var e=[];t.oldFileName==t.newFileName&&e.push("Index: "+t.oldFileName),e.push("==================================================================="),e.push("--- "+t.oldFileName+(typeof t.oldHeader=="undefined"?"":"	"+t.oldHeader)),e.push("+++ "+t.newFileName+(typeof t.newHeader=="undefined"?"":"	"+t.newHeader));for(var r=0;r<t.hunks.length;r++){var n=t.hunks[r];n.oldLines===0&&(n.oldStart-=1),n.newLines===0&&(n.newStart-=1),e.push("@@ -"+n.oldStart+","+n.oldLines+" +"+n.newStart+","+n.newLines+" @@"),e.push.apply(e,n.lines)}return e.join(`
`)+`
`}c(Uu,"formatPatch");function si(t,e,r,n,i,o,a){return Uu(Ac(t,e,r,n,i,o,a))}c(si,"createTwoFilesPatch");function jo(t,e,r,n,i,o){return si(t,t,e,r,n,i,o)}c(jo,"createPatch");function Lu(t,e){return t.length!==e.length?!1:Ni(t,e)}c(Lu,"arrayEqual");function Ni(t,e){if(e.length>t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}c(Ni,"arrayStartsWith");function Hu(t){var e=Vt(t.lines),r=e.oldLines,n=e.newLines;r!==void 0?t.oldLines=r:delete t.oldLines,n!==void 0?t.newLines=n:delete t.newLines}c(Hu,"calcLineCount");function Tc(t,e,r){t=kc(t,r),e=kc(e,r);var n={};(t.index||e.index)&&(n.index=t.index||e.index),(t.newFileName||e.newFileName)&&(Xa(t)?Xa(e)?(n.oldFileName=so(n,t.oldFileName,e.oldFileName),n.newFileName=so(n,t.newFileName,e.newFileName),n.oldHeader=so(n,t.oldHeader,e.oldHeader),n.newHeader=so(n,t.newHeader,e.newHeader)):(n.oldFileName=t.oldFileName,n.newFileName=t.newFileName,n.oldHeader=t.oldHeader,n.newHeader=t.newHeader):(n.oldFileName=e.oldFileName||t.oldFileName,n.newFileName=e.newFileName||t.newFileName,n.oldHeader=e.oldHeader||t.oldHeader,n.newHeader=e.newHeader||t.newHeader)),n.hunks=[];for(var i=0,o=0,a=0,s=0;i<t.hunks.length||o<e.hunks.length;){var l=t.hunks[i]||{oldStart:1/0},u=e.hunks[o]||{oldStart:1/0};if(Qa(l,u))n.hunks.push(Mi(l,a)),i++,s+=l.newLines-l.oldLines;else if(Qa(u,l))n.hunks.push(Mi(u,s)),o++,a+=u.newLines-u.oldLines;else{var d={oldStart:Math.min(l.oldStart,u.oldStart),oldLines:0,newStart:Math.min(l.newStart+a,u.oldStart+s),newLines:0,lines:[]};Ic(d,l.oldStart,l.lines,u.oldStart,u.lines),o++,i++,n.hunks.push(d)}}return n}c(Tc,"merge");function kc(t,e){if(typeof t=="string"){if(/^@@/m.test(t)||/^Index:/m.test(t))return Wr(t)[0];if(!e)throw new Error("Must provide a base reference or pass in a patch");return Ac(void 0,void 0,e,t)}return t}c(kc,"loadPatch");function Xa(t){return t.newFileName&&t.newFileName!==t.oldFileName}c(Xa,"fileNameChanged");function so(t,e,r){return e===r?e:(t.conflict=!0,{mine:e,theirs:r})}c(so,"selectField");function Qa(t,e){return t.oldStart<e.oldStart&&t.oldStart+t.oldLines<e.oldStart}c(Qa,"hunkBefore");function Mi(t,e){return{oldStart:t.oldStart,oldLines:t.oldLines,newStart:t.newStart+e,newLines:t.newLines,lines:t.lines}}c(Mi,"cloneHunk");function Ic(t,e,r,n,i){var o={offset:e,lines:r,index:0},a={offset:n,lines:i,index:0};for(L(t,o,a),L(t,a,o);o.index<o.lines.length&&a.index<a.lines.length;){var s=o.lines[o.index],l=a.lines[a.index];if((s[0]==="-"||s[0]==="+")&&(l[0]==="-"||l[0]==="+"))zu(t,o,a);else if(s[0]==="+"&&l[0]===" "){var u;(u=t.lines).push.apply(u,bn(xe(o)))}else if(l[0]==="+"&&s[0]===" "){var d;(d=t.lines).push.apply(d,bn(xe(a)))}else s[0]==="-"&&l[0]===" "?Dc(t,o,a):l[0]==="-"&&s[0]===" "?Dc(t,a,o,!0):s===l?(t.lines.push(s),o.index++,a.index++):Ya(t,xe(o),xe(a))}J(t,o),J(t,a),Hu(t)}c(Ic,"mergeLines");function zu(t,e,r){var n=xe(e),i=xe(r);if(Ut(n)&&Ut(i)){if(Ni(n,i)&&pt(r,n,n.length-i.length)){var o;(o=t.lines).push.apply(o,bn(n));return}else if(Ni(i,n)&&pt(e,i,i.length-n.length)){var a;(a=t.lines).push.apply(a,bn(i));return}}else if(Lu(n,i)){var s;(s=t.lines).push.apply(s,bn(n));return}Ya(t,n,i)}c(zu,"mutualChange");function Dc(t,e,r,n){var i=xe(e),o=Ze(r,i);if(o.merged){var a;(a=t.lines).push.apply(a,bn(o.merged))}else Ya(t,n?o:i,n?i:o)}c(Dc,"removal");function Ya(t,e,r){t.conflict=!0,t.lines.push({conflict:!0,mine:e,theirs:r})}c(Ya,"conflict");function L(t,e,r){for(;e.offset<r.offset&&e.index<e.lines.length;){var n=e.lines[e.index++];t.lines.push(n),e.offset++}}c(L,"insertLeading");function J(t,e){for(;e.index<e.lines.length;){var r=e.lines[e.index++];t.lines.push(r)}}c(J,"insertTrailing");function xe(t){for(var e=[],r=t.lines[t.index][0];t.index<t.lines.length;){var n=t.lines[t.index];if(r==="-"&&n[0]==="+"&&(r="+"),r===n[0])e.push(n),t.index++;else break}return e}c(xe,"collectChange");function Ze(t,e){for(var r=[],n=[],i=0,o=!1,a=!1;i<e.length&&t.index<t.lines.length;){var s=t.lines[t.index],l=e[i];if(l[0]==="+")break;if(o=o||s[0]!==" ",n.push(l),i++,s[0]==="+")for(a=!0;s[0]==="+";)r.push(s),s=t.lines[++t.index];l.substr(1)===s.substr(1)?(r.push(s),t.index++):a=!0}if((e[i]||"")[0]==="+"&&o&&(a=!0),a)return r;for(;i<e.length;)n.push(e[i++]);return{merged:n,changes:r}}c(Ze,"collectContext");function Ut(t){return t.reduce(function(e,r){return e&&r[0]==="-"},!0)}c(Ut,"allRemoves");function pt(t,e,r){for(var n=0;n<r;n++){var i=e[e.length-r+n].substr(1);if(t.lines[t.index+n]!==" "+i)return!1}return t.index+=r,!0}c(pt,"skipRemoveSuperset");function Vt(t){var e=0,r=0;return t.forEach(function(n){if(typeof n!="string"){var i=Vt(n.mine),o=Vt(n.theirs);e!==void 0&&(i.oldLines===o.oldLines?e+=i.oldLines:e=void 0),r!==void 0&&(i.newLines===o.newLines?r+=i.newLines:r=void 0)}else r!==void 0&&(n[0]==="+"||n[0]===" ")&&r++,e!==void 0&&(n[0]==="-"||n[0]===" ")&&e++}),{oldLines:e,newLines:r}}c(Vt,"calcOldNewLineCount");function lr(t){for(var e=[],r,n,i=0;i<t.length;i++)r=t[i],r.added?n=1:r.removed?n=-1:n=0,e.push([n,r.value]);return e}c(lr,"convertChangesToDMP");function wr(t){for(var e=[],r=0;r<t.length;r++){var n=t[r];n.added?e.push("<ins>"):n.removed&&e.push("<del>"),e.push(Xt(n.value)),n.added?e.push("</ins>"):n.removed&&e.push("</del>")}return e.join("")}c(wr,"convertChangesToXML");function Xt(t){var e=t;return e=e.replace(/&/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/"/g,"&quot;"),e}c(Xt,"escapeHTML");function _r(t,e){let r={};for(let o=0;o<e.length;o++){const a=e[o];r[a]?r[a].push(o):r[a]=[o]}let i=[{buffer1index:-1,buffer2index:-1,chain:null}];for(let o=0;o<t.length;o++){const a=t[o],s=r[a]||[];let l=0,u=i[0];for(let d=0;d<s.length;d++){const p=s[d];let f;for(f=l;f<i.length&&!(i[f].buffer2index<p&&(f===i.length-1||i[f+1].buffer2index>p));f++);if(f<i.length){const g={buffer1index:o,buffer2index:p,chain:i[f]};if(l===i.length?i.push(u):i[l]=u,l=f+1,u=g,l===i.length)break}}i[l]=u}return i[i.length-1]}c(_r,"LCS");function Zr(t,e){const r=_r(t,e);let n=[],i=t.length,o=e.length,a={common:[]};function s(){a.common.length&&(a.common.reverse(),n.push(a),a={common:[]})}c(s,"processCommon");for(let l=r;l!==null;l=l.chain){let u={buffer1:[],buffer2:[]};for(;--i>l.buffer1index;)u.buffer1.push(t[i]);for(;--o>l.buffer2index;)u.buffer2.push(e[o]);(u.buffer1.length||u.buffer2.length)&&(s(),u.buffer1.reverse(),u.buffer2.reverse(),n.push(u)),i>=0&&a.common.push(t[i])}return s(),n.reverse(),n}c(Zr,"diffComm");function ur(t,e){const r=_r(t,e);let n=[],i=t.length,o=e.length;for(let a=r;a!==null;a=a.chain){const s=i-a.buffer1index-1,l=o-a.buffer2index-1;i=a.buffer1index,o=a.buffer2index,(s||l)&&n.push({buffer1:[i+1,s],buffer1Content:t.slice(i+1,i+1+s),buffer2:[o+1,l],buffer2Content:e.slice(o+1,o+1+l)})}return n.reverse(),n}c(ur,"diffIndices");function Xr(t,e){const r=_r(t,e);let n=[],i=t.length,o=e.length;function a(s,l,u){let d=[];for(let p=0;p<u;p++)d.push(s[l+p]);return{offset:l,length:u,chunk:d}}c(a,"chunkDescription");for(let s=r;s!==null;s=s.chain){const l=i-s.buffer1index-1,u=o-s.buffer2index-1;i=s.buffer1index,o=s.buffer2index,(l||u)&&n.push({buffer1:a(t,s.buffer1index+1,l),buffer2:a(e,s.buffer2index+1,u)})}return n.reverse(),n}c(Xr,"diffPatch");function qr(t,e,r){let n=[];function i(l,u){n.push({ab:u,oStart:l.buffer1[0],oLength:l.buffer1[1],abStart:l.buffer2[0],abLength:l.buffer2[1]})}c(i,"addHunk"),ur(e,t).forEach(l=>i(l,"a")),ur(e,r).forEach(l=>i(l,"b")),n.sort((l,u)=>l.oStart-u.oStart);let o=[],a=0;function s(l){l>a&&(o.push({stable:!0,buffer:"o",bufferStart:a,bufferLength:l-a,bufferContent:e.slice(a,l)}),a=l)}for(c(s,"advanceTo");n.length;){let l=n.shift(),u=l.oStart,d=l.oStart+l.oLength,p=[l];for(s(u);n.length;){const f=n[0],g=f.oStart;if(g>d)break;d=Math.max(d,g+f.oLength),p.push(n.shift())}if(p.length===1){if(l.abLength>0){const f=l.ab==="a"?t:r;o.push({stable:!0,buffer:l.ab,bufferStart:l.abStart,bufferLength:l.abLength,bufferContent:f.slice(l.abStart,l.abStart+l.abLength)})}}else{let f={a:[t.length,-1,e.length,-1],b:[r.length,-1,e.length,-1]};for(;p.length;){l=p.shift();const E=l.oStart,D=E+l.oLength,$=l.abStart,z=$+l.abLength;let re=f[l.ab];re[0]=Math.min($,re[0]),re[1]=Math.max(z,re[1]),re[2]=Math.min(E,re[2]),re[3]=Math.max(D,re[3])}const g=f.a[0]+(u-f.a[2]),x=f.a[1]+(d-f.a[3]),y=f.b[0]+(u-f.b[2]),b=f.b[1]+(d-f.b[3]);let S={stable:!1,aStart:g,aLength:x-g,aContent:t.slice(g,x),oStart:u,oLength:d-u,oContent:e.slice(u,d),bStart:y,bLength:b-y,bContent:r.slice(y,b)};o.push(S)}a=d}return s(e.length),o}c(qr,"diff3MergeRegions");function en(t,e,r,n){n=Object.assign({excludeFalseConflicts:!0,stringSeparator:/\s+/},n);const o=typeof t=="string",a=typeof e=="string",s=typeof r=="string";o&&(t=t.split(n.stringSeparator)),a&&(e=e.split(n.stringSeparator)),s&&(r=r.split(n.stringSeparator));let l=[];const u=qr(t,e,r);let d=[];function p(){d.length&&l.push({ok:d}),d=[]}c(p,"flushOk");function f(g,x){if(g.length!==x.length)return!1;for(let y=0;y<g.length;y++)if(g[y]!==x[y])return!1;return!0}return c(f,"isFalseConflict"),u.forEach(g=>{g.stable?d.push(...g.bufferContent):n.excludeFalseConflicts&&f(g.aContent,g.bContent)?d.push(...g.aContent):(p(),l.push({conflict:{a:g.aContent,aIndex:g.aStart,o:g.oContent,oIndex:g.oStart,b:g.bContent,bIndex:g.bStart}}))}),p(),l}c(en,"diff3Merge");function $n(t,e,r,n){n=Object.assign({excludeFalseConflicts:!0,stringSeparator:/\s+/,label:{}},n);const o=en(t,e,r,n);let a=!1,s=[];return o.forEach(l=>{l.ok?s=s.concat(l.ok):l.conflict&&(a=!0,s.push(`<<<<<<<${n.label.a?` ${n.label.a}`:""}`),s=s.concat(l.conflict.a),s.push(`|||||||${n.label.o?` ${n.label.o}`:""}`),s=s.concat(l.conflict.o),s.push("======="),s=s.concat(l.conflict.b),s.push(`>>>>>>>${n.label.b?` ${n.label.b}`:""}`))}),{conflict:a,result:s}}c($n,"mergeDiff3");function ci(t,e,r,n){n=Object.assign({excludeFalseConflicts:!0,stringSeparator:/\s+/},n);const o=en(t,e,r,n);let a=!1,s=[];for(let l=0;l<o.length;l++){const u=o[l];u.ok?s=s.concat(u.ok):(a=!0,s=s.concat([`
<<<<<<<<<
`],u.conflict.a,[`
=========
`],u.conflict.b,[`
>>>>>>>>>
`]))}return{conflict:a,result:s}}c(ci,"node_diff3_merge");function Wu(t,e,r,n){n=Object.assign({excludeFalseConflicts:!1,stringSeparator:/\s+/},n);const o=en(t,e,r,n);let a=!1,s=[];for(let l=0;l<o.length;l++){const u=o[l];if(u.ok)s=s.concat(u.ok);else{const d=Zr(u.conflict.a,u.conflict.b);for(let p=0;p<d.length;p++){let f=d[p];f.common?s=s.concat(f.common):(a=!0,s=s.concat([`
<<<<<<<<<
`],f.buffer1,[`
=========
`],f.buffer2,[`
>>>>>>>>>
`]))}}}return{conflict:a,result:s}}c(Wu,"mergeDigIn");function Ja(t,e){let r=[],n=0;function i(o){for(;n<o;)r.push(t[n]),n++}c(i,"advanceTo");for(let o=0;o<e.length;o++){let a=e[o];i(a.buffer1.offset);for(let s=0;s<a.buffer2.chunk.length;s++)r.push(a.buffer2.chunk[s]);n+=a.buffer1.length}return i(t.length),r}c(Ja,"patch");function es(t){return t.map(e=>({buffer1:{offset:e.buffer1.offset,length:e.buffer1.length},buffer2:{chunk:e.buffer2.chunk}}))}c(es,"stripPatch");function dR(t){return t.map(e=>({buffer1:e.buffer2,buffer2:e.buffer1}))}c(dR,"invertPatch");function _p(t,e,r){return Rc(t,e,r)}c(_p,"diffs_applyPatch");function Uy(t,e){const r=[];for(const n of Wr(t,e))r.push({...n,oldFileName:n.newFileName,oldHeader:n.newHeader,newFileName:n.oldFileName,newHeader:n.oldHeader,hunks:n.hunks.map(i=>({...i,oldLines:i.newLines,oldStart:i.newStart,newLines:i.oldLines,newStart:i.oldStart,lines:i.lines.map(o=>o[0]==="-"?`+${o.slice(1)}`:o[0]==="+"?`-${o.slice(1)}`:o)}))}),r.push(n);return r}c(Uy,"reversePatch");function Sp(t,e,r){let n=`
`;const i=t.match(/(?:\r?\n)/g);if(i!==null&&i.length!==0){const l=i.filter(u=>u===`\r
`).length;n=l>i.length-l?`\r
`:`
`}const o=ci(t,e,r,{excludeFalseConflicts:!0,stringSeparator:/\r?\n/}),a=o.result;let s=!1;if(o.conflict){let l;const u=[];let d=0;for(const g of a)g===`
<<<<<<<<<
`?l={start:d,separator:d,end:d}:g===`
=========
`?l.separator=d:g===`
>>>>>>>>>
`&&(l.end=d,u.push(l)),d++;let p=0,f=0;for(const g of u)a.splice(g.start-p,1),p++,f=g.end-g.separator+1,a.splice(g.separator-p,f),p+=f;u.length&&(s=!0)}return{conflicts:s,mergedContent:a.join(n)}}c(Sp,"diffs_merge");function Ly(t){return t!==void 0&&typeof t.then=="function"}c(Ly,"isPromise");const Hy="";function zy(...t){if(t.length===1){const e=t[0];return e===void 0?Hy:typeof e=="string"?e:typeof e=="number"||typeof e=="boolean"||e instanceof Error?String(e):e instanceof h.Uri?e.toString():JSON.stringify(e)}return JSON.stringify(t)}c(zy,"gate_defaultResolver");function Sr(t){return(e,r,n)=>{let i;if(typeof n.value=="function"?i=n.value:typeof n.get=="function"&&(i=n.get),i===void 0)throw new Error("Not supported");const o=`$gate$${r}`;n.value=function(...a){const s=a.length===0?o:`${o}$${(t!=null?t:zy)(...a)}`;Object.prototype.hasOwnProperty.call(this,s)||Object.defineProperty(this,s,{configurable:!1,enumerable:!1,writable:!0,value:void 0});let l=this[s];if(l===void 0){let u;try{if(u=i.apply(this,a),u==null||!Ly(u))return u;this[s]=l=u.then(d=>(this[s]=void 0,d)).catch(d=>{throw this[s]=void 0,d})}catch(d){throw this[s]=void 0,d}}return l}}}c(Sr,"gate");let qu=0;function Wy(){return qu===Number.MAX_SAFE_INTEGER&&(qu=0),String(++qu)}c(Wy,"getNextLockId");class Cp{constructor(){this.id=Wy()}async synchronize(e){let r;const n=this.promise;this.promise=new Promise(i=>r=i),await n;try{return await e()}finally{r()}}}c(Cp,"Lock");class ts{constructor(e){this.lock=new Cp,this.readers=new Set,this.counter=0,this._id=e!=null?e:this.lock.id}get id(){return this._id}getNextCounter(){return this.counter===Number.MAX_SAFE_INTEGER&&(this.counter=0),++this.counter}async synchronizeRead(e,r){let n;const i=new Be(`Reader(${this.getNextCounter()}|${this.id})`,{log:{prefix:"(A) ",message:r?` \u2022 ${r}`:""},logLevel:ie.Debug});let o;await this.lock.synchronize(async()=>{this.writer&&await this.writer,o=new Promise(a=>n=a),this.readers.add(o)}),i.restart({prefix:"(L) ",suffix:r?` \u2022 ${r}`:"",took:" waited for "});try{return await e()}finally{i.stop({prefix:"(U) ",suffix:r?` \u2022 ${r}`:"",took:" locked for "}),o!==void 0&&this.readers.delete(o),n()}}async synchronizeWrite(e,r){let n;const i=new Be(`Writer(${this.getNextCounter()}|${this.id})`,{log:{prefix:"(A) ",message:r?` \u2022 ${r}`:""},logLevel:ie.Debug});await this.lock.synchronize(async()=>{if(this.writer&&await this.writer,this.readers.size){const o=[...this.readers];this.readers.clear(),await Promise.all(o)}this.writer=new Promise(o=>n=o)}),i.restart({prefix:"(L) ",suffix:r?` \u2022 ${r}`:"",took:" waited for "});try{return await e()}finally{i.stop({prefix:"(U) ",suffix:r?` \u2022 ${r}`:"",took:" locked for "}),n(),this.writer=void 0}}}c(ts,"ReaderWriterLock");class Ep{constructor(){this.locks=new Map}async synchronizeRead(e,r,n){let i=this.locks.get(e);return i===void 0&&(i=new ts(String(e)),this.locks.set(e,i)),i.synchronizeRead(r,n)}async synchronizeWrite(e,r,n){let i=this.locks.get(e);return i===void 0&&(i=new ts(String(e)),this.locks.set(e,i)),i.synchronizeWrite(r,n)}}c(Ep,"KeyedReaderWriterLock");var qy=Object.defineProperty,jy=Object.getOwnPropertyDescriptor,Vy=c((t,e,r,n)=>{for(var i=n>1?void 0:n?jy(e,r):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&qy(e,r,i),i},"changeStore_decorateClass");const tn=(0,A.loadMessageBundle)(),Gy=h.FileSystemError.FileNotFound().code,Rp=`===================================================================
`,Nn=new TextDecoder,Ky=new TextEncoder;var ut;(function(t){t[t.Changed=1]="Changed",t[t.Created=2]="Created",t[t.Deleted=3]="Deleted"})(ut||(ut={}));function Zy(t){return t&&"type"in t&&"uri"in t&&"uri"in t&&"fileType"in t&&"revision"in t&&"timestamp"in t}c(Zy,"isOperation");function rs(t,e,r){return{type:t.type,rootUri:e,uri:r!=null?r:t.uri}}c(rs,"toEvent");const Vo=c(class{constructor(t,e,r,n,i,o){this.providerService=t,this.storageService=e,this.fileStorageService=r,this.telemetryService=n,this.workspaceId=i,this._onDidChange=new h.EventEmitter,this.cache=new Map,this.lock=new Ep,this.scopedStores=new Map,o===void 0&&(Vo._instance=this,this.disposable=h.Disposable.from(this.providerService.onDidRefresh(()=>this.cache.clear())))}static get instance(){return this._instance}get onDidChange(){return this._onDidChange.event}dispose(){var t;(t=this.disposable)==null||t.dispose()}async exportDebugInfo(t){var e;async function r(n){const i=await h.workspace.openTextDocument({language:"json",content:`ChangeStore Operations for ${n.toString(!0)}

${this.toStorage(await this.getWorkingOperations(n))}`});return void h.window.showTextDocument(i)}if(c(r,"exportCore"),t===void 0)for(const n of(e=h.workspace.workspaceFolders)!=null?e:[])await r.call(this,n.uri);else return r.call(this,t)}async getWorkspaceProvidersWithChanges(){var t,e;const r=new Map;for(const n of(t=h.workspace.workspaceFolders)!=null?t:[])if(n.uri.scheme===Dt.scheme&&await this.hasChanges(n.uri)){const i=(e=this.providerService.getRepository(n.uri))==null?void 0:e.provider;if(!i)continue;r.set(i.id,i)}return[...r.values()]}async getWorkspacesWithChanges(){var t;const e=new Be("ChangeStore.getWorkspacesWithChanges()");try{const r=[];for(const n of(t=h.workspace.workspaceFolders)!=null?t:[])n.uri.scheme===Dt.scheme&&await this.hasChanges(n.uri)&&r.push(n.uri);return r.length>0?r:void 0}finally{e.stop()}}async acceptAll(t,e){const r=`ChangeStore.acceptAll(${t.toString()}, ${e==null?void 0:e.staged})`;C.log(r);const n=[];await this.lock.synchronizeWrite(H(t),async()=>{const i=await this.getWorkingOperations(t),o=[];let a=[];const s=(e==null?void 0:e.staged)&&!(e.staged==="auto"&&!i.some(l=>l.staged));for(const l of i){if(s&&!l.staged){a.push(l);continue}l.fileType===h.FileType.File&&await this.discardWorkingContent(t,l.uri);let u;if(l.type===2&&l.fileType===h.FileType.Directory&&(i.some(d=>qe(d.uri,l.uri))||(u={type:3,rootUri:t,uri:l.uri})),n.push(u!=null?u:rs(l,t)),l.type===2){let d=l.uri;for(;;){const{parent:p}=this.findParent(d,i,f=>f.type===2);if(p){o.push(p),d=p.uri;continue}break}}}a.length>0&&o.length>0&&(a=a.filter(l=>o.includes(l)?(n.push(rs(l,t)),!1):!0)),await this.saveWorkingOperations(t,a)},r),n.length!==0&&this._onDidChange.fire(n)}async discard(t){const e=this.providerService.getVirtualWorkspaceUri(t);if(e===void 0)return;const r=`ChangeStore.discard(${t.toString()})`;C.log(r);const n=[];await this.lock.synchronizeWrite(H(e),async()=>this.discardCore(e,t,n),r),n.length!==0&&this._onDidChange.fire(n)}async discardCore(t,e,r){C.debug(`ChangeStore.discardCore(${e.toString()})`);const n=await this.getWorkingOperations(t);if(n.length===0)return;const i=ue(e),o=n.findIndex(l=>ue(l.uri)===i);if(o===-1)return;const[a]=n.splice(o,1);let s;switch(a.type){case 2:s=3;break;case 3:s=2;break;default:s=a.type;break}if(r.push({type:s,rootUri:t,uri:e}),a.type===2){let l=a.uri;for(;;){const{parent:u,parentIndex:d}=this.findNewParentWithOnlyChild(l,n);if(u){n.splice(d,1),r.push({type:3,rootUri:t,uri:u.uri}),l=u.uri;continue}break}}await this.saveWorkingOperations(t,n),a.fileType===h.FileType.File&&await this.discardWorkingContent(t,e)}async discardAll(t,e){const r=this.getUriScope(t);if(r)return this.getScopedChangeStore(r).discardAll(t,e);const n=`ChangeStore.discardAll(${t.toString()}, ${e==null?void 0:e.staged})`;C.log(n);const i=[];await this.lock.synchronizeWrite(H(t),async()=>{const o=await this.getWorkingOperations(t),a=[];let s=[];const l=(e==null?void 0:e.staged)&&!(e.staged==="auto"&&!o.some(u=>u.staged));for(const u of o){if(l&&!u.staged){s.push(u);continue}u.fileType===h.FileType.File&&await this.discardWorkingContent(t,u.uri);let d;switch(u.type){case 2:d=3;break;case 3:d=2;break;default:d=u.type;break}if(i.push({type:d,rootUri:t,uri:u.uri}),u.type===2){let p=u.uri;for(;;){const{parent:f}=this.findNewParentWithOnlyChild(p,o);if(f){a.push(f),p=f.uri;continue}break}}}s.length>0&&a.length>0&&(s=s.filter(u=>a.includes(u)?(i.push({type:3,rootUri:t,uri:u.uri}),!1):!0)),await this.saveWorkingOperations(t,s)},n),i.length!==0&&this._onDidChange.fire(i)}async stage(t){const e=this.providerService.getVirtualWorkspaceUri(t);if(e===void 0)return;const r=`ChangeStore.stage(${t.toString()})`;C.log(r);const n=[];await this.lock.synchronizeWrite(H(e),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(t,e);i!==void 0&&await this.spliceOperation(t,o,{...i,staged:!0,timestamp:Date.now()},n)},r),n.length!==0&&this._onDidChange.fire(n)}async stageAll(t){const e=`ChangeStore.stageAll(${t.toString()})`;C.log(e);const r=[];await this.lock.synchronizeWrite(H(t),async()=>{const n=(await this.getWorkingOperations(t)).map(i=>({...i,staged:!0,timestamp:Date.now()}));n.length!==0&&(await this.saveWorkingOperations(t,n),r.push(...n.map(i=>rs(i,t))))},e),r.length!==0&&this._onDidChange.fire(r)}async unstage(t){const e=this.providerService.getVirtualWorkspaceUri(t);if(e===void 0)return;const r=`ChangeStore.unstage(${t.toString()})`;C.log(r);const n=[];await this.lock.synchronizeWrite(H(e),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(t,e);i!==void 0&&await this.spliceOperation(t,o,{...i,staged:!1,timestamp:Date.now()},n)},r),n.length!==0&&this._onDidChange.fire(n)}async unstageAll(t){const e=`ChangeStore.unstageAll(${t.toString()})`;C.log(e);const r=[];await this.lock.synchronizeWrite(H(t),async()=>{const n=(await this.getWorkingOperations(t)).map(i=>({...i,staged:!1,timestamp:Date.now()}));n.length!==0&&(await this.saveWorkingOperations(t,n),r.push(...n.map(i=>rs(i,t))))},e),r.length!==0&&this._onDidChange.fire(r)}async hasChanges(t){const e=this.getUriScope(t);if(e)return this.getScopedChangeStore(e).hasChanges(t);const r=H(t),n=this.cache.get(r);return n!==void 0?n.length!==0:this.lock.synchronizeRead(r,async()=>(await this.getWorkingOperations(t)).length!==0,`ChangeStore.hasChanges(${t.toString()})`)}maybeHasChanges(t,e){const r=this.getUriScope(t);if(r)return this.getScopedChangeStore(r).maybeHasChanges(t,e);const n=H(t),i=this.cache.get(n);if(i===void 0)return;if(i.length===0)return!1;if(e===void 0)return!0;const o=ue(e);return i.some(a=>ue(a.uri)===o)}async hasMergeConflicts(t){return this.lock.synchronizeRead(H(t),async()=>(await this.getWorkingOperations(t)).some(e=>e.conflicts!==void 0),`ChangeStore.hasMergeConflicts(${t.toString()})`)}async hasStagedChanges(t){return this.lock.synchronizeRead(H(t),async()=>(await this.getWorkingOperations(t)).some(e=>e.staged&&e.conflicts===void 0),`ChangeStore.hasStagedChanges(${t.toString()})`)}async hasWorkingChanges(t){return this.lock.synchronizeRead(H(t),async()=>(await this.getWorkingOperations(t)).some(e=>!e.staged&&e.conflicts===void 0),`ChangeStore.hasWorkingChanges(${t.toString()})`)}async getChange(t){const e=this.getUriScope(t);if(e)return this.getScopedChangeStore(e).getChange(t);const r=this.providerService.getVirtualRootUri(t);if(r!==void 0)return this.lock.synchronizeRead(H(r),async()=>{const{operation:n}=await this.getWorkingOperation(t,r);return n},`ChangeStore.getChange(${t.toString()})`)}async getChanges(t,e){const r=this.getUriScope(t);return r?this.getScopedChangeStore(r).getChanges(t,e):this.lock.synchronizeRead(H(t),async()=>{let n=await this.getWorkingOperations(t);if((e==null?void 0:e.excludeConflicts)||(e==null?void 0:e.predicate)){const{excludeConflicts:i,predicate:o}=e;n=n.filter(a=>{var s;return(!i||a.conflicts===void 0)&&((s=o==null?void 0:o(a))!=null?s:!0)})}return n},`ChangeStore.getChanges(${t.toString()})`)}async getGroupedChanges(t,e){const r=this.getUriScope(t);return r?this.getScopedChangeStore(r).getGroupedChanges(t,e):this.lock.synchronizeRead(H(t),async()=>{var n,i;const o=await this.getWorkingOperations(t),a={conflicts:[],staged:[],working:[]};for(const s of o)!((i=(n=e==null?void 0:e.predicate)==null?void 0:n.call(e,s))!=null?i:!0)||(s.conflicts?a.conflicts.push(s):s.staged?a.staged.push(s):a.working.push(s));return a},`ChangeStore.getChangesByType(${t.toString()})`)}async getContent(t){const e=this.providerService.getVirtualRootUri(t);if(e===void 0)throw new Error(`Unable to find content for ${t.toString()}; Repository not found`);const r=H(e),n=this.cache.get(r);if((n==null?void 0:n.length)===0)throw new Error(`Unable to find content for ${t.toString()}`);return this.lock.synchronizeRead(r,async()=>{const i=Nn.decode(await this.getWorkingContent(e,t));if(i!==void 0)return i;throw new Error(`Unable to find content for ${t.toString()}`)},`ChangeStore.getContent(${t.toString()}}`)}async getMergeConflicts(t,e){return this.lock.synchronizeRead(H(t),async()=>(await this.getWorkingOperations(t)).filter(n=>{var i,o;return n.conflicts!==void 0&&((o=(i=e==null?void 0:e.predicate)==null?void 0:i.call(e,n))!=null?o:!0)}),`ChangeStore.getMergeConflicts(${t.toString()})`)}async getStagedChanges(t,e){return this.lock.synchronizeRead(H(t),async()=>(await this.getWorkingOperations(t)).filter(n=>{var i,o;return n.staged&&n.conflicts===void 0&&((o=(i=e==null?void 0:e.predicate)==null?void 0:i.call(e,n))!=null?o:!0)}),`ChangeStore.getStagedChanges(${t.toString()})`)}async getWorkingChanges(t,e){return this.lock.synchronizeRead(H(t),async()=>(await this.getWorkingOperations(t)).filter(n=>{var i,o;return!n.staged&&n.conflicts===void 0&&((o=(i=e==null?void 0:e.predicate)==null?void 0:i.call(e,n))!=null?o:!0)}),`ChangeStore.getWorkingChanges(${t.toString()})`)}async applyChangeset(t,e,r,n){var i;let o;Zy(r)?o=r:n=n!=null?n:r,C.log(`ChangeStore.applyChangeset${t.toString()}`,e.workspaceId,e.uri,o==null?void 0:o.uri,n==null?void 0:n.save);const a=this.getScopedChangeStore(e.workspaceId),s=(i=e.patch)!=null?i:await a.createPatch(e.uri,o==null?void 0:o.uri);await this.applyPatchCore(t,s,{...n,getIncomingContent:async l=>{const u=this.getScopedUri(this.providerService.createRelativeVirtualUri(e.uri,l),e.workspaceId);return Nn.decode(await h.workspace.fs.readFile(u))},merge:async(l,u,d)=>{try{const p=this.providerService.getProviderUri(l),f=Nn.decode(await h.workspace.fs.readFile(p)),g=this.getScopedUri(this.providerService.createRelativeVirtualUri(e.uri,u),e.workspaceId),x=Nn.decode(await h.workspace.fs.readFile(g));return{...Sp(d,f,x),baseUri:p,incomingUri:g}}catch(p){throw new Error(`Unable to apply patch to ${u}: ${String(p)}`)}}})}async applyPatch(t,e,r){if(C.log(`ChangeStore.applyPatch(${t.toString()})`,r==null?void 0:r.save),!e.startsWith("diff --"))throw new Error("Invalid patch");return this.applyPatchCore(t,e,r)}async applyPatchCore(t,e,r={}){const n=`ChangeStore.applyPatchCore(${t.toString()})`;C.debug(n,r==null?void 0:r.save);const i=new h.WorkspaceEdit,o=[],a=new Map;async function s(f){var g;const x=H(f),y=h.workspace.textDocuments.find(b=>H(b.uri)===x);return(g=y==null?void 0:y.getText())!=null?g:Nn.decode(await h.workspace.fs.readFile(f))}c(s,"getContent");async function l(f){try{const g=await h.workspace.fs.stat(f);return Boolean(g)}catch{return!1}}c(l,"exists");async function u(f,g,x){let y=_p("",x,{fuzzFactor:0});if(y===!1){if(!r.getIncomingContent)throw new Error(`Unable to apply patch to ${g}`);y=await r.getIncomingContent(g)}i.createFile(f,{overwrite:!0}),i.replace(f,new h.Range(0,0,Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),y)}c(u,"applyCreate");async function d(f,g,x,y){const b=await s(f);let S=_p(b,x,{fuzzFactor:1});if(S===!1){if(r.merge===void 0)throw new Error(`Unable to apply patch to ${g}; Resulted in conflicts`);const E={title:tn("apply patch failed prompt confirm","Merge")},D={title:tn("apply patch failed prompt cancel","Skip File"),isCloseAffordance:!0};if(await h.window.showWarningMessage(tn("apply patch failed prompt",`Unable to apply changes to '{0}'.

Do you want to retry by merging the files?`,g),{modal:!0,useCustom:!0},E,D)!==E)return;const z=await r.merge(f,g,b);S=z.mergedContent,z.conflicts&&a.set(H(f),{type:y,baseUri:z.baseUri,incomingUri:z.incomingUri})}i.replace(f,new h.Range(0,0,Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),S)}c(d,"applyModification");const p=(r==null?void 0:r.reverse)?Uy(e,{}):Wr(e,{});for(const f of p)if(f.oldFileName==="/dev/null"){if(!f.newFileName)continue;const g=f.newFileName.startsWith("b/")?f.newFileName.substr(2):f.newFileName,x=this.providerService.createRelativeVirtualUri(t,g);o.push(H(x)),!await l(x)?await u(x,g,f):await d(x,g,f,2)}else if(f.newFileName==="/dev/null"){if(!f.oldFileName)continue;const g=f.oldFileName.startsWith("a/")?f.oldFileName.substr(2):f.oldFileName,x=this.providerService.createRelativeVirtualUri(t,g);await l(x)&&i.deleteFile(x)}else if(f.oldFileName===f.newFileName){if(!f.newFileName)continue;const g=this.providerService.createRelativeVirtualUri(t,f.newFileName);o.push(H(g)),!await l(g)?await u(g,f.newFileName,f):await d(g,f.newFileName,f,1)}else throw new Error(`Unable to apply patch to ${f.oldFileName}; Renames aren't currently supported`);if(await h.workspace.applyEdit(i),r.save&&o.length)for(const f of o){const g=h.workspace.textDocuments.find(x=>H(x.uri)===f);await(g==null?void 0:g.save())}a.size&&setTimeout(async()=>{const f=[];await this.lock.synchronizeWrite(H(t),async()=>{const g=await this.getWorkingOperations(t);if(g.length===0)return;let x=-1;for(const y of g){x++;const b=a.get(H(y.uri));b!==void 0&&await this.spliceOperation(y.uri,x,{...y,conflicts:{baseUri:b.baseUri,incomingUri:b.incomingUri,status:[y.type,b.type]},timestamp:Date.now()},f)}},n),f.length!==0&&this._onDidChange.fire(f)},0)}async createChangeset(t){C.log(`ChangeStore.createChangeset${t.toString()})`);const e=await this.createPatch(t);return e?{workspaceId:this.workspaceId,uri:t,patch:e}:void 0}async createPatch(t,e,r){if(C.log(`ChangeStore.createPatch${t.toString()})`,e),e===void 0){let o=await this.getWorkingOperations(t);if((r==null?void 0:r.staged)&&(o=o.filter(s=>s.staged)),o.length===0)return"";const a=[];for(const s of o){const l=await this.createPatchCore(t,s);a.push(l)}return a.join("")}const{operation:n}=await this.getWorkingOperation(e,t);if(n===void 0)throw new Error(`Unable to create patch for ${e.toString()}`);return(r==null?void 0:r.staged)&&n.staged?"":await this.createPatchCore(t,n)}async createPatchCore(t,e){const r=this.providerService.getRelativeFilePath(t,e.uri),n=`diff --git a/${r} b/${r}`;if(e.type===2){let l=await this.getContent(e.uri),u;!l.endsWith(`
`)&&!l.endsWith(`\r
`)?u=`
\\ No newline at end of file`:u="";let d=0;return l=l.replace(/\r?\n/g,p=>(d++,`${p}+`)),`${n}
new file mode 100644
--- /dev/null
+++ b/${r}
@@ -0,0 +1,${d} @@
+${l}${u}`}if(e.type===3){let l=Nn.decode(await h.workspace.fs.readFile(this.providerService.getProviderUri(e.uri))),u=0;return l=l.replace(/\r?\n/g,d=>(u++,`${d}-`)),`${n}
deleted file mode 100644
--- a/${r}
+++ /dev/null
@@ -1,${u} +0,0 @@
-${l}`}const i=await this.getContent(e.uri),o=Nn.decode(await h.workspace.fs.readFile(this.providerService.getProviderUri(e.uri))),a=jo(r,o,i),s=a.indexOf(Rp);return`${n}
${a.substr(s+Rp.length)}`}async keep(t,e){const r=this.providerService.getVirtualWorkspaceUri(t);if(r===void 0)return;const n=`ChangeStore.keep(${t.toString()})`;C.log(n,e);const i=[];await this.lock.synchronizeWrite(H(r),async()=>{const{operation:o,index:a}=await this.getWorkingOperation(t,r);if(o===void 0)return;if(e===void 0&&o.conflicts){const[,l]=o.conflicts.status;switch(l){case 1:switch(o.type){case 1:case 2:case 3:await this.spliceOperation(t,a,{...o,conflicts:void 0,timestamp:Date.now()},i);break}break;case 2:switch(o.type){case 1:case 3:await this.spliceOperation(t,a,{...o,conflicts:void 0,timestamp:Date.now()},i);break;case 2:await this.spliceOperation(t,a,{...o,type:1,size:o.size,hash:o.hash,originalHash:o.originalHash,conflicts:void 0,timestamp:Date.now()},i);break}break;case 3:switch(o.type){case 3:await this.discardCore(r,t,i);break;case 1:await this.spliceOperation(t,a,{...o,type:2,originalHash:void 0,conflicts:void 0,timestamp:Date.now()},i);break;case 2:await this.spliceOperation(t,a,{...o,conflicts:void 0,timestamp:Date.now()},i);break}break}return}if(e===void 0)return;switch(e.type){case 1:switch(o.type){case 3:await this.spliceOperation(t,a,{...o,type:3,size:void 0,hash:void 0,originalHash:void 0,conflicts:void 0,timestamp:Date.now()},i);return;case 2:break;case 1:break}break;case 2:switch(o.type){case 1:case 3:return;case 2:break}break;case 3:switch(o.type){case 3:return this.discardCore(r,t,i);case 1:await this.spliceOperation(t,a,{...o,type:2,originalHash:void 0,conflicts:void 0,timestamp:Date.now()},i);return;case 2:return}}const s=e!==void 0?await h.workspace.fs.readFile(e.providerUri):void 0;await this.spliceOperation(t,a,{...o,type:1,originalHash:s!==void 0?await mn(s):o.originalHash,conflicts:void 0,timestamp:Date.now()},i)},n),i.length!==0&&this._onDidChange.fire(i)}async merge(t,e,r){const n=this.providerService.getVirtualWorkspaceUri(t);if(n===void 0)return;const i=`ChangeStore.merge(${t.toString()})`;C.log(i,e,r);const o=[];await this.lock.synchronizeWrite(H(n),async()=>{const{operation:a,index:s}=await this.getWorkingOperation(t,n);if(a===void 0)return;switch(e.type){case 1:switch(a.type){case 3:return void this.spliceOperation(t,s,{...a,type:3,size:void 0,hash:void 0,originalHash:void 0,conflicts:{baseUri:r.providerUri,incomingUri:e.providerUri,status:[a.type,e.type]},timestamp:Date.now()},o);case 2:break;case 1:break}break;case 2:switch(a.type){case 3:case 1:return;case 2:break}break;case 3:switch(a.type){case 3:return this.discardCore(n,t,o);case 1:return void this.spliceOperation(t,s,{...a,type:2,originalHash:void 0,conflicts:{baseUri:void 0,incomingUri:e.providerUri,status:[a.type,e.type]},timestamp:Date.now()},o);case 2:return}}const l=await this.getWorkingContent(n,t),u=await h.workspace.fs.readFile(r.providerUri),d=await h.workspace.fs.readFile(e.providerUri),p=Sp(Nn.decode(l),Nn.decode(u),Nn.decode(d));await this.writeFileCore(n,t,o,Ky.encode(p.mergedContent),d!=null?d:new Uint8Array(0),p.conflicts?{baseUri:r.providerUri,incomingUri:e.providerUri,status:[a.type,e.type]}:void 0)},i),o.length!==0&&this._onDidChange.fire(o)}async resolveDiffCommand(t,e,r,n){let i;const o=this.providerService.getVirtualRootUri(t);return o!==void 0&&({operation:i}=await this.getWorkingOperation(t,o)),(i==null?void 0:i.type)===3?this.resolveOpenCommand(e):((i==null?void 0:i.type)===2&&(e=e.with({query:"~"})),{command:"vscode.diff",title:"Open Changes",arguments:[e,t,r,n]})}resolveOpenCommand(t,e){return{command:"vscode.open",title:"Open File",arguments:[t,e]}}getScopedUri(t,e){const r=typeof e=="string"?e:e.workspaceId;return r===this.workspaceId?t:t.with({fragment:r})}getUriScope(t){return t.fragment||void 0}getScopedChangeStore(t){const e=typeof t=="string"?t:t.workspaceId;C.log(`ChangeStore.getScopedChangeStore(${e})`);let r=this.scopedStores.get(e);return r===void 0&&(r=e===this.workspaceId?new Vo.ScopedChangeStore(this,e,this.workspaceId):new Vo.ScopedChangeStore(new Vo(this.providerService,this.storageService.with(e),this.fileStorageService.with(e),this.telemetryService,this.workspaceId,e),e,this.workspaceId),this.scopedStores.set(e,r)),r}async stat(t){const e=this.getUriScope(t);if(e)return this.getScopedChangeStore(e).stat(t);const r=this.providerService.getVirtualRootUri(t);if(r===void 0)return;const n=H(r),i=this.cache.get(n);if((i==null?void 0:i.length)!==0)return this.lock.synchronizeRead(n,async()=>{var o;const{operation:a}=await this.getWorkingOperation(t,r);if(a!==void 0){if(a.type===3)throw h.FileSystemError.FileNotFound(`The ${a.fileType===h.FileType.Directory?"folder":"file"} has been deleted.`);return{type:a.fileType,size:(o=a.size)!=null?o:0,ctime:0,mtime:a.timestamp}}},`ChangeStore.stat(${t.toString()}`)}async readFile(t){const e=this.getUriScope(t);if(e)return this.getScopedChangeStore(e).readFile(t);const r=new Be(`ChangeStore.readFile(${t.toString()})`);try{const n=this.providerService.getVirtualRootUri(t);if(n===void 0)return;const i=H(n),o=this.cache.get(i);return(o==null?void 0:o.length)===0?void 0:await this.lock.synchronizeRead(i,()=>{const a=this.cache.get(i);if((a==null?void 0:a.length)===0){r.log({message:": Not found; no operations"});return}return this.getWorkingContent(n,t)},r.context)}finally{r.stop()}}async createDirectory(t){const e=this.providerService.getVirtualWorkspaceUri(t);if(e===void 0)return;const r=new Be(`ChangeStore.createDirectory(${t.toString()})`);try{const n=[];if(await this.lock.synchronizeWrite(H(e),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(t,e),a=await this.providerService.getMetadata(t);await this.spliceOperation(t,o,i===void 0?{type:2,uri:t,fileType:h.FileType.Directory,revision:a.HEAD.sha,timestamp:Date.now(),size:0,hash:"",originalHash:void 0}:{...i,timestamp:Date.now()},n)},r.context),n.length===0)return;this._onDidChange.fire(n)}finally{r.stop()}}async deleteDirectory(t){const e=this.providerService.getVirtualWorkspaceUri(t);if(e===void 0)return;const r=new Be(`ChangeStore.deleteDirectory(${t.toString()})`);try{const n=[];if(await this.lock.synchronizeWrite(H(e),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(t,e);if((i==null?void 0:i.type)===2)return this.discardCore(e,t,n);const a=await this.providerService.getMetadata(t);await this.spliceOperation(t,o,{type:3,uri:t,fileType:h.FileType.Directory,revision:a.HEAD.sha,timestamp:Date.now(),size:void 0,hash:void 0,originalHash:void 0},n)},r.context),n.length===0)return;this._onDidChange.fire(n)}finally{r.stop()}}async updateDirectoryEntries(t,e){const r=this.providerService.getVirtualWorkspaceUri(t);if(r===void 0)return e;const n=new Be(`ChangeStore.updateDirectoryEntries(${t.toString()})`,{},e.length);try{const i=H(r),o=this.cache.get(i);return(o==null?void 0:o.length)===0?e:await this.lock.synchronizeRead(i,async()=>{const{path:a}=Ue(r,t),s=await this.getWorkingOperations(r);for(const l of s)switch(l.type){case 1:break;case 2:{if(qe(l.uri,a)){const u=this.providerService.getRelativeFilePath(t,l.uri);e.push([u,l.fileType])}break}case 3:{if(qe(l.uri,a)){const u=this.providerService.getRelativeFilePath(t,l.uri),d=e.findIndex(([p])=>p===u);d!==-1&&e.splice(d,1)}break}}return e},n.context)}finally{n.stop()}}async writeFile(t,e,r,n){const i=this.providerService.getVirtualWorkspaceUri(t);if(i===void 0)return;const o=new Be(`ChangeStore.writeFile(${t.toString()})`,{},e.length,n);try{const a=[];if(await this.lock.synchronizeWrite(H(i),async()=>this.writeFileCore(i,t,a,e,r,n),o.context),a.length===0)return;this._onDidChange.fire(a)}finally{o.stop()}}async writeFileCore(t,e,r,n,i,o){const a=new Be(`ChangeStore.writeFileCore(${e.toString()})`,{},n.length,o);try{const[{operation:s,index:l},u,d]=await Promise.all([this.getWorkingOperation(e,t),mn(n),mn(i)]);if(u===d&&(s==null?void 0:s.type)===1)return this.discardCore(t,e,r);if(u===(s==null?void 0:s.hash)&&d===(s==null?void 0:s.originalHash))return;const[{HEAD:p}]=await Promise.all([this.providerService.getMetadata(e),this.saveWorkingContent(t,e,n)]);await this.spliceOperation(e,l,s===void 0?{type:1,uri:e,fileType:h.FileType.File,revision:p.sha,timestamp:Date.now(),size:n.byteLength,hash:u,originalHash:d,conflicts:o,staged:!1}:{...s,revision:p.sha,timestamp:Date.now(),size:n.byteLength,hash:u,originalHash:d,conflicts:o,staged:!1},r)}finally{a.stop()}}async createFile(t,e){const r=this.providerService.getVirtualWorkspaceUri(t);if(r===void 0)return;const n=new Be(`ChangeStore.createFile(${t.toString()})`,{},e.length);try{const i=[];if(await this.lock.synchronizeWrite(H(r),async()=>{const[{operation:o,index:a},s,l]=await Promise.all([this.getWorkingOperation(t,r),mn(e),this.providerService.getMetadata(t),this.saveWorkingContent(r,t,e)]);await this.spliceOperation(t,a,o===void 0?{type:2,uri:t,fileType:h.FileType.File,revision:l.HEAD.sha,timestamp:Date.now(),size:e.byteLength,hash:s,originalHash:s}:{...o,type:2,revision:l.HEAD.sha,timestamp:Date.now(),size:e.byteLength,hash:s},i)},n.context),i.length===0)return;this._onDidChange.fire(i)}finally{n.stop()}}async deleteFile(t){const e=this.providerService.getVirtualWorkspaceUri(t);if(e===void 0)return;const r=new Be(`ChangeStore.deleteFile(${t.toString()})`);try{const n=[];if(await this.lock.synchronizeWrite(H(e),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(t,e);if((i==null?void 0:i.type)===2)return this.discardCore(e,t,n);const[a]=await Promise.all([this.providerService.getMetadata(t),this.discardWorkingContent(e,t)]);await this.spliceOperation(t,o,{type:3,uri:t,fileType:h.FileType.File,revision:a.HEAD.sha,timestamp:Date.now(),size:void 0,hash:void 0,originalHash:void 0},n)},r.context),n.length===0)return;this._onDidChange.fire(n)}finally{r.stop()}}findParent(t,e,r){const n=De(t),{operation:i,index:o}=this.findWorkingOperation(n,e);return i!==void 0&&r(i,e)?{parent:i,parentIndex:o}:{parent:void 0,parentIndex:-1}}findNewParentWithOnlyChild(t,e){const r=ue(t);return this.findParent(t,e,(n,i)=>n.type===2&&!i.some(o=>qe(o.uri,n.uri)&&ue(o.uri)!==r))}async getWorkingOperation(t,e){return this.findWorkingOperation(t,await this.getWorkingOperations(e))}findWorkingOperation(t,e){if(e.length===0)return{operation:void 0,index:-1};const r=ue(t);let n=-1;const i=e.find((o,a)=>ue(o.uri)!==r?!1:(n=a,!0));return i===void 0?{operation:void 0,index:-1}:{operation:i,index:n}}async getWorkingOperations(t){const e=H(t);let r=this.cache.get(e);return r===void 0&&(r=this.fromStorage(await this.storageService.get(this.getOperationsStorageKey(e))),this.cache.set(e,r)),r}async saveWorkingOperations(t,e){C.debug(`ChangeStore.saveWorkingOperations(${t.toString()})`,e.length);const r=H(t);this.cache.set(r,e);try{await this.storageService.store(this.getOperationsStorageKey(r),this.toStorage(e))}catch(n){throw this.cache.delete(r),C.error(n,`Failed to save repository changes for ${r}`),n}}getOperationsStorageKey(t){return`operations/${t}`}async getWorkingContent(t,e){try{return await this.fileStorageService.get(this.getFileStorageKey(t,e))}catch(r){throw C.error(r),this.telemetryService.sendException(r),r}}async discardWorkingContent(t,e){C.debug(`ChangeStore.discardWorkingContent(${e.toString()})`);try{return await this.fileStorageService.delete(this.getFileStorageKey(t,e))}catch(r){if(r instanceof h.FileSystemError&&r.code===Gy)return;throw C.error(r),this.telemetryService.sendException(r),r}}async saveWorkingContent(t,e,r){C.debug(`ChangeStore.saveWorkingContent(${e.toString()})`,r.length);try{return await this.fileStorageService.store(this.getFileStorageKey(t,e),r)}catch(n){throw C.error(n),this.telemetryService.sendException(n),n}}getFileStorageKey(t,e){return`changestore/${le(e)}`}async spliceOperation(t,e,r,n){const i=this.providerService.getVirtualWorkspaceUri(t);if(i===void 0)return;const o=await this.getWorkingOperations(i);e!==-1?o.splice(e,1,r):o.push(r),await this.saveWorkingOperations(i,o),n.push(rs(r,i,t))}fromStorage(t){if(!t)return[];try{const e=JSON.parse(t,(r,n)=>(r==="uri"||r.endsWith("Uri"))&&rt(n)?typeof n=="string"?h.Uri.parse(n):h.Uri.from(n):n);return Array.isArray(e)?e:e.operations}catch(e){throw C.error(e,"Failed to deserialize ChangeStore operations"),e}}toStorage(t){const e={schemaVersion:Vo.operationsStorageSchemaVersion,operations:t};return JSON.stringify(e)}},"_ChangeStore");let ns=Vo;ns.operationsStorageSchemaVersion=1,ns.ScopedChangeStore=class{constructor(t,e,r){this.changeStore=t,this.scope=e,this.workspaceId=r}createPatch(t,e,r){return this.changeStore.createPatch(this.stripUriScope(t),this.stripUriScope(e),r)}discardAll(t,e){return this.changeStore.discardAll(this.stripUriScope(t),e)}getChange(t){return this.changeStore.getChange(this.stripUriScope(t))}getChanges(t,e){return this.changeStore.getChanges(this.stripUriScope(t),e)}async getGroupedChanges(t,e){return this.changeStore.getGroupedChanges(this.stripUriScope(t),e)}hasChanges(t){return this.changeStore.hasChanges(this.stripUriScope(t))}maybeHasChanges(t,e){return this.changeStore.maybeHasChanges(this.stripUriScope(t),this.stripUriScope(e))}async stat(t){const r=this.changeStore.getUriScope(t)!==this.workspaceId,n=await this.changeStore.stat(this.stripUriScope(t));return n!==void 0&&r&&(n.permissions=h.FilePermission.Readonly),n}readFile(t){return this.changeStore.readFile(this.stripUriScope(t))}resolveDiffCommand(t,e,r,n){return this.changeStore.resolveDiffCommand(this.changeStore.getScopedUri(t,this.scope),this.changeStore.getScopedUri(e,this.scope),r,n)}stripUriScope(t){return t===void 0||!t.fragment?t:t.with({fragment:""})}},Vy([Sr()],ns.prototype,"getWorkingOperations",1);function Ap(t){switch(t){case 1:return tn("change type changed","Modified");case 2:return tn("change type created","Added");case 3:return tn("change type deleted","Deleted")}}c(Ap,"getStatusText");function Xy(t){const[e,r]=t;switch(e){case 1:switch(r){case 1:case 2:return tn("conflict status changed both","Modified by Both");case 3:return tn("conflict status deleted them","Deleted by Incoming")}break;case 2:switch(r){case 1:case 2:return tn("conflict status created both","Added by Both");case 3:return tn("conflict status deleted them","Deleted by Incoming")}break;case 3:switch(r){case 1:case 2:return tn("conflict status deleted us","Deleted by Current");case 3:return tn("conflict status deleted both","Deleted by Both")}break}}c(Xy,"getConflictStatusText");var Tp=Object.defineProperty,Qy=c(t=>Tp(t,"__esModule",{value:!0}),"vu"),Te=c((t,e)=>()=>(t&&(e=t(t=0)),e),"C"),Yy=c((t,e)=>{Qy(t);for(var r in e)Tp(t,r,{get:e[r],enumerable:!0})},"hu"),kp,Jy=Te(()=>{kp={Unknown:0,NonRetryableStatus:1,InvalidEvent:2,SizeLimitExceeded:3,KillSwitch:4,QueueFull:5}}),Go,Mn,li,Qr,Pc,ui,Fc,$c,Ip,Dp,is,ju=Te(()=>{Go="function",Mn="object",li="undefined",Qr="prototype",Pc="hasOwnProperty",ui=Object,Fc=ui[Qr],$c=ui.assign,Ip=ui.create,Dp=ui.defineProperty,is=Fc[Pc]});function Ko(){return typeof globalThis!==li&&globalThis?globalThis:typeof self!==li&&self?self:typeof window!==li&&window?window:typeof __webpack_require__.g!==li&&__webpack_require__.g?__webpack_require__.g:null}c(Ko,"ot");function Vu(t){throw new TypeError(t)}c(Vu,"Ir");function Nc(t){var e=Ip;if(e)return e(t);if(t==null)return{};var r=typeof t;r!==Mn&&r!==Go&&Vu("Object prototype may only be an Object:"+t);function n(){}return c(n,"n"),n[Qr]=t,new n}c(Nc,"Dt");var Pp=Te(()=>{ju()});function Bt(t,e){typeof e!==Go&&e!==null&&Vu("Class extends value "+String(e)+" is not a constructor or null"),Mc(t,e);function r(){this.constructor=t}c(r,"r"),t[Qr]=e===null?Nc(e):(r[Qr]=e[Qr],new r)}c(Bt,"H");var eb,tb,Fp,Zo,Mc,rb=Te(()=>{ju(),Pp(),eb=(Ko()||{}).Symbol,tb=(Ko()||{}).Reflect,Fp=c(function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Fc[Pc].call(e,i)&&(t[i]=e[i])}return t},"Su"),Zo=$c||Fp,Mc=c(function(t,e){return Mc=ui.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n[Pc](i)&&(r[i]=n[i])},Mc(t,e)},"Ai")}),nb=Te(()=>{}),Wt=Te(()=>{ju(),Pp(),rb(),nb()});function Bi(t,e){return t&&cs[Bn].hasOwnProperty.call(t,e)}c(Bi,"jt");function $p(t){return t&&(t===cs[Bn]||t===Array[Bn])}c($p,"To");function Gu(t){return $p(t)||t===Function[Bn]}c(Gu,"Ri");function co(t){if(t){if(Qo)return Qo(t);var e=t[Mp]||t[Bn]||(t[os]?t[os][Bn]:null);if(e)return e}return null}c(co,"nr");function Bc(t,e){var r=[],n=cs.getOwnPropertyNames;if(n)r=n(t);else for(var i in t)typeof i=="string"&&Bi(t,i)&&r.push(i);if(r&&r.length>0)for(var o=0;o<r.length;o++)e(r[o])}c(Bc,"Bn");function Ku(t,e,r){return e!==os&&typeof t[e]===as&&(r||Bi(t,e))}c(Ku,"Mi");function Oc(t){throw new TypeError("DynamicProto: "+t)}c(Oc,"Vn");function ib(t){var e={};return Bc(t,function(r){!e[r]&&Ku(t,r,!1)&&(e[r]=t[r])}),e}c(ib,"Tu");function Zu(t,e){for(var r=t.length-1;r>=0;r--)if(t[r]===e)return!0;return!1}c(Zu,"Li");function ob(t,e,r,n){function i(l,u,d){var p=u[d];if(p[Uc]&&n){var f=l[ss]||{};f[Xo]!==!1&&(p=(f[u[lo]]||{})[d]||p)}return function(){return p.apply(l,arguments)}}c(i,"i");var o={};Bc(r,function(l){o[l]=i(e,r,l)});for(var a=co(t),s=[];a&&!Gu(a)&&!Zu(s,a);)Bc(a,function(l){!o[l]&&Ku(a,l,!Qo)&&(o[l]=i(e,a,l))}),s.push(a),a=co(a);return o}c(ob,"Eu");function ab(t,e,r,n){var i=null;if(t&&Bi(r,lo)){var o=t[ss]||{};if(i=(o[r[lo]]||{})[e],i||Oc("Missing ["+e+"] "+as),!i[Lc]&&o[Xo]!==!1){for(var a=!Bi(t,e),s=co(t),l=[];a&&s&&!Gu(s)&&!Zu(l,s);){var u=s[e];if(u){a=u===n;break}l.push(s),s=co(s)}try{a&&(t[e]=i),i[Lc]=1}catch(d){o[Xo]=!1}}}return i}c(ab,"wu");function sb(t,e,r){var n=e[t];return n===r&&(n=co(e)[t]),typeof n!==as&&Oc("["+t+"] is not a "+as),n}c(sb,"Pu");function cb(t,e,r,n,i){function o(l,u){var d=c(function(){var p=ab(this,u,l,d)||sb(u,l,d);return p.apply(this,arguments)},"l");return d[Uc]=1,d}if(c(o,"a"),!$p(t)){var a=r[ss]=r[ss]||{},s=a[e]=a[e]||{};a[Xo]!==!1&&(a[Xo]=!!i),Bc(r,function(l){Ku(r,l,!1)&&r[l]!==n[l]&&(s[l]=r[l],delete r[l],(!Bi(t,l)||t[l]&&!t[l][Uc])&&(t[l]=o(t,l)))})}}c(cb,"bu");function lb(t,e){if(Qo)for(var r=[],n=co(e);n&&!Gu(n)&&!Zu(r,n);){if(n===t)return!0;r.push(n),n=co(n)}return!1}c(lb,"Du");function Xu(t,e){return Bi(t,Bn)?t.name||e||Ju:((t||{})[os]||{}).name||e||Ju}c(Xu,"Ui");function Qu(t,e,r,n){Bi(t,Bn)||Oc("theClass is an invalid class definition.");var i=t[Bn];lb(i,e)||Oc("["+Xu(t)+"] is not in class hierarchy of ["+Xu(e)+"]");var o=null;Bi(i,lo)?o=i[lo]:(o=Np+Xu(t,"_")+"$"+td,td++,i[lo]=o);var a=Qu[Yu],s=!!a[Hc];s&&n&&n[Hc]!==void 0&&(s=!!n[Hc]);var l=ib(e),u=ob(i,e,l,s);r(e,u);var d=!!Qo&&!!a[ed];d&&n&&(d=!!n[ed]),cb(i,o,e,l,d!==!1)}c(Qu,"_i");var os,Bn,as,ss,Uc,lo,Np,Lc,Xo,Yu,Ju,Mp,Hc,ed,cs,Qo,td,Bp,or,yr=Te(()=>{os="constructor",Bn="prototype",as="function",ss="_dynInstFuncs",Uc="_isDynProxy",lo="_dynClass",Np="_dynCls$",Lc="_dynInstChk",Xo=Lc,Yu="_dfOpts",Ju="_unknown_",Mp="__proto__",Hc="useBaseInst",ed="setInstFuncs",cs=Object,Qo=cs.getPrototypeOf,td=0,Bp={setInstFuncs:!0,useBaseInst:!0},Qu[Yu]=Bp,or=Qu}),Le,Fe,zc=Te(()=>{(function(t){t[t.CRITICAL=1]="CRITICAL",t[t.WARNING=2]="WARNING"})(Le||(Le={})),Fe={BrowserDoesNotSupportLocalStorage:0,BrowserCannotReadLocalStorage:1,BrowserCannotReadSessionStorage:2,BrowserCannotWriteLocalStorage:3,BrowserCannotWriteSessionStorage:4,BrowserFailedRemovalFromLocalStorage:5,BrowserFailedRemovalFromSessionStorage:6,CannotSendEmptyTelemetry:7,ClientPerformanceMathError:8,ErrorParsingAISessionCookie:9,ErrorPVCalc:10,ExceptionWhileLoggingError:11,FailedAddingTelemetryToBuffer:12,FailedMonitorAjaxAbort:13,FailedMonitorAjaxDur:14,FailedMonitorAjaxOpen:15,FailedMonitorAjaxRSC:16,FailedMonitorAjaxSend:17,FailedMonitorAjaxGetCorrelationHeader:18,FailedToAddHandlerForOnBeforeUnload:19,FailedToSendQueuedTelemetry:20,FailedToReportDataLoss:21,FlushFailed:22,MessageLimitPerPVExceeded:23,MissingRequiredFieldSpecification:24,NavigationTimingNotSupported:25,OnError:26,SessionRenewalDateIsZero:27,SenderNotInitialized:28,StartTrackEventFailed:29,StopTrackEventFailed:30,StartTrackFailed:31,StopTrackFailed:32,TelemetrySampledAndNotSent:33,TrackEventFailed:34,TrackExceptionFailed:35,TrackMetricFailed:36,TrackPVFailed:37,TrackPVFailedCalc:38,TrackTraceFailed:39,TransmissionFailed:40,FailedToSetStorageBuffer:41,FailedToRestoreStorageBuffer:42,InvalidBackendResponse:43,FailedToFixDepricatedValues:44,InvalidDurationValue:45,TelemetryEnvelopeInvalid:46,CreateEnvelopeError:47,CannotSerializeObject:48,CannotSerializeObjectNonSerializable:49,CircularReferenceDetected:50,ClearAuthContextFailed:51,ExceptionTruncated:52,IllegalCharsInName:53,ItemNotInArray:54,MaxAjaxPerPVExceeded:55,MessageTruncated:56,NameTooLong:57,SampleRateOutOfRange:58,SetAuthContextFailed:59,SetAuthContextFailedAccountName:60,StringValueTooLong:61,StartCalledMoreThanOnce:62,StopCalledWithoutStart:63,TelemetryInitializerFailed:64,TrackArgumentsNotSpecified:65,UrlTooLong:66,SessionStorageBufferFull:67,CannotAccessCookie:68,IdTooLong:69,InvalidEvent:70,FailedMonitorAjaxSetRequestHeader:71,SendBrowserInfoOnUserInit:72,PluginException:73,NotificationException:74,SnippetScriptLoadFailure:99,InvalidInstrumentationKey:100,CannotParseAiBlobValue:101,InvalidContentBlob:102,TrackPageActionEventFailed:103}});function rd(t){return Fc.toString.call(t)}c(rd,"Oi");function ub(t,e){return typeof t===e}c(ub,"Hi");function Or(t){return t===void 0||typeof t===li}c(Or,"pe");function He(t){return t===null||Or(t)}c(He,"x");function db(t){return!He(t)}c(db,"ji");function nd(t,e){return t&&is.call(t,e)}c(nd,"Er");function uo(t){return typeof t===Mn}c(uo,"st");function Tt(t){return typeof t===Go}c(Tt,"j");function ls(t,e,r,n){n===void 0&&(n=!1);var i=!1;if(!He(t))try{He(t[ud])?He(t[ld])||(t[ld](cd+e,r),i=!0):(t[ud](e,r,n),i=!0)}catch(o){}return i}c(ls,"zt");function Op(t,e,r,n){if(n===void 0&&(n=!1),!He(t))try{He(t[hd])?He(t[dd])||t[dd](cd+e,r):t[hd](e,r,n)}catch(i){}}c(Op,"qn");function hb(t){var e=t,r=/([^\w\d_$])/g;return r.test(t)&&(e=t.replace(r,"_")),e}c(hb,"zi");function dr(t,e){if(t)for(var r in t)is.call(t,r)&&e.call(t,r,t[r])}c(dr,"Q");function fb(t,e){if(t&&e){var r=e.length,n=t.length;if(t===e)return!0;if(n>=r){for(var i=n-1,o=r-1;o>=0;o--){if(t[i]!=e[o])return!1;i--}return!0}}return!1}c(fb,"Bi");function kr(t,e){return t&&e?t.indexOf(e)!==-1:!1}c(kr,"Ee");function id(t){return rd(t)==="[object Date]"}c(id,"wr");function di(t){return rd(t)==="[object Array]"}c(di,"Re");function Wc(t){return rd(t)==="[object Error]"}c(Wc,"Bt");function xt(t){return typeof t=="string"}c(xt,"_");function od(t){return typeof t=="number"}c(od,"ir");function ad(t){return typeof t=="boolean"}c(ad,"Gr");function Oi(t){if(id(t)){var e=c(function(r){var n=String(r);return n.length===1&&(n="0"+n),n},"e");return t.getUTCFullYear()+"-"+e(t.getUTCMonth()+1)+"-"+e(t.getUTCDate())+"T"+e(t.getUTCHours())+":"+e(t.getUTCMinutes())+":"+e(t.getUTCSeconds())+"."+String((t.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}c(Oi,"Me");function _t(t,e,r){for(var n=t.length,i=0;i<n&&!(i in t&&e.call(r||t,t[i],i,t)===-1);i++);}c(_t,"R");function us(t,e,r){for(var n=t.length,i=r||0,o=Math.max(i>=0?i:n-Math.abs(i),0);o<n;o++)if(o in t&&t[o]===e)return o;return-1}c(us,"Nt");function ds(t,e,r){for(var n=t.length,i=r||t,o=new Array(n),a=0;a<n;a++)a in t&&(o[a]=e.call(i,t[a],t));return o}c(ds,"Vt");function Up(t,e,r){var n=t.length,i=0,o;if(arguments.length>=3)o=arguments[2];else{for(;i<n&&!(i in t);)i++;o=t[i++]}for(;i<n;)i in t&&(o=e(o,t[i],i,t)),i++;return o}c(Up,"Kr");function Cr(t){return typeof t!="string"?t:t.replace(/^\s+|\s+$/g,"")}c(Cr,"oe");function ho(t){var e=typeof t;e!==Go&&(e!==Mn||t===null)&&Vu("objKeys called on non-object");var r=[];for(var n in t)t&&is.call(t,n)&&r.push(n);if(Wp)for(var i=qc.length,o=0;o<i;o++)t&&is.call(t,qc[o])&&r.push(qc[o]);return r}c(ho,"Qe");function Yo(t,e,r,n){if(fd)try{var i={enumerable:!0,configurable:!0};return r&&(i.get=r),n&&(i.set=n),fd(t,e,i),!0}catch(o){}return!1}c(Yo,"St");function rn(){var t=Date;return t.now?t.now():new t().getTime()}c(rn,"de");function Ft(t){return Wc(t)?t.name:""}c(Ft,"G");function kt(t,e,r,n,i){var o=r;return t&&(o=t[e],o!==r&&(!i||i(o))&&(!n||n(r))&&(o=r,t[e]=o)),o}c(kt,"K");function Ir(t,e,r){var n;return t?(n=t[e],!n&&He(n)&&(n=Or(r)?{}:r,t[e]=n)):n=Or(r)?{}:r,n}c(Ir,"ge");function Lp(t){return!t}c(Lp,"Gn");function sd(t){return!!t}c(sd,"Pr");function On(t){throw new Error(t)}c(On,"Ae");function Hp(t,e,r){if(t&&e&&t!==e&&uo(t)&&uo(e)){var n=c(function(o){if(xt(o)){var a=e[o];Tt(a)?(!r||r(o,!0,e,t))&&(t[o]=function(s){return function(){var l=arguments;return e[s].apply(e,l)}}(o)):(!r||r(o,!1,e,t))&&(nd(t,o)&&delete t[o],Yo(t,o,function(){return e[o]},function(s){e[o]=s})||(t[o]=a))}},"n");for(var i in e)n(i)}return t}c(Hp,"Wr");function pb(t){return function(){function e(){var r=this;t&&dr(t,function(n,i){r[n]=i})}return c(e,"e"),e}()}c(pb,"qi");function zp(t){return t&&(t=ui($c?$c({},t):t)),t}c(zp,"Kn");var cd,ld,ud,dd,hd,fd,gb,mb,Wp,qc,Dr=Te(()=>{Wt(),cd="on",ld="attachEvent",ud="addEventListener",dd="detachEvent",hd="removeEventListener",fd=Dp,gb=ui.freeze,mb=ui.seal,Wp=!{toString:null}.propertyIsEnumerable("toString"),qc=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]});function Pr(t){var e=Ko();return e&&e[t]?e[t]:t===gd&&jc()?window:null}c(Pr,"we");function jc(){return Boolean(typeof window===Mn&&window)}c(jc,"ar");function hs(){return jc()?window:Pr(gd)}c(hs,"Ct");function qp(){return Boolean(typeof document===Mn&&document)}c(qp,"Wn");function Un(){return qp()?document:Pr(jp)}c(Un,"Ne");function vb(){return Boolean(typeof navigator===Mn&&navigator)}c(vb,"ko");function Ln(){return vb()?navigator:Pr(Vp)}c(Ln,"Ue");function wb(){return Boolean(typeof history===Mn&&history)}c(wb,"Ro");function yb(){return wb()?history:Pr(Gp)}c(yb,"Xi");function fo(t){if(t&&eg){var e=Pr("__mockLocation");if(e)return e}return typeof location===Mn&&location?location:Pr(Kp)}c(fo,"et");function bb(){return typeof console!==li?console:Pr(Zp)}c(bb,"Yi");function hi(){return Pr(Xp)}c(hi,"Ye");function Jo(){return Boolean(typeof JSON===Mn&&JSON||Pr(md)!==null)}c(Jo,"vt");function xn(){return Jo()?JSON||Pr(md):null}c(xn,"Pe");function xb(){return Pr(Qp)}c(xb,"$i");function _b(){return Pr(Yp)}c(_b,"Zi");function Sb(){var t=Ln();return t&&t.product?t.product===Jp:!1}c(Sb,"Qi");function Vc(){var t=Ln();if(t&&(t.userAgent!==Xc||Zc===null)){Xc=t.userAgent;var e=(Xc||"").toLowerCase();Zc=kr(e,Gc)||kr(e,Kc)}return Zc}c(Vc,"qt");function pd(t){if(t===void 0&&(t=null),!t){var e=Ln()||{};t=e?(e.userAgent||"").toLowerCase():""}var r=(t||"").toLowerCase();if(kr(r,Gc))return parseInt(r.split(Gc)[1]);if(kr(r,Kc)){var n=parseInt(r.split(Kc)[1]);if(n)return n+4}return null}c(pd,"or");function vt(t){var e=Object[Qr].toString.call(t),r="";return e==="[object Error]"?r="{ stack: '"+t.stack+"', message: '"+t.message+"', name: '"+t.name+"'":Jo()&&(r=xn().stringify(t)),e+r}c(vt,"O");var gd,jp,Vp,Gp,Kp,Zp,Xp,md,Qp,Yp,Jp,Gc,Kc,Zc,Xc,eg,fs=Te(()=>{Wt(),Dr(),gd="window",jp="document",Vp="navigator",Gp="history",Kp="location",Zp="console",Xp="performance",md="JSON",Qp="crypto",Yp="msCrypto",Jp="ReactNative",Gc="msie",Kc="trident/",Zc=null,Xc=null,eg=!1});function tg(t){return t?'"'+t.replace(/\"/g,"")+'"':""}c(tg,"Mo");function Qc(t,e){return(t||{}).logger||new vd(e)}c(Qc,"kt");var rg,ng,ig,ea,vd,wd=Te(()=>{zc(),fs(),yr(),Dr(),rg="AI (Internal): ",ng="AI: ",ig="AITR_",ea=function(){function t(e,r,n,i){n===void 0&&(n=!1);var o=this;o.messageId=e,o.message=(n?ng:rg)+e;var a="";Jo()&&(a=xn().stringify(i));var s=(r?" message:"+tg(r):"")+(i?" props:"+tg(a):"");o.message+=s}return c(t,"t"),t.dataType="MessageData",t}(),vd=function(){function t(e){this.identifier="DiagnosticLogger",this.queue=[];var r=0,n={};or(t,this,function(i){He(e)&&(e={}),i.consoleLoggingLevel=function(){return o("loggingLevelConsole",0)},i.telemetryLoggingLevel=function(){return o("loggingLevelTelemetry",1)},i.maxInternalMessageLimit=function(){return o("maxMessageLimit",25)},i.enableDebugExceptions=function(){return o("enableDebugExceptions",!1)},i.throwInternal=function(s,l,u,d,p){p===void 0&&(p=!1);var f=new ea(l,u,p,d);if(i.enableDebugExceptions())throw f;if(!Or(f.message)){var g=i.consoleLoggingLevel();if(p){var x=+f.messageId;!n[x]&&g>=Le.WARNING&&(i.warnToConsole(f.message),n[x]=!0)}else g>=Le.WARNING&&i.warnToConsole(f.message);i.logInternalMessage(s,f)}},i.warnToConsole=function(s){var l=bb();if(l){var u="log";l.warn&&(u="warn"),Tt(l[u])&&l[u](s)}},i.resetInternalMessageCount=function(){r=0,n={}},i.logInternalMessage=function(s,l){if(!a()){var u=!0,d=ig+l.messageId;if(n[d]?u=!1:n[d]=!0,u&&(s<=i.telemetryLoggingLevel()&&(i.queue.push(l),r++),r===i.maxInternalMessageLimit())){var p="Internal events throttle limit per PageView reached for this app.",f=new ea(Fe.MessageLimitPerPVExceeded,p,!1);i.queue.push(f),i.warnToConsole(p)}}};function o(s,l){var u=e[s];return He(u)?l:u}c(o,"a");function a(){return r>=i.maxInternalMessageLimit()}c(a,"o")})}return c(t,"t"),t}()});function ta(t,e,r,n,i){if(t){var o=t;if(Tt(o.getPerfMgr)&&(o=o.getPerfMgr()),o){var a=void 0,s=o.getCtx(Yc);try{if(a=o.create(e(),n,i),a){if(s&&a.setCtx&&(a.setCtx(ra.ParentContextKey,s),s.getCtx&&s.setCtx)){var l=s.getCtx(ra.ChildrenContextKey);l||(l=[],s.setCtx(ra.ChildrenContextKey,l)),l.push(a)}return o.setCtx(Yc,a),r(a)}}catch(u){a&&a.setCtx&&a.setCtx("exception",u)}finally{a&&o.fire(a),o.setCtx(Yc,s)}}}return r()}c(ta,"ct");var po,ra,yd,Yc,Jc=Te(()=>{yr(),Dr(),po="ctx",ra=function(){function t(e,r,n){var i=this,o=!1;if(i.start=rn(),i.name=e,i.isAsync=n,i.isChildEvt=function(){return!1},Tt(r)){var a;o=Yo(i,"payload",function(){return!a&&Tt(r)&&(a=r(),r=null),a})}i.getCtx=function(s){return s?s===t.ParentContextKey||s===t.ChildrenContextKey?i[s]:(i[po]||{})[s]:null},i.setCtx=function(s,l){if(s)if(s===t.ParentContextKey)i[s]||(i.isChildEvt=function(){return!0}),i[s]=l;else if(s===t.ChildrenContextKey)i[s]=l;else{var u=i[po]=i[po]||{};u[s]=l}},i.complete=function(){var s=0,l=i.getCtx(t.ChildrenContextKey);if(di(l))for(var u=0;u<l.length;u++){var d=l[u];d&&(s+=d.time)}i.time=rn()-i.start,i.exTime=i.time-s,i.complete=function(){},!o&&Tt(r)&&(i.payload=r())}}return c(t,"t"),t.ParentContextKey="parent",t.ChildrenContextKey="childEvts",t}(),yd=function(){function t(e){this.ctx={},or(t,this,function(r){r.create=function(n,i,o){return new ra(n,i,o)},r.fire=function(n){n&&(n.complete(),e&&e.perfEvent(n))},r.setCtx=function(n,i){if(n){var o=r[po]=r[po]||{};o[n]=i}},r.getCtx=function(n){return(r[po]||{})[n]}})}return c(t,"t"),t}(),Yc="CoreUtils.doPerf"}),og,Cb=Te(()=>{Jc(),zc(),Dr(),og=function(){function t(e,r){var n=this,i=null,o=Tt(e.processTelemetry),a=Tt(e.setNextPlugin);n._hasRun=!1,n.getPlugin=function(){return e},n.getNext=function(){return i},n.setNext=function(s){i=s},n.processTelemetry=function(s,l){l||(l=r);var u=e?e.identifier:"TelemetryPluginChain";ta(l?l.core():null,function(){return u+":processTelemetry"},function(){if(e&&o){n._hasRun=!0;try{l.setNext(i),a&&e.setNextPlugin(i),i&&(i._hasRun=!1),e.processTelemetry(s,l)}catch(p){var d=i&&i._hasRun;(!i||!d)&&l.diagLog().throwInternal(Le.CRITICAL,Fe.PluginException,"Plugin ["+e.identifier+"] failed during processTelemetry - "+p),i&&!d&&i.processTelemetry(s,l)}}else i&&(n._hasRun=!0,i.processTelemetry(s,l))},function(){return{item:s}},!s.sync)}}return c(t,"t"),t}()});function bd(t,e){var r=[];if(t&&t.length>0)for(var n=null,i=0;i<t.length;i++){var o=t[i];if(o&&Tt(o.processTelemetry)){var a=new og(o,e);r.push(a),n&&n.setNext(a),n=a}}return r.length>0?r[0]:null}c(bd,"ta");function Eb(t,e,r){var n=[],i=!r;if(t)for(;t;){var o=t.getPlugin();(i||o===r)&&(i=!0,n.push(o)),t=t.getNext()}return i||n.push(r),bd(n,e)}c(Eb,"qu");function Rb(t,e,r){var n=t,i=!1;return r&&t&&(n=[],_t(t,function(o){(i||o===r)&&(i=!0,n.push(o))})),r&&!i&&(n||(n=[]),n.push(r)),bd(n,e)}c(Rb,"Gu");var go,xd=Te(()=>{wd(),Cb(),Dr(),go=function(){function t(e,r,n,i){var o=this,a=null;i!==null&&(e&&Tt(e.getPlugin)?a=Eb(e,o,i||e.getPlugin()):i?a=Rb(e,o,i):Or(i)&&(a=bd(e,o))),o.core=function(){return n},o.diagLog=function(){return Qc(n,r)},o.getCfg=function(){return r},o.getExtCfg=function(s,l){l===void 0&&(l={});var u;if(r){var d=r.extensionConfig;d&&s&&(u=d[s])}return u||l},o.getConfig=function(s,l,u){u===void 0&&(u=!1);var d,p=o.getExtCfg(s,null);return p&&!He(p[l])?d=p[l]:r&&!He(r[l])&&(d=r[l]),He(d)?u:d},o.hasNext=function(){return a!=null},o.getNext=function(){return a},o.setNext=function(s){a=s},o.processNext=function(s){var l=a;l&&(a=l.getNext(),l.processTelemetry(s,o))},o.createNew=function(s,l){return s===void 0&&(s=null),new t(s||a,r,n,l)}}return c(t,"t"),t}()}),ag,_d,sg=Te(()=>{ag="iKey",_d="extensionConfig"}),ps,mo,cg=Te(()=>{xd(),Dr(),sg(),ps="getPlugin",mo=function(){function t(){var e=this,r=!1,n=null,i=null;e.core=null,e.diagLog=function(o){return e._getTelCtx(o).diagLog()},e.isInitialized=function(){return r},e.setInitialized=function(o){r=o},e.setNextPlugin=function(o){i=o},e.processNext=function(o,a){a?a.processNext(o):i&&Tt(i.processTelemetry)&&i.processTelemetry(o,null)},e._getTelCtx=function(o){o===void 0&&(o=null);var a=o;if(!a){var s=n||new go(null,{},e.core);i&&i[ps]?a=s.createNew(null,i[ps]):a=s.createNew(null,i)}return a},e._baseTelInit=function(o,a,s,l){o&&kt(o,_d,[],null,He),!l&&a&&(l=a.getProcessTelContext().getNext());var u=i;i&&i[ps]&&(u=i[ps]()),e.core=a,n=new go(l,o,a,u),r=!0}}return c(t,"t"),t.prototype.initialize=function(e,r,n,i){this._baseTelInit(e,r,n,i)},t}()});function Sd(t,e){for(var r=[],n=null,i=t.getNext();i;){var o=i.getPlugin();o&&(n&&Tt(n[Ed])&&Tt(o[el])&&n[Ed](o),(!Tt(o[Rd])||!o[Rd]())&&r.push(o),n=o,i=i.getNext())}_t(r,function(a){a.initialize(t.getCfg(),t.core(),e,t.getNext())})}c(Sd,"Yr");function lg(t){return t.sort(function(e,r){var n=0,i=Tt(r[el]);return Tt(e[el])?n=i?e[Cd]-r[Cd]:1:i&&(n=-1),n})}c(lg,"aa");var el,Cd,Ed,Rd,ug=Te(()=>{Dr(),el="processTelemetry",Cd="priority",Ed="setNextPlugin",Rd="isInitialized"}),tl,dg,hg,Ab=Te(()=>{Wt(),yr(),cg(),xd(),ug(),Dr(),tl=500,dg="Channel has invalid priority",hg=function(t){Bt(e,t);function e(){var r=t.call(this)||this;r.identifier="ChannelControllerPlugin",r.priority=tl;var n;or(e,r,function(s,l){s.setNextPlugin=function(u){},s.processTelemetry=function(u,d){n&&_t(n,function(p){if(p.length>0){var f=r._getTelCtx(d).createNew(p);f.processNext(u)}})},s.getChannelControls=function(){return n},s.initialize=function(u,d,p){s.isInitialized()||(l.initialize(u,d,p),a((u||{}).channels,p),_t(n,function(f){return Sd(new go(f,u,d),p)}))}});function i(s){_t(s,function(l){l.priority<tl&&On(dg+l.identifier)})}c(i,"i");function o(s){s&&s.length>0&&(s=s.sort(function(l,u){return l.priority-u.priority}),i(s),n.push(s))}c(o,"a");function a(s,l){if(n=[],s&&_t(s,function(d){return o(d)}),l){var u=[];_t(l,function(d){d.priority>tl&&u.push(d)}),o(u)}}return c(a,"o"),r}return c(e,"e"),e._staticInit=function(){var r=e.prototype;Yo(r,"ChannelControls",r.getChannelControls),Yo(r,"channelQueue",r.getChannelControls)}(),e}(mo)});function fg(t,e){var r=gs[fi]||vs[fi];return r||(r=gs[fi]=gs(t,e),vs[fi]=r),r}c(fg,"pa");function rl(t){return t?t.isEnabled():!0}c(rl,"ti");function Tb(t){var e=t.cookieCfg=t.cookieCfg||{};if(kt(e,"domain",t.cookieDomain,db,He),kt(e,"path",t.cookiePath||"/",null,He),He(e[ol])){var r=void 0;Or(t[Id])||(r=!t[Id]),Or(t[Dd])||(r=!t[Dd]),e[ol]=r}return e}c(Tb,"Wu");function Ad(t,e){var r;if(t)r=t.getCookieMgr();else if(e){var n=e.cookieCfg;n[fi]?r=n[fi]:r=gs(e)}return r||(r=fg(e,(t||{}).logger)),r}c(Ad,"cr");function gs(t,e){var r=Tb(t||vs),n=r.path||"/",i=r.domain,o=r[ol]!==!1,a={isEnabled:function(){var s=o&&pg(e),l=vs[fi];return s&&l&&a!==l&&(s=rl(l)),s},setEnabled:function(s){o=s!==!1},set:function(s,l,u,d,p){if(rl(a)){var f={},g=Cr(l||nn),x=g.indexOf(";");if(x!==-1&&(g=Cr(l.substring(0,x)),f=gg(l.substring(x+1))),kt(f,"domain",d||i,sd,Or),!He(u)){var y=Vc();if(Or(f[il])){var b=rn(),S=b+u*1e3;if(S>0){var E=new Date;E.setTime(S),kt(f,il,mg(E,y?Td:kd)||mg(E,y?Td:kd)||nn,sd)}}y||kt(f,"max-age",nn+u,null,Or)}var D=fo();D&&D.protocol==="https:"&&(kt(f,"secure",null,null,Or),al===null&&(al=!yg((Ln()||{}).userAgent)),al&&kt(f,"SameSite","None",null,Or)),kt(f,"path",p||n,null,Or);var $=r.setCookie||wg;$(s,vg(g,f))}},get:function(s){var l=nn;return rl(a)&&(l=(r.getCookie||kb)(s)),l},del:function(s,l){rl(a)&&a.purge(s,l)},purge:function(s,l){if(pg(e)){var u=(p={},p.path=l||"/",p[il]="Thu, 01 Jan 1970 00:00:01 GMT",p);Vc()||(u["max-age"]="0");var d=r.delCookie||wg;d(s,vg(nn,u))}var p}};return a[fi]=a,a}c(gs,"ur");function pg(t){if(ms===null){ms=!1;try{var e=na||{};ms=e[nl]!==void 0}catch(r){t&&t.throwInternal(Le.WARNING,Fe.CannotAccessCookie,"Cannot access document.cookie - "+Ft(r),{exception:vt(r)})}}return ms}c(pg,"da");function gg(t){var e={};if(t&&t.length){var r=Cr(t).split(";");_t(r,function(n){if(n=Cr(n||nn),n){var i=n.indexOf("=");i===-1?e[n]=null:e[Cr(n.substring(0,i))]=Cr(n.substring(i+1))}})}return e}c(gg,"Xo");function mg(t,e){return Tt(t[e])?t[e]():null}c(mg,"Yo");function vg(t,e){var r=t||nn;return dr(e,function(n,i){r+="; "+n+(He(i)?nn:"="+i)}),r}c(vg,"$o");function kb(t){var e=nn;if(na){var r=na[nl]||nn;Pd!==r&&(Fd=gg(r),Pd=r),e=Cr(Fd[t]||nn)}return e}c(kb,"Ju");function wg(t,e){na&&(na[nl]=t+"="+e)}c(wg,"Zo");function yg(t){return xt(t)?!!(kr(t,"CPU iPhone OS 12")||kr(t,"iPad; CPU OS 12")||kr(t,"Macintosh; Intel Mac OS X 10_14")&&kr(t,"Version/")&&kr(t,"Safari")||kr(t,"Macintosh; Intel Mac OS X 10_14")&&fb(t,"AppleWebKit/605.1.15 (KHTML, like Gecko)")||kr(t,"Chrome/5")||kr(t,"Chrome/6")||kr(t,"UnrealEngine")&&!kr(t,"Chrome")||kr(t,"UCBrowser/12")||kr(t,"UCBrowser/11")):!1}c(yg,"ri");var Td,kd,nl,il,ol,Id,Dd,fi,nn,ms,al,Pd,na,Fd,vs,$d=Te(()=>{zc(),fs(),Dr(),Td="toGMTString",kd="toUTCString",nl="cookie",il="expires",ol="enabled",Id="isCookieUseDisabled",Dd="disableCookiesUsage",fi="_ckMgr",nn="",ms=null,al=null,Pd=null,na=Un(),Fd={},vs={}}),bg,Nd,Md,xg=Te(()=>{Wt(),yr(),Ab(),xd(),ug(),Jc(),$d(),Dr(),sg(),bg="Extensions must provide callback to initialize",Nd="_notificationManager",Md=function(){function t(){var e=!1,r,n,i,o,a;or(t,this,function(s){s._extensions=new Array,n=new hg,s.logger=Nc({throwInternal:function(l,u,d,p,f){f===void 0&&(f=!1)},warnToConsole:function(l){},resetInternalMessageCount:function(){}}),r=[],s.isInitialized=function(){return e},s.initialize=function(l,u,d,p){s.isInitialized()&&On("Core should not be initialized more than once"),(!l||He(l.instrumentationKey))&&On("Please provide instrumentation key"),i=p,s[Nd]=p,s.config=l||{},l.extensions=He(l.extensions)?[]:l.extensions;var f=Ir(l,_d);f.NotificationManager=p,d&&(s.logger=d);var g=[];g.push.apply(g,u.concat(l.extensions)),g=lg(g);var x=[],y=[],b={};_t(g,function(S){(He(S)||He(S.initialize))&&On(bg);var E=S.priority,D=S.identifier;S&&E&&(He(b[E])?b[E]=D:d.warnToConsole("Two extensions have same priority #"+E+" - "+b[E]+", "+D)),!E||E<n.priority?x.push(S):y.push(S)}),g.push(n),x.push(n),g=lg(g),s._extensions=g,Sd(new go([n],l,s),g),Sd(new go(x,l,s),g),s._extensions=x,s.getTransmissionControls().length===0&&On("No channels available"),e=!0,s.releaseQueue()},s.getTransmissionControls=function(){return n.getChannelControls()},s.track=function(l){kt(l,ag,s.config.instrumentationKey,null,Lp),kt(l,"time",Oi(new Date),null,Lp),kt(l,"ver","4.0",null,He),s.isInitialized()?s.getProcessTelContext().processNext(l):r.push(l)},s.getProcessTelContext=function(){var l=s._extensions,u=l;return(!l||l.length===0)&&(u=[n]),new go(u,s.config,s)},s.getNotifyMgr=function(){return i||(i=Nc({addNotificationListener:function(l){},removeNotificationListener:function(l){},eventsSent:function(l){},eventsDiscarded:function(l,u){},eventsSendRequest:function(l,u){}}),s[Nd]=i),i},s.getCookieMgr=function(){return a||(a=gs(s.config,s.logger)),a},s.setCookieMgr=function(l){a=l},s.getPerfMgr=function(){return o||s.config&&s.config.enablePerfMgr&&(o=new yd(s.getNotifyMgr())),o},s.setPerfMgr=function(l){o=l},s.eventCnt=function(){return r.length},s.releaseQueue=function(){r.length>0&&(_t(r,function(l){s.getProcessTelContext().processNext(l)}),r=[])}})}return c(t,"t"),t}()}),Bd,_g=Te(()=>{yr(),Dr(),Bd=function(){function t(e){this.listeners=[];var r=!!(e||{}).perfEvtsSendAll;or(t,this,function(n){n.addNotificationListener=function(i){n.listeners.push(i)},n.removeNotificationListener=function(i){for(var o=us(n.listeners,i);o>-1;)n.listeners.splice(o,1),o=us(n.listeners,i)},n.eventsSent=function(i){_t(n.listeners,function(o){o&&o.eventsSent&&setTimeout(function(){return o.eventsSent(i)},0)})},n.eventsDiscarded=function(i,o){_t(n.listeners,function(a){a&&a.eventsDiscarded&&setTimeout(function(){return a.eventsDiscarded(i,o)},0)})},n.eventsSendRequest=function(i,o){_t(n.listeners,function(a){if(a&&a.eventsSendRequest)if(o)setTimeout(function(){return a.eventsSendRequest(i,o)},0);else try{a.eventsSendRequest(i,o)}catch(s){}})},n.perfEvent=function(i){i&&(r||!i.isChildEvt())&&_t(n.listeners,function(o){if(o&&o.perfEvent)if(i.isAsync)setTimeout(function(){return o.perfEvent(i)},0);else try{o.perfEvent(i)}catch(a){}})}})}return c(t,"t"),t}()}),Od,Ib=Te(()=>{Wt(),xg(),Jy(),_g(),Jc(),wd(),yr(),Dr(),Od=function(t){Bt(e,t);function e(){var r=t.call(this)||this;return or(e,r,function(n,i){n.initialize=function(s,l,u,d){i.initialize(s,l,u||new vd(s),d||new Bd(s))},n.track=function(s){ta(n.getPerfMgr(),function(){return"AppInsightsCore:track"},function(){s===null&&(a(s),On("Invalid telemetry item")),o(s),i.track(s)},function(){return{item:s}},!s.sync)},n.addNotificationListener=function(s){var l=n.getNotifyMgr();l&&l.addNotificationListener(s)},n.removeNotificationListener=function(s){var l=n.getNotifyMgr();l&&l.removeNotificationListener(s)},n.pollInternalLogs=function(s){var l=n.config.diagnosticLogInterval;return(!l||!(l>0))&&(l=1e4),setInterval(function(){var u=n.logger?n.logger.queue:[];_t(u,function(d){var p={name:s||"InternalMessageId: "+d.messageId,iKey:n.config.instrumentationKey,time:Oi(new Date),baseType:ea.dataType,baseData:{message:d.message}};n.track(p)}),u.length=0},l)};function o(s){if(He(s.name))throw a(s),Error("telemetry name required")}c(o,"a");function a(s){var l=n.getNotifyMgr();l&&l.eventsDiscarded([s],kp.InvalidEvent)}c(a,"o")}),r}return c(e,"e"),e}(Md)});function Sg(t){t<0&&(t>>>=0),ia=123456789+t&pi,oa=987654321-t&pi,Ld=!0}c(Sg,"ns");function Cg(){try{var t=rn()&2147483647;Sg((Math.random()*Ud^t)+t)}catch(e){}}c(Cg,"is");function Eg(t){return t>0?Math.floor(vo()/pi*(t+1))>>>0:0}c(Eg,"ii");function vo(t){var e,r=xb()||_b();return r&&r.getRandomValues?e=r.getRandomValues(new Uint32Array(1))[0]&pi:Vc()?(Ld||Cg(),e=Rg()&pi):e=Math.floor(Ud*Math.random()|0),t||(e>>>=0),e}c(vo,"It");function Db(t){t?Sg(t):Cg()}c(Db,"va");function Rg(t){oa=36969*(oa&65535)+(oa>>16)&pi,ia=18e3*(ia&65535)+(ia>>16)&pi;var e=(oa<<16)+(ia&65535)>>>0&pi|0;return t||(e>>>=0),e}c(Rg,"ai");var Ud,pi,Ld,ia,oa,Ag=Te(()=>{fs(),Dr(),Ud=4294967296,pi=4294967295,Ld=!1,ia=123456789,oa=987654321});function wo(t,e){var r=!1,n=hs();n&&(r=ls(n,t,e),r=ls(n.body,t,e)||r);var i=Un();return i&&(r=ys.Attach(i,t,e)||r),r}c(wo,"Mt");function Pb(){function t(){return Eg(15)}return c(t,"t"),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(kg,function(e){var r=t()|0,n=e==="x"?r:r&3|8;return n.toString(16)})}c(Pb,"as");function Fb(){var t=hi();return t&&t.now?t.now():rn()}c(Fb,"os");function sl(t){t===void 0&&(t=22);for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=vo()>>>0,n=0,i="";i.length<t;)n++,i+=e.charAt(r&63),r>>>=6,n===5&&(r=(vo()<<2&4294967295|r&3)>>>0,n=0);return i}c(sl,"Wt");function Hn(){for(var t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],e="",r,n=0;n<4;n++)r=vo(),e+=t[r&15]+t[r>>4&15]+t[r>>8&15]+t[r>>12&15]+t[r>>16&15]+t[r>>20&15]+t[r>>24&15]+t[r>>28&15];var i=t[8+(vo()&3)|0];return e.substr(0,8)+e.substr(9,4)+"4"+e.substr(13,3)+i+e.substr(16,3)+e.substr(19,12)}c(Hn,"He");function aa(t,e){var r=fg(t,e),n=cl._canUseCookies;return sa===null&&(sa=[],ws=n,Yo(cl,"_canUseCookies",function(){return ws},function(i){ws=i,_t(sa,function(o){o.setEnabled(i)})})),us(sa,r)===-1&&sa.push(r),ad(n)&&r.setEnabled(n),ad(ws)&&r.setEnabled(ws),r}c(aa,"Xt");function Tg(){aa().setEnabled(!1)}c(Tg,"oi");function $b(t){return aa(null,t).isEnabled()}c($b,"xa");function Nb(t,e){return aa(null,t).get(e)}c(Nb,"ya");function Mb(t,e,r,n){aa(null,t).set(e,r,null,n)}c(Mb,"Sa");function Bb(t,e){return aa(null,t).del(e)}c(Bb,"Ca");var sa,ws,cl,kg,ys,Ob=Te(()=>{Wt(),$d(),fs(),Dr(),Ag(),sa=null,cl={_canUseCookies:void 0,isTypeof:ub,isUndefined:Or,isNullOrUndefined:He,hasOwnProperty:nd,isFunction:Tt,isObject:uo,isDate:id,isArray:di,isError:Wc,isString:xt,isNumber:od,isBoolean:ad,toISOString:Oi,arrForEach:_t,arrIndexOf:us,arrMap:ds,arrReduce:Up,strTrim:Cr,objCreate:Nc,objKeys:ho,objDefineAccessors:Yo,addEventHandler:wo,dateNow:rn,isIE:Vc,disableCookies:Tg,newGuid:Pb,perfNow:Fb,newId:sl,randomValue:Eg,random32:vo,mwcRandomSeed:Db,mwcRandom32:Rg,generateW3CId:Hn},kg=/[xy]/g,ys={Attach:ls,AttachEvent:ls,Detach:Op,DetachEvent:Op}});function Hd(t,e){if(t)for(var r=0;r<t.length&&!e(t[r],r);r++);}c(Hd,"Ia");function zd(t,e,r,n,i){i>=0&&i<=2&&Hd(t,function(o,a){var s=o.cbks,l=s[jd[i]];if(l){e.ctx=function(){var p=n[a]=n[a]||{};return p};try{l.apply(e.inst,r)}catch(p){var u=e.err;try{var d=s[jd[2]];d&&(e.err=p,d.apply(e.inst,r))}catch(f){}finally{e.err=u}}}})}c(zd,"Ta");function Ub(t){return function(){var e=this,r=arguments,n=t.h,i={name:t.n,inst:e,ctx:null,set:l},o=[],a=s([i],r);function s(d,p){return Hd(p,function(f){d.push(f)}),d}c(s,"c");function l(d,p){r=s([],r),r[d]=p,a=s([i],r)}c(l,"s"),zd(n,i,a,o,0);var u=t.f;try{i.rslt=u.apply(e,r)}catch(d){throw i.err=d,zd(n,i,a,o,3),d}return zd(n,i,a,o,1),i.rslt}}c(Ub,"Qu");function Lb(t){if(t){if(Vd)return Vd(t);var e=t[Dg]||t[Qr]||t[Pg];if(e)return e}return null}c(Lb,"el");function Ig(t,e,r){var n=null;return t&&(nd(t,e)?n=t:r&&(n=Ig(Lb(t),e,!1))),n}c(Ig,"fs");function Hb(t,e,r){return t?Wd(t[Qr],e,r,!1):null}c(Hb,"Ea");function Wd(t,e,r,n){if(n===void 0&&(n=!0),t&&e&&r){var i=Ig(t,e,n);if(i){var o=i[e];if(typeof o===Go){var a=o[qd];if(!a){a={i:0,n:e,f:o,h:[]};var s=Ub(a);s[qd]=a,i[e]=s}var l={id:a.i,cbks:r,rm:function(){var u=this.id;Hd(a.h,function(d,p){if(d.id===u)return a.h.splice(p,1),1})}};return a.i++,a.h.push(l),l}}}return null}c(Wd,"sn");var qd,jd,Dg,Pg,Vd,zb=Te(()=>{Wt(),Dr(),qd="_aiHooks",jd=["req","rsp","hkErr","fnErr"],Dg="__proto__",Pg="constructor",Vd=Object.getPrototypeOf}),St=Te(()=>{Ib(),xg(),cg(),Ag(),Ob(),Dr(),fs(),Wt(),_g(),Jc(),wd(),zc(),zb(),$d()}),Gt,Fg=Te(()=>{Gt={requestContextHeader:"Request-Context",requestContextTargetKey:"appId",requestContextAppIdFormat:"appId=cid-v1:",requestIdHeader:"Request-Id",traceParentHeader:"traceparent",traceStateHeader:"tracestate",sdkContextHeader:"Sdk-Context",sdkContextHeaderAppIdRequest:"appId",requestContextHeaderLowerCase:"request-context"}});function Gd(t,e,r){var n=e.length,i=$g(t,e);if(i.length!==n){for(var o=0,a=i;r[a]!==void 0;)o++,a=i.substring(0,150-3)+Bg(o);i=a}return i}c(Gd,"si");function $g(t,e){var r;return e&&(e=Cr(e.toString()),e.length>150&&(r=e.substring(0,150),t.throwInternal(Le.WARNING,Fe.NameTooLong,"name is too long.  It has been truncated to "+150+" characters.",{name:e},!0))),r||e}c($g,"Pa");function Ur(t,e,r){r===void 0&&(r=1024);var n;return e&&(r=r||1024,e=Cr(e),e.toString().length>r&&(n=e.toString().substring(0,r),t.throwInternal(Le.WARNING,Fe.StringValueTooLong,"string value is too long. It has been truncated to "+r+" characters.",{value:e},!0))),n||e}c(Ur,"ae");function bs(t,e){return Zd(t,e,2048,Fe.UrlTooLong)}c(bs,"Tt");function Kd(t,e){var r;return e&&e.length>32768&&(r=e.substring(0,32768),t.throwInternal(Le.WARNING,Fe.MessageTruncated,"message is too long, it has been truncated to "+32768+" characters.",{message:e},!0)),r||e}c(Kd,"Ar");function Ng(t,e){var r;if(e){var n=""+e;n.length>32768&&(r=n.substring(0,32768),t.throwInternal(Le.WARNING,Fe.ExceptionTruncated,"exception is too long, it has been truncated to "+32768+" characters.",{exception:e},!0))}return r||e}c(Ng,"ci");function Ui(t,e){if(e){var r={};dr(e,function(n,i){if(uo(i)&&Jo())try{i=xn().stringify(i)}catch(o){t.throwInternal(Le.WARNING,Fe.CannotSerializeObjectNonSerializable,"custom property is not valid",{exception:o},!0)}i=Ur(t,i,8192),n=Gd(t,n,r),r[n]=i}),e=r}return e}c(Ui,"je");function Li(t,e){if(e){var r={};dr(e,function(n,i){n=Gd(t,n,r),r[n]=i}),e=r}return e}c(Li,"ze");function Mg(t,e){return e&&Zd(t,e,128,Fe.IdTooLong).toString()}c(Mg,"ui");function Zd(t,e,r,n){var i;return e&&(e=Cr(e),e.length>r&&(i=e.substring(0,r),t.throwInternal(Le.WARNING,n,"input is too long, it has been truncated to "+r+" characters.",{data:e},!0))),i||e}c(Zd,"li");function Bg(t){var e="00"+t;return e.substr(e.length-3)}c(Bg,"ba");var Og,_n=Te(()=>{St(),Og={MAX_NAME_LENGTH:150,MAX_ID_LENGTH:128,MAX_PROPERTY_LENGTH:8192,MAX_STRING_LENGTH:1024,MAX_URL_LENGTH:2048,MAX_MESSAGE_LENGTH:32768,MAX_EXCEPTION_LENGTH:32768,sanitizeKeyAndAddUniqueness:Gd,sanitizeKey:$g,sanitizeString:Ur,sanitizeUrl:bs,sanitizeMessage:Kd,sanitizeException:Ng,sanitizeProperties:Ui,sanitizeMeasurements:Li,sanitizeId:Mg,sanitizeInput:Zd,padNumber:Bg,trim:Cr}});function ca(t){var e=null;if(Tt(Event))e=new Event(t);else{var r=Un();r&&r.createEvent&&(e=r.createEvent("Event"),e.initEvent(t,!0,!0))}return e}c(ca,"Lt");var Ug=Te(()=>{St()});function Lt(t,e){return e===void 0&&(e=!1),t==null?e:t.toString().toLowerCase()==="true"}c(Lt,"ee");function gi(t){(isNaN(t)||t<0)&&(t=0),t=Math.round(t);var e=""+t%1e3,r=""+Math.floor(t/1e3)%60,n=""+Math.floor(t/(1e3*60))%60,i=""+Math.floor(t/(1e3*60*60))%24,o=Math.floor(t/(1e3*60*60*24));return e=e.length===1?"00"+e:e.length===2?"0"+e:e,r=r.length<2?"0"+r:r,n=n.length<2?"0"+n:n,i=i.length<2?"0"+i:i,(o>0?o+".":"")+i+":"+n+":"+r+"."+e}c(gi,"Ge");function Xd(){var t=Ln();return"sendBeacon"in t&&t.sendBeacon}c(Xd,"Nr");function Lg(t,e){var r=null;return _t(t,function(n){if(n.identifier===e)return r=n,-1}),r}c(Lg,"cn");function Hg(t,e,r,n,i){return!i&&xt(t)&&(t==="Script error."||t==="Script error")}c(Hg,"un");var ll=Te(()=>{St()}),yo,ul,la,dl,Qd,on,Sn=Te(()=>{yo="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",ul="sampleRate",la="ProcessLegacy",dl="http.method",Qd="https://dc.services.visualstudio.com",on="not_specified"}),bo,Cn,zg=Te(()=>{(function(t){t[t.LocalStorage=0]="LocalStorage",t[t.SessionStorage=1]="SessionStorage"})(bo||(bo={})),function(t){t[t.AI=0]="AI",t[t.AI_AND_W3C=1]="AI_AND_W3C",t[t.W3C=2]="W3C"}(Cn||(Cn={}))});function Yd(){return eh()?hl(bo.LocalStorage):null}c(Yd,"Fa");function hl(t){try{if(He(Ko()))return null;var e=new Date,r=Pr(t===bo.LocalStorage?"localStorage":"sessionStorage");r.setItem(e.toString(),e.toString());var n=r.getItem(e.toString())!==e.toString();if(r.removeItem(e.toString()),!n)return r}catch(i){}return null}c(hl,"fi");function Jd(){return ua()?hl(bo.SessionStorage):null}c(Jd,"ka");function Wg(){Hi=!1,zi=!1}c(Wg,"pn");function eh(){return Hi===void 0&&(Hi=!!hl(bo.LocalStorage)),Hi}c(eh,"kr");function qg(t,e){var r=Yd();if(r!==null)try{return r.getItem(e)}catch(n){Hi=!1,t.throwInternal(Le.WARNING,Fe.BrowserCannotReadLocalStorage,"Browser failed read of local storage. "+Ft(n),{exception:vt(n)})}return null}c(qg,"dn");function jg(t,e,r){var n=Yd();if(n!==null)try{return n.setItem(e,r),!0}catch(i){Hi=!1,t.throwInternal(Le.WARNING,Fe.BrowserCannotWriteLocalStorage,"Browser failed write to local storage. "+Ft(i),{exception:vt(i)})}return!1}c(jg,"mn");function Vg(t,e){var r=Yd();if(r!==null)try{return r.removeItem(e),!0}catch(n){Hi=!1,t.throwInternal(Le.WARNING,Fe.BrowserFailedRemovalFromLocalStorage,"Browser failed removal of local storage item. "+Ft(n),{exception:vt(n)})}return!1}c(Vg,"gn");function ua(){return zi===void 0&&(zi=!!hl(bo.SessionStorage)),zi}c(ua,"wt");function Wb(){var t=[];return ua()&&dr(Pr("sessionStorage"),function(e){t.push(e)}),t}c(Wb,"Ra");function fl(t,e){var r=Jd();if(r!==null)try{return r.getItem(e)}catch(n){zi=!1,t.throwInternal(Le.WARNING,Fe.BrowserCannotReadSessionStorage,"Browser failed read of session storage. "+Ft(n),{exception:vt(n)})}return null}c(fl,"$t");function pl(t,e,r){var n=Jd();if(n!==null)try{return n.setItem(e,r),!0}catch(i){zi=!1,t.throwInternal(Le.WARNING,Fe.BrowserCannotWriteSessionStorage,"Browser failed write to session storage. "+Ft(i),{exception:vt(i)})}return!1}c(pl,"Zt");function Gg(t,e){var r=Jd();if(r!==null)try{return r.removeItem(e),!0}catch(n){zi=!1,t.throwInternal(Le.WARNING,Fe.BrowserFailedRemovalFromSessionStorage,"Browser failed removal of session storage item. "+Ft(n),{exception:vt(n)})}return!1}c(Gg,"vn");var Hi,zi,Kg=Te(()=>{St(),zg(),Hi=void 0,zi=void 0});function xs(t){var e=nh,r=Yg,n=r[e];return rh.createElement?r[e]||(n=r[e]=rh.createElement("a")):n={host:Qg(t,!0)},n.href=t,e++,e>=r.length&&(e=0),nh=e,n}c(xs,"dr");function Zg(t){var e,r=xs(t);return r&&(e=r.href),e}c(Zg,"hn");function qb(t){var e,r=xs(t);return r&&(e=r.pathname),e}c(qb,"La");function Xg(t,e){return t?t.toUpperCase()+" "+e:e}c(Xg,"xn");function Qg(t,e){var r=th(t,e)||"";if(r){var n=r.match(/(www[0-9]?\.)?(.[^/:]+)(\:[\d]+)?/i);if(n!=null&&n.length>3&&xt(n[2])&&n[2].length>0)return n[2]+(n[3]||"")}return r}c(Qg,"pi");function th(t,e){var r=null;if(t){var n=t.match(/(\w*):\/\/(.[^/:]+)(\:[\d]+)?/i);if(n!=null&&n.length>2&&xt(n[2])&&n[2].length>0&&(r=n[2]||"",e&&n.length>2)){var i=(n[1]||"").toLowerCase(),o=n[3]||"";(i==="http"&&o===":80"||i==="https"&&o===":443")&&(o=""),r+=o}}return r}c(th,"yn");var rh,nh,Yg,Jg=Te(()=>{St(),rh=Un()||{},nh=0,Yg=[null,null,null,null,null]});function gl(t){return em.indexOf(t.toLowerCase())!==-1}c(gl,"Rr");function jb(t,e,r,n){var i,o=n,a=n;if(e&&e.length>0){var s=xs(e);if(i=s.host,!o)if(s.pathname!=null){var l=s.pathname.length===0?"/":s.pathname;l.charAt(0)!=="/"&&(l="/"+l),a=s.pathname,o=Ur(t,r?r+" "+l:l)}else o=Ur(t,e)}else i=n,o=n;return{target:i,name:o,data:a}}c(jb,"gs");function _s(){var t=hi();if(t&&t.now&&t.timing){var e=t.now()+t.timing.navigationStart;if(e>0)return e}return rn()}c(_s,"mr");function Lr(t,e){var r=null;return t!==0&&e!==0&&!He(t)&&!He(e)&&(r=e-t),r}c(Lr,"ve");var em,ih,tm,Wi,rm,nm=Te(()=>{St(),Fg(),_n(),Ug(),ll(),Sn(),Kg(),Jg(),em=["https://dc.services.visualstudio.com/v2/track","https://breeze.aimon.applicationinsights.io/v2/track","https://dc-int.services.visualstudio.com/v2/track"],ih={NotSpecified:on,createDomEvent:ca,disableStorage:Wg,isInternalApplicationInsightsEndpoint:gl,canUseLocalStorage:eh,getStorage:qg,setStorage:jg,removeStorage:Vg,canUseSessionStorage:ua,getSessionStorageKeys:Wb,getSessionStorage:fl,setSessionStorage:pl,removeSessionStorage:Gg,disableCookies:Tg,canUseCookies:$b,disallowsSameSiteNone:yg,setCookie:Mb,stringToBoolOrDefault:Lt,getCookie:Nb,deleteCookie:Bb,trim:Cr,newId:sl,random32:function(){return vo(!0)},generateW3CId:Hn,isArray:di,isError:Wc,isDate:id,toISOStringForIE8:Oi,getIEVersion:pd,msToTimeSpan:gi,isCrossOriginError:Hg,dump:vt,getExceptionName:Ft,addEventHandler:ls,IsBeaconApiSupported:Xd,getExtension:Lg},tm={parseUrl:xs,getAbsoluteUrl:Zg,getPathName:qb,getCompleteUrl:Xg,parseHost:Qg,parseFullHost:th},Wi={correlationIdPrefix:"cid-v1:",canIncludeCorrelationHeader:function(t,e,r){if(!e||t&&t.disableCorrelationHeaders)return!1;if(t&&t.correlationHeaderExcludePatterns){for(var n=0;n<t.correlationHeaderExcludePatterns.length;n++)if(t.correlationHeaderExcludePatterns[n].test(e))return!1}var i=xs(e).host.toLowerCase();if(i&&(i.indexOf(":443")!==-1||i.indexOf(":80")!==-1)&&(i=(th(e,!0)||"").toLowerCase()),(!t||!t.enableCorsCorrelation)&&i&&i!==r)return!1;var o=t&&t.correlationHeaderDomains;if(o){var a;if(_t(o,function(u){var d=new RegExp(u.toLowerCase().replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*"));a=a||d.test(i)}),!a)return!1}var s=t&&t.correlationHeaderExcludedDomains;if(!s||s.length===0)return!0;for(var n=0;n<s.length;n++){var l=new RegExp(s[n].toLowerCase().replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*"));if(l.test(i))return!1}return i&&i.length>0},getCorrelationContext:function(t){if(t){var e=Wi.getCorrelationContextValue(t,Gt.requestContextTargetKey);if(e&&e!==Wi.correlationIdPrefix)return e}},getCorrelationContextValue:function(t,e){if(t)for(var r=t.split(","),n=0;n<r.length;++n){var i=r[n].split("=");if(i.length===2&&i[0]===e)return i[1]}}},rm={Now:_s,GetDuration:Lr}});function im(t){if(!t)return{};var e=t.split(om),r=Up(e,function(i,o){var a=o.split(am);if(a.length===2){var s=a[0].toLowerCase(),l=a[1];i[s]=l}return i},{});if(ho(r).length>0){if(r.endpointsuffix){var n=r.location?r.location+".":"";r.ingestionendpoint=r.ingestionendpoint||"https://"+n+"dc."+r.endpointsuffix}r.ingestionendpoint=r.ingestionendpoint||Qd}return r}c(im,"di");var om,am,sm,Vb=Te(()=>{Sn(),St(),om=";",am="=",sm={parse:im}}),oh,cm=Te(()=>{oh=function(){function t(){}return c(t,"t"),t}()}),ah,lm=Te(()=>{Wt(),cm(),ah=function(t){Bt(e,t);function e(){return t.call(this)||this}return c(e,"e"),e}(oh)}),um,Gb=Te(()=>{um=function(){function t(){this.ver=1,this.sampleRate=100,this.tags={}}return c(t,"t"),t}()}),sh,Kb=Te(()=>{Wt(),Gb(),_n(),St(),Sn(),sh=function(t){Bt(e,t);function e(r,n,i){var o=t.call(this)||this;return o.name=Ur(r,i)||on,o.data=n,o.time=Oi(new Date),o.aiDataContract={time:1,iKey:1,name:1,sampleRate:function(){return o.sampleRate===100?4:1},tags:1,data:1},o}return c(e,"e"),e}(um)}),ch,dm=Te(()=>{ch=function(){function t(){this.ver=2,this.properties={},this.measurements={}}return c(t,"t"),t}()}),En,Zb=Te(()=>{Wt(),dm(),_n(),Sn(),En=function(t){Bt(e,t);function e(r,n,i,o){var a=t.call(this)||this;return a.aiDataContract={ver:1,name:1,properties:0,measurements:0},a.name=Ur(r,n)||on,a.properties=Ui(r,i),a.measurements=Li(r,o),a}return c(e,"e"),e.envelopeType="Microsoft.ApplicationInsights.{0}.Event",e.dataType="EventData",e}(ch)}),hm,Xb=Te(()=>{hm=function(){function t(){}return c(t,"t"),t}()}),fm,Qb=Te(()=>{fm=function(){function t(){this.ver=2,this.exceptions=[],this.properties={},this.measurements={}}return c(t,"t"),t}()}),pm,Yb=Te(()=>{pm=function(){function t(){this.hasFullStack=!0,this.parsedStack=[]}return c(t,"t"),t}()});function lh(t,e){var r=t;return r&&!xt(r)&&(JSON&&JSON.stringify?(r=JSON.stringify(t),e&&(!r||r==="{}")&&(Tt(t.toString)?r=t.toString():r=""+t)):r=""+t+" - (Missing JSON.stringify)"),r||""}c(lh,"Ka");function gm(t,e){var r=t;return t&&(r=t[wl]||t[hh]||"",r&&!xt(r)&&(r=lh(r,!0)),t.filename&&(r=r+" @"+(t.filename||"")+":"+(t.lineno||"?")+":"+(t.colno||"?"))),e&&e!=="String"&&e!=="Object"&&e!=="Error"&&(r||"").indexOf(e)===-1&&(r=e+": "+r),r||""}c(gm,"As");function Jb(t){return uo(t)?"hasFullStack"in t&&"typeName"in t:!1}c(Jb,"ol");function ex(t){return uo(t)?"ver"in t&&"exceptions"in t&&"properties"in t:!1}c(ex,"sl");function mm(t){return t&&t.src&&xt(t.src)&&t.obj&&di(t.obj)}c(mm,"Ns");function da(t){var e=t||"";xt(e)||(xt(e[Yr])?e=e[Yr]:e=""+e);var r=e.split(`
`);return{src:e,obj:r}}c(da,"Lr");function tx(t){for(var e=[],r=t.split(`
`),n=0;n<r.length;n++){var i=r[n];r[n+1]&&(i+="@"+r[n+1],n++),e.push(i)}return{src:t,obj:e}}c(tx,"cl");function vm(t){var e=null;if(t)try{if(t[Yr])e=da(t[Yr]);else if(t[xo]&&t[xo][Yr])e=da(t[xo][Yr]);else if(t.exception&&t.exception[Yr])e=da(t.exception[Yr]);else if(mm(t))e=t;else if(mm(t[vl]))e=t[vl];else if(window.opera&&t[wl])e=tx(t.message);else if(xt(t))e=da(t);else{var r=t[wl]||t[hh]||"";xt(t[dh])&&(r&&(r+=`
`),r+=" from "+t[dh]),r&&(e=da(r))}}catch(n){e=da(n)}return e||{src:"",obj:null}}c(vm,"Fs");function rx(t){var e="";return t&&(t.obj?_t(t.obj,function(r){e+=r+`
`}):e=t.src||""),e}c(rx,"ul");function nx(t){var e,r=t.obj;if(r&&r.length>0){e=[];var n=0,i=0;_t(r,function(x){var y=x.toString();if(yl.regex.test(y)){var b=new yl(y,n++);i+=b.sizeInBytes,e.push(b)}});var o=32*1024;if(i>o)for(var a=0,s=e.length-1,l=0,u=a,d=s;a<s;){var p=e[a].sizeInBytes,f=e[s].sizeInBytes;if(l+=p+f,l>o){var g=d-u+1;e.splice(u,g);break}u=a,d=s,a++,s--}}return e}c(nx,"ll");function ml(t){var e="";if(t&&(e=t.typeName||t.name||"",!e))try{var r=/function (.{1,200})\(/,n=r.exec(t.constructor.toString());e=n&&n.length>1?n[1]:""}catch(i){}return e}c(ml,"gi");function uh(t){if(t)try{if(!xt(t)){var e=ml(t),r=lh(t,!1);return(!r||r==="{}")&&(t[xo]&&(t=t[xo],e=ml(t)),r=lh(t,!0)),r.indexOf(e)!==0&&e!=="String"?e+":"+r:r}}catch(n){}return""+(t||"")}c(uh,"Wa");var wm,xo,Yr,vl,dh,wl,hh,Hr,fh,yl,ix=Te(()=>{Wt(),Xb(),Qb(),Yb(),_n(),St(),Sn(),wm="<no_method>",xo="error",Yr="stack",vl="stackDetails",dh="errorSrc",wl="message",hh="description",Hr=function(t){Bt(e,t);function e(r,n,i,o,a,s){var l=t.call(this)||this;return l.aiDataContract={ver:1,exceptions:1,severityLevel:0,properties:0,measurements:0},ex(n)?(l.exceptions=n.exceptions,l.properties=n.properties,l.measurements=n.measurements,n.severityLevel&&(l.severityLevel=n.severityLevel),n.id&&(l.id=n.id),n.problemGroup&&(l.problemGroup=n.problemGroup),l.ver=2,He(n.isManual)||(l.isManual=n.isManual)):(i||(i={}),l.exceptions=[new fh(r,n,i)],l.properties=Ui(r,i),l.measurements=Li(r,o),a&&(l.severityLevel=a),s&&(l.id=s)),l}return c(e,"e"),e.CreateAutoException=function(r,n,i,o,a,s,l,u){var d=ml(a||s||r);return{message:gm(r,d),url:n,lineNumber:i,columnNumber:o,error:uh(a||s||r),evt:uh(s||r),typeName:d,stackDetails:vm(l||a||s),errorSrc:u}},e.CreateFromInterface=function(r,n,i,o){var a=n.exceptions&&ds(n.exceptions,function(l){return fh.CreateFromInterface(r,l)}),s=new e(r,Zo({},n,{exceptions:a}),i,o);return s},e.prototype.toInterface=function(){var r=this,n=r.exceptions,i=r.properties,o=r.measurements,a=r.severityLevel,s=r.ver,l=r.problemGroup,u=r.id,d=r.isManual,p=n instanceof Array&&ds(n,function(f){return f.toInterface()})||void 0;return{ver:"4.0",exceptions:p,severityLevel:a,properties:i,measurements:o,problemGroup:l,id:u,isManual:d}},e.CreateSimpleException=function(r,n,i,o,a,s){return{exceptions:[{hasFullStack:!0,message:r,stack:a,typeName:n}]}},e.envelopeType="Microsoft.ApplicationInsights.{0}.Exception",e.dataType="ExceptionData",e.formatError=uh,e}(fm),fh=function(t){Bt(e,t);function e(r,n,i){var o=t.call(this)||this;if(o.aiDataContract={id:0,outerId:0,typeName:1,message:1,hasFullStack:0,stack:0,parsedStack:2},Jb(n))o.typeName=n.typeName,o.message=n.message,o[Yr]=n[Yr],o.parsedStack=n.parsedStack,o.hasFullStack=n.hasFullStack;else{var a=n,s=a&&a.evt;Wc(a)||(a=a[xo]||s||a),o.typeName=Ur(r,ml(a))||on,o.message=Kd(r,gm(n||a,o.typeName))||on;var l=n[vl]||vm(n);o.parsedStack=nx(l),o[Yr]=Ng(r,rx(l)),o.hasFullStack=di(o.parsedStack)&&o.parsedStack.length>0,i&&(i.typeName=i.typeName||o.typeName)}return o}return c(e,"e"),e.prototype.toInterface=function(){var r=this.parsedStack instanceof Array&&ds(this.parsedStack,function(i){return i.toInterface()}),n={id:this.id,outerId:this.outerId,typeName:this.typeName,message:this.message,hasFullStack:this.hasFullStack,stack:this[Yr],parsedStack:r||void 0};return n},e.CreateFromInterface=function(r,n){var i=n.parsedStack instanceof Array&&ds(n.parsedStack,function(a){return yl.CreateFromInterface(a)})||n.parsedStack,o=new e(r,Zo({},n,{parsedStack:i}));return o},e}(pm),yl=function(t){Bt(e,t);function e(r,n){var i=t.call(this)||this;if(i.sizeInBytes=0,i.aiDataContract={level:1,method:1,assembly:0,fileName:0,line:0},typeof r=="string"){var o=r;i.level=n,i.method=wm,i.assembly=Cr(o),i.fileName="",i.line=0;var a=o.match(e.regex);a&&a.length>=5&&(i.method=Cr(a[2])||i.method,i.fileName=Cr(a[4]),i.line=parseInt(a[5])||0)}else i.level=r.level,i.method=r.method,i.assembly=r.assembly,i.fileName=r.fileName,i.line=r.line,i.sizeInBytes=0;return i.sizeInBytes+=i.method.length,i.sizeInBytes+=i.fileName.length,i.sizeInBytes+=i.assembly.length,i.sizeInBytes+=e.baseSize,i.sizeInBytes+=i.level.toString().length,i.sizeInBytes+=i.line.toString().length,i}return c(e,"e"),e.CreateFromInterface=function(r){return new e(r,null)},e.prototype.toInterface=function(){return{level:this.level,method:this.method,assembly:this.assembly,fileName:this.fileName,line:this.line}},e.regex=/^([\s]+at)?[\s]{0,50}([^\@\()]+?)[\s]{0,50}(\@|\()([^\(\n]+):([0-9]+):([0-9]+)(\)?)$/,e.baseSize=58,e}(hm)}),ym,ox=Te(()=>{ym=function(){function t(){this.ver=2,this.metrics=[],this.properties={},this.measurements={}}return c(t,"t"),t}()}),ph,ax=Te(()=>{(function(t){t[t.Measurement=0]="Measurement",t[t.Aggregation=1]="Aggregation"})(ph||(ph={}))}),bm,sx=Te(()=>{ax(),bm=function(){function t(){this.kind=ph.Measurement}return c(t,"t"),t}()}),xm,cx=Te(()=>{Wt(),sx(),xm=function(t){Bt(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.aiDataContract={name:1,kind:0,value:1,count:0,min:0,max:0,stdDev:0},r}return c(e,"e"),e}(bm)}),zn,lx=Te(()=>{Wt(),ox(),_n(),cx(),Sn(),zn=function(t){Bt(e,t);function e(r,n,i,o,a,s,l,u){var d=t.call(this)||this;d.aiDataContract={ver:1,metrics:1,properties:0};var p=new xm;return p.count=o>0?o:void 0,p.max=isNaN(s)||s===null?void 0:s,p.min=isNaN(a)||a===null?void 0:a,p.name=Ur(r,n)||on,p.value=i,d.metrics=[p],d.properties=Ui(r,l),d.measurements=Li(r,u),d}return c(e,"e"),e.envelopeType="Microsoft.ApplicationInsights.{0}.Metric",e.dataType="MetricData",e}(ym)}),bl,gh=Te(()=>{Wt(),dm(),bl=function(t){Bt(e,t);function e(){var r=t.call(this)||this;return r.ver=2,r.properties={},r.measurements={},r}return c(e,"e"),e}(ch)}),Rn,ux=Te(()=>{Wt(),gh(),_n(),ll(),Sn(),Rn=function(t){Bt(e,t);function e(r,n,i,o,a,s,l){var u=t.call(this)||this;return u.aiDataContract={ver:1,name:0,url:0,duration:0,properties:0,measurements:0,id:0},u.id=Mg(r,l),u.url=bs(r,i),u.name=Ur(r,n)||on,isNaN(o)||(u.duration=gi(o)),u.properties=Ui(r,a),u.measurements=Li(r,s),u}return c(e,"e"),e.envelopeType="Microsoft.ApplicationInsights.{0}.Pageview",e.dataType="PageviewData",e}(bl)}),_m,dx=Te(()=>{_m=function(){function t(){this.ver=2,this.success=!0,this.properties={},this.measurements={}}return c(t,"t"),t}()}),Wn,hx=Te(()=>{Wt(),_n(),nm(),dx(),ll(),Wn=function(t){Bt(e,t);function e(r,n,i,o,a,s,l,u,d,p,f,g){d===void 0&&(d="Ajax");var x=t.call(this)||this;x.aiDataContract={id:1,ver:1,name:0,resultCode:0,duration:0,success:0,data:0,target:0,type:0,properties:0,measurements:0,kind:0,value:0,count:0,min:0,max:0,stdDev:0,dependencyKind:0,dependencySource:0,commandName:0,dependencyTypeName:0},x.id=n,x.duration=gi(a),x.success=s,x.resultCode=l+"",x.type=Ur(r,d);var y=jb(r,i,u,o);return x.data=bs(r,o)||y.data,x.target=Ur(r,y.target),p&&(x.target=x.target+" | "+p),x.name=Ur(r,y.name),x.properties=Ui(r,f),x.measurements=Li(r,g),x}return c(e,"e"),e.envelopeType="Microsoft.ApplicationInsights.{0}.RemoteDependency",e.dataType="RemoteDependencyData",e}(_m)}),Sm,fx=Te(()=>{Sm=function(){function t(){this.ver=2,this.properties={},this.measurements={}}return c(t,"t"),t}()}),mi,px=Te(()=>{Wt(),fx(),_n(),Sn(),mi=function(t){Bt(e,t);function e(r,n,i,o,a){var s=t.call(this)||this;return s.aiDataContract={ver:1,message:1,severityLevel:0,properties:0},n=n||on,s.message=Kd(r,n),s.properties=Ui(r,o),s.measurements=Li(r,a),i&&(s.severityLevel=i),s}return c(e,"e"),e.envelopeType="Microsoft.ApplicationInsights.{0}.Message",e.dataType="MessageData",e}(Sm)}),Cm,gx=Te(()=>{Wt(),gh(),Cm=function(t){Bt(e,t);function e(){var r=t.call(this)||this;return r.ver=2,r.properties={},r.measurements={},r}return c(e,"e"),e}(bl)}),vi,mx=Te(()=>{Wt(),gx(),_n(),Sn(),vi=function(t){Bt(e,t);function e(r,n,i,o,a,s,l){var u=t.call(this)||this;return u.aiDataContract={ver:1,name:0,url:0,duration:0,perfTotal:0,networkConnect:0,sentRequest:0,receivedResponse:0,domProcessing:0,properties:0,measurements:0},u.url=bs(r,i),u.name=Ur(r,n)||on,u.properties=Ui(r,a),u.measurements=Li(r,s),l&&(u.domProcessing=l.domProcessing,u.duration=l.duration,u.networkConnect=l.networkConnect,u.perfTotal=l.perfTotal,u.receivedResponse=l.receivedResponse,u.sentRequest=l.sentRequest),u}return c(e,"e"),e.envelopeType="Microsoft.ApplicationInsights.{0}.PageviewPerformance",e.dataType="PageviewPerformanceData",e}(Cm)}),wi,vx=Te(()=>{Wt(),lm(),wi=function(t){Bt(e,t);function e(r,n){var i=t.call(this)||this;return i.aiDataContract={baseType:1,baseData:1},i.baseType=r,i.baseData=n,i}return c(e,"e"),e}(ah)}),Ss,wx=Te(()=>{(function(t){t[t.Verbose=0]="Verbose",t[t.Information=1]="Information",t[t.Warning=2]="Warning",t[t.Error=3]="Error",t[t.Critical=4]="Critical"})(Ss||(Ss={}))}),Em,yx=Te(()=>{St(),Em=function(){function t(){}return c(t,"t"),t.getConfig=function(e,r,n,i){i===void 0&&(i=!1);var o;return n&&e.extensionConfig&&e.extensionConfig[n]&&!He(e.extensionConfig[n][r])?o=e.extensionConfig[n][r]:o=e[r],He(o)?i:o},t}()});function qi(t){var e="ai."+t+".";return function(r){return e+r}}c(qi,"Qt");var ha,ar,Cs,_o,xl,yi,ji,fa,_l,Rm=Te(()=>{Wt(),St(),ha=qi("application"),ar=qi("device"),Cs=qi("location"),_o=qi("operation"),xl=qi("session"),yi=qi("user"),ji=qi("cloud"),fa=qi("internal"),_l=function(t){Bt(e,t);function e(){return t.call(this)||this}return c(e,"e"),e}(pb({applicationVersion:ha("ver"),applicationBuild:ha("build"),applicationTypeId:ha("typeId"),applicationId:ha("applicationId"),applicationLayer:ha("layer"),deviceId:ar("id"),deviceIp:ar("ip"),deviceLanguage:ar("language"),deviceLocale:ar("locale"),deviceModel:ar("model"),deviceFriendlyName:ar("friendlyName"),deviceNetwork:ar("network"),deviceNetworkName:ar("networkName"),deviceOEMName:ar("oemName"),deviceOS:ar("os"),deviceOSVersion:ar("osVersion"),deviceRoleInstance:ar("roleInstance"),deviceRoleName:ar("roleName"),deviceScreenResolution:ar("screenResolution"),deviceType:ar("type"),deviceMachineName:ar("machineName"),deviceVMName:ar("vmName"),deviceBrowser:ar("browser"),deviceBrowserVersion:ar("browserVersion"),locationIp:Cs("ip"),locationCountry:Cs("country"),locationProvince:Cs("province"),locationCity:Cs("city"),operationId:_o("id"),operationName:_o("name"),operationParentId:_o("parentId"),operationRootId:_o("rootId"),operationSyntheticSource:_o("syntheticSource"),operationCorrelationVector:_o("correlationVector"),sessionId:xl("id"),sessionIsFirst:xl("isFirst"),sessionIsNew:xl("isNew"),userAccountAcquisitionDate:yi("accountAcquisitionDate"),userAccountId:yi("accountId"),userAgent:yi("userAgent"),userId:yi("id"),userStoreRegion:yi("storeRegion"),userAuthUserId:yi("authUserId"),userAnonymousUserAcquisitionDate:yi("anonUserAcquisitionDate"),userAuthenticatedUserAcquisitionDate:yi("authUserAcquisitionDate"),cloudName:ji("name"),cloudRole:ji("role"),cloudRoleVer:ji("roleVer"),cloudRoleInstance:ji("roleInstance"),cloudEnvironment:ji("environment"),cloudLocation:ji("location"),cloudDeploymentUnit:ji("deploymentUnit"),internalNodeName:fa("nodeName"),internalSdkVersion:fa("sdkVersion"),internalAgentVersion:fa("agentVersion"),internalSnippet:fa("snippet"),internalSdkSrc:fa("sdkSrc")}))}),qn,bx=Te(()=>{_n(),St(),Sn(),qn=function(){function t(){}return c(t,"t"),t.create=function(e,r,n,i,o,a){if(n=Ur(i,n)||on,He(e)||He(r)||He(n))throw Error("Input doesn't contain all required fields");var s={name:n,time:Oi(new Date),iKey:"",ext:a||{},tags:[],data:{},baseType:r,baseData:e};return He(o)||dr(o,function(l,u){s.data[l]=u}),s},t}()}),zr,qt,xx=Te(()=>{Rm(),zr={UserExt:"user",DeviceExt:"device",TraceExt:"trace",WebExt:"web",AppExt:"app",OSExt:"os",SessionExt:"ses",SDKExt:"sdk"},qt=new _l}),pa,Sl,mh,hr=Te(()=>{nm(),Vb(),Fg(),Sn(),lm(),cm(),Kb(),Zb(),ix(),lx(),ux(),gh(),hx(),px(),mx(),vx(),wx(),yx(),Rm(),_n(),bx(),xx(),zg(),ll(),Ug(),Kg(),Jg(),pa="AppInsightsPropertiesPlugin",Sl="AppInsightsChannelPlugin",mh="ApplicationInsightsAnalytics"}),Am,_x=Te(()=>{hr(),St(),yr(),Am=function(){function t(e,r,n,i){or(t,this,function(o){var a=null,s=[],l=!1,u;n&&(u=n.logger);function d(){n&&_t(n.getTransmissionControls(),function(f){_t(f,function(g){return g.flush(!0)})})}c(d,"l");function p(f){s.push(f),a||(a=setInterval(function(){var g=s.slice(0),x=!1;s=[],_t(g,function(y){y()?x=!0:s.push(y)}),s.length===0&&(clearInterval(a),a=null),x&&d()},100))}c(p,"f"),o.trackPageView=function(f,g){var x=f.name;if(He(x)||typeof x!="string"){var y=Un();x=f.name=y&&y.title||""}var b=f.uri;if(He(b)||typeof b!="string"){var S=fo();b=f.uri=S&&S.href||""}if(!i.isPerformanceTimingSupported()){e.sendPageViewInternal(f,g),d(),u.throwInternal(Le.WARNING,Fe.NavigationTimingNotSupported,"trackPageView: navigation timing API used for calculation of page duration is not supported in this browser. This page view will be collected without duration and timing info.");return}var E=!1,D,$=i.getPerformanceTiming().navigationStart;$>0&&(D=Lr($,+new Date),i.shouldCollectDuration(D)||(D=void 0));var z;!He(g)&&!He(g.duration)&&(z=g.duration),(r||!isNaN(z))&&(isNaN(z)&&(g||(g={}),g.duration=D),e.sendPageViewInternal(f,g),d(),E=!0);var re=6e4;g||(g={}),p(function(){var ne=!1;try{if(i.isPerformanceTimingDataReady()){ne=!0;var ee={name:x,uri:b};i.populatePageViewPerformanceEvent(ee),!ee.isValid&&!E?(g.duration=D,e.sendPageViewInternal(f,g)):(E||(g.duration=ee.durationMs,e.sendPageViewInternal(f,g)),l||(e.sendPageViewPerformanceInternal(ee,g),l=!0))}else $>0&&Lr($,+new Date)>re&&(ne=!0,E||(g.duration=re,e.sendPageViewInternal(f,g)))}catch(we){u.throwInternal(Le.CRITICAL,Fe.TrackPVFailedCalc,"trackPageView failed on page load calculation: "+Ft(we),{exception:vt(we)})}return ne})}})}return c(t,"t"),t}()}),Tm,km,Sx=Te(()=>{hr(),St(),Tm=function(){function t(e,r){this.prevPageVisitDataKeyName="prevPageVisitData",this.pageVisitTimeTrackingHandler=r,this._logger=e}return c(t,"t"),t.prototype.trackPreviousPageVisit=function(e,r){try{var n=this.restartPageVisitTimer(e,r);n&&this.pageVisitTimeTrackingHandler(n.pageName,n.pageUrl,n.pageVisitTime)}catch(i){this._logger.warnToConsole("Auto track page visit time failed, metric will not be collected: "+vt(i))}},t.prototype.restartPageVisitTimer=function(e,r){try{var n=this.stopPageVisitTimer();return this.startPageVisitTimer(e,r),n}catch(i){return this._logger.warnToConsole("Call to restart failed: "+vt(i)),null}},t.prototype.startPageVisitTimer=function(e,r){try{if(ua()){fl(this._logger,this.prevPageVisitDataKeyName)!=null&&On("Cannot call startPageVisit consecutively without first calling stopPageVisit");var n=new km(e,r),i=xn().stringify(n);pl(this._logger,this.prevPageVisitDataKeyName,i)}}catch(o){this._logger.warnToConsole("Call to start failed: "+vt(o))}},t.prototype.stopPageVisitTimer=function(){try{if(ua()){var e=rn(),r=fl(this._logger,this.prevPageVisitDataKeyName);if(r&&Jo()){var n=xn().parse(r);return n.pageVisitTime=e-n.pageVisitStartTime,Gg(this._logger,this.prevPageVisitDataKeyName),n}else return null}return null}catch(i){return this._logger.warnToConsole("Stop page visit timer failed: "+vt(i)),null}},t}(),km=function(){function t(e,r){this.pageVisitStartTime=rn(),this.pageName=e,this.pageUrl=r}return c(t,"t"),t}()}),Im,Cx=Te(()=>{hr(),St(),Im=function(){function t(e){this.MAX_DURATION_ALLOWED=36e5,e&&(this._logger=e.logger)}return c(t,"t"),t.prototype.populatePageViewPerformanceEvent=function(e){e.isValid=!1;var r=this.getPerformanceNavigationTiming(),n=this.getPerformanceTiming(),i=0,o=0,a=0,s=0,l=0;(r||n)&&(r?(i=r.duration,o=r.startTime===0?r.connectEnd:Lr(r.startTime,r.connectEnd),a=Lr(r.requestStart,r.responseStart),s=Lr(r.responseStart,r.responseEnd),l=Lr(r.responseEnd,r.loadEventEnd)):(i=Lr(n.navigationStart,n.loadEventEnd),o=Lr(n.navigationStart,n.connectEnd),a=Lr(n.requestStart,n.responseStart),s=Lr(n.responseStart,n.responseEnd),l=Lr(n.responseEnd,n.loadEventEnd)),i===0?this._logger.throwInternal(Le.WARNING,Fe.ErrorPVCalc,"error calculating page view performance.",{total:i,network:o,request:a,response:s,dom:l}):this.shouldCollectDuration(i,o,a,s,l)?i<Math.floor(o)+Math.floor(a)+Math.floor(s)+Math.floor(l)?this._logger.throwInternal(Le.WARNING,Fe.ClientPerformanceMathError,"client performance math error.",{total:i,network:o,request:a,response:s,dom:l}):(e.durationMs=i,e.perfTotal=e.duration=gi(i),e.networkConnect=gi(o),e.sentRequest=gi(a),e.receivedResponse=gi(s),e.domProcessing=gi(l),e.isValid=!0):this._logger.throwInternal(Le.WARNING,Fe.InvalidDurationValue,"Invalid page load duration value. Browser perf data won't be sent.",{total:i,network:o,request:a,response:s,dom:l}))},t.prototype.getPerformanceTiming=function(){return this.isPerformanceTimingSupported()?hi().timing:null},t.prototype.getPerformanceNavigationTiming=function(){return this.isPerformanceNavigationTimingSupported()?hi().getEntriesByType("navigation")[0]:null},t.prototype.isPerformanceNavigationTimingSupported=function(){var e=hi();return e&&e.getEntriesByType&&e.getEntriesByType("navigation").length>0},t.prototype.isPerformanceTimingSupported=function(){var e=hi();return e&&e.timing},t.prototype.isPerformanceTimingDataReady=function(){var e=hi(),r=e?e.timing:0;return r&&r.domainLookupStart>0&&r.navigationStart>0&&r.responseStart>0&&r.requestStart>0&&r.loadEventEnd>0&&r.responseEnd>0&&r.connectEnd>0&&r.domLoading>0},t.prototype.shouldCollectDuration=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=Ln()||{},i=["googlebot","adsbot-google","apis-google","mediapartners-google"],o=n.userAgent,a=!1;if(o)for(var s=0;s<i.length;s++)a=a||o.toLowerCase().indexOf(i[s])!==-1;if(a)return!1;for(var s=0;s<e.length;s++)if(e[s]<0||e[s]>=this.MAX_DURATION_ALLOWED)return!1;return!0},t}()});function Es(t,e){t&&t.dispatchEvent&&e&&t.dispatchEvent(e)}c(Es,"Pn");var vh,Cl,wh,yh,Ex=Te(()=>{Wt(),hr(),St(),_x(),Sx(),Cx(),yr(),vh="duration",Cl="event",wh=function(t){Bt(e,t);function e(){var r=t.call(this)||this;r.identifier=mh,r.priority=180,r.autoRoutePVDelay=500;var n,i,o,a=0,s,l;return or(e,r,function(u,d){var p=fo(!0);s=p&&p.href||"",u.getCookieMgr=function(){return Ad(u.core)},u.processTelemetry=function(b,S){ta(u.core,function(){return u.identifier+":processTelemetry"},function(){var E=!1,D=u._telemetryInitializers.length;S=u._getTelCtx(S);for(var $=0;$<D;++$){var z=u._telemetryInitializers[$];if(z)try{if(z.apply(null,[b])===!1){E=!0;break}}catch(re){S.diagLog().throwInternal(Le.CRITICAL,Fe.TelemetryInitializerFailed,"One of telemetry initializers failed, telemetry item will not be sent: "+Ft(re),{exception:vt(re)},!0)}}E||u.processNext(b,S)},function(){return{item:b}},!b.sync)},u.trackEvent=function(b,S){try{var E=qn.create(b,En.dataType,En.envelopeType,u.diagLog(),S);u.core.track(E)}catch(D){u.diagLog().throwInternal(Le.WARNING,Fe.TrackTraceFailed,"trackTrace failed, trace will not be collected: "+Ft(D),{exception:vt(D)})}},u.startTrackEvent=function(b){try{n.start(b)}catch(S){u.diagLog().throwInternal(Le.CRITICAL,Fe.StartTrackEventFailed,"startTrackEvent failed, event will not be collected: "+Ft(S),{exception:vt(S)})}},u.stopTrackEvent=function(b,S,E){try{n.stop(b,void 0,S)}catch(D){u.diagLog().throwInternal(Le.CRITICAL,Fe.StopTrackEventFailed,"stopTrackEvent failed, event will not be collected: "+Ft(D),{exception:vt(D)})}},u.trackTrace=function(b,S){try{var E=qn.create(b,mi.dataType,mi.envelopeType,u.diagLog(),S);u.core.track(E)}catch(D){u.diagLog().throwInternal(Le.WARNING,Fe.TrackTraceFailed,"trackTrace failed, trace will not be collected: "+Ft(D),{exception:vt(D)})}},u.trackMetric=function(b,S){try{var E=qn.create(b,zn.dataType,zn.envelopeType,u.diagLog(),S);u.core.track(E)}catch(D){u.diagLog().throwInternal(Le.CRITICAL,Fe.TrackMetricFailed,"trackMetric failed, metric will not be collected: "+Ft(D),{exception:vt(D)})}},u.trackPageView=function(b,S){try{var E=b||{};u._pageViewManager.trackPageView(E,Zo({},E.properties,E.measurements,S)),u.config.autoTrackPageVisitTime&&u._pageVisitTimeManager.trackPreviousPageVisit(E.name,E.uri)}catch(D){u.diagLog().throwInternal(Le.CRITICAL,Fe.TrackPVFailed,"trackPageView failed, page view will not be collected: "+Ft(D),{exception:vt(D)})}},u.sendPageViewInternal=function(b,S,E){var D=Un();D&&(b.refUri=b.refUri===void 0?D.referrer:b.refUri);var $=qn.create(b,Rn.dataType,Rn.envelopeType,u.diagLog(),S,E);u.core.track($),a=0},u.sendPageViewPerformanceInternal=function(b,S,E){var D=qn.create(b,vi.dataType,vi.envelopeType,u.diagLog(),S,E);u.core.track(D)},u.trackPageViewPerformance=function(b,S){try{u._pageViewPerformanceManager.populatePageViewPerformanceEvent(b),u.sendPageViewPerformanceInternal(b,S)}catch(E){u.diagLog().throwInternal(Le.CRITICAL,Fe.TrackPVFailed,"trackPageViewPerformance failed, page view will not be collected: "+Ft(E),{exception:vt(E)})}},u.startTrackPage=function(b){try{if(typeof b!="string"){var S=Un();b=S&&S.title||""}i.start(b)}catch(E){u.diagLog().throwInternal(Le.CRITICAL,Fe.StartTrackFailed,"startTrackPage failed, page view may not be collected: "+Ft(E),{exception:vt(E)})}},u.stopTrackPage=function(b,S,E,D){try{if(typeof b!="string"){var $=Un();b=$&&$.title||""}if(typeof S!="string"){var z=fo();S=z&&z.href||""}i.stop(b,S,E,D),u.config.autoTrackPageVisitTime&&u._pageVisitTimeManager.trackPreviousPageVisit(b,S)}catch(re){u.diagLog().throwInternal(Le.CRITICAL,Fe.StopTrackFailed,"stopTrackPage failed, page view will not be collected: "+Ft(re),{exception:vt(re)})}},u.sendExceptionInternal=function(b,S,E){var D=b.exception||b.error||new Error(on),$=new Hr(u.diagLog(),D,b.properties||S,b.measurements,b.severityLevel,b.id).toInterface(),z=qn.create($,Hr.dataType,Hr.envelopeType,u.diagLog(),S,E);u.core.track(z)},u.trackException=function(b,S){try{u.sendExceptionInternal(b,S)}catch(E){u.diagLog().throwInternal(Le.CRITICAL,Fe.TrackExceptionFailed,"trackException failed, exception will not be collected: "+Ft(E),{exception:vt(E)})}},u._onerror=function(b){var S=b&&b.error,E=b&&b.evt;try{if(!E){var D=hs();D&&(E=D[Cl])}var $=b&&b.url||(Un()||{}).URL,z=b.errorSrc||"window.onerror@"+$+":"+(b.lineNumber||0)+":"+(b.columnNumber||0),re={errorSrc:z,url:$,lineNumber:b.lineNumber||0,columnNumber:b.columnNumber||0,message:b.message};Hg(b.message,b.url,b.lineNumber,b.columnNumber,b.error)?y(Hr.CreateAutoException("Script error: The browser's same-origin policy prevents us from getting the details of this exception. Consider using the 'crossorigin' attribute.",$,b.lineNumber||0,b.columnNumber||0,S,E,null,z),re):(b.errorSrc||(b.errorSrc=z),u.trackException({exception:b,severityLevel:Ss.Error},re))}catch(ee){var ne=S?S.name+", "+S.message:"null";u.diagLog().throwInternal(Le.CRITICAL,Fe.ExceptionWhileLoggingError,"_onError threw exception while logging error, error will not be collected: "+Ft(ee),{exception:vt(ee),errorString:ne})}},u.addTelemetryInitializer=function(b){u._telemetryInitializers.push(b)},u.initialize=function(b,S,E,D){if(!u.isInitialized()){if(He(S))throw Error("Error initializing");d.initialize(b,S,E,D),u.setInitialized(!1);var $=u._getTelCtx(),z=u.identifier;u.config=$.getExtCfg(z);var re=e.getDefaultConfig(b);re!==void 0&&dr(re,function($e,Xe){u.config[$e]=$.getConfig(z,$e,Xe),u.config[$e]===void 0&&(u.config[$e]=Xe)}),u.config.isStorageUseDisabled&&Wg();var ne={instrumentationKey:function(){return b.instrumentationKey},accountId:function(){return u.config.accountId||b.accountId},sessionRenewalMs:function(){return u.config.sessionRenewalMs||b.sessionRenewalMs},sessionExpirationMs:function(){return u.config.sessionExpirationMs||b.sessionExpirationMs},sampleRate:function(){return u.config.samplingPercentage||b.samplingPercentage},sdkExtension:function(){return u.config.sdkExtension||b.sdkExtension},isBrowserLinkTrackingEnabled:function(){return u.config.isBrowserLinkTrackingEnabled||b.isBrowserLinkTrackingEnabled},appId:function(){return u.config.appId||b.appId}};u._pageViewPerformanceManager=new Im(u.core),u._pageViewManager=new Am(r,u.config.overridePageViewDuration,u.core,u._pageViewPerformanceManager),u._pageVisitTimeManager=new Tm(u.diagLog(),function($e,Xe,it){return f($e,Xe,it)}),u._telemetryInitializers=u._telemetryInitializers||[],g(ne),n=new yh(u.diagLog(),"trackEvent"),n.action=function($e,Xe,it,ht){ht||(ht={}),ht[vh]=it.toString(),u.trackEvent({name:$e,properties:ht})},i=new yh(u.diagLog(),"trackPageView"),i.action=function($e,Xe,it,ht,Ct){He(ht)&&(ht={}),ht[vh]=it.toString();var Ht={name:$e,uri:Xe,properties:ht,measurements:Ct};u.sendPageViewInternal(Ht,ht)};var ee=hs(),we=yb(),oe=fo(!0),ge=r;if(u.config.disableExceptionTracking===!1&&!u.config.autoExceptionInstrumented&&ee){var Ee="onerror",et=ee[Ee];ee.onerror=function($e,Xe,it,ht,Ct){var Ht=ee[Cl],fn=et&&et($e,Xe,it,ht,Ct);return fn!==!0&&ge._onerror(Hr.CreateAutoException($e,Xe,it,ht,Ct,Ht)),fn},u.config.autoExceptionInstrumented=!0}if(u.config.disableExceptionTracking===!1&&u.config.enableUnhandledPromiseRejectionTracking===!0&&!u.config.autoUnhandledPromiseInstrumented&&ee){var ae="onunhandledrejection",Re=ee[ae];ee[ae]=function($e){var Xe=ee[Cl],it=Re&&Re.call(ee,$e);return it!==!0&&ge._onerror(Hr.CreateAutoException($e.reason.toString(),oe?oe.href:"",0,0,$e,Xe)),it},u.config.autoUnhandledPromiseInstrumented=!0}if(u.config.enableAutoRouteTracking===!0&&we&&Tt(we.pushState)&&Tt(we.replaceState)&&ee&&typeof Event!="undefined"){var Ne=r;_t(E,function($e){$e.identifier===pa&&(o=$e)}),we.pushState=function($e){return function(){var Xe=$e.apply(this,arguments);return Es(ee,ca(Ne.config.namePrefix+"pushState")),Es(ee,ca(Ne.config.namePrefix+"locationchange")),Xe}}(we.pushState),we.replaceState=function($e){return function(){var Xe=$e.apply(this,arguments);return Es(ee,ca(Ne.config.namePrefix+"replaceState")),Es(ee,ca(Ne.config.namePrefix+"locationchange")),Xe}}(we.replaceState),ee.addEventListener&&(ee.addEventListener(Ne.config.namePrefix+"popstate",function(){Es(ee,ca(Ne.config.namePrefix+"locationchange"))}),ee.addEventListener(Ne.config.namePrefix+"locationchange",function(){if(o&&o.context&&o.context.telemetryTrace){o.context.telemetryTrace.traceID=Hn();var $e="_unknown_";oe&&oe.pathname&&($e=oe.pathname+(oe.hash||"")),o.context.telemetryTrace.name=$e}l&&(s=l),l=oe&&oe.href||"",setTimeout(function(Xe){Ne.trackPageView({refUri:Xe,properties:{duration:0}})}.bind(r,s),Ne.autoRoutePVDelay)}))}u.setInitialized(!0)}};function f(b,S,E){var D={PageName:b,PageUrl:S};u.trackMetric({name:"PageVisitTime",average:E,max:E,min:E,sampleCount:1},D)}c(f,"m");function g(b){if(!b.isBrowserLinkTrackingEnabled()){var S=["/browserLinkSignalR/","/__browserLink/"],E=c(function(D){if(D.baseType===Wn.dataType){var $=D.baseData;if($){for(var z=0;z<S.length;z++)if($.target&&$.target.indexOf(S[z])>=0)return!1}}return!0},"y");x(E)}}c(g,"I");function x(b){u._telemetryInitializers.push(b)}c(x,"E");function y(b,S){var E=qn.create(b,Hr.dataType,Hr.envelopeType,u.diagLog(),S);u.core.track(E)}c(y,"b")}),r}return c(e,"e"),e.getDefaultConfig=function(r){return r||(r={}),r.sessionRenewalMs=30*60*1e3,r.sessionExpirationMs=24*60*60*1e3,r.disableExceptionTracking=Lt(r.disableExceptionTracking),r.autoTrackPageVisitTime=Lt(r.autoTrackPageVisitTime),r.overridePageViewDuration=Lt(r.overridePageViewDuration),r.enableUnhandledPromiseRejectionTracking=Lt(r.enableUnhandledPromiseRejectionTracking),(isNaN(r.samplingPercentage)||r.samplingPercentage<=0||r.samplingPercentage>=100)&&(r.samplingPercentage=100),r.isStorageUseDisabled=Lt(r.isStorageUseDisabled),r.isBrowserLinkTrackingEnabled=Lt(r.isBrowserLinkTrackingEnabled),r.enableAutoRouteTracking=Lt(r.enableAutoRouteTracking),r.namePrefix=r.namePrefix||"",r.enableDebug=Lt(r.enableDebug),r.disableFlushOnBeforeUnload=Lt(r.disableFlushOnBeforeUnload),r.disableFlushOnUnload=Lt(r.disableFlushOnUnload,r.disableFlushOnBeforeUnload),r},e.Version="2.6.4",e}(mo),yh=function(){function t(e,r){var n=this,i={};n.start=function(o){typeof i[o]!="undefined"&&e.throwInternal(Le.WARNING,Fe.StartCalledMoreThanOnce,"start was called more than once for this event without calling stop.",{name:o,key:o},!0),i[o]=+new Date},n.stop=function(o,a,s,l){var u=i[o];if(isNaN(u))e.throwInternal(Le.WARNING,Fe.StopCalledWithoutStart,"stop was called without a corresponding start.",{name:o,key:o},!0);else{var d=+new Date,p=Lr(u,d);n.action(o,a,p,s,l)}delete i[o],i[o]=void 0}}return c(t,"t"),t}()}),Dm=Te(()=>{Ex()}),Pm,Fm,Rx=Te(()=>{hr(),St(),yr(),Pm=function(){function t(e){var r=[];or(t,this,function(n){n.enqueue=function(i){r.push(i)},n.count=function(){return r.length},n.clear=function(){r.length=0},n.getItems=function(){return r.slice(0)},n.batchPayloads=function(i){if(i&&i.length>0){var o=e.emitLineDelimitedJson()?i.join(`
`):"["+i.join(",")+"]";return o}return null},n.markAsSent=function(i){n.clear()},n.clearSent=function(i){}})}return c(t,"t"),t}(),Fm=function(){function t(e,r){var n=!1,i;or(t,this,function(o){var a=u(t.BUFFER_KEY),s=u(t.SENT_BUFFER_KEY);i=a.concat(s),i.length>t.MAX_BUFFER_SIZE&&(i.length=t.MAX_BUFFER_SIZE),d(t.SENT_BUFFER_KEY,[]),d(t.BUFFER_KEY,i),o.enqueue=function(p){if(i.length>=t.MAX_BUFFER_SIZE){n||(e.throwInternal(Le.WARNING,Fe.SessionStorageBufferFull,"Maximum buffer size reached: "+i.length,!0),n=!0);return}i.push(p),d(t.BUFFER_KEY,i)},o.count=function(){return i.length},o.clear=function(){i=[],d(t.BUFFER_KEY,[]),d(t.SENT_BUFFER_KEY,[]),n=!1},o.getItems=function(){return i.slice(0)},o.batchPayloads=function(p){if(p&&p.length>0){var f=r.emitLineDelimitedJson()?p.join(`
`):"["+p.join(",")+"]";return f}return null},o.markAsSent=function(p){i=l(p,i),d(t.BUFFER_KEY,i);var f=u(t.SENT_BUFFER_KEY);f instanceof Array&&p instanceof Array&&(f=f.concat(p),f.length>t.MAX_BUFFER_SIZE&&(e.throwInternal(Le.CRITICAL,Fe.SessionStorageBufferFull,"Sent buffer reached its maximum size: "+f.length,!0),f.length=t.MAX_BUFFER_SIZE),d(t.SENT_BUFFER_KEY,f))},o.clearSent=function(p){var f=u(t.SENT_BUFFER_KEY);f=l(p,f),d(t.SENT_BUFFER_KEY,f)};function l(p,f){var g=[];return _t(f,function(x){!Tt(x)&&us(p,x)===-1&&g.push(x)}),g}c(l,"s");function u(p){var f=p;try{f=r.namePrefix&&r.namePrefix()?r.namePrefix()+"_"+f:f;var g=fl(e,f);if(g){var x=xn().parse(g);if(xt(x)&&(x=xn().parse(x)),x&&di(x))return x}}catch(y){e.throwInternal(Le.CRITICAL,Fe.FailedToRestoreStorageBuffer," storage key: "+f+", "+Ft(y),{exception:vt(y)})}return[]}c(u,"u");function d(p,f){var g=p;try{g=r.namePrefix&&r.namePrefix()?r.namePrefix()+"_"+g:g;var x=JSON.stringify(f);pl(e,g,x)}catch(y){pl(e,g,JSON.stringify([])),e.throwInternal(Le.WARNING,Fe.FailedToSetStorageBuffer," storage key: "+g+", "+Ft(y)+". Buffer cleared",{exception:vt(y)})}}c(d,"l")})}return c(t,"t"),t.BUFFER_KEY="AI_buffer",t.SENT_BUFFER_KEY="AI_sentBuffer",t.MAX_BUFFER_SIZE=2e3,t}()});function sr(t,e,r){return kt(t,e,r,sd)}c(sr,"ye");var El,Qt,fr,bh,tr,$m,xh,Nm,Mm,Bm,Om,Um,Ax=Te(()=>{Wt(),hr(),St(),El="baseType",Qt="baseData",fr="properties",bh="true",tr=function(){function t(){}return c(t,"t"),t.extractPropsAndMeasurements=function(e,r,n){He(e)||dr(e,function(i,o){od(o)?n[i]=o:xt(o)?r[i]=o:Jo()&&(r[i]=xn().stringify(o))})},t.createEnvelope=function(e,r,n,i){var o=new sh(e,i,r);sr(o,"sampleRate",n[ul]),(n[Qt]||{}).startTime&&(o.time=Oi(n[Qt].startTime)),o.iKey=n.iKey;var a=n.iKey.replace(/-/g,"");return o.name=o.name.replace("{0}",a),t.extractPartAExtensions(n,o),n.tags=n.tags||[],zp(o)},t.extractPartAExtensions=function(e,r){var n=r.tags=r.tags||{},i=e.ext=e.ext||{},o=e.tags=e.tags||[],a=i.user;a&&(sr(n,qt.userAuthUserId,a.authId),sr(n,qt.userId,a.id||a.localId));var s=i.app;s&&sr(n,qt.sessionId,s.sesId);var l=i.device;l&&(sr(n,qt.deviceId,l.id||l.localId),sr(n,qt.deviceType,l.deviceClass),sr(n,qt.deviceIp,l.ip),sr(n,qt.deviceModel,l.model),sr(n,qt.deviceType,l.deviceType));var u=e.ext.web;if(u){sr(n,qt.deviceLanguage,u.browserLang),sr(n,qt.deviceBrowserVersion,u.browserVer),sr(n,qt.deviceBrowser,u.browser);var d=r.data=r.data||{},p=d[Qt]=d[Qt]||{},f=p[fr]=p[fr]||{};sr(f,"domain",u.domain),sr(f,"isManual",u.isManual?bh:null),sr(f,"screenRes",u.screenRes),sr(f,"userConsent",u.userConsent?bh:null)}var g=i.os;g&&sr(n,qt.deviceOS,g.name);var x=i.trace;x&&(sr(n,qt.operationParentId,x.parentID),sr(n,qt.operationName,x.name),sr(n,qt.operationId,x.traceID));for(var y={},b=o.length-1;b>=0;b--){var S=o[b];dr(S,function(D,$){y[D]=$}),o.splice(b,1)}dr(o,function(D,$){y[D]=$});var E=Zo({},n,y);E[qt.internalSdkVersion]||(E[qt.internalSdkVersion]="javascript:"+t.Version),r.tags=zp(E)},t.prototype.Init=function(e,r){this._logger=e,He(r[Qt])&&this._logger.throwInternal(Le.CRITICAL,Fe.TelemetryEnvelopeInvalid,"telemetryItem.baseData cannot be null.")},t.Version="2.6.4",t}(),$m=function(t){Bt(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return c(e,"e"),e.prototype.Create=function(r,n){t.prototype.Init.call(this,r,n);var i=n[Qt].measurements||{},o=n[Qt][fr]||{};tr.extractPropsAndMeasurements(n.data,o,i);var a=n[Qt];if(He(a))return r.warnToConsole("Invalid input for dependency data"),null;var s=a[fr]&&a[fr][dl]?a[fr][dl]:"GET",l=new Wn(r,a.id,a.target,a.name,a.duration,a.success,a.responseCode,s,a.type,a.correlationContext,o,i),u=new wi(Wn.dataType,l);return tr.createEnvelope(r,Wn.envelopeType,n,u)},e.DependencyEnvelopeCreator=new e,e}(tr),xh=function(t){Bt(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return c(e,"e"),e.prototype.Create=function(r,n){t.prototype.Init.call(this,r,n);var i={},o={};n[El]!==En.dataType&&(i.baseTypeSource=n[El]),n[El]===En.dataType?(i=n[Qt][fr]||{},o=n[Qt].measurements||{}):n[Qt]&&tr.extractPropsAndMeasurements(n[Qt],i,o),tr.extractPropsAndMeasurements(n.data,i,o);var a=n[Qt].name,s=new En(r,a,i,o),l=new wi(En.dataType,s);return tr.createEnvelope(r,En.envelopeType,n,l)},e.EventEnvelopeCreator=new e,e}(tr),Nm=function(t){Bt(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return c(e,"e"),e.prototype.Create=function(r,n){t.prototype.Init.call(this,r,n);var i=n[Qt].measurements||{},o=n[Qt][fr]||{};tr.extractPropsAndMeasurements(n.data,o,i);var a=n[Qt],s=Hr.CreateFromInterface(r,a,o,i),l=new wi(Hr.dataType,s);return tr.createEnvelope(r,Hr.envelopeType,n,l)},e.ExceptionEnvelopeCreator=new e,e}(tr),Mm=function(t){Bt(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return c(e,"e"),e.prototype.Create=function(r,n){t.prototype.Init.call(this,r,n);var i=n[Qt],o=i[fr]||{},a=i.measurements||{};tr.extractPropsAndMeasurements(n.data,o,a);var s=new zn(r,i.name,i.average,i.sampleCount,i.min,i.max,o,a),l=new wi(zn.dataType,s);return tr.createEnvelope(r,zn.envelopeType,n,l)},e.MetricEnvelopeCreator=new e,e}(tr),Bm=function(t){Bt(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return c(e,"e"),e.prototype.Create=function(r,n){t.prototype.Init.call(this,r,n);var i="duration",o,a=n[Qt];!He(a)&&!He(a[fr])&&!He(a[fr][i])?(o=a[fr][i],delete a[fr][i]):!He(n.data)&&!He(n.data[i])&&(o=n.data[i],delete n.data[i]);var s=n[Qt],l;((n.ext||{}).trace||{}).traceID&&(l=n.ext.trace.traceID);var u=s.id||l,d=s.name,p=s.uri,f=s[fr]||{},g=s.measurements||{};if(He(s.refUri)||(f.refUri=s.refUri),He(s.pageType)||(f.pageType=s.pageType),He(s.isLoggedIn)||(f.isLoggedIn=s.isLoggedIn.toString()),!He(s[fr])){var x=s[fr];dr(x,function(S,E){f[S]=E})}tr.extractPropsAndMeasurements(n.data,f,g);var y=new Rn(r,d,p,o,f,g,u),b=new wi(Rn.dataType,y);return tr.createEnvelope(r,Rn.envelopeType,n,b)},e.PageViewEnvelopeCreator=new e,e}(tr),Om=function(t){Bt(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return c(e,"e"),e.prototype.Create=function(r,n){t.prototype.Init.call(this,r,n);var i=n[Qt],o=i.name,a=i.uri||i.url,s=i[fr]||{},l=i.measurements||{};tr.extractPropsAndMeasurements(n.data,s,l);var u=new vi(r,o,a,void 0,s,l,i),d=new wi(vi.dataType,u);return tr.createEnvelope(r,vi.envelopeType,n,d)},e.PageViewPerformanceEnvelopeCreator=new e,e}(tr),Um=function(t){Bt(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return c(e,"e"),e.prototype.Create=function(r,n){t.prototype.Init.call(this,r,n);var i=n[Qt].message,o=n[Qt].severityLevel,a=n[Qt][fr]||{},s=n[Qt].measurements||{};tr.extractPropsAndMeasurements(n.data,a,s);var l=new mi(r,i,o,a,s),u=new wi(mi.dataType,l);return tr.createEnvelope(r,mi.envelopeType,n,u)},e.TraceEnvelopeCreator=new e,e}(tr)}),Lm,Tx=Te(()=>{St(),yr(),Lm=function(){function t(e){or(t,this,function(r){r.serialize=function(a){var s=n(a,"root");try{return xn().stringify(s)}catch(l){e.throwInternal(Le.CRITICAL,Fe.CannotSerializeObject,l&&Tt(l.toString)?l.toString():"Error serializing object",null,!0)}};function n(a,s){var l="__aiCircularRefCheck",u={};if(!a)return e.throwInternal(Le.CRITICAL,Fe.CannotSerializeObject,"cannot serialize object because it is null or undefined",{name:s},!0),u;if(a[l])return e.throwInternal(Le.WARNING,Fe.CircularReferenceDetected,"Circular reference detected while serializing object",{name:s},!0),u;if(!a.aiDataContract){if(s==="measurements")u=o(a,"number",s);else if(s==="properties")u=o(a,"string",s);else if(s==="tags")u=o(a,"string",s);else if(di(a))u=i(a,s);else{e.throwInternal(Le.WARNING,Fe.CannotSerializeObjectNonSerializable,"Attempting to serialize an object which does not implement ISerializable",{name:s},!0);try{xn().stringify(a),u=a}catch(d){e.throwInternal(Le.CRITICAL,Fe.CannotSerializeObject,d&&Tt(d.toString)?d.toString():"Error serializing object",null,!0)}}return u}return a[l]=!0,dr(a.aiDataContract,function(d,p){var f=Tt(p)?p()&1:p&1,g=Tt(p)?p()&4:p&4,x=p&2,y=a[d]!==void 0,b=uo(a[d])&&a[d]!==null;if(f&&!y&&!x)e.throwInternal(Le.CRITICAL,Fe.MissingRequiredFieldSpecification,"Missing required field specification. The field is required but not present on source",{field:d,name:s});else if(!g){var S=void 0;b?x?S=i(a[d],d):S=n(a[d],d):S=a[d],S!==void 0&&(u[d]=S)}}),delete a[l],u}c(n,"n");function i(a,s){var l;if(a)if(!di(a))e.throwInternal(Le.CRITICAL,Fe.ItemNotInArray,`This field was specified as an array in the contract but the item is not an array.\r
`,{name:s},!0);else{l=[];for(var u=0;u<a.length;u++){var d=a[u],p=n(d,s+"["+u+"]");l.push(p)}}return l}c(i,"i");function o(a,s,l){var u;return a&&(u={},dr(a,function(d,p){if(s==="string")p===void 0?u[d]="undefined":p===null?u[d]="null":p.toString?u[d]=p.toString():u[d]="invalid field: toString() is not defined.";else if(s==="number")if(p===void 0)u[d]="undefined";else if(p===null)u[d]="null";else{var f=parseFloat(p);isNaN(f)?u[d]="NaN":u[d]=f}else u[d]="invalid field: "+l+" is of unknown type.",e.throwInternal(Le.CRITICAL,u[d],null,!0)})),u}c(o,"a")})}return c(t,"t"),t}()}),Hm,_h,kx=Te(()=>{St(),yr(),Hm=function(){function t(){var e=hs(),r=Un(),n=!1,i=!0;or(t,this,function(o){try{if(e&&ys.Attach(e,"online",l)&&(ys.Attach(e,"offline",u),n=!0),r){var a=r.body||r;Or(a.ononline)||(a.ononline=l,a.onoffline=u,n=!0)}if(n){var s=Ln();s&&!He(s.onLine)&&(i=s.onLine)}}catch(d){n=!1}o.isListening=n,o.isOnline=function(){var d=!0,p=Ln();return n?d=i:p&&!He(p.onLine)&&(d=p.onLine),d},o.isOffline=function(){return!o.isOnline()};function l(){i=!0}c(l,"s");function u(){i=!1}c(u,"u")})}return c(t,"t"),t.Offline=new t,t}(),_h=Hm.Offline}),zm,Ix=Te(()=>{zm=function(){function t(){}return c(t,"t"),t.prototype.getHashCodeScore=function(e){var r=this.getHashCode(e)/t.INT_MAX_VALUE;return r*100},t.prototype.getHashCode=function(e){if(e==="")return 0;for(;e.length<t.MIN_INPUT_LENGTH;)e=e.concat(e);for(var r=5381,n=0;n<e.length;++n)r=(r<<5)+r+e.charCodeAt(n),r=r&r;return Math.abs(r)},t.INT_MAX_VALUE=2147483647,t.MIN_INPUT_LENGTH=8,t}()}),Wm,Dx=Te(()=>{Ix(),hr(),Wm=function(){function t(){this.hashCodeGeneragor=new zm,this.keys=new _l}return c(t,"t"),t.prototype.getSamplingScore=function(e){var r=0;return e.tags&&e.tags[this.keys.userId]?r=this.hashCodeGeneragor.getHashCodeScore(e.tags[this.keys.userId]):e.ext&&e.ext.user&&e.ext.user.id?r=this.hashCodeGeneragor.getHashCodeScore(e.ext.user.id):e.tags&&e.tags[this.keys.operationId]?r=this.hashCodeGeneragor.getHashCodeScore(e.tags[this.keys.operationId]):e.ext&&e.ext.telemetryTrace&&e.ext.telemetryTrace.traceID?r=this.hashCodeGeneragor.getHashCodeScore(e.ext.telemetryTrace.traceID):r=Math.random()*100,r},t}()}),qm,Px=Te(()=>{Dx(),hr(),St(),qm=function(){function t(e,r){this.INT_MAX_VALUE=2147483647,this._logger=r||Qc(null),(e>100||e<0)&&(this._logger.throwInternal(Le.WARNING,Fe.SampleRateOutOfRange,"Sampling rate is out of range (0..100). Sampling will be disabled, you may be sending too much data which may affect your AI service level.",{samplingRate:e},!0),e=100),this.sampleRate=e,this.samplingScoreGenerator=new Wm}return c(t,"t"),t.prototype.isSampledIn=function(e){var r=this.sampleRate,n=!1;return r==null||r>=100||e.baseType===zn.dataType?!0:(n=this.samplingScoreGenerator.getSamplingScore(e)<r,n)},t}()});function Rl(t){try{return t.responseText}catch(e){}return null}c(Rl,"Si");var Sh,Fx=Te(()=>{Wt(),Rx(),Ax(),Tx(),hr(),St(),kx(),Px(),yr(),Sh=function(t){Bt(e,t);function e(){var r=t.call(this)||this;r.priority=1001,r.identifier=Sl,r._XMLHttpRequestSupported=!1;var n,i,o,a,s,l,u={};return or(e,r,function(d,p){function f(){On("Method not implemented.")}c(f,"m"),d.pause=f,d.resume=f,d.flush=function(){try{d.triggerSend(!0,null,1)}catch(ae){d.diagLog().throwInternal(Le.CRITICAL,Fe.FlushFailed,"flush failed, telemetry will not be collected: "+Ft(ae),{exception:vt(ae)})}},d.onunloadFlush=function(){if((d._senderConfig.onunloadDisableBeacon()===!1||d._senderConfig.isBeaconApiDisabled()===!1)&&Xd())try{d.triggerSend(!0,b,2)}catch(ae){d.diagLog().throwInternal(Le.CRITICAL,Fe.FailedToSendQueuedTelemetry,"failed to flush with beacon sender on page unload, telemetry will not be collected: "+Ft(ae),{exception:vt(ae)})}else d.flush()},d.teardown=f,d.addHeader=function(ae,Re){u[ae]=Re},d.initialize=function(ae,Re,Ne,$e){p.initialize(ae,Re,Ne,$e);var Xe=d._getTelCtx(),it=d.identifier;s=new Lm(Re.logger),n=0,i=null,o=0,d._sender=null,l=0;var ht=e._getDefaultAppInsightsChannelConfig();if(d._senderConfig=e._getEmptyAppInsightsChannelConfig(),dr(ht,function(be,Me){d._senderConfig[be]=function(){return Xe.getConfig(it,be,Me())}}),d._buffer=d._senderConfig.enableSessionStorageBuffer()&&ua()?new Fm(d.diagLog(),d._senderConfig):new Pm(d._senderConfig),d._sample=new qm(d._senderConfig.samplingPercentage(),d.diagLog()),et(ae)||d.diagLog().throwInternal(Le.CRITICAL,Fe.InvalidInstrumentationKey,"Invalid Instrumentation key "+ae.instrumentationKey),!gl(d._senderConfig.endpointUrl())&&d._senderConfig.customHeaders()&&d._senderConfig.customHeaders().length>0&&_t(d._senderConfig.customHeaders(),function(be){r.addHeader(be.header,be.value)}),!d._senderConfig.isBeaconApiDisabled()&&Xd())d._sender=b;else{var Ct=Pr("XMLHttpRequest");if(Ct){var Ht=new Ct;"withCredentials"in Ht?(d._sender=S,d._XMLHttpRequestSupported=!0):typeof XDomainRequest!==li&&(d._sender=we)}else{var fn=Pr("fetch");fn&&(d._sender=E)}}},d.processTelemetry=function(ae,Re){Re=d._getTelCtx(Re);try{if(d._senderConfig.disableTelemetry())return;if(!ae){Re.diagLog().throwInternal(Le.CRITICAL,Fe.CannotSendEmptyTelemetry,"Cannot send empty telemetry");return}if(ae.baseData&&!ae.baseType){Re.diagLog().throwInternal(Le.CRITICAL,Fe.InvalidEvent,"Cannot send telemetry without baseData and baseType");return}if(ae.baseType||(ae.baseType="EventData"),!d._sender){Re.diagLog().throwInternal(Le.CRITICAL,Fe.SenderNotInitialized,"Sender was not initialized");return}if(g(ae))ae[ul]=d._sample.sampleRate;else{Re.diagLog().throwInternal(Le.WARNING,Fe.TelemetrySampledAndNotSent,"Telemetry item was sampled out and not sent",{SampleRate:d._sample.sampleRate});return}var Ne=e.constructEnvelope(ae,d._senderConfig.instrumentationKey(),Re.diagLog());if(!Ne){Re.diagLog().throwInternal(Le.CRITICAL,Fe.CreateEnvelopeError,"Unable to create an AppInsights envelope");return}var $e=!1;if(ae.tags&&ae.tags[la]&&(_t(ae.tags[la],function(Ct){try{Ct&&Ct(Ne)===!1&&($e=!0,Re.diagLog().warnToConsole("Telemetry processor check returns false"))}catch(Ht){Re.diagLog().throwInternal(Le.CRITICAL,Fe.TelemetryInitializerFailed,"One of telemetry initializers failed, telemetry item will not be sent: "+Ft(Ht),{exception:vt(Ht)},!0)}}),delete ae.tags[la]),$e)return;var Xe=s.serialize(Ne),it=d._buffer.getItems(),ht=d._buffer.batchPayloads(it);ht&&ht.length+Xe.length>d._senderConfig.maxBatchSizeInBytes()&&d.triggerSend(!0,null,10),d._buffer.enqueue(Xe),re()}catch(Ct){Re.diagLog().throwInternal(Le.WARNING,Fe.FailedAddingTelemetryToBuffer,"Failed adding telemetry to the sender's buffer, some telemetry will be lost: "+Ft(Ct),{exception:vt(Ct)})}d.processNext(ae,Re)},d._xhrReadyStateChange=function(ae,Re,Ne){ae.readyState===4&&x(ae.status,Re,ae.responseURL,Ne,ee(ae),Rl(ae)||ae.response)},d.triggerSend=function(ae,Re,Ne){ae===void 0&&(ae=!0);try{if(d._senderConfig.disableTelemetry())d._buffer.clear();else{if(d._buffer.count()>0){var $e=d._buffer.getItems();Ee(Ne||0,ae),Re?Re.call(r,$e,ae):d._sender($e,ae)}o=+new Date}clearTimeout(a),a=null,i=null}catch(it){var Xe=pd();(!Xe||Xe>9)&&d.diagLog().throwInternal(Le.CRITICAL,Fe.TransmissionFailed,"Telemetry transmission failed, some telemetry will be lost: "+Ft(it),{exception:vt(it)})}},d._onError=function(ae,Re,Ne){d.diagLog().throwInternal(Le.WARNING,Fe.OnError,"Failed to send telemetry.",{message:Re}),d._buffer.clearSent(ae)},d._onPartialSuccess=function(ae,Re){for(var Ne=[],$e=[],Xe=Re.errors.reverse(),it=0,ht=Xe;it<ht.length;it++){var Ct=ht[it],Ht=ae.splice(Ct.index,1)[0];ne(Ct.statusCode)?$e.push(Ht):Ne.push(Ht)}ae.length>0&&d._onSuccess(ae,Re.itemsAccepted),Ne.length>0&&d._onError(Ne,ee(null,["partial success",Re.itemsAccepted,"of",Re.itemsReceived].join(" "))),$e.length>0&&($($e),d.diagLog().throwInternal(Le.WARNING,Fe.TransmissionFailed,"Partial success. Delivered: "+ae.length+", Failed: "+Ne.length+". Will retry to send "+$e.length+" our of "+Re.itemsReceived+" items"))},d._onSuccess=function(ae,Re){d._buffer.clearSent(ae)},d._xdrOnLoad=function(ae,Re){var Ne=Rl(ae);if(ae&&(Ne+""=="200"||Ne===""))n=0,d._onSuccess(Re,0);else{var $e=D(Ne);$e&&$e.itemsReceived&&$e.itemsReceived>$e.itemsAccepted&&!d._senderConfig.isRetryDisabled()?d._onPartialSuccess(Re,$e):d._onError(Re,oe(ae))}};function g(ae){return d._sample.isSampledIn(ae)}c(g,"I");function x(ae,Re,Ne,$e,Xe,it){var ht=null;if(d._appId||(ht=D(it),ht&&ht.appId&&(d._appId=ht.appId)),(ae<200||ae>=300)&&ae!==0){if((ae===301||ae===307||ae===308)&&!y(Ne)){d._onError(Re,Xe);return}!d._senderConfig.isRetryDisabled()&&ne(ae)?($(Re),d.diagLog().throwInternal(Le.WARNING,Fe.TransmissionFailed,". Response code "+ae+". Will retry to send "+Re.length+" items.")):d._onError(Re,Xe)}else if(_h.isOffline()){if(!d._senderConfig.isRetryDisabled()){var Ct=10;$(Re,Ct),d.diagLog().throwInternal(Le.WARNING,Fe.TransmissionFailed,". Offline - Response Code: "+ae+". Offline status: "+_h.isOffline()+". Will retry to send "+Re.length+" items.")}}else y(Ne),ae===206?(ht||(ht=D(it)),ht&&!d._senderConfig.isRetryDisabled()?d._onPartialSuccess(Re,ht):d._onError(Re,Xe)):(n=0,d._onSuccess(Re,$e))}c(x,"E");function y(ae){return l>=10?!1:!He(ae)&&ae!==""&&ae!==d._senderConfig.endpointUrl()?(d._senderConfig.endpointUrl=function(){return ae},++l,!0):!1}c(y,"b");function b(ae,Re){var Ne=d._senderConfig.endpointUrl(),$e=d._buffer.batchPayloads(ae),Xe=new Blob([$e],{type:"text/plain;charset=UTF-8"}),it=Ln().sendBeacon(Ne,Xe);it?(d._buffer.markAsSent(ae),d._onSuccess(ae,ae.length)):(S(ae,!0),d.diagLog().throwInternal(Le.WARNING,Fe.TransmissionFailed,". Failed to send telemetry with Beacon API, retried with xhrSender."))}c(b,"p");function S(ae,Re){var Ne=new XMLHttpRequest,$e=d._senderConfig.endpointUrl();try{Ne[yo]=!0}catch(it){}Ne.open("POST",$e,Re),Ne.setRequestHeader("Content-type","application/json"),gl($e)&&Ne.setRequestHeader(Gt.sdkContextHeader,Gt.sdkContextHeaderAppIdRequest),_t(ho(u),function(it){Ne.setRequestHeader(it,u[it])}),Ne.onreadystatechange=function(){return d._xhrReadyStateChange(Ne,ae,ae.length)},Ne.onerror=function(it){return d._onError(ae,ee(Ne),it)};var Xe=d._buffer.batchPayloads(ae);Ne.send(Xe),d._buffer.markAsSent(ae)}c(S,"v");function E(ae,Re){var Ne=d._senderConfig.endpointUrl(),$e=d._buffer.batchPayloads(ae),Xe=new Blob([$e],{type:"text/plain;charset=UTF-8"}),it=new Headers;gl(Ne)&&it.append(Gt.sdkContextHeader,Gt.sdkContextHeaderAppIdRequest),_t(ho(u),function(Ht){it.append(Ht,u[Ht])});var ht={method:"POST",headers:it,body:Xe},Ct=new Request(Ne,ht);fetch(Ct).then(function(Ht){if(Ht.ok)Ht.text().then(function(fn){x(Ht.status,ae,Ht.url,ae.length,Ht.statusText,fn)}),d._buffer.markAsSent(ae);else throw Error(Ht.statusText)}).catch(function(Ht){d._onError(ae,Ht.message)})}c(E,"y");function D(ae){try{if(ae&&ae!==""){var Re=xn().parse(ae);if(Re&&Re.itemsReceived&&Re.itemsReceived>=Re.itemsAccepted&&Re.itemsReceived-Re.itemsAccepted===Re.errors.length)return Re}}catch(Ne){d.diagLog().throwInternal(Le.CRITICAL,Fe.InvalidBackendResponse,"Cannot parse the response. "+Ft(Ne),{response:ae})}return null}c(D,"w");function $(ae,Re){if(Re===void 0&&(Re=1),!(!ae||ae.length===0)){d._buffer.clearSent(ae),n++;for(var Ne=0,$e=ae;Ne<$e.length;Ne++){var Xe=$e[Ne];d._buffer.enqueue(Xe)}z(Re),re()}}c($,"L");function z(ae){var Re=10,Ne;if(n<=1)Ne=Re;else{var $e=(Math.pow(2,n)-1)/2,Xe=Math.floor(Math.random()*$e*Re)+1;Xe=ae*Xe,Ne=Math.max(Math.min(Xe,3600),Re)}var it=rn()+Ne*1e3;i=it}c(z,"F");function re(){if(!a){var ae=i?Math.max(0,i-rn()):0,Re=Math.max(d._senderConfig.maxBatchInterval(),ae);a=setTimeout(function(){d.triggerSend(!0,null,1)},Re)}}c(re,"Y");function ne(ae){return ae===408||ae===429||ae===500||ae===503}c(ne,"Se");function ee(ae,Re){return ae?"XMLHttpRequest,Status:"+ae.status+",Response:"+Rl(ae)||0||0:Re}c(ee,"X");function we(ae,Re){var Ne=hs(),$e=new XDomainRequest;$e.onload=function(){return d._xdrOnLoad($e,ae)},$e.onerror=function(Ct){return d._onError(ae,oe($e),Ct)};var Xe=Ne&&Ne.location&&Ne.location.protocol||"";if(d._senderConfig.endpointUrl().lastIndexOf(Xe,0)!==0){d.diagLog().throwInternal(Le.WARNING,Fe.TransmissionFailed,". Cannot send XDomain request. The endpoint URL protocol doesn't match the hosting page protocol."),d._buffer.clear();return}var it=d._senderConfig.endpointUrl().replace(/^(https?:)/,"");$e.open("POST",it);var ht=d._buffer.batchPayloads(ae);$e.send(ht),d._buffer.markAsSent(ae)}c(we,"me");function oe(ae,Re){return ae?"XDomainRequest,Response:"+Rl(ae)||0:Re}c(oe,"De");function ge(){var ae="getNotifyMgr";return d.core[ae]?d.core[ae]():d.core._notificationManager}c(ge,"pt");function Ee(ae,Re){var Ne=ge();if(Ne&&Ne.eventsSendRequest)try{Ne.eventsSendRequest(ae,Re)}catch($e){d.diagLog().throwInternal(Le.CRITICAL,Fe.NotificationException,"send request notification failed: "+Ft($e),{exception:vt($e)})}}c(Ee,"at");function et(ae){var Re=He(ae.disableInstrumentationKeyValidation)?!1:ae.disableInstrumentationKeyValidation;if(Re)return!0;var Ne="^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$",$e=new RegExp(Ne);return $e.test(ae.instrumentationKey)}c(et,"dt")}),r}return c(e,"e"),e.constructEnvelope=function(r,n,i){var o;switch(n!==r.iKey&&!He(n)?o=Zo({},r,{iKey:n}):o=r,o.baseType){case En.dataType:return xh.EventEnvelopeCreator.Create(i,o);case mi.dataType:return Um.TraceEnvelopeCreator.Create(i,o);case Rn.dataType:return Bm.PageViewEnvelopeCreator.Create(i,o);case vi.dataType:return Om.PageViewPerformanceEnvelopeCreator.Create(i,o);case Hr.dataType:return Nm.ExceptionEnvelopeCreator.Create(i,o);case zn.dataType:return Mm.MetricEnvelopeCreator.Create(i,o);case Wn.dataType:return $m.DependencyEnvelopeCreator.Create(i,o);default:return xh.EventEnvelopeCreator.Create(i,o)}},e._getDefaultAppInsightsChannelConfig=function(){return{endpointUrl:function(){return"https://dc.services.visualstudio.com/v2/track"},emitLineDelimitedJson:function(){return!1},maxBatchInterval:function(){return 15e3},maxBatchSizeInBytes:function(){return 102400},disableTelemetry:function(){return!1},enableSessionStorageBuffer:function(){return!0},isRetryDisabled:function(){return!1},isBeaconApiDisabled:function(){return!0},onunloadDisableBeacon:function(){return!1},instrumentationKey:function(){},namePrefix:function(){},samplingPercentage:function(){return 100},customHeaders:function(){}}},e._getEmptyAppInsightsChannelConfig=function(){return{endpointUrl:void 0,emitLineDelimitedJson:void 0,maxBatchInterval:void 0,maxBatchSizeInBytes:void 0,disableTelemetry:void 0,enableSessionStorageBuffer:void 0,isRetryDisabled:void 0,isBeaconApiDisabled:void 0,onunloadDisableBeacon:void 0,instrumentationKey:void 0,namePrefix:void 0,samplingPercentage:void 0,customHeaders:void 0}},e}(mo)}),jm=Te(()=>{Fx()}),Vm,Ch,Gm,$x=Te(()=>{yr(),hr(),St(),Vm="ai_session",Ch=function(){function t(){}return c(t,"t"),t}(),Gm=function(){function t(e,r){var n=this,i,o,a=Qc(r),s=Ad(r);or(t,n,function(l){e||(e={}),Tt(e.sessionExpirationMs)||(e.sessionExpirationMs=function(){return t.acquisitionSpan}),Tt(e.sessionRenewalMs)||(e.sessionRenewalMs=function(){return t.renewalSpan}),l.config=e;var u=l.config.sessionCookiePostfix&&l.config.sessionCookiePostfix()?l.config.sessionCookiePostfix():l.config.namePrefix&&l.config.namePrefix()?l.config.namePrefix():"";i=c(function(){return Vm+u},"i"),l.automaticSession=new Ch,l.update=function(){var y=rn(),b=!1,S=l.automaticSession;S.id||(b=!d(S,y));var E=l.config.sessionExpirationMs();if(!b&&E>0){var D=l.config.sessionRenewalMs(),$=y-S.acquisitionDate,z=y-S.renewalDate;b=$<0||z<0,b=b||$>E,b=b||z>D}b?f(y):(!o||y-o>t.cookieUpdateInterval)&&g(S,y)},l.backup=function(){var y=l.automaticSession;x(y.id,y.acquisitionDate,y.renewalDate)};function d(y,b){var S=!1,E=s.get(i());if(E&&Tt(E.split))S=p(y,E);else{var D=qg(a,i());D&&(S=p(y,D))}return S||!!y.id}c(d,"l");function p(y,b){var S=!1,E=", session will be reset",D=b.split("|");if(D.length>=2)try{var $=+D[1]||0,z=+D[2]||0;isNaN($)||$<=0?a.throwInternal(Le.WARNING,Fe.SessionRenewalDateIsZero,"AI session acquisition date is 0"+E):isNaN(z)||z<=0?a.throwInternal(Le.WARNING,Fe.SessionRenewalDateIsZero,"AI session renewal date is 0"+E):D[0]&&(y.id=D[0],y.acquisitionDate=$,y.renewalDate=z,S=!0)}catch(re){a.throwInternal(Le.CRITICAL,Fe.ErrorParsingAISessionCookie,"Error parsing ai_session value ["+(b||"")+"]"+E+" - "+Ft(re),{exception:vt(re)})}return S}c(p,"f");function f(y){var b=l.config||{},S=(b.getNewId?b.getNewId():null)||sl;l.automaticSession.id=S(b.idLength?b.idLength():22),l.automaticSession.acquisitionDate=y,g(l.automaticSession,y),eh()||a.throwInternal(Le.WARNING,Fe.BrowserDoesNotSupportLocalStorage,"Browser does not support local storage. Session durations will be inaccurate.")}c(f,"m");function g(y,b){var S=y.acquisitionDate;y.renewalDate=b;var E=l.config,D=E.sessionRenewalMs(),$=S+E.sessionExpirationMs()-b,z=[y.id,S,b],re=0;$<D?re=$/1e3:re=D/1e3;var ne=E.cookieDomain?E.cookieDomain():null;s.set(i(),z.join("|"),E.sessionExpirationMs()>0?re:null,ne),o=b}c(g,"I");function x(y,b,S){jg(a,i(),[y,b,S].join("|"))}c(x,"E")})}return c(t,"t"),t.acquisitionSpan=864e5,t.renewalSpan=18e5,t.cookieUpdateInterval=6e4,t}()}),Km,Nx=Te(()=>{Km=function(){function t(){}return c(t,"t"),t}()}),Zm,Mx=Te(()=>{Zm=function(){function t(){this.id="browser",this.deviceClass="Browser"}return c(t,"t"),t}()}),Xm,Qm,Bx=Te(()=>{Xm="2.6.4",Qm=function(){function t(e){this.sdkVersion=(e.sdkExtension&&e.sdkExtension()?e.sdkExtension()+"_":"")+"javascript:"+Xm}return c(t,"t"),t}()});function Ym(t){return!(typeof t!="string"||!t||t.match(/,|;|=| |\|/))}c(Ym,"zc");var Jm,Ox=Te(()=>{yr(),hr(),St(),Jm=function(){function t(e,r){this.isNewUser=!1;var n=Qc(r),i=Ad(r),o;or(t,this,function(a){a.config=e;var s=a.config.userCookiePostfix&&a.config.userCookiePostfix()?a.config.userCookiePostfix():"";o=c(function(){return t.userCookieName+s},"a");var l=i.get(o());if(l){a.isNewUser=!1;var u=l.split(t.cookieSeparator);u.length>0&&(a.id=u[0])}if(!a.id){var d=e||{},p=(d.getNewId?d.getNewId():null)||sl;a.id=p(d.idLength?e.idLength():22);var f=31536e3,g=Oi(new Date);a.accountAcquisitionDate=g,a.isNewUser=!0;var x=[a.id,g];i.set(o(),x.join(t.cookieSeparator),f);var y=e.namePrefix&&e.namePrefix()?e.namePrefix()+"ai_session":"ai_session";Vg(n,y)}a.accountId=e.accountId?e.accountId():void 0;var b=i.get(t.authUserCookieName);if(b){b=decodeURI(b);var S=b.split(t.cookieSeparator);S[0]&&(a.authenticatedId=S[0]),S.length>1&&S[1]&&(a.accountId=S[1])}a.setAuthenticatedUserContext=function(E,D,$){$===void 0&&($=!1);var z=!Ym(E)||D&&!Ym(D);if(z){n.throwInternal(Le.WARNING,Fe.SetAuthContextFailedAccountName,"Setting auth user context failed. User auth/account id should be of type string, and not contain commas, semi-colons, equal signs, spaces, or vertical-bars.",!0);return}a.authenticatedId=E;var re=a.authenticatedId;D&&(a.accountId=D,re=[a.authenticatedId,a.accountId].join(t.cookieSeparator)),$&&i.set(t.authUserCookieName,encodeURI(re))},a.clearAuthenticatedUserContext=function(){a.authenticatedId=null,a.accountId=null,i.del(t.authUserCookieName)}})}return c(t,"t"),t.cookieSeparator="|",t.userCookieName="ai_user",t.authUserCookieName="ai_authUser",t}()}),e0,Ux=Te(()=>{e0=function(){function t(){}return c(t,"t"),t}()}),t0,Lx=Te(()=>{hr(),St(),t0=function(){function t(e,r,n,i){var o=this;o.traceID=e||Hn(),o.parentID=r,o.name=n;var a=fo();!n&&a&&a.pathname&&(o.name=a.pathname),o.name=Ur(i,o.name)}return c(t,"t"),t}()});function ga(t,e){t&&t[e]&&ho(t[e]).length===0&&delete t[e]}c(ga,"Or");var Rs,As,r0,Hx=Te(()=>{yr(),St(),$x(),hr(),Nx(),Mx(),Bx(),Ox(),Ux(),Lx(),Rs="ext",As="tags",r0=function(){function t(e,r){var n=this,i=e.logger;this.appId=function(){return null},or(t,this,function(o){o.application=new Km,o.internal=new Qm(r),jc()&&(o.sessionManager=new Gm(r,e),o.device=new Zm,o.location=new e0,o.user=new Jm(r,e),o.telemetryTrace=new t0(void 0,void 0,void 0,i),o.session=new Ch),o.applySessionContext=function(a,s){var l=o.session,u=o.sessionManager;l&&xt(l.id)?kt(Ir(a.ext,zr.AppExt),"sesId",l.id):u&&u.automaticSession&&kt(Ir(a.ext,zr.AppExt),"sesId",u.automaticSession.id,xt)},o.applyOperatingSystemContxt=function(a,s){kt(a.ext,zr.OSExt,o.os)},o.applyApplicationContext=function(a,s){var l=o.application;if(l){var u=Ir(a,As);kt(u,qt.applicationVersion,l.ver,xt),kt(u,qt.applicationBuild,l.build,xt)}},o.applyDeviceContext=function(a,s){var l=o.device;if(l){var u=Ir(Ir(a,Rs),zr.DeviceExt);kt(u,"localId",l.id,xt),kt(u,"ip",l.ip,xt),kt(u,"model",l.model,xt),kt(u,"deviceClass",l.deviceClass,xt)}},o.applyInternalContext=function(a,s){var l=o.internal;if(l){var u=Ir(a,As);kt(u,qt.internalAgentVersion,l.agentVersion,xt),kt(u,qt.internalSdkVersion,l.sdkVersion,xt),(a.baseType===ea.dataType||a.baseType===Rn.dataType)&&(kt(u,qt.internalSnippet,l.snippetVer,xt),kt(u,qt.internalSdkSrc,l.sdkSrc,xt))}},o.applyLocationContext=function(a,s){var l=n.location;l&&kt(Ir(a,As,[]),qt.locationIp,l.ip,xt)},o.applyOperationContext=function(a,s){var l=o.telemetryTrace;if(l){var u=Ir(Ir(a,Rs),zr.TraceExt,{traceID:void 0,parentID:void 0});kt(u,"traceID",l.traceID,xt),kt(u,"name",l.name,xt),kt(u,"parentID",l.parentID,xt)}},o.applyWebContext=function(a,s){var l=n.web;l&&kt(Ir(a,Rs),zr.WebExt,l)},o.applyUserContext=function(a,s){var l=o.user;if(l){var u=Ir(a,As,[]);kt(u,qt.userAccountId,l.accountId,xt);var d=Ir(Ir(a,Rs),zr.UserExt);kt(d,"id",l.id,xt),kt(d,"authId",l.authenticatedId,xt)}},o.cleanUp=function(a,s){var l=a.ext;l&&(ga(l,zr.DeviceExt),ga(l,zr.UserExt),ga(l,zr.WebExt),ga(l,zr.OSExt),ga(l,zr.AppExt),ga(l,zr.TraceExt))}})}return c(t,"t"),t}()}),n0,Eh,zx=Te(()=>{Wt(),yr(),St(),Hx(),hr(),n0=function(t){Bt(e,t);function e(){var r=t.call(this)||this;r.priority=110,r.identifier=pa;var n,i;return or(e,r,function(o,a){o.initialize=function(l,u,d,p){a.initialize(l,u,d,p);var f=o._getTelCtx(),g=o.identifier,x=e.getDefaultConfig();i=i||{},dr(x,function(y,b){i[y]=function(){return f.getConfig(g,y,b())}}),o.context=new r0(u,i),n=Lg(d,Sl),o.context.appId=function(){return n?n._appId:null},o._extConfig=i},o.processTelemetry=function(l,u){if(!He(l)){u=o._getTelCtx(u),l.name===Rn.envelopeType&&u.diagLog().resetInternalMessageCount();var d=o.context||{};if(d.session&&typeof o.context.session.id!="string"&&d.sessionManager&&d.sessionManager.update(),s(l,u),d.user&&d.user.isNewUser){d.user.isNewUser=!1;var p=new ea(Fe.SendBrowserInfoOnUserInit,(Ln()||{}).userAgent||"");u.diagLog().logInternalMessage(Le.CRITICAL,p)}o.processNext(l,u)}};function s(l,u){Ir(l,"tags",[]),Ir(l,"ext",{});var d=o.context;d.applySessionContext(l,u),d.applyApplicationContext(l,u),d.applyDeviceContext(l,u),d.applyOperationContext(l,u),d.applyUserContext(l,u),d.applyOperatingSystemContxt(l,u),d.applyWebContext(l,u),d.applyLocationContext(l,u),d.applyInternalContext(l,u),d.cleanUp(l,u)}c(s,"c")}),r}return c(e,"e"),e.getDefaultConfig=function(){var r={instrumentationKey:function(){},accountId:function(){return null},sessionRenewalMs:function(){return 30*60*1e3},samplingPercentage:function(){return 100},sessionExpirationMs:function(){return 24*60*60*1e3},cookieDomain:function(){return null},sdkExtension:function(){return null},isBrowserLinkTrackingEnabled:function(){return!1},appId:function(){return null},namePrefix:function(){},sessionCookiePostfix:function(){},userCookiePostfix:function(){},idLength:function(){return 22},getNewId:function(){return null}};return r},e}(mo),Eh=n0}),i0=Te(()=>{zx()});function o0(t,e,r){var n=0,i=t[e],o=t[r];return i&&o&&(n=Lr(i,o)),n}c(o0,"$c");function So(t,e,r,n,i){var o=0,a=o0(r,n,i);return a&&(o=Vi(t,e,gi(a))),o}c(So,"xr");function Vi(t,e,r){var n="ajaxPerf",i=0;if(t&&e&&r){var o=t[n]=t[n]||{};o[e]=r,i=1}return i}c(Vi,"tr");function Wx(t,e){var r=t.perfTiming,n=e[jr]||{},i=0,o="name",a="Start",s="End",l="domainLookup",u="connect",d="redirect",p="request",f="response",g="duration",x="startTime",y=l+a,b=l+s,S=u+a,E=u+s,D=p+a,$=p+s,z=f+a,re=f+s,ne=d+a,ee=d=s,we="transferSize",oe="encodedBodySize",ge="decodedBodySize",Ee="serverTiming";if(r){i|=So(n,d,r,ne,ee),i|=So(n,l,r,y,b),i|=So(n,u,r,S,E),i|=So(n,p,r,D,$),i|=So(n,f,r,z,re),i|=So(n,"networkConnect",r,x,E),i|=So(n,"sentRequest",r,D,re);var et=r[g];et||(et=o0(r,x,re)||0),i|=Vi(n,g,et),i|=Vi(n,"perfTotal",et);var ae=r[Ee];if(ae){var Re={};_t(ae,function(Ne,$e){var Xe=hb(Ne[o]||""+$e),it=Re[Xe]||{};dr(Ne,function(ht,Ct){(ht!==o&&xt(Ct)||od(Ct))&&(it[ht]&&(Ct=it[ht]+";"+Ct),(Ct||!xt(Ct))&&(it[ht]=Ct))}),Re[Xe]=it}),i|=Vi(n,Ee,Re)}i|=Vi(n,we,r[we]),i|=Vi(n,oe,r[oe]),i|=Vi(n,ge,r[ge])}else t.perfMark&&(i|=Vi(n,"missing",t.perfAttempts));i&&(e[jr]=n)}c(Wx,"vl");var jr,a0,Rh,qx=Te(()=>{hr(),St(),yr(),jr="properties",a0=function(){function t(){var e=this;e.openDone=!1,e.setRequestHeaderDone=!1,e.sendDone=!1,e.abortDone=!1,e.stateChangeAttached=!1}return c(t,"t"),t}(),Rh=function(){function t(e,r,n){var i=this,o=n,a="responseText";i.perfMark=null,i.completed=!1,i.requestHeadersSize=null,i.requestHeaders=null,i.responseReceivingDuration=null,i.callbackDuration=null,i.ajaxTotalDuration=null,i.aborted=0,i.pageUrl=null,i.requestUrl=null,i.requestSize=0,i.method=null,i.status=null,i.requestSentTime=null,i.responseStartedTime=null,i.responseFinishedTime=null,i.callbackFinishedTime=null,i.endTime=null,i.xhrMonitoringState=new a0,i.clientFailure=0,i.traceID=e,i.spanID=r,or(t,i,function(s){s.getAbsoluteUrl=function(){return s.requestUrl?Zg(s.requestUrl):null},s.getPathName=function(){return s.requestUrl?bs(o,Xg(s.method,s.requestUrl)):null},s.CreateTrackItem=function(l,u,d){if(s.ajaxTotalDuration=Math.round(Lr(s.requestSentTime,s.responseFinishedTime)*1e3)/1e3,s.ajaxTotalDuration<0)return null;var p=(y={id:"|"+s.traceID+"."+s.spanID,target:s.getAbsoluteUrl(),name:s.getPathName(),type:l,startTime:null,duration:s.ajaxTotalDuration,success:+s.status>=200&&+s.status<400,responseCode:+s.status,method:s.method},y[jr]={HttpMethod:s.method},y);if(s.requestSentTime&&(p.startTime=new Date,p.startTime.setTime(s.requestSentTime)),Wx(s,p),u&&ho(s.requestHeaders).length>0&&(p[jr]=p[jr]||{},p[jr].requestHeaders=s.requestHeaders),d){var f=d();if(f){var g=f.correlationContext;if(g&&(p.correlationContext=g),f.headerMap&&ho(f.headerMap).length>0&&(p[jr]=p[jr]||{},p[jr].responseHeaders=f.headerMap),s.status>=400){var x=f.type;p[jr]=p[jr]||{},(x===""||x==="text")&&(p[jr][a]=f[a]?f.statusText+" - "+f[a]:f.statusText),x==="json"&&(p[jr][a]=f.response?f.statusText+" - "+JSON.stringify(f.response):f.statusText)}}}return p;var y}})}return c(t,"t"),t}()}),jx,Vx=Te(()=>{St(),St(),jx=function(){function t(){}return c(t,"t"),t.GetLength=function(e){var r=0;if(!He(e)){var n="";try{n=e.toString()}catch(i){}r=n.length,r=isNaN(r)?0:r}return r},t}()}),Ah,Gx=Te(()=>{St(),Ah=function(){function t(e,r){var n=this;n.traceFlag=t.DEFAULT_TRACE_FLAG,n.version=t.DEFAULT_VERSION,e&&t.isValidTraceId(e)?n.traceId=e:n.traceId=Hn(),r&&t.isValidSpanId(r)?n.spanId=r:n.spanId=Hn().substr(0,16)}return c(t,"t"),t.isValidTraceId=function(e){return e.match(/^[0-9a-f]{32}$/)&&e!=="00000000000000000000000000000000"},t.isValidSpanId=function(e){return e.match(/^[0-9a-f]{16}$/)&&e!=="0000000000000000"},t.prototype.toString=function(){var e=this;return e.version+"-"+e.traceId+"-"+e.spanId+"-"+e.traceFlag},t.DEFAULT_TRACE_FLAG="01",t.DEFAULT_VERSION="00",t}()});function Kx(){var t=Ko();return!t||He(t.Request)||He(t.Request[Qr])||He(t[wa])?null:t[wa]}c(Kx,"xl");function Zx(t){var e=!1;if(typeof XMLHttpRequest!==li&&!He(XMLHttpRequest)){var r=XMLHttpRequest[Qr];e=!He(r)&&!He(r.open)&&!He(r.send)&&!He(r.abort)}var n=pd();if(n&&n<9&&(e=!1),e)try{var i=new XMLHttpRequest;i[Vr]={};var o=XMLHttpRequest[Qr].open;XMLHttpRequest[Qr].open=o}catch(a){e=!1,Ts(t,Fe.FailedMonitorAjaxOpen,"Failed to enable XMLHttpRequest monitoring, extension is not supported",{exception:vt(a)})}return e}c(Zx,"yl");function Al(t){var e="";try{!He(t)&&!He(t[Vr])&&!He(t[Vr].requestUrl)&&(e+="(url: '"+t[Vr].requestUrl+"')")}catch(r){}return e}c(Al,"Ti");function Ts(t,e,r,n,i){t[va]()[kh](Le.CRITICAL,e,r,n,i)}c(Ts,"kn");function Tl(t,e,r,n,i){t[va]()[kh](Le.WARNING,e,r,n,i)}c(Tl,"Ei");function ks(t,e,r){return function(n){Ts(t,e,r,{ajaxDiagnosticsMessage:Al(n.inst),exception:vt(n.err)})}}c(ks,"Rn");function ma(t,e){return t&&e?t.indexOf(e):-1}c(ma,"Hr");var Th,va,Vr,kh,wa,Ih,Dh,Xx=Te(()=>{Wt(),hr(),St(),qx(),Vx(),Gx(),yr(),Th="ai.ajxmn.",va="diagLog",Vr="ajaxData",kh="throwInternal",wa="fetch",Ih=0,Dh=function(t){Bt(e,t);function e(){var r=t.call(this)||this;r.identifier=e.identifier,r.priority=120;var n="trackDependencyDataInternal",i=fo(),o=!1,a=!1,s=i&&i.host&&i.host.toLowerCase(),l=e.getEmptyConfig(),u=!1,d=0,p,f,g,x,y=!1,b=0,S=!1,E=[],D={},$;return or(e,r,function(z,re){z.initialize=function(be,Me,je,ze){if(!z.isInitialized()){re.initialize(be,Me,je,ze);var Ye=z._getTelCtx(),ct=e.getDefaultConfig();dr(ct,function(Mr,Di){l[Mr]=Ye.getConfig(e.identifier,Mr,Di)});var st=l.distributedTracingMode;if(u=l.enableRequestHeaderTracking,y=l.enableAjaxPerfTracking,b=l.maxAjaxCallsPerView,S=l.enableResponseHeaderTracking,$=l.excludeRequestFromAutoTrackingPatterns,g=st===Cn.AI||st===Cn.AI_AND_W3C,f=st===Cn.AI_AND_W3C||st===Cn.W3C,y){var Et=be.instrumentationKey||"unkwn";Et.length>5?x=Th+Et.substring(Et.length-5)+".":x=Th+Et+"."}if(l.disableAjaxTracking===!1&&oe(),ee(),je.length>0&&je){for(var Kt=void 0,nr=0;!Kt&&nr<je.length;)je[nr]&&je[nr].identifier===pa&&(Kt=je[nr]),nr++;Kt&&(p=Kt.context)}}},z.teardown=function(){_t(E,function(be){be.rm()}),E=[],o=!1,a=!1,z.setInitialized(!1)},z.trackDependencyData=function(be,Me){z[n](be,Me)},z.includeCorrelationHeaders=function(be,Me,je,ze){var Ye=z._currentWindowHost||s;if(Me){if(Wi.canIncludeCorrelationHeader(l,be.getAbsoluteUrl(),Ye)){if(je||(je={}),je.headers=new Headers(je.headers||(Me instanceof Request?Me.headers||{}:{})),g){var ct="|"+be.traceID+"."+be.spanID;je.headers.set(Gt.requestIdHeader,ct),u&&(be.requestHeaders[Gt.requestIdHeader]=ct)}var st=l.appId||p&&p.appId();if(st&&(je.headers.set(Gt.requestContextHeader,Gt.requestContextAppIdFormat+st),u&&(be.requestHeaders[Gt.requestContextHeader]=Gt.requestContextAppIdFormat+st)),f){var Et=new Ah(be.traceID,be.spanID);je.headers.set(Gt.traceParentHeader,Et.toString()),u&&(be.requestHeaders[Gt.traceParentHeader]=Et.toString())}}return je}else if(ze){if(Wi.canIncludeCorrelationHeader(l,be.getAbsoluteUrl(),Ye)){if(g){var ct="|"+be.traceID+"."+be.spanID;ze.setRequestHeader(Gt.requestIdHeader,ct),u&&(be.requestHeaders[Gt.requestIdHeader]=ct)}var st=l.appId||p&&p.appId();if(st&&(ze.setRequestHeader(Gt.requestContextHeader,Gt.requestContextAppIdFormat+st),u&&(be.requestHeaders[Gt.requestContextHeader]=Gt.requestContextAppIdFormat+st)),f){var Et=new Ah(be.traceID,be.spanID);ze.setRequestHeader(Gt.traceParentHeader,Et.toString()),u&&(be.requestHeaders[Gt.traceParentHeader]=Et.toString())}}return ze}},z[n]=function(be,Me,je){if(b===-1||d<b){(l.distributedTracingMode===Cn.W3C||l.distributedTracingMode===Cn.AI_AND_W3C)&&typeof be.id=="string"&&be.id[be.id.length-1]!=="."&&(be.id+="."),He(be.startTime)&&(be.startTime=new Date);var ze=qn.create(be,Wn.dataType,Wn.envelopeType,z[va](),Me,je);z.core.track(ze)}else d===b&&Ts(z,Fe.MaxAjaxPerPVExceeded,"Maximum ajax per page view limit reached, ajax monitoring is paused until the next trackPageView(). In order to increase the limit set the maxAjaxCallsPerView configuration parameter.",!0);++d};function ne(be){var Me=!0;return(be||l.ignoreHeaders)&&_t(l.ignoreHeaders,function(je){if(je.toLowerCase()===be.toLowerCase())return Me=!1,-1}),Me}c(ne,"Se");function ee(){var be=Kx();if(be){var Me=Ko(),je=be.polyfill;l.disableFetchTracking===!1?(E.push(Wd(Me,wa,{req:function(ze,Ye,ct){var st;if(o&&!ge(null,Ye,ct)&&!(je&&a)){var Et=ze.ctx();st=ht(Ye,ct);var Kt=z.includeCorrelationHeaders(st,Ye,ct);Kt!==ct&&ze.set(1,Kt),Et.data=st}},rsp:function(ze,Ye){var ct=ze.ctx().data;ct&&(ze.rslt=ze.rslt.then(function(st){return Ht(ze,(st||{}).status,st,ct,function(){var Et={statusText:st.statusText,headerMap:null,correlationContext:fn(st)};if(S){var Kt={};st.headers.forEach(function(nr,Mr){ne(Mr)&&(Kt[Mr]=nr)}),Et.headerMap=Kt}return Et}),st}).catch(function(st){throw Ht(ze,0,Ye,ct,null,{error:st.message}),st}))},hkErr:ks(z,Fe.FailedMonitorAjaxOpen,"Failed to monitor Window.fetch, monitoring data for this fetch call may be incorrect.")})),o=!0):je&&E.push(Wd(Me,wa,{req:function(ze,Ye,ct){ge(null,Ye,ct)}})),je&&(Me[wa].polyfill=je)}}c(ee,"X");function we(be,Me,je){E.push(Hb(be,Me,je))}c(we,"me");function oe(){Zx(z)&&!a&&(we(XMLHttpRequest,"open",{req:function(be,Me,je,ze){var Ye=be.inst,ct=Ye[Vr];!ge(Ye,je)&&Ee(Ye,!0)&&(!ct||!ct.xhrMonitoringState.openDone)&&et(Ye,Me,je,ze)},hkErr:ks(z,Fe.FailedMonitorAjaxOpen,"Failed to monitor XMLHttpRequest.open, monitoring data for this ajax call may be incorrect.")}),we(XMLHttpRequest,"send",{req:function(be,Me){var je=be.inst,ze=je[Vr];Ee(je)&&!ze.xhrMonitoringState.sendDone&&(Xe("xhr",ze),ze.requestSentTime=_s(),z.includeCorrelationHeaders(ze,void 0,void 0,je),ze.xhrMonitoringState.sendDone=!0)},hkErr:ks(z,Fe.FailedMonitorAjaxSend,"Failed to monitor XMLHttpRequest, monitoring data for this ajax call may be incorrect.")}),we(XMLHttpRequest,"abort",{req:function(be){var Me=be.inst,je=Me[Vr];Ee(Me)&&!je.xhrMonitoringState.abortDone&&(je.aborted=1,je.xhrMonitoringState.abortDone=!0)},hkErr:ks(z,Fe.FailedMonitorAjaxAbort,"Failed to monitor XMLHttpRequest.abort, monitoring data for this ajax call may be incorrect.")}),u&&we(XMLHttpRequest,"setRequestHeader",{req:function(be,Me,je){var ze=be.inst;Ee(ze)&&ne(Me)&&(ze[Vr].requestHeaders[Me]=je)},hkErr:ks(z,Fe.FailedMonitorAjaxSetRequestHeader,"Failed to monitor XMLHttpRequest.setRequestHeader, monitoring data for this ajax call may be incorrect.")}),a=!0)}c(oe,"De");function ge(be,Me,je){var ze=!1,Ye=((xt(Me)?Me:(Me||{}).url||"")||"").toLowerCase();if(_t($,function(Et){var Kt=Et;xt(Et)&&(Kt=new RegExp(Et)),ze||(ze=Kt.test(Ye))}),ze)return ze;var ct=ma(Ye,"?"),st=ma(Ye,"#");return(ct===-1||st!==-1&&st<ct)&&(ct=st),ct!==-1&&(Ye=Ye.substring(0,ct)),He(be)?He(Me)||(ze=(typeof Me=="object"?Me[yo]===!0:!1)||(je?je[yo]===!0:!1)):ze=be[yo]===!0||Ye[yo]===!0,ze?D[Ye]||(D[Ye]=1):D[Ye]&&(ze=!0),ze}c(ge,"pt");function Ee(be,Me){var je=!0,ze=a;return He(be)||(je=Me===!0||!He(be[Vr])),ze&&je}c(Ee,"at");function et(be,Me,je,ze){var Ye=p&&p.telemetryTrace&&p.telemetryTrace.traceID||Hn(),ct=Hn().substr(0,16),st=new Rh(Ye,ct,z[va]());st.method=Me,st.requestUrl=je,st.xhrMonitoringState.openDone=!0,st.requestHeaders={},st.async=ze,be[Vr]=st,ae(be)}c(et,"dt");function ae(be){be[Vr].xhrMonitoringState.stateChangeAttached=ys.Attach(be,"readystatechange",function(){try{be&&be.readyState===4&&Ee(be)&&Ne(be)}catch(je){var Me=vt(je);(!Me||ma(Me.toLowerCase(),"c00c023f")===-1)&&Ts(z,Fe.FailedMonitorAjaxRSC,"Failed to monitor XMLHttpRequest 'readystatechange' event handler, monitoring data for this ajax call may be incorrect.",{ajaxDiagnosticsMessage:Al(be),exception:Me})}})}c(ae,"d");function Re(be){try{var Me=be.responseType;if(Me===""||Me==="text")return be.responseText}catch(je){}return null}c(Re,"T");function Ne(be){var Me=be[Vr];Me.responseFinishedTime=_s(),Me.status=be.status;function je(ze,Ye){var ct=Ye||{};ct.ajaxDiagnosticsMessage=Al(be),ze&&(ct.exception=vt(ze)),Tl(z,Fe.FailedMonitorAjaxDur,"Failed to calculate the duration of the ajax call, monitoring data for this ajax call won't be sent.",ct)}c(je,"N"),it("xmlhttprequest",Me,function(){try{var ze=Me.CreateTrackItem("Ajax",u,function(){var Ye={statusText:be.statusText,headerMap:null,correlationContext:$e(be),type:be.responseType,responseText:Re(be),response:be.response};if(S){var ct=be.getAllResponseHeaders();if(ct){var st=Cr(ct).split(/[\r\n]+/),Et={};_t(st,function(Kt){var nr=Kt.split(": "),Mr=nr.shift(),Di=nr.join(": ");ne(Mr)&&(Et[Mr]=Di)}),Ye.headerMap=Et}}return Ye});ze?z[n](ze):je(null,{requestSentTime:Me.requestSentTime,responseFinishedTime:Me.responseFinishedTime})}finally{try{be[Vr]=null}catch(Ye){}}},function(ze){je(ze,null)})}c(Ne,"A");function $e(be){try{var Me=be.getAllResponseHeaders();if(Me!==null){var je=ma(Me.toLowerCase(),Gt.requestContextHeaderLowerCase);if(je!==-1){var ze=be.getResponseHeader(Gt.requestContextHeader);return Wi.getCorrelationContext(ze)}}}catch(Ye){Tl(z,Fe.FailedMonitorAjaxGetCorrelationHeader,"Failed to get Request-Context correlation header as it may be not included in the response or not accessible.",{ajaxDiagnosticsMessage:Al(be),exception:vt(Ye)})}}c($e,"D");function Xe(be,Me){if(Me.requestUrl&&x&&y){var je=hi();if(je&&Tt(je.mark)){Ih++;var ze=x+be+"#"+Ih;je.mark(ze);var Ye=je.getEntriesByName(ze);Ye&&Ye.length===1&&(Me.perfMark=Ye[0])}}}c(Xe,"z");function it(be,Me,je,ze){var Ye=Me.perfMark,ct=hi(),st=l.maxAjaxPerfLookupAttempts,Et=l.ajaxPerfLookupDelay,Kt=Me.requestUrl,nr=0;c(function Mr(){try{if(ct&&Ye){nr++;for(var Di=null,bu=ct.getEntries(),Ha=bu.length-1;Ha>=0;Ha--){var pn=bu[Ha];if(pn){if(pn.entryType==="resource")pn.initiatorType===be&&(ma(pn.name,Kt)!==-1||ma(Kt,pn.name)!==-1)&&(Di=pn);else if(pn.entryType==="mark"&&pn.name===Ye.name){Me.perfTiming=Di;break}if(pn.startTime<Ye.startTime-1e3)break}}}!Ye||Me.perfTiming||nr>=st||Me.async===!1?(Ye&&Tt(ct.clearMarks)&&ct.clearMarks(Ye.name),Me.perfAttempts=nr,je()):setTimeout(Mr,Et)}catch(fp){ze(fp)}},"We")()}c(it,"U");function ht(be,Me){var je=p&&p.telemetryTrace&&p.telemetryTrace.traceID||Hn(),ze=Hn().substr(0,16),Ye=new Rh(je,ze,z[va]());Ye.requestSentTime=_s(),be instanceof Request?Ye.requestUrl=be?be.url:"":Ye.requestUrl=be;var ct="GET";Me&&Me.method?ct=Me.method:be&&be instanceof Request&&(ct=be.method),Ye.method=ct;var st={};if(u){var Et=new Headers((Me?Me.headers:0)||(be instanceof Request?be.headers||{}:{}));Et.forEach(function(Kt,nr){ne(nr)&&(st[nr]=Kt)})}return Ye.requestHeaders=st,Xe("fetch",Ye),Ye}c(ht,"q");function Ct(be){var Me="";try{He(be)||(typeof be=="string"?Me+="(url: '"+be+"')":Me+="(url: '"+be.url+"')")}catch(je){Ts(z,Fe.FailedMonitorAjaxOpen,"Failed to grab failed fetch diagnostics message",{exception:vt(je)})}return Me}c(Ct,"$");function Ht(be,Me,je,ze,Ye,ct){if(!ze)return;function st(Et,Kt,nr){var Mr=nr||{};Mr.fetchDiagnosticsMessage=Ct(je),Kt&&(Mr.exception=vt(Kt)),Tl(z,Et,"Failed to calculate the duration of the fetch call, monitoring data for this fetch call won't be sent.",Mr)}c(st,"B"),ze.responseFinishedTime=_s(),ze.status=Me,it("fetch",ze,function(){var Et=ze.CreateTrackItem("Fetch",u,Ye);Et?z[n](Et):st(Fe.FailedMonitorAjaxDur,null,{requestSentTime:ze.requestSentTime,responseFinishedTime:ze.responseFinishedTime})},function(Et){st(Fe.FailedMonitorAjaxGetCorrelationHeader,Et,null)})}c(Ht,"ie");function fn(be){if(be&&be.headers)try{var Me=be.headers.get(Gt.requestContextHeader);return Wi.getCorrelationContext(Me)}catch(je){Tl(z,Fe.FailedMonitorAjaxGetCorrelationHeader,"Failed to get Request-Context correlation header as it may be not included in the response or not accessible.",{fetchDiagnosticsMessage:Ct(be),exception:vt(je)})}}c(fn,"Ht")}),r}return c(e,"e"),e.getDefaultConfig=function(){var r={maxAjaxCallsPerView:500,disableAjaxTracking:!1,disableFetchTracking:!0,excludeRequestFromAutoTrackingPatterns:void 0,disableCorrelationHeaders:!1,distributedTracingMode:Cn.AI_AND_W3C,correlationHeaderExcludedDomains:["*.blob.core.windows.net","*.blob.core.chinacloudapi.cn","*.blob.core.cloudapi.de","*.blob.core.usgovcloudapi.net"],correlationHeaderDomains:void 0,correlationHeaderExcludePatterns:void 0,appId:void 0,enableCorsCorrelation:!1,enableRequestHeaderTracking:!1,enableResponseHeaderTracking:!1,enableAjaxErrorStatusText:!1,enableAjaxPerfTracking:!1,maxAjaxPerfLookupAttempts:3,ajaxPerfLookupDelay:25,ignoreHeaders:["Authorization","X-API-Key","WWW-Authenticate"]};return r},e.getEmptyConfig=function(){var r=this.getDefaultConfig();return dr(r,function(n){r[n]=void 0}),r},e.prototype.processTelemetry=function(r,n){this.processNext(r,n)},e.identifier="AjaxDependencyPlugin",e}(mo)}),s0=Te(()=>{Xx()}),Ph,Fh,c0,l0,$h,u0=Te(()=>{St(),Dm(),jm(),i0(),s0(),hr(),Fh=["snippet","dependencies","properties","_snippetVersion","appInsightsNew","getSKUDefaults"],c0={Default:0,Required:1,Array:2,Hidden:4},l0={__proto__:null,PropertiesPluginIdentifier:pa,BreezeChannelIdentifier:Sl,AnalyticsPluginIdentifier:mh,Util:ih,CorrelationIdHelper:Wi,UrlHelper:tm,DateTimeUtils:rm,ConnectionStringParser:sm,FieldType:c0,RequestHeaders:Gt,DisabledPropertyName:yo,ProcessLegacy:la,SampleRate:ul,HttpMethod:dl,DEFAULT_BREEZE_ENDPOINT:Qd,AIData:ah,AIBase:oh,Envelope:sh,Event:En,Exception:Hr,Metric:zn,PageView:Rn,PageViewData:bl,RemoteDependencyData:Wn,Trace:mi,PageViewPerformance:vi,Data:wi,SeverityLevel:Ss,ConfigurationManager:Em,ContextTagKeys:_l,DataSanitizer:Og,TelemetryItemCreator:qn,CtxTagKeys:qt,Extensions:zr,DistributedTracingModes:Cn},$h=function(){function t(e){var r=this;r._snippetVersion=""+(e.sv||e.version||""),e.queue=e.queue||[],e.version=e.version||2;var n=e.config||{};if(n.connectionString){var i=im(n.connectionString),o=i.ingestionendpoint;n.endpointUrl=o?o+"/v2/track":n.endpointUrl,n.instrumentationKey=i.instrumentationkey||n.instrumentationKey}r.appInsights=new wh,r.properties=new Eh,r.dependencies=new Dh,r.core=new Od,r._sender=new Sh,r.snippet=e,r.config=n,r.getSKUDefaults()}return c(t,"t"),t.prototype.getCookieMgr=function(){return this.appInsights.getCookieMgr()},t.prototype.trackEvent=function(e,r){this.appInsights.trackEvent(e,r)},t.prototype.trackPageView=function(e){var r=e||{};this.appInsights.trackPageView(r)},t.prototype.trackPageViewPerformance=function(e){var r=e||{};this.appInsights.trackPageViewPerformance(r)},t.prototype.trackException=function(e){e&&!e.exception&&e.error&&(e.exception=e.error),this.appInsights.trackException(e)},t.prototype._onerror=function(e){this.appInsights._onerror(e)},t.prototype.trackTrace=function(e,r){this.appInsights.trackTrace(e,r)},t.prototype.trackMetric=function(e,r){this.appInsights.trackMetric(e,r)},t.prototype.startTrackPage=function(e){this.appInsights.startTrackPage(e)},t.prototype.stopTrackPage=function(e,r,n,i){this.appInsights.stopTrackPage(e,r,n,i)},t.prototype.startTrackEvent=function(e){this.appInsights.startTrackEvent(e)},t.prototype.stopTrackEvent=function(e,r,n){this.appInsights.stopTrackEvent(e,r,n)},t.prototype.addTelemetryInitializer=function(e){return this.appInsights.addTelemetryInitializer(e)},t.prototype.setAuthenticatedUserContext=function(e,r,n){n===void 0&&(n=!1),this.properties.context.user.setAuthenticatedUserContext(e,r,n)},t.prototype.clearAuthenticatedUserContext=function(){this.properties.context.user.clearAuthenticatedUserContext()},t.prototype.trackDependencyData=function(e){this.dependencies.trackDependencyData(e)},t.prototype.flush=function(e){var r=this;e===void 0&&(e=!0),ta(this.core,function(){return"AISKU.flush"},function(){_t(r.core.getTransmissionControls(),function(n){_t(n,function(i){i.flush(e)})})},null,e)},t.prototype.onunloadFlush=function(e){e===void 0&&(e=!0),_t(this.core.getTransmissionControls(),function(r){_t(r,function(n){n.onunloadFlush?n.onunloadFlush():n.flush(e)})})},t.prototype.loadAppInsights=function(e,r,n){var i=this;e===void 0&&(e=!1);var o=this;function a(s){if(s){var l="";He(o._snippetVersion)||(l+=o._snippetVersion),e&&(l+=".lg"),o.context&&o.context.internal&&(o.context.internal.snippetVer=l||"-"),dr(o,function(u,d){xt(u)&&!Tt(d)&&u&&u[0]!=="_"&&Fh.indexOf(u)===-1&&(s[u]=d)})}}return c(a,"o"),e&&o.config.extensions&&o.config.extensions.length>0&&On("Extensions not allowed in legacy mode"),ta(o.core,function(){return"AISKU.loadAppInsights"},function(){var s=[];s.push(o._sender),s.push(o.properties),s.push(o.dependencies),s.push(o.appInsights),o.core.initialize(o.config,s,r,n),o.context=o.properties.context,Ph&&o.context&&(o.context.internal.sdkSrc=Ph),a(o.snippet),o.emptyQueue(),o.pollInternalLogs(),o.addHousekeepingBeforeUnload(i)}),o},t.prototype.updateSnippetDefinitions=function(e){Hp(e,this,function(r){return r&&Fh.indexOf(r)===-1})},t.prototype.emptyQueue=function(){var e=this;try{if(di(e.snippet.queue)){for(var r=e.snippet.queue.length,n=0;n<r;n++){var i=e.snippet.queue[n];i()}e.snippet.queue=void 0,delete e.snippet.queue}}catch(a){var o={};a&&Tt(a.toString)&&(o.exception=a.toString())}},t.prototype.pollInternalLogs=function(){this.core.pollInternalLogs()},t.prototype.addHousekeepingBeforeUnload=function(e){if(jc()||qp()){var r=c(function(){e.onunloadFlush(!1),_t(e.appInsights.core._extensions,function(i){if(i.identifier===pa)return i&&i.context&&i.context._sessionManager&&i.context._sessionManager.backup(),-1})},"r");if(!e.appInsights.config.disableFlushOnBeforeUnload){var n=wo("beforeunload",r);n=wo("unload",r)||n,n=wo("pagehide",r)||n,n=wo("visibilitychange",r)||n,!n&&!Sb()&&e.appInsights.core.logger.throwInternal(Le.CRITICAL,Fe.FailedToAddHandlerForOnBeforeUnload,"Could not add handler for beforeunload and pagehide")}e.appInsights.config.disableFlushOnUnload||(wo("pagehide",r),wo("visibilitychange",r))}},t.prototype.getSender=function(){return this._sender},t.prototype.getSKUDefaults=function(){var e=this;e.config.diagnosticLogInterval=e.config.diagnosticLogInterval&&e.config.diagnosticLogInterval>0?e.config.diagnosticLogInterval:1e4},t}(),function(){var t=null,e=!1,r=["://js.monitor.azure.com/","://az416426.vo.msecnd.net/"];try{var n=(document||{}).currentScript;n&&(t=n.src)}catch(s){}if(t)try{var i=t.toLowerCase();if(i){for(var o="",a=0;a<r.length;a++)if(i.indexOf(r[a])!==-1){o="cdn"+(a+1),i.indexOf("/scripts/")===-1&&(i.indexOf("/next/")!==-1?o+="-next":i.indexOf("/beta/")!==-1&&(o+="-beta")),Ph=o+(e?".mod":"");break}}}catch(s){}}()}),d0,h0,Qx=Te(()=>{hr(),St(),d0=["snippet","getDefaultConfig","_hasLegacyInitializers","_queue","_processLegacyInitializers"],h0=function(){function t(e,r){this._hasLegacyInitializers=!1,this._queue=[],this.config=t.getDefaultConfig(e.config),this.appInsightsNew=r,this.context={addTelemetryInitializer:this.addTelemetryInitializers.bind(this)}}return c(t,"t"),t.getDefaultConfig=function(e){return e||(e={}),e.endpointUrl=e.endpointUrl||"https://dc.services.visualstudio.com/v2/track",e.sessionRenewalMs=30*60*1e3,e.sessionExpirationMs=24*60*60*1e3,e.maxBatchSizeInBytes=e.maxBatchSizeInBytes>0?e.maxBatchSizeInBytes:102400,e.maxBatchInterval=isNaN(e.maxBatchInterval)?15e3:e.maxBatchInterval,e.enableDebug=Lt(e.enableDebug),e.disableExceptionTracking=Lt(e.disableExceptionTracking),e.disableTelemetry=Lt(e.disableTelemetry),e.verboseLogging=Lt(e.verboseLogging),e.emitLineDelimitedJson=Lt(e.emitLineDelimitedJson),e.diagnosticLogInterval=e.diagnosticLogInterval||1e4,e.autoTrackPageVisitTime=Lt(e.autoTrackPageVisitTime),(isNaN(e.samplingPercentage)||e.samplingPercentage<=0||e.samplingPercentage>=100)&&(e.samplingPercentage=100),e.disableAjaxTracking=Lt(e.disableAjaxTracking),e.maxAjaxCallsPerView=isNaN(e.maxAjaxCallsPerView)?500:e.maxAjaxCallsPerView,e.isBeaconApiDisabled=Lt(e.isBeaconApiDisabled,!0),e.disableCorrelationHeaders=Lt(e.disableCorrelationHeaders),e.correlationHeaderExcludedDomains=e.correlationHeaderExcludedDomains||["*.blob.core.windows.net","*.blob.core.chinacloudapi.cn","*.blob.core.cloudapi.de","*.blob.core.usgovcloudapi.net"],e.disableFlushOnBeforeUnload=Lt(e.disableFlushOnBeforeUnload),e.disableFlushOnUnload=Lt(e.disableFlushOnUnload,e.disableFlushOnBeforeUnload),e.enableSessionStorageBuffer=Lt(e.enableSessionStorageBuffer,!0),e.isRetryDisabled=Lt(e.isRetryDisabled),e.isCookieUseDisabled=Lt(e.isCookieUseDisabled),e.isStorageUseDisabled=Lt(e.isStorageUseDisabled),e.isBrowserLinkTrackingEnabled=Lt(e.isBrowserLinkTrackingEnabled),e.enableCorsCorrelation=Lt(e.enableCorsCorrelation),e},t.prototype.addTelemetryInitializers=function(e){var r=this;this._hasLegacyInitializers||(this.appInsightsNew.addTelemetryInitializer(function(n){r._processLegacyInitializers(n)}),this._hasLegacyInitializers=!0),this._queue.push(e)},t.prototype.getCookieMgr=function(){return this.appInsightsNew.getCookieMgr()},t.prototype.startTrackPage=function(e){this.appInsightsNew.startTrackPage(e)},t.prototype.stopTrackPage=function(e,r,n,i){this.appInsightsNew.stopTrackPage(e,r,n)},t.prototype.trackPageView=function(e,r,n,i,o){var a={name:e,uri:r,properties:n,measurements:i};this.appInsightsNew.trackPageView(a)},t.prototype.trackEvent=function(e,r,n){this.appInsightsNew.trackEvent({name:e})},t.prototype.trackDependency=function(e,r,n,i,o,a,s){this.appInsightsNew.trackDependencyData({id:e,target:n,type:i,duration:o,properties:{HttpMethod:r},success:a,responseCode:s})},t.prototype.trackException=function(e,r,n,i,o){this.appInsightsNew.trackException({exception:e})},t.prototype.trackMetric=function(e,r,n,i,o,a){this.appInsightsNew.trackMetric({name:e,average:r,sampleCount:n,min:i,max:o})},t.prototype.trackTrace=function(e,r,n){this.appInsightsNew.trackTrace({message:e,severityLevel:n})},t.prototype.flush=function(e){this.appInsightsNew.flush(e)},t.prototype.setAuthenticatedUserContext=function(e,r,n){this.appInsightsNew.context.user.setAuthenticatedUserContext(e,r,n)},t.prototype.clearAuthenticatedUserContext=function(){this.appInsightsNew.context.user.clearAuthenticatedUserContext()},t.prototype._onerror=function(e,r,n,i,o){this.appInsightsNew._onerror({message:e,url:r,lineNumber:n,columnNumber:i,error:o})},t.prototype.startTrackEvent=function(e){this.appInsightsNew.startTrackEvent(e)},t.prototype.stopTrackEvent=function(e,r,n){this.appInsightsNew.stopTrackEvent(e,r,n)},t.prototype.downloadAndSetup=function(e){On("downloadAndSetup not implemented in web SKU")},t.prototype.updateSnippetDefinitions=function(e){Hp(e,this,function(r){return r&&d0.indexOf(r)===-1})},t.prototype.loadAppInsights=function(){var e=this;if(this.config.iKey){var r=this.trackPageView;this.trackPageView=function(o,a,s){r.apply(e,[null,o,a,s])}}var n="logPageView";typeof this.snippet[n]=="function"&&(this[n]=function(o,a,s){e.trackPageView(null,o,a,s)});var i="logEvent";return typeof this.snippet[i]=="function"&&(this[i]=function(o,a,s){e.trackEvent(o,a,s)}),this},t.prototype._processLegacyInitializers=function(e){return e.tags[la]=this._queue,e},t}()}),f0,Yx=Te(()=>{Qx(),u0(),St(),f0=function(){function t(){}return c(t,"t"),t.getAppInsights=function(e,r){var n=new $h(e),i=r!==2;if(aa(),r===2)return n.updateSnippetDefinitions(e),n.loadAppInsights(i),n;var o=new h0(e,n);return o.updateSnippetDefinitions(e),n.loadAppInsights(i),o},t}()}),p0={};Yy(p0,{AppInsightsCore:()=>Od,ApplicationAnalytics:()=>wh,ApplicationInsights:()=>$h,ApplicationInsightsContainer:()=>f0,BaseCore:()=>Md,BaseTelemetryPlugin:()=>mo,CoreUtils:()=>cl,DependenciesPlugin:()=>Dh,DistributedTracingModes:()=>Cn,Event:()=>En,Exception:()=>Hr,LoggingSeverity:()=>Le,Metric:()=>zn,NotificationManager:()=>Bd,PageView:()=>Rn,PageViewPerformance:()=>vi,PerfEvent:()=>ra,PerfManager:()=>yd,PropertiesPlugin:()=>Eh,RemoteDependencyData:()=>Wn,Sender:()=>Sh,SeverityLevel:()=>Ss,Telemetry:()=>l0,Trace:()=>mi,Util:()=>ih,_InternalMessageId:()=>Fe,doPerf:()=>ta});var Jx=Te(()=>{u0(),Yx(),St(),hr(),jm(),Dm(),i0(),s0()}),an;(function(t){t.ON="on",t.ERROR="error",t.OFF="off"})(an||(an={}));function Nh(){let t="telemetry",e="enableTelemetry";return h.env.isTelemetryEnabled!==void 0?h.env.isTelemetryEnabled?an.ON:an.OFF:h.workspace.getConfiguration(t).get(e)?an.ON:an.OFF}c(Nh,"jr");var e_=c(class{constructor(t,e,r,n,i){this.extensionId=t,this.extensionVersion=e,this.telemetryAppender=r,this.osShim=n,this.firstParty=!1,this.userOptIn=!1,this.errorOptIn=!1,this.disposables=[],this.firstParty=!!i,this.updateUserOptStatus(),h.env.onDidChangeTelemetryEnabled!==void 0?(this.disposables.push(h.env.onDidChangeTelemetryEnabled(()=>this.updateUserOptStatus())),this.disposables.push(h.workspace.onDidChangeConfiguration(()=>this.updateUserOptStatus()))):this.disposables.push(h.workspace.onDidChangeConfiguration(()=>this.updateUserOptStatus()))}updateUserOptStatus(){let t=Nh();this.userOptIn=t===an.ON,this.errorOptIn=t===an.ERROR||t===an.ON,(this.userOptIn||this.errorOptIn)&&this.telemetryAppender.instantiateAppender()}cleanRemoteName(t){if(!t)return"none";let e="other";return["ssh-remote","dev-container","attached-container","wsl"].forEach(r=>{t.indexOf(`${r}+`)===0&&(e=r)}),e}get extension(){return this._extension===void 0&&(this._extension=h.extensions.getExtension(this.extensionId)),this._extension}cloneAndChange(t,e){if(t===null||typeof t!="object"||typeof e!="function")return t;let r={};for(let n in t)r[n]=e(n,t[n]);return r}shouldSendErrorTelemetry(){return this.errorOptIn===!1?!1:this.firstParty?this.cleanRemoteName(h.env.remoteName)!=="other"?!0:!(this.extension===void 0||this.extension.extensionKind===h.ExtensionKind.Workspace||h.env.uiKind===h.UIKind.Web):!0}getCommonProperties(){let t=Object.create(null);if(t["common.os"]=this.osShim.platform,t["common.platformversion"]=(this.osShim.release||"").replace(/^(\d+)(\.\d+)?(\.\d+)?(.*)/,"$1$2$3"),t["common.extname"]=this.extensionId,t["common.extversion"]=this.extensionVersion,h&&h.env){switch(t["common.vscodemachineid"]=h.env.machineId,t["common.vscodesessionid"]=h.env.sessionId,t["common.vscodeversion"]=h.version,t["common.isnewappinstall"]=h.env.isNewAppInstall?h.env.isNewAppInstall.toString():"false",t["common.product"]=h.env.appHost,h.env.uiKind){case h.UIKind.Web:t["common.uikind"]="web";break;case h.UIKind.Desktop:t["common.uikind"]="desktop";break;default:t["common.uikind"]="unknown"}t["common.remotename"]=this.cleanRemoteName(h.env.remoteName)}return t}anonymizeFilePaths(t,e){let r;if(t==null)return"";let n=[];h.env.appRoot!==""&&n.push(new RegExp(h.env.appRoot.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi")),this.extension&&n.push(new RegExp(this.extension.extensionPath.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi"));let i=t;if(e){let o=[];for(let u of n)for(;(r=u.exec(t))&&r;)o.push([r.index,u.lastIndex]);let a=/^[\\/]?(node_modules|node_modules\.asar)[\\/]/,s=/(file:\/\/)?([a-zA-Z]:(\\\\|\\|\/)|(\\\\|\\|\/))?([\w-._]+(\\\\|\\|\/))+[\w-._]*/g,l=0;for(i="";(r=s.exec(t))&&r;)r[0]&&!a.test(r[0])&&o.every(([u,d])=>r.index<u||r.index>=d)&&(i+=t.substring(l,r.index)+"<REDACTED: user-file-path>",l=s.lastIndex);l<t.length&&(i+=t.substr(l))}for(let o of n)i=i.replace(o,"");return i}removePropertiesWithPossibleUserInfo(t){if(typeof t!="object")return;let e=Object.create(null);for(let r of Object.keys(t)){let n=t[r];if(!n)continue;let i=/@[a-zA-Z0-9-.]+/;/\S*(key|token|sig|password|passwd|pwd)[="':\s]+\S*/.test(n.toLowerCase())?e[r]="<REDACTED: secret>":i.test(n)?e[r]="<REDACTED: email>":e[r]=n}return e}sendTelemetryEvent(t,e,r){if(this.userOptIn&&t!==""){e={...e,...this.getCommonProperties()};let n=this.cloneAndChange(e,(i,o)=>this.anonymizeFilePaths(o,this.firstParty));this.telemetryAppender.logEvent(`${this.extensionId}/${t}`,{properties:this.removePropertiesWithPossibleUserInfo(n),measurements:r})}}sendTelemetryErrorEvent(t,e,r,n){if(this.errorOptIn&&t!==""){e={...e,...this.getCommonProperties()};let i=this.cloneAndChange(e,(o,a)=>this.shouldSendErrorTelemetry()?this.anonymizeFilePaths(a,this.firstParty):n===void 0||n.indexOf(o)!==-1?"REDACTED":this.anonymizeFilePaths(a,this.firstParty));this.telemetryAppender.logEvent(`${this.extensionId}/${t}`,{properties:this.removePropertiesWithPossibleUserInfo(i),measurements:r})}}sendTelemetryException(t,e,r){if(this.shouldSendErrorTelemetry()&&this.errorOptIn&&t){e={...e,...this.getCommonProperties()};let n=this.cloneAndChange(e,(i,o)=>this.anonymizeFilePaths(o,this.firstParty));t.stack&&(t.stack=this.anonymizeFilePaths(t.stack,this.firstParty)),this.telemetryAppender.logException(t,{properties:this.removePropertiesWithPossibleUserInfo(n),measurements:r})}}dispose(){return this.telemetryAppender.flush(),Promise.all(this.disposables.map(t=>t.dispose()))}},"bi"),t_=c(class{constructor(t){this._key=t,this._isInstantiated=!1,Nh()!==an.OFF&&this.instantiateAppender()}logEvent(t,e){!this._aiClient||this._aiClient.trackEvent({name:t},{...e.properties,...e.measurements})}logException(t,e){!this._aiClient||this._aiClient.trackException({exception:t,properties:{...e.properties,...e.measurements}})}flush(){return this._aiClient&&(this._aiClient.flush(),this._aiClient=void 0),Promise.resolve(void 0)}instantiateAppender(){this._isInstantiated||Promise.resolve().then(()=>(Jx(),p0)).then(t=>{let e;this._key&&this._key.indexOf("AIF-")===0&&(e="https://vortex.data.microsoft.com/collect/v1"),this._aiClient=new t.ApplicationInsights({config:{instrumentationKey:this._key,endpointUrl:e,disableAjaxTracking:!0,disableExceptionTracking:!0,disableFetchTracking:!0,disableCorrelationHeaders:!0,disableCookiesUsage:!0,autoTrackPageVisitTime:!1,emitLineDelimitedJson:!0,disableInstrumentationKeyValidation:!0}}),this._aiClient.loadAppInsights();let r=Nh();e&&(r===an.ON||r===an.ERROR)&&fetch(e).catch(()=>this._aiClient=void 0),this._isInstantiated=!0})}},"du"),r_=c(class extends e_{constructor(t,e,r,n){let i=new t_(r);r&&r.indexOf("AIF-")===0&&(n=!0);super(t,e,i,{release:navigator.appVersion,platform:"web"},n)}},"mu");/*!
 * Microsoft Dynamic Proto Utility, 1.1.4
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */const n_="Type of classified event does not match event properties",Mh=c(class{constructor(t){this.sharedProperties={},Mh._instance=this,this.reporter=new r_(t.extension.id,t.extension.packageJSON.version,Mh.aiKey,!0)}static get instance(){return this._instance}dispose(){this.reporter.dispose()}publicLog2(t,e){e!==n_&&this.reporter.sendTelemetryEvent(t,{...this.sharedProperties,...e})}sendEvent(t,e,r){this.reporter.sendTelemetryEvent(t,{...this.sharedProperties,...e},r)}sendErrorEvent(t,e,r){this.reporter.sendTelemetryErrorEvent(t,{...this.sharedProperties,...e},r)}sendException(t,e,r){this.reporter.sendTelemetryException(t,{...this.sharedProperties,...e},r)}setSharedProperty(t,e){this.sharedProperties[t]=e}},"_TelemetryService");let Is=Mh;Is.aiKey="AIF-d9b70cd4-b9f9-4d70-929b-a071c400b217";function i_(t,e){h.env.appHost==="github.dev"&&(C.debug(`Executing ${t}`),e={...e,errorDetail:e.errorDetail instanceof Error?e.errorDetail.name:void 0},h.commands.executeCommand(t,e).then(r=>{},r=>{C.debug(`Failed to execute ${t}`,r)}))}c(i_,"reportWorkbenchLoadResult");const kl=(0,A.loadMessageBundle)();let An;var Bh;(function(t){function e(r){const n=s_(r);return An=h.env.uiKind===h.UIKind.Web,C.warn(`Running on the ${An?"web":"desktop"}${r.extensionRuntime!==h.ExtensionRuntime.Node?" in a webworker":""}; workspaceId=${n}; storageUri=${r.globalStorageUri.toString(!0)}`),n}c(e,"configure"),t.configure=e})(Bh||(Bh={}));function o_(){var t,e;return(e=(t=h.workspace.workspaceFolders)==null?void 0:t.every(r=>r.uri.scheme===Dt.scheme))!=null?e:!1}c(o_,"isVirtualWorkspace");var $t;(function(t){t.CurrentWindow="currentWindow",t.NewWindow="newWindow",t.AddToWorkspace="addToWorkspace"})($t||($t={}));const a_=/\/workspaceStorage\/(?<id>[^/]+)/i;function s_(t){var e;if(t.storageUri===void 0)return"";const r=a_.exec(t.storageUri.path);let n;if((e=r==null?void 0:r.groups)==null?void 0:e.id)n=r.groups.id;else{n=t.storageUri.path;const i=vn(t.globalStorageUri.path,n),o=`/${t.extension.id}`;n.endsWith(o)?n=n.slice(i,-o.length):n=n.substr(i)}return/-[0-9]$/.test(n)?n.slice(0,-2):n}c(s_,"getWorkspaceId");async function sn(t,e){var r,n,i,o,a;if(Is.instance.sendEvent("openWorkspace",{location:t.location}),t.location===$t.AddToWorkspace){const l=(n=(r=h.workspace.workspaceFolders)==null?void 0:r.length)!=null?n:0;return void h.workspace.updateWorkspaceFolders(l,0,{uri:t.uri,name:t.name})}if(t.location===$t.CurrentWindow&&!(e==null?void 0:e.skipChangesPrompt)){const l=await ns.instance.getWorkspaceProvidersWithChanges();if(l.length){const u={title:kl("continue","Continue")},d={title:kl("cancel","Cancel"),isCloseAffordance:!0};if(await h.window.showWarningMessage(An?kl("open folder uncommitted changes web",`You have uncommitted changes.

If you want to see your changes on {0} or from other browsers or machines, commit them before leaving this workspace. Otherwise, you can re-open this workspace anytime and pick up right where you left off.

Do you want to continue opening a new workspace?`,l.map(f=>f.name).join(", ")):kl("open folder uncommitted changes",`You have uncommitted changes.

If you want to see your changes on {0} or from other machines, commit them before leaving this workspace. Otherwise, you can re-open this workspace anytime and pick up right where you left off.

Do you want to continue opening a new workspace?`,l.map(f=>f.name).join(", ")),{modal:!0,useCustom:!0},u,d)!==u){Is.instance.sendEvent("openWorkspace.abort",{reason:"abandoned uncommitted changes prompt"});return}}}const s=h.env.remoteName?!0:void 0;return t.filesToOpen&&(t.location===$t.CurrentWindow&&s===void 0&&((i=h.workspace.workspaceFolders)==null?void 0:i.length)===1&&h.workspace.workspaceFolders[0].uri.toString()===t.uri.toString()?await((o=yu())==null?void 0:o.openPendingFiles(t.uri,t.filesToOpen)):await((a=yu())==null?void 0:a.setPendingFilesToOpen(t.uri,t.filesToOpen))),Is.instance.sendEvent("openWorkspace.success",{location:t.location,forceLocalWindow:String(s)}),void h.commands.executeCommand("vscode.openFolder",t.uri,{forceNewWindow:t.location===$t.NewWindow,forceLocalWindow:s})}c(sn,"openWorkspace");var jn;(function(t){t.HasVirtualFolders="remoteHub:hasVirtualFolders",t.HasSearchIndexes="remoteHub:hasSearchIndexes",t.EnabledSomeSearchIndexes="remoteHub:enabledSomeSearchIndexes",t.EnabledAllSearchIndexes="remoteHub:enabledAllSearchIndexes",t.VirtualFolderProviders="remoteHub:virtualFolderProviders",t.HasPullRequestExtension="remoteHub:hasPullRequestExtension",t.HasWriteableScmProvider="remoteHub:hasWriteableScmProvider",t.HasRecentRepositories="remoteHub:hasRecentRepositories"})(jn||(jn={}));const g0=new Map;function ya(t){return t==="isWeb"?An:t==="remoteName"?h.env.remoteName:t==="virtualWorkspace"?o_():t.startsWith("config.")?P.getAny(t.substr(7)):g0.get(t)}c(ya,"getContext");function ba(t){return t==="isWeb"||t==="remoteName"||t==="virtualWorkspace"||t.startsWith("config.")||t.startsWith("remoteHub:")||t.startsWith("continueOn:")}c(ba,"isSupportedContextKey");async function bi(t,e){g0.set(t,e),!t.startsWith("continueOn:")&&await h.commands.executeCommand("setContext",t,e)}c(bi,"setContext");class m0{constructor(e){this.menuItem=e}get label(){return`${this.menuItem.icon?`${this.menuItem.icon} `:""}${this.menuItem.title}`}get description(){return this.menuItem.extension.builtin?"Built-in":this.menuItem.extension.name||this.menuItem.extension.id}async execute(e){return void await h.commands.executeCommand(this.menuItem.command,e)}}c(m0,"ContinueOnCommandQuickPickItem");var Oh;(function(t){async function e(r,n,i){const o=c_(r).map(l=>new m0(l)),a=h.window.createQuickPick(),s=[];try{return await new Promise(u=>{s.push(a.onDidHide(()=>u(void 0)),a.onDidAccept(()=>{if(a.activeItems.length!==0){const[d]=a.activeItems;u(d)}})),a.title=i,a.placeholder=n,a.items=o,a.show()})}finally{a.dispose(),s.forEach(l=>void l.dispose())}}c(e,"show"),t.show=e})(Oh||(Oh={}));function c_(t){var e,r,n,i,o;const a=new Map,[,s]=t.split(".");for(const u of h.extensions.all){const{name:d,displayName:p,contributes:f}=u.packageJSON;if(!f)continue;const g=(r=(e=f.virtualWorkspaces)==null?void 0:e.menus)==null?void 0:r.continueOn;if(g==null?void 0:g.length){const x=new Map(((n=f.commands)!=null?n:[]).map(y=>[y.command,y]));for(const y of g){if(!y.command)continue;if(a.has(y.command)){C.warn(`Duplicate 'continueOn' menu command: ${y.command}`);continue}const b=x.get(y.command);if(!b){C.warn(`Unable to find 'continueOn' menu command: ${y.command}`);continue}if(!l_(y.when))continue;const S=(o=(i=y.group)==null?void 0:i.lastIndexOf("@"))!=null?o:-1;a.set(y.command,{extension:{id:d,name:p,builtin:d===s},command:b.command,title:b.title,icon:typeof b.icon=="string"?b.icon:void 0,group:S>0?y.group.substr(0,S):y.group,order:S>0?Number(y.group.substr(S+1)):0,category:b.category})}}}function l(u,d){const p=u.group,f=d.group;if(p!==f){if(!p)return 1;if(!f||p==="navigation")return-1;if(f==="navigation")return 1;const g=p.localeCompare(f);if(g!==0)return g}return u.order<d.order?-1:u.order>d.order?1:u.title.localeCompare(d.title)}return c(l,"compareMenuItems"),[...a.values()].sort(l)}c(c_,"getContinueOnContributions");function l_(t){return t?t.split("&&").every(e=>{const r=/^(?:(!)?(\S+)|(\S+)\s?(==|!=|=~)\s?(\S+))$/.exec(e.trim());if(!r)return!0;const[,n,i,o,a,s]=r;if(i){if(i==="false")return!1;if(!ba(i))return!0;const l=ya(i);return n?!l:l}if(o&&a&&s)switch(a){case"==":return!ba(o)||!ba(s)||ya(o)==ya(s);case"!=":return!ba(o)||!ba(s)||ya(o)!=ya(s);case"=~":{if(!ba(o))return!0;const l=ya(o);try{return new RegExp(s.slice(1,-1)).test(String(l!=null?l:""))}catch{return!1}}}return!0}):!0}c(l_,"evaluateWhenClause");class Il{constructor(e){this.defaultDelay=e}dispose(){this.cancelTimeout()}debounce(e,r=this.defaultDelay){return this.task=e,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((n,i)=>{this.resolver=n,this.rejecter=i}).then(()=>{if(this.completionPromise=void 0,this.resolver=void 0,this.task){const n=this.task;return this.task=void 0,n()}})),this.timeout=setTimeout(()=>{var n;this.timeout=void 0,(n=this.resolver)==null||n.call(this,void 0)},r),this.completionPromise}cancel(){var e;this.cancelTimeout(),this.completionPromise&&((e=this.rejecter)==null||e.call(this,new Error("Canceled")),this.completionPromise=void 0)}cancelTimeout(){this.timeout!==void 0&&(clearTimeout(this.timeout),this.timeout=void 0)}}c(Il,"TaskDebouncer");const xi=(0,A.loadMessageBundle)(),Uh=Symbol("QuickPickGoBack");var Lh;(function(t){async function e(r,n,i,o,a,s){const l=r.getRemoteWorkspaceSourceProviders();let u=[];l.length===0?u=[]:u=l.map(x=>new Hh(x));const d=await n.getRemoteWorkspaceSourceProvider();if(d){const x=await d.provideSources();x&&u.push(...x.filter(y=>P.get("azureRepos.enabled")?!0:y.providerId==="github").map(y=>({label:`${y.icon?`${y.icon} `:""}${y.name}`,description:y.description,detail:y.detail,url:y.url,workspace:y.url?void 0:y.workspace,buttons:[Tn.OpenInNewWindow]})))}const p=h.window.createQuickPick();p.ignoreFocusOut=!0;const f=[];let g=i;try{for(;;){const x=await new Promise(y=>{f.push(p.onDidHide(()=>y(void 0)),p.onDidChangeValue(b=>{b=b.trim(),b.length===0?p.items=u:p.activeItems.length===0||p.activeItems[0]instanceof xa?p.items=[new xa(r,b),...u]:p.items=u}),p.onDidAccept(()=>{if(p.activeItems.length!==0){const[b]=p.activeItems;(!(b instanceof xa)||b.validate())&&y(b)}}),p.onDidChangeActive(()=>{if(g!==void 0||!(s==null?void 0:s.allowAddToWorkspace))return;const[b]=p.activeItems;let S=!0;if(b===void 0?S=Boolean(p.value):S=b instanceof xa,S){if(p.buttons.length===1)return;p.buttons=[Tn.AddToWorkspace]}else{if(p.buttons.length===0)return;p.buttons=[]}}),p.onDidTriggerButton(b=>{if(b===Tn.AddToWorkspace){const[S]=p.activeItems;if(!(S instanceof xa))return;S.validate()&&(g=$t.AddToWorkspace,y(S))}}),p.onDidTriggerItemButton(b=>{switch(b.button){case Tn.OpenInNewWindow:g=$t.NewWindow,y(b.item);break;default:break}})),p.title=a,p.placeholder=o,p.matchOnDescription=!0,p.items=u,p.sortByLabel=!1,p.show()});if(x instanceof Hh){const y=await x.show(g,x.placeholder,a,s);if(y===Uh)continue;return y}return[x,g]}}finally{p.dispose(),f.forEach(x=>void x.dispose())}}c(e,"show"),t.show=e})(Lh||(Lh={}));class Hh{constructor(e){this.provider=e}get label(){return`${this.provider.icon?`${this.provider.icon} `:""}${this.provider.label}`}get placeholder(){return this.provider.placeholder}async show(e,r,n,i){const o=h.window.createQuickPick(),a=new Il(500),s=[a];async function l(b,S,E,D,$){const z=await b.provideSources(S,E,D,$);return z==null?void 0:z.map(re=>({label:`${re.icon?`${re.icon} `:""}${re.name}`,description:re.description,detail:re.detail,url:re.url,workspace:re.workspace,buttons:[Tn.OpenInNewWindow]}))}c(l,"getItems");async function u(b){var S;g=void 0;const E=o.activeItems;o.items=(S=b!=null?b:await y)!=null?S:[],f&&E.length!==0&&(o.activeItems=o.items.filter(D=>E.some($=>$.url===D.url))),o.busy=!1}c(u,"setItems");let d,p;if(this.provider.provideOrganization&&this.provider.provideProject){if(d=await this.provider.provideOrganization(),!d)return[void 0,void 0];if(p=await this.provider.provideProject(d),!p)return[void 0,void 0]}let f=!1,g,x=e;const y=l(this.provider,d,p,void 0,{sort:"updated"});try{const b=await new Promise(S=>{s.push(o.onDidHide(()=>S(void 0)),o.onDidChangeValue(E=>{f=!1,E=E.trim(),o.busy=!0;const D=a.debounce(E?()=>l(this.provider,d,p,E,{sort:"stars"}):()=>y);g===void 0&&(g=D.then($=>u($)))}),o.onDidAccept(()=>{if(o.activeItems.length!==0){const[E]=o.activeItems;S(E)}}),o.onDidChangeActive(()=>{if(f=o.activeItems.length!==0,x!==void 0||!(i==null?void 0:i.allowAddToWorkspace))return;const[E]=o.activeItems;if(E===void 0){if(o.buttons.length===1)return;o.buttons=[h.QuickInputButtons.Back]}else{if(o.buttons.length===2)return;o.buttons=[h.QuickInputButtons.Back,Tn.AddToWorkspace]}}),o.onDidTriggerButton(E=>{if(E===h.QuickInputButtons.Back){S(Uh);return}if(E===Tn.AddToWorkspace){const[D]=o.activeItems;if(D===void 0)return;x=$t.AddToWorkspace,S(D)}}),o.onDidTriggerItemButton(E=>{switch(E.button){case Tn.OpenInNewWindow:x=$t.NewWindow,S(E.item);break;default:break}})),o.title=n,o.placeholder=r,o.matchOnDetail=!0,o.ignoreFocusOut=!0,o.sortByLabel=!1,o.buttons=[h.QuickInputButtons.Back],o.busy=!0,o.show(),g=a.debounce(()=>y,0).then(E=>u(E))});return b===Uh?b:[b,x]}finally{o.dispose(),s.forEach(b=>void b.dispose())}}}c(Hh,"RemoteSourceProviderPickerItem");class xa{constructor(e,r){this.url=r,this.alwaysShow=!0,this.canOpenResult=e.canOpenRemoteUrl(r)}get buttons(){return[Tn.OpenInNewWindow]}get label(){if(this.canOpenResult){const{provider:e,urlType:r}=this.canOpenResult;switch(r){case Ie.Branch:return xi("remote url picker open branch","Open Branch from {0} Repository",e.name);case Ie.Tag:return xi("remote url picker open tag","Open Tag from {0} Repository",e.name);case Ie.Commit:return xi("remote url picker open commit","Open Commit from {0} Repository",e.name);case Ie.File:return xi("remote url picker open file","Open File from {0} Repository",e.name);case Ie.PullRequest:return xi("remote url picker open pull request","Open Pull Request from {0} Repository",e.name);default:return xi("remote url picker open repository","Open {0} Repository",e.name)}}return xi("remote url picker open unknown","Enter a Remote Url")}get description(){return this.url}validate(){return this.canOpenResult!==void 0}}c(xa,"RemoteUrlQuickPickItem");var Tn;(function(t){t.AddToWorkspace={iconPath:new h.ThemeIcon("plus"),tooltip:xi("remote url picker button add to workspace","Add to Workspace")},t.OpenInNewWindow={iconPath:new h.ThemeIcon("empty-window"),tooltip:xi("remote picker open in new window","Open in New Window")}})(Tn||(Tn={}));var u_=Object.defineProperty,d_=Object.getOwnPropertyDescriptor,_i=c((t,e,r,n)=>{for(var i=n>1?void 0:n?d_(e,r):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&u_(e,r,i),i},"messages_decorateClass");const rr=(0,A.loadMessageBundle)();class kn{showGitHubStatus500Message(){return h.window.showErrorMessage(rr("github 500 error notification","GitHub failed to respond and might be experiencing issues. Visit the [GitHub status page](https://githubstatus.com) for more information."),rr("ok","OK")),Promise.resolve()}async showStatus401Message(e){if(!e)return void h.window.showErrorMessage(rr("401 error notification","The provided credentials are either invalid or expired."),rr("ok","OK"));const r=rr("401 error notification confirm","Reauthenticate");await h.window.showErrorMessage(rr("401 error notification with reauth","The provided credentials are either invalid or expired. Would you like to reauthenticate?"),r)===r&&e()}async showStatus403Message(e){if(!e)return void h.window.showErrorMessage(rr("403 error notification","The provided credentials do not have the required access."),rr("ok","OK"));const r=rr("403 error notification confirm","Reauthenticate");await h.window.showErrorMessage(rr("403 error notification with reauth","The provided credentials do not have the required access. Would you like to reauthenticate to grant additional access?"),r)===r&&e()}async showRepositoryEmptyMessage(e){const r=rr("repository empty open","Open Repository");await h.window.showErrorMessage(rr("repository empty","Repository '{0}' is empty and cannot be opened. Would you like to open another repository?",e),r)===r&&h.commands.executeCommand("remoteHub.openRepository")}async showPullRequestNotFoundMessage(e,r){const n=rr("pull request not found open","Open Pull Request");await h.window.showErrorMessage(rr("pull request not found","Unable to find pull request {1} on repository '{0}'. Would you like to open another pull request?",e,r),n)===n&&h.commands.executeCommand("remoteHub.openRepository")}async showPullRequestHeadNotFoundMessage(e,r){const n=rr("pull request head not found ok","OK");await h.window.showWarningMessage(rr("pull request head not found","Unable to find the source branch for pull request {1} on repository '{0}'.",e,r),n)}async showRepositoryForbiddenMessage(e){const r=rr("repository forbidden open","Open Repository");await h.window.showErrorMessage(rr("repository forbidden","You don't have access to repository '{0}'. Would you like to open another repository?",e),r)===r&&h.commands.executeCommand("remoteHub.openRepository")}async showRepositoryNotFoundMessage(e){const r=rr("repository not found confirm","Open Repository");await h.window.showErrorMessage(rr("repository not found","Unable to find repository '{0}'. Would you like to open another repository?",e),r)===r&&h.commands.executeCommand("remoteHub.openRepository")}async showUnableToOpenRepositoryMessage(e){const r=rr("unable to open repo confirm","Open Repository");await h.window.showErrorMessage(rr("unable to open repo","Unable to open repository. {0}. Would you like to open another repository?",String(e)),r)===r&&h.commands.executeCommand("remoteHub.openRepository")}}c(kn,"Messages"),_i([Sr(()=>"")],kn.prototype,"showGitHubStatus500Message",1),_i([Sr(()=>"")],kn.prototype,"showStatus401Message",1),_i([Sr(()=>"")],kn.prototype,"showStatus403Message",1),_i([Sr()],kn.prototype,"showRepositoryEmptyMessage",1),_i([Sr()],kn.prototype,"showPullRequestNotFoundMessage",1),_i([Sr()],kn.prototype,"showPullRequestHeadNotFoundMessage",1),_i([Sr()],kn.prototype,"showRepositoryForbiddenMessage",1),_i([Sr()],kn.prototype,"showRepositoryNotFoundMessage",1),_i([Sr()],kn.prototype,"showUnableToOpenRepositoryMessage",1);const Fr=new kn,pr=(0,A.loadMessageBundle)();function h_(t,e,r,n,i){async function o(s){const[l,u]=await Lh.show(t,r,s,pr("open repo placeholder","Enter a remote url, or select a remote provider"),s===$t.AddToWorkspace?pr("open repo title add to workspace","Add Remote Repository to Workspace"):pr("open repo title current window","Open Remote Repository"),{allowAddToWorkspace:!1});if(!l){i.sendEvent("openRepository.abort",{reason:"abandoned"});return}try{let d;if(l.workspace)d=l.workspace,d.location=u!=null?u:d.location;else if(d=await t.createWorkspaceForRemoteUrl(l.url,void 0,u!=null?u:s),!d){i.sendEvent("openRepository.abort",{reason:"aborted invalid url"});return}await sn(d)}catch(d){if(i.sendException(d),d instanceof nt){const{reauthenticate:p}=d;Fr.showStatus401Message(()=>p());return}if(d instanceof gt){Fr.showRepositoryNotFoundMessage(d.name);return}if(d instanceof te){Fr.showRepositoryForbiddenMessage(d.name);return}if(d instanceof Ge){Fr.showRepositoryEmptyMessage(d.name);return}if(d instanceof Je){Fr.showPullRequestNotFoundMessage(d.name,d.id);return}C.error(d)}}c(o,"openRepository");async function a(s,l,u){if(u==null?void 0:u.workspaceFolder){const p=t.getRepository(u.workspaceFolder,l);if(p!==void 0)return p}const d=l?t.repositories.filter(p=>p.provider.id===l):t.repositories;if(d.length!==0){if(d.length>1){const p=await h.window.showQuickPick(d.map(f=>({label:f.name,description:f.provider.name,repository:f})),{placeHolder:s});return p?p.repository:void 0}return d[0]}}return c(a,"getRepository"),[h.commands.registerCommand("remoteHub.openRepository",()=>(i.sendEvent("command.openRepository"),o())),h.commands.registerCommand("remoteHub.continueOn.openRepository",()=>(i.sendEvent("command.continueOn.openRepository"),o())),h.commands.registerCommand("remoteHub.addRepositoryToWorkspace",()=>{i.sendEvent("command.continueOn.openRepository")}),h.commands.registerCommand("remoteHub.continueOn.addRepositoryToWorkspace",()=>{i.sendEvent("command.continueOn.openRepository")}),h.commands.registerCommand("remoteHub.continueOn",async()=>{const s=await a(pr("continue on choose repository placeholder","Choose which repository to continue working on elsewhere"));if(s===void 0)return;i.sendEvent("command.continueOn");const l=await Oh.show(n,pr("continue on placeholder","Choose how you would like to continue working"),pr("continue on title","Continue '{0}' on",s.name));if(!l){i.sendEvent("command.continueOn.abort",{reason:"abandoned"});return}if(await e.hasChanges(s.uri)){const p={title:pr("continue","Continue")},f={title:pr("cancel","Cancel"),isCloseAffordance:!0};if(await h.window.showWarningMessage(pr("continue on uncommitted changes",`You have uncommitted changes.

Unless you commit those changes, you won't be able see them from elsewhere.`),{modal:!0,useCustom:!0},p,f)!==p){i.sendEvent("command.continueOn.abort",{reason:"abandoned uncommitted changes prompt"});return}}const u=t.getRemoteUri(s.provider.id,{repo:s.id}),{HEAD:d}=await s.getMetadata();await l.execute({provider:s.provider,workspaceFolder:s.uri,name:s.name,url:u==null?void 0:u.toString(!0),ref:d.name})}),h.commands.registerCommand("remoteHub.openOnDesktop",async s=>{if(!An)return;const l=await a(pr("continue on desktop choose repository placeholder","Choose which repository to open on the desktop"),void 0,s);if(l===void 0)return;const u=await t.getBestRemoteUri(l.uri);u!==void 0&&(i.sendEvent("command.openOnDesktop"),h.env.openExternal(h.Uri.parse(`${h.env.uriScheme}://${n}/open?url=${encodeURIComponent(u.toString(!0))}`)))}),h.commands.registerCommand("remoteHub.openOnWeb",async s=>{if(An)return;const l=await a(pr("continue on web choose repository placeholder","Choose which repository to open on the web"),void 0,s);if(l===void 0)return;const u=await t.getBestRemoteUri(l.uri);u!==void 0&&(i.sendEvent("command.openOnWeb"),h.env.openExternal(u))}),h.commands.registerCommand("remoteHub.goToRepository",async()=>{var s,l,u;i.sendEvent("command.goToRepository");const d=await a(pr("open on remote choose repository placeholder","Choose which repository to open on the remote"));if(!d)return;const p=await t.getMetadata(d.uri);let f;const g={provider:d.provider,repo:d.id,path:((s=h.window.activeTextEditor)==null?void 0:s.document.uri)?t.getRelativeFilePath((l=h.window.activeTextEditor)==null?void 0:l.document.uri):void 0};return p.HEAD.type===he.Branch&&(((u=h.window.activeTextEditor)==null?void 0:u.document)||p.defaultBranch.name!==p.HEAD.name)?f={...g,branch:p.HEAD.name}:p.HEAD.type===he.Tag?f={...g,tag:p.HEAD.name}:p.HEAD.type===he.Commit?f={...g,sha:p.HEAD.name}:f={...g},h.commands.executeCommand("remoteHub.openOnRemote",f)}),h.commands.registerCommand("remoteHub.openOnRemote",async s=>{i.sendEvent("command.openOnRemote");const{provider:l,...u}=s,d=t.getRemoteUri(l.id,u);if(d){await h.env.openExternal(d);return}h.window.showErrorMessage(pr("open on remote command provider not supported","Unable to open the resource on {0}",s.provider.name))}),h.commands.registerCommand("remoteHub.clone",async s=>{const l=await a(pr("clone placeholder","Choose which repository to clone"),void 0,s);if(l!==void 0){if(i.sendEvent("command.clone"),s===void 0&&await e.hasChanges(l.uri)){const u={title:pr("continue","Continue")},d={title:pr("cancel","Cancel"),isCloseAffordance:!0};if(await h.window.showWarningMessage(pr("clone uncommitted changes",`You have uncommitted changes.

Unless you commit those changes, you won't be able see them in your local clone.`),{modal:!0,useCustom:!0},u,d)!==u){i.sendEvent("command.clone.abort",{reason:"abandoned uncommitted changes prompt"});return}}await t.clone(l.uri)}}),h.commands.registerCommand("remoteHub.refresh",()=>void t.refresh()),h.commands.registerCommand("remoteHub.enableDebugLogging",()=>P.updateEffective("logLevel",ie.Debug)),h.commands.registerCommand("remoteHub.disableDebugLogging",()=>P.updateEffective("logLevel",ie.Warn)),h.commands.registerCommand("remoteHub.exportDebugInfo",async()=>{await r.exportDebugInfo(),await e.exportDebugInfo()}),h.commands.registerCommand("remoteHub.setContext",async(s,l)=>{if(!s.startsWith("continueOn:"))throw new Error("Key must start with 'continueOn:'");await bi(s,l)}),h.commands.registerCommand("remoteHub.notebook.continueOn",async()=>{const s={title:pr("continue on","Continue Working On...")};await h.window.showInformationMessage(pr("notebook continue on","Running notebook cells is not available in the web editor. To run this cell, you will need to continue in an environment that can run code, like a codespace or local VS Code."),{modal:!0},s)===s&&await h.commands.executeCommand("remoteHub.continueOn")}),h.commands.registerCommand("remoteHub.remoteHelp.getStarted",()=>An?"https://aka.ms/vscode-web-docs":"https://aka.ms/vscode-remote/remote-repositories/getting-started")]}c(h_,"registerCommands");function In(t){return t}c(In,"command");async function zh(t,e){return h.commands.executeCommand(t,e)}c(zh,"executeCommand");class v0{constructor(){this._timeout=0,this._disposable=P.onDidChange(this.onConfigurationChanged,this),this.maybeQueueFetch()}dispose(){this._disposable.dispose(),this._timeout&&clearTimeout(this._timeout)}get config(){var e;if(this._config===void 0){const r=P.get("autoFetch");this._config={enabled:(e=r.enabled)!=null?e:!0,interval:r.interval*1e3}}return this._config}onConfigurationChanged(e){!P.changed(e,"autoFetch")||(this._config=void 0,this.maybeQueueFetch())}async fetchAll(){try{await zh("remoteHub.fetchAll",{automated:!0})}catch(e){C.error(e,"Autofetch failed")}this.maybeQueueFetch()}maybeQueueFetch(){this._timeout&&(clearTimeout(this._timeout),this._timeout=0),!!this.config.enabled&&(this._timeout=setTimeout(()=>this.fetchAll(),this.config.interval))}}c(v0,"AutoFetchService");var f_=__webpack_require__(8764),Dl,p_=new Uint8Array(16);function g_(){if(!Dl&&(Dl=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!Dl))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Dl(p_)}c(g_,"rng");const m_=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function v_(t){return typeof t=="string"&&m_.test(t)}c(v_,"validate");const w_=v_;for(var Er=[],Wh=0;Wh<256;++Wh)Er.push((Wh+256).toString(16).substr(1));function y_(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=(Er[t[e+0]]+Er[t[e+1]]+Er[t[e+2]]+Er[t[e+3]]+"-"+Er[t[e+4]]+Er[t[e+5]]+"-"+Er[t[e+6]]+Er[t[e+7]]+"-"+Er[t[e+8]]+Er[t[e+9]]+"-"+Er[t[e+10]]+Er[t[e+11]]+Er[t[e+12]]+Er[t[e+13]]+Er[t[e+14]]+Er[t[e+15]]).toLowerCase();if(!w_(r))throw TypeError("Stringified UUID is invalid");return r}c(y_,"stringify");const b_=y_;function x_(t,e,r){t=t||{};var n=t.random||(t.rng||g_)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){r=r||0;for(var i=0;i<16;++i)e[r+i]=n[i];return e}return b_(n)}c(x_,"v4");const qh=x_,Vn=globalThis.fetch;async function jh(t,e,r){const n=new AbortController;r.onCancellationRequested(()=>n.abort());try{return await globalThis.fetch(t,{...e,signal:n.signal})}catch(i){throw r.isCancellationRequested?new h.CancellationError:i}}c(jh,"fetchWithCancellation");var __="/";const S_=A.loadMessageBundle(__webpack_require__(6470).join(__,"azure-devops/azdoAuthHelper.ts")),C_="https://app.vssps.visualstudio.com/oauth2",w0="https://vscode.dev/codeExchangeProxyEndpoints/azuredevops",E_="B6B1E9E6-B408-45D9-A6EA-AF1FFBAB6A0F",Ds=["vso.code"];function y0(t){return(t.query.includes("&")?t.query:decodeURIComponent(t.query)).split("&").reduce((r,n)=>{const i=n.split("=");return r[i[0]]=i[1],r},{})}c(y0,"parseQuery");const Gi=new h.EventEmitter,b0=new h.EventEmitter,Pl="Network failure",x0="AzDO",Ps="azuredevops";class _0{constructor(e){this._tokens=[],this._refreshTimeouts=new Map,this._disposables=[],this._pendingStates=new Map,this._codeExchangePromises=new Map,this.secretStorage=e.secrets,this.extensionId=e.extension.id}async initialize(){await this.secretStorage.get(x0)&&(C.debug("Detected outdated auth session format. Removing and will ask for new auth session... "),await this.secretStorage.delete(x0));const r=await this.secretStorage.get(Ps);if(r)try{const i=this.parseStoredData(r).map(async o=>{var a;if(!o.refreshToken)return Promise.resolve();try{await this.refreshToken(o.refreshToken,o.scope,o.id)}catch(s){s.message===Pl?await this.handleRefreshNetworkError(o.id,o.refreshToken,o.scope)||(this._tokens.push({accessToken:void 0,refreshToken:o.refreshToken,account:{label:(a=o.account.label)!=null?a:o.account.displayName,id:o.account.id},scope:o.scope,sessionId:o.id}),this.pollForReconnect(o.id,o.refreshToken,o.scope)):await this.removeSession(o.id)}});await Promise.all(i)}catch(n){C.log("Failed to initialize stored data"),await this.clearSessions()}this._disposables.push(this.secretStorage.onDidChange(()=>this.checkForUpdates))}parseStoredData(e){return JSON.parse(e)}async storeTokenData(){const e=this._tokens.map(r=>({id:r.sessionId,refreshToken:r.refreshToken,scope:r.scope,account:r.account}));await this.secretStorage.store(Ps,JSON.stringify(e))}async checkForUpdates(){const e=[];let r=[];const n=await this.secretStorage.get(Ps);if(n)try{const i=this.parseStoredData(n);let o=i.map(async a=>{if(!this._tokens.some(l=>l.scope===a.scope&&l.sessionId===a.id)&&a.refreshToken)try{const l=await this.refreshToken(a.refreshToken,a.scope,a.id);e.push(this.convertToSessionSync(l))}catch(l){l.message===Pl||await this.removeSession(a.id)}});o=o.concat(this._tokens.map(async a=>{i.some(l=>a.scope===l.scope&&a.sessionId===l.id)||(await this.removeSession(a.sessionId),r.push(this.convertToSessionSync(a)))})),await Promise.all(o)}catch(i){C.error(i),r=this._tokens.map(this.convertToSessionSync),this.clearSessions()}else this._tokens.length&&(r=this._tokens.map(this.convertToSessionSync),C.log("No stored keychain data, clearing local data"),this._tokens=[],this._refreshTimeouts.forEach(i=>{clearTimeout(i)}),this._refreshTimeouts.clear());(e.length||r.length)&&Gi.fire({added:e,removed:r,changed:[]})}convertToSessionSync(e){return{id:e.sessionId,accessToken:e.accessToken,account:e.account,scopes:e.scope.split(" ")}}async convertToSession(e){const r=await this.resolveAccessToken(e);return{id:e.sessionId,accessToken:r,account:e.account,scopes:e.scope.split(" ")}}async resolveAccessToken(e){if(e.accessToken&&(!e.expiresAt||e.expiresAt>Date.now()))return e.expiresAt?C.log(`Token available from cache, expires in ${e.expiresAt-Date.now()} milliseconds`):C.log("Token available from cache"),Promise.resolve(e.accessToken);try{C.log("Token expired or unavailable, trying refresh");const r=await this.refreshToken(e.refreshToken,e.scope,e.sessionId);if(r.accessToken)return r.accessToken;throw new Error("No access token returned.")}catch(r){throw new Error("Unavailable due to network problems")}}getTokenClaims(e){try{return JSON.parse(f_.Buffer.from(e.split(".")[1],"base64").toString())}catch(r){throw C.error(r),new Error("Unable to read token claims")}}get sessions(){return Promise.all(this._tokens.map(e=>this.convertToSession(e)))}async getSessions(e){if(!e)return this.sessions;const r=e.sort().join(" "),n=this._tokens.filter(i=>i.scope===r);return Promise.all(n.map(i=>this.convertToSession(i)))}createSession(e){return C.log("Logging in..."),this.loginWithoutLocalServer(e)}dispose(){this._disposables.forEach(e=>e.dispose()),this._disposables=[]}isTestEnvironment(e){return/\.azurewebsites\.net$/.test(e.authority)||e.authority.startsWith("localhost:")}async loginWithoutLocalServer(e){var r;const n=await h.env.asExternalUri(h.Uri.parse(`${h.env.uriScheme}://${this.extensionId}/login`));if(this.isTestEnvironment(n)){const u=await h.window.showInputBox({prompt:'Azure Repos Personal Access Token (you must have "vso.code" in your scopes)',ignoreFocusOut:!0});if(!u)throw new Error("Sign in failed: No token provided");return{id:"test",accessToken:u,scopes:Ds,account:{id:"test",label:"Test Account"}}}const i=n.toString(),o=h.Uri.parse(`${C_}/authorize?client_id=${E_}&response_type=Assertion&state=${encodeURIComponent(i)}&scope=${encodeURIComponent(Ds.join(" "))}&redirect_uri=${encodeURIComponent(w0)}`),a=new Promise((u,d)=>{const p=setTimeout(()=>{clearTimeout(p),d("Login timed out.")},1e3*60*5)}),s=(r=this._pendingStates.get(e))!=null?r:[];this._pendingStates.set(e,[...s,i]);let l=this._codeExchangePromises.get(e);return l||(l=this.handleCodeResponse(e),this._codeExchangePromises.set(e,l)),h.env.openExternal(o),Promise.race([l,a]).finally(()=>{this._pendingStates.delete(e),this._codeExchangePromises.delete(e)})}async handleCodeResponse(e){let r;return new Promise((n,i)=>{r=b0.event(async o=>{try{C.log(`Received Uri: ${o.toString()}`);const a=y0(o);if(!a)throw new Error(`No access info found in query: ${JSON.stringify(a)}`);const s=a,l=await this.getTokenFromResponse(s,e);this.setToken(l,e);const u=await this.convertToSession(l);n(u)}catch(a){C.error(a),i(a)}})}).then(n=>(r.dispose(),n)).catch(n=>{throw r.dispose(),n})}setToken(e,r){const n=this._tokens.findIndex(i=>i.sessionId===e.sessionId);return n>-1?this._tokens.splice(n,1,e):this._tokens.push(e),this.clearSessionTimeout(e.sessionId),e.expiresIn&&this._refreshTimeouts.set(e.sessionId,setTimeout(async()=>{try{const i=await this.refreshToken(e.refreshToken,r,e.sessionId);Gi.fire({added:[],removed:[],changed:[this.convertToSessionSync(i)]})}catch(i){i.message===Pl?await this.handleRefreshNetworkError(e.sessionId,e.refreshToken,r)||this.pollForReconnect(e.sessionId,e.refreshToken,e.scope):(await this.removeSession(e.sessionId),Gi.fire({added:[],removed:[this.convertToSessionSync(e)],changed:[]}))}},1e3*(e.expiresIn*2/3))),this.storeTokenData()}async getTokenFromResponse(e,r,n){var i;const o=this.getTokenClaims(e.access_token),a=await Vn("https://app.vssps.visualstudio.com/_apis/profile/profiles/me?api-version=6.0",{headers:{Authorization:`Bearer ${e.access_token}`,"Content-Type":"application/json"}});let s;if(a.ok)s=(await a.json()).displayName;else{const l=await a.text();C.error(l),s="User"}return{expiresIn:e.expires_in,expiresAt:e.expires_in?Date.now()+e.expires_in*1e3:void 0,accessToken:e.access_token,refreshToken:e.refresh_token,scope:r,sessionId:n!=null?n:`${o.nameid}/${qh()}`,account:{label:s,id:`${o.nameid}/${(i=o.aui)!=null?i:""}`}}}async refreshToken(e,r,n){C.log("Refreshing token...");const i=`refresh_token=${encodeURIComponent(e)}`;let o;try{o=await Vn(w0,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","Content-Length":i.length.toString()},body:i})}catch(a){throw C.error("Refreshing token failed"),new Error(Pl)}try{if(o.ok){const a=await o.json(),s=await this.getTokenFromResponse({access_token:a.access_token,expires_in:a.expires_in,refresh_token:a.refresh_token},r,n);return this.setToken(s,r),C.log("Token refresh success"),s}throw new Error("Bad request.")}catch(a){throw await h.window.showErrorMessage(S_(0,null)),C.error(`Refreshing token failed: ${o.statusText}`),new Error("Refreshing token failed")}}clearSessionTimeout(e){const r=this._refreshTimeouts.get(e);r&&(clearTimeout(r),this._refreshTimeouts.delete(e))}removeInMemorySessionData(e){const r=this._tokens.findIndex(i=>i.sessionId===e);let n;return r>-1&&(n=this._tokens[r],this._tokens.splice(r,1)),this.clearSessionTimeout(e),n}pollForReconnect(e,r,n){this.clearSessionTimeout(e),this._refreshTimeouts.set(e,setTimeout(async()=>{try{const i=await this.refreshToken(r,n,e);Gi.fire({added:[],removed:[],changed:[this.convertToSessionSync(i)]})}catch(i){this.pollForReconnect(e,r,n)}},1e3*60*30))}handleRefreshNetworkError(e,r,n,i=1){return new Promise((o,a)=>{if(i===3)return C.error("Token refresh failed after 3 attempts"),o(!1);const s=5*i*i;this.clearSessionTimeout(e),this._refreshTimeouts.set(e,setTimeout(async()=>{try{const l=await this.refreshToken(r,n,e);return Gi.fire({added:[],removed:[],changed:[this.convertToSessionSync(l)]}),o(!0)}catch(l){return o(await this.handleRefreshNetworkError(e,r,n,i+1))}},1e3*s))})}async removeSession(e){C.log(`Logging out of session '${e}'`);const r=this.removeInMemorySessionData(e);let n;return r&&(n=this.convertToSessionSync(r)),this._tokens.length===0?await this.secretStorage.delete(Ps):this.storeTokenData(),n}async clearSessions(){C.log("Logging out of all sessions"),this._tokens=[],await this.secretStorage.delete(Ps),this._refreshTimeouts.forEach(e=>{clearTimeout(e)}),this._refreshTimeouts.clear()}}c(_0,"AzureDevOpsAuthService");const S0=c(class{constructor(t){this.onDidChangeSessions=Gi.event,this.loginService=new _0(t),this.initializePromise=this.loginService.initialize(),this.disposable=h.authentication.registerAuthenticationProvider(S0.id,"Azure Repos",this)}dispose(){this.disposable.dispose()}async getSessions(t){return await this.initializePromise,this.loginService.getSessions(t)}async createSession(t){await this.initializePromise;const e=await this.loginService.createSession(t.sort().join(" "));return Gi.fire({added:[e],removed:[],changed:[]}),e}async removeSession(t){await this.initializePromise;const e=await this.loginService.removeSession(t);e&&Gi.fire({added:[],removed:[e],changed:[]})}},"_AzDOAuthenticationProvider");let Co=S0;Co.id="azurerepos";var _a=__webpack_require__(7360),R_=__webpack_require__(850),Vh=__webpack_require__.n(R_);function Gh(t,e,r){if(!(e==null?void 0:e.length)&&!(r==null?void 0:r.length))return new Set(t);let n;if(e==null?void 0:e.length){const i=new Set([...e,...e.map(a=>`${a}/**`)]),o=Vh()(t,[...i],{dot:!0,nocase:!0});n=new Set(o)}if(r==null?void 0:r.length){const i=new Set([...r,...r.map(o=>`${o}/**`)]);if(n===void 0){const o=Vh().not(t,[...i],{dot:!0,nocase:!0});n=new Set(o)}else Vh()(t,[...i],{dot:!0,nocase:!0}).forEach(n.delete,n)}return n}c(Gh,"globFilter");var A_=Object.defineProperty,T_=Object.getOwnPropertyDescriptor,Kh=c((t,e,r,n)=>{for(var i=n>1?void 0:n?T_(e,r):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&A_(e,r,i),i},"fs_decorateClass");const k_=(0,A.loadMessageBundle)(),I_=h.FileSystemError.FileNotFound().code,D_=/(\/|\\)/g;class Fs{constructor(e,r,n){this.providerService=e,this.azdo=r,this.changeStore=n,this._onDidChangeFile=new h.EventEmitter,this.contentCache=new Map,this.fileSearchCache=new Map,this.pendingUriRequests=new Map,this.pendingUriRequestsEventDelay=10,this.implicitlyWatchedUris=new Map,this.watchedUris=new Map,this.pathTypeMap={},this.disposable=h.Disposable.from(h.workspace.registerFileSystemProvider(this.scheme,this,{isCaseSensitive:!0,isReadonly:!0}),h.workspace.registerFileSearchProvider(this.scheme,this),h.workspace.registerTextSearchProvider(this.scheme,this),h.workspace.onDidCloseTextDocument(i=>this.onTextDocumentClosed(i.uri)),e.onDidChangeRepository(i=>{i.reason==="HEAD"&&this.onRefreshOrRepositoryChanged([i.repository.uri])}),e.onDidRefresh(i=>this.onRefreshOrRepositoryChanged(i)))}get onDidChangeFile(){return this._onDidChangeFile.event}get scheme(){return this.azdo.scheme}dispose(){var e;(e=this.disposable)==null||e.dispose()}onRefreshOrRepositoryChanged(e){if(e=e.filter(r=>Dt.getProviderId(r)===this.scheme).map(r=>this.providerService.getProviderUri(r)),e.length!==0){C.log(`AzDOFS.onRefreshOrRepositoryChanged(${e.map(r=>r.toString()).join(", ")})`),this.fileSearchCache.clear();for(const[r,n]of[...this.pendingUriRequests])e.some(i=>_e(n.uri,i))&&(this.pendingUriRequests.delete(r),n.outdated=!0);for(const[r,{uri:n}]of[...this.contentCache])e.some(i=>_e(n,i))&&this.contentCache.delete(r);this.updateOpenOrWatchedUris(e)}}onTextDocumentClosed(e){e.scheme===this.scheme&&this.contentCache.delete(H(e))}updateOpenOrWatchedUris(e){const r=this.providerService.getOpenUris(this.scheme,e);for(const[i,o]of[...this.watchedUris,...this.implicitlyWatchedUris])e.some(a=>_e(o,a))&&(this.implicitlyWatchedUris.delete(i),r.set(i,o));C.debug(`AzDOFS.updateOpenOrWatchedUris(${e.map(i=>i.toString()).join(", ")}): uris=${r.size}`);for(const i of e)r.set(H(i),i);const n=[...r.values()].map(i=>({type:h.FileChangeType.Changed,uri:i}));setTimeout(()=>{C.debug(`AzDOFS.updateOpenOrWatchedUris: Firing events=${n.map(i=>i.uri.toString()).join(", ")}`),this._onDidChangeFile.fire(n)},0)}watch(e,r){const n=H(e);return this.watchedUris.set(n,e),{dispose:()=>{this.watchedUris.delete(n)}}}async stat(e){const r=H(e);this.implicitlyWatchedUris.set(r,e);const n={uri:e,outdated:!1};try{this.pendingUriRequests.set(`stat:${r}`,n);const i=await this.providerService.getMetadata(e),o=h.FilePermission.Readonly;if(!i.path)return{type:h.FileType.Directory,mtime:0,ctime:0,size:0,permissions:o};if(i.path in this.pathTypeMap||await this.updateWorkspaceItemMap(i,e.path,!0),i.path in this.pathTypeMap)return this.pathTypeMap[i.path]===h.FileType.Directory?{type:h.FileType.Directory,mtime:0,ctime:0,size:0,permissions:o}:{type:h.FileType.File,mtime:0,ctime:0,size:0,permissions:o};if(this.implicitlyWatchedUris.delete(r),e.query!=="~")throw h.FileSystemError.FileNotFound(e);return{type:h.FileType.File,size:0,ctime:0,mtime:Date.now(),permissions:h.FilePermission.Readonly}}finally{this.pendingUriRequests.delete(`stat:${r}`),(n==null?void 0:n.outdated)&&setTimeout(()=>{C.log(`AzDOFS.stat(${e.toString()}): Repository changed; firing change event...`),this._onDidChangeFile.fire([{type:h.FileChangeType.Changed,uri:e}])},this.pendingUriRequestsEventDelay)}}async updateWorkspaceItemMap(e,r,n){const i=new Array,o=await this.azdo.getRepoItems(e,r,{recursionLevel:"OneLevel"});for(const a of o){const s=a.path.substring(1);if(s!==e.path||n){const l=a.isFolder===!0?h.FileType.Directory:h.FileType.File;this.pathTypeMap[s]=l,i.push([s,l])}}return i}async readDirectory(e){this.implicitlyWatchedUris.set(H(e),e);const r=this.providerService.getVirtualRootUri(e),n=await this.providerService.getMetadata(e);return(await this.updateWorkspaceItemMap(n,e.path,!1)).map(o=>[this.providerService.getRelativeFilePath(e,Ue(r,o[0])),o[1]])}createDirectory(e){throw h.FileSystemError.NoPermissions()}async readFile(e){var r;const n=H(e);this.implicitlyWatchedUris.set(n,e);let i=this.contentCache.get(n);if(i!==void 0)return i.content;const o={uri:e,outdated:!1};try{return this.pendingUriRequests.set(n,o),i={content:this.azdo.getFileContent(e),uri:e},this.contentCache.set(n,i),await i.content}catch(a){if(this.implicitlyWatchedUris.delete(n),i!==void 0&&i.content===((r=this.contentCache.get(n))==null?void 0:r.content)&&this.contentCache.delete(n),e.query==="~"&&a instanceof h.FileSystemError&&a.code===I_)return new Uint8Array(0);throw a}finally{this.pendingUriRequests.delete(n),(o==null?void 0:o.outdated)&&setTimeout(()=>{C.log(`AzDOFS.readFile(${e.toString()}): Repository changed; firing change event...`),this._onDidChangeFile.fire([{type:h.FileChangeType.Changed,uri:e}])},this.pendingUriRequestsEventDelay)}}writeFile(e,r,n){throw h.FileSystemError.NoPermissions()}delete(e,r){throw h.FileSystemError.NoPermissions()}rename(e,r,n){throw h.FileSystemError.NoPermissions()}copy(e,r,n){throw h.FileSystemError.NoPermissions()}async provideFileSearchResults(e,{folder:r,maxResults:n,includes:i,excludes:o},a){const s=`${H(r)}|${JSON.stringify({includes:i,excludes:o})}`;let l=this.fileSearchCache.get(s);if(l===void 0){const d=await this.providerService.getMetadata(r),p=await this.azdo.getRepoItems(d,"",{recursionLevel:"Full"});let f=[];for(const g of p)g.isFolder||f.push(g.path);if(f.length===0||a.isCancellationRequested)return[];((i==null?void 0:i.length)||(o==null?void 0:o.length))&&(f=[...Gh(f,i,o)]),l=f.map(g=>_a.prepareSlow(g)),this.fileSearchCache.set(s,l)}let u;return e.pattern===""?u=l.map(d=>h.Uri.joinPath(r,d.target)):(u=_a.go(e.pattern.replace(D_,"/"),l,{allowTypo:!0,limit:n}).map(d=>h.Uri.joinPath(r,d.target)),_a.cleanup()),n!==void 0&&n!==0&&n<u.length&&(u=u.slice(0,n)),u}async provideTextSearchResults(e,r,n,i){const o=[];(e.isCaseSensitive||e.isRegExp||e.isWordMatch)&&o.push({text:k_("azdo flags not supported","Search flags are not supported."),type:h.TextSearchCompleteMessageType.Warning});const a=await this.azdo.searchCodeQuery(e.pattern,r.folder,{maxResults:r.maxResults,context:{before:r.beforeContext,after:r.afterContext}});if(a.warnings&&a.warnings.forEach(l=>{o.push({text:l,type:h.TextSearchCompleteMessageType.Warning})}),a===void 0)return{limitHit:!0,message:o};let s;for(const l of a.matches)s=h.Uri.joinPath(r.folder,l.path),n.report({uri:s,ranges:l.ranges,preview:{text:l.preview,matches:l.matches}});return{limitHit:!1,message:o}}}c(Fs,"AzDOFS"),Kh([dt()],Fs.prototype,"stat",1),Kh([dt()],Fs.prototype,"readDirectory",1),Kh([dt()],Fs.prototype,"readFile",1);var C0;(function(t){t[t.Force=0]="Force",t[t.ForceWithLease=1]="ForceWithLease"})(C0||(C0={}));var Gn;(function(t){t[t.Head=0]="Head",t[t.RemoteHead=1]="RemoteHead",t[t.Tag=2]="Tag"})(Gn||(Gn={}));var $s;(function(t){t[t.INDEX_MODIFIED=0]="INDEX_MODIFIED",t[t.INDEX_ADDED=1]="INDEX_ADDED",t[t.INDEX_DELETED=2]="INDEX_DELETED",t[t.INDEX_RENAMED=3]="INDEX_RENAMED",t[t.INDEX_COPIED=4]="INDEX_COPIED",t[t.MODIFIED=5]="MODIFIED",t[t.DELETED=6]="DELETED",t[t.UNTRACKED=7]="UNTRACKED",t[t.IGNORED=8]="IGNORED",t[t.INTENT_TO_ADD=9]="INTENT_TO_ADD",t[t.ADDED_BY_US=10]="ADDED_BY_US",t[t.ADDED_BY_THEM=11]="ADDED_BY_THEM",t[t.DELETED_BY_US=12]="DELETED_BY_US",t[t.DELETED_BY_THEM=13]="DELETED_BY_THEM",t[t.BOTH_ADDED=14]="BOTH_ADDED",t[t.BOTH_DELETED=15]="BOTH_DELETED",t[t.BOTH_MODIFIED=16]="BOTH_MODIFIED"})($s||($s={}));var E0;(function(t){t.BadConfigFile="BadConfigFile",t.AuthenticationFailed="AuthenticationFailed",t.NoUserNameConfigured="NoUserNameConfigured",t.NoUserEmailConfigured="NoUserEmailConfigured",t.NoRemoteRepositorySpecified="NoRemoteRepositorySpecified",t.NotAGitRepository="NotAGitRepository",t.NotAtRepositoryRoot="NotAtRepositoryRoot",t.Conflict="Conflict",t.StashConflict="StashConflict",t.UnmergedChanges="UnmergedChanges",t.PushRejected="PushRejected",t.RemoteConnectionError="RemoteConnectionError",t.DirtyWorkTree="DirtyWorkTree",t.CantOpenResource="CantOpenResource",t.GitNotFound="GitNotFound",t.CantCreatePipe="CantCreatePipe",t.PermissionDenied="PermissionDenied",t.CantAccessRemote="CantAccessRemote",t.RepositoryNotFound="RepositoryNotFound",t.RepositoryIsLocked="RepositoryIsLocked",t.BranchNotFullyMerged="BranchNotFullyMerged",t.NoRemoteReference="NoRemoteReference",t.InvalidBranchName="InvalidBranchName",t.BranchAlreadyExists="BranchAlreadyExists",t.NoLocalChanges="NoLocalChanges",t.NoStashFound="NoStashFound",t.LocalChangesOverwritten="LocalChangesOverwritten",t.NoUpstreamBranch="NoUpstreamBranch",t.IsInSubmodule="IsInSubmodule",t.WrongCase="WrongCase",t.CantLockRef="CantLockRef",t.CantRebaseMultipleBranches="CantRebaseMultipleBranches",t.PatchDoesNotApply="PatchDoesNotApply",t.NoPathFound="NoPathFound",t.UnknownPath="UnknownPath"})(E0||(E0={}));var P_=Object.defineProperty,F_=Object.getOwnPropertyDescriptor,$_=c((t,e,r,n)=>{for(var i=n>1?void 0:n?F_(e,r):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&P_(e,r,i),i},"provider_decorateClass");const N_=/^https?:\/\/dev\.azure\.com(?:\/defaultcollection)?\/(?<organization>[^/]+)(?:\/(?<project>[^_/][^/]*))?(?:\/_git)?\/(?<repo>[^/?#]+)(?:\/commit\/(?<commit>[0-9a-f]{40})|\/pullrequest\/(?<pull>\d+))?/i,R0=(0,A.loadMessageBundle)(),A0=1,T0=Object.freeze({id:"azurerepos",name:"Azure Repos"});function Eo(t){const{scheme:e,metadata:r}=Dt.decodeAuthority(t),[,n,i,o,...a]=t.path.split("/");return{scheme:e,provider:T0,name:`${n}/${i}/${o}`,repo:{organization:n,project:i,name:o},path:a.join("/")||"",ref:r==null?void 0:r.ref,idx:r==null?void 0:r.idx}}c(Eo,"getAzDOMetadata");function M_(t,e){const{repo:r}=e!=null?e:Eo(t);return t.with({path:`/${r.organization}/${r.project}/${r.name}`,query:"",fragment:""})}c(M_,"getAzDORootUri");function Zh(t,e,r){const{repo:{organization:n,name:i}}=t instanceof h.Uri?Eo(t):t;return h.Uri.parse(`azurerepos://${Dt.encodeAuthority("azurerepos",{v:A0,ref:{type:ke.Commit,id:e}})}/${n}/${i}/${r}`)}c(Zh,"getAzDORevisionUri");function k0(t){var e,r,n,i,o,a;const s=N_.exec(t);if((s==null?void 0:s.groups)===void 0)return;const{organization:l,project:u,repo:d,commit:p}=s.groups,f=y0(h.Uri.parse(t)),g=/^GB(?<branchName>.+)/i.exec((e=f.version)!=null?e:""),x=/^GT(?<tagName>.+)/i.exec((r=f.version)!=null?r:""),y=/^GC(?<commit>[0-9a-f]{40})/i.exec((n=f.version)!=null?n:""),b=f.path&&f.path!=="/"?f.path:void 0;return{organization:l,project:u,repo:d,branch:(i=g==null?void 0:g.groups)==null?void 0:i.branchName,tag:(o=x==null?void 0:x.groups)==null?void 0:o.tagName,commit:p!=null?p:(a=y==null?void 0:y.groups)==null?void 0:a.commit,path:b}}c(k0,"parseAzureReposUrl");class Xh{constructor(e){this.providerService=e}get isReadonly(){return!0}get scheme(){return"azurerepos"}dispose(){}async ensureAuthenticated(e=!1){const r=new Be("AzDO.ensureAuthenticated");try{if(this._session===void 0){async function n(){try{return await h.authentication.getSession(Co.id,Ds,{createIfNone:!0,forceNewSession:e})}catch{try{const o=await h.authentication.getSession(Co.id,Ds,{createIfNone:!1});if(o!==void 0)return o}catch{}return new Promise(o=>{async function a(){const l=await h.authentication.getSession(Co.id,Ds,{createIfNone:!0});l!==void 0&&o(l)}c(a,"getSession");const s=h.authentication.onDidChangeSessions(async l=>{l.provider.id===Co.id&&(s.dispose(),await a())})})}}c(n,"waitUntilAuthenticated"),this._session=await n();const i=h.authentication.onDidChangeSessions(o=>{if(this._session===void 0){i.dispose();return}o.provider.id===Co.id&&(this.clearAuthenticationSession(),i.dispose())})}return this._session}finally{r.stop()}}async getAuthentication(e){const r=await this.ensureAuthenticated();return{provider:T0,session:r,getRichNavigationHeaders:()=>({"X-Git-AzureDevOps":`Basic ${this.getBase64AuthenticationSessionToken(r)}`})}}getBase64AuthenticationSessionToken(e){if(this._sessionTokenBase64===void 0){if(e===void 0)return this.ensureAuthenticated().then(r=>(this._sessionTokenBase64=Jr(`PAT:${r.accessToken}`),this._sessionTokenBase64));this._sessionTokenBase64=Jr(`PAT:${e.accessToken}`)}return this._sessionTokenBase64}clearAuthenticationSession(){this._session=void 0,this._sessionTokenBase64=void 0}async reauthenticate(){this.clearAuthenticationSession(),await this.ensureAuthenticated(!0)}async sendGetRequest(e,r,n,i){const a=`${n?`https://dev.azure.com/${e}/${n}/_apis/`:`https://dev.azure.com/${e}/_apis/`}${r}${i?`?${i}&`:"?"}api-version=5.1`;try{const s=await this.getBase64AuthenticationSessionToken();if(!s)throw new nt("Unauthenticated",()=>this.reauthenticate());const l=await Vn(a,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Basic ${s}`}});if(l.status===401)throw new nt("Unauthenticated",()=>this.reauthenticate());if(l.status===404)return;const u=await l.json();return u!=null?u:void 0}catch(s){throw C.error(s),s instanceof nt&&Fr.showStatus401Message(s.reauthenticate),s}}async sendPostRequest(e,r){try{const n=await this.getBase64AuthenticationSessionToken();if(!n)throw new nt("Unauthenticated",()=>this.reauthenticate());const i=await Vn(e,{method:"POST",body:r,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Basic ${n}`}});if(i.status===401)throw new nt("Unauthenticated",()=>this.reauthenticate());const o=await i.json();return o!=null?o:void 0}catch(n){throw C.error(n),n instanceof nt&&Fr.showStatus401Message(n.reauthenticate),n}}canOpenRemoteUrl(e){const r=k0(e);if(r===void 0)return;const{branch:n,tag:i,commit:o,path:a}=r;return a?Ie.File:n?Ie.Branch:i?Ie.Tag:o?Ie.Commit:Ie.Repository}async createWorkspaceForRemoteUrl(e,r=$t.CurrentWindow){const n=k0(e);if(n===void 0)return;const{organization:i,project:o,repo:a,branch:s,tag:l,commit:u,path:d}=n;let p;s?p={type:ke.Branch,id:s}:l?p={type:ke.Tag,id:l}:u&&(p={type:ke.Commit,id:u});const f=this.providerService.createVirtualUri("azurerepos",{repo:{organization:i,project:o!=null?o:a,name:a},ref:p});return{name:(await this.providerService.getMetadata(f)).name,uri:f,location:r,filesToOpen:d?[d]:void 0}}createVirtualUri(e,{repo:r,ref:n,idx:i},o){if((n==null?void 0:n.type)===ke.Tree)throw new Error(`Invalid ref type '${n.type}'`);const a=n!==void 0||i!==void 0?{v:A0}:void 0;return a&&(n&&(a.ref={type:n.type,id:n.id}),i&&(a.idx=i)),e.with({authority:Dt.encodeAuthority("azurerepos",a),path:`/${r.organization}/${r.project}/${r.name}${(o==null?void 0:o.startsWith("/"))?o:`/${o!=null?o:""}`}`})}getRemoteUri(e){const r=`https://dev.azure.com/${e.repo.organization}/${e.repo.project}/_git/${e.repo.name}`,n=e.path?`&path=/${e.path}`:"";return e.pullRequest?h.Uri.parse(r):e.branch?h.Uri.parse(`${r}?version=GB${e.branch}${n}`):e.tag?h.Uri.parse(`${r}?version=GT${e.tag}${n}`):e.sha?h.Uri.parse(`${r}?version=GC${e.sha}${n}`):h.Uri.parse(r)}getProviderRootUri(e){return M_(e)}getRelativeFilePath(e,r){const{path:n}=Eo(e),{path:i}=Eo(Ue(e,r));return n.length!==0&&i!==n&&i.startsWith(n)?i.slice(n.length+1):i}getVirtualUriMetadata(e){const{provider:r,name:n,repo:i,ref:o}=Eo(e);return{provider:r,name:n,repo:i,ref:o}}async validateBranchOrTagCasing(e,r,n,i){const o=`git/repositories/${n}/refs`,a="includeLinks=true",s=await this.sendGetRequest(e,o,r,a);if((s==null?void 0:s.value)===void 0){C.warn("Could not get branches, might be incorrect auth token");return}const l=s.value;if(l.length===0)return i?{type:ke.Branch,id:i}:void 0;const u=`refs/heads/${i.toLowerCase()}`,d=`refs/tags/${i.toLowerCase()}`;for(const p of l){const f=p.name;if(f.toLowerCase()==u)return{type:ke.Branch,id:f.substr(11)};if(f.toLowerCase()==d)return{type:ke.Tag,id:f.substr(10)}}}async getModeRefType(e,r){const{HEAD:n,pullRequest:i}=await(r!=null?r:this.getMetadata(e));switch(n.type){case he.Branch:return i!==void 0?q.PullRequestBranch:q.Branch;case he.RemoteBranch:return i!==void 0?q.PullRequestRemoteBranch:q.RemoteBranch;case he.Tag:return q.Tag;case he.Commit:return q.Commit}}async createMetadata(e,r){var n,i,o,a;const s=new Be(`AzDO.createMetadata(${e.toString()}, ${r})`);let l;try{let{provider:u,name:d,repo:{organization:p,project:f,name:g},ref:x}=Eo(e);if(!x||x.type===ke.Commit&&/HEAD/i.test(x.id))x={type:ke.Commit,id:"HEAD"};else if((x.type===ke.Branch||x.type===ke.Tag)&&(x=await this.validateBranchOrTagCasing(p,f,g,x.id),x===void 0))throw new Error(`Cannot get metadata for Uri(${e.toString(!0)}); Unable to find the specified branch or tag`);const y=await this.getRepositoryInfo(p,f,g,x);if(y===void 0)throw l=" \u2022 Aborted; Unable to get repository info",new Error(`Cannot get metadata for Uri(${e.toString()}); Unable to get repository info`);let b;if(r)b=r;else if(x.type===ke.Commit)b=x.id;else if(b=(i=(n=y.ref)==null?void 0:n.sha)!=null?i:y.defaultBranch.sha,b===void 0)throw l=" \u2022 Aborted; Unable to get repository revision",new Error(`Cannot get metadata for Uri(${e.toString()}); Unable to get repository info`);let S;((o=y.ref)==null?void 0:o.prefix)==="refs/heads/"?S={type:he.Branch,name:y.ref.name,sha:b,branch:{name:y.ref.name,sha:y.ref.sha}}:((a=y.ref)==null?void 0:a.prefix)==="refs/tags/"?S={type:he.Tag,name:y.ref.name,sha:b,detached:{type:he.Tag,name:y.ref.name}}:S={type:he.Commit,name:Ve(b),sha:b,detached:{type:he.Commit,name:Ve(b)}};const E={version:Ke.schemaVersion,timestamp:Date.now(),provider:u,name:d,repo:y.repo,user:y.user,accessLevel:y.accessLevel,HEAD:S,defaultBranch:y.defaultBranch,pullRequest:y.pullRequest};return l=` \u2022 HEAD=${S.sha}`,E}finally{s.stop(l?{suffix:l}:void 0)}}getMetadata(e){return this.providerService.getMetadata(e)}getRemoteWorkspaceSourceProviders(){return[{name:"Azure Repos",icon:"$(azure-devops)",label:R0("open repo from","Open Repository from {0}","Azure Repos"),placeholder:R0("pick repo","Choose a repository"),provideOrganization:async()=>{var e;return(e=await this.getOrganization())==null?void 0:e.label},provideProject:async e=>{var r;return(r=await this.getTeamProject(e))==null?void 0:r.label},provideSources:async(e,r,n,i)=>{if(n)return;const o=await this.searchRepositoriesQuery(e,r);return o==null?void 0:o.map(a=>({providerId:"azurerepos",name:a.name,icon:"$(repo)",description:`${a.fork?`$(repo-forked) ${a.fork}`:""}${a.stars>0?`${a.fork?" \u2022 ":""}$(star-full) ${a.stars}`:""}`,detail:a.description,url:a.url}))}}]}async createBranch(e,r,n,i){throw new Error("Branch creation is currently not supported")}async createCommit(e,r,n,i){throw new Error("Commit creation is currently not supported")}async createAndPushCommit(e,r,n,i,o){throw new Error("Commit creation is currently not supported")}async createPullRequest(e,r,n,i,o){throw new Error("PR creation is currently not supported")}async fetch(e,r){const{fetched:n,metadata:i}=await this.fetchCore(e,!1,r);n&&await this.providerService.updateMetadata(e,i)}async fetchCore(e,r,n){var i,o,a,s;const{force:l,to:u}={...n,force:r||(n==null?void 0:n.force)},d=new Be(`AzDO.fetch(${e.toString()}, force=${l}, to=${u})`);let p;try{const f=await this.getMetadata(e);if(f.HEAD.detached)return p=" \u2022 Skipped; detached HEAD",{fetched:!1,metadata:f};if(f.HEAD.type===he.RemoteBranch)return p=" \u2022 Skipped; remote branch",{fetched:!1,metadata:f};const g=await this.getBranchTips(e);if(!g)throw p=" \u2022 Unable to fetch branch tips",new Qe(r);if(!l&&!u&&((i=g.defaultBranch)==null?void 0:i.sha)!==void 0&&g.defaultBranch.sha===f.defaultBranch.sha&&((o=g.branch)==null?void 0:o.sha)!==void 0&&g.branch.sha===f.HEAD.branch.sha)return p=" \u2022 No changes detected",{fetched:!1,metadata:f};let x;if(((a=g.defaultBranch)==null?void 0:a.sha)!==void 0&&g.defaultBranch.sha!==f.defaultBranch.sha&&(x={defaultBranch:{...f.defaultBranch,sha:g.defaultBranch.sha}}),((s=g.branch)==null?void 0:s.sha)===void 0){if(p=" \u2022 Unable to find branch tip",l)throw new Qe(r);return x!==void 0?{fetched:!0,metadata:{...f,...x}}:{fetched:!1,metadata:f}}return g.branch.sha!==f.HEAD.branch.sha&&(x={...x,HEAD:{...f.HEAD,branch:{...f.HEAD.branch,sha:g.branch.sha},detached:void 0}}),g.branch.sha===f.HEAD.sha?(p=" \u2022 Up to date",f.state!==void 0||x!==void 0?{fetched:!0,metadata:{...f,...x,state:void 0}}:{fetched:!1,metadata:f}):x!==void 0?{fetched:!0,metadata:{...f,...x}}:{fetched:!1,metadata:f}}finally{d.stop(p?{suffix:p}:void 0)}}async fork(e){throw new Error("Forks are currently not supported")}async getBranches(e,r){try{const n=await this.getRefs(e,{...r,filter:"heads",filterContains:r==null?void 0:r.query});if(n.length===0)return{branches:[]};const i=[];for(const o of n)!o.name.startsWith("refs/heads/")||i.push({type:Gn.Head,name:o.name.substr(11),commit:o.objectId,commitUrl:o.url});return{branches:i}}catch(n){return{branches:[]}}}async getCommit(e,r){try{const{repo:{organization:n,project:i,name:o}}=await this.getMetadata(e),a=`git/repositories/${o}/commits/${r}`,s=await this.sendGetRequest(n,a,i);return s===void 0?void 0:{hash:s.commitId,message:s.comment,parents:s.parents,authorDate:new Date(s.author.date),authorEmail:s.author.email,authorName:s.author.name,commitDate:new Date(s.committer.date)}}catch(n){return}}async getCommits(e,r){var n,i;try{const{repo:{organization:o,project:a,name:s}}=await this.getMetadata(e),l=`git/repositories/${s}/commits`;let u=`searchCriteria.itemVersion.version=${(n=r==null?void 0:r.cursor)!=null?n:r==null?void 0:r.ref}&searchCriteria.itemVersion.versionType=commit`;(r==null?void 0:r.path)&&(u+=`&searchCriteria.itemPath=${r.path}`);const d=(i=r==null?void 0:r.limit)!=null?i:100;u+=`&searchCriteria.$top=${d+1}`;const p=await this.sendGetRequest(o,l,a,u);if((p==null?void 0:p.value)===void 0)return;const f=p.value.map((x,y)=>({hash:x.commitId,message:x.comment,parents:p.value[y+1]?[p.value[y+1].commitId]:[],authorDate:new Date(x.author.date),authorEmail:x.author.email,authorName:x.author.name,commitDate:new Date(x.committer.date)}));let g;return f.length>d&&(f.splice(f.length-1,1),g={cursor:f[f.length-1].hash,more:!0}),{commits:f,paging:g}}catch(o){return}}async getFileContent(e,r,n){var i,o;try{const{HEAD:a,repo:{organization:s,project:l,id:u},path:d}=await this.providerService.getMetadata(e);n=n!=null?n:d;const p=`git/repositories/${u}/items`;let f="";n&&(f+=`path=${n}&includeContent=true`),r||Jt((i=a.branch)==null?void 0:i.name)?f+=`&versionDescriptor.version=${r!=null?r:(o=a.branch)==null?void 0:o.name}&versionDescriptor.versionType=commit`:a.type===he.Branch?f+=`&versionDescriptor.version=${a.branch.name}&versionDescriptor.versionType=branch`:a.type===he.Tag&&(f+=`&versionDescriptor.version=${a.name}&versionDescriptor.versionType=tag`);const g=await this.sendGetRequest(s,p,l,f);if(g)return new TextEncoder().encode(g.content);throw h.FileSystemError.FileNotFound(e)}catch(a){throw C.logLevel===ie.Debug&&C.error(a),a}}async getFork(e){throw new Error("Forks are currently not supported")}async getIncomingChanges(e){var r,n;return(n=(r=(await this.getMetadata(e)).state)==null?void 0:r.incomingChanges)!=null?n:[]}async compareCommits(e,r){throw new Error("Comparing commits is currently not supported")}async getObjectDetails(e,r,n){throw new Error("Not able to get object detail")}async getPullRequest(e,r){throw new Error("PRs are currently not supported")}async getRepoItems(e,r,n){const i=`git/repositories/${e.repo.name}/items`,[,,,,...o]=r.split("/");let a=`scopePath=${o.join("/")}&recursionLevel=${n.recursionLevel}&includeContentMetadata=true`;e.HEAD.type===he.Commit?a+=`&versionDescriptor.version=${e.HEAD.sha}&versionDescriptor.versionType=commit`:e.HEAD.type===he.Branch?a+=`&versionDescriptor.version=${e.HEAD.branch.name}&versionDescriptor.versionType=branch`:e.HEAD.type===he.Tag&&(a+=`&versionDescriptor.version=${e.HEAD.name}&versionDescriptor.versionType=tag`);const s=await this.sendGetRequest(e.repo.organization,i,e.repo.project,a);return s&&Array.isArray(s==null?void 0:s.value)?s==null?void 0:s.value:(C.debug(`AzDOProvider.getRepoItems returned ${s===void 0?"empty":"invalid"} result ${s==null?void 0:s.value} for path ${r}`),[])}async getTags(e,r){try{const n=await this.getRefs(e,{...r,filter:"tags",filterContains:r==null?void 0:r.query});if(n.length===0)return{tags:[]};const i=[];for(const o of n)!o.name.startsWith("refs/tags/")||i.push({type:Gn.Tag,name:o.name.substr(10),commit:o.objectId,commitUrl:o.url});return{tags:i}}catch(n){return{tags:[]}}}async getTarGz(e,r){throw new Error("Getting zip is currently not supported")}async pushCommit(e,r,n,i){throw new Error("Commit pushing is not currently supported")}async getRefs(e,r){var n;const{repo:{organization:i,project:o,name:a}}=Eo(e),s=`git/repositories/${a}/refs`;let l="includeLinks=true";(r==null?void 0:r.filter)&&(l+=`&filter=${r.filter}`),(r==null?void 0:r.filterContains)&&(l+=`&filterContains=${r.filterContains}`),(r==null?void 0:r.limit)&&(l+=`&$top=${r.limit}`);const u=await this.sendGetRequest(i,s,o,l);return(n=u==null?void 0:u.value)!=null?n:[]}async getOrganization(){const e=c(async()=>{const r=await this.getAccounts();return r?r.sort((n,i)=>n.accountName.localeCompare(i.accountName)).map(n=>({label:n.accountName})):[]},"getQuickPickItems");return h.window.showQuickPick(e(),{placeHolder:"Choose an Azure DevOps Organization",title:"Choose an Azure DevOps Organization",ignoreFocusOut:!0})}async getTeamProject(e){const r=c(async()=>{const n=await this.sendGetRequest(e,"projects");return(n==null?void 0:n.value)?n.value.sort((i,o)=>i.name.localeCompare(o.name)).map(i=>({label:i.name,description:i.description})):[]},"getQuickPickItems");return h.window.showQuickPick(r(),{placeholder:"Choose an Azure DevOps project",title:"Choose an Azure DevOps project",ignoreFocusOut:!0})}async searchRepositoriesQuery(e,r){try{const n=await this.sendGetRequest(e,"git/repositories",r);return n?n.value.filter(i=>i.defaultBranch&&!i.isDisabled).sort((i,o)=>i.name.localeCompare(o.name)).map(i=>({name:i.name,description:void 0,url:i.webUrl,fork:void 0,stars:0})):void 0}catch(n){throw C.error(n),n}}async getAccounts(){var e;try{const r=await this.getBase64AuthenticationSessionToken();if(!r)throw new nt("Unauthenticated",()=>this.reauthenticate());const i=`https://app.vssps.visualstudio.com/_apis/accounts?memberId=${(e=this._session)==null?void 0:e.account.id.split("/")[0]}&api-version=6.0`,o=await Vn(i,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Basic ${r}`}});if(o.status===401)throw new nt("Unauthenticated",()=>this.reauthenticate());return(await o.json()).value}catch(r){C.error(r);return}}async searchCodeQuery(e,r,n){var i;const{repo:{organization:o,project:a,name:s},HEAD:l,defaultBranch:u}=await this.getMetadata(r),d=`https://almsearch.dev.azure.com/${o}/${a}/_apis/search/codesearchresults?api-version=6.1-preview.1`,p=l.branch?l.branch.name:u.name,f={searchText:e,$skip:0,$top:1e3,filters:{Project:[a],Repository:[s],Path:["/"],Branch:[p]},$orderBy:[{field:"filename",sortOrder:"ASC"}],includeSnippet:!0},g=await this.sendPostRequest(d,JSON.stringify(f)),x=new h.Range(0,0,0,0),y=[];let b;for(const S of(i=g==null?void 0:g.results)!=null?i:[])for(const E of S.matches.content){b={path:S.path,ranges:[],preview:"",matches:[]};const D=Math.max(0,E.line-1),$=E.charOffset,z=$+E.length;b.preview=E.codeSnippet?E.codeSnippet:`CharOffset: ${E.charOffset}, Type: ${E.type}`,b.ranges.push(new h.Range(D,$,D,z)),b.matches.push(x),y.push(b)}return{matches:y,limitHit:!1}}async switchTo(e,r,n){const{name:i,repo:o,HEAD:{branch:a}}=await this.getMetadata(e);let s;if(!(r!==void 0&&(typeof r=="string"?r.startsWith("refs/heads/")?s={type:ke.Branch,id:r.substr(11)}:r.startsWith("refs/tags/")?s={type:ke.Tag,id:r.substr(10)}:s={type:ke.Branch,id:r}:s={...r,type:r.type===ke.Tree?ke.Branch:r.type},(a==null?void 0:a.name)===s.id)))return{name:i,uri:this.providerService.createVirtualUri(e,{repo:o,ref:s}),location:(n==null?void 0:n.openInNewWindow)?$t.NewWindow:$t.CurrentWindow}}async sync(e,r,n){var i,o,a,s,l,u;const d=new Be(`AzDO.sync(${e.toString()}, resolution=${n.conflictResolution}, to=${n.to})`);let p;try{const{metadata:f}=await this.fetchCore(e,!0,{to:n.to});if(f.HEAD.detached){p=" \u2022 Skipped; detached HEAD";return}if(((o=(i=f==null?void 0:f.state)==null?void 0:i.behind)!=null?o:0)>0&&await r.hasChanges(e)){d.logStep("Fetching upstream changes");const g=[],x=(s=(a=f.state)==null?void 0:a.incomingChanges)!=null?s:[];if(x.length>0){const y=await r.getChanges(e);for(const b of y){const S=this.providerService.getRelativeFilePath(e,b.uri),E=x.find(D=>D.uri.path===b.uri.path);if(E!==void 0){g.push({path:S,current:b,incomingType:E.type});break}}}if(g.length>0)switch(n.conflictResolution){case Br.KeepCurrent:d.logStep("Syncing (keep) upstream changes",{message:`: ${g.length} conflicts; \u2022`,suffix:" \u2022 Syncing (keep) upstream changes..."});for(const y of g)await r.keep(y.current.uri,{type:y.incomingType,providerUri:Zh(f,f.HEAD.branch.sha,y.path)});break;case Br.DiscardCurrent:d.logStep("Syncing (discard) upstream changes",{message:`: ${g.length} conflicts; \u2022`,suffix:" \u2022 Syncing (discard) upstream changes..."});for(const y of g)await r.discard(y.current.uri);break;case Br.Merge:d.logStep("Syncing (merge) upstream changes",{message:`: ${g.length} conflicts; \u2022`,suffix:" \u2022 Syncing (merge) upstream changes..."});for(const y of g)await r.merge(y.current.uri,{type:y.incomingType,providerUri:Zh(f,f.HEAD.branch.sha,y.path)},{providerUri:Zh(f,f.HEAD.sha,y.path)});break;case Br.Abort:default:throw d.logStep("Syncing (abort) upstream changes",{message:`: ${g.length} conflicts; \u2022`,suffix:" \u2022 Syncing (abort) upstream changes..."}),await this.providerService.updateMetadata(e,f),new mt}}p=` \u2022 to=${(l=n.to)!=null?l:f.HEAD.branch.sha}`,await this.fastForwardTo(e,(u=n.to)!=null?u:f.HEAD.branch.sha,f)}finally{d.stop(p?{suffix:p}:void 0)}}async fastForwardTo(e,r,n){if(n.HEAD.detached)throw new ot("Unable to fast-forward; no current branch");n.HEAD.sha===r&&n.state===void 0||(C.log(`Fast forward to ${r}; rootUri=${e.toString()}`),await this.providerService.updateMetadata(e,{...n,HEAD:{...n.HEAD,detached:void 0,sha:r},state:void 0,timestamp:Date.now()}),r!==n.HEAD.branch.sha&&await this.fetchCore(e,!1,{to:r}))}async getBranchTips(e,r){try{const{repo:{organization:n,project:i,name:o},HEAD:{branch:a}}=await this.getMetadata(e);r===void 0?r=a?`heads/${a.name}`:"":r.startsWith("refs/")&&(r=r.slice(5));const s=`git/repositories/${o}/refs`,l=`includeLinks=true&filter=${r}`,u=await this.sendGetRequest(n,s,i,l),d=u==null?void 0:u.value;if(d===[])return;const p={target:{oid:d[0].objectId}},f=`git/repositories/${o}`,g=await this.sendGetRequest(n,f,i);let x=g==null?void 0:g.defaultBranch;x.startsWith("refs/")&&(x=x.slice(5));const y=`git/repositories/${o}/refs`,b=`includeLinks=true&filter=${x}`,S=await this.sendGetRequest(n,y,i,b),E=S==null?void 0:S.value;if(E===[])return;const D={target:{oid:E[0].objectId}};if(!D&&!p)return;const $=D?{sha:D.target.oid}:void 0,z=p?{sha:p.target.oid}:void 0;return{defaultBranch:$,branch:z}}catch(n){return}}async getRepositoryId(e,r,n){const i=`git/repositories/${n}`,o=await this.sendGetRequest(e,i,r);if(o){if(o.id)return o.id;throw new Error("Sign in page was returned for repoId. Check the token sent")}throw new Error("Can't get Repo Id")}async getRepositoryInfo(e,r,n,i){const o=await this.getRepositoryId(e,r,n),a=`git/repositories/${o}`,s=await this.sendGetRequest(e,a,r);if(!s)return;s.defaultBranch.startsWith("refs/heads/")&&(s.defaultBranch=s.defaultBranch.substr(11));const l=`git/repositories/${n}/stats/branches`,u=`name=${s.defaultBranch}`,d=await this.sendGetRequest(e,l,r,u);if(!d)return;const p={user:"jepetty",repo:{organization:e,project:r,name:n,id:o},accessLevel:Se.Read,defaultBranch:{name:d.name,sha:d.commit.commitId}};if(i.type===ke.Branch){const f=`git/repositories/${n}/stats/branches`,g=`name=${i.id}`,x=await this.sendGetRequest(e,f,r,g);if(x)return{...p,ref:{name:x.name,sha:x.commit.commitId,prefix:"refs/heads/"}}}else if(i.type===ke.Tag){const f=`git/repositories/${o}/items`,g=`versionDescriptor.version=${i.id}&versionDescriptor.versionType=tag`,x=await this.sendGetRequest(e,f,r,g);if(x&&x.value.length===1)return{...p,ref:{name:i.id,sha:x.value[0].commitId,prefix:"refs/tags/"}}}else{if(i.type===ke.Commit)return i.id==="HEAD"&&(i.id=s.defaultBranch),{...p,ref:{name:i.id,sha:Jt(i.id)?i.id:d.commit.commitId,prefix:Jt(i.id)?"":"refs/heads/"}};throw new Error("Not supported yet :(")}}}c(Xh,"AzDORepositoryProvider"),$_([Sr()],Xh.prototype,"ensureAuthenticated",1);class I0{constructor(e,r){this.providerService=e,this.changeStore=r,this.providers=[],this.handledRepositories=new Set,this.services=new Map,this.disposable=h.Disposable.from(e.onDidChangeRepositories(n=>{for(const i of n.added)this.repositoryOpened(i);for(const i of n.removed)this.repositoryClosed(i)}));for(const n of this.providerService.repositories)this.repositoryOpened(n)}dispose(){this.disposable.dispose()}register(e){const r=this.providers.length;return this.providers.push(e),{dispose:()=>this.providers.splice(r,1)}}async repositoryOpened(e){const r=H(e.uri);if(!this.handledRepositories.has(r)){this.handledRepositories.add(r);for(const n of this.providers){const i=await n.createNavigationService(this.providerService,e,this.changeStore);if(i!==void 0){const o=i();this.services.set(r,{service:o});break}}}}repositoryClosed(e){const r=H(e.uri);this.handledRepositories.delete(r);const n=this.services.get(r);n!==void 0&&(n.service.dispose(),this.services.delete(H(e.uri)))}}c(I0,"CodeNavigationServices");/*! (c) Andrea Giammarchi - ISC */var Fl={};try{(function(t,e){if(new t("q=%2B").get("q")!==e||new t({q:e}).get("q")!==e||new t([["q",e]]).get("q")!==e||new t(`q=
`).toString()!=="q=%0A"||new t({q:" &"}).toString()!=="q=+%26"||new t({q:"%zx"}).toString()!=="q=%25zx")throw t;Fl.URLSearchParams=t})(URLSearchParams,"+")}catch(t){(function(e,r,n){"use strict";var i=e.create,o=e.defineProperty,a=/[!'\(\)~]|%20|%00/g,s=/%(?![0-9a-fA-F]{2})/g,l=/\+/g,u={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"},d={append:function(E,D){x(this._ungap,E,D)},delete:function(E){delete this._ungap[E]},get:function(E){return this.has(E)?this._ungap[E][0]:null},getAll:function(E){return this.has(E)?this._ungap[E].slice(0):[]},has:function(E){return E in this._ungap},set:function(E,D){this._ungap[E]=[r(D)]},forEach:function(E,D){var $=this;for(var z in $._ungap)$._ungap[z].forEach(re,z);function re(ne){E.call(D,ne,r(z),$)}c(re,"invoke")},toJSON:function(){return{}},toString:function(){var E=[];for(var D in this._ungap)for(var $=b(D),z=0,re=this._ungap[D];z<re.length;z++)E.push($+"="+b(re[z]));return E.join("&")}};for(var p in d)o(f.prototype,p,{configurable:!0,writable:!0,value:d[p]});Fl.URLSearchParams=f;function f(E){var D=i(null);switch(o(this,"_ungap",{value:D}),!0){case!E:break;case typeof E=="string":E.charAt(0)==="?"&&(E=E.slice(1));for(var $=E.split("&"),z=0,re=$.length;z<re;z++){var ne=$[z],ee=ne.indexOf("=");-1<ee?x(D,y(ne.slice(0,ee)),y(ne.slice(ee+1))):ne.length&&x(D,y(ne),"")}break;case n(E):for(var z=0,re=E.length;z<re;z++){var ne=E[z];x(D,ne[0],ne[1])}break;case"forEach"in E:E.forEach(g,D);break;default:for(var we in E)x(D,we,E[we])}}c(f,"URLSearchParams");function g(E,D){x(this,D,E)}c(g,"addEach");function x(E,D,$){var z=n($)?$.join(","):$;D in E?E[D].push(z):E[D]=[z]}c(x,"appendTo");function y(E){return decodeURIComponent(E.replace(s,"%25").replace(l," "))}c(y,"decode");function b(E){return encodeURIComponent(E).replace(a,S)}c(b,"encode");function S(E){return u[E]}c(S,"replacer")})(Object,String,Array.isArray)}(function(t){var e=!1;try{e=!!Symbol.iterator}catch(n){}"forEach"in t||(t.forEach=c(function(i,o){var a=this,s=Object.create(null);this.toString().replace(/=[\s\S]*?(?:&|$)/g,"=").split("=").forEach(function(l){!l.length||l in s||(s[l]=a.getAll(l)).forEach(function(u){i.call(o,u,l,a)})})},"forEach")),"keys"in t||(t.keys=c(function(){return r(this,function(i,o){this.push(o)})},"keys")),"values"in t||(t.values=c(function(){return r(this,function(i,o){this.push(i)})},"values")),"entries"in t||(t.entries=c(function(){return r(this,function(i,o){this.push([o,i])})},"entries")),e&&!(Symbol.iterator in t)&&(t[Symbol.iterator]=t.entries),"sort"in t||(t.sort=c(function(){for(var i=this.entries(),o=i.next(),a=o.done,s=[],l=Object.create(null),u,d,p;!a;)p=o.value,d=p[0],s.push(d),d in l||(l[d]=[]),l[d].push(p[1]),o=i.next(),a=o.done;for(s.sort(),u=0;u<s.length;u++)this.delete(s[u]);for(u=0;u<s.length;u++)d=s[u],this.append(d,l[d].shift())},"sort"));function r(n,i){var o=[];return n.forEach(i,o),e?o[Symbol.iterator]():{next:function(){var a=o.shift();return{done:a===void 0,value:a}}}}c(r,"iterator"),function(n){var i=n.defineProperty,o=n.getOwnPropertyDescriptor,a=c(function(p){function f(y,b){t.append.call(this,y,b),y=this.toString(),p.set.call(this._usp,y?"?"+y:"")}c(f,"append");function g(y){t.delete.call(this,y),y=this.toString(),p.set.call(this._usp,y?"?"+y:"")}c(g,"del");function x(y,b){t.set.call(this,y,b),y=this.toString(),p.set.call(this._usp,y?"?"+y:"")}return c(x,"set"),function(y,b){return y.append=f,y.delete=g,y.set=x,i(y,"_usp",{configurable:!0,writable:!0,value:b})}},"createSearchParamsPollute"),s=c(function(p){return function(f,g){return i(f,"_searchParams",{configurable:!0,writable:!0,value:p(g,f)}),g}},"createSearchParamsCreate"),l=c(function(p){var f=p.append;p.append=t.append,URLSearchParams.call(p,p._usp.search.slice(1)),p.append=f},"updateSearchParams"),u=c(function(p,f){if(!(p instanceof f))throw new TypeError("'searchParams' accessed on an object that does not implement interface "+f.name)},"verifySearchParams"),d=c(function(p){var f=p.prototype,g=o(f,"searchParams"),x=o(f,"href"),y=o(f,"search"),b;!g&&y&&y.set&&(b=s(a(y)),n.defineProperties(f,{href:{get:function(){return x.get.call(this)},set:function(S){var E=this._searchParams;x.set.call(this,S),E&&l(E)}},search:{get:function(){return y.get.call(this)},set:function(S){var E=this._searchParams;y.set.call(this,S),E&&l(E)}},searchParams:{get:function(){return u(this,p),this._searchParams||b(this,new URLSearchParams(this.search.slice(1)))},set:function(S){u(this,p),b(this,S)}}}))},"upgradeClass");try{d(HTMLAnchorElement),/^function|object$/.test(typeof URL)&&URL.prototype&&d(URL)}catch(p){}}(Object)})(Fl.URLSearchParams.prototype,Object);const D0=Fl.URLSearchParams;var B_=__webpack_require__(6822);const tt=(0,A.loadMessageBundle)(),Qh=60,Yh=Qh*60,Ns=Yh*24,P0=Ns*7,F0=Ns*30,$0=Ns*365;function Ms(t,e){typeof t!="number"&&(t=t.getTime());const r=Math.round((new Date().getTime()-t)/1e3);if(r<-30)return tt("date.fromNow.in","in {0}",Ms(new Date().getTime()+r*1e3,{ago:!1,short:e==null?void 0:e.short}));if(r<30)return(e==null?void 0:e.ago)?(e==null?void 0:e.short)?tt("date.fromNow.seconds.short.ago","secs ago"):tt("date.fromNow.seconds.ago","A few seconds ago"):(e==null?void 0:e.short)?tt("date.fromNow.now.short","now"):tt("date.fromNow.now","Just now");let n;return r<Qh?(n=r,(e==null?void 0:e.ago)?n===1?(e==null?void 0:e.short)?tt("date.fromNow.seconds.singular.short.ago","{0} sec ago",n):tt("date.fromNow.seconds.singular.ago","{0} second ago",n):(e==null?void 0:e.short)?tt("date.fromNow.seconds.plural.short.ago","{0} secs ago",n):tt("date.fromNow.seconds.plural.ago","{0} seconds ago",n):n===1?(e==null?void 0:e.short)?tt("date.fromNow.seconds.singular.short","{0} sec",n):tt("date.fromNow.seconds.singular","{0} second",n):(e==null?void 0:e.short)?tt("date.fromNow.seconds.plural.short","{0} secs",n):tt("date.fromNow.seconds.plural","{0} seconds",n)):r<Yh?(n=Math.floor(r/Qh),(e==null?void 0:e.ago)?n===1?(e==null?void 0:e.short)?tt("date.fromNow.minutes.singular.short.ago","{0} min ago",n):tt("date.fromNow.minutes.singular.ago","{0} minute ago",n):(e==null?void 0:e.short)?tt("date.fromNow.minutes.plural.short.ago","{0} mins ago",n):tt("date.fromNow.minutes.plural.ago","{0} minutes ago",n):n===1?(e==null?void 0:e.short)?tt("date.fromNow.minutes.singular.short","{0} min",n):tt("date.fromNow.minutes.singular","{0} minute",n):(e==null?void 0:e.short)?tt("date.fromNow.minutes.plural.short","{0} mins",n):tt("date.fromNow.minutes.plural","{0} minutes",n)):r<Ns?(n=Math.floor(r/Yh),(e==null?void 0:e.ago)?n===1?(e==null?void 0:e.short)?tt("date.fromNow.hours.singular.short.ago","{0} hr ago",n):tt("date.fromNow.hours.singular.ago","{0} hour ago",n):(e==null?void 0:e.short)?tt("date.fromNow.hours.plural.short.ago","{0} hrs ago",n):tt("date.fromNow.hours.plural.ago","{0} hours ago",n):n===1?(e==null?void 0:e.short)?tt("date.fromNow.hours.singular.short","{0} hr",n):tt("date.fromNow.hours.singular","{0} hour",n):(e==null?void 0:e.short)?tt("date.fromNow.hours.plural.short","{0} hrs",n):tt("date.fromNow.hours.plural","{0} hours",n)):r<P0?(n=Math.floor(r/Ns),(e==null?void 0:e.ago)?n===1?tt("date.fromNow.days.singular.ago","{0} day ago",n):tt("date.fromNow.days.plural.ago","{0} days ago",n):n===1?tt("date.fromNow.days.singular","{0} day",n):tt("date.fromNow.days.plural","{0} days",n)):r<F0?(n=Math.floor(r/P0),(e==null?void 0:e.ago)?n===1?(e==null?void 0:e.short)?tt("date.fromNow.weeks.singular.short.ago","{0} wk ago",n):tt("date.fromNow.weeks.singular.ago","{0} week ago",n):(e==null?void 0:e.short)?tt("date.fromNow.weeks.plural.short.ago","{0} wks ago",n):tt("date.fromNow.weeks.plural.ago","{0} weeks ago",n):n===1?(e==null?void 0:e.short)?tt("date.fromNow.weeks.singular.short","{0} wk",n):tt("date.fromNow.weeks.singular","{0} week",n):(e==null?void 0:e.short)?tt("date.fromNow.weeks.plural.short","{0} wks",n):tt("date.fromNow.weeks.plural","{0} weeks",n)):r<$0?(n=Math.floor(r/F0),(e==null?void 0:e.ago)?n===1?(e==null?void 0:e.short)?tt("date.fromNow.months.singular.short.ago","{0} mo ago",n):tt("date.fromNow.months.singular.ago","{0} month ago",n):(e==null?void 0:e.short)?tt("date.fromNow.months.plural.short.ago","{0} mos ago",n):tt("date.fromNow.months.plural.ago","{0} months ago",n):n===1?(e==null?void 0:e.short)?tt("date.fromNow.months.singular.short","{0} mo",n):tt("date.fromNow.months.singular","{0} month",n):(e==null?void 0:e.short)?tt("date.fromNow.months.plural.short","{0} mos",n):tt("date.fromNow.months.plural","{0} months",n)):(n=Math.floor(r/$0),(e==null?void 0:e.ago)?n===1?(e==null?void 0:e.short)?tt("date.fromNow.years.singular.short.ago","{0} yr ago",n):tt("date.fromNow.years.singular.ago","{0} year ago",n):(e==null?void 0:e.short)?tt("date.fromNow.years.plural.short.ago","{0} yrs ago",n):tt("date.fromNow.years.plural.ago","{0} years ago",n):n===1?(e==null?void 0:e.short)?tt("date.fromNow.years.singular.short","{0} yr",n):tt("date.fromNow.years.singular","{0} year",n):(e==null?void 0:e.short)?tt("date.fromNow.years.plural.short","{0} yrs",n):tt("date.fromNow.years.plural","{0} years",n))}c(Ms,"fromNow");var N0,$r;(function(t){t.None=0,t.First=1,t.AsOld=t.First,t.Last=2,t.AsNew=t.Last})($r||($r={}));class M0{constructor(){this[N0]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return(e=this._head)==null?void 0:e.value}get last(){var e;return(e=this._tail)==null?void 0:e.value}has(e){return this._map.has(e)}get(e,r=$r.None){const n=this._map.get(e);if(!!n)return r!==$r.None&&this.touch(n,r),n.value}set(e,r,n=$r.None){let i=this._map.get(e);if(i)i.value=r,n!==$r.None&&this.touch(i,n);else{switch(i={key:e,value:r,next:void 0,previous:void 0},n){case $r.None:this.addItemLast(i);break;case $r.First:this.addItemFirst(i);break;case $r.Last:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i),this._size++}return this}delete(e){return Boolean(this.remove(e))}remove(e){const r=this._map.get(e);if(!!r)return this._map.delete(e),this.removeItem(r),this._size--,r.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,r){const n=this._state;let i=this._head;for(;i;){if(r?e.bind(r)(i.value,i.key,this):e(i.value,i.key,this),this._state!==n)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){const e=this._state;let r=this._head;const n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(r){const i={value:r.key,done:!1};return r=r.next,i}return{value:void 0,done:!0}}};return n}values(){const e=this._state;let r=this._head;const n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(r){const i={value:r.value,done:!1};return r=r.next,i}return{value:void 0,done:!0}}};return n}entries(){const e=this._state;let r=this._head;const n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(r){const i={value:[r.key,r.value],done:!1};return r=r.next,i}return{value:void 0,done:!0}}};return n}[(N0=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let r=this._head,n=this.size;for(;r&&n>e;)this._map.delete(r.key),r=r.next,n--;this._head=r,this._size=n,r&&(r.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const r=e.next,n=e.previous;if(!r||!n)throw new Error("Invalid list");r.previous=n,n.next=r}e.next=void 0,e.previous=void 0,this._state++}touch(e,r){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(r!==$r.First&&r!==$r.Last)){if(r===$r.First){if(e===this._head)return;const n=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(n.previous=i,i.next=n),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(r===$r.Last){if(e===this._tail)return;const n=e.next,i=e.previous;e===this._head?(n.previous=void 0,this._head=n):(n.previous=i,i.next=n),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){const e=[];return this.forEach((r,n)=>{e.push([n,r])}),e}fromJSON(e){this.clear();for(const[r,n]of e)this.set(r,n)}}c(M0,"LinkedMap");class Si extends M0{constructor(e,r=1){super();this._limit=e,this._ratio=Math.min(Math.max(0,r),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,r=$r.AsNew){return super.get(e,r)}peek(e){return super.get(e,$r.None)}set(e,r){return super.set(e,r,$r.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}c(Si,"LRUCache");function O_(t,e,r){return new Ki(new Jh(t),new Jh(e)).ComputeDiff(r).changes}c(O_,"stringDiff");class Ci{constructor(e,r,n,i){this.originalStart=e,this.originalLength=r,this.modifiedStart=n,this.modifiedLength=i}getOriginalEnd(){return this.originalStart+this.originalLength}getModifiedEnd(){return this.modifiedStart+this.modifiedLength}}c(Ci,"DiffChange");var B0;(function(t){t[t.MAX_SAFE_SMALL_INTEGER=1073741824]="MAX_SAFE_SMALL_INTEGER",t[t.MIN_SAFE_SMALL_INTEGER=-1073741824]="MIN_SAFE_SMALL_INTEGER",t[t.MAX_UINT_8=255]="MAX_UINT_8",t[t.MAX_UINT_16=65535]="MAX_UINT_16",t[t.MAX_UINT_32=4294967295]="MAX_UINT_32",t[t.UNICODE_SUPPLEMENTARY_PLANE_BEGIN=65536]="UNICODE_SUPPLEMENTARY_PLANE_BEGIN"})(B0||(B0={}));function O0(t,e){return(e<<5)-e+t|0}c(O0,"numberHash");function U_(t,e){e=O0(149417,e);for(let r=0,n=t.length;r<n;r++)e=O0(t.charCodeAt(r),e);return e}c(U_,"stringHash");class Jh{constructor(e){this.source=e}getElements(){const e=this.source,r=new Int32Array(e.length);for(let n=0,i=e.length;n<i;n++)r[n]=e.charCodeAt(n);return r}}c(Jh,"StringDiffSequence");class Ro{static Assert(e,r){if(!e)throw new Error(r)}}c(Ro,"Debug");class Ao{static Copy(e,r,n,i,o){for(let a=0;a<o;a++)n[i+a]=e[r+a]}static Copy2(e,r,n,i,o){for(let a=0;a<o;a++)n[i+a]=e[r+a]}}c(Ao,"MyArray");var U0;(function(t){t[t.MaxDifferencesHistory=1447]="MaxDifferencesHistory"})(U0||(U0={}));class ef{constructor(){this.m_changes=[],this.m_originalStart=1073741824,this.m_modifiedStart=1073741824,this.m_originalCount=0,this.m_modifiedCount=0}MarkNextChange(){(this.m_originalCount>0||this.m_modifiedCount>0)&&this.m_changes.push(new Ci(this.m_originalStart,this.m_originalCount,this.m_modifiedStart,this.m_modifiedCount)),this.m_originalCount=0,this.m_modifiedCount=0,this.m_originalStart=1073741824,this.m_modifiedStart=1073741824}AddOriginalElement(e,r){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,r),this.m_originalCount++}AddModifiedElement(e,r){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,r),this.m_modifiedCount++}getChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes}getReverseChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes.reverse(),this.m_changes}}c(ef,"DiffChangeHelper");class Ki{constructor(e,r,n=null){this.ContinueProcessingPredicate=n,this._originalSequence=e,this._modifiedSequence=r;const[i,o,a]=Ki._getElements(e),[s,l,u]=Ki._getElements(r);this._hasStrings=a&&u,this._originalStringElements=i,this._originalElementsOrHash=o,this._modifiedStringElements=s,this._modifiedElementsOrHash=l,this.m_forwardHistory=[],this.m_reverseHistory=[]}static _isStringArray(e){return e.length>0&&typeof e[0]=="string"}static _getElements(e){const r=e.getElements();if(Ki._isStringArray(r)){const n=new Int32Array(r.length);for(let i=0,o=r.length;i<o;i++)n[i]=U_(r[i],0);return[r,n,!0]}return r instanceof Int32Array?[[],r,!1]:[[],new Int32Array(r),!1]}ElementsAreEqual(e,r){return this._originalElementsOrHash[e]!==this._modifiedElementsOrHash[r]?!1:this._hasStrings?this._originalStringElements[e]===this._modifiedStringElements[r]:!0}ElementsAreStrictEqual(e,r){if(!this.ElementsAreEqual(e,r))return!1;const n=Ki._getStrictElement(this._originalSequence,e),i=Ki._getStrictElement(this._modifiedSequence,r);return n===i}static _getStrictElement(e,r){return typeof e.getStrictElement=="function"?e.getStrictElement(r):null}OriginalElementsAreEqual(e,r){return this._originalElementsOrHash[e]!==this._originalElementsOrHash[r]?!1:this._hasStrings?this._originalStringElements[e]===this._originalStringElements[r]:!0}ModifiedElementsAreEqual(e,r){return this._modifiedElementsOrHash[e]!==this._modifiedElementsOrHash[r]?!1:this._hasStrings?this._modifiedStringElements[e]===this._modifiedStringElements[r]:!0}ComputeDiff(e){return this._ComputeDiff(0,this._originalElementsOrHash.length-1,0,this._modifiedElementsOrHash.length-1,e)}_ComputeDiff(e,r,n,i,o){const a=[!1];let s=this.ComputeDiffRecursive(e,r,n,i,a);return o&&(s=this.PrettifyChanges(s)),{quitEarly:a[0],changes:s}}ComputeDiffRecursive(e,r,n,i,o){for(o[0]=!1;e<=r&&n<=i&&this.ElementsAreEqual(e,n);)e++,n++;for(;r>=e&&i>=n&&this.ElementsAreEqual(r,i);)r--,i--;if(e>r||n>i){let p;return n<=i?(Ro.Assert(e===r+1,"originalStart should only be one more than originalEnd"),p=[new Ci(e,0,n,i-n+1)]):e<=r?(Ro.Assert(n===i+1,"modifiedStart should only be one more than modifiedEnd"),p=[new Ci(e,r-e+1,n,0)]):(Ro.Assert(e===r+1,"originalStart should only be one more than originalEnd"),Ro.Assert(n===i+1,"modifiedStart should only be one more than modifiedEnd"),p=[]),p}const a=[0],s=[0],l=this.ComputeRecursionPoint(e,r,n,i,a,s,o),u=a[0],d=s[0];if(l!==null)return l;if(!o[0]){const p=this.ComputeDiffRecursive(e,u,n,d,o);let f=[];return o[0]?f=[new Ci(u+1,r-(u+1)+1,d+1,i-(d+1)+1)]:f=this.ComputeDiffRecursive(u+1,r,d+1,i,o),this.ConcatenateChanges(p,f)}return[new Ci(e,r-e+1,n,i-n+1)]}WALKTRACE(e,r,n,i,o,a,s,l,u,d,p,f,g,x,y,b,S,E){let D=null,$=null,z=new ef,re=r,ne=n,ee=g[0]-b[0]-i,we=-1073741824,oe=this.m_forwardHistory.length-1;do{const ge=ee+e;ge===re||ge<ne&&u[ge-1]<u[ge+1]?(p=u[ge+1],x=p-ee-i,p<we&&z.MarkNextChange(),we=p,z.AddModifiedElement(p+1,x),ee=ge+1-e):(p=u[ge-1]+1,x=p-ee-i,p<we&&z.MarkNextChange(),we=p-1,z.AddOriginalElement(p,x+1),ee=ge-1-e),oe>=0&&(u=this.m_forwardHistory[oe],e=u[0],re=1,ne=u.length-1)}while(--oe>=-1);if(D=z.getReverseChanges(),E[0]){let ge=g[0]+1,Ee=b[0]+1;if(D!==null&&D.length>0){const et=D[D.length-1];ge=Math.max(ge,et.getOriginalEnd()),Ee=Math.max(Ee,et.getModifiedEnd())}$=[new Ci(ge,f-ge+1,Ee,y-Ee+1)]}else{z=new ef,re=a,ne=s,ee=g[0]-b[0]-l,we=1073741824,oe=S?this.m_reverseHistory.length-1:this.m_reverseHistory.length-2;do{const ge=ee+o;ge===re||ge<ne&&d[ge-1]>=d[ge+1]?(p=d[ge+1]-1,x=p-ee-l,p>we&&z.MarkNextChange(),we=p+1,z.AddOriginalElement(p+1,x+1),ee=ge+1-o):(p=d[ge-1],x=p-ee-l,p>we&&z.MarkNextChange(),we=p,z.AddModifiedElement(p+1,x+1),ee=ge-1-o),oe>=0&&(d=this.m_reverseHistory[oe],o=d[0],re=1,ne=d.length-1)}while(--oe>=-1);$=z.getChanges()}return this.ConcatenateChanges(D,$)}ComputeRecursionPoint(e,r,n,i,o,a,s){let l=0,u=0,d=0,p=0,f=0,g=0;e--,n--,o[0]=0,a[0]=0,this.m_forwardHistory=[],this.m_reverseHistory=[];const x=r-e+(i-n),y=x+1,b=new Int32Array(y),S=new Int32Array(y),E=i-n,D=r-e,$=e-n,z=r-i,ne=(D-E)%2==0;b[E]=e,S[D]=r,s[0]=!1;for(let ee=1;ee<=x/2+1;ee++){let we=0,oe=0;d=this.ClipDiagonalBound(E-ee,ee,E,y),p=this.ClipDiagonalBound(E+ee,ee,E,y);for(let Ee=d;Ee<=p;Ee+=2){Ee===d||Ee<p&&b[Ee-1]<b[Ee+1]?l=b[Ee+1]:l=b[Ee-1]+1,u=l-(Ee-E)-$;const et=l;for(;l<r&&u<i&&this.ElementsAreEqual(l+1,u+1);)l++,u++;if(b[Ee]=l,l+u>we+oe&&(we=l,oe=u),!ne&&Math.abs(Ee-D)<=ee-1&&l>=S[Ee])return o[0]=l,a[0]=u,et<=S[Ee]&&1447>0&&ee<=1447+1?this.WALKTRACE(E,d,p,$,D,f,g,z,b,S,l,r,o,u,i,a,ne,s):null}const ge=(we-e+(oe-n)-ee)/2;if(this.ContinueProcessingPredicate!==null&&!this.ContinueProcessingPredicate(we,ge))return s[0]=!0,o[0]=we,a[0]=oe,ge>0&&1447>0&&ee<=1447+1?this.WALKTRACE(E,d,p,$,D,f,g,z,b,S,l,r,o,u,i,a,ne,s):(e++,n++,[new Ci(e,r-e+1,n,i-n+1)]);f=this.ClipDiagonalBound(D-ee,ee,D,y),g=this.ClipDiagonalBound(D+ee,ee,D,y);for(let Ee=f;Ee<=g;Ee+=2){Ee===f||Ee<g&&S[Ee-1]>=S[Ee+1]?l=S[Ee+1]-1:l=S[Ee-1],u=l-(Ee-D)-z;const et=l;for(;l>e&&u>n&&this.ElementsAreEqual(l,u);)l--,u--;if(S[Ee]=l,ne&&Math.abs(Ee-E)<=ee&&l<=b[Ee])return o[0]=l,a[0]=u,et>=b[Ee]&&1447>0&&ee<=1447+1?this.WALKTRACE(E,d,p,$,D,f,g,z,b,S,l,r,o,u,i,a,ne,s):null}if(ee<=1447){let Ee=new Int32Array(p-d+2);Ee[0]=E-d+1,Ao.Copy2(b,d,Ee,1,p-d+1),this.m_forwardHistory.push(Ee),Ee=new Int32Array(g-f+2),Ee[0]=D-f+1,Ao.Copy2(S,f,Ee,1,g-f+1),this.m_reverseHistory.push(Ee)}}return this.WALKTRACE(E,d,p,$,D,f,g,z,b,S,l,r,o,u,i,a,ne,s)}PrettifyChanges(e){for(let r=0;r<e.length;r++){const n=e[r],i=r<e.length-1?e[r+1].originalStart:this._originalElementsOrHash.length,o=r<e.length-1?e[r+1].modifiedStart:this._modifiedElementsOrHash.length,a=n.originalLength>0,s=n.modifiedLength>0;for(;n.originalStart+n.originalLength<i&&n.modifiedStart+n.modifiedLength<o&&(!a||this.OriginalElementsAreEqual(n.originalStart,n.originalStart+n.originalLength))&&(!s||this.ModifiedElementsAreEqual(n.modifiedStart,n.modifiedStart+n.modifiedLength));){const u=this.ElementsAreStrictEqual(n.originalStart,n.modifiedStart);if(this.ElementsAreStrictEqual(n.originalStart+n.originalLength,n.modifiedStart+n.modifiedLength)&&!u)break;n.originalStart++,n.modifiedStart++}let l=[null];if(r<e.length-1&&this.ChangesOverlap(e[r],e[r+1],l)){e[r]=l[0],e.splice(r+1,1),r--;continue}}for(let r=e.length-1;r>=0;r--){const n=e[r];let i=0,o=0;if(r>0){const p=e[r-1];i=p.originalStart+p.originalLength,o=p.modifiedStart+p.modifiedLength}const a=n.originalLength>0,s=n.modifiedLength>0;let l=0,u=this._boundaryScore(n.originalStart,n.originalLength,n.modifiedStart,n.modifiedLength);for(let p=1;;p++){const f=n.originalStart-p,g=n.modifiedStart-p;if(f<i||g<o||a&&!this.OriginalElementsAreEqual(f,f+n.originalLength)||s&&!this.ModifiedElementsAreEqual(g,g+n.modifiedLength))break;const y=(f===i&&g===o?5:0)+this._boundaryScore(f,n.originalLength,g,n.modifiedLength);y>u&&(u=y,l=p)}n.originalStart-=l,n.modifiedStart-=l;const d=[null];if(r>0&&this.ChangesOverlap(e[r-1],e[r],d)){e[r-1]=d[0],e.splice(r,1),r++;continue}}if(this._hasStrings)for(let r=1,n=e.length;r<n;r++){const i=e[r-1],o=e[r],a=o.originalStart-i.originalStart-i.originalLength,s=i.originalStart,l=o.originalStart+o.originalLength,u=l-s,d=i.modifiedStart,p=o.modifiedStart+o.modifiedLength,f=p-d;if(a<5&&u<20&&f<20){const g=this._findBetterContiguousSequence(s,u,d,f,a);if(g){const[x,y]=g;(x!==i.originalStart+i.originalLength||y!==i.modifiedStart+i.modifiedLength)&&(i.originalLength=x-i.originalStart,i.modifiedLength=y-i.modifiedStart,o.originalStart=x+a,o.modifiedStart=y+a,o.originalLength=l-o.originalStart,o.modifiedLength=p-o.modifiedStart)}}}return e}_findBetterContiguousSequence(e,r,n,i,o){if(r<o||i<o)return null;const a=e+r-o+1,s=n+i-o+1;let l=0,u=0,d=0;for(let p=e;p<a;p++)for(let f=n;f<s;f++){const g=this._contiguousSequenceScore(p,f,o);g>0&&g>l&&(l=g,u=p,d=f)}return l>0?[u,d]:null}_contiguousSequenceScore(e,r,n){let i=0;for(let o=0;o<n;o++){if(!this.ElementsAreEqual(e+o,r+o))return 0;i+=this._originalStringElements[e+o].length}return i}_OriginalIsBoundary(e){return e<=0||e>=this._originalElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._originalStringElements[e])}_OriginalRegionIsBoundary(e,r){if(this._OriginalIsBoundary(e)||this._OriginalIsBoundary(e-1))return!0;if(r>0){const n=e+r;if(this._OriginalIsBoundary(n-1)||this._OriginalIsBoundary(n))return!0}return!1}_ModifiedIsBoundary(e){return e<=0||e>=this._modifiedElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._modifiedStringElements[e])}_ModifiedRegionIsBoundary(e,r){if(this._ModifiedIsBoundary(e)||this._ModifiedIsBoundary(e-1))return!0;if(r>0){const n=e+r;if(this._ModifiedIsBoundary(n-1)||this._ModifiedIsBoundary(n))return!0}return!1}_boundaryScore(e,r,n,i){const o=this._OriginalRegionIsBoundary(e,r)?1:0,a=this._ModifiedRegionIsBoundary(n,i)?1:0;return o+a}ConcatenateChanges(e,r){let n=[];if(e.length===0||r.length===0)return r.length>0?r:e;if(this.ChangesOverlap(e[e.length-1],r[0],n)){const i=new Array(e.length+r.length-1);return Ao.Copy(e,0,i,0,e.length-1),i[e.length-1]=n[0],Ao.Copy(r,1,i,e.length,r.length-1),i}else{const i=new Array(e.length+r.length);return Ao.Copy(e,0,i,0,e.length),Ao.Copy(r,0,i,e.length,r.length),i}}ChangesOverlap(e,r,n){if(Ro.Assert(e.originalStart<=r.originalStart,"Left change is not less than or equal to right change"),Ro.Assert(e.modifiedStart<=r.modifiedStart,"Left change is not less than or equal to right change"),e.originalStart+e.originalLength>=r.originalStart||e.modifiedStart+e.modifiedLength>=r.modifiedStart){const i=e.originalStart;let o=e.originalLength;const a=e.modifiedStart;let s=e.modifiedLength;return e.originalStart+e.originalLength>=r.originalStart&&(o=r.originalStart+r.originalLength-e.originalStart),e.modifiedStart+e.modifiedLength>=r.modifiedStart&&(s=r.modifiedStart+r.modifiedLength-e.modifiedStart),n[0]=new Ci(i,o,a,s),!0}else return n[0]=null,!1}ClipDiagonalBound(e,r,n,i){if(e>=0&&e<i)return e;const o=n,a=i-n-1,s=r%2==0;if(e<0){const l=o%2==0;return s===l?0:1}else{const l=a%2==0;return s===l?i-1:i-2}}}c(Ki,"LcsDiff");var tf;(function(t){function e(n,i){return n instanceof Sa?i:new h.Position(i.line,i.character)}c(e,"makePosition"),t.makePosition=e;function r(n,i){return n instanceof Sa?i:new h.Range(i.start.line,i.start.character,i.end.line,i.end.character)}c(r,"makeRange"),t.makeRange=r})(tf||(tf={}));var L0;(function(t){t[t.index2code=1]="index2code",t[t.code2Index=2]="code2Index"})(L0||(L0={}));const H0=c(class{constructor(t,e,r,n){this.diffCache=new Si(32),this.indexDocumentCache=new Si(32),this.codeDocumentCache=new Si(32),this.providerService=t,this.rootUri=e,this.index=r,this.code=n,this.changes=this.computeChanges()}async computeChanges(){if(this.index===this.code)return new Map;const t=await this.providerService.compareCommits(this.rootUri,{base:this.index,compare:this.code});return t===void 0?new Map:new Map(t.map(e=>[e.uri.toString(),e.type]))}async needsMapping(t){const e=t.uri;if(!e.toString().startsWith(this.rootUri.toString()))return!1;if((await this.changes).get(e.toString())!==void 0)return!0;const i=await this.getIndexDocument(e);return i===void 0?!0:this.getDiff(1,i,t).length!==0}async mapPositionFromCodeToIndex(t,e){const r=t.uri;if(!r.toString().startsWith(this.rootUri.toString()))return;const i=(await this.changes).get(r.toString());if(i===ut.Created||i===ut.Deleted)return;const o=await this.getIndexDocument(r);if(o===void 0)return;const a=this.getDiff(2,o,t);if(a.length===0)return e;const s=t.offsetAt(new h.Position(e.line,e.character));let l=s;for(const f of a){if(f.modifiedStart<=s&&s<f.modifiedStart+f.modifiedLength)return;if(l<f.modifiedStart)break;l=l-(f.modifiedLength-f.originalLength)}const u=o.positionAt(l),d=this.getWordAtOffset(o.lineAt(u.line).text,u.character),p=this.getWordAtOffset(t.lineAt(e.line).text,e.character);if(!(d===void 0||p===void 0||d!==p))return new h.Position(u.line,u.character)}async mapRangeFromIndexToCode(t,e){const r=t instanceof h.Uri?t:t.uri;if(!r.toString().startsWith(this.rootUri.toString()))return;const i=(await this.changes).get(r.toString());if(i===ut.Created||i===ut.Deleted)return;const[o,a]=await Promise.all([this.getIndexDocument(r),this.getCodeDocument(t)]);if(o===void 0||a===void 0)return;const s=this.getDiff(1,o,a);if(s.length===0)return e;const l=o.offsetAt(e.start);let u=l;const d=o.offsetAt(e.end);let p=d;for(const b of s){if(p<b.originalStart)break;const S=b.modifiedLength-b.originalLength;if(b.originalStart<=l){if(l<b.originalStart+b.originalLength)return;u+=S}else if(d<b.originalStart+b.originalLength)return;if(b.originalStart<=d){if(d<b.originalStart+b.originalLength)return;p+=S}}const f=a.positionAt(u),g=a.positionAt(p),x=o.getText(e),y=a.getText(tf.makeRange(a,{start:f,end:g}));if(x===y)return new h.Range(f.line,f.character,g.line,g.character)}async getIndexDocument(t){return this.getDocument(this.indexDocumentCache,t,this.index)}async getCodeDocument(t){return t instanceof h.Uri?this.getDocument(this.codeDocumentCache,t,this.code):t}async getDocument(t,e,r){let n=t.get(e.toString());if(n!==null)return n!==void 0||(n=this._getDocument(e,r),t.set(e.toString(),n),n.then(i=>{i===void 0&&t.set(e.toString(),null)},void 0)),n}async _getDocument(t,e){const r=t.toString().substr(this.rootUri.toString().length);return this.providerService.getFileContent(this.rootUri,e,r).then(n=>new Sa(t,Number.MAX_VALUE,H0.textDecoder.decode(n)),()=>{})}getDiff(t,e,r){if(e.uri.toString()!==r.uri.toString())throw new Error(`Original (${e.uri.toString()}) and modified (${r.uri.toString()}) are pointing to a different document`);const n=`${t}${e.uri.toString()}`;let i=this.diffCache.get(n);return i!==void 0&&i.original===e.version&&i.modified===r.version||(i={original:e.version,modified:r.version,changes:O_(e.getText(),r.getText(),!0)},this.diffCache.set(n,i)),i.changes}getWordAtOffset(t,e){let r="findStart",n=0,i=t.length,o=0;for(;o<t.length&&r!=="endFound";){switch(o===e&&(r="findEnd"),t[o]){case" ":case"	":case"(":case")":case"[":case"]":case"{":case"}":case"'":case'"':case"`":switch(r){case"findStart":n=o+1;break;case"findEnd":i=o,r="endFound";break}break}o++}return r==="endFound"?t.substring(n,i):void 0}},"_DiffMapper");let z0=H0;z0.textDecoder=new TextDecoder("utf8");var W0;(function(t){t[t.LineFeed=10]="LineFeed",t[t.CarriageReturn=13]="CarriageReturn"})(W0||(W0={}));class Sa{static computeLineOffsets(e,r,n=0){const i=r?[n]:[];for(let o=0;o<e.length;o++){const a=e.charCodeAt(o);(a===13||a===10)&&(a===13&&o+1<e.length&&e.charCodeAt(o+1)===10&&o++,i.push(n+o+1))}return i}constructor(e,r,n){this._content=n,this.uri=e,this.version=r,this._lineOffsets=void 0}getLineOffsets(){return this._lineOffsets===void 0&&(this._lineOffsets=Sa.computeLineOffsets(this._content,!0)),this._lineOffsets}getText(e){if(e){const r=this.offsetAt(e.start),n=this.offsetAt(e.end);return this._content.substring(r,n)}return this._content}lineAt(e){const r=this.getLineOffsets();if(e>=r.length)return{lineNumber:e,text:""};const n=r[e],i=r[e+1];if(i===void 0)return{lineNumber:e,text:this._content.substring(n)};const o=this._content.substring(n,i);let a=o.length-1;for(;a>=0&&(o[a]===`
`||o[a]==="\r");)a--;return{lineNumber:e,text:o.substr(0,a+1)}}positionAt(e){e=Math.max(Math.min(e,this._content.length),0);const r=this.getLineOffsets();let n=0,i=r.length;if(i===0)return{line:0,character:e};for(;n<i;){const a=Math.floor((n+i)/2);r[a]>e?i=a:n=a+1}const o=n-1;return{line:o,character:e-r[o]}}offsetAt(e){const r=this.getLineOffsets();if(e.line>=r.length)return this._content.length;if(e.line<0)return 0;const n=r[e.line],i=e.line+1<r.length?r[e.line+1]:this._content.length;return Math.max(Math.min(n+e.character,i),n)}get lineCount(){return this.getLineOffsets().length}}c(Sa,"TextDocument");var q0;(function(t){t.MIN_VALUE=-2147483648,t.MAX_VALUE=2147483647})(q0||(q0={}));var $l;(function(t){t.MIN_VALUE=0,t.MAX_VALUE=2147483647})($l||($l={}));var Kn;(function(t){function e(n,i){return n===Number.MAX_VALUE&&(n=$l.MAX_VALUE),i===Number.MAX_VALUE&&(i=$l.MAX_VALUE),{line:n,character:i}}c(e,"create"),t.create=e;function r(n){var i=n;return pe.objectLiteral(i)&&pe.uinteger(i.line)&&pe.uinteger(i.character)}c(r,"is"),t.is=r})(Kn||(Kn={}));var Rr;(function(t){function e(n,i,o,a){if(pe.uinteger(n)&&pe.uinteger(i)&&pe.uinteger(o)&&pe.uinteger(a))return{start:Kn.create(n,i),end:Kn.create(o,a)};if(Kn.is(n)&&Kn.is(i))return{start:n,end:i};throw new Error("Range#create called with invalid arguments["+n+", "+i+", "+o+", "+a+"]")}c(e,"create"),t.create=e;function r(n){var i=n;return pe.objectLiteral(i)&&Kn.is(i.start)&&Kn.is(i.end)}c(r,"is"),t.is=r})(Rr||(Rr={}));var rf;(function(t){function e(n,i){return{uri:n,range:i}}c(e,"create"),t.create=e;function r(n){var i=n;return pe.defined(i)&&Rr.is(i.range)&&(pe.string(i.uri)||pe.undefined(i.uri))}c(r,"is"),t.is=r})(rf||(rf={}));var Nl;(function(t){function e(n,i,o,a){return{targetUri:n,targetRange:i,targetSelectionRange:o,originSelectionRange:a}}c(e,"create"),t.create=e;function r(n){var i=n;return pe.defined(i)&&Rr.is(i.targetRange)&&pe.string(i.targetUri)&&(Rr.is(i.targetSelectionRange)||pe.undefined(i.targetSelectionRange))&&(Rr.is(i.originSelectionRange)||pe.undefined(i.originSelectionRange))}c(r,"is"),t.is=r})(Nl||(Nl={}));var nf;(function(t){function e(n,i,o,a){return{red:n,green:i,blue:o,alpha:a}}c(e,"create"),t.create=e;function r(n){var i=n;return pe.numberRange(i.red,0,1)&&pe.numberRange(i.green,0,1)&&pe.numberRange(i.blue,0,1)&&pe.numberRange(i.alpha,0,1)}c(r,"is"),t.is=r})(nf||(nf={}));var j0;(function(t){function e(n,i){return{range:n,color:i}}c(e,"create"),t.create=e;function r(n){var i=n;return Rr.is(i.range)&&nf.is(i.color)}c(r,"is"),t.is=r})(j0||(j0={}));var V0;(function(t){function e(n,i,o){return{label:n,textEdit:i,additionalTextEdits:o}}c(e,"create"),t.create=e;function r(n){var i=n;return pe.string(i.label)&&(pe.undefined(i.textEdit)||Zi.is(i))&&(pe.undefined(i.additionalTextEdits)||pe.typedArray(i.additionalTextEdits,Zi.is))}c(r,"is"),t.is=r})(V0||(V0={}));var Bs;(function(t){t.Comment="comment",t.Imports="imports",t.Region="region"})(Bs||(Bs={}));var G0;(function(t){function e(n,i,o,a,s){var l={startLine:n,endLine:i};return pe.defined(o)&&(l.startCharacter=o),pe.defined(a)&&(l.endCharacter=a),pe.defined(s)&&(l.kind=s),l}c(e,"create"),t.create=e;function r(n){var i=n;return pe.uinteger(i.startLine)&&pe.uinteger(i.startLine)&&(pe.undefined(i.startCharacter)||pe.uinteger(i.startCharacter))&&(pe.undefined(i.endCharacter)||pe.uinteger(i.endCharacter))&&(pe.undefined(i.kind)||pe.string(i.kind))}c(r,"is"),t.is=r})(G0||(G0={}));var of;(function(t){function e(n,i){return{location:n,message:i}}c(e,"create"),t.create=e;function r(n){var i=n;return pe.defined(i)&&rf.is(i.location)&&pe.string(i.message)}c(r,"is"),t.is=r})(of||(of={}));var Ca;(function(t){t.Error=1,t.Warning=2,t.Information=3,t.Hint=4})(Ca||(Ca={}));var Ml;(function(t){t.Unnecessary=1,t.Deprecated=2})(Ml||(Ml={}));var af;(function(t){function e(r){var n=r;return n!=null&&pe.string(n.href)}c(e,"is"),t.is=e})(af||(af={}));var Bl;(function(t){function e(n,i,o,a,s,l){var u={range:n,message:i};return pe.defined(o)&&(u.severity=o),pe.defined(a)&&(u.code=a),pe.defined(s)&&(u.source=s),pe.defined(l)&&(u.relatedInformation=l),u}c(e,"create"),t.create=e;function r(n){var i,o=n;return pe.defined(o)&&Rr.is(o.range)&&pe.string(o.message)&&(pe.number(o.severity)||pe.undefined(o.severity))&&(pe.integer(o.code)||pe.string(o.code)||pe.undefined(o.code))&&(pe.undefined(o.codeDescription)||pe.string((i=o.codeDescription)===null||i===void 0?void 0:i.href))&&(pe.string(o.source)||pe.undefined(o.source))&&(pe.undefined(o.relatedInformation)||pe.typedArray(o.relatedInformation,of.is))}c(r,"is"),t.is=r})(Bl||(Bl={}));var Os;(function(t){function e(n,i){for(var o=[],a=2;a<arguments.length;a++)o[a-2]=arguments[a];var s={title:n,command:i};return pe.defined(o)&&o.length>0&&(s.arguments=o),s}c(e,"create"),t.create=e;function r(n){var i=n;return pe.defined(i)&&pe.string(i.title)&&pe.string(i.command)}c(r,"is"),t.is=r})(Os||(Os={}));var Zi;(function(t){function e(o,a){return{range:o,newText:a}}c(e,"replace"),t.replace=e;function r(o,a){return{range:{start:o,end:o},newText:a}}c(r,"insert"),t.insert=r;function n(o){return{range:o,newText:""}}c(n,"del"),t.del=n;function i(o){var a=o;return pe.objectLiteral(a)&&pe.string(a.newText)&&Rr.is(a.range)}c(i,"is"),t.is=i})(Zi||(Zi={}));var Ea;(function(t){function e(n,i,o){var a={label:n};return i!==void 0&&(a.needsConfirmation=i),o!==void 0&&(a.description=o),a}c(e,"create"),t.create=e;function r(n){var i=n;return i!==void 0&&pe.objectLiteral(i)&&pe.string(i.label)&&(pe.boolean(i.needsConfirmation)||i.needsConfirmation===void 0)&&(pe.string(i.description)||i.description===void 0)}c(r,"is"),t.is=r})(Ea||(Ea={}));var Nr;(function(t){function e(r){var n=r;return typeof n=="string"}c(e,"is"),t.is=e})(Nr||(Nr={}));var Xi;(function(t){function e(o,a,s){return{range:o,newText:a,annotationId:s}}c(e,"replace"),t.replace=e;function r(o,a,s){return{range:{start:o,end:o},newText:a,annotationId:s}}c(r,"insert"),t.insert=r;function n(o,a){return{range:o,newText:"",annotationId:a}}c(n,"del"),t.del=n;function i(o){var a=o;return Zi.is(a)&&(Ea.is(a.annotationId)||Nr.is(a.annotationId))}c(i,"is"),t.is=i})(Xi||(Xi={}));var Us;(function(t){function e(n,i){return{textDocument:n,edits:i}}c(e,"create"),t.create=e;function r(n){var i=n;return pe.defined(i)&&Ul.is(i.textDocument)&&Array.isArray(i.edits)}c(r,"is"),t.is=r})(Us||(Us={}));var Ra;(function(t){function e(n,i,o){var a={kind:"create",uri:n};return i!==void 0&&(i.overwrite!==void 0||i.ignoreIfExists!==void 0)&&(a.options=i),o!==void 0&&(a.annotationId=o),a}c(e,"create"),t.create=e;function r(n){var i=n;return i&&i.kind==="create"&&pe.string(i.uri)&&(i.options===void 0||(i.options.overwrite===void 0||pe.boolean(i.options.overwrite))&&(i.options.ignoreIfExists===void 0||pe.boolean(i.options.ignoreIfExists)))&&(i.annotationId===void 0||Nr.is(i.annotationId))}c(r,"is"),t.is=r})(Ra||(Ra={}));var Aa;(function(t){function e(n,i,o,a){var s={kind:"rename",oldUri:n,newUri:i};return o!==void 0&&(o.overwrite!==void 0||o.ignoreIfExists!==void 0)&&(s.options=o),a!==void 0&&(s.annotationId=a),s}c(e,"create"),t.create=e;function r(n){var i=n;return i&&i.kind==="rename"&&pe.string(i.oldUri)&&pe.string(i.newUri)&&(i.options===void 0||(i.options.overwrite===void 0||pe.boolean(i.options.overwrite))&&(i.options.ignoreIfExists===void 0||pe.boolean(i.options.ignoreIfExists)))&&(i.annotationId===void 0||Nr.is(i.annotationId))}c(r,"is"),t.is=r})(Aa||(Aa={}));var Ta;(function(t){function e(n,i,o){var a={kind:"delete",uri:n};return i!==void 0&&(i.recursive!==void 0||i.ignoreIfNotExists!==void 0)&&(a.options=i),o!==void 0&&(a.annotationId=o),a}c(e,"create"),t.create=e;function r(n){var i=n;return i&&i.kind==="delete"&&pe.string(i.uri)&&(i.options===void 0||(i.options.recursive===void 0||pe.boolean(i.options.recursive))&&(i.options.ignoreIfNotExists===void 0||pe.boolean(i.options.ignoreIfNotExists)))&&(i.annotationId===void 0||Nr.is(i.annotationId))}c(r,"is"),t.is=r})(Ta||(Ta={}));var sf;(function(t){function e(r){var n=r;return n&&(n.changes!==void 0||n.documentChanges!==void 0)&&(n.documentChanges===void 0||n.documentChanges.every(function(i){return pe.string(i.kind)?Ra.is(i)||Aa.is(i)||Ta.is(i):Us.is(i)}))}c(e,"is"),t.is=e})(sf||(sf={}));var Ol=function(){function t(e,r){this.edits=e,this.changeAnnotations=r}return c(t,"TextEditChangeImpl"),t.prototype.insert=function(e,r,n){var i,o;if(n===void 0?i=Zi.insert(e,r):Nr.is(n)?(o=n,i=Xi.insert(e,r,n)):(this.assertChangeAnnotations(this.changeAnnotations),o=this.changeAnnotations.manage(n),i=Xi.insert(e,r,o)),this.edits.push(i),o!==void 0)return o},t.prototype.replace=function(e,r,n){var i,o;if(n===void 0?i=Zi.replace(e,r):Nr.is(n)?(o=n,i=Xi.replace(e,r,n)):(this.assertChangeAnnotations(this.changeAnnotations),o=this.changeAnnotations.manage(n),i=Xi.replace(e,r,o)),this.edits.push(i),o!==void 0)return o},t.prototype.delete=function(e,r){var n,i;if(r===void 0?n=Zi.del(e):Nr.is(r)?(i=r,n=Xi.del(e,r)):(this.assertChangeAnnotations(this.changeAnnotations),i=this.changeAnnotations.manage(r),n=Xi.del(e,i)),this.edits.push(n),i!==void 0)return i},t.prototype.add=function(e){this.edits.push(e)},t.prototype.all=function(){return this.edits},t.prototype.clear=function(){this.edits.splice(0,this.edits.length)},t.prototype.assertChangeAnnotations=function(e){if(e===void 0)throw new Error("Text edit change is not configured to manage change annotations.")},t}(),K0=function(){function t(e){this._annotations=e===void 0?Object.create(null):e,this._counter=0,this._size=0}return c(t,"ChangeAnnotations"),t.prototype.all=function(){return this._annotations},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),t.prototype.manage=function(e,r){var n;if(Nr.is(e)?n=e:(n=this.nextId(),r=e),this._annotations[n]!==void 0)throw new Error("Id "+n+" is already in use.");if(r===void 0)throw new Error("No annotation provided for id "+n);return this._annotations[n]=r,this._size++,n},t.prototype.nextId=function(){return this._counter++,this._counter.toString()},t}(),hR=function(){function t(e){var r=this;this._textEditChanges=Object.create(null),e!==void 0?(this._workspaceEdit=e,e.documentChanges?(this._changeAnnotations=new K0(e.changeAnnotations),e.changeAnnotations=this._changeAnnotations.all(),e.documentChanges.forEach(function(n){if(Us.is(n)){var i=new Ol(n.edits,r._changeAnnotations);r._textEditChanges[n.textDocument.uri]=i}})):e.changes&&Object.keys(e.changes).forEach(function(n){var i=new Ol(e.changes[n]);r._textEditChanges[n]=i})):this._workspaceEdit={}}return c(t,"WorkspaceChange"),Object.defineProperty(t.prototype,"edit",{get:function(){return this.initDocumentChanges(),this._changeAnnotations!==void 0&&(this._changeAnnotations.size===0?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),t.prototype.getTextEditChange=function(e){if(Ul.is(e)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var r={uri:e.uri,version:e.version},n=this._textEditChanges[r.uri];if(!n){var i=[],o={textDocument:r,edits:i};this._workspaceEdit.documentChanges.push(o),n=new Ol(i,this._changeAnnotations),this._textEditChanges[r.uri]=n}return n}else{if(this.initChanges(),this._workspaceEdit.changes===void 0)throw new Error("Workspace edit is not configured for normal text edit changes.");var n=this._textEditChanges[e];if(!n){var i=[];this._workspaceEdit.changes[e]=i,n=new Ol(i),this._textEditChanges[e]=n}return n}},t.prototype.initDocumentChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._changeAnnotations=new K0,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},t.prototype.initChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._workspaceEdit.changes=Object.create(null))},t.prototype.createFile=function(e,r,n){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var i;Ea.is(r)||Nr.is(r)?i=r:n=r;var o,a;if(i===void 0?o=Ra.create(e,n):(a=Nr.is(i)?i:this._changeAnnotations.manage(i),o=Ra.create(e,n,a)),this._workspaceEdit.documentChanges.push(o),a!==void 0)return a},t.prototype.renameFile=function(e,r,n,i){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var o;Ea.is(n)||Nr.is(n)?o=n:i=n;var a,s;if(o===void 0?a=Aa.create(e,r,i):(s=Nr.is(o)?o:this._changeAnnotations.manage(o),a=Aa.create(e,r,i,s)),this._workspaceEdit.documentChanges.push(a),s!==void 0)return s},t.prototype.deleteFile=function(e,r,n){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var i;Ea.is(r)||Nr.is(r)?i=r:n=r;var o,a;if(i===void 0?o=Ta.create(e,n):(a=Nr.is(i)?i:this._changeAnnotations.manage(i),o=Ta.create(e,n,a)),this._workspaceEdit.documentChanges.push(o),a!==void 0)return a},t}(),Z0;(function(t){function e(n){return{uri:n}}c(e,"create"),t.create=e;function r(n){var i=n;return pe.defined(i)&&pe.string(i.uri)}c(r,"is"),t.is=r})(Z0||(Z0={}));var X0;(function(t){function e(n,i){return{uri:n,version:i}}c(e,"create"),t.create=e;function r(n){var i=n;return pe.defined(i)&&pe.string(i.uri)&&pe.integer(i.version)}c(r,"is"),t.is=r})(X0||(X0={}));var Ul;(function(t){function e(n,i){return{uri:n,version:i}}c(e,"create"),t.create=e;function r(n){var i=n;return pe.defined(i)&&pe.string(i.uri)&&(i.version===null||pe.integer(i.version))}c(r,"is"),t.is=r})(Ul||(Ul={}));var Q0;(function(t){function e(n,i,o,a){return{uri:n,languageId:i,version:o,text:a}}c(e,"create"),t.create=e;function r(n){var i=n;return pe.defined(i)&&pe.string(i.uri)&&pe.string(i.languageId)&&pe.integer(i.version)&&pe.string(i.text)}c(r,"is"),t.is=r})(Q0||(Q0={}));var Ei;(function(t){t.PlainText="plaintext",t.Markdown="markdown"})(Ei||(Ei={})),function(t){function e(r){var n=r;return n===t.PlainText||n===t.Markdown}c(e,"is"),t.is=e}(Ei||(Ei={}));var cf;(function(t){function e(r){var n=r;return pe.objectLiteral(r)&&Ei.is(n.kind)&&pe.string(n.value)}c(e,"is"),t.is=e})(cf||(cf={}));var Y0;(function(t){t.Text=1,t.Method=2,t.Function=3,t.Constructor=4,t.Field=5,t.Variable=6,t.Class=7,t.Interface=8,t.Module=9,t.Property=10,t.Unit=11,t.Value=12,t.Enum=13,t.Keyword=14,t.Snippet=15,t.Color=16,t.File=17,t.Reference=18,t.Folder=19,t.EnumMember=20,t.Constant=21,t.Struct=22,t.Event=23,t.Operator=24,t.TypeParameter=25})(Y0||(Y0={}));var J0;(function(t){t.PlainText=1,t.Snippet=2})(J0||(J0={}));var ev;(function(t){t.Deprecated=1})(ev||(ev={}));var tv;(function(t){function e(n,i,o){return{newText:n,insert:i,replace:o}}c(e,"create"),t.create=e;function r(n){var i=n;return i&&pe.string(i.newText)&&Rr.is(i.insert)&&Rr.is(i.replace)}c(r,"is"),t.is=r})(tv||(tv={}));var rv;(function(t){t.asIs=1,t.adjustIndentation=2})(rv||(rv={}));var nv;(function(t){function e(r){return{label:r}}c(e,"create"),t.create=e})(nv||(nv={}));var iv;(function(t){function e(r,n){return{items:r||[],isIncomplete:!!n}}c(e,"create"),t.create=e})(iv||(iv={}));var Ll;(function(t){function e(n){return n.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}c(e,"fromPlainText"),t.fromPlainText=e;function r(n){var i=n;return pe.string(i)||pe.objectLiteral(i)&&pe.string(i.language)&&pe.string(i.value)}c(r,"is"),t.is=r})(Ll||(Ll={}));var ov;(function(t){function e(r){var n=r;return!!n&&pe.objectLiteral(n)&&(cf.is(n.contents)||Ll.is(n.contents)||pe.typedArray(n.contents,Ll.is))&&(r.range===void 0||Rr.is(r.range))}c(e,"is"),t.is=e})(ov||(ov={}));var av;(function(t){function e(r,n){return n?{label:r,documentation:n}:{label:r}}c(e,"create"),t.create=e})(av||(av={}));var sv;(function(t){function e(r,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var a={label:r};return pe.defined(n)&&(a.documentation=n),pe.defined(i)?a.parameters=i:a.parameters=[],a}c(e,"create"),t.create=e})(sv||(sv={}));var Ls;(function(t){t.Text=1,t.Read=2,t.Write=3})(Ls||(Ls={}));var cv;(function(t){function e(r,n){var i={range:r};return pe.number(n)&&(i.kind=n),i}c(e,"create"),t.create=e})(cv||(cv={}));var lf;(function(t){t.File=1,t.Module=2,t.Namespace=3,t.Package=4,t.Class=5,t.Method=6,t.Property=7,t.Field=8,t.Constructor=9,t.Enum=10,t.Interface=11,t.Function=12,t.Variable=13,t.Constant=14,t.String=15,t.Number=16,t.Boolean=17,t.Array=18,t.Object=19,t.Key=20,t.Null=21,t.EnumMember=22,t.Struct=23,t.Event=24,t.Operator=25,t.TypeParameter=26})(lf||(lf={}));var uf;(function(t){t.Deprecated=1})(uf||(uf={}));var lv;(function(t){function e(r,n,i,o,a){var s={name:r,kind:n,location:{uri:o,range:i}};return a&&(s.containerName=a),s}c(e,"create"),t.create=e})(lv||(lv={}));var uv;(function(t){function e(n,i,o,a,s,l){var u={name:n,detail:i,kind:o,range:a,selectionRange:s};return l!==void 0&&(u.children=l),u}c(e,"create"),t.create=e;function r(n){var i=n;return i&&pe.string(i.name)&&pe.number(i.kind)&&Rr.is(i.range)&&Rr.is(i.selectionRange)&&(i.detail===void 0||pe.string(i.detail))&&(i.deprecated===void 0||pe.boolean(i.deprecated))&&(i.children===void 0||Array.isArray(i.children))&&(i.tags===void 0||Array.isArray(i.tags))}c(r,"is"),t.is=r})(uv||(uv={}));var Zn;(function(t){t.Empty="",t.QuickFix="quickfix",t.Refactor="refactor",t.RefactorExtract="refactor.extract",t.RefactorInline="refactor.inline",t.RefactorRewrite="refactor.rewrite",t.Source="source",t.SourceOrganizeImports="source.organizeImports",t.SourceFixAll="source.fixAll"})(Zn||(Zn={}));var dv;(function(t){function e(n,i){var o={diagnostics:n};return i!=null&&(o.only=i),o}c(e,"create"),t.create=e;function r(n){var i=n;return pe.defined(i)&&pe.typedArray(i.diagnostics,Bl.is)&&(i.only===void 0||pe.typedArray(i.only,pe.string))}c(r,"is"),t.is=r})(dv||(dv={}));var hv;(function(t){function e(n,i,o){var a={title:n},s=!0;return typeof i=="string"?(s=!1,a.kind=i):Os.is(i)?a.command=i:a.edit=i,s&&o!==void 0&&(a.kind=o),a}c(e,"create"),t.create=e;function r(n){var i=n;return i&&pe.string(i.title)&&(i.diagnostics===void 0||pe.typedArray(i.diagnostics,Bl.is))&&(i.kind===void 0||pe.string(i.kind))&&(i.edit!==void 0||i.command!==void 0)&&(i.command===void 0||Os.is(i.command))&&(i.isPreferred===void 0||pe.boolean(i.isPreferred))&&(i.edit===void 0||sf.is(i.edit))}c(r,"is"),t.is=r})(hv||(hv={}));var fv;(function(t){function e(n,i){var o={range:n};return pe.defined(i)&&(o.data=i),o}c(e,"create"),t.create=e;function r(n){var i=n;return pe.defined(i)&&Rr.is(i.range)&&(pe.undefined(i.command)||Os.is(i.command))}c(r,"is"),t.is=r})(fv||(fv={}));var pv;(function(t){function e(n,i){return{tabSize:n,insertSpaces:i}}c(e,"create"),t.create=e;function r(n){var i=n;return pe.defined(i)&&pe.uinteger(i.tabSize)&&pe.boolean(i.insertSpaces)}c(r,"is"),t.is=r})(pv||(pv={}));var gv;(function(t){function e(n,i,o){return{range:n,target:i,data:o}}c(e,"create"),t.create=e;function r(n){var i=n;return pe.defined(i)&&Rr.is(i.range)&&(pe.undefined(i.target)||pe.string(i.target))}c(r,"is"),t.is=r})(gv||(gv={}));var mv;(function(t){function e(n,i){return{range:n,parent:i}}c(e,"create"),t.create=e;function r(n){var i=n;return i!==void 0&&Rr.is(i.range)&&(i.parent===void 0||t.is(i.parent))}c(r,"is"),t.is=r})(mv||(mv={}));var fR=null,vv;(function(t){function e(o,a,s,l){return new L_(o,a,s,l)}c(e,"create"),t.create=e;function r(o){var a=o;return!!(pe.defined(a)&&pe.string(a.uri)&&(pe.undefined(a.languageId)||pe.string(a.languageId))&&pe.uinteger(a.lineCount)&&pe.func(a.getText)&&pe.func(a.positionAt)&&pe.func(a.offsetAt))}c(r,"is"),t.is=r;function n(o,a){for(var s=o.getText(),l=i(a,function(x,y){var b=x.range.start.line-y.range.start.line;return b===0?x.range.start.character-y.range.start.character:b}),u=s.length,d=l.length-1;d>=0;d--){var p=l[d],f=o.offsetAt(p.range.start),g=o.offsetAt(p.range.end);if(g<=u)s=s.substring(0,f)+p.newText+s.substring(g,s.length);else throw new Error("Overlapping edit");u=f}return s}c(n,"applyEdits"),t.applyEdits=n;function i(o,a){if(o.length<=1)return o;var s=o.length/2|0,l=o.slice(0,s),u=o.slice(s);i(l,a),i(u,a);for(var d=0,p=0,f=0;d<l.length&&p<u.length;){var g=a(l[d],u[p]);g<=0?o[f++]=l[d++]:o[f++]=u[p++]}for(;d<l.length;)o[f++]=l[d++];for(;p<u.length;)o[f++]=u[p++];return o}c(i,"mergeSort")})(vv||(vv={}));var L_=function(){function t(e,r,n,i){this._uri=e,this._languageId=r,this._version=n,this._content=i,this._lineOffsets=void 0}return c(t,"FullTextDocument"),Object.defineProperty(t.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),t.prototype.getText=function(e){if(e){var r=this.offsetAt(e.start),n=this.offsetAt(e.end);return this._content.substring(r,n)}return this._content},t.prototype.update=function(e,r){this._content=e.text,this._version=r,this._lineOffsets=void 0},t.prototype.getLineOffsets=function(){if(this._lineOffsets===void 0){for(var e=[],r=this._content,n=!0,i=0;i<r.length;i++){n&&(e.push(i),n=!1);var o=r.charAt(i);n=o==="\r"||o===`
`,o==="\r"&&i+1<r.length&&r.charAt(i+1)===`
`&&i++}n&&r.length>0&&e.push(r.length),this._lineOffsets=e}return this._lineOffsets},t.prototype.positionAt=function(e){e=Math.max(Math.min(e,this._content.length),0);var r=this.getLineOffsets(),n=0,i=r.length;if(i===0)return Kn.create(0,e);for(;n<i;){var o=Math.floor((n+i)/2);r[o]>e?i=o:n=o+1}var a=n-1;return Kn.create(a,e-r[a])},t.prototype.offsetAt=function(e){var r=this.getLineOffsets();if(e.line>=r.length)return this._content.length;if(e.line<0)return 0;var n=r[e.line],i=e.line+1<r.length?r[e.line+1]:this._content.length;return Math.max(Math.min(n+e.character,i),n)},Object.defineProperty(t.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),t}(),pe;(function(t){var e=Object.prototype.toString;function r(g){return typeof g!="undefined"}c(r,"defined"),t.defined=r;function n(g){return typeof g=="undefined"}c(n,"undefined"),t.undefined=n;function i(g){return g===!0||g===!1}c(i,"boolean"),t.boolean=i;function o(g){return e.call(g)==="[object String]"}c(o,"string"),t.string=o;function a(g){return e.call(g)==="[object Number]"}c(a,"number"),t.number=a;function s(g,x,y){return e.call(g)==="[object Number]"&&x<=g&&g<=y}c(s,"numberRange"),t.numberRange=s;function l(g){return e.call(g)==="[object Number]"&&-2147483648<=g&&g<=2147483647}c(l,"integer"),t.integer=l;function u(g){return e.call(g)==="[object Number]"&&0<=g&&g<=2147483647}c(u,"uinteger"),t.uinteger=u;function d(g){return e.call(g)==="[object Function]"}c(d,"func"),t.func=d;function p(g){return g!==null&&typeof g=="object"}c(p,"objectLiteral"),t.objectLiteral=p;function f(g,x){return Array.isArray(g)&&g.every(x)}c(f,"typedArray"),t.typedArray=f})(pe||(pe={}));var Hs;(function(t){function e(n){return typeof n=="string"||n instanceof String}c(e,"string"),t.string=e;function r(n){return typeof n=="number"||n instanceof Number}c(r,"number"),t.number=r})(Hs||(Hs={}));var df;(function(t){function e(r){const n=r;return n!=null&&(Hs.number(n.value)||Hs.string(n.value))&&Hs.string(n.target)}c(e,"is"),t.is=e})(df||(df={}));class wv extends h.Diagnostic{constructor(e,r,n,i){super(e,r,n);this.data=i,this.hasDiagnosticCode=!1}}c(wv,"ProtocolDiagnostic");var Xn;(function(t){const e=Object.prototype.toString;function r(d){return typeof d!="undefined"}c(r,"defined"),t.defined=r;function n(d){return d===!0||d===!1}c(n,"boolean"),t.boolean=n;function i(d){return e.call(d)==="[object String]"}c(i,"string"),t.string=i;function o(d){return e.call(d)==="[object Number]"}c(o,"number"),t.number=o;function a(d){return d!==null&&typeof d=="object"}c(a,"objectLiteral"),t.objectLiteral=a;function s(d){return Array.isArray(d)}c(s,"array"),t.array=s;function l(d){return s(d)&&d.every(p=>i(p))}c(l,"stringArray"),t.stringArray=l;function u(d,p){return Array.isArray(d)&&d.every(p)}c(u,"typedArray"),t.typedArray=u})(Xn||(Xn={}));var Hl;(function(t){function e(r){const n=r;return n&&Xn.string(n.language)&&Xn.string(n.value)}c(e,"is"),t.is=e})(Hl||(Hl={}));function H_(t){const e=c(W=>h.Uri.parse(W),"nullConverter"),r=t!=null?t:e;function n(W){return r(W)}c(n,"asUri");function i(W){return W.map(o)}c(i,"asDiagnostics");function o(W){const Pe=new wv(p(W.range),W.message,g(W.severity),W.data);return W.code!==void 0&&(af.is(W.codeDescription)?Pe.code={value:W.code,target:n(W.codeDescription.href)}:df.is(W.code)?(Pe.hasDiagnosticCode=!0,Pe.code={value:W.code.value,target:n(W.code.target)}):Pe.code=W.code),W.source&&(Pe.source=W.source),W.relatedInformation&&(Pe.relatedInformation=a(W.relatedInformation)),Array.isArray(W.tags)&&(Pe.tags=l(W.tags)),Pe}c(o,"asDiagnostic");function a(W){return W.map(s)}c(a,"asRelatedInformation");function s(W){return new h.DiagnosticRelatedInformation(ee(W.location),W.message)}c(s,"asDiagnosticRelatedInformation");function l(W){if(!W)return;const Pe=[];for(const wt of W){const Tr=u(wt);Tr!==void 0&&Pe.push(Tr)}return Pe.length>0?Pe:void 0}c(l,"asDiagnosticTags");function u(W){switch(W){case Ml.Unnecessary:return h.DiagnosticTag.Unnecessary;case Ml.Deprecated:return h.DiagnosticTag.Deprecated;default:return}}c(u,"asDiagnosticTag");function d(W){if(!!W)return new h.Position(W.line,W.character)}c(d,"asPosition");function p(W){if(!!W)return new h.Range(d(W.start),d(W.end))}c(p,"asRange");function f(W){return W.map(Pe=>p(Pe))}c(f,"asRanges");function g(W){if(W==null)return h.DiagnosticSeverity.Error;switch(W){case Ca.Error:return h.DiagnosticSeverity.Error;case Ca.Warning:return h.DiagnosticSeverity.Warning;case Ca.Information:return h.DiagnosticSeverity.Information;case Ca.Hint:return h.DiagnosticSeverity.Hint}return h.DiagnosticSeverity.Error}c(g,"asDiagnosticSeverity");function x(W){if(Xn.string(W))return new h.MarkdownString(W);if(Hl.is(W))return new h.MarkdownString().appendCodeblock(W.value,W.language);if(Array.isArray(W)){const wt=[];for(const Tr of W){const vc=new h.MarkdownString;Hl.is(Tr)?vc.appendCodeblock(Tr.value,Tr.language):vc.appendMarkdown(Tr),wt.push(vc)}return wt}let Pe;switch(W.kind){case Ei.Markdown:return new h.MarkdownString(W.value);case Ei.PlainText:return Pe=new h.MarkdownString,Pe.appendText(W.value),Pe;default:return Pe=new h.MarkdownString,Pe.appendText(`Unsupported Markup content received. Kind is: ${W.kind}`),Pe}}c(x,"asHoverContent");function y(W){if(Xn.string(W))return W;switch(W.kind){case Ei.Markdown:return new h.MarkdownString(W.value);case Ei.PlainText:return W.value;default:return`Unsupported Markup content received. Kind is: ${W.kind}`}}c(y,"asDocumentation");function b(W){if(!!W)return new h.Hover(x(W.contents),p(W.range))}c(b,"asHover");function S(W){if(!!W)return new h.TextEdit(p(W.range),W.newText)}c(S,"asTextEdit");function E(W){if(!!W)return W.map(S)}c(E,"asTextEdits");function D(W){if(!W)return;const Pe=new h.SignatureHelp;return Xn.number(W.activeSignature)?Pe.activeSignature=W.activeSignature:Pe.activeSignature=0,Xn.number(W.activeParameter)?Pe.activeParameter=W.activeParameter:Pe.activeParameter=0,W.signatures&&(Pe.signatures=$(W.signatures)),Pe}c(D,"asSignatureHelp");function $(W){return W.map(z)}c($,"asSignatureInformations");function z(W){const Pe=new h.SignatureInformation(W.label);return W.documentation!==void 0&&(Pe.documentation=y(W.documentation)),W.parameters!==void 0&&(Pe.parameters=re(W.parameters)),W.activeParameter!==void 0&&(Pe.activeParameter=W.activeParameter),Pe}c(z,"asSignatureInformation");function re(W){return W.map(ne)}c(re,"asParameterInformations");function ne(W){const Pe=new h.ParameterInformation(W.label);return W.documentation&&(Pe.documentation=y(W.documentation)),Pe}c(ne,"asParameterInformation");function ee(W){if(!!W)return new h.Location(r(W.uri),p(W.range))}c(ee,"asLocation");function we(W){if(!!W)return Ee(W)}c(we,"asDeclarationResult");function oe(W){if(!!W)return Ee(W)}c(oe,"asDefinitionResult");function ge(W){if(!W)return;const Pe={targetUri:r(W.targetUri),targetRange:p(W.targetSelectionRange),originSelectionRange:p(W.originSelectionRange),targetSelectionRange:p(W.targetSelectionRange)};if(!Pe.targetSelectionRange)throw new Error("targetSelectionRange must not be undefined or null");return Pe}c(ge,"asLocationLink");function Ee(W){if(!!W)return Xn.array(W)?W.length===0?[]:Nl.is(W[0])?W.map(Tr=>ge(Tr)):W.map(wt=>ee(wt)):Nl.is(W)?[ge(W)]:ee(W)}c(Ee,"asLocationResult");function et(W){if(!!W)return W.map(Pe=>ee(Pe))}c(et,"asReferences");function ae(W){if(!!W)return W.map(Re)}c(ae,"asDocumentHighlights");function Re(W){const Pe=new h.DocumentHighlight(p(W.range));return Xn.number(W.kind)&&(Pe.kind=Ne(W.kind)),Pe}c(Re,"asDocumentHighlight");function Ne(W){switch(W){case Ls.Text:return h.DocumentHighlightKind.Text;case Ls.Read:return h.DocumentHighlightKind.Read;case Ls.Write:return h.DocumentHighlightKind.Write}return h.DocumentHighlightKind.Text}c(Ne,"asDocumentHighlightKind");function $e(W,Pe){if(!!W)return W.map(wt=>Ct(wt,Pe))}c($e,"asSymbolInformations");function Xe(W){return W<=lf.TypeParameter?W-1:h.SymbolKind.Property}c(Xe,"asSymbolKind");function it(W){switch(W){case uf.Deprecated:return h.SymbolTag.Deprecated;default:return}}c(it,"asSymbolTag");function ht(W){if(W==null)return;const Pe=[];for(const wt of W){const Tr=it(wt);Tr!==void 0&&Pe.push(Tr)}return Pe.length===0?void 0:Pe}c(ht,"asSymbolTags");function Ct(W,Pe){const wt=new h.SymbolInformation(W.name,Xe(W.kind),p(W.location.range),W.location.uri?r(W.location.uri):Pe);return be(wt,W),W.containerName&&(wt.containerName=W.containerName),wt}c(Ct,"asSymbolInformation");function Ht(W){if(W!=null)return W.map(fn)}c(Ht,"asDocumentSymbols");function fn(W){var Pe;const wt=new h.DocumentSymbol(W.name,(Pe=W.detail)!=null?Pe:"",Xe(W.kind),p(W.range),p(W.selectionRange));if(be(wt,W),W.children!==void 0&&W.children.length>0){const Tr=[];for(const vc of W.children)Tr.push(fn(vc));wt.children=Tr}return wt}c(fn,"asDocumentSymbol");function be(W,Pe){W.tags=ht(Pe.tags),Pe.deprecated&&(W.tags?W.tags.includes(h.SymbolTag.Deprecated)||(W.tags=W.tags.concat(h.SymbolTag.Deprecated)):W.tags=[h.SymbolTag.Deprecated])}c(be,"fillTags");function Me(W){const Pe={title:W.title,command:W.command};return W.arguments&&(Pe.arguments=W.arguments),Pe}c(Me,"asCommand");function je(W){if(!!W)return W.map(Me)}c(je,"asCommands");const ze=new Map;ze.set(Zn.Empty,h.CodeActionKind.Empty),ze.set(Zn.QuickFix,h.CodeActionKind.QuickFix),ze.set(Zn.Refactor,h.CodeActionKind.Refactor),ze.set(Zn.RefactorExtract,h.CodeActionKind.RefactorExtract),ze.set(Zn.RefactorInline,h.CodeActionKind.RefactorInline),ze.set(Zn.RefactorRewrite,h.CodeActionKind.RefactorRewrite),ze.set(Zn.Source,h.CodeActionKind.Source),ze.set(Zn.SourceOrganizeImports,h.CodeActionKind.SourceOrganizeImports);function Ye(W){if(W==null)return;let Pe=ze.get(W);if(Pe)return Pe;const wt=W.split(".");Pe=h.CodeActionKind.Empty;for(const Tr of wt)Pe=Pe.append(Tr);return Pe}c(Ye,"asCodeActionKind");function ct(W){if(W!=null)return W.map(Pe=>Ye(Pe))}c(ct,"asCodeActionKinds");function st(W){if(W==null)return;const Pe=new h.CodeAction(W.title);return W.kind!==void 0&&(Pe.kind=Ye(W.kind)),W.diagnostics&&(Pe.diagnostics=i(W.diagnostics)),W.edit&&(Pe.edit=Et(W.edit)),W.command&&(Pe.command=Me(W.command)),W.isPreferred!==void 0&&(Pe.isPreferred=W.isPreferred),Pe}c(st,"asCodeAction");function Et(W){if(!W)return;const Pe=new h.WorkspaceEdit;return W.documentChanges?W.documentChanges.forEach(wt=>{if(Ra.is(wt))Pe.createFile(r(wt.uri),wt.options);else if(Aa.is(wt))Pe.renameFile(r(wt.oldUri),r(wt.newUri),wt.options);else if(Ta.is(wt))Pe.deleteFile(r(wt.uri),wt.options);else if(Us.is(wt))Pe.set(r(wt.textDocument.uri),E(wt.edits));else throw new Error(`Unknown workspace edit change received:
${JSON.stringify(wt,void 0,4)}`)}):W.changes&&Object.keys(W.changes).forEach(wt=>{Pe.set(r(wt),E(W.changes[wt]))}),Pe}c(Et,"asWorkspaceEdit");function Kt(W){return new h.Color(W.red,W.green,W.blue,W.alpha)}c(Kt,"asColor");function nr(W){return new h.ColorInformation(p(W.range),Kt(W.color))}c(nr,"asColorInformation");function Mr(W){if(Array.isArray(W))return W.map(nr)}c(Mr,"asColorInformations");function Di(W){const Pe=new h.ColorPresentation(W.label);return Pe.additionalTextEdits=E(W.additionalTextEdits),W.textEdit&&(Pe.textEdit=S(W.textEdit)),Pe}c(Di,"asColorPresentation");function bu(W){if(Array.isArray(W))return W.map(Di)}c(bu,"asColorPresentations");function Ha(W){if(W)switch(W){case Bs.Comment:return h.FoldingRangeKind.Comment;case Bs.Imports:return h.FoldingRangeKind.Imports;case Bs.Region:return h.FoldingRangeKind.Region}}c(Ha,"asFoldingRangeKind");function pn(W){return new h.FoldingRange(W.startLine,W.endLine,Ha(W.kind))}c(pn,"asFoldingRange");function fp(W){if(Array.isArray(W))return W.map(pn)}c(fp,"asFoldingRanges");function pp(W){return new h.SelectionRange(p(W.range),W.parent?pp(W.parent):void 0)}c(pp,"asSelectionRange");function lR(W){if(!Array.isArray(W))return[];const Pe=[];for(const wt of W)Pe.push(pp(wt));return Pe}return c(lR,"asSelectionRanges"),{asUri:n,asDiagnostics:i,asDiagnostic:o,asRange:p,asRanges:f,asPosition:d,asDiagnosticSeverity:g,asDiagnosticTag:u,asHover:b,asTextEdit:S,asTextEdits:E,asSignatureHelp:D,asSignatureInformations:$,asSignatureInformation:z,asParameterInformations:re,asParameterInformation:ne,asDeclarationResult:we,asDefinitionResult:oe,asLocation:ee,asReferences:et,asDocumentHighlights:ae,asDocumentHighlight:Re,asDocumentHighlightKind:Ne,asSymbolKind:Xe,asSymbolTag:it,asSymbolTags:ht,asSymbolInformations:$e,asSymbolInformation:Ct,asDocumentSymbols:Ht,asDocumentSymbol:fn,asCommand:Me,asCommands:je,asCodeAction:st,asCodeActionKind:Ye,asCodeActionKinds:ct,asWorkspaceEdit:Et,asFoldingRangeKind:Ha,asFoldingRange:pn,asFoldingRanges:fp,asColor:Kt,asColorInformation:nr,asColorInformations:Mr,asColorPresentation:Di,asColorPresentations:bu,asSelectionRange:pp,asSelectionRanges:lR}}c(H_,"createConverter");const cr=(0,B_.loadMessageBundle)();var Qn;(function(t){function e(n,i){const{provider:o,repo:a}=i instanceof h.Uri?n.getVirtualUriMetadata(i):i;return n.getRemoteUri(o.id,{repo:a})}c(e,"externalUri"),t.externalUri=e;function r(n,i){const{provider:o,repo:a}=i instanceof h.Uri?n.getVirtualUriMetadata(i):i;return n.getRemoteUri(o.id,{repo:a})}c(r,"externalIndexUri"),t.externalIndexUri=r})(Qn||(Qn={}));var Qi;(function(t){function e(i){if(i.HEAD.type===he.Branch||i.HEAD.type===he.RemoteBranch)return i.HEAD.name}c(e,"getBranchName"),t.getBranchName=e;function r(i){if(i.HEAD.type!==he.Branch)return;if(i.pullRequest!==void 0)return i.HEAD.name;const o=i.HEAD.name;return o===void 0||o.startsWith("refs/heads/")?o:`refs/heads/${o}`}c(r,"getIndexBranchName"),t.getIndexBranchName=r;async function n(i,o,a=gr.timeout){const s=await i.getMetadata(o),l=Qn.externalIndexUri(i,s),u=t.getIndexBranchName(s);if(!(l===void 0||u===void 0))return gr.getIndexedTip(l,u,{authentication:i.getAuthentication(o)},a)}c(n,"getIndexedTip"),t.getIndexedTip=n})(Qi||(Qi={}));var zs;(function(t){const e=new Si(1024);function r(a,s,l){let u=e.get(l);return u!==void 0||(u=a.getCommit(s,l),e.set(l,u)),u}c(r,"get"),t.get=r;async function n(a,s,l){const u=[];for(const p of l)u.push(r(a,s,p));const d=[];for(const p of await Promise.all(u))p!==void 0&&d.push(p);return d}c(n,"all"),t.all=n;function i(a,s){const l=a.commitDate,u=s.commitDate;return l===void 0&&u===void 0?0:l===void 0?1:u===void 0?-1:l<u?1:l>u?-1:0}c(i,"sort"),t.sort=i;function o(a){const s=a.authorName!==void 0?`  \u2022  ${a.authorName}`:"",l=a.commitDate!==void 0?`  \u2022  ${Ms(a.commitDate,{ago:!0})}`:"",u=a.branchName!==void 0?` - ${a.branchName}`:"",d=a.tags!==void 0?typeof a.tags=="string"?`  \u2022  ${a.tags}`:`  \u2022  ${a.tags.join(" ")}`:"";return{author:s,date:l,branch:u,tag:d}}c(o,"getCommitInfo"),t.getCommitInfo=o})(zs||(zs={}));var yv;(function(t){t[t.Unknown=0]="Unknown",t[t.New=1]="New",t[t.Failed=2]="Failed",t[t.Partial=3]="Partial",t[t.InProgress=4]="InProgress",t[t.Complete=5]="Complete",t[t.PartialIndex=6]="PartialIndex",t[t.CompleteIndex=7]="CompleteIndex"})(yv||(yv={}));var zl;(function(t){function e(n){return{workspaceId:n.WorkspaceId,snapshotId:n.SnapshotId,state:n.State,commitId:n.commitId.toLowerCase(),branchName:r(n.BranchName),creationDate:new Date(n._ts*1e3)}}c(e,"asWorkspaceSnapshot"),t.asWorkspaceSnapshot=e;function r(n){if(n!==null)return n.startsWith("refs/heads/")?n.substr(11):n}c(r,"getBranchName")})(zl||(zl={}));var gr;(function(t){t.timeout=5*60*1e3;const e=new Si(32),r=new Si(32);async function n(d,p,f,g=t.timeout){const x=await i(d,p,f,g);if(!(x===void 0||x.length===0))return x[0]}c(n,"getIndexedTip"),t.getIndexedTip=n;async function i(d,p,f,g=t.timeout){const x=a(d,p);let y=e.get(x);if(y===void 0||y!==void 0&&Date.now()-y.time>g){const b=cn.getAllWorkspaceSnapshots(d,f,p);y={time:Date.now(),promise:b,snapshots:void 0},e.set(x,y)}if(y.snapshots!==null){if(y.snapshots===void 0){let b=await y.promise;if(b===void 0){y.snapshots=null;return}b.sort((S,E)=>E.creationDate.getTime()-S.creationDate.getTime()),b=b.filter(S=>S.state===5||S.state===3),y.snapshots=b}return y.snapshots}}c(i,"all"),t.all=i;async function o(d,p,f,g,x=t.timeout){const y=d.toString();let b=r.get(y);if(b===null)return;if(b!==void 0)return b;const S=a(d,f),E=e.get(S);if(E!==void 0&&Date.now()-E.time<=x){if(E.snapshots===null)return;const D=E.snapshots!==void 0?E.snapshots:await i(d,f,g);if(D!==void 0){for(const $ of D)if($.commitId===p)return $}return}if(b=await cn.getWorkspaceSnapshot(p,g),b===void 0){r.set(y,null);return}return r.set(y,b),b}c(o,"single"),t.single=o;function a(d,p){return p!==void 0?`${p}\\${d.toString()}`:d.toString()}c(a,"getAllCacheKey");async function s(d,p,f,g=t.timeout){return await o(d,p,void 0,f,g)!==void 0}c(s,"exists"),t.exists=s;async function l(d,p,f,g=t.timeout){return await i(d,p,f,g)!==void 0}c(l,"branch"),t.branch=l;async function u(d,p,f){const g=new Map(f.map(b=>[b.commitId,b])),x=await zs.all(d,p.uri,f.map(b=>b.commitId));if(x.length===0)return;const y=[];for(const b of x){const S=g.get(b.hash);S!==void 0&&y.push({...S,commit:b})}if(y.length!==0)return y}c(u,"resolve"),t.resolve=u})(gr||(gr={}));var Yn;(function(t){function e(r=!1){return{hoverProvider:r,declarationProvider:r,definitionProvider:r,typeDefinitionProvider:r,referencesProvider:r,documentSymbolProvider:r,foldingRangeProvider:r,diagnosticProvider:r}}c(e,"create"),t.create=e})(Yn||(Yn={}));var cn;(function(t){const e="v0.1",r="https://prod.richnav.vsengsaas.visualstudio.com/api";async function n(S,E,D){var $;const z=await Vn(S,{method:"POST",body:JSON.stringify(E),headers:{"Content-Type":"application/json",...(await D.authentication).getRichNavigationHeaders(),"x-correlation-id":($=D.correlationId)!=null?$:qh()}});if(!!z.ok)return z.json()}c(n,"postRequest");async function i(S,E,D){const $=await Vn(S,{method:"POST",body:E,headers:(await D.authentication).getRichNavigationHeaders()});if(!!$.ok)return await $.json()}c(i,"postForm");function o(S,E){return`${r}/${e}/HttpLanguageService/${S}/${E}`}c(o,"makeRequestUrl");async function a(S,E){const D=await Vn(`${r}/${e}/WorkspaceSnapshot?commitId=${S}`,{headers:(await E.authentication).getRichNavigationHeaders()});if(D.ok){const $=await D.json();return{workspaceId:$.workspaceId,snapshotId:$.snapshotId,state:$.state,commitId:S.toLowerCase(),branchName:void 0,creationDate:new Date}}}c(a,"getWorkspaceSnapshot"),t.getWorkspaceSnapshot=a;async function s(S,E,D){const $=new D0;$.append("uriString",S.toString(!0)),D!==void 0&&$.append("branchName",D);try{const z=await i(`${r}/${e}/WorkspaceSnapshot/all`,$,E);return z===void 0?void 0:z.map(zl.asWorkspaceSnapshot)}catch(z){C.error(z);return}}c(s,"getAllWorkspaceSnapshots"),t.getAllWorkspaceSnapshots=s;async function l(S,E,D){const $=new D0;$.append("uriString",S.toString(!0)),D!==void 0&&$.append("branchName",D);try{const z=await i(`${r}/${e}/WorkspaceSnapshot/latest`,$,E);return z===void 0?void 0:zl.asWorkspaceSnapshot(z)}catch(z){C.error(z);return}}c(l,"getLatestWorkspaceSnapshot"),t.getLatestWorkspaceSnapshot=l;async function u(S,E,D){try{return n(o(S,"textDocument/capabilities"),E,D)}catch($){C.error($);return}}c(u,"capabilities"),t.capabilities=u;async function d(S,E,D){try{return n(o(S,"textDocument/hover"),E,D)}catch($){C.error($);return}}c(d,"provideHover"),t.provideHover=d;async function p(S,E,D){try{return n(o(S,"textDocument/definition"),E,D)}catch($){C.error($);return}}c(p,"provideDefinition"),t.provideDefinition=p;async function f(S,E,D){try{return n(o(S,"textDocument/declaration"),E,D)}catch($){C.error($);return}}c(f,"provideDeclaration"),t.provideDeclaration=f;async function g(S,E,D){try{return n(o(S,"textDocument/typeDefinition"),E,D)}catch($){C.error($);return}}c(g,"provideTypeDefinition"),t.provideTypeDefinition=g;async function x(S,E,D){try{return n(o(S,"textDocument/references"),E,D)}catch($){C.error($);return}}c(x,"provideReferences"),t.provideReferences=x;async function y(S,E,D){try{return n(o(S,"textDocument/foldingRange"),E,D)}catch($){C.error($);return}}c(y,"providerFoldingRanges"),t.providerFoldingRanges=y;async function b(S,E,D){const $=h.Uri.from({scheme:"https",authority:"prod.richnav.vsengsaas.visualstudio.com",path:`/api/${e}/Workspace/${S}/${E}/assets/designtime`,query:`id=${D}`});try{const z=await Vn($.toString().replace("?id%3D","?id="),{method:"GET",headers:{accept:"text/plain"}});return z.ok?z.text():void 0}catch(z){C.error(z);return}}c(b,"getDesignTimeFileContent"),t.getDesignTimeFileContent=b})(cn||(cn={}));class bv{constructor(e,r){this.providerService=e,this.telemetryService=r,this.metadata=new Map,this.providerService.onDidChangeRepositories(n=>{var i;for(const o of n.added){const a=o.uri,s=P.getIndexMemento(a);if(s!==void 0){const l=Qn.externalIndexUri(this.providerService,a);l!==void 0&&(typeof((i=s.branch)==null?void 0:i.name)=="string"?gr.all(l,s.branch.name,{authentication:this.providerService.getAuthentication(a)}).catch(void 0):typeof s.ref=="string"&&Jt(s.ref)&&gr.single(l,s.ref,void 0,{authentication:this.providerService.getAuthentication(a)}).catch(void 0))}this.providerService.getMetadata(a).then(l=>{const u={},d=l.pullRequest===void 0?Qi.getIndexBranchName(l):void 0;d!==void 0?u.branch={name:d}:u.ref=l.HEAD.sha,P.setIndexMemento(a,u).then(void 0,void 0)},void 0)}}),this.providerService.onDidChangeRepository(n=>{const i=n.repository.uri,o=H(i);this.metadata.delete(o),this.getIndexMetadata(i).catch(void 0)})}async resolveIndexRef(e,r){const n=await this.providerService.getModeRefType(e),i=At.decode(e);if(i!==void 0){if(i.type===bt.Latest)return n===q.Branch?this.getIndexedTip(e,r?0:gr.timeout):void 0;if(i.type===bt.SHA){const a=Qn.externalIndexUri(this.providerService,e);return a===void 0?void 0:await gr.exists(a,i.sha,{authentication:this.providerService.getAuthentication(e)},r?0:gr.timeout)?i.sha:void 0}}if(this.providerService.getModeConfig(e,n).index===I.Latest)return this.getIndexedTip(e,r?0:gr.timeout)}refresh(e){for(const r of e)this.metadata.delete(r.toString())}getIndexMetadata(e){const r=this.providerService.getVirtualRootUri(e),n=H(r);let i=this.metadata.get(n);return i!==void 0||(i=this.createIndexMetadata(e),this.metadata.set(n,i)),i}async getIndexedTip(e,r=gr.timeout){const n=await Qi.getIndexedTip(this.providerService,e,r);return n!==void 0?n.commitId:void 0}async createIndexMetadata(e){const r=new Be(`RichNavIndexProvider.createIndexMetadata(${e.toString()})`);try{const n=Qn.externalIndexUri(this.providerService,e);if(n===void 0)return;r.logStep("Getting metadata");const i=this.providerService.getMetadata(e),o=this.providerService.getModeRefType(e,i),a=await i;r.logStep("Getting snapshot",{suffix:" \u2022 Getting snapshot..."});const s=this.providerService.getAuthentication(e),l=a.pullRequest===void 0?Qi.getIndexBranchName(a):void 0,u=await gr.single(n,a.HEAD.sha,l,{authentication:this.providerService.getAuthentication(e)});if(a.HEAD.type===he.Branch||a.HEAD.type===he.RemoteBranch){const g=At.decode(e);if(g!==void 0)return r.logStep("Handle legacy encoding",{suffix:" \u2022 Handle legacy encoding..."}),u===void 0?g.type===bt.Latest?(r.logStep("Getting branch snapshot",{suffix:" \u2022 Getting branch snapshot..."}),l!==void 0&&await gr.branch(n,l,{authentication:this.providerService.getAuthentication(e)})?{type:Oe.Indexed}:{type:Oe.NotIndexed}):{type:Oe.NotIndexed}:g.type===bt.Latest||g.type===bt.SHA?{type:Oe.Active,sha:Promise.resolve(u.commitId),branch:{name:u.branchName}}:{type:Oe.Match,sha:Promise.resolve(u.commitId),branch:{name:u.branchName}}}r.logStep("Getting mode config",{suffix:" \u2022 Getting mode config..."});const p=this.providerService.getModeConfig(e,await o),f=this.providerService.getVirtualUriMetadata(e);if((p.index===I.Latest||p.index===I.Match)&&u!==void 0)return{type:Oe.Active,sha:Promise.resolve(u.commitId),branch:{name:u.branchName}};if(p.index===I.TipPlusLatest&&f.provider.id==="github"){if(u!==void 0&&u.commitId===a.HEAD.sha)return{type:Oe.Active,sha:Promise.resolve(u.commitId),branch:{name:u.branchName}};if(a.HEAD.type===he.Branch&&l!==void 0){r.logStep("Getting closest index",{suffix:" \u2022 Getting closest index..."});const g=await gr.all(n,l,{authentication:s});if(g!==void 0&&g.length>0)return{type:Oe.Active,sha:this.computeClosestIndex(e,a.HEAD.sha,g),branch:{name:l}}}}return u!==void 0?{type:Oe.Indexed}:a.HEAD.type===he.Branch&&(r.logStep("Getting branch snapshot",{suffix:" \u2022 Getting branch snapshot..."}),l!==void 0&&await gr.branch(n,l,{authentication:s}))?{type:Oe.Indexed}:{type:Oe.NotIndexed}}finally{r.stop()}}async computeClosestIndex(e,r,n){if(n.length===0)throw new Error("At least on snapshot should exist");const i=new Set(n.map(d=>d.commitId)),o=await this.providerService.getCommits(e,{ref:r,limit:100});if(o===void 0)return;let a;for(const d of o.commits)if(d.hash===r){a=d;break}if(a===void 0)return;const s=new Map(o.commits.map(d=>[d.hash,d])),l=[a];let u;for(;l.length>0;){for(u=l.shift();u!==void 0&&!i.has(u.hash);)if(u.parents.length>0){for(let d=1;d<u.parents.length;d++){const p=s.get(u.parents[d]);p!==void 0&&l.push(p)}u=s.get(u.parents[0])}if(u!==void 0)break}return u!==void 0?u.hash:void 0}async getSnapshots(e,r){const n=Qn.externalIndexUri(this.providerService,e);if(n===void 0)return[];const i=await gr.all(n,void 0,{authentication:this.providerService.getAuthentication(e)});if(i===void 0)return[];const o=[];for(const a of i)a.branchName!==void 0&&o.push({workspaceId:a.workspaceId,snapshotId:a.snapshotId,hash:a.commitId,branch:{name:a.branchName}});return o}async getStatusBarContributions(e){const r=await this.providerService.getMetadata(e),[n,i]=await Promise.all([this.getIndexMetadata(e),this.providerService.getModeRefType(e,r)]),o=this.providerService.getModeConfig(e,i);if(n===void 0)return[];const{HEAD:a}=r,s=[];if(n!==void 0){let l;const u=[`${Ve(a.sha)}`];if(n.type===Oe.Active){const d=await n.sha;o.index===I.Latest||o.index===I.Match?(l=o.display===M.Browse?"$(layers-active)\u2009\u2009$(lock)":"$(layers-active)",u.push(cr("statusbar.active",`The commit is indexed and rich code navigation features are enabled.
The files in the workspace are readonly.`))):o.index===I.TipPlusLatest&&(l="$(layers-dot)",d!==r.HEAD.sha?u.push(cr("statusbar.tipPlusLatest","The commit is not indexed. Rich code navigation features are enabled using a former indexed commit which might lead to fuzzy results.")):u.push(cr("statusbar.tipPlusLatest","The commit is indexed. Rich code navigation features are enabled. Files in the workspace can be modified which might lead to fuzzy results.")))}else n.type===Oe.Match?(l="$(layers)",u.push(cr("statusbar.match",`The commit you are on is indexed, but rich navigation is not enabled.
Click the status bar item to enable it.`))):n.type===Oe.Indexed&&(l="$(layers)",u.push(cr("statusbar.indexed",`The branch you are on is indexed, but rich navigation is not enabled.
Click the status bar item to enable it.`)));l&&s.push(In({command:"remoteHub.indexMode.select",title:l,tooltip:u.join(`
`),arguments:[{uri:e}]}))}return s}}c(bv,"RichNavIndexProvider");var To;(function(t){let e;function r(){return e=h.window.createStatusBarItem(h.StatusBarAlignment.Right),e.text="$(compass)",e.command="remoteHub.indexMode.select",e.hide(),[e,h.window.onDidChangeActiveTextEditor(()=>{l()}),h.commands.registerCommand("remoteHub.indexMode.select",d=>{u(d).catch(p=>C.log("Selecting index mode failed.",p))})]}c(r,"create"),t.create=r;const n=new Map;function i(d){n.set(d.key(),d)}c(i,"addService"),t.addService=i;function o(d){n.delete(d.key())}c(o,"removeService"),t.removeService=o;function a(d){return n.get(H(d))}c(a,"getService");async function s(d){for(const p of n.values())if(await p.handles(d))return p}c(s,"getServiceForDocument");async function l(){try{let d=c(function(x){const y=x.lastIndexOf("/");return y<=0?x:x.substr(y+1)},"basename");const p=h.window.activeTextEditor;if(p===void 0){e.hide();return}const f=await s(p.document);if(f===void 0){e.hide();return}const g=await f.isDocumentIndexed(p.document);g===Wl.Indexed?(e.text="$(compass)",e.tooltip=new h.MarkdownString(cr("isIndexed","The source file '{0}' is indexed and provides rich code navigation features like Go to Declaration and Find all References.",d(p.document.uri.path))),e.show()):g===Wl.IndexMapped?(e.text="$(compass-dot)",e.tooltip=new h.MarkdownString(cr("isIndexed","The source file '{0}' provides rich code navigation features using an earlier indexed commit. Navigation results might be fuzzy.",d(p.document.uri.path))),e.show()):e.hide()}catch(d){e.hide()}}c(l,"updateStatusBarItem"),t.updateStatusBarItem=l;async function u(d){const p=d.uri,f=a(p);if(f===void 0)return;const[g,x,y,b]=await Promise.all([f.getBranchName(),f.getMetadata(),f.getIndexMetadata(),f.getModeRefType(p)]);if(y===void 0||!Oe.hasIndex(y.type))return;let S,E=!1;const D=At.decode(p);(D==null?void 0:D.type)===bt.Latest||(D==null?void 0:D.type)===bt.SHA?(E=!0,S={display:M.Browse,index:D.type===bt.Latest?I.Latest:I.Match}):S=f.getModeConfig(p,b);const $=f.getUriMetadata(),z=cr("current item","{0} current","$(check)"),re={kind:"disable",label:cr("RichNavStatus.disable.label","Disable"),description:S.index===I.None?`  \u2022  ${z}`:void 0,detail:cr("RichNavStatus.disable.detail","Disable rich navigation. {0}",$.provider.id==="github"?"Files will be writable.":"Files will be read-only.")};let ne,ee;if(b===q.PullRequestBranch||b===q.PullRequestRemoteBranch||b===q.Commit||b===q.Tag){const we={kind:"match",label:cr("RichNavStatus.match.label","Current indexed commit - readonly"),description:S.index===I.Match&&S.display===M.Browse?`  \u2022  ${z}`:void 0,detail:cr("RichNavStatus.match.detail","Enable rich navigation only if the current commit is indexed. Files will be read-only.")},oe={kind:"match+writeable",label:cr("RichNavStatus.matchWritable.label","Current indexed commit - writable"),description:S.index===I.Match&&S.display===M.Edit?`  \u2022  ${z}`:void 0,detail:cr("RichNavStatus.match.detail","Enable rich navigation only if the current commit is indexed. Files will be writable.")};let ge=$.provider.id==="github";ge&&(ge=x.HEAD.type===he.RemoteBranch?x.HEAD.branch.remote.accessLevel>=Se.Write:!0);const Ee=ge?[we,oe,re]:[we,re];ee=await h.window.showQuickPick(Ee,{placeHolder:"Pick a rich navigation mode"})}else if(b===q.Branch||b===q.RemoteBranch){const we={kind:"latest",label:cr("RichNavStatus.latestIndexed.label","Latest indexed commit"),description:S.index===I.Latest?`  \u2022  ${z}`:void 0,detail:cr("RichNavStatus.latestIndexed.detail","Enable rich navigation on the latest indexed commit. Files will be read-only.")},oe={kind:"tip+latest",label:cr("RichNavStatus.matchLatestIndexed.label","Current commit & latest index"),description:S.index===I.TipPlusLatest?`  \u2022  ${z}`:void 0,detail:cr("RichNavStatus.matchLatestIndexed.detail","Enable rich navigation on the current commit using the latest index. Files will be writeable.")},ge=$.provider.id==="github"?[we,oe,re]:[we,re];ee=await h.window.showQuickPick(ge,{placeHolder:cr("RichNavStatus.placeHolder","Pick a rich navigation mode for branch {0}",g)})}if(ee!==void 0&&(ee.kind==="disable"?ne={display:M.Edit,index:I.None}:ee.kind==="match"?ne={display:M.Browse,index:I.Match}:ee.kind==="match+writeable"?ne={display:M.Edit,index:I.Match}:ee.kind==="tip+latest"?ne={display:M.Edit,index:I.TipPlusLatest}:ee.kind==="latest"&&(ne={display:M.Browse,index:I.Latest}),ne!==void 0&&!B.equals(S,ne))){if(await f.hasChanges()&&ne.display===M.Browse){await h.window.showInformationMessage("The repository has outgoing changes. Commit them first before switching to browse mode.",{modal:!0,useCustom:!0});return}if(ne.index===I.Latest){const we=await f.getIndexedTip();if(we===void 0)return;await f.sync(we.hash)}else ne.index===I.TipPlusLatest&&await f.sync();if(await P.setMode(p,ne),E){const we=await f.getNonIndexedWorkspaceDescriptor();we!==void 0&&sn(we)}else f.refresh()}}c(u,"toggleIndexMode")})(To||(To={}));class hf{constructor(e){this.telemetryService=e}static createStatus(){return To.create()}async createNavigationService(e,r,n){const i=await e.getIndexMetadata(r.uri);if(!(i===void 0||i.type===Oe.NotIndexed))return()=>new pf(e,r,n,this.telemetryService)}}c(hf,"RichNavServiceProvider");var Ws;(function(t){const e=new RegExp("^vsck:\\/\\/([a-fA-F0-9]+)\\/(latest|[a-fA-F0-9]{15})\\/designtime\\/([a-fA-F0-9]+)(\\/?.*)$");function r(i){const o=e.exec(i);if(o===null||o.length!==5)return;const a={v:1,w:o[1],s:o[2],a:o[3]};return h.Uri.from({scheme:Ri.scheme,authority:Ga(JSON.stringify(a)),path:o[4]})}c(r,"toVSCode"),t.toVSCode=r;function n(i){if(i.scheme!==Ri.scheme)return;let o;try{return o=JSON.parse(Sc(i.authority)),o===void 0?void 0:{workspaceId:o.w,snapshotId:o.s,assetId:`${o.a}${i.path}`}}catch{return}}c(n,"toRichNavComponents"),t.toRichNavComponents=n})(Ws||(Ws={}));const ff=c(class{constructor(){this._onDidChangeFile=new h.EventEmitter,this.cache=new Si(64),this.textEncoder=new TextEncoder}get onDidChangeFile(){return this._onDidChangeFile.event}watch(t,e){return ff.emptyDisposable}async stat(t){const e=await this.getFile(t);if(e===void 0)throw h.FileSystemError.FileNotFound();return{type:h.FileType.File,mtime:e.time,ctime:e.time,size:e.content.length,permissions:h.FilePermission.Readonly}}readDirectory(t){return[]}createDirectory(t){throw h.FileSystemError.NoPermissions()}async readFile(t){const e=await this.getFile(t);if(e===void 0)throw h.FileSystemError.FileNotFound();return e.content}writeFile(t,e,r){throw h.FileSystemError.NoPermissions()}delete(t,e){throw h.FileSystemError.NoPermissions()}rename(t,e,r){throw h.FileSystemError.NoPermissions()}async getFile(t){let e=this.cache.get(t.toString());if(e!==void 0)return e;if(t.scheme!==ff.scheme)return;const r=Ws.toRichNavComponents(t);if(r===void 0)return;const n=await cn.getDesignTimeFileContent(r.workspaceId,r.snapshotId,r.assetId);if(n!==void 0)return e={content:this.textEncoder.encode(n),time:Date.now()},this.cache.set(t.toString(),e),e}},"_RichNavFileSystemProvider");let Ri=ff;Ri.scheme="vsck-fs",Ri.emptyDisposable={dispose:()=>{}};var Wl;(function(t){t[t.NotIndexed=0]="NotIndexed",t[t.IndexMapped=1]="IndexMapped",t[t.Indexed=2]="Indexed"})(Wl||(Wl={}));const Jn=c(class{static registerCapability(t,e,r){var n;const i=this.disabledCapabilities.get(t);if(i==null?void 0:i[e])return!1;const o=this.localCapabilities.get(t);return(o==null?void 0:o[e])?!1:(n=r[e])!=null?n:!1}constructor(t,e,r,n){this.providerService=t,this.repository=e,this.changeStore=r,this.telemetryService=n,this.repositoryRoot=`${e.uri.toString()}/`;const i=c((a=!1)=>{const s=this.repository.uri;a||(this.metadata=this.providerService.getMetadata(s),this.indexMetadata=this.providerService.getIndexMetadata(s)),Promise.all([this.metadata,this.indexMetadata,this.providerService.getModeRefType(s,this.metadata)]).then(async l=>{var u,d;const[p,f,g]=this.currentlyResolved,[x,y,b]=l,S=this.providerService.getModeConfig(s,b);if(p!==void 0&&f!==void 0&&g!==void 0&&p.HEAD.sha===x.HEAD.sha&&y!==void 0&&f.type===y.type&&g.index===S.index&&g.display===S.display){const D=(f==null?void 0:f.type)===Oe.Active?await f.sha:void 0,$=(y==null?void 0:y.type)===Oe.Active?await y.sha:void 0;if(D===$)return}const E={newDisplayMode:S.display,newIndexMode:S.index,newIndexType:(y==null?void 0:y.type)===void 0?"undefined":Oe[y==null?void 0:y.type],currentDisplayMode:(u=g==null?void 0:g.display)!=null?u:"undefined",currentIndexMode:(d=g==null?void 0:g.index)!=null?d:"undefined",currentIndexType:(f==null?void 0:f.type)===void 0?"undefined":Oe[f==null?void 0:f.type]};this.telemetryService.publicLog2("codex.handleRepositoryChanged",E),this.currentlyResolved=[x,y,S];for(const D of this.registeredFeatures.values())D.dispose();if(this.registeredFeatures.clear(),this.pendingCapabilitiesRequests.clear(),this.documentListeners!==void 0&&this.documentListeners.dispose(),this.workspaceSnapshot=void 0,this.mapper=void 0,Nt.isActive(y)){const D=Qn.externalIndexUri(this.providerService,x),$=await y.sha;if(D!==void 0&&$!==void 0){const z=await gr.single(D,$,Qi.getIndexBranchName(x),{authentication:this.providerService.getAuthentication(s)});z!==void 0&&(this.telemetryService.publicLog2("codex.foundSnapshot",{snapshotId:z.snapshotId}),this.workspaceSnapshot=z,this.documentListeners=this.installDocumentListeners(),((S==null?void 0:S.display)===M.Edit||x.HEAD.sha!==$)&&(this.mapper=new z0(this.providerService,s,$,x.HEAD.sha)))}}await To.updateStatusBarItem()}).then(void 0,void 0)},"handleRepositoryChanged");this.metadata=this.providerService.getMetadata(this.repository.uri),this.indexMetadata=this.providerService.getIndexMetadata(this.repository.uri),this.currentlyResolved=[void 0,void 0,void 0],this.registeredFeatures=new Map,this.pendingCapabilitiesRequests=new Map,this.capabilitiesCache=new Si(2048),this.knownDesignTimeFiles=new Set;const o=[];o.push(this.providerService.onDidChangeRepository(a=>{H(a.repository.uri)===H(this.repository.uri)&&i()})),o.push(this.providerService.onDidRefresh(a=>{for(const s of a)if(H(s)===H(this.repository.uri)){i();break}})),o.push(P.onDidChange(a=>{a.affectsConfiguration("remoteHub.richNavigation.indexMode",this.repository.uri)&&this.providerService.refresh()})),this.environmentListeners=h.Disposable.from(...o),i(!0),To.addService(this),this.indexMetadata.then(async a=>{const s=this.repository.uri;let l=!1;const u=At.decode(this.repository.uri);if(u!==void 0&&a!==void 0&&(u.type===bt.Latest&&a.type!==Oe.Active||u.type===bt.SHA&&(a.type!==Oe.Active||await a.sha!==u.sha))&&(l=!0),!l){const d=this.providerService.getModeConfig(s,await this.providerService.getModeRefType(s,this.metadata),!0);d!==void 0&&d.display===M.Browse&&a!==void 0&&d.index!==I.None&&a.type!==Oe.Active?l=!0:(a==null?void 0:a.type)===Oe.Active&&await a.sha===void 0&&((d==null?void 0:d.display)===M.Browse,l=!0)}l&&h.window.showWarningMessage(cr("RichNavService.latest.notIndexed","The repository got opened in rich code navigation mode but no corresponding index is available. Rich code navigation features are disabled.")).then(void 0,void 0)},void 0),Jn.fileSystemProvider===void 0&&(Jn.fileSystemProvider=new Ri,h.workspace.registerFileSystemProvider(Ri.scheme,Jn.fileSystemProvider))}key(){return H(this.repository.uri)}dispose(){for(const t of this.registeredFeatures.values())t.dispose();this.registeredFeatures.clear(),To.removeService(this),this.documentListeners!==void 0&&(this.documentListeners.dispose(),this.documentListeners=void 0),this.environmentListeners!==void 0&&(this.environmentListeners.dispose(),this.environmentListeners=void 0)}handles(t){return t.uri.scheme!==Dt.scheme?Promise.resolve(!1):Promise.resolve(t.uri.toString().startsWith(this.repositoryRoot))}async getBranchName(){return Qi.getBranchName(await this.metadata)}async getMetadata(){return this.metadata}async getIndexMetadata(){return this.indexMetadata}getUriMetadata(){return this.providerService.getVirtualUriMetadata(this.repository.uri)}getModeConfig(t,e){return this.providerService.getModeConfig(t,e)}getModeRefType(t){return this.providerService.getModeRefType(t)}refresh(){return this.providerService.refresh()}async getNonIndexedWorkspaceDescriptor(){const{name:t,repo:e}=await this.metadata,{ref:r}=this.providerService.getVirtualUriMetadata(this.repository.uri);return{name:t,uri:this.providerService.createVirtualUri(this.repository.uri,{repo:e,ref:r}),location:$t.CurrentWindow}}async isDocumentIndexed(t){await this.metadata;const e=await this.indexMetadata;if(e===void 0||e.type===Oe.NotIndexed||this.workspaceSnapshot===void 0)return 0;const r=this.pendingCapabilitiesRequests.get(t.uri.toString());return r!==void 0&&await r,this.registeredFeatures.has(t.uri.toString())?this.mapper===void 0?2:await this.mapper.needsMapping(t)?1:2:0}async getIndexedTip(){const t=await this.metadata,e=Qn.externalIndexUri(this.providerService,t),r=Qi.getIndexBranchName(t);if(e===void 0||r===void 0)return;const n=await gr.getIndexedTip(e,r,{authentication:this.providerService.getAuthentication(this.repository.uri)});if(n===void 0)return;const i=await zs.get(this.providerService,this.repository.uri,n.commitId);if(i!==void 0)return{...i,branchName:r}}hasChanges(){return this.changeStore.hasChanges(this.repository.uri)}sync(t){return this.providerService.sync(this.repository.uri,this.changeStore,{to:t,reason:"user"})}async getCommit(t){const e=await this.metadata,r=Qn.externalIndexUri(this.providerService,e);if(r===void 0)return;const[n,i]=await Promise.all([zs.get(this.providerService,this.repository.uri,t),gr.single(r,t,void 0,{authentication:this.providerService.getAuthentication(this.repository.uri)})]);if(!(n===void 0||i===void 0))return{...n,branchName:i.branchName}}installDocumentListeners(){const t=[],e=c(async r=>{const n=r.uri.scheme;if(Dt.scheme!==n&&Ri.scheme!==n)return;const i=r.uri.toString();if(n===Dt.scheme&&!i.startsWith(this.repositoryRoot)||n===Ri.scheme&&!this.knownDesignTimeFiles.has(i)||this.pendingCapabilitiesRequests.has(i))return;const o=this.workspaceSnapshot!==void 0?this.workspaceSnapshot.commitId:void 0;if(o===void 0)return;let a=this.capabilitiesCache.get(i);if(a!==null){if(a===void 0){const s=this.capabilities(r.uri);this.pendingCapabilitiesRequests.set(i,s),a=await s,this.pendingCapabilitiesRequests.delete(i),this.capabilitiesCache.set(i,a===void 0?null:a)}a===void 0||!h.workspace.textDocuments.some(s=>s===r)||this.registerProviders(r,a,o)}},"openHandler");return t.push(h.workspace.onDidOpenTextDocument(e)),h.workspace.textDocuments.forEach(e),t.push(h.workspace.onDidCloseTextDocument(r=>{const n=r.uri.toString(),i=this.registeredFeatures.get(n);i!==void 0&&(this.registeredFeatures.delete(r.uri.toString()),i.dispose()),this.pendingCapabilitiesRequests.delete(n)})),h.Disposable.from(...t)}registerProviders(t,e,r){if(this.workspaceSnapshot===void 0)return;const n=this.workspaceSnapshot,i=t.languageId,a=[{scheme:this.repository.uri.scheme,pattern:t.uri.fsPath,language:t.languageId,exclusive:!0}],s=[],l=new Promise((y,b)=>{const S=`/${n.snapshotId}/source/`;this.metadata.then(E=>{y(H_(D=>{const $=h.Uri.parse(D);if(E===void 0)return $;try{if($.scheme==="vsck"&&$.authority===n.workspaceId&&$.path.startsWith(S))return this.repository.createRelativeUri($.path.substr(S.length));const z=Ws.toVSCode(D);return z!==void 0?(this.knownDesignTimeFiles.add(z.toString()),z):$}catch(z){return $}}))},b)}),u=new RegExp(`^vsck:\\/\\/${n.workspaceId}\\/(?:latest|[a-fA-F0-9]{15})\\/designtime\\/(?:[a-fA-F0-9]+)(\\/?.*)$`);function d(y){const b=u.exec(y);return b===null||b.length===2}c(d,"designTimeFilter");function p(y){if(y==null)return y;if(Array.isArray(y)){if(y.length===0)return[];const b=y[0];return typeof b.uri=="string"?y.filter(D=>d(D.uri)):typeof b.targetUri=="string"?y.filter(D=>d(D.targetUri)):[]}return u.exec(y.uri)===null?y:void 0}c(p,"filterDesignTimeFiles");async function f(y,b,S){var E,D,$;if(S==null||y===void 0)return S;const z=new Map(h.workspace.textDocuments.map(ne=>[ne.uri.toString(!0),ne]));if(Array.isArray(S)){const ne=[],ee=[];if(S.length===0)return[];for(const we of S){const oe=we;if(oe.uri instanceof h.Uri){const ge=await y.mapRangeFromIndexToCode((E=z.get(oe.uri.toString()))!=null?E:oe.uri,oe.range);ge!==void 0&&ne.push(new h.Location(oe.uri,ge))}else{const ge=we,Ee=(D=z.get(ge.targetUri.toString()))!=null?D:ge.targetUri,et=ge.originSelectionRange?await y.mapRangeFromIndexToCode(b,ge.originSelectionRange):void 0;if(et!==void 0||ge.originSelectionRange===void 0){const ae=await y.mapRangeFromIndexToCode(Ee,ge.targetRange);if(ae!==void 0){const Re=ge.targetSelectionRange?await y.mapRangeFromIndexToCode(Ee,ge.targetSelectionRange):void 0;(Re!==void 0||ge.targetSelectionRange===void 0)&&ee.push({targetUri:ge.targetUri,targetRange:ae,targetSelectionRange:Re,originSelectionRange:et})}}}}return ne.length>0?ne:ee}const re=await y.mapRangeFromIndexToCode(($=z.get(S.uri.toString()))!=null?$:S.uri,S.range);if(re!==void 0)return new h.Location(S.uri,re)}c(f,"mapLocations");const g=c(y=>({authentication:this.providerService.getAuthentication(y.uri),correlationId:qh()}),"getRestApiOptions"),x=c((y,b)=>{const S={method:y,correlationId:b.correlationId};this.telemetryService.publicLog2("codex.restAPICall",S)},"sendTelemetry");Jn.registerCapability(i,"hoverProvider",e)&&s.push(h.languages.registerHoverProvider(a,{provideHover:async(y,b)=>{const S=await this.createTextDocumentPositionParams(y,b);if(S===void 0)return;const E=g(y);return x("codex.provideHover",E),(await l).asHover(await cn.provideHover(r,S,E))}})),Jn.registerCapability(i,"definitionProvider",e)&&s.push(h.languages.registerDefinitionProvider(a,{provideDefinition:async(y,b)=>{const S=await this.createTextDocumentPositionParams(y,b);if(S===void 0)return;const E=g(y);return x("codex.provideDefinition",E),f(this.mapper,y,(await l).asDefinitionResult(p(await cn.provideDefinition(r,S,E))))}})),Jn.registerCapability(i,"declarationProvider",e)&&s.push(h.languages.registerDeclarationProvider(a,{provideDeclaration:async(y,b)=>{const S=await this.createTextDocumentPositionParams(y,b);if(S===void 0)return;const E=g(y);return x("codex.provideDeclaration",E),f(this.mapper,y,(await l).asDeclarationResult(p(await cn.provideDeclaration(r,S,E))))}})),Jn.registerCapability(i,"typeDefinitionProvider",e)&&s.push(h.languages.registerTypeDefinitionProvider(a,{provideTypeDefinition:async(y,b)=>{const S=await this.createTextDocumentPositionParams(y,b);if(S===void 0)return;const E=g(y);return x("codex.provideTypeDefinition",E),f(this.mapper,y,(await l).asDefinitionResult(p(await cn.provideTypeDefinition(r,S,E))))}})),Jn.registerCapability(i,"referencesProvider",e)&&s.push(h.languages.registerReferenceProvider(a,{provideReferences:async(y,b,S)=>{const E=this.mapper!==void 0?await this.mapper.mapPositionFromCodeToIndex(y,b):b;if(E===void 0)return;const D={position:{line:E.line,character:E.character},textDocument:{uri:this.createRichNavDocumentUri(y.uri).toString(!0)},context:{includeDeclaration:S.includeDeclaration}},$=g(y);return x("codex.provideReferences",$),f(this.mapper,y,(await l).asReferences(p(await cn.provideReferences(r,D,$))))}})),Jn.registerCapability(i,"foldingRangeProvider",e)&&s.push(h.languages.registerFoldingRangeProvider(a,{provideFoldingRanges:async y=>{if(this.mapper!==void 0&&await this.mapper.needsMapping(y))return;const b=g(y);return x("codex.provideFoldingRanges",b),(await l).asFoldingRanges(await cn.providerFoldingRanges(r,this.createTextDocumentParams(y.uri),b))}})),this.registeredFeatures.set(t.uri.toString(),h.Disposable.from(...s)),To.updateStatusBarItem()}async capabilities(t){var e;const r=this.workspaceSnapshot!==void 0?this.workspaceSnapshot.commitId:void 0;if(r!==void 0)return(e=await cn.capabilities(r,this.createTextDocumentParams(t),{authentication:this.providerService.getAuthentication(t)}))!=null?e:void 0}createTextDocumentParams(t){return{textDocument:{uri:this.createRichNavDocumentUri(t).toString(!0)}}}async createTextDocumentPositionParams(t,e){const r=this.mapper!==void 0?await this.mapper.mapPositionFromCodeToIndex(t,e):e;if(r!==void 0)return{position:{line:r.line,character:r.character},textDocument:{uri:this.createRichNavDocumentUri(t.uri).toString(!0)}}}createRichNavDocumentUri(t){if(t.scheme===Ri.scheme){const n=Ws.toRichNavComponents(t);return n===void 0?t:h.Uri.file(n.assetId)}const e=this.repository.uri.toString(!0),r=t.toString(!0);return h.Uri.file(r.substr(e.length))}},"_RichNavService");let pf=Jn;pf.localCapabilities=new Map([["javascript",Object.assign(Yn.create(),{documentSymbolProvider:!0,foldingRangeProvider:!0})],["javascriptreact",Object.assign(Yn.create(),{documentSymbolProvider:!0,foldingRangeProvider:!0})],["typescript",Object.assign(Yn.create(),{documentSymbolProvider:!0,foldingRangeProvider:!0})],["typescriptreact",Object.assign(Yn.create(),{documentSymbolProvider:!0,foldingRangeProvider:!0})]]),pf.disabledCapabilities=new Map([["javascript",Object.assign(Yn.create(),{declarationProvider:!0})],["javascriptreact",Object.assign(Yn.create(),{declarationProvider:!0})],["typescript",Object.assign(Yn.create(),{declarationProvider:!0})],["typescriptreact",Object.assign(Yn.create(),{declarationProvider:!0})]]);var xv=c((t,e,r)=>{if(!e.has(t))throw TypeError("Cannot "+r)},"__accessCheck"),ei=c((t,e,r)=>(xv(t,e,"read from private field"),r?r.call(t):e.get(t)),"__privateGet"),_v=c((t,e,r)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,r)},"__privateAdd"),Sv=c((t,e,r,n)=>(xv(t,e,"write to private field"),n?n.call(t,r):e.set(t,r),r),"__privateSet"),ln,ql;class Cv{constructor(e,r){_v(this,ln,void 0),_v(this,ql,void 0),Sv(this,ln,e),Sv(this,ql,r)}async loadWorkspaceContents(e){if(e.scheme!=="vscode-vfs")return!1;const r=ei(this,ln).getProviderRootUri(e);if(r.scheme!=="github")return!1;try{return await ei(this,ql).getTar(r),!0}catch(n){return C.error(n),!1}}async getMetadata(e){const r=ei(this,ln).getVirtualUriMetadata(e);if(r===void 0)return;const{provider:n,repo:i}=r;return{provider:{id:n.id,name:n.name},repo:i,getRevision:async()=>{const{HEAD:o}=await ei(this,ln).getMetadata(e);return{type:o.type,name:o.name,revision:o.sha}}}}getProvider(e){return ei(this,ln).getRegisteredProvider(e)}getProviderUri(e){return ei(this,ln).getProviderUri(e)}getProviderRootUri(e){return ei(this,ln).getProviderRootUri(e)}isProviderUri(e,r){return e.scheme!==Dt.scheme&&ei(this,ln).hasProvider(e,r)}getVirtualUri(e){return ei(this,ln).getVirtualUri(e)}getVirtualWorkspaceUri(e){return ei(this,ln).getVirtualWorkspaceUri(e)}}c(Cv,"ExtensionApi"),ln=new WeakMap,ql=new WeakMap;var z_=Object.defineProperty,W_=Object.getOwnPropertyDescriptor,gf=c((t,e,r,n)=>{for(var i=n>1?void 0:n?W_(e,r):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&z_(e,r,i),i},"src_fs_decorateClass");const mf=h.FileSystemError.FileNotFound().code;class qs{constructor(e,r){this.providerService=e,this.changeStore=r,this._onDidChangeFile=new h.EventEmitter,this.implicitlyWatchedUris=new Map,this.watchedUris=new Map,this.disposable=h.Disposable.from(h.workspace.registerFileSystemProvider(this.scheme,this,{isCaseSensitive:!0}),h.workspace.registerFileSearchProvider(this.scheme,this),h.workspace.registerTextSearchProvider(this.scheme,this),e.onDidChangeRepository(n=>{n.reason==="HEAD"&&this.onRefreshOrRepositoryChanged([n.repository.uri])}),e.onDidRefresh(n=>this.onRefreshOrRepositoryChanged(n)),r.onDidChange(n=>{const i=n.map(o=>{switch(o.type){case ut.Created:return{type:h.FileChangeType.Created,uri:o.uri};case ut.Changed:return{type:h.FileChangeType.Changed,uri:o.uri};case ut.Deleted:return{type:h.FileChangeType.Deleted,uri:o.uri}}});setTimeout(()=>this._onDidChangeFile.fire(i),0)}))}get onDidChangeFile(){return this._onDidChangeFile.event}get scheme(){return Dt.scheme}dispose(){var e;(e=this.disposable)==null||e.dispose()}onRefreshOrRepositoryChanged(e){e=e.filter(r=>r.scheme===this.scheme),e.length!==0&&(C.log(`fs.onRefreshOrRepositoryChanged(${e.map(r=>r.toString()).join(", ")})`),this.updateOpenOrWatchedUris(e))}updateOpenOrWatchedUris(e){const r=this.providerService.getOpenUris(this.scheme,e);for(const[i,o]of[...this.watchedUris,...this.implicitlyWatchedUris])e.some(a=>_e(o,a))&&(this.implicitlyWatchedUris.delete(i),r.set(i,o));C.debug(`fs.updateOpenOrWatchedUris(${e.map(i=>i.toString()).join(", ")}): uris=${r.size}`);for(const i of e)r.set(H(i),i);const n=[...r.values()].map(i=>({type:h.FileChangeType.Changed,uri:i}));setTimeout(()=>{C.debug(`fs.updateOpenOrWatchedUris: Firing events=${n.map(i=>i.uri.toString()).join(", ")}`),this._onDidChangeFile.fire(n)},0)}watch(e,r){const n=H(e);this.watchedUris.set(n,e);const i=this.providerService.watch(this.providerService.getProviderUri(e),r);return{dispose:()=>{this.watchedUris.delete(n),i.dispose()}}}async stat(e){const r=new Be(`fs.stat(${e.toString()})`);let n;try{if(this.changeStore.maybeHasChanges(this.providerService.getVirtualRootUri(e),e)!==!1){if(r.logStep("ChangeStore query"),n=await this.changeStore.stat(e),n!==void 0)return n;r.logStep("Provider query",{message:": Not found \u2022",suffix:" \u2022 Querying provider..."})}else r.logStep("Provider query"),this.implicitlyWatchedUris.set(H(e),e);return n=await this.providerService.stat(this.providerService.getProviderUri(e)),n}finally{n===void 0&&this.implicitlyWatchedUris.delete(H(e)),r.stop()}}async readDirectory(e){const r=new Be(`fs.readDirectory(${e.toString()})`);this.implicitlyWatchedUris.set(H(e),e);try{r.logStep("Provider query");let n=await this.providerService.readDirectory(this.providerService.getProviderUri(e));return this.changeStore.maybeHasChanges(this.providerService.getVirtualRootUri(e))!==!1&&(r.logStep("Applying changes",{suffix:" \u2022 Applying changes..."}),n=await this.changeStore.updateDirectoryEntries(e,n)),n}finally{r.stop()}}async createDirectory(e){const r=new Be(`fs.createDirectory(${e.toString()})`);try{await this.changeStore.createDirectory(e)}catch(n){throw C.error(n,r.context),n}finally{r.stop()}}async readFile(e){const r=new Be(`fs.readFile(${e.toString()})`),n=H(e);let i;try{if(this.changeStore.maybeHasChanges(this.providerService.getVirtualRootUri(e),e)!==!1){r.logStep("ChangeStore query");const o=await this.changeStore.readFile(e);if(o!==void 0)return o;r.logStep("Provider query",{message:": Not found \u2022",suffix:" \u2022 Querying provider..."})}else r.logStep("Provider query"),this.implicitlyWatchedUris.set(n,e);return i=await this.providerService.readFile(this.providerService.getProviderUri(e)),i}finally{i===void 0&&this.implicitlyWatchedUris.delete(n),r.stop()}}async writeFile(e,r,n){const i=new Be(`fs.writeFile(${e.toString()})`,{},r.length,n);try{let o;try{if(o=await this.stat(e),!n.overwrite)throw h.FileSystemError.FileExists()}catch(a){if(a instanceof h.FileSystemError&&a.code===mf){if(!n.create)throw h.FileSystemError.FileNotFound(e)}else throw a}try{if(o===void 0)await this.changeStore.createFile(e,r);else{i.logStep("Provider original query");let a;try{a=await this.providerService.readFile(this.providerService.getProviderUri(e))}catch(s){if(s instanceof h.FileSystemError&&s.code===mf)a=new Uint8Array;else throw s}i.logStep("Writing file",{suffix:" \u2022 Writing file to Change Store..."}),await this.changeStore.writeFile(e,r,a)}}catch(a){throw C.error(a,i.context),a}}finally{i.stop()}}async delete(e,r){const n=new Be(`fs.delete(${e.toString()})`,{},r);try{switch((await this.stat(e)).type){case h.FileType.File:await this.changeStore.deleteFile(e);break;case h.FileType.Directory:{await this.deleteDirectory(e,r);break}default:throw h.FileSystemError.NoPermissions()}}catch(i){throw C.error(i,n.context),i}finally{n.stop()}}async deleteDirectory(e,r){const n=new Be(`fs.deleteDirectory(${e.toString()})`,{},r);try{const i=await this.readDirectory(e);if(i.length!==0){if(!r.recursive&&i.some(([,o])=>o===h.FileType.Directory))throw h.FileSystemError.NoPermissions();for(const[o,a]of i)a===h.FileType.Directory?await this.deleteDirectory(h.Uri.joinPath(e,o),r):await this.changeStore.deleteFile(h.Uri.joinPath(e,o))}await this.changeStore.deleteDirectory(e)}catch(i){throw C.error(i,n.context),i}finally{n.stop()}}async rename(e,r,n){const i=new Be(`fs.rename(${e.toString()} -> ${r.toString()})`,{},n);try{switch((await this.stat(e)).type){case h.FileType.File:{const a=await this.readFile(e);await this.writeFile(r,a,{create:!0,overwrite:n.overwrite}),await this.delete(e,{recursive:!1});break}case h.FileType.Directory:{await this.renameDirectory(e,r,n);break}default:throw h.FileSystemError.NoPermissions()}}catch(o){throw C.error(o,i.context),o}finally{i.stop()}}async renameDirectory(e,r,n){const i=new Be(`fs.renameDirectory(${e.toString()} -> ${r.toString()})`,{},n);try{await this.copyDirectory(e,r,n),await this.delete(e,{recursive:!0})}catch(o){throw C.error(o,i.context),o}finally{i.stop()}}async copy(e,r,n){const i=new Be(`fs.copy(${e.toString()} -> ${r.toString()})`,{},n);try{switch((await this.stat(e)).type){case h.FileType.File:{const a=await this.readFile(e);await this.writeFile(r,a,{create:!0,overwrite:n.overwrite});break}case h.FileType.Directory:{await this.copyDirectory(e,r,n);break}default:throw h.FileSystemError.NoPermissions()}}catch(o){throw C.error(o,i.context),o}finally{i.stop()}}async copyDirectory(e,r,n){const i=new Be(`fs.copyDirectory(${e.toString()} -> ${r.toString()})`,{},n);try{if(await this.exists(r))throw h.FileSystemError.FileExists();try{await this.createDirectory(r);const o=await this.readDirectory(e);for(const[a,s]of o)s===h.FileType.Directory?await this.copyDirectory(h.Uri.joinPath(e,a),h.Uri.joinPath(r,a),n):await this.copy(h.Uri.joinPath(e,a),h.Uri.joinPath(r,a),n)}catch(o){throw C.error(o,i.context),o}}finally{i.stop()}}async exists(e){try{return await this.stat(e),!0}catch(r){if(r instanceof h.FileSystemError&&r.code===mf)return!1;throw r}}async provideFileSearchResults(e,r,n){var i;const o=new Be(`fs.provideFileSearchResults(${e.pattern}, ${r.folder.toString()})`,{logLevel:ie.Debug});let a;try{return a=await this.providerService.provideFileSearchResults(e,{...r,folder:this.providerService.getProviderUri(r.folder)},n),a==null?void 0:a.map(s=>this.providerService.getVirtualUri(s))}catch(s){throw C.error(s,o.context),s}finally{o.stop({suffix:` \u2022 ${(i=a==null?void 0:a.length)!=null?i:0} results found`})}}provideTextSearchResults(e,r,n,i){return this.providerService.provideTextSearchResults(e,{...r,folder:this.providerService.getProviderUri(r.folder)},{report:o=>n.report({...o,uri:this.providerService.getVirtualUri(o.uri)})},i)}}c(qs,"ChangeTrackingFileSystem"),gf([dt()],qs.prototype,"stat",1),gf([dt()],qs.prototype,"readDirectory",1),gf([dt()],qs.prototype,"readFile",1);function q_(t){return t.replace(/[\\{}*+?|^$.[\]()]/g,"\\$&")}c(q_,"escapeRegExpCharacters");function j_(t,e,r={}){if(!t)throw new Error("Cannot create regex from empty string");e||(t=q_(t)),r.wholeWord&&(/\B/.test(t.charAt(0))||(t=`\\b${t}`),/\B/.test(t.charAt(t.length-1))||(t=`${t}\\b`));let n="gmu";return r.matchCase||(n+="i"),new RegExp(t,n)}c(j_,"createRegExp");let Ev,Rv,vf;const V_=c((t,e,r,n)=>{const i=`${e.join("--")};;;;${r.join("--")}`,o=t.map(s=>s.path).join("::");if(Ev===o&&i==Rv&&vf)return vf;const a=Gh((n?t.filter(s=>s.size<n):t).map(s=>s.path),e,r);return Ev=o,Rv=i,vf=a,a},"generateIncludeSet"),G_=c((t,e,r,n)=>{var i;const o=[];let a;if(typeof t=="string")a=t;else{const d=t;if(d[0]==255&&d[1]==254)a=new TextDecoder("utf-16le").decode(d);else if(d[0]==254&&d[1]==255)a=new TextDecoder("utf-16be").decode(d);else if(a=new TextDecoder("utf8").decode(d),a.slice(0,1e3).includes("\uFFFD")&&d.includes(0))return[]}const s=[];let l=null,u=n.remainingResultQuota;for(;(u===void 0||u>=0)&&(l=r.exec(a));)s.push({matchStartIndex:l.index,matchedText:l[0]}),u!==void 0&&u--;if(s.length){const d=new Set,p=new Set,f=[],g=c(E=>a.slice(f[E].start,f[E].end),"readLine");let x=0,y=null;const b=/\r?\n/g;for(;y=b.exec(a);)f.push({start:x,end:y.index}),x=y.index+y[0].length;x<a.length&&f.push({start:x,end:a.length});let S=0;for(const{matchStartIndex:E,matchedText:D}of s){if(u!==void 0&&u<0)break;for(;Boolean(f[S+1])&&E>f[S].end;)S++;let $=S;for(;Boolean(f[$+1])&&E+D.length>f[$].end;)$++;if(n.beforeContext)for(let oe=Math.max(0,S-n.beforeContext);oe<S;oe++)d.add(oe);let z="",re=0;for(let oe=S;oe<=$;oe++){let ge=g(oe);((i=n.previewOptions)==null?void 0:i.charsPerLine)&&ge.length>n.previewOptions.charsPerLine&&(re=Math.max(E-f[S].start-20,0),ge=ge.substr(re,n.previewOptions.charsPerLine)),z+=`${ge}
`,p.add(oe)}const ne=new h.Range(S,E-f[S].start,$,E+D.length-f[$].start),ee=new h.Range(0,E-f[S].start-re,$-S,E+D.length-f[$].start-($===S?re:0)),we={uri:h.Uri.file(e),ranges:ne,preview:{text:z,matches:ee}};if(o.push(we),n.afterContext)for(let oe=$+1;oe<=Math.min($+n.afterContext,f.length-1);oe++)d.add(oe)}for(const E of d)p.has(E)||o.push({uri:h.Uri.file(e),text:g(E),lineNumber:E+1})}return o},"getFileResults");var K_=__webpack_require__(5790);/*! pako 2.0.4 https://github.com/nodeca/pako @license (MIT AND Zlib) */const Z_=4,Av=0,Tv=1,X_=2;function ka(t){let e=t.length;for(;--e>=0;)t[e]=0}c(ka,"zero$1");const Q_=0,kv=1,Y_=2,J_=3,eS=258,wf=29,js=256,Vs=js+1+wf,Ia=30,yf=19,Iv=2*Vs+1,ko=15,bf=16,tS=7,xf=256,Dv=16,Pv=17,Fv=18,_f=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),jl=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),rS=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),$v=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),nS=512,Ai=new Array((Vs+2)*2);ka(Ai);const Gs=new Array(Ia*2);ka(Gs);const Ks=new Array(nS);ka(Ks);const Zs=new Array(eS-J_+1);ka(Zs);const Sf=new Array(wf);ka(Sf);const Vl=new Array(Ia);ka(Vl);function Cf(t,e,r,n,i){this.static_tree=t,this.extra_bits=e,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=t&&t.length}c(Cf,"StaticTreeDesc");let Nv,Mv,Bv;function Ef(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}c(Ef,"TreeDesc");const Ov=c(t=>t<256?Ks[t]:Ks[256+(t>>>7)],"d_code"),Xs=c((t,e)=>{t.pending_buf[t.pending++]=e&255,t.pending_buf[t.pending++]=e>>>8&255},"put_short"),Gr=c((t,e,r)=>{t.bi_valid>bf-r?(t.bi_buf|=e<<t.bi_valid&65535,Xs(t,t.bi_buf),t.bi_buf=e>>bf-t.bi_valid,t.bi_valid+=r-bf):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=r)},"send_bits"),ti=c((t,e,r)=>{Gr(t,r[e*2],r[e*2+1])},"send_code"),Uv=c((t,e)=>{let r=0;do r|=t&1,t>>>=1,r<<=1;while(--e>0);return r>>>1},"bi_reverse"),iS=c(t=>{t.bi_valid===16?(Xs(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=t.bi_buf&255,t.bi_buf>>=8,t.bi_valid-=8)},"bi_flush"),oS=c((t,e)=>{const r=e.dyn_tree,n=e.max_code,i=e.stat_desc.static_tree,o=e.stat_desc.has_stree,a=e.stat_desc.extra_bits,s=e.stat_desc.extra_base,l=e.stat_desc.max_length;let u,d,p,f,g,x,y=0;for(f=0;f<=ko;f++)t.bl_count[f]=0;for(r[t.heap[t.heap_max]*2+1]=0,u=t.heap_max+1;u<Iv;u++)d=t.heap[u],f=r[r[d*2+1]*2+1]+1,f>l&&(f=l,y++),r[d*2+1]=f,!(d>n)&&(t.bl_count[f]++,g=0,d>=s&&(g=a[d-s]),x=r[d*2],t.opt_len+=x*(f+g),o&&(t.static_len+=x*(i[d*2+1]+g)));if(y!==0){do{for(f=l-1;t.bl_count[f]===0;)f--;t.bl_count[f]--,t.bl_count[f+1]+=2,t.bl_count[l]--,y-=2}while(y>0);for(f=l;f!==0;f--)for(d=t.bl_count[f];d!==0;)p=t.heap[--u],!(p>n)&&(r[p*2+1]!==f&&(t.opt_len+=(f-r[p*2+1])*r[p*2],r[p*2+1]=f),d--)}},"gen_bitlen"),Lv=c((t,e,r)=>{const n=new Array(ko+1);let i=0,o,a;for(o=1;o<=ko;o++)n[o]=i=i+r[o-1]<<1;for(a=0;a<=e;a++){let s=t[a*2+1];s!==0&&(t[a*2]=Uv(n[s]++,s))}},"gen_codes"),aS=c(()=>{let t,e,r,n,i;const o=new Array(ko+1);for(r=0,n=0;n<wf-1;n++)for(Sf[n]=r,t=0;t<1<<_f[n];t++)Zs[r++]=n;for(Zs[r-1]=n,i=0,n=0;n<16;n++)for(Vl[n]=i,t=0;t<1<<jl[n];t++)Ks[i++]=n;for(i>>=7;n<Ia;n++)for(Vl[n]=i<<7,t=0;t<1<<jl[n]-7;t++)Ks[256+i++]=n;for(e=0;e<=ko;e++)o[e]=0;for(t=0;t<=143;)Ai[t*2+1]=8,t++,o[8]++;for(;t<=255;)Ai[t*2+1]=9,t++,o[9]++;for(;t<=279;)Ai[t*2+1]=7,t++,o[7]++;for(;t<=287;)Ai[t*2+1]=8,t++,o[8]++;for(Lv(Ai,Vs+1,o),t=0;t<Ia;t++)Gs[t*2+1]=5,Gs[t*2]=Uv(t,5);Nv=new Cf(Ai,_f,js+1,Vs,ko),Mv=new Cf(Gs,jl,0,Ia,ko),Bv=new Cf(new Array(0),rS,0,yf,tS)},"tr_static_init"),Hv=c(t=>{let e;for(e=0;e<Vs;e++)t.dyn_ltree[e*2]=0;for(e=0;e<Ia;e++)t.dyn_dtree[e*2]=0;for(e=0;e<yf;e++)t.bl_tree[e*2]=0;t.dyn_ltree[xf*2]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0},"init_block"),zv=c(t=>{t.bi_valid>8?Xs(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},"bi_windup"),sS=c((t,e,r,n)=>{zv(t),n&&(Xs(t,r),Xs(t,~r)),t.pending_buf.set(t.window.subarray(e,e+r),t.pending),t.pending+=r},"copy_block"),Wv=c((t,e,r,n)=>{const i=e*2,o=r*2;return t[i]<t[o]||t[i]===t[o]&&n[e]<=n[r]},"smaller"),Rf=c((t,e,r)=>{const n=t.heap[r];let i=r<<1;for(;i<=t.heap_len&&(i<t.heap_len&&Wv(e,t.heap[i+1],t.heap[i],t.depth)&&i++,!Wv(e,n,t.heap[i],t.depth));)t.heap[r]=t.heap[i],r=i,i<<=1;t.heap[r]=n},"pqdownheap"),qv=c((t,e,r)=>{let n,i,o=0,a,s;if(t.last_lit!==0)do n=t.pending_buf[t.d_buf+o*2]<<8|t.pending_buf[t.d_buf+o*2+1],i=t.pending_buf[t.l_buf+o],o++,n===0?ti(t,i,e):(a=Zs[i],ti(t,a+js+1,e),s=_f[a],s!==0&&(i-=Sf[a],Gr(t,i,s)),n--,a=Ov(n),ti(t,a,r),s=jl[a],s!==0&&(n-=Vl[a],Gr(t,n,s)));while(o<t.last_lit);ti(t,xf,e)},"compress_block"),Af=c((t,e)=>{const r=e.dyn_tree,n=e.stat_desc.static_tree,i=e.stat_desc.has_stree,o=e.stat_desc.elems;let a,s,l=-1,u;for(t.heap_len=0,t.heap_max=Iv,a=0;a<o;a++)r[a*2]!==0?(t.heap[++t.heap_len]=l=a,t.depth[a]=0):r[a*2+1]=0;for(;t.heap_len<2;)u=t.heap[++t.heap_len]=l<2?++l:0,r[u*2]=1,t.depth[u]=0,t.opt_len--,i&&(t.static_len-=n[u*2+1]);for(e.max_code=l,a=t.heap_len>>1;a>=1;a--)Rf(t,r,a);u=o;do a=t.heap[1],t.heap[1]=t.heap[t.heap_len--],Rf(t,r,1),s=t.heap[1],t.heap[--t.heap_max]=a,t.heap[--t.heap_max]=s,r[u*2]=r[a*2]+r[s*2],t.depth[u]=(t.depth[a]>=t.depth[s]?t.depth[a]:t.depth[s])+1,r[a*2+1]=r[s*2+1]=u,t.heap[1]=u++,Rf(t,r,1);while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],oS(t,e),Lv(r,l,t.bl_count)},"build_tree"),jv=c((t,e,r)=>{let n,i=-1,o,a=e[0*2+1],s=0,l=7,u=4;for(a===0&&(l=138,u=3),e[(r+1)*2+1]=65535,n=0;n<=r;n++)o=a,a=e[(n+1)*2+1],!(++s<l&&o===a)&&(s<u?t.bl_tree[o*2]+=s:o!==0?(o!==i&&t.bl_tree[o*2]++,t.bl_tree[Dv*2]++):s<=10?t.bl_tree[Pv*2]++:t.bl_tree[Fv*2]++,s=0,i=o,a===0?(l=138,u=3):o===a?(l=6,u=3):(l=7,u=4))},"scan_tree"),Vv=c((t,e,r)=>{let n,i=-1,o,a=e[0*2+1],s=0,l=7,u=4;for(a===0&&(l=138,u=3),n=0;n<=r;n++)if(o=a,a=e[(n+1)*2+1],!(++s<l&&o===a)){if(s<u)do ti(t,o,t.bl_tree);while(--s!=0);else o!==0?(o!==i&&(ti(t,o,t.bl_tree),s--),ti(t,Dv,t.bl_tree),Gr(t,s-3,2)):s<=10?(ti(t,Pv,t.bl_tree),Gr(t,s-3,3)):(ti(t,Fv,t.bl_tree),Gr(t,s-11,7));s=0,i=o,a===0?(l=138,u=3):o===a?(l=6,u=3):(l=7,u=4)}},"send_tree"),cS=c(t=>{let e;for(jv(t,t.dyn_ltree,t.l_desc.max_code),jv(t,t.dyn_dtree,t.d_desc.max_code),Af(t,t.bl_desc),e=yf-1;e>=3&&t.bl_tree[$v[e]*2+1]===0;e--);return t.opt_len+=3*(e+1)+5+5+4,e},"build_bl_tree"),lS=c((t,e,r,n)=>{let i;for(Gr(t,e-257,5),Gr(t,r-1,5),Gr(t,n-4,4),i=0;i<n;i++)Gr(t,t.bl_tree[$v[i]*2+1],3);Vv(t,t.dyn_ltree,e-1),Vv(t,t.dyn_dtree,r-1)},"send_all_trees"),uS=c(t=>{let e=4093624447,r;for(r=0;r<=31;r++,e>>>=1)if(e&1&&t.dyn_ltree[r*2]!==0)return Av;if(t.dyn_ltree[9*2]!==0||t.dyn_ltree[10*2]!==0||t.dyn_ltree[13*2]!==0)return Tv;for(r=32;r<js;r++)if(t.dyn_ltree[r*2]!==0)return Tv;return Av},"detect_data_type");let Gv=!1;const dS=c(t=>{Gv||(aS(),Gv=!0),t.l_desc=new Ef(t.dyn_ltree,Nv),t.d_desc=new Ef(t.dyn_dtree,Mv),t.bl_desc=new Ef(t.bl_tree,Bv),t.bi_buf=0,t.bi_valid=0,Hv(t)},"_tr_init$1"),Kv=c((t,e,r,n)=>{Gr(t,(Q_<<1)+(n?1:0),3),sS(t,e,r,!0)},"_tr_stored_block$1"),hS=c(t=>{Gr(t,kv<<1,3),ti(t,xf,Ai),iS(t)},"_tr_align$1"),fS=c((t,e,r,n)=>{let i,o,a=0;t.level>0?(t.strm.data_type===X_&&(t.strm.data_type=uS(t)),Af(t,t.l_desc),Af(t,t.d_desc),a=cS(t),i=t.opt_len+3+7>>>3,o=t.static_len+3+7>>>3,o<=i&&(i=o)):i=o=r+5,r+4<=i&&e!==-1?Kv(t,e,r,n):t.strategy===Z_||o===i?(Gr(t,(kv<<1)+(n?1:0),3),qv(t,Ai,Gs)):(Gr(t,(Y_<<1)+(n?1:0),3),lS(t,t.l_desc.max_code+1,t.d_desc.max_code+1,a+1),qv(t,t.dyn_ltree,t.dyn_dtree)),Hv(t),n&&zv(t)},"_tr_flush_block$1"),pS=c((t,e,r)=>(t.pending_buf[t.d_buf+t.last_lit*2]=e>>>8&255,t.pending_buf[t.d_buf+t.last_lit*2+1]=e&255,t.pending_buf[t.l_buf+t.last_lit]=r&255,t.last_lit++,e===0?t.dyn_ltree[r*2]++:(t.matches++,e--,t.dyn_ltree[(Zs[r]+js+1)*2]++,t.dyn_dtree[Ov(e)*2]++),t.last_lit===t.lit_bufsize-1),"_tr_tally$1");var gS=dS,mS=Kv,vS=fS,wS=pS,yS=hS,bS={_tr_init:gS,_tr_stored_block:mS,_tr_flush_block:vS,_tr_tally:wS,_tr_align:yS},Qs=c((t,e,r,n)=>{let i=t&65535|0,o=t>>>16&65535|0,a=0;for(;r!==0;){a=r>2e3?2e3:r,r-=a;do i=i+e[n++]|0,o=o+i|0;while(--a);i%=65521,o%=65521}return i|o<<16|0},"adler32");const xS=c(()=>{let t,e=[];for(var r=0;r<256;r++){t=r;for(var n=0;n<8;n++)t=t&1?3988292384^t>>>1:t>>>1;e[r]=t}return e},"makeTable"),_S=new Uint32Array(xS());var br=c((t,e,r,n)=>{const i=_S,o=n+r;t^=-1;for(let a=n;a<o;a++)t=t>>>8^i[(t^e[a])&255];return t^-1},"crc32"),Io={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Do={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:SS,_tr_stored_block:CS,_tr_flush_block:ES,_tr_tally:Yi,_tr_align:RS}=bS,{Z_NO_FLUSH:Po,Z_PARTIAL_FLUSH:AS,Z_FULL_FLUSH:TS,Z_FINISH:Ji,Z_BLOCK:Zv,Z_OK:ri,Z_STREAM_END:Xv,Z_STREAM_ERROR:un,Z_DATA_ERROR:kS,Z_BUF_ERROR:Tf,Z_DEFAULT_COMPRESSION:IS,Z_FILTERED:DS,Z_HUFFMAN_ONLY:Gl,Z_RLE:PS,Z_FIXED:FS,Z_DEFAULT_STRATEGY:$S,Z_UNKNOWN:NS,Z_DEFLATED:Kl}=Do,MS=9,BS=15,OS=8,US=29,kf=256+1+US,LS=30,HS=19,zS=2*kf+1,WS=15,Rt=3,eo=258,Dn=eo+Rt+1,qS=32,Zl=42,If=69,Xl=73,Ql=91,Yl=103,Fo=113,Ys=666,mr=1,Js=2,$o=3,Da=4,jS=3,to=c((t,e)=>(t.msg=Io[e],e),"err"),Qv=c(t=>(t<<1)-(t>4?9:0),"rank"),ro=c(t=>{let e=t.length;for(;--e>=0;)t[e]=0},"zero");let no=c((t,e,r)=>(e<<t.hash_shift^r)&t.hash_mask,"HASH_ZLIB");const io=c(t=>{const e=t.state;let r=e.pending;r>t.avail_out&&(r=t.avail_out),r!==0&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+r),t.next_out),t.next_out+=r,e.pending_out+=r,t.total_out+=r,t.avail_out-=r,e.pending-=r,e.pending===0&&(e.pending_out=0))},"flush_pending"),Ar=c((t,e)=>{ES(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,io(t.strm)},"flush_block_only"),Pt=c((t,e)=>{t.pending_buf[t.pending++]=e},"put_byte"),ec=c((t,e)=>{t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=e&255},"putShortMSB"),VS=c((t,e,r,n)=>{let i=t.avail_in;return i>n&&(i=n),i===0?0:(t.avail_in-=i,e.set(t.input.subarray(t.next_in,t.next_in+i),r),t.state.wrap===1?t.adler=Qs(t.adler,e,i,r):t.state.wrap===2&&(t.adler=br(t.adler,e,i,r)),t.next_in+=i,t.total_in+=i,i)},"read_buf"),Yv=c((t,e)=>{let r=t.max_chain_length,n=t.strstart,i,o,a=t.prev_length,s=t.nice_match;const l=t.strstart>t.w_size-Dn?t.strstart-(t.w_size-Dn):0,u=t.window,d=t.w_mask,p=t.prev,f=t.strstart+eo;let g=u[n+a-1],x=u[n+a];t.prev_length>=t.good_match&&(r>>=2),s>t.lookahead&&(s=t.lookahead);do if(i=e,!(u[i+a]!==x||u[i+a-1]!==g||u[i]!==u[n]||u[++i]!==u[n+1])){n+=2,i++;do;while(u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&n<f);if(o=eo-(f-n),n=f-eo,o>a){if(t.match_start=e,a=o,o>=s)break;g=u[n+a-1],x=u[n+a]}}while((e=p[e&d])>l&&--r!=0);return a<=t.lookahead?a:t.lookahead},"longest_match"),No=c(t=>{const e=t.w_size;let r,n,i,o,a;do{if(o=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-Dn)){t.window.set(t.window.subarray(e,e+e),0),t.match_start-=e,t.strstart-=e,t.block_start-=e,n=t.hash_size,r=n;do i=t.head[--r],t.head[r]=i>=e?i-e:0;while(--n);n=e,r=n;do i=t.prev[--r],t.prev[r]=i>=e?i-e:0;while(--n);o+=e}if(t.strm.avail_in===0)break;if(n=VS(t.strm,t.window,t.strstart+t.lookahead,o),t.lookahead+=n,t.lookahead+t.insert>=Rt)for(a=t.strstart-t.insert,t.ins_h=t.window[a],t.ins_h=no(t,t.ins_h,t.window[a+1]);t.insert&&(t.ins_h=no(t,t.ins_h,t.window[a+Rt-1]),t.prev[a&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=a,a++,t.insert--,!(t.lookahead+t.insert<Rt)););}while(t.lookahead<Dn&&t.strm.avail_in!==0)},"fill_window"),GS=c((t,e)=>{let r=65535;for(r>t.pending_buf_size-5&&(r=t.pending_buf_size-5);;){if(t.lookahead<=1){if(No(t),t.lookahead===0&&e===Po)return mr;if(t.lookahead===0)break}t.strstart+=t.lookahead,t.lookahead=0;const n=t.block_start+r;if((t.strstart===0||t.strstart>=n)&&(t.lookahead=t.strstart-n,t.strstart=n,Ar(t,!1),t.strm.avail_out===0)||t.strstart-t.block_start>=t.w_size-Dn&&(Ar(t,!1),t.strm.avail_out===0))return mr}return t.insert=0,e===Ji?(Ar(t,!0),t.strm.avail_out===0?$o:Da):(t.strstart>t.block_start&&(Ar(t,!1),t.strm.avail_out===0),mr)},"deflate_stored"),Df=c((t,e)=>{let r,n;for(;;){if(t.lookahead<Dn){if(No(t),t.lookahead<Dn&&e===Po)return mr;if(t.lookahead===0)break}if(r=0,t.lookahead>=Rt&&(t.ins_h=no(t,t.ins_h,t.window[t.strstart+Rt-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),r!==0&&t.strstart-r<=t.w_size-Dn&&(t.match_length=Yv(t,r)),t.match_length>=Rt)if(n=Yi(t,t.strstart-t.match_start,t.match_length-Rt),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=Rt){t.match_length--;do t.strstart++,t.ins_h=no(t,t.ins_h,t.window[t.strstart+Rt-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart;while(--t.match_length!=0);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=no(t,t.ins_h,t.window[t.strstart+1]);else n=Yi(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(Ar(t,!1),t.strm.avail_out===0))return mr}return t.insert=t.strstart<Rt-1?t.strstart:Rt-1,e===Ji?(Ar(t,!0),t.strm.avail_out===0?$o:Da):t.last_lit&&(Ar(t,!1),t.strm.avail_out===0)?mr:Js},"deflate_fast"),Pa=c((t,e)=>{let r,n,i;for(;;){if(t.lookahead<Dn){if(No(t),t.lookahead<Dn&&e===Po)return mr;if(t.lookahead===0)break}if(r=0,t.lookahead>=Rt&&(t.ins_h=no(t,t.ins_h,t.window[t.strstart+Rt-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=Rt-1,r!==0&&t.prev_length<t.max_lazy_match&&t.strstart-r<=t.w_size-Dn&&(t.match_length=Yv(t,r),t.match_length<=5&&(t.strategy===DS||t.match_length===Rt&&t.strstart-t.match_start>4096)&&(t.match_length=Rt-1)),t.prev_length>=Rt&&t.match_length<=t.prev_length){i=t.strstart+t.lookahead-Rt,n=Yi(t,t.strstart-1-t.prev_match,t.prev_length-Rt),t.lookahead-=t.prev_length-1,t.prev_length-=2;do++t.strstart<=i&&(t.ins_h=no(t,t.ins_h,t.window[t.strstart+Rt-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart);while(--t.prev_length!=0);if(t.match_available=0,t.match_length=Rt-1,t.strstart++,n&&(Ar(t,!1),t.strm.avail_out===0))return mr}else if(t.match_available){if(n=Yi(t,0,t.window[t.strstart-1]),n&&Ar(t,!1),t.strstart++,t.lookahead--,t.strm.avail_out===0)return mr}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=Yi(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<Rt-1?t.strstart:Rt-1,e===Ji?(Ar(t,!0),t.strm.avail_out===0?$o:Da):t.last_lit&&(Ar(t,!1),t.strm.avail_out===0)?mr:Js},"deflate_slow"),KS=c((t,e)=>{let r,n,i,o;const a=t.window;for(;;){if(t.lookahead<=eo){if(No(t),t.lookahead<=eo&&e===Po)return mr;if(t.lookahead===0)break}if(t.match_length=0,t.lookahead>=Rt&&t.strstart>0&&(i=t.strstart-1,n=a[i],n===a[++i]&&n===a[++i]&&n===a[++i])){o=t.strstart+eo;do;while(n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&i<o);t.match_length=eo-(o-i),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=Rt?(r=Yi(t,1,t.match_length-Rt),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(r=Yi(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),r&&(Ar(t,!1),t.strm.avail_out===0))return mr}return t.insert=0,e===Ji?(Ar(t,!0),t.strm.avail_out===0?$o:Da):t.last_lit&&(Ar(t,!1),t.strm.avail_out===0)?mr:Js},"deflate_rle"),ZS=c((t,e)=>{let r;for(;;){if(t.lookahead===0&&(No(t),t.lookahead===0)){if(e===Po)return mr;break}if(t.match_length=0,r=Yi(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,r&&(Ar(t,!1),t.strm.avail_out===0))return mr}return t.insert=0,e===Ji?(Ar(t,!0),t.strm.avail_out===0?$o:Da):t.last_lit&&(Ar(t,!1),t.strm.avail_out===0)?mr:Js},"deflate_huff");function ni(t,e,r,n,i){this.good_length=t,this.max_lazy=e,this.nice_length=r,this.max_chain=n,this.func=i}c(ni,"Config");const tc=[new ni(0,0,0,0,GS),new ni(4,4,8,4,Df),new ni(4,5,16,8,Df),new ni(4,6,32,32,Df),new ni(4,4,16,16,Pa),new ni(8,16,32,32,Pa),new ni(8,16,128,128,Pa),new ni(8,32,128,256,Pa),new ni(32,128,258,1024,Pa),new ni(32,258,258,4096,Pa)],XS=c(t=>{t.window_size=2*t.w_size,ro(t.head),t.max_lazy_match=tc[t.level].max_lazy,t.good_match=tc[t.level].good_length,t.nice_match=tc[t.level].nice_length,t.max_chain_length=tc[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=Rt-1,t.match_available=0,t.ins_h=0},"lm_init");function QS(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Kl,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(zS*2),this.dyn_dtree=new Uint16Array((2*LS+1)*2),this.bl_tree=new Uint16Array((2*HS+1)*2),ro(this.dyn_ltree),ro(this.dyn_dtree),ro(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(WS+1),this.heap=new Uint16Array(2*kf+1),ro(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*kf+1),ro(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}c(QS,"DeflateState");const Jv=c(t=>{if(!t||!t.state)return to(t,un);t.total_in=t.total_out=0,t.data_type=NS;const e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?Zl:Fo,t.adler=e.wrap===2?0:1,e.last_flush=Po,SS(e),ri},"deflateResetKeep"),ew=c(t=>{const e=Jv(t);return e===ri&&XS(t.state),e},"deflateReset"),YS=c((t,e)=>!t||!t.state||t.state.wrap!==2?un:(t.state.gzhead=e,ri),"deflateSetHeader"),tw=c((t,e,r,n,i,o)=>{if(!t)return un;let a=1;if(e===IS&&(e=6),n<0?(a=0,n=-n):n>15&&(a=2,n-=16),i<1||i>MS||r!==Kl||n<8||n>15||e<0||e>9||o<0||o>FS)return to(t,un);n===8&&(n=9);const s=new QS;return t.state=s,s.strm=t,s.wrap=a,s.gzhead=null,s.w_bits=n,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=i+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+Rt-1)/Rt),s.window=new Uint8Array(s.w_size*2),s.head=new Uint16Array(s.hash_size),s.prev=new Uint16Array(s.w_size),s.lit_bufsize=1<<i+6,s.pending_buf_size=s.lit_bufsize*4,s.pending_buf=new Uint8Array(s.pending_buf_size),s.d_buf=1*s.lit_bufsize,s.l_buf=(1+2)*s.lit_bufsize,s.level=e,s.strategy=o,s.method=r,ew(t)},"deflateInit2"),JS=c((t,e)=>tw(t,e,Kl,BS,OS,$S),"deflateInit"),eC=c((t,e)=>{let r,n;if(!t||!t.state||e>Zv||e<0)return t?to(t,un):un;const i=t.state;if(!t.output||!t.input&&t.avail_in!==0||i.status===Ys&&e!==Ji)return to(t,t.avail_out===0?Tf:un);i.strm=t;const o=i.last_flush;if(i.last_flush=e,i.status===Zl)if(i.wrap===2)t.adler=0,Pt(i,31),Pt(i,139),Pt(i,8),i.gzhead?(Pt(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),Pt(i,i.gzhead.time&255),Pt(i,i.gzhead.time>>8&255),Pt(i,i.gzhead.time>>16&255),Pt(i,i.gzhead.time>>24&255),Pt(i,i.level===9?2:i.strategy>=Gl||i.level<2?4:0),Pt(i,i.gzhead.os&255),i.gzhead.extra&&i.gzhead.extra.length&&(Pt(i,i.gzhead.extra.length&255),Pt(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(t.adler=br(t.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=If):(Pt(i,0),Pt(i,0),Pt(i,0),Pt(i,0),Pt(i,0),Pt(i,i.level===9?2:i.strategy>=Gl||i.level<2?4:0),Pt(i,jS),i.status=Fo);else{let a=Kl+(i.w_bits-8<<4)<<8,s=-1;i.strategy>=Gl||i.level<2?s=0:i.level<6?s=1:i.level===6?s=2:s=3,a|=s<<6,i.strstart!==0&&(a|=qS),a+=31-a%31,i.status=Fo,ec(i,a),i.strstart!==0&&(ec(i,t.adler>>>16),ec(i,t.adler&65535)),t.adler=1}if(i.status===If)if(i.gzhead.extra){for(r=i.pending;i.gzindex<(i.gzhead.extra.length&65535)&&!(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(t.adler=br(t.adler,i.pending_buf,i.pending-r,r)),io(t),r=i.pending,i.pending===i.pending_buf_size));)Pt(i,i.gzhead.extra[i.gzindex]&255),i.gzindex++;i.gzhead.hcrc&&i.pending>r&&(t.adler=br(t.adler,i.pending_buf,i.pending-r,r)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=Xl)}else i.status=Xl;if(i.status===Xl)if(i.gzhead.name){r=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(t.adler=br(t.adler,i.pending_buf,i.pending-r,r)),io(t),r=i.pending,i.pending===i.pending_buf_size)){n=1;break}i.gzindex<i.gzhead.name.length?n=i.gzhead.name.charCodeAt(i.gzindex++)&255:n=0,Pt(i,n)}while(n!==0);i.gzhead.hcrc&&i.pending>r&&(t.adler=br(t.adler,i.pending_buf,i.pending-r,r)),n===0&&(i.gzindex=0,i.status=Ql)}else i.status=Ql;if(i.status===Ql)if(i.gzhead.comment){r=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(t.adler=br(t.adler,i.pending_buf,i.pending-r,r)),io(t),r=i.pending,i.pending===i.pending_buf_size)){n=1;break}i.gzindex<i.gzhead.comment.length?n=i.gzhead.comment.charCodeAt(i.gzindex++)&255:n=0,Pt(i,n)}while(n!==0);i.gzhead.hcrc&&i.pending>r&&(t.adler=br(t.adler,i.pending_buf,i.pending-r,r)),n===0&&(i.status=Yl)}else i.status=Yl;if(i.status===Yl&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&io(t),i.pending+2<=i.pending_buf_size&&(Pt(i,t.adler&255),Pt(i,t.adler>>8&255),t.adler=0,i.status=Fo)):i.status=Fo),i.pending!==0){if(io(t),t.avail_out===0)return i.last_flush=-1,ri}else if(t.avail_in===0&&Qv(e)<=Qv(o)&&e!==Ji)return to(t,Tf);if(i.status===Ys&&t.avail_in!==0)return to(t,Tf);if(t.avail_in!==0||i.lookahead!==0||e!==Po&&i.status!==Ys){let a=i.strategy===Gl?ZS(i,e):i.strategy===PS?KS(i,e):tc[i.level].func(i,e);if((a===$o||a===Da)&&(i.status=Ys),a===mr||a===$o)return t.avail_out===0&&(i.last_flush=-1),ri;if(a===Js&&(e===AS?RS(i):e!==Zv&&(CS(i,0,0,!1),e===TS&&(ro(i.head),i.lookahead===0&&(i.strstart=0,i.block_start=0,i.insert=0))),io(t),t.avail_out===0))return i.last_flush=-1,ri}return e!==Ji?ri:i.wrap<=0?Xv:(i.wrap===2?(Pt(i,t.adler&255),Pt(i,t.adler>>8&255),Pt(i,t.adler>>16&255),Pt(i,t.adler>>24&255),Pt(i,t.total_in&255),Pt(i,t.total_in>>8&255),Pt(i,t.total_in>>16&255),Pt(i,t.total_in>>24&255)):(ec(i,t.adler>>>16),ec(i,t.adler&65535)),io(t),i.wrap>0&&(i.wrap=-i.wrap),i.pending!==0?ri:Xv)},"deflate$2"),tC=c(t=>{if(!t||!t.state)return un;const e=t.state.status;return e!==Zl&&e!==If&&e!==Xl&&e!==Ql&&e!==Yl&&e!==Fo&&e!==Ys?to(t,un):(t.state=null,e===Fo?to(t,kS):ri)},"deflateEnd"),rC=c((t,e)=>{let r=e.length;if(!t||!t.state)return un;const n=t.state,i=n.wrap;if(i===2||i===1&&n.status!==Zl||n.lookahead)return un;if(i===1&&(t.adler=Qs(t.adler,e,r,0)),n.wrap=0,r>=n.w_size){i===0&&(ro(n.head),n.strstart=0,n.block_start=0,n.insert=0);let l=new Uint8Array(n.w_size);l.set(e.subarray(r-n.w_size,r),0),e=l,r=n.w_size}const o=t.avail_in,a=t.next_in,s=t.input;for(t.avail_in=r,t.next_in=0,t.input=e,No(n);n.lookahead>=Rt;){let l=n.strstart,u=n.lookahead-(Rt-1);do n.ins_h=no(n,n.ins_h,n.window[l+Rt-1]),n.prev[l&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=l,l++;while(--u);n.strstart=l,n.lookahead=Rt-1,No(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=Rt-1,n.match_available=0,t.next_in=a,t.input=s,t.avail_in=o,n.wrap=i,ri},"deflateSetDictionary");var nC=JS,iC=tw,oC=ew,aC=Jv,sC=YS,cC=eC,lC=tC,uC=rC,dC="pako deflate (from Nodeca project)",rc={deflateInit:nC,deflateInit2:iC,deflateReset:oC,deflateResetKeep:aC,deflateSetHeader:sC,deflate:cC,deflateEnd:lC,deflateSetDictionary:uC,deflateInfo:dC};const hC=c((t,e)=>Object.prototype.hasOwnProperty.call(t,e),"_has");var fC=c(function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const r=e.shift();if(!!r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)hC(r,n)&&(t[n]=r[n])}}return t},"pako_esm_assign"),pC=c(t=>{let e=0;for(let n=0,i=t.length;n<i;n++)e+=t[n].length;const r=new Uint8Array(e);for(let n=0,i=0,o=t.length;n<o;n++){let a=t[n];r.set(a,i),i+=a.length}return r},"flattenChunks"),Jl={assign:fC,flattenChunks:pC};let rw=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){rw=!1}const nc=new Uint8Array(256);for(let t=0;t<256;t++)nc[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;nc[254]=nc[254]=1;var gC=c(t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,r,n,i,o,a=t.length,s=0;for(i=0;i<a;i++)r=t.charCodeAt(i),(r&64512)==55296&&i+1<a&&(n=t.charCodeAt(i+1),(n&64512)==56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),s+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Uint8Array(s),o=0,i=0;o<s;i++)r=t.charCodeAt(i),(r&64512)==55296&&i+1<a&&(n=t.charCodeAt(i+1),(n&64512)==56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),r<128?e[o++]=r:r<2048?(e[o++]=192|r>>>6,e[o++]=128|r&63):r<65536?(e[o++]=224|r>>>12,e[o++]=128|r>>>6&63,e[o++]=128|r&63):(e[o++]=240|r>>>18,e[o++]=128|r>>>12&63,e[o++]=128|r>>>6&63,e[o++]=128|r&63);return e},"string2buf");const mC=c((t,e)=>{if(e<65534&&t.subarray&&rw)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let r="";for(let n=0;n<e;n++)r+=String.fromCharCode(t[n]);return r},"buf2binstring");var vC=c((t,e)=>{const r=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let n,i;const o=new Array(r*2);for(i=0,n=0;n<r;){let a=t[n++];if(a<128){o[i++]=a;continue}let s=nc[a];if(s>4){o[i++]=65533,n+=s-1;continue}for(a&=s===2?31:s===3?15:7;s>1&&n<r;)a=a<<6|t[n++]&63,s--;if(s>1){o[i++]=65533;continue}a<65536?o[i++]=a:(a-=65536,o[i++]=55296|a>>10&1023,o[i++]=56320|a&1023)}return mC(o,i)},"buf2string"),wC=c((t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let r=e-1;for(;r>=0&&(t[r]&192)==128;)r--;return r<0||r===0?e:r+nc[t[r]]>e?r:e},"utf8border"),ic={string2buf:gC,buf2string:vC,utf8border:wC};function yC(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}c(yC,"ZStream");var nw=yC;const iw=Object.prototype.toString,{Z_NO_FLUSH:bC,Z_SYNC_FLUSH:xC,Z_FULL_FLUSH:_C,Z_FINISH:SC,Z_OK:eu,Z_STREAM_END:CC,Z_DEFAULT_COMPRESSION:EC,Z_DEFAULT_STRATEGY:RC,Z_DEFLATED:AC}=Do;function oc(t){this.options=Jl.assign({level:EC,method:AC,chunkSize:16384,windowBits:15,memLevel:8,strategy:RC},t||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new nw,this.strm.avail_out=0;let r=rc.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(r!==eu)throw new Error(Io[r]);if(e.header&&rc.deflateSetHeader(this.strm,e.header),e.dictionary){let n;if(typeof e.dictionary=="string"?n=ic.string2buf(e.dictionary):iw.call(e.dictionary)==="[object ArrayBuffer]"?n=new Uint8Array(e.dictionary):n=e.dictionary,r=rc.deflateSetDictionary(this.strm,n),r!==eu)throw new Error(Io[r]);this._dict_set=!0}}c(oc,"Deflate$1"),oc.prototype.push=function(t,e){const r=this.strm,n=this.options.chunkSize;let i,o;if(this.ended)return!1;for(e===~~e?o=e:o=e===!0?SC:bC,typeof t=="string"?r.input=ic.string2buf(t):iw.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){if(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),(o===xC||o===_C)&&r.avail_out<=6){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(i=rc.deflate(r,o),i===CC)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),i=rc.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===eu;if(r.avail_out===0){this.onData(r.output);continue}if(o>0&&r.next_out>0){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(r.avail_in===0)break}return!0},oc.prototype.onData=function(t){this.chunks.push(t)},oc.prototype.onEnd=function(t){t===eu&&(this.result=Jl.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function Pf(t,e){const r=new oc(e);if(r.push(t,!0),r.err)throw r.msg||Io[r.err];return r.result}c(Pf,"deflate$1");function TC(t,e){return e=e||{},e.raw=!0,Pf(t,e)}c(TC,"deflateRaw$1");function kC(t,e){return e=e||{},e.gzip=!0,Pf(t,e)}c(kC,"gzip$1");var IC=oc,DC=Pf,PC=TC,FC=kC,$C=Do,NC={Deflate:IC,deflate:DC,deflateRaw:PC,gzip:FC,constants:$C};const tu=30,MC=12;var BC=c(function(e,r){let n,i,o,a,s,l,u,d,p,f,g,x,y,b,S,E,D,$,z,re,ne,ee,we,oe;const ge=e.state;n=e.next_in,we=e.input,i=n+(e.avail_in-5),o=e.next_out,oe=e.output,a=o-(r-e.avail_out),s=o+(e.avail_out-257),l=ge.dmax,u=ge.wsize,d=ge.whave,p=ge.wnext,f=ge.window,g=ge.hold,x=ge.bits,y=ge.lencode,b=ge.distcode,S=(1<<ge.lenbits)-1,E=(1<<ge.distbits)-1;e:do{x<15&&(g+=we[n++]<<x,x+=8,g+=we[n++]<<x,x+=8),D=y[g&S];t:for(;;){if($=D>>>24,g>>>=$,x-=$,$=D>>>16&255,$===0)oe[o++]=D&65535;else if($&16){z=D&65535,$&=15,$&&(x<$&&(g+=we[n++]<<x,x+=8),z+=g&(1<<$)-1,g>>>=$,x-=$),x<15&&(g+=we[n++]<<x,x+=8,g+=we[n++]<<x,x+=8),D=b[g&E];r:for(;;){if($=D>>>24,g>>>=$,x-=$,$=D>>>16&255,$&16){if(re=D&65535,$&=15,x<$&&(g+=we[n++]<<x,x+=8,x<$&&(g+=we[n++]<<x,x+=8)),re+=g&(1<<$)-1,re>l){e.msg="invalid distance too far back",ge.mode=tu;break e}if(g>>>=$,x-=$,$=o-a,re>$){if($=re-$,$>d&&ge.sane){e.msg="invalid distance too far back",ge.mode=tu;break e}if(ne=0,ee=f,p===0){if(ne+=u-$,$<z){z-=$;do oe[o++]=f[ne++];while(--$);ne=o-re,ee=oe}}else if(p<$){if(ne+=u+p-$,$-=p,$<z){z-=$;do oe[o++]=f[ne++];while(--$);if(ne=0,p<z){$=p,z-=$;do oe[o++]=f[ne++];while(--$);ne=o-re,ee=oe}}}else if(ne+=p-$,$<z){z-=$;do oe[o++]=f[ne++];while(--$);ne=o-re,ee=oe}for(;z>2;)oe[o++]=ee[ne++],oe[o++]=ee[ne++],oe[o++]=ee[ne++],z-=3;z&&(oe[o++]=ee[ne++],z>1&&(oe[o++]=ee[ne++]))}else{ne=o-re;do oe[o++]=oe[ne++],oe[o++]=oe[ne++],oe[o++]=oe[ne++],z-=3;while(z>2);z&&(oe[o++]=oe[ne++],z>1&&(oe[o++]=oe[ne++]))}}else if(($&64)==0){D=b[(D&65535)+(g&(1<<$)-1)];continue r}else{e.msg="invalid distance code",ge.mode=tu;break e}break}}else if(($&64)==0){D=y[(D&65535)+(g&(1<<$)-1)];continue t}else if($&32){ge.mode=MC;break e}else{e.msg="invalid literal/length code",ge.mode=tu;break e}break}}while(n<i&&o<s);z=x>>3,n-=z,x-=z<<3,g&=(1<<x)-1,e.next_in=n,e.next_out=o,e.avail_in=n<i?5+(i-n):5-(n-i),e.avail_out=o<s?257+(s-o):257-(o-s),ge.hold=g,ge.bits=x},"inflate_fast");const Fa=15,ow=852,aw=592,sw=0,Ff=1,cw=2,OC=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),UC=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),LC=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),HC=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var ac=c((t,e,r,n,i,o,a,s)=>{const l=s.bits;let u=0,d=0,p=0,f=0,g=0,x=0,y=0,b=0,S=0,E=0,D,$,z,re,ne,ee=null,we=0,oe;const ge=new Uint16Array(Fa+1),Ee=new Uint16Array(Fa+1);let et=null,ae=0,Re,Ne,$e;for(u=0;u<=Fa;u++)ge[u]=0;for(d=0;d<n;d++)ge[e[r+d]]++;for(g=l,f=Fa;f>=1&&ge[f]===0;f--);if(g>f&&(g=f),f===0)return i[o++]=1<<24|64<<16|0,i[o++]=1<<24|64<<16|0,s.bits=1,0;for(p=1;p<f&&ge[p]===0;p++);for(g<p&&(g=p),b=1,u=1;u<=Fa;u++)if(b<<=1,b-=ge[u],b<0)return-1;if(b>0&&(t===sw||f!==1))return-1;for(Ee[1]=0,u=1;u<Fa;u++)Ee[u+1]=Ee[u]+ge[u];for(d=0;d<n;d++)e[r+d]!==0&&(a[Ee[e[r+d]]++]=d);if(t===sw?(ee=et=a,oe=19):t===Ff?(ee=OC,we-=257,et=UC,ae-=257,oe=256):(ee=LC,et=HC,oe=-1),E=0,d=0,u=p,ne=o,x=g,y=0,z=-1,S=1<<g,re=S-1,t===Ff&&S>ow||t===cw&&S>aw)return 1;for(;;){Re=u-y,a[d]<oe?(Ne=0,$e=a[d]):a[d]>oe?(Ne=et[ae+a[d]],$e=ee[we+a[d]]):(Ne=32+64,$e=0),D=1<<u-y,$=1<<x,p=$;do $-=D,i[ne+(E>>y)+$]=Re<<24|Ne<<16|$e|0;while($!==0);for(D=1<<u-1;E&D;)D>>=1;if(D!==0?(E&=D-1,E+=D):E=0,d++,--ge[u]==0){if(u===f)break;u=e[r+a[d]]}if(u>g&&(E&re)!==z){for(y===0&&(y=g),ne+=p,x=u-y,b=1<<x;x+y<f&&(b-=ge[x+y],!(b<=0));)x++,b<<=1;if(S+=1<<x,t===Ff&&S>ow||t===cw&&S>aw)return 1;z=E&re,i[z]=g<<24|x<<16|ne-o|0}}return E!==0&&(i[ne+E]=u-y<<24|64<<16|0),s.bits=g,0},"inflate_table");const zC=0,lw=1,uw=2,{Z_FINISH:dw,Z_BLOCK:WC,Z_TREES:ru,Z_OK:Mo,Z_STREAM_END:qC,Z_NEED_DICT:jC,Z_STREAM_ERROR:dn,Z_DATA_ERROR:hw,Z_MEM_ERROR:fw,Z_BUF_ERROR:VC,Z_DEFLATED:pw}=Do,gw=1,mw=2,vw=3,ww=4,yw=5,bw=6,xw=7,_w=8,Sw=9,Cw=10,nu=11,Ti=12,$f=13,Ew=14,Nf=15,Rw=16,Aw=17,Tw=18,kw=19,iu=20,ou=21,Iw=22,Dw=23,Pw=24,Fw=25,$w=26,Mf=27,Nw=28,Mw=29,er=30,Bw=31,GC=32,KC=852,ZC=592,XC=15,Ow=c(t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24),"zswap32");function QC(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}c(QC,"InflateState");const Uw=c(t=>{if(!t||!t.state)return dn;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=gw,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(KC),e.distcode=e.distdyn=new Int32Array(ZC),e.sane=1,e.back=-1,Mo},"inflateResetKeep"),Lw=c(t=>{if(!t||!t.state)return dn;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,Uw(t)},"inflateReset"),Hw=c((t,e)=>{let r;if(!t||!t.state)return dn;const n=t.state;return e<0?(r=0,e=-e):(r=(e>>4)+1,e<48&&(e&=15)),e&&(e<8||e>15)?dn:(n.window!==null&&n.wbits!==e&&(n.window=null),n.wrap=r,n.wbits=e,Lw(t))},"inflateReset2"),zw=c((t,e)=>{if(!t)return dn;const r=new QC;t.state=r,r.window=null;const n=Hw(t,e);return n!==Mo&&(t.state=null),n},"inflateInit2"),YC=c(t=>zw(t,XC),"inflateInit");let Ww=!0,Bf,Of;const JC=c(t=>{if(Ww){Bf=new Int32Array(512),Of=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(ac(lw,t.lens,0,288,Bf,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;ac(uw,t.lens,0,32,Of,0,t.work,{bits:5}),Ww=!1}t.lencode=Bf,t.lenbits=9,t.distcode=Of,t.distbits=5},"fixedtables"),qw=c((t,e,r,n)=>{let i;const o=t.state;return o.window===null&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),n>=o.wsize?(o.window.set(e.subarray(r-o.wsize,r),0),o.wnext=0,o.whave=o.wsize):(i=o.wsize-o.wnext,i>n&&(i=n),o.window.set(e.subarray(r-n,r-n+i),o.wnext),n-=i,n?(o.window.set(e.subarray(r-n,r),0),o.wnext=n,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0},"updatewindow"),e1=c((t,e)=>{let r,n,i,o,a,s,l,u,d,p,f,g,x,y,b=0,S,E,D,$,z,re,ne,ee;const we=new Uint8Array(4);let oe,ge;const Ee=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!t||!t.state||!t.output||!t.input&&t.avail_in!==0)return dn;r=t.state,r.mode===Ti&&(r.mode=$f),a=t.next_out,i=t.output,l=t.avail_out,o=t.next_in,n=t.input,s=t.avail_in,u=r.hold,d=r.bits,p=s,f=l,ee=Mo;e:for(;;)switch(r.mode){case gw:if(r.wrap===0){r.mode=$f;break}for(;d<16;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}if(r.wrap&2&&u===35615){r.check=0,we[0]=u&255,we[1]=u>>>8&255,r.check=br(r.check,we,2,0),u=0,d=0,r.mode=mw;break}if(r.flags=0,r.head&&(r.head.done=!1),!(r.wrap&1)||(((u&255)<<8)+(u>>8))%31){t.msg="incorrect header check",r.mode=er;break}if((u&15)!==pw){t.msg="unknown compression method",r.mode=er;break}if(u>>>=4,d-=4,ne=(u&15)+8,r.wbits===0)r.wbits=ne;else if(ne>r.wbits){t.msg="invalid window size",r.mode=er;break}r.dmax=1<<r.wbits,t.adler=r.check=1,r.mode=u&512?Cw:Ti,u=0,d=0;break;case mw:for(;d<16;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}if(r.flags=u,(r.flags&255)!==pw){t.msg="unknown compression method",r.mode=er;break}if(r.flags&57344){t.msg="unknown header flags set",r.mode=er;break}r.head&&(r.head.text=u>>8&1),r.flags&512&&(we[0]=u&255,we[1]=u>>>8&255,r.check=br(r.check,we,2,0)),u=0,d=0,r.mode=vw;case vw:for(;d<32;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}r.head&&(r.head.time=u),r.flags&512&&(we[0]=u&255,we[1]=u>>>8&255,we[2]=u>>>16&255,we[3]=u>>>24&255,r.check=br(r.check,we,4,0)),u=0,d=0,r.mode=ww;case ww:for(;d<16;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}r.head&&(r.head.xflags=u&255,r.head.os=u>>8),r.flags&512&&(we[0]=u&255,we[1]=u>>>8&255,r.check=br(r.check,we,2,0)),u=0,d=0,r.mode=yw;case yw:if(r.flags&1024){for(;d<16;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}r.length=u,r.head&&(r.head.extra_len=u),r.flags&512&&(we[0]=u&255,we[1]=u>>>8&255,r.check=br(r.check,we,2,0)),u=0,d=0}else r.head&&(r.head.extra=null);r.mode=bw;case bw:if(r.flags&1024&&(g=r.length,g>s&&(g=s),g&&(r.head&&(ne=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(o,o+g),ne)),r.flags&512&&(r.check=br(r.check,n,g,o)),s-=g,o+=g,r.length-=g),r.length))break e;r.length=0,r.mode=xw;case xw:if(r.flags&2048){if(s===0)break e;g=0;do ne=n[o+g++],r.head&&ne&&r.length<65536&&(r.head.name+=String.fromCharCode(ne));while(ne&&g<s);if(r.flags&512&&(r.check=br(r.check,n,g,o)),s-=g,o+=g,ne)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=_w;case _w:if(r.flags&4096){if(s===0)break e;g=0;do ne=n[o+g++],r.head&&ne&&r.length<65536&&(r.head.comment+=String.fromCharCode(ne));while(ne&&g<s);if(r.flags&512&&(r.check=br(r.check,n,g,o)),s-=g,o+=g,ne)break e}else r.head&&(r.head.comment=null);r.mode=Sw;case Sw:if(r.flags&512){for(;d<16;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}if(u!==(r.check&65535)){t.msg="header crc mismatch",r.mode=er;break}u=0,d=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=Ti;break;case Cw:for(;d<32;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}t.adler=r.check=Ow(u),u=0,d=0,r.mode=nu;case nu:if(r.havedict===0)return t.next_out=a,t.avail_out=l,t.next_in=o,t.avail_in=s,r.hold=u,r.bits=d,jC;t.adler=r.check=1,r.mode=Ti;case Ti:if(e===WC||e===ru)break e;case $f:if(r.last){u>>>=d&7,d-=d&7,r.mode=Mf;break}for(;d<3;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}switch(r.last=u&1,u>>>=1,d-=1,u&3){case 0:r.mode=Ew;break;case 1:if(JC(r),r.mode=iu,e===ru){u>>>=2,d-=2;break e}break;case 2:r.mode=Aw;break;case 3:t.msg="invalid block type",r.mode=er}u>>>=2,d-=2;break;case Ew:for(u>>>=d&7,d-=d&7;d<32;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}if((u&65535)!=(u>>>16^65535)){t.msg="invalid stored block lengths",r.mode=er;break}if(r.length=u&65535,u=0,d=0,r.mode=Nf,e===ru)break e;case Nf:r.mode=Rw;case Rw:if(g=r.length,g){if(g>s&&(g=s),g>l&&(g=l),g===0)break e;i.set(n.subarray(o,o+g),a),s-=g,o+=g,l-=g,a+=g,r.length-=g;break}r.mode=Ti;break;case Aw:for(;d<14;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}if(r.nlen=(u&31)+257,u>>>=5,d-=5,r.ndist=(u&31)+1,u>>>=5,d-=5,r.ncode=(u&15)+4,u>>>=4,d-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=er;break}r.have=0,r.mode=Tw;case Tw:for(;r.have<r.ncode;){for(;d<3;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}r.lens[Ee[r.have++]]=u&7,u>>>=3,d-=3}for(;r.have<19;)r.lens[Ee[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,oe={bits:r.lenbits},ee=ac(zC,r.lens,0,19,r.lencode,0,r.work,oe),r.lenbits=oe.bits,ee){t.msg="invalid code lengths set",r.mode=er;break}r.have=0,r.mode=kw;case kw:for(;r.have<r.nlen+r.ndist;){for(;b=r.lencode[u&(1<<r.lenbits)-1],S=b>>>24,E=b>>>16&255,D=b&65535,!(S<=d);){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}if(D<16)u>>>=S,d-=S,r.lens[r.have++]=D;else{if(D===16){for(ge=S+2;d<ge;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}if(u>>>=S,d-=S,r.have===0){t.msg="invalid bit length repeat",r.mode=er;break}ne=r.lens[r.have-1],g=3+(u&3),u>>>=2,d-=2}else if(D===17){for(ge=S+3;d<ge;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}u>>>=S,d-=S,ne=0,g=3+(u&7),u>>>=3,d-=3}else{for(ge=S+7;d<ge;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}u>>>=S,d-=S,ne=0,g=11+(u&127),u>>>=7,d-=7}if(r.have+g>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=er;break}for(;g--;)r.lens[r.have++]=ne}}if(r.mode===er)break;if(r.lens[256]===0){t.msg="invalid code -- missing end-of-block",r.mode=er;break}if(r.lenbits=9,oe={bits:r.lenbits},ee=ac(lw,r.lens,0,r.nlen,r.lencode,0,r.work,oe),r.lenbits=oe.bits,ee){t.msg="invalid literal/lengths set",r.mode=er;break}if(r.distbits=6,r.distcode=r.distdyn,oe={bits:r.distbits},ee=ac(uw,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,oe),r.distbits=oe.bits,ee){t.msg="invalid distances set",r.mode=er;break}if(r.mode=iu,e===ru)break e;case iu:r.mode=ou;case ou:if(s>=6&&l>=258){t.next_out=a,t.avail_out=l,t.next_in=o,t.avail_in=s,r.hold=u,r.bits=d,BC(t,f),a=t.next_out,i=t.output,l=t.avail_out,o=t.next_in,n=t.input,s=t.avail_in,u=r.hold,d=r.bits,r.mode===Ti&&(r.back=-1);break}for(r.back=0;b=r.lencode[u&(1<<r.lenbits)-1],S=b>>>24,E=b>>>16&255,D=b&65535,!(S<=d);){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}if(E&&(E&240)==0){for($=S,z=E,re=D;b=r.lencode[re+((u&(1<<$+z)-1)>>$)],S=b>>>24,E=b>>>16&255,D=b&65535,!($+S<=d);){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}u>>>=$,d-=$,r.back+=$}if(u>>>=S,d-=S,r.back+=S,r.length=D,E===0){r.mode=$w;break}if(E&32){r.back=-1,r.mode=Ti;break}if(E&64){t.msg="invalid literal/length code",r.mode=er;break}r.extra=E&15,r.mode=Iw;case Iw:if(r.extra){for(ge=r.extra;d<ge;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}r.length+=u&(1<<r.extra)-1,u>>>=r.extra,d-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=Dw;case Dw:for(;b=r.distcode[u&(1<<r.distbits)-1],S=b>>>24,E=b>>>16&255,D=b&65535,!(S<=d);){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}if((E&240)==0){for($=S,z=E,re=D;b=r.distcode[re+((u&(1<<$+z)-1)>>$)],S=b>>>24,E=b>>>16&255,D=b&65535,!($+S<=d);){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}u>>>=$,d-=$,r.back+=$}if(u>>>=S,d-=S,r.back+=S,E&64){t.msg="invalid distance code",r.mode=er;break}r.offset=D,r.extra=E&15,r.mode=Pw;case Pw:if(r.extra){for(ge=r.extra;d<ge;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}r.offset+=u&(1<<r.extra)-1,u>>>=r.extra,d-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=er;break}r.mode=Fw;case Fw:if(l===0)break e;if(g=f-l,r.offset>g){if(g=r.offset-g,g>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=er;break}g>r.wnext?(g-=r.wnext,x=r.wsize-g):x=r.wnext-g,g>r.length&&(g=r.length),y=r.window}else y=i,x=a-r.offset,g=r.length;g>l&&(g=l),l-=g,r.length-=g;do i[a++]=y[x++];while(--g);r.length===0&&(r.mode=ou);break;case $w:if(l===0)break e;i[a++]=r.length,l--,r.mode=ou;break;case Mf:if(r.wrap){for(;d<32;){if(s===0)break e;s--,u|=n[o++]<<d,d+=8}if(f-=l,t.total_out+=f,r.total+=f,f&&(t.adler=r.check=r.flags?br(r.check,i,f,a-f):Qs(r.check,i,f,a-f)),f=l,(r.flags?u:Ow(u))!==r.check){t.msg="incorrect data check",r.mode=er;break}u=0,d=0}r.mode=Nw;case Nw:if(r.wrap&&r.flags){for(;d<32;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}if(u!==(r.total&4294967295)){t.msg="incorrect length check",r.mode=er;break}u=0,d=0}r.mode=Mw;case Mw:ee=qC;break e;case er:ee=hw;break e;case Bw:return fw;case GC:default:return dn}return t.next_out=a,t.avail_out=l,t.next_in=o,t.avail_in=s,r.hold=u,r.bits=d,(r.wsize||f!==t.avail_out&&r.mode<er&&(r.mode<Mf||e!==dw))&&qw(t,t.output,t.next_out,f-t.avail_out),p-=t.avail_in,f-=t.avail_out,t.total_in+=p,t.total_out+=f,r.total+=f,r.wrap&&f&&(t.adler=r.check=r.flags?br(r.check,i,f,t.next_out-f):Qs(r.check,i,f,t.next_out-f)),t.data_type=r.bits+(r.last?64:0)+(r.mode===Ti?128:0)+(r.mode===iu||r.mode===Nf?256:0),(p===0&&f===0||e===dw)&&ee===Mo&&(ee=VC),ee},"inflate$2"),t1=c(t=>{if(!t||!t.state)return dn;let e=t.state;return e.window&&(e.window=null),t.state=null,Mo},"inflateEnd"),r1=c((t,e)=>{if(!t||!t.state)return dn;const r=t.state;return(r.wrap&2)==0?dn:(r.head=e,e.done=!1,Mo)},"inflateGetHeader"),n1=c((t,e)=>{const r=e.length;let n,i,o;return!t||!t.state||(n=t.state,n.wrap!==0&&n.mode!==nu)?dn:n.mode===nu&&(i=1,i=Qs(i,e,r,0),i!==n.check)?hw:(o=qw(t,e,r,r),o?(n.mode=Bw,fw):(n.havedict=1,Mo))},"inflateSetDictionary");var i1=Lw,o1=Hw,a1=Uw,s1=YC,c1=zw,l1=e1,u1=t1,d1=r1,h1=n1,f1="pako inflate (from Nodeca project)",ki={inflateReset:i1,inflateReset2:o1,inflateResetKeep:a1,inflateInit:s1,inflateInit2:c1,inflate:l1,inflateEnd:u1,inflateGetHeader:d1,inflateSetDictionary:h1,inflateInfo:f1};function p1(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}c(p1,"GZheader");var g1=p1;const jw=Object.prototype.toString,{Z_NO_FLUSH:m1,Z_FINISH:v1,Z_OK:sc,Z_STREAM_END:Uf,Z_NEED_DICT:Lf,Z_STREAM_ERROR:w1,Z_DATA_ERROR:Vw,Z_MEM_ERROR:y1}=Do;function cc(t){this.options=Jl.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)==0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new nw,this.strm.avail_out=0;let r=ki.inflateInit2(this.strm,e.windowBits);if(r!==sc)throw new Error(Io[r]);if(this.header=new g1,ki.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=ic.string2buf(e.dictionary):jw.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=ki.inflateSetDictionary(this.strm,e.dictionary),r!==sc)))throw new Error(Io[r])}c(cc,"Inflate$1"),cc.prototype.push=function(t,e){const r=this.strm,n=this.options.chunkSize,i=this.options.dictionary;let o,a,s;if(this.ended)return!1;for(e===~~e?a=e:a=e===!0?v1:m1,jw.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),o=ki.inflate(r,a),o===Lf&&i&&(o=ki.inflateSetDictionary(r,i),o===sc?o=ki.inflate(r,a):o===Vw&&(o=Lf));r.avail_in>0&&o===Uf&&r.state.wrap>0&&t[r.next_in]!==0;)ki.inflateReset(r),o=ki.inflate(r,a);switch(o){case w1:case Vw:case Lf:case y1:return this.onEnd(o),this.ended=!0,!1}if(s=r.avail_out,r.next_out&&(r.avail_out===0||o===Uf))if(this.options.to==="string"){let l=ic.utf8border(r.output,r.next_out),u=r.next_out-l,d=ic.buf2string(r.output,l);r.next_out=u,r.avail_out=n-u,u&&r.output.set(r.output.subarray(l,l+u),0),this.onData(d)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(o===sc&&s===0)){if(o===Uf)return o=ki.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(r.avail_in===0)break}}return!0},cc.prototype.onData=function(t){this.chunks.push(t)},cc.prototype.onEnd=function(t){t===sc&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Jl.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function Hf(t,e){const r=new cc(e);if(r.push(t),r.err)throw r.msg||Io[r.err];return r.result}c(Hf,"inflate$1");function b1(t,e){return e=e||{},e.raw=!0,Hf(t,e)}c(b1,"inflateRaw$1");var x1=cc,_1=Hf,S1=b1,C1=Hf,E1=Do,R1={Inflate:x1,inflate:_1,inflateRaw:S1,ungzip:C1,constants:E1};const{Deflate:A1,deflate:T1,deflateRaw:k1,gzip:I1}=NC,{Inflate:D1,inflate:P1,inflateRaw:F1,ungzip:$1}=R1;var N1=A1,M1=T1,B1=k1,O1=I1,U1=D1,L1=P1,H1=F1,Gw=$1,z1=Do,bR={Deflate:N1,deflate:M1,deflateRaw:B1,gzip:O1,Inflate:U1,inflate:L1,inflateRaw:H1,ungzip:Gw,constants:z1};const Bo=(0,A.loadMessageBundle)(),au=new TextDecoder,su=new TextEncoder;class Kw{constructor(e,r=0){this.retainFor=r;try{this.weakRef=new WeakRef(e)}catch{}this.retain(e)}retain(e){this.retainTimeout&&clearTimeout(this.retainTimeout),this.strongRef=e,this.retainTimeout=setTimeout(()=>{this.strongRef=void 0,this.retainTimeout=void 0},this.retainFor)}deref(){var e,r;const n=(r=this.strongRef)!=null?r:(e=this.weakRef)==null?void 0:e.deref();return n&&this.retain(n),n}}c(Kw,"TimedRetainingRef");class Zw{constructor(e,r){this.root=e,this.providerService=r,this._onDidChangeIndexingEnablement=new h.EventEmitter,this._onDidDownloadTar=new h.EventEmitter,this.ongoingRequests=new Map,this.indexingDisabled=!1,this.usageFile=h.Uri.joinPath(this.root,"usageHistory.json"),this.indexingAllowanceFile=h.Uri.joinPath(this.root,"indexAllowances.json"),this._disposable=h.Disposable.from(...this.registerCommands()),this.updateContext()}get onDidChangeIndexingEnablement(){return this._onDidChangeIndexingEnablement.event}get onDidDownloadTar(){return this._onDidDownloadTar.event}async updateContext(){await bi(jn.HasSearchIndexes,(await this.listTars()).length>0);const e=this.providerService.repositories.map(i=>i.name),r=await this.getIndexingEnabledRepos(),n=r.has("*")||e.every(i=>r.has(i));await bi(jn.EnabledSomeSearchIndexes,r.size>0),await bi(jn.EnabledAllSearchIndexes,n)}dispose(){this._disposable.dispose()}registerCommands(){return[h.commands.registerCommand("remoteHub.configureIndexingAllowedRepos",async()=>{await this.configureIndexingAllowedRepos()}),h.commands.registerCommand("remoteHub.disableIndexingForSession",()=>(this.temporarilyDisableIndexing(),{triggerSearch:!0})),h.commands.registerCommand("remoteHub.enableIndexing",async()=>{const e={title:Bo("search download prompt enable","Enable")},r={title:Bo("search download prompt enable always","Always Enable")},n={title:Bo("search download prompt configure","Configure")},i={title:Bo("search download prompt cancel","Cancel"),isCloseAffordance:!0},o=await h.window.showInformationMessage(Bo("search download prompt",`Indexing creates a copy of this repository in your browser's storage in order to provide enhanced text searches.

Without indexing, searches will use GitHub's text search, which is imprecise.

Do you want to enable creating local indexes for this repository on this browser? You should only enable indexing on machines you trust.`),{modal:!0,useCustom:!0},e,r,n,i);if(o===n&&await h.commands.executeCommand("workbench.action.openSettings","remoteHub.search.download"),o===e)return await this.markIndexingEnabledForRepos(...this.providerService.repositories.map(a=>a.name)),{triggerSearch:!0};if(o===r)return await this.markIndexingEnabledForRepos("*"),{triggerSearch:!0}}),h.commands.registerCommand("remoteHub.deleteLocalRepositoryData",async()=>{const e=c(i=>{const o=[{power:9,name:"GB"},{power:6,name:"MB"},{power:3,name:"kB"},{power:0,name:"B"}];for(const a of o)if(i>10**a.power)return`${Math.round(i/10**a.power)} ${a.name}`;return"Unknown size"},"humanReadableSize"),r=await this.listTars();if(r.length===0){await h.window.showInformationMessage("No Search Indexes Found");return}const n=h.window.createQuickPick();n.canSelectMany=!0,n.items=r.map(({name:i,size:o,path:a})=>({label:i,path:a,description:o?e(o):void 0})),n.show(),n.onDidAccept(async()=>{n.hide();for(const{label:i,path:o}of n.selectedItems){const a=h.workspace.fs.delete(o),s=h.window.setStatusBarMessage(`$(loading) Deleting ${i}`,a);await a,s.dispose()}this.updateContext()}),n.onDidHide(()=>n.dispose())}),h.commands.registerCommand("remoteHub.deleteAllLocalRepositoryData",()=>h.window.withProgress({location:h.ProgressLocation.Notification,title:"Deleting Search Indexes..."},async()=>{this.lastReadKey=void 0,this.lastReadValue=void 0,await Promise.all([h.workspace.fs.delete(this.root,{recursive:!0})]),this.updateContext()}))]}getTarFromMemory(e){var r;if(e===this.lastReadKey){const n=(r=this.lastReadValue)==null?void 0:r.deref();if(n)return n;C.log("Weakref deallocated.")}}async getTarFromDisk(e){try{const r=await h.workspace.fs.readFile(e);return!r||!r.length?void 0:r}catch(r){if(!(r instanceof h.FileSystemError)||r.code!==h.FileSystemError.FileNotFound.name)throw r;return}}async getTarFromNetwork(e){try{if(!await this.isIndexingEnabledForRepo(e))throw Error("Unable to search without indexing allowed");const r=await this.providerService.getTarGz(e);if(r===void 0)throw Error("Unable to retrieve search index from provider");return r}finally{this.updateContext()}}async getTar(e,r){r===void 0&&({HEAD:{sha:r}}=await this.providerService.getMetadata(e)),e=this.providerService.getCanonicalUri(e);const n=this.getTarStorageUri(e,r),i=n.toString();try{let o=this.ongoingRequests.get(i);return o===void 0&&(o=this.getTarCore(e,r,n),this.ongoingRequests.set(i,o)),await o}finally{this.ongoingRequests.delete(i)}}async getCachedTar(e,r){return e=this.providerService.getCanonicalUri(e),this.getTarCore(e,r,this.getTarStorageUri(e,r),{skipDownload:!0})}async getTarCore(e,r,n,i){var o;const a=`${le(e,{excludeScheme:!0})}/${r}`,s=new Be(`TarPit.getTar(${a})`),l=n.toString(),u=Date.now();let d,p;try{if(s.logStep("Getting .tar from memory",{suffix:" \u2022 Getting .tar from memory..."}),p=this.getTarFromMemory(l),p)return d=" \u2022 Got .tar from memory",p;s.logStep("Getting .tar from disk",{message:": Not found \u2022",suffix:" \u2022 Getting .tar from disk..."});let f=!1,g=await this.getTarFromDisk(n);if(g==null?void 0:g.length)d=" \u2022 Got .tar from disk";else{if(i==null?void 0:i.skipDownload){d=" \u2022 Skipped download";return}s.logStep("Getting .tar from network",{message:": Not found \u2022",suffix:" \u2022 Getting .tar from network..."}),g=await this.getTarFromNetwork(e),f=!0,d=" \u2022 Got .tar from network",h.workspace.fs.writeFile(n,g).then(()=>C.debug(`Sucessfully wrote tarball to disk in ${Date.now()-u}ms`),b=>C.error(b,`Error writing tarball to disk in ${Date.now()-u}ms`))}if(!(g==null?void 0:g.length))throw new Error("Internal Error: Invalid search index. Try deleting repository data and running search again: `GitHub Repositories: Delete Local Repository Data...`");s.logStep("Unzipping .tar",{suffix:" \u2022 Unzipping .tar..."});const x=Gw(g);s.logStep("Parsing .tar",{suffix:" \u2022 Parsing .tar..."}),p=(0,K_.t9)(x),s.logStep("Fixing up .tar entries",{suffix:" \u2022 Fixing up .tar entries..."});const y=[];for(const b of p.entries)((o=b.header.typeFlag)==null?void 0:o.name)==="Normal"&&(b.header.fullFileName=b.header.fullFileName.replace(/^[^/]+\/?/,""),y.push(b));return p.entries=y,this.lastReadValue=new Kw(p,Date.now()-u),this.lastReadKey=l,f&&setTimeout(()=>this._onDidDownloadTar.fire({rootUri:e,sha:r}),0),p}catch(f){throw d=` \u2022 Failed; ${String(f)}`,f}finally{p&&(this.markCacheEntryUsed(`${a}`).catch(f=>C.log(`Error marking entry used: ${f}`)),this.cleanUpCache().catch(f=>C.log(`Error cleaning cache: ${f}`))),s.stop(d?{suffix:d}:void 0)}}getTarStorageUri(e,r){return h.Uri.joinPath(this.root,"tars",le(e,{excludeScheme:!0}),r)}async readDir(e){try{return(await h.workspace.fs.readDirectory(e)).map(r=>h.Uri.joinPath(e,r[0]))}catch{return[]}}temporarilyDisableIndexing(){this.indexingDisabled=!0}async isIndexingEnabledForRepo(e){if(this.indexingDisabled)return!1;const r=await this.getIndexingEnabledRepos();if(r.has("*"))return!0;const{name:n}=this.providerService.getVirtualUriMetadata(e);return n?r.has(n):!1}async configureIndexingAllowedRepos(){const e=[...(await this.getIndexingEnabledRepos()).values()],r=await h.window.showQuickPick(e.map(n=>({picked:!0,description:n==="*"?Bo("all","All Repositories"):"",label:n})),{canPickMany:!0,title:Bo("select repos where indexing is allowed","Select repositories that should be indexed")});r&&await this.resetIndexingAllowedRepos(r.map(n=>n.label))}async getIndexingEnabledRepos(){let e;try{e=JSON.parse(au.decode(await h.workspace.fs.readFile(this.indexingAllowanceFile)))}catch(r){r instanceof h.FileSystemError&&r.code!==h.FileSystemError.FileNotFound().code&&C.error(r,"Error reading index allowance data."),e=[]}return new Set(e)}async listTars(){const e=await this.readDir(h.Uri.joinPath(this.root,"tars")).catch(()=>[]),r=(await Promise.all(e.map(o=>this.readDir(o)))).flat(),n=(await Promise.all(r.map(o=>this.readDir(o)))).flat(),i=(await Promise.all(n.map(o=>this.readDir(o)))).flat();return Promise.all(i.map(async o=>({name:o.path.replace(/^.*\/tars\//,""),path:o,size:(await h.workspace.fs.stat(o)).size})))}async resetIndexingAllowedRepos(e){await h.workspace.fs.writeFile(this.indexingAllowanceFile,su.encode(JSON.stringify(e))),await this.updateContext(),setTimeout(()=>this._onDidChangeIndexingEnablement.fire(),0)}async markIndexingEnabledForRepos(...e){let r;try{r=JSON.parse(au.decode(await h.workspace.fs.readFile(this.indexingAllowanceFile)))}catch(n){n instanceof h.FileSystemError&&n.code!==h.FileSystemError.FileNotFound().code&&C.error(n,"Error reading index allowance data."),r=[]}for(const n of e)r.includes(n)||r.push(n);this.indexingDisabled=!1,await h.workspace.fs.writeFile(this.indexingAllowanceFile,su.encode(JSON.stringify(r))),await this.updateContext(),setTimeout(()=>this._onDidChangeIndexingEnablement.fire(),0)}async markCacheEntryUsed(e){let r;try{r=JSON.parse(au.decode(await h.workspace.fs.readFile(this.usageFile)))}catch(n){n instanceof h.FileSystemError&&n.code!==h.FileSystemError.FileNotFound().code&&C.error(n,"Error reading usage data."),r={}}r[e]=Number(Date.now()),await h.workspace.fs.writeFile(this.usageFile,su.encode(JSON.stringify(r)))}async cleanUpCache(){var e,r;C.log("Cleaning up search cache...");const n=await this.listTars();let i;try{i=JSON.parse(au.decode(await h.workspace.fs.readFile(this.usageFile)))}catch(p){p instanceof h.FileSystemError&&p.code!==h.FileSystemError.FileNotFound().code&&C.error(p,"Error reading usage data. All existing indexes will be discarded."),i={}}const o=[];n.forEach(p=>{var f;const g=/^([^/]*\/[^/]*)\//.exec(p.name);if(!g)throw Error("Unexpected repo entry");const x=g[1],y=(f=i[p.name])!=null?f:0;o.push({...p,lastUsed:y,repo:x})}),o.sort((p,f)=>f.lastUsed-p.lastUsed);let a=0;const s=[],l=new Map,u=((e=P.get("search.download.sizeLimit"))!=null?e:100)*1024*1024,d=(r=P.get("search.download.repoLimit"))!=null?r:4;o.forEach(p=>{var f,g;(p.lastUsed===0||a>u||((f=l.get(p.repo))!=null?f:0)>d)&&s.push(p),a+=p.size,l.set(p.repo,((g=l.get(p.repo))!=null?g:0)+1)}),await Promise.all(s.map(async p=>{try{await h.workspace.fs.delete(p.path,{recursive:!0}),delete i[p.name],C.log(`Deleted cache entry for ${p.name}`)}catch(f){C.log(`Deleting cache entry for ${p.name} failed; ${String(f)}`)}})),await h.workspace.fs.writeFile(this.usageFile,su.encode(JSON.stringify(i))),await this.updateContext()}}c(Zw,"TarPit");const W1=(0,A.loadMessageBundle)();async function q1(t,e,r,n,i,o,a){return zf("provideTextSearchResults",async()=>{const s=j_(n.pattern,Boolean(n.isRegExp),{matchCase:n.isCaseSensitive,wholeWord:n.isWordMatch,multiline:n.isMultiline,global:!0});let l;try{l=await zf("fetch tarball",()=>r.getTar(i.folder))}catch(b){return{limitHit:!1,message:{type:h.TextSearchCompleteMessageType.Warning,trusted:!0,text:W1("indexNotAvailable","Search index not available. [Retry with indexing disabled]({0}).","command:remoteHub.disableIndexingForSession")}}}if(a.isCancellationRequested)return{limitHit:!1};const{maxResults:u,maxFileSize:d,includes:p,excludes:f}=i,g=await j1(i.folder,t,l,e);if(a.isCancellationRequested)return{limitHit:!0};let x=u;const y=V_(g,p,f,d);return zf("searchFiles",async()=>{var b,S;let E=0;for(const D of g){if(!y.has(D.path))continue;const $=G_(D.contents,D.path,s,{beforeContext:(b=i.beforeContext)!=null?b:0,afterContext:(S=i.afterContext)!=null?S:0,previewOptions:i.previewOptions,remainingResultQuota:x});for(const z of $)o.report({...z,uri:h.Uri.joinPath(i.folder,z.uri.path)});if(x!==void 0&&(x-=$.length,x<=0))return{limitHit:!0};if(E++,E%1e4==0&&(await new Promise(z=>setTimeout(z,0)),a.isCancellationRequested))return{limitHit:!1}}return{limitHit:!1}})})}c(q1,"provideTextSearchResults");async function j1(t,e,r,n){const i=r.entries,o=e.getVirtualRootUri(t),a=await n.getChanges(o,{predicate:p=>p.fileType===h.FileType.File});if(a.length===0)return i.map(p=>({contents:p.dataAsBytes,path:p.header.fullFileName,size:p.dataAsBytes.byteLength}));const s=await Promise.all(w(a,p=>{if(p.type===ut.Created)return n.getContent(p.uri).then(f=>({path:e.getRelativeFilePath(o,p.uri),size:f.length,contents:f}))})),l=await Promise.all(w(a,p=>{if(p.type===ut.Changed)return n.getContent(p.uri).then(f=>({path:e.getRelativeFilePath(o,p.uri),size:f.length,contents:f}))})),u=new Set(ft(se(l,p=>p.path),w(a,p=>{if(p.type===ut.Deleted)return e.getRelativeFilePath(o,p.uri)})));return[...w(i,p=>{if(!u.has(p.header.fullFileName))return{contents:p.dataAsBytes,path:p.header.fullFileName,size:p.dataAsBytes.byteLength}}),...s,...l]}c(j1,"listAllFiles");function xR(t,e){const r=Date.now(),n=e();return Logger.log(`${t} time: ${Date.now()-r}`),n}c(xR,"timeSync");async function zf(t,e){const r=Date.now(),n=await e();return C.log(`${t} time: ${Date.now()-r}`),n}c(zf,"time");var V1=Object.defineProperty,G1=Object.getOwnPropertyDescriptor,Wf=c((t,e,r,n)=>{for(var i=n>1?void 0:n?G1(e,r):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&V1(e,r,i),i},"github_fs_decorateClass");const qf=(0,A.loadMessageBundle)(),K1=h.FileSystemError.FileNotFound().code,Z1=/(\/|\\)/g,Xw=".vscode/.github-pull-request.rec";class lc{constructor(e,r,n,i){this.providerService=e,this.github=r,this.changeStore=n,this.tarPit=i,this._onDidChangeFile=new h.EventEmitter,this.fileSearchCache=new Map,this.pendingUriRequests=new Map,this.pendingUriRequestsEventDelay=10,this.implicitlyWatchedUris=new Map,this.watchedUris=new Map,this.disposable=h.Disposable.from(h.workspace.registerFileSystemProvider(this.scheme,this,{isCaseSensitive:!0,isReadonly:!0}),h.workspace.registerFileSearchProvider(this.scheme,this),h.workspace.registerTextSearchProvider(this.scheme,this),e.onDidChangeRepository(o=>{o.reason==="HEAD"&&this.onRefreshOrRepositoryChanged([o.repository.uri])}),e.onDidRefresh(o=>this.onRefreshOrRepositoryChanged(o)))}get onDidChangeFile(){return this._onDidChangeFile.event}get scheme(){return this.github.scheme}dispose(){var e;(e=this.disposable)==null||e.dispose()}onRefreshOrRepositoryChanged(e){if(e=e.filter(r=>Dt.getProviderId(r)===this.scheme).map(r=>this.providerService.getProviderUri(r)),e.length!==0){C.log(`GitHubFS.onRefreshOrRepositoryChanged(${e.map(r=>r.toString()).join(", ")})`),this.fileSearchCache.clear();for(const[r,n]of[...this.pendingUriRequests])e.some(i=>_e(n.uri,i))&&(this.pendingUriRequests.delete(r),n.outdated=!0);this.updateOpenOrWatchedUris(e)}}updateOpenOrWatchedUris(e){const r=this.providerService.getOpenUris(this.scheme,e);for(const[i,o]of[...this.watchedUris,...this.implicitlyWatchedUris])e.some(a=>_e(o,a))&&(this.implicitlyWatchedUris.delete(i),r.set(i,o));C.debug(`GitHubFS.updateOpenOrWatchedUris(${e.map(i=>i.toString()).join(", ")}): uris=${r.size}`);for(const i of e)r.set(H(i),i);const n=[...r.values()].map(i=>({type:h.FileChangeType.Changed,uri:i}));setTimeout(()=>{C.debug(`GitHubFS.updateOpenOrWatchedUris: Firing events=${n.map(i=>i.uri.toString()).join(", ")}`),this._onDidChangeFile.fire(n)},0)}watch(e,r){const n=H(e);return this.watchedUris.set(n,e),{dispose:()=>{this.watchedUris.delete(n)}}}async stat(e){var r,n;const i=H(e);this.implicitlyWatchedUris.set(i,e);const o=this.providerService.getRelativeFilePath(e),a={uri:e,outdated:!1};try{this.pendingUriRequests.set(`stat:${i}`,a);const s=await this.github.getFileTree(e),l=await s.get(o);if(l==null?void 0:l.stat)return l==null?void 0:l.stat;if(this.implicitlyWatchedUris.delete(i),e.query==="~")return{type:h.FileType.File,size:0,ctime:0,mtime:(r=s.timestamp)!=null?r:Date.now(),permissions:h.FilePermission.Readonly};if(o===Xw){const{ref:u}=this.providerService.getVirtualUriMetadata(e);if((u==null?void 0:u.type)===ke.PullRequest)return{type:h.FileType.File,size:0,ctime:0,mtime:(n=s.timestamp)!=null?n:Date.now(),permissions:h.FilePermission.Readonly}}throw h.FileSystemError.FileNotFound(e)}finally{this.pendingUriRequests.delete(`stat:${i}`),(a==null?void 0:a.outdated)&&setTimeout(()=>{C.log(`GitHubFS.stat(${e.toString()}): Repository changed; firing change event...`),this._onDidChangeFile.fire([{type:h.FileChangeType.Changed,uri:e}])},this.pendingUriRequestsEventDelay)}}async readDirectory(e,r){this.implicitlyWatchedUris.set(H(e),e);const n=await this.github.getFileTree(e),i=this.providerService.getRelativeFilePath(e),o=(await n.getChildren(i,r)).map(([a,{stat:{type:s}}])=>[a,s]);return i===""&&Be.stop("Time to root directory"),o}createDirectory(e){throw h.FileSystemError.NoPermissions()}async readFile(e){const r=H(e);this.implicitlyWatchedUris.set(r,e);const n={uri:e,outdated:!1};try{return this.pendingUriRequests.set(r,n),await this.github.getFileContent(e)}catch(i){if(this.implicitlyWatchedUris.delete(r),i instanceof h.FileSystemError&&i.code===K1){if(e.query==="~")return new Uint8Array(0);if(this.providerService.getRelativeFilePath(e)===Xw){const{ref:a}=this.providerService.getVirtualUriMetadata(e);if((a==null?void 0:a.type)===ke.PullRequest)return new Uint8Array(0)}}throw i}finally{this.pendingUriRequests.delete(r),(n==null?void 0:n.outdated)&&setTimeout(()=>{C.log(`GitHubFS.readFile(${e.toString()}): Repository changed; firing change event...`),this._onDidChangeFile.fire([{type:h.FileChangeType.Changed,uri:e}])},this.pendingUriRequestsEventDelay)}}writeFile(e,r,n){throw h.FileSystemError.NoPermissions()}delete(e,r){throw h.FileSystemError.NoPermissions()}rename(e,r,n){throw h.FileSystemError.NoPermissions()}copy(e,r,n){throw h.FileSystemError.NoPermissions()}async provideFileSearchResults(e,{folder:r,maxResults:n,includes:i,excludes:o},a){const s=`${H(r)}|${JSON.stringify({includes:i,excludes:o})}`;let l=this.fileSearchCache.get(s);if(l===void 0){const d=this.providerService.getRelativeFilePath(r);let p;await this.github.hasFileTree(r)&&(p=await this.github.getFileTree(r));let f;if(p===void 0||p.loading||!p.hasEntireTree?f=await this.github.getFileList(r,d):f=(await p.getChildren(d,{filter:h.FileType.File,recursive:!0})).map(([g])=>g),f.length===0||a.isCancellationRequested)return[];((i==null?void 0:i.length)||(o==null?void 0:o.length))&&(f=[...Gh(f,i,o)]),l=f.map(g=>_a.prepareSlow(g)),this.fileSearchCache.set(s,l)}let u;return e.pattern===""?u=l.map(d=>h.Uri.joinPath(r,d.target)):(u=_a.go(e.pattern.replace(Z1,"/"),l,{allowTypo:!0,limit:n}).map(d=>h.Uri.joinPath(r,d.target)),_a.cleanup()),n!==void 0&&n!==0&&n<u.length&&(u=u.slice(0,n)),u}async provideTextSearchResults(e,r,n,i){const o=[];if(await this.tarPit.isIndexingEnabledForRepo(r.folder))try{return q1(this.providerService,this.changeStore,this.tarPit,e,r,n,i)}catch{o.push({text:qf("index error","Error searching index, falling back to GitHub search. Try [deleting this repo's data]({0}) or [deleting all local data]({1}) to rebuild the index.","command:remoteHub.deleteLocalRepositoryData","command:remoteHub.deleteAllLocalRepositoryData"),type:h.TextSearchCompleteMessageType.Warning})}e.isCaseSensitive||e.isRegExp||e.isWordMatch?o.push({text:qf("flags not supported","Search flags are not supported by GitHub search. [Enable indexing]({0}) for full search features and exact text searches.","command:remoteHub.enableIndexing"),type:h.TextSearchCompleteMessageType.Warning,trusted:!0}):o.push({text:qf("enable index","Currently using GitHub text search. [Enable indexing]({0}) for exact text searches.","command:remoteHub.enableIndexing"),type:h.TextSearchCompleteMessageType.Information,trusted:!0});const a=await this.github.searchCodeQuery(e.pattern,r.folder,{maxResults:r.maxResults,context:{before:r.beforeContext,after:r.afterContext}});if(a.warnings&&a.warnings.forEach(l=>{o.push({text:l,trusted:!0,type:h.TextSearchCompleteMessageType.Warning})}),a===void 0)return{limitHit:!0,message:o};let s;for(const l of a.matches)s=h.Uri.joinPath(r.folder,l.path),n.report({uri:s,ranges:l.ranges,preview:{text:l.preview,matches:l.matches}});return{limitHit:!1,message:o}}}c(lc,"GitHubFS"),Wf([dt()],lc.prototype,"stat",1),Wf([dt()],lc.prototype,"readDirectory",1),Wf([dt()],lc.prototype,"readFile",1);var X1=__webpack_require__(6470),uc=__webpack_require__(4155);function cu(){return typeof navigator=="object"&&"userAgent"in navigator?navigator.userAgent:typeof uc=="object"&&"version"in uc?`Node.js/${uc.version.substr(1)} (${uc.platform}; ${uc.arch})`:"<environment undetectable>"}c(cu,"getUserAgent");var Q1=__webpack_require__(5186);/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */function Qw(t){return Object.prototype.toString.call(t)==="[object Object]"}c(Qw,"isObject");function Yw(t){var e,r;return Qw(t)===!1?!1:(e=t.constructor,e===void 0?!0:(r=e.prototype,!(Qw(r)===!1||r.hasOwnProperty("isPrototypeOf")===!1)))}c(Yw,"isPlainObject");function Y1(t){return t?Object.keys(t).reduce((e,r)=>(e[r.toLowerCase()]=t[r],e),{}):{}}c(Y1,"lowercaseKeys");function Jw(t,e){const r=Object.assign({},t);return Object.keys(e).forEach(n=>{Yw(e[n])?n in t?r[n]=Jw(t[n],e[n]):Object.assign(r,{[n]:e[n]}):Object.assign(r,{[n]:e[n]})}),r}c(Jw,"mergeDeep");function ey(t){for(const e in t)t[e]===void 0&&delete t[e];return t}c(ey,"removeUndefinedProperties");function jf(t,e,r){if(typeof e=="string"){let[i,o]=e.split(" ");r=Object.assign(o?{method:i,url:o}:{url:i},r)}else r=Object.assign({},e);r.headers=Y1(r.headers),ey(r),ey(r.headers);const n=Jw(t||{},r);return t&&t.mediaType.previews.length&&(n.mediaType.previews=t.mediaType.previews.filter(i=>!n.mediaType.previews.includes(i)).concat(n.mediaType.previews)),n.mediaType.previews=n.mediaType.previews.map(i=>i.replace(/-preview/,"")),n}c(jf,"dist_web_merge");function J1(t,e){const r=/\?/.test(t)?"&":"?",n=Object.keys(e);return n.length===0?t:t+r+n.map(i=>i==="q"?"q="+e.q.split("+").map(encodeURIComponent).join("+"):`${i}=${encodeURIComponent(e[i])}`).join("&")}c(J1,"addQueryParameters");const eE=/\{[^}]+\}/g;function tE(t){return t.replace(/^\W+|\W+$/g,"").split(/,/)}c(tE,"removeNonChars");function rE(t){const e=t.match(eE);return e?e.map(tE).reduce((r,n)=>r.concat(n),[]):[]}c(rE,"extractUrlVariableNames");function ty(t,e){return Object.keys(t).filter(r=>!e.includes(r)).reduce((r,n)=>(r[n]=t[n],r),{})}c(ty,"omit");function ry(t){return t.split(/(%[0-9A-Fa-f]{2})/g).map(function(e){return/%[0-9A-Fa-f]/.test(e)||(e=encodeURI(e).replace(/%5B/g,"[").replace(/%5D/g,"]")),e}).join("")}c(ry,"encodeReserved");function $a(t){return encodeURIComponent(t).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}c($a,"encodeUnreserved");function dc(t,e,r){return e=t==="+"||t==="#"?ry(e):$a(e),r?$a(r)+"="+e:e}c(dc,"encodeValue");function Na(t){return t!=null}c(Na,"isDefined");function Vf(t){return t===";"||t==="&"||t==="?"}c(Vf,"isKeyOperator");function nE(t,e,r,n){var i=t[r],o=[];if(Na(i)&&i!=="")if(typeof i=="string"||typeof i=="number"||typeof i=="boolean")i=i.toString(),n&&n!=="*"&&(i=i.substring(0,parseInt(n,10))),o.push(dc(e,i,Vf(e)?r:""));else if(n==="*")Array.isArray(i)?i.filter(Na).forEach(function(a){o.push(dc(e,a,Vf(e)?r:""))}):Object.keys(i).forEach(function(a){Na(i[a])&&o.push(dc(e,i[a],a))});else{const a=[];Array.isArray(i)?i.filter(Na).forEach(function(s){a.push(dc(e,s))}):Object.keys(i).forEach(function(s){Na(i[s])&&(a.push($a(s)),a.push(dc(e,i[s].toString())))}),Vf(e)?o.push($a(r)+"="+a.join(",")):a.length!==0&&o.push(a.join(","))}else e===";"?Na(i)&&o.push($a(r)):i===""&&(e==="&"||e==="?")?o.push($a(r)+"="):i===""&&o.push("");return o}c(nE,"getValues");function iE(t){return{expand:oE.bind(null,t)}}c(iE,"parseUrl");function oE(t,e){var r=["+","#",".","/",";","?","&"];return t.replace(/\{([^\{\}]+)\}|([^\{\}]+)/g,function(n,i,o){if(i){let s="";const l=[];if(r.indexOf(i.charAt(0))!==-1&&(s=i.charAt(0),i=i.substr(1)),i.split(/,/g).forEach(function(u){var d=/([^:\*]*)(?::(\d+)|(\*))?/.exec(u);l.push(nE(e,s,d[1],d[2]||d[3]))}),s&&s!=="+"){var a=",";return s==="?"?a="&":s!=="#"&&(a=s),(l.length!==0?s:"")+l.join(a)}else return l.join(",")}else return ry(o)})}c(oE,"expand");function ny(t){let e=t.method.toUpperCase(),r=(t.url||"/").replace(/:([a-z]\w+)/g,"{$1}"),n=Object.assign({},t.headers),i,o=ty(t,["method","baseUrl","url","headers","request","mediaType"]);const a=rE(r);r=iE(r).expand(o),/^http/.test(r)||(r=t.baseUrl+r);const s=Object.keys(t).filter(d=>a.includes(d)).concat("baseUrl"),l=ty(o,s);if(!/application\/octet-stream/i.test(n.accept)&&(t.mediaType.format&&(n.accept=n.accept.split(/,/).map(d=>d.replace(/application\/vnd(\.\w+)(\.v3)?(\.\w+)?(\+json)?$/,`application/vnd$1$2.${t.mediaType.format}`)).join(",")),t.mediaType.previews.length)){const d=n.accept.match(/[\w-]+(?=-preview)/g)||[];n.accept=d.concat(t.mediaType.previews).map(p=>{const f=t.mediaType.format?`.${t.mediaType.format}`:"+json";return`application/vnd.github.${p}-preview${f}`}).join(",")}return["GET","HEAD"].includes(e)?r=J1(r,l):"data"in l?i=l.data:Object.keys(l).length?i=l:n["content-length"]=0,!n["content-type"]&&typeof i!="undefined"&&(n["content-type"]="application/json; charset=utf-8"),["PATCH","PUT"].includes(e)&&typeof i=="undefined"&&(i=""),Object.assign({method:e,url:r,headers:n},typeof i!="undefined"?{body:i}:null,t.request?{request:t.request}:null)}c(ny,"parse");function aE(t,e,r){return ny(jf(t,e,r))}c(aE,"endpointWithDefaults");function iy(t,e){const r=jf(t,e),n=aE.bind(null,r);return Object.assign(n,{DEFAULTS:r,defaults:iy.bind(null,r),merge:jf.bind(null,r),parse:ny})}c(iy,"withDefaults");const sE=`octokit-endpoint.js/6.0.12 ${cu()}`,cE=iy(null,{method:"GET",baseUrl:"https://api.github.com",headers:{accept:"application/vnd.github.v3+json","user-agent":sE},mediaType:{format:"",previews:[]}});var lE=__webpack_require__(3672),uE=__webpack_require__.n(lE);class Gf extends Error{constructor(e){super(e);Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="Deprecation"}}c(Gf,"Deprecation");var dE=__webpack_require__(447),oy=__webpack_require__.n(dE);const hE=oy()(t=>console.warn(t)),fE=oy()(t=>console.warn(t));class ii extends Error{constructor(e,r,n){super(e);Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="HttpError",this.status=r;let i;"headers"in n&&typeof n.headers!="undefined"&&(i=n.headers),"response"in n&&(this.response=n.response,i=n.response.headers);const o=Object.assign({},n.request);n.request.headers.authorization&&(o.headers=Object.assign({},n.request.headers,{authorization:n.request.headers.authorization.replace(/ .*$/," [REDACTED]")})),o.url=o.url.replace(/\bclient_secret=\w+/g,"client_secret=[REDACTED]").replace(/\baccess_token=\w+/g,"access_token=[REDACTED]"),this.request=o,Object.defineProperty(this,"code",{get(){return hE(new Gf("[@octokit/request-error] `error.code` is deprecated, use `error.status`.")),r}}),Object.defineProperty(this,"headers",{get(){return fE(new Gf("[@octokit/request-error] `error.headers` is deprecated, use `error.response.headers`.")),i||{}}})}}c(ii,"RequestError");const pE="5.6.1";function gE(t){return t.arrayBuffer()}c(gE,"getBufferResponse");function ay(t){const e=t.request&&t.request.log?t.request.log:console;(Yw(t.body)||Array.isArray(t.body))&&(t.body=JSON.stringify(t.body));let r={},n,i;return(t.request&&t.request.fetch||uE())(t.url,Object.assign({method:t.method,body:t.body,headers:t.headers,redirect:t.redirect},t.request)).then(async a=>{i=a.url,n=a.status;for(const s of a.headers)r[s[0]]=s[1];if("deprecation"in r){const s=r.link&&r.link.match(/<([^>]+)>; rel="deprecation"/),l=s&&s.pop();e.warn(`[@octokit/request] "${t.method} ${t.url}" is deprecated. It is scheduled to be removed on ${r.sunset}${l?`. See ${l}`:""}`)}if(!(n===204||n===205)){if(t.method==="HEAD"){if(n<400)return;throw new ii(a.statusText,n,{response:{url:i,status:n,headers:r,data:void 0},request:t})}if(n===304)throw new ii("Not modified",n,{response:{url:i,status:n,headers:r,data:await Kf(a)},request:t});if(n>=400){const s=await Kf(a);throw new ii(mE(s),n,{response:{url:i,status:n,headers:r,data:s},request:t})}return Kf(a)}}).then(a=>({status:n,url:i,headers:r,data:a})).catch(a=>{throw a instanceof ii?a:new ii(a.message,500,{request:t})})}c(ay,"fetchWrapper");async function Kf(t){const e=t.headers.get("content-type");return/application\/json/.test(e)?t.json():!e||/^text\/|charset=utf-8$/.test(e)?t.text():gE(t)}c(Kf,"getResponseData");function mE(t){return typeof t=="string"?t:"message"in t?Array.isArray(t.errors)?`${t.message}: ${t.errors.map(JSON.stringify).join(", ")}`:t.message:`Unknown error: ${JSON.stringify(t)}`}c(mE,"toErrorMessage");function Zf(t,e){const r=t.defaults(e);return Object.assign(c(function(i,o){const a=r.merge(i,o);if(!a.request||!a.request.hook)return ay(r.parse(a));const s=c((l,u)=>ay(r.parse(r.merge(l,u))),"request");return Object.assign(s,{endpoint:r,defaults:Zf.bind(null,r)}),a.request.hook(s,a)},"newApi"),{endpoint:r,defaults:Zf.bind(null,r)})}c(Zf,"dist_web_withDefaults");const lu=Zf(cE,{headers:{"user-agent":`octokit-request.js/${pE} ${cu()}`}}),vE="4.8.0";function wE(t){return`Request failed due to following response errors:
`+t.errors.map(e=>` - ${e.message}`).join(`
`)}c(wE,"_buildMessageForResponseErrors");class Ma extends Error{constructor(e,r,n){super(wE(n));this.request=e,this.headers=r,this.response=n,this.name="GraphqlResponseError",this.errors=n.errors,this.data=n.data,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}c(Ma,"GraphqlResponseError");const yE=["method","baseUrl","url","headers","request","query","mediaType"],bE=["query","method","url"],sy=/\/api\/v3\/?$/;function xE(t,e,r){if(r){if(typeof e=="string"&&"query"in r)return Promise.reject(new Error('[@octokit/graphql] "query" cannot be used as variable name'));for(const a in r)if(!!bE.includes(a))return Promise.reject(new Error(`[@octokit/graphql] "${a}" cannot be used as variable name`))}const n=typeof e=="string"?Object.assign({query:e},r):e,i=Object.keys(n).reduce((a,s)=>yE.includes(s)?(a[s]=n[s],a):(a.variables||(a.variables={}),a.variables[s]=n[s],a),{}),o=n.baseUrl||t.endpoint.DEFAULTS.baseUrl;return sy.test(o)&&(i.url=o.replace(sy,"/api/graphql")),t(i).then(a=>{if(a.data.errors){const s={};for(const l of Object.keys(a.headers))s[l]=a.headers[l];throw new Ma(i,s,a.data)}return a.data.data})}c(xE,"graphql");function Xf(t,e){const r=t.defaults(e);return Object.assign(c((i,o)=>xE(r,i,o),"newApi"),{defaults:Xf.bind(null,r),endpoint:lu.endpoint})}c(Xf,"graphql_dist_web_withDefaults");const CR=Xf(lu,{headers:{"user-agent":`octokit-graphql.js/${vE} ${cu()}`},method:"POST",url:"/graphql"});function _E(t){return Xf(t,{method:"POST",url:"/graphql"})}c(_E,"withCustomRequest");const SE=/^v1\./,CE=/^ghs_/,EE=/^ghu_/;async function RE(t){const e=t.split(/\./).length===3,r=SE.test(t)||CE.test(t),n=EE.test(t);return{type:"token",token:t,tokenType:e?"app":r?"installation":n?"user-to-server":"oauth"}}c(RE,"auth");function AE(t){return t.split(/\./).length===3?`bearer ${t}`:`token ${t}`}c(AE,"withAuthorizationPrefix");async function TE(t,e,r,n){const i=e.endpoint.merge(r,n);return i.headers.authorization=AE(t),e(i)}c(TE,"hook");const kE=c(function(e){if(!e)throw new Error("[@octokit/auth-token] No token passed to createTokenAuth");if(typeof e!="string")throw new Error("[@octokit/auth-token] Token passed to createTokenAuth is not a string");return e=e.replace(/^(token|bearer) +/i,""),Object.assign(RE.bind(null,e),{hook:TE.bind(null,e)})},"createTokenAuth"),cy="3.5.1";class hc{constructor(e={}){const r=new Q1.Collection,n={baseUrl:lu.endpoint.DEFAULTS.baseUrl,headers:{},request:Object.assign({},e.request,{hook:r.bind(null,"request")}),mediaType:{previews:[],format:""}};if(n.headers["user-agent"]=[e.userAgent,`octokit-core.js/${cy} ${cu()}`].filter(Boolean).join(" "),e.baseUrl&&(n.baseUrl=e.baseUrl),e.previews&&(n.mediaType.previews=e.previews),e.timeZone&&(n.headers["time-zone"]=e.timeZone),this.request=lu.defaults(n),this.graphql=_E(this.request).defaults(n),this.log=Object.assign({debug:()=>{},info:()=>{},warn:console.warn.bind(console),error:console.error.bind(console)},e.log),this.hook=r,e.authStrategy){const{authStrategy:o,...a}=e,s=o(Object.assign({request:this.request,log:this.log,octokit:this,octokitOptions:a},e.auth));r.wrap("request",s.hook),this.auth=s}else if(!e.auth)this.auth=async()=>({type:"unauthenticated"});else{const o=kE(e.auth);r.wrap("request",o.hook),this.auth=o}this.constructor.plugins.forEach(o=>{Object.assign(this,o(this,e))})}static defaults(e){return c(class extends this{constructor(...n){const i=n[0]||{};if(typeof e=="function"){super(e(i));return}super(Object.assign({},e,i,i.userAgent&&e.userAgent?{userAgent:`${i.userAgent} ${e.userAgent}`}:null))}},"OctokitWithDefaults")}static plugin(...e){var r;const n=this.plugins;return r=c(class extends this{},"_a"),r.plugins=n.concat(e.filter(o=>!n.includes(o))),r}}c(hc,"Octokit"),hc.VERSION=cy,hc.plugins=[];function IE(t,e){return t.reduce((n,i)=>{const o=e(i),a=n.get(o);return a===void 0?n.set(o,[i]):a.push(i),n},new Map)}c(IE,"groupBy");function DE(t){let e=0;for(const r of t){if(r===0)return!0;if(e++,e>8e3)break}return!1}c(DE,"isBinary");function Qf(t,e,r=n=>n){return[...t.reduce((i,o)=>{const a=e(o),s=i.get(a);if(s===void 0)i.set(a,o);else{const l=r(s,o);l!==void 0&&i.set(a,l)}return i},new Map).values()]}c(Qf,"uniqueBy");function Yf(t){const e="$memoize$";return function(...r){return this.hasOwnProperty(e)||Object.defineProperty(this,e,{configurable:!1,enumerable:!1,writable:!1,value:t.apply(this,r)}),this[e]}}c(Yf,"memoize");class Jf{constructor(e,r){this.path=e,this.relativePath=r}}c(Jf,"TrieNode");class ly{constructor(){this.root=new Jf("","")}get(e){var r;e.startsWith("/")?e=e.slice(1,e.endsWith("/")?-1:void 0):e.endsWith("/")&&(e=e.slice(0,-1));let n=this.root;for(const i of e.split("/")){const o=(r=n.children)==null?void 0:r.get(i);if(o===void 0)return;n=o}return n.path===e?n.data:void 0}getChildren(e){var r;e.startsWith("/")?e=e.slice(1,e.endsWith("/")?-1:void 0):e.endsWith("/")&&(e=e.slice(0,-1));let n=this.root;if(e)for(const i of e.split("/")){const o=(r=n.children)==null?void 0:r.get(i);if(o===void 0)return[];n=o}return n.children===void 0?[]:[...n.children.values()].map(i=>[i.relativePath,i.data])}getDescendants(e){var r;e.startsWith("/")?e=e.slice(1,e.endsWith("/")?-1:void 0):e.endsWith("/")&&(e=e.slice(0,-1));let n=this.root;const i=[];if(e)for(const o of e.split("/")){const a=(r=n.children)==null?void 0:r.get(o);if(a===void 0)return i;n=a}if(n.children!==void 0){let o=c(function(a,s,l){for(const u of a.values()){const d=`${s?`${s}/`:""}${u.relativePath}`;u.data&&l.push([d,u.data]),u.children!==void 0&&o(u.children,d,l)}},"getDescendantsCore");o(n.children,"",i)}return i}has(e){var r;e.startsWith("/")?e=e.slice(1,e.endsWith("/")?-1:void 0):e.endsWith("/")&&(e=e.slice(0,-1));let n=this.root;for(const i of e.split("/")){const o=(r=n.children)==null?void 0:r.get(i);if(o===void 0)return!1;n=o}return n.path===e}set(e,r){var n;e.startsWith("/")?e=e.slice(1,e.endsWith("/")?-1:void 0):e.endsWith("/")&&(e=e.slice(0,-1));let i=this.root,o="";for(const a of e.split("/")){let s=(n=i.children)==null?void 0:n.get(a);o=`${o?`${o}/`:""}${a}`,s===void 0&&(i.children===void 0&&(i.children=new Map),s=new Jf(o,a),i.children.set(a,s)),i=s}i.data=r}}c(ly,"Trie");class ep{constructor(e,r,n,i,o){if(this.rootUri=e,this.sha=r,this.timestamp=n,this.provider=i,this.trie=new ly,this._hasEntireTree=!1,this._isContentCached=!1,i===void 0)return;const a=[i];i.onDidTriggerContentCaching!==void 0&&i.tryCachingContent!==void 0&&a.push(i.onDidTriggerContentCaching(s=>{(!s||H(s.rootUri)===H(this.rootUri)&&s.sha===this.sha)&&!this.loading&&this.hasEntireTree&&!this.isContentCached&&i.tryCachingContent(this.trie.get.bind(this.trie)).then(l=>this._isContentCached=l,()=>this._isContentCached=!0)})),this._loading=this.load(o==null?void 0:o.path,o==null?void 0:o.recursive).then(s=>(this._hasEntireTree=(s==null?void 0:s.success)?s.recursive:!1,this._hasEntireTree&&setTimeout(()=>{var l;return void((l=i.tryCachingContent)==null?void 0:l.call(i,this.trie.get.bind(this.trie)).then(u=>this._isContentCached=u,()=>this._isContentCached=!0))},0),i_("_codespaces.webeditor.connectWorkspace",{result:(s==null?void 0:s.success)?"Success":"Failure",errorMessage:this._hasEntireTree?"":"Unable to load entire tree",errorDetail:(s==null?void 0:s.success)===!1?s.error:void 0}),this._loading=void 0,this.preloading=void 0,this.treeSha=(s==null?void 0:s.success)?s.sha:void 0,this.treeSha)),(o==null?void 0:o.preload)&&(this.preloading=new Map([["",this.load("")],[".vscode",this.load(".vscode")]])),this.disposable=h.Disposable.from(...a)}get hasEntireTree(){return this._hasEntireTree}get isContentCached(){return this._isContentCached}get loading(){return this._loading!==void 0}get permissions(){var e;return(e=this.provider)==null?void 0:e.permissions}dispose(){var e;(e=this.disposable)==null||e.dispose()}async get(e){var r;if(e==="")return{mode:"040000",sha:this.treeSha,stat:{type:h.FileType.Directory,size:0,ctime:0,mtime:(r=this.timestamp)!=null?r:Date.now(),permissions:await this.permissions},getContent:void 0};let n=this.trie.get(e);return n!==void 0||(await this.ensureLoaded(e),n=this.trie.get(e)),n}async getChildren(e,r){await this.ensureLoaded(e,!0);const n=(r==null?void 0:r.recursive)?this.trie.getDescendants(e):this.trie.getChildren(e);return(r==null?void 0:r.filter)===void 0?n:n.filter(([,i])=>i.stat.type===r.filter)}async getTreeSha(){return await this.waitUntilLoaded(),this.treeSha}async waitUntilLoaded(){this._loading!==void 0&&await this._loading}async ensureLoaded(e,r=!1){if(this._loading!==void 0){let i;if(this.preloading!==void 0)if(r)i=this.preloading.get(e);else{const o=U(this.preloading,([a])=>e.startsWith(a)&&e.lastIndexOf("/")===(a?a.length:-1));i=o==null?void 0:o[1]}await(i!=null?i:this._loading)}if(this.hasEntireTree||e==="")return;let n=this.trie.get(e);if(n)return r&&(n==null?void 0:n.loadChildren)?n.loadChildren():void 0;if(await this.ensureLoaded(e.substr(0,e.lastIndexOf("/")),!0),n=this.trie.get(e),r&&(n==null?void 0:n.loadChildren))return n.loadChildren()}async load(e,r=!1){var n;if(((n=this.provider)==null?void 0:n.getTree)===void 0)return;const i=new Be(`FileTree.load(${this.sha}:${e})`);let o;try{i.logStep("Tree query");const a=await this.provider.getTree(e,r);if(a.truncated){C.warn(`Loading file tree for path=${e} was truncated`),i.logStep("Fixing directories",{message:`: Tree=${a.sha};`,suffix:" \u2022 Fixing directories..."});for(const[l,u]of this.trie.getDescendants(""))u.stat.type===h.FileType.Directory&&(u.loadChildren=Yf(()=>this.load(l).then(()=>u.loadChildren=void 0)));return o=` \u2022 Tree=${a.sha} \u2022 Truncated`,{sha:a.sha,recursive:!1,success:!0}}let s;this.permissions!==void 0&&(i.logStep("Permissions query",{message:`: Tree=${a.sha};`,suffix:" \u2022 Waiting for permissions..."}),s=await this.permissions),i.logStep("Filling trie",{suffix:" \u2022 Filling trie..."});for(let{path:l,item:u}of a.tree)if(l!==void 0){switch(l=e?`${e}/${l}`:l,u.stat.permissions=s,u.stat.type){case h.FileType.File:u.getContent=Yf(()=>this.provider.getContent(u));break;case h.FileType.Directory:r||(u.loadChildren=Yf(()=>this.load(l).then(()=>u.loadChildren=void 0)));break}this.trie.set(l,u)}return o=` \u2022 Tree=${a.sha}`,{sha:a.sha,recursive:r,success:!0}}catch(a){return o=`\u2022 Loading for path=${e} failed; ${String(a)}`,{error:a,success:!1}}finally{i.stop(o?{suffix:o}:void 0)}}}c(ep,"FileTree");var PE=__webpack_require__(7769);const FE="github-pr-owner-number";function $E(t){return`branch.${t}.${FE}`}c($E,"getMetadataKeyForBranch");const NE=(0,A.loadMessageBundle)(),uy=new TextDecoder;class dy{constructor(e,r,n,i,o,a){this.providerService=e,this.rootUri=r,this.sourceControl=n,this.metadata=i,this.changeStore=o,this.github=a,this._onDidChangeSelection=new h.EventEmitter,this._onDidChangeState=new h.EventEmitter,this._objects=new Map,this.disposable=h.Disposable.from(this.sourceControl.onDidChangeSelection(()=>this._onDidChangeSelection.fire()),this.providerService.onDidRefresh(u=>{const d=H(this.rootUri);!u.some(p=>H(p)===d)||this.updateState(this.metadata)}),this.providerService.onDidChangeRepository(async({repository:u})=>{H(this.rootUri)===H(u.uri)&&this.updateState(await u.getMetadata())}),this.changeStore.onDidChange(()=>this.updateState(this.metadata)),this._onDidChangeSelection,this._onDidChangeState),this._inputBox={get value(){return n.inputBox.value},set value(u){n.inputBox.value=u}},this._ui={get selected(){return n.selected},onDidChange:this._onDidChangeSelection.event};const{repo:{owner:s,name:l}}=i;this.remote={name:"origin",fetchUrl:`https://github.com/${s}/${l}.git`,isReadOnly:i.accessLevel<Se.Write},this.remotes=[this.remote],this._state={HEAD:this.getHEADFromMetadata(i),mergeChanges:[],indexChanges:[],workingTreeChanges:[],onDidChange:this._onDidChangeState.event,rebaseCommit:void 0,refs:[],remotes:this.remotes,submodules:[]},this.updateState(i)}dispose(){this.disposable.dispose()}get inputBox(){return this._inputBox}get state(){return this._state}get ui(){return this._ui}getHEADFromMetadata(e){switch(e.HEAD.type){case he.Branch:return{type:Gn.Head,commit:e.HEAD.sha,name:e.HEAD.branch.name,upstream:{name:e.HEAD.branch.name,remote:this.remote.name}};case he.RemoteBranch:{const r=e.HEAD.branch.remote.repo.owner,n=e.HEAD.branch.remote.accessLevel<Se.Write,i=this.remotes.findIndex(o=>o.name===r);return this.remotes.splice(i===-1?this.remotes.length:i,i===-1?0:1,{name:r,fetchUrl:`https://github.com/${e.HEAD.branch.remote.repo.owner}/${e.HEAD.branch.remote.repo.name}.git`,pushUrl:n?void 0:`https://github.com/${e.HEAD.branch.remote.repo.owner}/${e.HEAD.branch.remote.repo.name}.git`,isReadOnly:n}),{type:Gn.RemoteHead,commit:e.HEAD.sha,name:e.HEAD.branch.name,upstream:{name:e.HEAD.branch.name,remote:e.HEAD.branch.remote.repo.owner}}}case he.Tag:return{type:Gn.Tag,name:e.HEAD.detached.name,commit:e.HEAD.sha};case he.Commit:return{type:Gn.Head,commit:e.HEAD.sha}}}async updateState(e){this.metadata=e;const r=await this.changeStore.getGroupedChanges(this.rootUri,{predicate:s=>s.fileType===h.FileType.File}),n=r.conflicts.map(s=>({uri:s.uri,status:tp(s.type),originalUri:s.uri,renameUri:s.uri})),i=r.staged.map(s=>({uri:s.uri,status:tp(s.type),originalUri:s.uri,renameUri:s.uri})),o=r.working.map(s=>({uri:s.uri,status:tp(s.type),originalUri:s.uri,renameUri:s.uri})),a=P.get("staging.enabled");this._state={...this._state,HEAD:this.getHEADFromMetadata(e),mergeChanges:n,indexChanges:a?i:[],workingTreeChanges:a?o:[...i,...o]},this._onDidChangeState.fire()}getConfigs(){return Promise.resolve([])}getConfig(e){return this.metadata.HEAD.branch&&this.metadata.pullRequest&&e===$E(this.metadata.HEAD.branch.name)?Promise.resolve(`${this.metadata.repo.owner}#${this.metadata.repo.name}#${this.metadata.pullRequest.id}`):Promise.resolve("")}setConfig(e,r){return Promise.resolve("")}getGlobalConfig(e){throw new Error("Method not implemented.")}async getObjectDetails(e,r){const n=new Be(`IGit.getObjectDetails(${e}, ${r})`);try{return await this.github.getObjectDetails(this.rootUri,e,this.pathToRelativePath(r))}finally{n.stop()}}async detectObjectType(e){var r;const n=new Be(`IGit.detectObjectType(${e})`);try{const i=await this.github.getBlobContent(this.metadata.repo,e);if(!DE(i))return{mimetype:"text/plain"};const a=await(0,PE.fromBuffer)(i);return{mimetype:(r=a==null?void 0:a.mime)!=null?r:"application/octet-stream"}}finally{n.stop()}}async buffer(e,r){const n=new Be(`IGit.buffer(${e}, ${r})`);try{return await this.github.getFileContent(this.rootUri,e,this.pathToRelativePath(r))}finally{n.stop()}}async show(e,r){const n=new Be(`IGit.show(${e}, ${r})`);try{const i=await this.github.getFileContent(this.rootUri,e,this.pathToRelativePath(r));return uy.decode(i)}finally{n.stop()}}async getCommit(e){const r=new Be(`IGit.getCommit(${e})`);try{const n=await this.github.getCommit(this.rootUri,e);if(n===void 0)throw new Error(`Unable to find commit for ref "${e}"`);return n}finally{r.stop()}}clean(e){return this._objects.clear(),Promise.resolve()}async apply(e,r){const n=new Be(`IGit.apply(reverse=${r})`);try{return await this.changeStore.applyPatch(this.rootUri,e,r?{reverse:!0}:void 0)}finally{n.stop()}}async diff(e){const r=new Be(`IGit.diff(${e})`);try{return await this.changeStore.createPatch(this.rootUri,void 0,e?{staged:!0}:void 0)}finally{r.stop()}}diffWithHEAD(e){return e?this.diffBetween("","HEAD",e):this.diffBetween("","HEAD")}diffWith(e,r){return r?this.diffBetween("",e,r):this.diffBetween("",e)}diffIndexWithHEAD(e){return e?this.diffBetween("~","HEAD",e):this.diffBetween("~","HEAD")}diffIndexWith(e,r){return r?this.diffBetween("~",e,r):this.diffBetween("~",e)}async diffBetween(e,r,n){if(!n)throw new Error("Method not implemented.");const i=new Be(`IGit.diffBetween(${e}, ${r}, ${n})`);try{const[o,a]=await Promise.all([this.getContent(e,n),this.getContent(r,n)]);return jo(n,o,a)}finally{i.stop()}}async diffBlobs(e,r){const n=new Be(`IGit.diffBlobs(${e}, ${r})`);try{const i=await this.getBlobContent(e),o=await this.getBlobContent(r),a=jo("untitled",i,o);return Promise.resolve(a)}finally{n.stop()}}async getBlobContent(e){const r=new Be(`IGit.getBlobContent(${e})`);try{const n=this._objects.get(e);if(n)return this._objects.delete(e),n;const{repo:i}=this.providerService.getVirtualUriMetadata(this.rootUri),o=await this.github.getBlobContent(i,e);return uy.decode(o)}finally{r.stop()}}async getContent(e,r){const n=new Be(`IGit.getContent(${e}, ${r})`);try{const i=this.pathToRelativeUri(r);if(e===""||e==="~"){const o=await this.changeStore.getChange(i);if(o!==void 0&&(e===""||o.staged))return this.changeStore.getContent(i);e="HEAD"}return await this.show(e==="HEAD"?this.metadata.HEAD.sha:e,r)}finally{n.stop()}}async hashObject(e){const r=new Be("IGit.hashObject");try{const n=Ga(await mn(e));return this._objects.set(n,e),n}finally{r.stop()}}async createBranch(e,r,n){const i=new Be(`IGit.createBranch(${e}, ${r}, ${n})`);try{n||(n=this.metadata.HEAD.sha);const o=await this.github.createBranch(this.rootUri,e,n);r&&await this.checkout(o)}finally{i.stop()}}deleteBranch(e,r){throw new Error("Method not implemented.")}async getBranch(e){const r=new Be(`IGit.getBranch(${e})`);try{const{branches:n}=await this.github.getBranches(this.rootUri,{query:e,limit:1}),[i]=n;if(i===void 0)throw new Error(`Unable to find branch named "${e}"`);return{type:i.type,name:i.name,commit:i.commit,remote:this.remote.name,upstream:{name:i.name,remote:i.commitUrl}}}finally{r.stop()}}async getBranches(e){var r,n;const i=(n=(r=e.contains)!=null?r:e.pattern)!=null?n:"",o=new Be(`IGit.getBranches(${i})`);try{const{branches:a}=await this.github.getBranches(this.rootUri,{query:i,limit:e.count});if(a.length===0)throw new Error(`Unable to find branches for "${i}"`);return a.map(s=>({type:s.type,name:s.name,commit:s.commit}))}finally{o.stop()}}setBranchUpstream(e,r){throw new Error("Method not implemented.")}getMergeBase(e,r){throw new Error("Method not implemented.")}async status(){}async checkout(e){const r=new Be(`IGit.checkout(${e})`);try{if(await this.github.repositoryObjectExists(this.rootUri,e)){const i=await this.github.switchTo(this.rootUri,e,{openInNewWindow:!1});throw i!==void 0&&await sn(i),new Error("User aborted")}const n=/pr\/(?<remote>.+)\/(?<num>\d+)/.exec(e);if(n==null?void 0:n.groups){const{num:i}=n.groups,{provider:o,repo:a}=this.providerService.getVirtualUriMetadata(this.rootUri),s=this.providerService.getRemoteUri(o.id,{repo:a,pullRequest:{id:i}});if(s!==void 0){const l=await this.providerService.createWorkspaceForRemoteUrl(s.toString());l!==void 0&&await sn(l)}}throw new Error("User aborted")}finally{r.stop()}}addRemote(e,r){var n;let i;const o=this.remotes.findIndex(a=>a.name===e);return o!==-1&&([i]=this.remotes.splice(o,1)),this.remotes.push({name:e,fetchUrl:r,isReadOnly:(n=i==null?void 0:i.isReadOnly)!=null?n:!1}),Promise.resolve()}removeRemote(e){const r=this.remotes.findIndex(n=>n.name===e);return r!==-1&&this.remotes.splice(r,1),Promise.resolve()}renameRemote(e,r){const n=this.remotes.findIndex(o=>o.name===e);if(n===-1)return Promise.resolve();const[i]=this.remotes.splice(n,1);return this.remotes.push({...i,name:r}),Promise.resolve()}async fetch(e,r,n){const i=new Be("IGit.fetch");try{return this.github.fetch(this.rootUri)}finally{i.stop()}}async pull(e){const r=new Be("IGit.pull");try{return this.github.sync(this.rootUri,this.changeStore,{conflictResolution:Br.Merge})}finally{r.stop()}}push(e,r,n){return Promise.resolve()}blame(e){throw new Error("Method not implemented.")}async log(e){if((e==null?void 0:e.maxEntries)!==1||(e==null?void 0:e.path)!==void 0)throw new Error("The specified log options are not yet supported.");return[await this.getCommit(this.metadata.HEAD.sha)]}async commit(e,r){const n=new Be("IGit.commit");try{if((r==null?void 0:r.amend)!==void 0||(r==null?void 0:r.empty)!==void 0||(r==null?void 0:r.signCommit)!==void 0||(r==null?void 0:r.signoff)!==void 0)throw new Error("The specified commit options are not yet supported.");const i=(await this.providerService.getCommitOperations(this.rootUri,this.changeStore,{staged:(r==null?void 0:r.all)===!1})).filter(o=>o.fileType===h.FileType.File);if(!i.length){h.window.showInformationMessage(NE("no changes to commit","There are no changes to commit."));return}if(P.getUseNewCommitApi())await this.github.createAndPushCommit(this.rootUri,e,i,void 0);else{const o=await this.github.createCommit(this.rootUri,e,i);await this.github.pushCommit(this.rootUri,o)}}finally{n.stop()}}pathToRelativePath(e){return this.providerService.getRelativeFilePath(this.rootUri,this.pathToRelativeUri(e))}pathToRelativeUri(e){return Ue(this.rootUri,OE(e))}}c(dy,"GitHubRepository");const ME=/^\/?([a-zA-Z])(?::\/)(.*)$/,BE=/\\/g;function OE(t){t=h.Uri.file(t).fsPath.replace(BE,"/");const e=ME.exec(t);return e!==null&&([,,t]=e),t.startsWith("/")?t:`/${t}`}c(OE,"normalizePath");function tp(t){switch(t){case ut.Changed:return $s.MODIFIED;case ut.Created:return $s.INTENT_TO_ADD;case ut.Deleted:return $s.DELETED}}c(tp,"opTypeToStatus");var UE=Object.defineProperty,LE=Object.getOwnPropertyDescriptor,hy=c((t,e,r,n)=>{for(var i=n>1?void 0:n?LE(e,r):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&UE(e,r,i),i},"github_provider_decorateClass");const Ba=(0,A.loadMessageBundle)(),fy=/^(?:https?:\/\/)?github\.(?:com|dev)\/(?<owner>[^/]+)\/(?<repo>[^/?#]+)(?:|\.git|\/tree\/(?<tree>[^?#]+)|\/blob\/(?<blob>[^?#]+)|\/commit\/(?<commit>[0-9a-f]{40})|\/pull\/(?<pull>[0-9]+))?(?<extra>[^?#]*)(?:\?(?<query>[^#]*))?(?:#(?<fragment>.*))?$/i,py=/(?<remoteOwner>[^/:]+)\/?(?<remoteRepo>[^/:]+)?:(?<remoteRef>.*)/,uu=["repo","workflow"],du=1,gy=Object.freeze({id:"github",name:"GitHub"});function Oa(t){const{scheme:e,metadata:r}=Dt.decodeAuthority(t,a=>{if(a.v!==void 0)return a;if(typeof a.pr=="string")return{v:du,ref:{type:ke.PullRequest,id:a.pr},idx:a.idx};if(typeof a.ref=="string")return{v:du,ref:{type:ke.Tree,id:a.ref},idx:a.idx}}),[,n,i,...o]=t.path.split("/");return{scheme:e,provider:gy,name:`${n}/${i}`,repo:{owner:n,name:i},path:o.join("/")||"",ref:r==null?void 0:r.ref,idx:r==null?void 0:r.idx}}c(Oa,"getGitHubMetadata");function HE(t,e){const{repo:r}=e!=null?e:Oa(t);return t.with({path:`/${r.owner}/${r.name}`,query:"",fragment:""})}c(HE,"getGitHubRootUri");function rp(t,e,r){const{repo:{owner:n,name:i}}=t instanceof h.Uri?Oa(t):t;return h.Uri.parse(`github://${Dt.encodeAuthority("github",{v:du,ref:{type:ke.Commit,id:e}})}/${n}/${i}/${r}`)}c(rp,"getGitHubRevisionUri");class hu{constructor(e,r){this.providerService=e,this.tarPit=r,this.fileTreeCache=new Map,this.disposable=h.Disposable.from(e.onDidChangeRepository(n=>{n.reason==="HEAD"&&this.onRefreshOrRepositoryChanged([n.repository.uri])}),e.onDidRefresh(n=>this.onRefreshOrRepositoryChanged(n))),An&&(this.tarballProxyEndpoint=h.commands.executeCommand("_workbench.getTarballProxyEndpoints").then(n=>n==null?void 0:n["github.com"]))}get isReadonly(){return!1}get scheme(){return"github"}dispose(){this.disposable.dispose()}onRefreshOrRepositoryChanged(e){e=e.filter(r=>Dt.getProviderId(r)===this.scheme),e.length!==0&&(this.fileTreeCache.forEach(r=>r.dispose()),this.fileTreeCache.clear())}async ensureAuthenticated(e=!1){const r=new Be("GitHub.ensureAuthenticated");try{if(this._session===void 0){async function n(){try{return e?await h.authentication.getSession("github",uu,{forceNewSession:e}):await h.authentication.getSession("github",uu,{createIfNone:!0})}catch(o){C.error(o);try{const a=await h.authentication.getSession("github",uu,{createIfNone:!1});if(a!==void 0)return a}catch{}return new Promise(a=>{async function s(){const u=await h.authentication.getSession("github",uu,{createIfNone:!0});u!==void 0&&a(u)}c(s,"getSession");const l=h.authentication.onDidChangeSessions(async u=>{u.provider.id==="github"&&(l.dispose(),await s())})})}}c(n,"waitUntilAuthenticated"),this._session=await n();const i=h.authentication.onDidChangeSessions(o=>{if(this._session===void 0){i.dispose();return}o.provider.id==="github"&&(this.clearAuthenticationSession(),i.dispose())})}return this._session}finally{r.stop()}}async getAuthentication(e){const r=await this.ensureAuthenticated();return{provider:gy,session:r,getRichNavigationHeaders:()=>({"X-Git-GitHub":`Bearer ${r.accessToken}`})}}clearAuthenticationSession(){this._session=void 0,this._octokit=void 0,this._octokitDefaults=void 0}async reauthenticate(){this.clearAuthenticationSession(),await this.ensureAuthenticated(!0)}async octokit(e){if(this._octokitDefaults===void 0){const n=await this.ensureAuthenticated();if(An){async function i(o,a){if(a.headers!==void 0){const{"user-agent":s,...l}=a.headers;s&&(a.headers=l)}return Vn(o,a)}c(i,"fetchCore"),this._octokitDefaults=hc.defaults({auth:`token ${n.accessToken}`,request:{fetch:i}})}else this._octokitDefaults=hc.defaults({auth:`token ${n.accessToken}`})}const r=new this._octokitDefaults(e);return(C.logLevel===ie.Debug||C.isDebugging)&&r.hook.wrap("request",async(n,i)=>{var o;const a=new Be(`[GITHUB] ${i.method} ${i.url}`,{log:!1});try{return await n(i)}finally{let s;try{if(typeof i.query=="string"){const l=/(^[^({\n]+)/.exec(i.query);s=` ${(o=l==null?void 0:l[1].trim())!=null?o:i.query}`}}catch{}a.stop({message:s})}}),r}async graphql(e,r){this._octokit===void 0&&(this._octokit=await this.octokit());try{return await this._octokit.graphql(e,r)}catch(n){throw this.handleRequestErrors(n),n}}async request(e,r){this._octokit===void 0&&(this._octokit=await this.octokit());try{return await this._octokit.request(e,r)}catch(n){throw this.handleRequestErrors(n),n}}handleRequestErrors(e){var r,n;if(e instanceof ii)switch(e.status){case 500:return e.response&&Fr.showGitHubStatus500Message(),!0;case 401:return Fr.showStatus401Message(()=>void this.reauthenticate()),!0;case 403:return Fr.showStatus403Message(()=>void this.reauthenticate()),!0}else if(e instanceof Ma&&((n=(r=e.errors)==null?void 0:r[0])==null?void 0:n.type)==="FORBIDDEN")return Fr.showStatus403Message(()=>void this.reauthenticate()),!0;return!1}createIGitRepository(e,r,n,i){return new dy(this.providerService,e,r,n,i,this)}async createMetadata(e,r){var n,i,o,a,s,l;const u=new Be(`GitHub.createMetadata(${e.toString()}, ${r})`);let d;try{let{provider:p,name:f,repo:{owner:g,name:x},ref:y}=Oa(e);(!y||y.type===ke.Commit&&/HEAD/i.test(y.id))&&(y={type:ke.Commit,id:"HEAD"});const b=this.providerService.isInWorkspace(e);let S,E;P.get("experimental.prefetch")&&b&&(r?S=r:(y.type===ke.Commit||y.type===ke.Tree)&&(S=y.id),S&&(u.log({suffix:` \u2022 Prefetching tree for ${S}...`}),this.getFileTree(e,void 0,{cache:!0,recursive:!0,prefetched:{metadata:new Promise(ne=>E=ne),repo:{owner:g,name:x},HEAD:{sha:S},timestamp:Date.now()}})));const D=await this.getRepositoryInfo(g,x,b,y.type===ke.PullRequest?{pr:Number(y.id)}:{ref:y.id});if(D===void 0)throw d=" \u2022 Aborted; Unable to get repository info",new Error(`Cannot get metadata for Uri(${e.toString()}); Unable to get repository info`);let $;if(r)$=r;else if(y.type===ke.Commit||y.type===ke.Tree&&D.ref===void 0)$=y.id;else if($=(i=(n=D.ref)==null?void 0:n.sha)!=null?i:D.defaultBranch.sha,$===void 0)throw d=" \u2022 Aborted; Unable to get repository revision",new Error(`Cannot get metadata for Uri(${e.toString()}); Unable to get repository revision`);let z;if(((o=D.ref)==null?void 0:o.prefix)==="refs/heads/")z={type:he.Branch,name:D.ref.name,sha:$,branch:{name:D.ref.name,sha:D.ref.sha}};else if(((a=D.ref)==null?void 0:a.prefix)==="refs/remotes/"){if(!D.ref.remote)throw d=" \u2022 Aborted; Unable to get remote info",new Error(`Cannot get metadata for Uri(${e.toString()}); Unable to get remote info`);z={type:he.RemoteBranch,name:`${D.ref.remote.repo.owner}${D.ref.remote.repo.name!==x?`/${D.ref.remote.repo.name}`:""}:${D.ref.name}`,sha:$,branch:{name:D.ref.name,sha:D.ref.sha,remote:D.ref.remote}}}else((s=D.ref)==null?void 0:s.prefix)==="refs/tags/"?z={type:he.Tag,name:D.ref.name,sha:$,detached:{type:he.Tag,name:D.ref.name}}:z={type:he.Commit,name:Ve($),sha:$,detached:{type:he.Commit,name:Ve($)}};if(S!==void 0&&S!==z.sha){const ne=this.asFileTreeKey(e,S),ee=this.fileTreeCache.get(ne);ee&&!Jt(S)&&z.sha===((l=z.branch)==null?void 0:l.sha)?(u.log({suffix:` \u2022 Updating prefetched tree for ${S}, since HEAD was resolved; HEAD=${z.sha}`}),this.fileTreeCache.set(this.asFileTreeKey(e,z.sha),ee),this.fileTreeCache.delete(ne)):(u.log({suffix:` \u2022 Removing prefetched tree for ${S}, since the HEAD changed; HEAD=${z.sha}`}),this.fileTreeCache.delete(ne),ee==null||ee.dispose())}const re={version:Ke.schemaVersion,timestamp:Date.now(),provider:p,name:f,repo:D.repo,user:D.user,accessLevel:D.accessLevel,HEAD:z,defaultBranch:D.defaultBranch,pullRequest:D.pullRequest};return d=` \u2022 HEAD=${z.sha}`,E==null||E(re),re}finally{u.stop(d?{suffix:d}:void 0)}}getMetadata(e){return this.providerService.getMetadata(e)}getRemoteWorkspaceSourceProviders(){return[{name:"GitHub",icon:"$(github)",label:Ba("open repo from","Open Repository from {0}","GitHub"),placeholder:Ba("pick repo","Choose a repository"),provideSources:async(e,r,n,i)=>{n=n!=null?n:"";let o;const a=n==null?void 0:n.indexOf("/");return a!==-1&&(o=n.substring(0,a),n=n.substr(a+1)),(await this.searchRepositoriesQuery(n,{...i,user:o})).map(l=>({providerId:"github",name:l.repoWithOwner,icon:"$(repo)",description:`${l.fork?`$(repo-forked) ${l.fork}`:""}${l.stars>0?`${l.fork?" \u2022 ":""}$(star-full) ${l.stars}`:""}`,detail:l.description,url:l.url}))}},{name:"GitHub",icon:"$(github)",label:Ba("open pr from","Open Pull Request from {0}","GitHub"),placeholder:Ba("pick pr","Choose a pull request"),provideSources:async(e,r,n,i)=>{n=n!=null?n:"";let o;const a=n==null?void 0:n.indexOf("/");return a!==-1&&(o=n.substring(0,a),n=n.substr(a+1)),(await this.searchPullRequestsQuery(n,{user:o})).map(l=>({providerId:"azurerepos",name:l.title,icon:"$(git-pull-request)",description:l.reasons.length!==0?l.reasons.sort().join(", "):void 0,detail:`${l.repoWithOwner} #${l.number}`,url:l.url}))}}]}canOpenRemoteUrl(e){const r=fy.exec(e);if((r==null?void 0:r.groups)===void 0)return;const{blob:n,commit:i,pull:o,tree:a}=r.groups;return o?Ie.PullRequest:i?Ie.Commit:a?Ie.Branch:n?Ie.File:Ie.Repository}async createWorkspaceForRemoteUrl(e,r=$t.CurrentWindow){const n=fy.exec(e);if((n==null?void 0:n.groups)===void 0)return;let{owner:i,repo:o,blob:a,commit:s,pull:l,tree:u,fragment:d}=n.groups;const p=await this.validateOwnerAndRepoAndSplitRefFromPath(i,o,u!=null?u:a);if(p===void 0)return;let f,g;if({owner:i,repo:o,ref:g,path:f}=p,u||a){if(f&&d&&a){const b=/L(?<start>\d+)(?:-L(?<end>\d+))?/.exec(d);if(b==null?void 0:b.groups){const{start:S,end:E}=b.groups;f+=`:${S}${E!==void 0?`-${E}`:""}`}}}else s?g={type:ke.Commit,id:s}:l&&(g={type:ke.PullRequest,id:l});const x=this.providerService.createVirtualUri("github",{repo:{owner:i,name:o},ref:g});return{name:(await this.getMetadata(x)).name,uri:x,location:r,filesToOpen:f?[f]:void 0}}createVirtualUri(e,{repo:r,ref:n,idx:i},o){const a=n!==void 0||i!==void 0?{v:du}:void 0;return a&&(n&&(a.ref={...n,type:n.type===ke.Branch||n.type===ke.Tag?ke.Tree:n.type}),i&&(a.idx=i)),e.with({authority:Dt.encodeAuthority("github",a),path:`/${r.owner}/${r.name}${(o==null?void 0:o.startsWith("/"))?o:o?`/${o}`:""}`})}getRemoteUri(e){const r=`https://github.com/${e.repo.owner}/${e.repo.name}`,n=e.path?"blob":"tree",i=e.path?`/${e.path}`:"";return e.clone?h.Uri.parse(`${r}.git`):e.pullRequest?h.Uri.parse(`${r}/pull/${e.pullRequest.id}`):e.branch?h.Uri.parse(`${r}/${n}/${e.branch}${i}`):e.tag?h.Uri.parse(`${r}/${n}/${e.tag}${i}`):e.sha?h.Uri.parse(`${r}/${n}/${e.sha}${i}`):h.Uri.parse(r)}getProviderRootUri(e){return HE(e)}getRelativeFilePath(e,r){const{path:n}=Oa(e),{path:i}=Oa(Ue(e,r));return n.length!==0&&i!==n&&i.startsWith(n)?i.slice(n.length+1):i}getVirtualUriMetadata(e){const{provider:r,name:n,repo:i,ref:o}=Oa(e);return{provider:r,name:n,repo:i,ref:o}}async getModeRefType(e,r){const{HEAD:n,pullRequest:i}=await(r!=null?r:this.getMetadata(e));switch(n.type){case he.Branch:return i!==void 0?q.PullRequestBranch:q.Branch;case he.RemoteBranch:return i!==void 0?q.PullRequestRemoteBranch:q.RemoteBranch;case he.Tag:return q.Tag;case he.Commit:return q.Commit}}async createBranch(e,r,n,i){try{const{repo:{owner:o,name:a}}=i!=null?i:await this.getMetadata(e);return r.startsWith("refs/heads/")||(r=`refs/heads/${r}`),(await this.request("POST /repos/{owner}/{repo}/git/refs",{owner:o,repo:a,ref:r,sha:n})).data.ref.substr(11)}catch(o){throw o instanceof ii&&o.status===422?o.message==="Reference already exists"?new fe(o,!0):new fe(o,!1):(C.error(o),o)}}async createAndPushCommit(e,r,n,i,o){var a;const s=new Be(`GitHub.createAndPushCommit(${e.toString()}${o?`, fork=${o.repo.owner}/${o.repo.name}`:""})`);if(n=n.filter(u=>u.fileType===h.FileType.File),n.length===0)throw s.stop({message:"Aborted; No changes to commit"}),new We("No changes to commit");let l;try{const u=await this.getMetadata(e);let d;if(i!==void 0)d=i;else{if(u.HEAD.detached&&!u.HEAD.branch)throw new ot("Unable to commit; no current branch");d=u.HEAD.branch.name}let p;if(o)p=`${o.repo.owner}/${o.repo.name}`;else if(u.HEAD.type===he.RemoteBranch&&u.HEAD.branch.remote.accessLevel>=Se.Write){const{owner:S,name:E}=u.HEAD.branch.remote.repo;p=`${S}/${E}`}else p=`${u.repo.owner}/${u.repo.name}`;const f=[],g=[];for(const S of n)switch(S.type){case ut.Created:case ut.Changed:f.push({path:S.path,contents:Jr(await S.content)});break;case ut.Deleted:g.push({path:S.path});break}const x={branch:{branchName:d,repositoryNameWithOwner:p},message:{headline:r},fileChanges:{additions:f,deletions:g},expectedHeadOid:u.HEAD.sha},y=`mutation($commitInput: CreateCommitOnBranchInput!) {
	createCommitOnBranch(input: $commitInput) {
		commit {
			oid
		}
		ref {
			name
		}
	}
}`,b=await this.graphql(y,{commitInput:x});if(l=b==null?void 0:b.createCommitOnBranch.commit.oid,!l)throw new Zt;return i===void 0&&!u.HEAD.detached&&l!==void 0&&await this.fastForwardTo(e,l,u),l}catch(u){if(u instanceof Ma){const d=(a=u.errors)==null?void 0:a[0];if((d==null?void 0:d.type)==="STALE_DATA"&&d.message.includes("Pull and try again"))throw new de(u)}throw C.error(u),u}finally{s.stop(l?{message:`: Created and pushed commit ${l}`}:void 0)}}async createCommit(e,r,n,i){const o=new Be(`GitHub.createCommit(${e.toString()}${i?`, fork=${i.repo.owner}/${i.repo.name}`:""})`);if(n=n.filter(s=>s.fileType===h.FileType.File),n.length===0)throw o.stop({message:"Aborted; No changes to commit"}),new We("No changes to commit");let a;try{const s=await this.getMetadata(e);let l,u,d;i?({repo:{owner:l,name:u}}=i,d=await this.getFileTree(this.createVirtualUri(e,i),s.HEAD.sha)):s.HEAD.type===he.RemoteBranch&&s.HEAD.branch.remote.accessLevel>=Se.Write?({owner:l,name:u}=s.HEAD.branch.remote.accessLevel===Se.WriteToPullRequest?s.repo:s.HEAD.branch.remote.repo,d=await this.getFileTree(this.createVirtualUri(e,{repo:s.HEAD.branch.remote.repo}),s.HEAD.sha)):({repo:{owner:l,name:u}}=s,d=await this.getFileTree(e,s.HEAD.sha));const p=await d.getTreeSha();if(!Jt(p))throw new Error(`Unable to create commit based on tree sha ${p}`);o.logStep("Creating Blobs",{message:`: Committing ${n.length} changes onto commit ${s.HEAD.sha} based on tree ${p}`,suffix:" \u2022 Creating blobs..."});const f=[];async function g(S){var E;try{const D=await this.request("POST /repos/{owner}/{repo}/git/blobs",{owner:l,repo:u,encoding:"base64",content:Jr(await S.content),mediaType:{format:"raw"}});let $;if(S.type===ut.Changed){const z=await d.get(S.path);$=(E=z==null?void 0:z.mode)!=null?E:"100644"}else $="100644";f.push({path:S.path,mode:$,type:"blob",sha:D.data.sha})}catch(D){throw C.error(D,`Failed to create blob for ${S.path}`),D}}c(g,"createOrUpdateBlob");const x=[];for(const S of n)switch(S.type){case ut.Created:case ut.Changed:{x.push(g.call(this,S));break}case ut.Deleted:{f.push({path:S.path,mode:"100644",type:"blob",sha:null});break}}await Promise.all(x),o.logStep("Creating tree",{message:`: Created ${x.length} blobs;`,suffix:` \u2022 Creating tree based on ${p}...`});const y=await this.request("POST /repos/{owner}/{repo}/git/trees",{owner:l,repo:u,base_tree:p,tree:f});return o.logStep("Creating commit",{message:`: Created tree ${y.data.sha};`,suffix:" \u2022 Creating commit..."}),a=(await this.request("POST /repos/{owner}/{repo}/git/commits",{owner:l,repo:u,message:r,tree:y.data.sha,parents:[s.HEAD.sha]})).data.sha,a}catch(s){throw C.error(s),s}finally{o.stop(a?{message:`: Created commit ${a}`}:void 0)}}async createPullRequest(e,r,n,i,o){var a,s,l;const u=new Be(`GitHub.createPullRequest(${e.toString()}, ${r}${o?`, fork=${o.repo.owner}/${o.repo.name}`:""})`);try{const{repo:{owner:d,name:p},HEAD:{branch:f},defaultBranch:g}=await this.getMetadata(e),x=await this.request("POST /repos/{owner}/{repo}/pulls",{owner:d,repo:p,base:`refs/heads/${(a=f==null?void 0:f.name)!=null?a:g.name}`,head:o?`${o.repo.owner}:${r}`:r,title:n,draft:(s=i==null?void 0:i.draft)!=null?s:!1,maintainer_can_modify:(l=i==null?void 0:i.canMaintainerModify)!=null?l:!0});return{id:x.data.number.toString(),uri:h.Uri.parse(x.data.html_url)}}catch(d){throw C.error(d),d}finally{u.stop()}}async fetch(e,r){const{fetched:n,metadata:i}=await this.fetchCore(e,!1,r);n&&await this.providerService.updateMetadata(e,i)}async fetchCore(e,r,n){var i,o,a,s,l,u,d,p,f;const{force:g,to:x}={...n,force:r||(n==null?void 0:n.force)},y=new Be(`GitHub.fetch(${e.toString()}, force=${g}, to=${x})`);let b;try{const S=await this.getMetadata(e);if(S.HEAD.detached)return b=" \u2022 Skipped; detached HEAD",{fetched:!1,metadata:S};const E=await this.getBranchTips(e);if(!E)throw b=" \u2022 Unable to fetch branch tips",new Qe(r);if(!g&&!x&&((i=E.defaultBranch)==null?void 0:i.sha)!==void 0&&E.defaultBranch.sha===S.defaultBranch.sha&&((o=E.branch)==null?void 0:o.sha)!==void 0&&E.branch.sha===S.HEAD.branch.sha&&(S.HEAD.sha===S.HEAD.branch.sha||S.state!==void 0))return b=" \u2022 No changes detected",{fetched:!1,metadata:S};let D;if(((a=E.defaultBranch)==null?void 0:a.sha)!==void 0&&E.defaultBranch.sha!==S.defaultBranch.sha&&(D={defaultBranch:{...S.defaultBranch,sha:E.defaultBranch.sha}}),((s=E.branch)==null?void 0:s.sha)===void 0){if(b=" \u2022 Unable to find branch tip",g)throw new Qe(r);return D!==void 0?{fetched:!0,metadata:{...S,...D}}:{fetched:!1,metadata:S}}if(E.branch.sha!==S.HEAD.branch.sha&&(D={...D,HEAD:{...S.HEAD,branch:{...S.HEAD.branch,sha:E.branch.sha},detached:void 0}}),E.branch.sha===((l=n==null?void 0:n.to)!=null?l:S.HEAD.sha))return b=" \u2022 Up to date",S.state!==void 0||D!==void 0?{fetched:!0,metadata:{...S,...D,state:void 0}}:{fetched:!1,metadata:S};y.logStep("Fetching upstream changes");try{const $=await this.getAheadBehindState(e,S,{base:(u=n==null?void 0:n.to)!=null?u:S.HEAD.sha,head:(f=(p=(d=D==null?void 0:D.HEAD)==null?void 0:d.branch)==null?void 0:p.sha)!=null?f:S.HEAD.branch.sha});return b=` \u2022 Changes detected; ${$==null?void 0:$.behind} commits behind`,{fetched:!0,metadata:{...S,...D,state:$?{ahead:$.ahead,behind:$.behind,incomingChanges:$.incomingChanges}:void 0}}}catch($){if(b=` \u2022 Failed fetching upstream changes; ${String($)}`,g)throw new Qe(r);return D!==void 0?{fetched:!0,metadata:{...S,...D}}:{fetched:!1,metadata:S}}}finally{y.stop(b?{suffix:b}:void 0)}}async fork(e){try{const{repo:{owner:r,name:n}}=await this.getMetadata(e),i=await this.request("POST /repos/{owner}/{repo}/forks",{owner:r,repo:n});let o;for(;;){try{if(o=await this.getRepositoryInfo(i.data.owner.login,i.data.name,!1),o!==void 0)break}catch{}await new Promise(a=>setTimeout(a,250))}return{name:`${i.data.owner.login}/${i.data.name}`,repo:{owner:i.data.owner.login,name:i.data.name},url:i.data.url}}catch(r){throw C.error(r),r}}async getBranches(e,r){var n,i,o;try{const{repo:{owner:a,name:s}}=await this.getMetadata(e),l=`query getBranches(
	$owner: String!
	$repo: String!
	$branchQuery: String!
	$cursor: String
	$limit: Int = 100
) {
	repository(owner: $owner, name: $repo) {
		refs(query: $branchQuery, refPrefix: "refs/heads/", first: $limit, after: $cursor) {
			pageInfo {
				endCursor
				hasNextPage
			}
			nodes {
				name
				target {
					oid
				}
			}
		}
	}
}`,u=await this.graphql(l,{owner:a,repo:s,branchQuery:(n=r==null?void 0:r.query)!=null?n:"",cursor:r==null?void 0:r.cursor,limit:Math.min(100,(i=r==null?void 0:r.limit)!=null?i:100)});if(u===void 0)return{branches:[]};const d=(o=u.repository)==null?void 0:o.refs;if(d===void 0)return{branches:[]};const p=d.nodes.map(f=>({type:Gn.Head,name:f.name,commit:f.target.oid,commitUrl:f.target.commitUrl}));return{paging:{cursor:d.pageInfo.endCursor,more:d.pageInfo.hasNextPage},branches:p}}catch(a){return{branches:[]}}}async getCommit(e,r){var n;try{const{HEAD:i,repo:{owner:o,name:a}}=await this.getMetadata(e),s=`query getCommit(
	$owner: String!
	$repo: String!
	$ref: GitObjectID!
) {
	repository(name: $repo owner: $owner) {
		object(oid: $ref) {
			...on Commit {
				oid
				message
				parents(first: 100) {
					nodes {
						oid
					}
				}
				author {
					date
					email
					name
				}
				committer {
					date
				}
			}
		}
	}
}`;r.toUpperCase()==="HEAD"&&(r=i.sha);const l=await this.graphql(s,{owner:o,repo:a,ref:r});if(l===void 0)return;const u=(n=l.repository)==null?void 0:n.object;return u===void 0?void 0:{hash:u.oid,message:u.message,parents:u.parents.nodes.map(d=>d.oid),authorDate:new Date(u.author.date),authorEmail:u.author.email,authorName:u.author.name,commitDate:new Date(u.committer.date)}}catch(i){return}}async getCommits(e,r){var n,i,o;try{const{HEAD:a,repo:{owner:s,name:l}}=await this.getMetadata(e),u=`query getCommits(
	$owner: String!
	$repo: String!
	$ref: GitObjectID!
	$path: String
	$cursor: String
	$limit: Int = 100
) {
	repository(name: $repo, owner: $owner) {
		object(oid: $ref) {
			... on Commit {
				history(first: $limit, path: $path, after: $cursor) {
					pageInfo {
						endCursor
						hasNextPage
					}
					nodes {
						... on Commit {
							...commit
						}
					}
				}
			}
		}
	}
}

fragment commit on Commit {
	oid
	message
	parents(first: 100) {
		nodes {
			oid
		}
	}
	author {
		date
		email
		name
	}
	committer {
		date
	}
}
`;let d=r==null?void 0:r.ref;(d==null?void 0:d.toUpperCase())==="HEAD"&&(d=a.sha);const p=await this.graphql(u,{owner:s,repo:l,ref:d,cursor:r==null?void 0:r.cursor,path:r==null?void 0:r.path,limit:Math.min(100,(n=r==null?void 0:r.limit)!=null?n:100)});if(p===void 0)return;const f=(o=(i=p.repository)==null?void 0:i.object)==null?void 0:o.history;if(f===void 0)return;const g=f.nodes.map(x=>({hash:x.oid,message:x.message,parents:x.parents.nodes.map(y=>y.oid),authorDate:new Date(x.author.date),authorEmail:x.author.email,authorName:x.author.name,commitDate:new Date(x.committer.date)}));return{paging:{cursor:f.pageInfo.endCursor,more:f.pageInfo.hasNextPage},commits:g}}catch(a){return}}async getBlobContent(e,r){try{const n=await this.request("GET /repos/{owner}/{repo}/git/blobs/{file_sha}",{owner:e.owner,repo:e.name,file_sha:r});return _c(n.data.content)}catch(n){throw C.logLevel===ie.Debug&&C.error(n),n}}async getFileContent(e,r,n){try{let i;if(r&&n&&!this.hasFileTree(e,r)){const o=this.providerService.getProviderRootUri(e);n.startsWith("/")&&(n=n.slice(1));let a=(0,X1.dirname)(n);(a==="."||a==="/")&&(a=""),i=await(await this.getFileTree(o,r,{path:a,cache:!1,recursive:!1})).get(n)}else{const[o,{path:a}]=await Promise.all([this.getFileTree(e,r),n?{path:void 0}:this.providerService.getMetadata(e)]);i=await o.get(n!=null?n:a)}if((i==null?void 0:i.sha)===void 0)throw h.FileSystemError.FileNotFound(e);return await i.getContent()}catch(i){throw C.logLevel===ie.Debug&&C.error(i),i}}async getFileList(e,r,n){const i=new Be(`GitHub.getFileList(${e.toString()}${n?`, ${n}`:""})`);try{const{repo:{owner:o,name:a},HEAD:{sha:s}}=await this.getMetadata(e),l=await this.request("GET /repos/{owner}/{repo}/git/tree-file-list/{treeish}",{owner:o,repo:a,treeish:`${n!=null?n:s}${r?`:${r}`:""}`});return l.status!==200?[]:l.data}catch(o){return C.error(o),[]}finally{i.stop()}}hasFileTree(e,r){return r?this.fileTreeCache.has(this.asFileTreeKey(e,r)):this.getMetadata(e).then(n=>this.fileTreeCache.has(this.asFileTreeKey(e,n.HEAD.sha)))}async getFileTree(e,r,n){var i,o,a,s,l;const u=this.providerService.isInWorkspace(e);let d=(i=n==null?void 0:n.cache)!=null?i:u,p,f,g;if(d||!r){const S=(a=(o=n==null?void 0:n.prefetched)==null?void 0:o.metadata)!=null?a:this.getMetadata(e);p=u?this.getFileTreePermissions(e,S):void 0;let E;({repo:f,HEAD:{sha:E},timestamp:g}=(s=n==null?void 0:n.prefetched)!=null?s:await S),r&&E!==r?(d=!1,g=Date.now()):r=E}else({repo:f}=(l=n==null?void 0:n.prefetched)!=null?l:this.providerService.getVirtualUriMetadata(e)),g=Date.now();const x=this.asFileTreeKey(e,r),y=this.providerService.getProviderRootUri(e),b=new Be(`GitHub.getFileTree(${x}): ${e.toString()}`,{log:!1,logLevel:ie.Debug});try{let S=c(function(){var D;const $=new Be(`GitHub.createFileTree(${x})`);let z,re;d&&u&&(z=new h.EventEmitter,re=h.Disposable.from(this.tarPit.onDidChangeIndexingEnablement(()=>z.fire()),this.tarPit.onDidDownloadTar(ee=>z.fire({rootUri:this.providerService.getProviderRootUri(ee.rootUri),sha:ee.sha}))));const ne={dispose:()=>re==null?void 0:re.dispose(),permissions:p,getContent:ee=>this.getBlobContent(f,ee.sha),getTree:async(ee,we)=>{const oe=await this.request("GET /repos/{owner}/{repo}/git/trees/{tree_sha}",{owner:f.owner,repo:f.name,recursive:we?"1":void 0,tree_sha:`${r}${ee?`:${ee}`:""}`});return oe.data.truncated?{sha:oe.data.sha,truncated:!0}:{sha:oe.data.sha,truncated:!1,tree:se(oe.data.tree,ge=>{var Ee;return{path:ge.path,item:{mode:ge.mode,sha:ge.sha,stat:{type:WE(ge.type),size:(Ee=ge.size)!=null?Ee:0,ctime:0,mtime:g,permissions:void 0}}}})}},onDidTriggerContentCaching:z==null?void 0:z.event,tryCachingContent:d&&u?async ee=>{const we=P.get("experimental.fs.useTars");if(we!=="always"&&we!=="ifAvailable")return!1;const oe=new Be(`FileTree.loadAllContent(${r})`);let ge;try{let Ee;if(we==="ifAvailable"){if(oe.logStep("Tar cache query"),Ee=await this.tarPit.getCachedTar(y,r),Ee===void 0)return ge=" \u2022 No cached Tar",!1}else oe.logStep("Tar query"),Ee=await this.tarPit.getTar(y,r);oe.logStep("Updating content",{suffix:" \u2022 Updating content..."});for(const et of Ee.entries){const ae=ee(et.header.fullFileName);if(ae===void 0)continue;const Re=et.dataAsBytes;ae.getContent=()=>Re}return!0}catch(Ee){return ge=` \u2022 Failed ${String(Ee)}`,!1}finally{oe.stop(ge?{suffix:ge}:void 0)}}:void 0};try{return new ep(y,r,g,ne,{path:n==null?void 0:n.path,recursive:(D=n==null?void 0:n.recursive)!=null?D:d,preload:d||(n==null?void 0:n.recursive)})}catch(ee){return C.error(ee),new ep(y,r,g,void 0)}finally{$.stop()}},"createFileTree"),E=this.fileTreeCache.get(x);return E!==void 0||(E=S.call(this),d&&this.fileTreeCache.set(x,E)),E}finally{b.stop()}}async getFileTreePermissions(e,r){if(this.providerService.getModeConfig(e,await this.getModeRefType(e,r)).display===M.Edit)return;const i=await this.providerService.getIndexMetadata(e);return Nt.isActive(i)?h.FilePermission.Readonly:void 0}async getFork(e){var r,n,i;try{const{repo:{owner:o,name:a}}=await this.getMetadata(e),s=`query getFork(
	$owner: String!
	$repo: String!
) {
	repository(owner: $owner, name: $repo) {
		forks(affiliations: OWNER, first: 1) {
			nodes {
				owner {
					login
				}
				name
				url
			}
		}
	}
}`,l=await this.graphql(s,{owner:o,repo:a});if(l===void 0)return;const[u]=(i=(n=(r=l.repository)==null?void 0:r.forks)==null?void 0:n.nodes)!=null?i:[];return u===void 0?void 0:{name:`${u.owner.login}/${u.name}`,repo:{owner:u.owner.login,name:u.name},url:u.url}}catch(o){return}}async getIncomingChanges(e){var r,n;return(n=(r=(await this.getMetadata(e)).state)==null?void 0:r.incomingChanges)!=null?n:[]}async compareCommits(e,r){const n=await this.getMetadata(e),i=await this.getAheadBehindState(e,n,{base:r.base,head:r.compare});return i==null?void 0:i.incomingChanges}async getAheadBehindState(e,r,n){var i,o,a,s,l;const{base:u,head:d}={base:r.HEAD.sha,head:(i=r.HEAD.branch)==null?void 0:i.sha,...n},p=new Be(`GitHub.getAheadBehindState(${e.toString()}, base=${u}, head=${d})`);let f,g;try{if(!d){f=` \u2022 Skipped; Unsupported HEAD type (${r.HEAD.type})`;return}const x=await this.request("GET /repos/{owner}/{repo}/compare/{base}...{head}",{owner:r.repo.owner,repo:r.repo.name,base:u,head:d}),y=[];for(const b of(o=x.data.files)!=null?o:[])switch(b.status){case"added":case"copied":y.push({uri:h.Uri.joinPath(e,b.filename),type:ut.Created});break;case"removed":y.push({uri:h.Uri.joinPath(e,b.filename),type:ut.Deleted});break;case"modified":y.push({uri:h.Uri.joinPath(e,b.filename),type:ut.Changed});break;case"renamed":y.push({uri:h.Uri.joinPath(e,b.filename),type:ut.Created}),y.push({uri:h.Uri.joinPath(e,b.previous_filename),type:ut.Deleted});break;default:C.warn(`GitHub.getAheadBehindState(${e.toString()}, base=${u}, head=${d}): Unknown file status encountered '${b.status}'`);break}return g={ahead:(a=x.data.behind_by)!=null?a:0,behind:(s=x.data.ahead_by)!=null?s:0,incomingChanges:y},g}catch(x){throw f=` \u2022 Failed; ${String(x)}`,C.error(x),x}finally{p.stop({suffix:f!=null?f:` \u2022 ${(l=g==null?void 0:g.behind)!=null?l:0} commits behind`})}}async getObjectDetails(e,r,n){var i;try{const o=await this.getFileTree(e,r);n?n=this.providerService.getRelativeFilePath(e,this.providerService.createRelativeUri(e,n)):{path:n}=await this.providerService.getMetadata(e);const a=await o.get(n);if((a==null?void 0:a.mode)===void 0||(a==null?void 0:a.sha)===void 0)throw new Error(`Cannot get details of ${n} in ${r}`);return{mode:a.mode,object:a.sha,size:(i=a.stat.size)!=null?i:0}}catch(o){throw C.error(o),o}}async getPullRequest(e,r){const{repo:{owner:n,name:i}}=await this.getMetadata(e);return this.getPullRequestCore(n,i,r)}async getPullRequestCore(e,r,n){var i,o,a,s,l,u,d;try{const p=`query getPullRequest(
	$owner: String!
	$repo: String!
	$pr: Int!
) {
	repository(name: $repo, owner: $owner) {
		pullRequest(number: $pr) {
			author {
				login
				avatarUrl
				url
			}
			permalink
			number
			title
			state
			updatedAt
			closedAt
			mergedAt
			repository {
				name
				owner {
					login
				}
			}
			baseRef {
				name
			}
			baseRefName
			baseRefOid
			baseRepository {
				name
				owner {
					login
				}
			}
			headRef {
				name
			}
			headRefName
			headRefOid
			headRepository {
				name
				owner {
					login
				}
			}
			headRepositoryOwner {
				login
			}
		}
	}
}`,f=await this.graphql(p,{owner:e,repo:r,number:Number(n)}),g=(i=f==null?void 0:f.repository)==null?void 0:i.pullRequest;return g?{author:{name:g.author.login,avatarUrl:g.author.avatarUrl,url:g.author.url},closedAt:g.closedAt?new Date(g.closedAt):void 0,mergedAt:g.mergedAt?new Date(g.mergedAt):void 0,id:g.number.toString(),repo:{name:g.repository.name,owner:g.repository.owner.login},state:np(g.state),title:g.title,updatedAt:new Date(g.updatedAt),url:g.permalink,refs:{base:{owner:g.baseRepository.owner.login,repo:g.baseRepository.name,branch:g.baseRefName,sha:g.baseRefOid,exists:g.baseRef!=null},head:{owner:(l=(s=(o=g.headRepository)==null?void 0:o.owner.login)!=null?s:(a=g.headRepositoryOwner)==null?void 0:a.login)!=null?l:"<unknown>",repo:(d=(u=g.headRepository)==null?void 0:u.name)!=null?d:g.baseRepository.name,branch:g.headRefName,sha:g.headRefOid,exists:g.headRef!=null}}}:void 0}catch(p){C.error(p);return}}async getPullRequestForBranch(e,r,n){var i,o,a,s,l;try{const{repo:{owner:u,name:d}}=await this.getMetadata(e),p=`query getPullRequestForBranch(
	$owner: String!
	$repo: String!
	$branch: String!
	$maxCount: Int!
	$states: [PullRequestState!]
) {
	repository(name: $repo, owner: $owner) {
		refs(query: $branch, refPrefix: "refs/heads/", first: 1) {
			nodes {
				associatedPullRequests(first: $maxCount, orderBy: {field: UPDATED_AT, direction: DESC}, states: $states) {
					nodes {
						author {
							login
							avatarUrl
							url
						}
						permalink
						number
						title
						state
						updatedAt
						closedAt
						mergedAt
						repository {
							isFork
							name
							owner {
								login
							}
						}
					}
				}
			}
		}
	}
}`,f=await this.graphql(p,{owner:u,repo:d,branch:r,maxCount:(i=n==null?void 0:n.maxCount)!=null?i:1,states:zE(n==null?void 0:n.include)}),g=(l=(s=(a=(o=f==null?void 0:f.repository)==null?void 0:o.refs.nodes[0])==null?void 0:a.associatedPullRequests)==null?void 0:s.nodes)==null?void 0:l.filter(y=>!y.repository.isFork||y.repository.owner.login===u);if(g==null||g.length===0)return;g.length>1&&g.sort((y,b)=>(y.repository.owner.login===u?-1:1)-(b.repository.owner.login===u?-1:1)||(y.state==="OPEN"?-1:1)-(b.state==="OPEN"?-1:1)||new Date(b.updatedAt).getTime()-new Date(y.updatedAt).getTime());const[x]=g;return{author:{name:x.author.login,avatarUrl:x.author.avatarUrl,url:x.author.url},closedAt:x.closedAt?new Date(x.closedAt):void 0,mergedAt:x.mergedAt?new Date(x.mergedAt):void 0,id:x.number.toString(),repo:{name:x.repository.name,owner:x.repository.owner.login},state:np(x.state),title:x.title,updatedAt:new Date(x.updatedAt),url:x.permalink}}catch(u){C.error(u);return}}async getTags(e,r){var n,i,o;try{const{repo:{owner:a,name:s}}=await this.getMetadata(e),l=`query getTags(
	$owner: String!
	$repo: String!
	$tagQuery: String!
	$cursor: String
	$limit: Int = 100
) {
	repository(owner: $owner, name: $repo) {
		refs(query: $tagQuery, refPrefix: "refs/tags/", first: $limit, after: $cursor, orderBy: { field: TAG_COMMIT_DATE, direction: DESC }) {
			pageInfo {
				endCursor
				hasNextPage
			}
			nodes {
				name
				target {
					oid
				}
			}
		}
	}
}`,u=await this.graphql(l,{owner:a,repo:s,tagQuery:(n=r==null?void 0:r.query)!=null?n:"",cursor:r==null?void 0:r.cursor,limit:Math.min(100,(i=r==null?void 0:r.limit)!=null?i:100)});if(u===void 0)return{tags:[]};const d=(o=u.repository)==null?void 0:o.refs;if(d===void 0)return{tags:[]};const p=d.nodes.map(f=>({type:Gn.Tag,name:f.name,commit:f.target.oid,commitUrl:f.target.commitUrl}));return{paging:{cursor:d.pageInfo.endCursor,more:d.pageInfo.hasNextPage},tags:p}}catch(a){return{tags:[]}}}async getTarGz(e){const{repo:{owner:r,name:n},HEAD:{sha:i}}=await this.getMetadata(e),o=await this.ensureAuthenticated();return h.window.withProgress({location:h.ProgressLocation.Notification,cancellable:!0,title:Ba("fetching index","Fetching search index...")},async(a,s)=>{try{if(An){let d=`https://vscode.dev/indexes/github2/${r}/${n}/${i}`;try{const x=await this.tarballProxyEndpoint;x!==void 0&&(d=x.replace("{owner}",r).replace("{repo}",n).replace("{sha}",i))}catch{}const f=await(await jh(d,{headers:{"x-proxy-authorization":`Bearer ${o.accessToken}`},credentials:"include"},s)).text(),g=await jh(f,{},s);return new Uint8Array(await g.arrayBuffer())}const l=`https://api.github.com/repos/${r}/${n}/tarball/${i}`,u=await jh(l,{headers:{Authorization:`Bearer ${o.accessToken}`}},s);return new Uint8Array(await u.arrayBuffer())}catch(l){throw C.error(l),l}})}async pushCommit(e,r,n,i){const o=new Be(`GitHub.pushCommit(${e.toString()}, sha=${r}${n?`, ref=${n}`:""}${i?`, fork=${i.repo.owner}/${i.repo.name}`:""})`);let a;try{const s=await this.getMetadata(e);let l,u;if(i?{repo:{owner:l,name:u}}=i:s.HEAD.type===he.RemoteBranch&&s.HEAD.branch.remote.accessLevel>=Se.Write?{owner:l,name:u}=s.HEAD.branch.remote.repo:{repo:{owner:l,name:u}}=s,n===void 0&&s.HEAD.detached)throw new ot("Unable to commit; no current branch");(n==null?void 0:n.startsWith("refs/heads/"))&&(n=n.substr(11));const d=await this.request("PATCH /repos/{owner}/{repo}/git/refs/{ref}",{owner:l,repo:u,ref:`heads/${n!=null?n:s.HEAD.branch.name}`,sha:r});return n===void 0&&!s.HEAD.detached&&await this.fastForwardTo(e,r,s),a=d.data.ref,a}catch(s){throw s instanceof ii&&s.status===422&&s.message.includes("Update is not a fast forward")?new de(s):(C.error(s),s)}finally{o.stop(a?{message:`: Pushed commit to ${a}`}:void 0)}}async queryRepositoryObject(e,r,n,i){var o,a;try{const{repo:{owner:s,name:l},HEAD:{sha:u},path:d}=await this.providerService.getMetadata(e),p=`query ${r}(
	$owner: String!
	$repo: String!
	$expression: String
) {
	repository(owner: $owner, name: $repo) {
		object(expression: $expression) {
			${n}
		}
	}
}`,f=await this.graphql(p,{owner:s,repo:l,expression:i!=null?i:`${u}:${d}`});return(a=(o=f==null?void 0:f.repository)==null?void 0:o.object)!=null?a:void 0}catch(s){C.error(s);return}}async repositoryObjectExists(e,r){return await this.queryRepositoryObject(e,"exists","			__typename",r)!==void 0}async searchPullRequestsQuery(e,r){try{let n=c(function(s,l){return{number:s.number,title:s.title,repoWithOwner:s.repository.nameWithOwner,reasons:l?[l]:[],url:s.url}},"toResult");const i=`query searchPullRequests(
	$authored: String!
	$assigned: String!
	$reviewRequested: String!
	$mentioned: String!
) {
	viewer {
		repositories(first: 100, orderBy: { field: STARGAZERS, direction: DESC }) {
			nodes {
				pullRequests(first: 100, states: OPEN, orderBy: { field: UPDATED_AT, direction: DESC }) {
					nodes {
						number
						title
						url
						repository {
							nameWithOwner
						}
					}
				}
			}
		}
	}
	authored: search(first: 100, query: $authored, type: ISSUE) {
		nodes {
			...on PullRequest {
				number
				title
				url
				repository {
					nameWithOwner
				}
			}
		}
	}
	assigned: search(first: 100, query: $assigned, type: ISSUE) {
		nodes {
			...on PullRequest {
				number
				title
				url
				repository {
					nameWithOwner
				}
			}
		}
	}
	reviewRequested: search(first: 100, query: $reviewRequested, type: ISSUE) {
		nodes {
			...on PullRequest {
				number
				title
				url
				repository {
					nameWithOwner
				}
			}
		}
	}
	mentioned: search(first: 100, query: $mentioned, type: ISSUE) {
		nodes {
			...on PullRequest {
				number
				title
				url
				repository {
					nameWithOwner
				}
			}
		}
	}
}`;e=e.trim(),(r==null?void 0:r.user)&&(e+=` user:${r.user}`);const o=await this.graphql(i,{authored:(e?`${e} is:pr is:open archived:false author:@me`:"is:pr is:open archived:false author:@me").trim(),assigned:(e?`${e} is:pr is:open archived:false assignee:@me`:"is:pr is:open archived:false assignee:@me").trim(),reviewRequested:(e?`${e} is:pr is:open archived:false review-requested:@me`:"is:pr is:open archived:false review-requested:@me").trim(),mentioned:(e?`${e} is:pr is:open archived:false mentions:@me`:"is:pr is:open archived:false mentions:@me").trim()});return o===void 0?[]:Qf([...o.assigned.nodes.map(s=>n(s,"assigned")),...o.reviewRequested.nodes.map(s=>n(s,"review requested")),...o.mentioned.nodes.map(s=>n(s,"mentioned")),...o.authored.nodes.map(s=>n(s,"authored")),...k(o.viewer.repositories.nodes,s=>s.pullRequests.nodes.map(l=>n(l)))],s=>s.url,(s,l)=>(l.reasons.length!==0&&s.reasons.push(...l.reasons),s))}catch(n){return[]}}async searchRepositoriesQuery(e,r){try{const n=`query searchRepositories(
	$search: String!
) {
	viewer {
		repositories(first: 100, orderBy: { field: UPDATED_AT, direction: DESC }) {
			nodes {
				nameWithOwner
				description
				url
				parent {
					nameWithOwner
				}
				stargazerCount
			}
		}
	}
	search(first: 100, query: $search, type: REPOSITORY) {
		nodes {
			...on Repository {
				nameWithOwner
				description
				url
				parent {
					nameWithOwner
				}
				stargazerCount
			}
		}
	}
}`;(r==null?void 0:r.user)&&(e+=` user:${r.user}`),(r==null?void 0:r.sort)&&(e+=` sort:${r.sort}`),e+=" fork:true";const i=await this.graphql(n,{search:e.trim()});return i===void 0?[]:Qf((r==null?void 0:r.user)?[...i.search.nodes,...i.viewer.repositories.nodes]:[...i.viewer.repositories.nodes,...i.search.nodes],a=>a.url).map(a=>{var s,l,u;return{repoWithOwner:a.nameWithOwner,description:(s=a.description)!=null?s:void 0,url:a.url,fork:(u=(l=a.parent)==null?void 0:l.nameWithOwner)!=null?u:void 0,stars:a.stargazerCount}})}catch(n){return[]}}async searchCodeQuery(e,r,n){var i,o,a;const{repo:{owner:s,name:l},HEAD:u,defaultBranch:d}=await this.getMetadata(r),p=[];((i=u.branch)==null?void 0:i.name)!==d.name&&p.push(Ba("Cant search branch","Unable to search {0} without index, falling back to {1}.",(a=(o=u.branch)==null?void 0:o.name)!=null?a:u.detached.name,d.name));try{const g=await(await this.octokit({request:{headers:{authorization:`Bearer ${(await this.ensureAuthenticated()).accessToken}`,accept:"application/vnd.github.v3.text-match+json"}}})).request("GET /search/code",{q:`${e} repo:${s}/${l}`}),x=new h.Range(0,0,0,0),y=[];let b=0,S;for(const E of g.data.items)for(const D of E.text_matches){if(b++,n.maxResults!==void 0&&b>n.maxResults)return{matches:y,limitHit:!0};S={path:E.path,ranges:[],preview:D.fragment,matches:[]};for(const $ of D.matches){let z=0,re=0,ne=0;for(let ee=0;ee<$.indices[1];ee++)ee===$.indices[0]&&(re=ne),D.fragment[ee]===`
`?(z++,ne=0):ne++;S.ranges.push(x),S.matches.push(new h.Range(z,re,z,ne))}y.push(S)}return{matches:y,limitHit:!1,warnings:p}}catch(f){return{matches:[],limitHit:!0}}}async switchTo(e,r,n){const{name:i,repo:o,HEAD:{branch:a}}=await this.getMetadata(e);let s;if(!(r!==void 0&&(typeof r=="string"?(r==null?void 0:r.startsWith("refs/heads/"))?(s={type:ke.Tree,id:r.substr(11)},r=r.substr(11)):(r==null?void 0:r.startsWith("refs/tags/"))?s={type:ke.Tree,id:r.substr(10)}:s={type:ke.Tree,id:r}:s={...r,type:r.type===ke.Branch||r.type===ke.Tag?ke.Tree:r.type},(a==null?void 0:a.name)===s.id)))return{name:i,uri:this.providerService.createVirtualUri(e,{repo:o,ref:s}),location:(n==null?void 0:n.openInNewWindow)?$t.NewWindow:$t.CurrentWindow}}async sync(e,r,n){var i,o,a,s,l,u;const d=new Be(`GitHub.sync(${e.toString()}, resolution=${n.conflictResolution}, to=${n.to})`);let p;try{const{metadata:f}=await this.fetchCore(e,!0,{to:n.to});if(f.HEAD.detached){p=" \u2022 Skipped; detached HEAD";return}if(((o=(i=f==null?void 0:f.state)==null?void 0:i.behind)!=null?o:0)>0&&await r.hasChanges(e)){d.logStep("Fetching upstream changes");const g=[],x=(s=(a=f.state)==null?void 0:a.incomingChanges)!=null?s:[];if(x.length>0){const y=await r.getChanges(e);for(const b of y){const S=this.providerService.getRelativeFilePath(e,b.uri),E=x.find(D=>D.uri.path===S);if(E!==void 0){g.push({path:S,current:b,incomingType:E.type});break}}}if(g.length>0)switch(n.conflictResolution){case Br.KeepCurrent:d.logStep("Syncing (keep) upstream changes",{message:`: ${g.length} conflicts; \u2022`,suffix:" \u2022 Syncing (keep) upstream changes..."});for(const y of g)await r.keep(y.current.uri,{type:y.incomingType,providerUri:rp(f,f.HEAD.branch.sha,y.path)});break;case Br.DiscardCurrent:d.logStep("Syncing (discard) upstream changes",{message:`: ${g.length} conflicts; \u2022`,suffix:" \u2022 Syncing (discard) upstream changes..."});for(const y of g)await r.discard(y.current.uri);break;case Br.Merge:d.logStep("Syncing (merge) upstream changes",{message:`: ${g.length} conflicts; \u2022`,suffix:" \u2022 Syncing (merge) upstream changes..."});for(const y of g)await r.merge(y.current.uri,{type:y.incomingType,providerUri:rp(f,f.HEAD.branch.sha,y.path)},{providerUri:rp(f,f.HEAD.sha,y.path)});break;case Br.Abort:default:throw d.logStep("Syncing (abort) upstream changes",{message:`: ${g.length} conflicts; \u2022`,suffix:" \u2022 Syncing (abort) upstream changes..."}),await this.providerService.updateMetadata(e,f),new mt}}p=` \u2022 to=${(l=n.to)!=null?l:f.HEAD.branch.sha}`,await this.fastForwardTo(e,(u=n.to)!=null?u:f.HEAD.branch.sha,f)}finally{d.stop(p?{suffix:p}:void 0)}}async fastForwardTo(e,r,n){if(n.HEAD.detached)throw new ot("Unable to fast-forward; no current branch");if(n.HEAD.sha===r&&n.state===void 0)return;const i=this.asFileTreeKey(e,n.HEAD.sha),o=this.fileTreeCache.get(i);this.fileTreeCache.delete(i),o==null||o.dispose(),C.log(`Fast forward to ${r}; rootUri=${e.toString()}`),await this.providerService.updateMetadata(e,{...n,HEAD:{...n.HEAD,detached:void 0,sha:r},state:r!==n.HEAD.branch.sha?n.state:void 0,timestamp:Date.now()}),r!==n.HEAD.branch.sha&&n.state===void 0&&await this.fetchCore(e,!1,{to:r})}async getBranchTips(e,r){try{const{repo:{owner:n,name:i},HEAD:o}=await this.getMetadata(e);r===void 0&&(o.type===he.RemoteBranch?r=`${o.branch.remote.repo.owner}/${o.branch.remote.repo.name}:refs/heads/${o.branch.name}`:r=o.branch?`refs/heads/${o.branch.name}`:"");const a=py.exec(r);if(a==null?void 0:a.groups)return this.getRemoteBranchTips(n,i,r);const s=`query getBranchTips(
	$owner: String!
	$repo: String!
	$ref: String!
) {
	repository(owner: $owner, name: $repo) {
		defaultBranchRef {
			target {
				oid
			}
		}
		ref(qualifiedName: $ref) {
			target {
				oid
			}
		}
	}
}`,l=await this.graphql(s,{owner:n,repo:i,ref:r});if((l==null?void 0:l.repository)==null)return;const{defaultBranchRef:u,ref:d}=l.repository;return!u&&!d?void 0:{defaultBranch:u?{sha:u.target.oid}:void 0,branch:d?{sha:d.target.oid}:void 0}}catch(n){return}}async getRemoteBranchTips(e,r,n){try{const i=py.exec(n);if((i==null?void 0:i.groups)==null)return;let{remoteOwner:o,remoteRepo:a,remoteRef:s}=i.groups;a||(a=r);const l=`query getRemoteBranchTips(
	$owner: String!
	$repo: String!
	$remoteOwner: String!
	$remoteRepo: String!
	$remoteRef: String!
) {
	repository(owner: $owner, name: $repo) {
		defaultBranchRef {
			target {
				oid
			}
		}
	}
	remote: repository(owner: $remoteOwner, name: $remoteRepo) {
		ref(qualifiedName: $remoteRef) {
			target {
				oid
			}
		}
	}
}`,u=await this.graphql(l,{owner:e,repo:r,remoteOwner:o,remoteRepo:a,remoteRef:s});if((u==null?void 0:u.repository)==null||(u==null?void 0:u.remote)==null)return;const{repository:{defaultBranchRef:d},remote:{ref:p}}=u;return!d&&!p?void 0:{defaultBranch:d?{sha:d.target.oid}:void 0,branch:p?{sha:p.target.oid}:void 0}}catch(i){return}}async getRepositoryInfo(e,r,n,i){var o,a,s,l,u,d,p,f,g,x,y,b,S,E,D,$;try{const z=`number
title
state
maintainerCanModify
baseRef { name }
baseRefName
baseRefOid
baseRepository {
	name
	owner { login }
	defaultBranchRef {
		name
		target { oid }
	}
	viewerPermission
}
headRef { name }
headRefName
headRefOid
headRepository {
	name
	owner { login }
	defaultBranchRef {
		name
		target { oid }
	}
	viewerPermission
}
mergeCommit { oid }
`,re=`query getRepository(
	$owner: String!
	$repo: String!
	$ref: String = ""
	$has_pr: Boolean!
	$pr: Int = 0
) {
	viewer { login }
	repository(owner: $owner, name: $repo) {
		name
		owner { login }
		defaultBranchRef {
			name
			target { oid }
		}
		ref(qualifiedName: $ref) {
			name
			prefix
			target { oid }
		}
		viewerPermission
		pullRequest(number: $pr) @include(if: $has_pr) {
			${z}
		}
	}
}`;let ne,ee;try{const Ee=await this.graphql(re,{owner:e,repo:r,ref:(i==null?void 0:i.ref)!=="HEAD"?i==null?void 0:i.ref:void 0,has_pr:Boolean(i==null?void 0:i.pr),pr:(o=i==null?void 0:i.pr)!=null?o:0});if((Ee==null?void 0:Ee.repository)==null)return;({repository:ee,viewer:{login:ne}}=Ee)}catch(Ee){if((i==null?void 0:i.pr)&&Ee instanceof Ma&&((s=(a=Ee.errors)==null?void 0:a[0])==null?void 0:s.type)==="NOT_FOUND"&&((l=Ee.errors[0])==null?void 0:l.message.includes("Could not resolve to a PullRequest"))){({repository:ee,viewer:{login:ne}}=Ee.data);try{const et=await this.graphql(`query getPullRequestFromParentRepository(
	$owner: String!
	$repo: String!
	$pr: Int!
) {
	repository(owner: $owner, name: $repo) {
		parent {
			pullRequest(number: $pr) {
				${z}
			}
		}
	}
}`,{owner:e,repo:r,pr:i==null?void 0:i.pr});if(((d=(u=et==null?void 0:et.repository)==null?void 0:u.parent)==null?void 0:d.pullRequest)==null)throw Ee;ee.pullRequest=et.repository.parent.pullRequest}catch{throw Ee}}else throw Ee}const we=(p=ee.defaultBranchRef)!=null?p:void 0;if((we==null?void 0:we.name)==null)return;const oe=ee.pullRequest;let ge;if(ee==null?void 0:ee.ref)ge={prefix:ee.ref.prefix,name:ee.ref.name,sha:ee.ref.target.oid};else if(oe==null?void 0:oe.headRef){let Ee=ip(oe.headRepository.viewerPermission);Ee<Se.Write&&oe.maintainerCanModify&&ip(ee.viewerPermission)>=Se.Write&&(Ee=Se.WriteToPullRequest),ge=oe.headRepository.owner.login===e?{prefix:"refs/heads/",name:oe==null?void 0:oe.headRef.name,sha:(g=(f=oe.mergeCommit)==null?void 0:f.oid)!=null?g:oe==null?void 0:oe.headRefOid}:{prefix:"refs/remotes/",name:oe==null?void 0:oe.headRef.name,sha:(y=(x=oe.mergeCommit)==null?void 0:x.oid)!=null?y:oe==null?void 0:oe.headRefOid,remote:{name:`${oe.headRepository.owner.login}/${oe.headRepository.name}`,accessLevel:Ee,repo:{owner:oe.headRepository.owner.login,name:oe.headRepository.name}}}}else(oe==null?void 0:oe.baseRef)?(ge={prefix:"refs/heads/",name:oe==null?void 0:oe.baseRef.name,sha:(S=(b=oe.mergeCommit)==null?void 0:b.oid)!=null?S:oe==null?void 0:oe.baseRefOid},n&&(C.log("Did not find a headRef for PR, falling back to baseRef",oe.baseRef),Fr.showPullRequestHeadNotFoundMessage(`${e}/${r}`,`#${i==null?void 0:i.pr}`))):(i==null?void 0:i.ref)==="HEAD"&&(ge={prefix:"refs/heads/",name:we.name,sha:we.target.oid});return{user:ne,repo:{owner:ee.owner.login,name:ee.name},accessLevel:ip(ee.viewerPermission),ref:ge,defaultBranch:{name:we.name,sha:we.target.oid},pullRequest:oe?{id:oe.number.toString(),state:np(oe.state),title:oe.title}:void 0}}catch(z){if(z instanceof Ma)switch((D=(E=z.errors)==null?void 0:E[0])==null?void 0:D.type){case"NOT_FOUND":{if((i==null?void 0:i.pr)&&(($=z.errors[0])==null?void 0:$.message.includes("Could not resolve to a PullRequest"))){const ne=new Je(z,`${e}/${r}`,`#${i==null?void 0:i.pr}`);throw n&&Fr.showPullRequestNotFoundMessage(ne.name,ne.id),ne}const re=new gt(z,`${e}/${r}`);throw n&&Fr.showRepositoryNotFoundMessage(re.name),re}case"FORBIDDEN":{const re=new te(z,`${e}/${r}`);throw n&&Fr.showRepositoryForbiddenMessage(re.name),re}}C.error(z,`Failed to get repository info for '${e}/${r}'`),!this.handleRequestErrors(z)&&n&&Fr.showUnableToOpenRepositoryMessage(z);return}}async validateOwnerAndRepoAndSplitRefFromPath(e,r,n){try{const i=await this.request(`GET /repos/{owner}/{repo}/git/extract-ref/${n!=null?n:"HEAD"}`,{owner:e,repo:r});return[e,r]=i.data.name_with_owner.split("/"),n?{owner:e,repo:r,ref:{type:ke.Tree,id:i.data.ref},path:i.data.path}:{owner:e,repo:r}}catch(i){if(i instanceof ii)switch(i.status){case 401:throw new nt(i,()=>void this.reauthenticate());case 403:throw new te(i,`${e}/${r}`);case 404:throw new gt(i,`${e}/${r}`);case 409:throw new Ge(i,`${e}/${r}`)}return}}asFileTreeKey(e,r){return`${ue(this.providerService.getProviderRootUri(e))}:${r}`}}c(hu,"GitHubRepositoryProvider"),hy([Sr()],hu.prototype,"ensureAuthenticated",1),hy([Sr()],hu.prototype,"octokit",1);function np(t){switch(t){case"OPEN":return Ae.Open;case"CLOSED":return Ae.Closed;case"MERGED":return Ae.Merged}}c(np,"toPullRequestState");function zE(t){if(t!==void 0)return t.map(e=>{switch(e){case Ae.Open:return"OPEN";case Ae.Closed:return"CLOSED";case Ae.Merged:return"MERGED"}})}c(zE,"fromPullRequestStates");var Oo;(function(t){t.ADMIN="ADMIN",t.MAINTAIN="MAINTAIN",t.WRITE="WRITE",t.TRIAGE="TRIAGE",t.READ="READ",t.NONE="NONE"})(Oo||(Oo={}));function ip(t){switch(t){case Oo.ADMIN:return Se.Admin;case Oo.MAINTAIN:return Se.Maintain;case Oo.WRITE:return Se.Write;case Oo.TRIAGE:return Se.Triage;case Oo.READ:return Se.Read;default:return Se.None}}c(ip,"permissionToAccessLevel");function WE(t){switch(t&&(t=t.toLocaleLowerCase()),t){case"blob":return h.FileType.File;case"tree":return h.FileType.Directory;default:return h.FileType.Unknown}}c(WE,"typenameToFileType");const my=c(class{constructor(t,e,r){this.providerService=t,this.storageService=e,this.changeStore=r,this.lock=new ts("PendingRepositoryOpenActions"),this.disposable=h.Disposable.from(t.onDidChangeRepositories(n=>n.added.length&&this.onRepositoriesOpened(n.added)))}dispose(){this.disposable.dispose()}async onRepositoriesOpened(t){for(const e of t){const r=await this.getAndDelete(e);(r==null?void 0:r.applyChangeset)&&await this.applyPendingChangeset(e,r.applyChangeset),(r==null?void 0:r.filesToOpen)&&this.openPendingFiles(e.uri,r.filesToOpen),this.fetchOrSync(e)}}async fetchOrSync(t){await this.changeStore.hasChanges(t.uri)?await this.providerService.fetch(t.uri):await this.providerService.sync(t.uri,this.changeStore,{reason:"invoked"})}async get(t){return this.lock.synchronizeRead(()=>this.getCore(t.uri),"PendingRepositoryOpenActions.get")}async getAndDelete(t){C.debug(`RepositoryOpenActionsService.getAndDelete(${t.uri.toString()})`);try{return await this.lock.synchronizeWrite(async()=>{const r=await this.getCore(t.uri);if(r!==void 0)return await this.storeCore(t.uri,void 0),r},"PendingRepositoryOpenActions.getAndDelete")}catch(e){C.error(e,`Failed to get pending actions for ${t.uri.toString()}`);return}}async openPendingFiles(t,e){if(e.length!==0){C.log(`RepositoryOpenActionsService.openPendingFiles(${t.toString()})`,e.join(","));for(let r of e){const n=/:(?<start>\d+)(?:-(?<end>\d+))?$/.exec(r);let i,o;(n==null?void 0:n.groups)!==void 0&&(i=Number(n.groups.start),isNaN(i)&&(i=void 0),o=Number(n.groups.end),isNaN(o)&&(o=void 0),r=r.substring(0,n.index));const a=h.Uri.joinPath(t,r);let s;try{s=await h.workspace.fs.stat(a)}catch{}if((s==null?void 0:s.type)===h.FileType.Directory)h.commands.executeCommand("revealInExplorer",a);else{let l;i!==void 0&&(l={selection:new h.Range(Number(i)-1,0,o!=null?o:i,0)}),h.commands.executeCommand("vscode.open",a,l)}}}}setChangesetToApply(t,e){return C.log(`RepositoryOpenActionsService.setChangesetToApply(${t.toString()})`),this.lock.synchronizeWrite(async()=>{const r=await this.getCore(t);await this.storeCore(t,{...r,applyChangeset:e})},"PendingRepositoryOpenActions.setChangesetToApply")}setPendingFilesToOpen(t,e){return C.log(`RepositoryOpenActionsService.setPendingFilesToOpen(${t.toString()})`,e.length),this.lock.synchronizeWrite(async()=>{const r=await this.getCore(t);await this.storeCore(t,{...r,filesToOpen:e})},"PendingRepositoryOpenActions.setPendingFilesToOpen")}async applyPendingChangeset(t,e){C.log(`RepositoryOpenActionsService.applyPendingChangeset(${t.uri.toString()})`);try{await this.changeStore.applyChangeset(t.uri,e,{save:!0})}catch(r){C.error(r,`Failed to apply pending changeset for ${t.uri.toString()}`)}}async getCore(t){return this.fromStorage(await this.storageService.get(this.getStorageKey(t)))}storeCore(t,e){return e===void 0||e.applyChangeset===void 0&&(e.filesToOpen===void 0||e.filesToOpen.length===0)?this.storageService.delete(this.getStorageKey(t)):this.storageService.store(this.getStorageKey(t),this.toStorage(e))}getStorageKey(t){return`actions/${H(t)}`}fromStorage(t){if(!!t)try{const e=JSON.parse(t,(r,n)=>(r==="uri"||r.endsWith("Uri"))&&rt(n)?h.Uri.from(n):n);return{filesToOpen:e.filesToOpen,applyChangeset:e.applyChangeset}}catch(e){return C.error(e,"Failed to deserialize pending repository actions"),{}}}toStorage(t){const e={schemaVersion:my.storageSchemaVersion,...t};return JSON.stringify(e)}},"_RepositoryOpenActionsService");let vy=my;vy.storageSchemaVersion=1;const hn=(0,A.loadMessageBundle)();class wy{constructor(e,r){this.providerService=e,this.changeStore=r,this._onDidChangeFileDecorations=new h.EventEmitter,this._decorations=new Map,this.disposable=h.Disposable.from(h.window.registerFileDecorationProvider(this),e.onDidChangeRepository(this.onRefresh,this),e.onDidRefresh(this.onRefresh,this),r.onDidChange(this.onUrisChanged,this))}get onDidChangeFileDecorations(){return this._onDidChangeFileDecorations.event}dispose(){this.disposable.dispose(),this._decorations.clear()}onRefresh(){this._decorations.clear(),setTimeout(()=>this._onDidChangeFileDecorations.fire(void 0),0)}onUrisChanged(e){const r=e.map(({uri:n})=>(this._decorations.delete(H(n)),n));setTimeout(()=>this._onDidChangeFileDecorations.fire(r),0)}async provideFileDecoration(e,r){if(e.scheme!==Dt.scheme)return;const n=H(e);let i=this._decorations.get(n);if(i!==void 0)return i!=null?i:void 0;const o=await this.providerService.getIncomingChanges(this.providerService.getVirtualRootUri(e));let a;o.length>0&&(a=o.find(l=>H(l.uri)===n));const s=await this.changeStore.getChange(e);if(s===void 0){if(a!==void 0)switch(a.type){case ut.Created:i={badge:"\u2193A",color:new h.ThemeColor("remoteHub.decorations.incomingAddedForegroundColor"),tooltip:hn("decoration tooltip incoming change added","Pending Incoming Changes (Added)")};break;case ut.Deleted:i={badge:"\u2193D",color:new h.ThemeColor("remoteHub.decorations.incomingDeletedForegroundColor"),tooltip:hn("decoration tooltip incoming change deleted","Pending Incoming Changes (Deleted)")};break;case ut.Changed:i={badge:"\u2193M",color:new h.ThemeColor("remoteHub.decorations.incomingModifiedForegroundColor"),tooltip:hn("decoration tooltip incoming change modified","Pending Incoming Changes (Modified)")};break;default:i={badge:"\u2193~",color:new h.ThemeColor("remoteHub.decorations.incomingModifiedForegroundColor"),tooltip:hn("decoration tooltip incoming change","Pending Incoming Changes")};break}return this._decorations.set(n,i!=null?i:null),i}if(s.conflicts)i={badge:"\u26A0",color:new h.ThemeColor("remoteHub.decorations.conflictForegroundColor"),tooltip:hn("decoration tooltip conflicts","Merge Conflicts ({0})",Xy(s.conflicts.status))};else if(a!==void 0)switch(a.type){case ut.Created:i={badge:"\u26A0",color:new h.ThemeColor("remoteHub.decorations.possibleConflictForegroundColor"),tooltip:hn("decoration tooltip possible conflict added","Possible Merge Conflicts (Added)")};break;case ut.Deleted:i={badge:"\u26A0",color:new h.ThemeColor("remoteHub.decorations.possibleConflictForegroundColor"),tooltip:hn("decoration tooltip possible conflict deleted","Possible Merge Conflicts (Deleted)")};break;case ut.Changed:i={badge:"\u26A0",color:new h.ThemeColor("remoteHub.decorations.possibleConflictForegroundColor"),tooltip:hn("decoration tooltip possible conflict","Possible Merge Conflicts")};break;default:i={badge:"\u26A0",color:new h.ThemeColor("remoteHub.decorations.possibleConflictForegroundColor"),tooltip:hn("decoration tooltip possible conflict","Possible Merge Conflicts")}}else switch(s.type){case ut.Created:i={badge:"A",color:new h.ThemeColor("remoteHub.decorations.addedForegroundColor"),tooltip:hn("decoration tooltip added","Added")};break;case ut.Changed:i={badge:"M",color:new h.ThemeColor("remoteHub.decorations.modifiedForegroundColor"),tooltip:hn("decoration tooltip modified","Modified")};break;case ut.Deleted:i={badge:"D",color:new h.ThemeColor("remoteHub.decorations.deletedForegroundColor"),tooltip:hn("decoration tooltip deleted","Deleted")};break}return this._decorations.set(n,i!=null?i:null),i}}c(wy,"ScmDecorationProvider");const qE=(0,A.loadMessageBundle)();class Ii{constructor(e){this.command=e}get label(){return this.command.title}async execute(){var e;return void await h.commands.executeCommand(this.command.command,...(e=this.command.arguments)!=null?e:[])}}c(Ii,"CommandQuickPickItem");var fu;(function(t){async function e(r,n,i,o,a,s){let l;Array.isArray(a)?l=a:s===void 0&&(l=[],s=a);const u=h.window.createQuickPick(),d=new Il(500),p=[d],{defaultBranch:f,HEAD:g}=await r.getMetadata(n);async function x(D){var $;const[z,re,ne]=await Promise.all([r.getBranches(n,{query:D,limit:100}),r.getTags(n,{query:D,limit:100}),r.getSnapshots(n)]),ee=new Set,we=new Set;for(const et of ne)ee.add(et.hash),we.add(et.branch.name);const oe=((s==null?void 0:s.filterBranches)?z.branches.filter(s==null?void 0:s.filterBranches):z.branches).filter(et=>et.name!==f.name),ge=qE("indexedCommit","Open indexed commit"),Ee=[{iconPath:new h.ThemeIcon("layers-active"),tooltip:ge}];return[...l,...(($=g.branch)==null?void 0:$.name)!==f.name?[{label:`$(git-branch) ${f.name} (default)`,description:`\u2022$(git-commit) ${Ve(f.sha)}${we.has(f.name)||ee.has(f.sha)?"\xA0\xA0\u2022\xA0\xA0$(layers)":""}`,alwaysShow:!0,type:ke.Branch,name:void 0,sha:f.sha,buttons:we.has(f.name)||ee.has(f.sha)?Ee:void 0}]:[],...oe.map(et=>({label:`$(git-branch) ${et.name}`,description:`\u2022$(git-commit) ${Ve(et.commit)}${we.has(et.name)?"\xA0\xA0\u2022\xA0\xA0$(layers)":""}`,type:ke.Branch,name:et.name,sha:et.commit,buttons:we.has(et.name)?Ee:void 0})),...re.tags.map(et=>({label:`$(tag) ${et.name}`,description:`\u2022$(git-commit) ${Ve(et.commit)}${ee.has(et.commit)?"\xA0\xA0\u2022\xA0\xA0$(layers)":""}`,type:ke.Tag,name:et.name,sha:et.commit,buttons:ee.has(et.commit)?Ee:void 0}))]}c(x,"getItems");const y=x(void 0);let b,S=!1;async function E(D){b=void 0;const $=u.activeItems;u.items=D!=null?D:await y,S&&$.length!==0&&(u.activeItems=u.items.filter(z=>$.some(re=>re.label===z.label))),u.busy=!1}c(E,"setItems");try{return await new Promise($=>{var z;p.push(u.onDidHide(()=>$(void 0)),u.onDidChangeValue(re=>{if(S=!1,re=re.trim(),(s==null?void 0:s.allowResetToSha)&&g.branch&&Jt(re)){E([{label:`Reset $(git-branch) ${g.branch.name} to $(git-commit) ${re}`,name:g.branch.name,sha:re,type:ke.Branch}]);return}u.busy=!0;const ne=d.debounce(re?()=>x(re):()=>y);b===void 0&&(b=ne.then(async ee=>E(ee)))}),u.onDidAccept(()=>{if(u.activeItems.length!==0){const[re]=u.activeItems;$(re)}}),u.onDidTriggerItemButton(re=>{const ne=re.item;ne instanceof Ii||(ne.useIndex=!0),$(ne)})),u.title=o,u.placeholder=i,u.matchOnDescription=!0,u.ignoreFocusOut=(z=s==null?void 0:s.ignoreFocusOut)!=null?z:!0,u.busy=!0,u.show(),b=d.debounce(async()=>y,0).then(re=>E(re))})}finally{u.dispose(),p.forEach(D=>void D.dispose())}}c(e,"show"),t.show=e})(fu||(fu={}));function op(t,e){switch(t){case he.Branch:case he.RemoteBranch:return e?"$(git-pull-request)":"$(git-branch)";case he.Tag:return"$(tag)";case he.Commit:return"$(git-commit)"}}c(op,"headTypeToCodicon");function jE(t){switch(t){case Oe.Active:return"$(layers-active)";case Oe.Match:return"$(layers-dot)";case Oe.Indexed:return"$(layers)"}}c(jE,"indexTypeToCodicon");function VE(t,e){switch(t){case he.Branch:case he.RemoteBranch:return e?new h.ThemeIcon("git-pull-request"):new h.ThemeIcon("git-branch");case he.Tag:return new h.ThemeIcon("tag");case he.Commit:return new h.ThemeIcon("git-commit")}}c(VE,"headTypeToThemeIcon");const me=(0,A.loadMessageBundle)(),GE=new TextDecoder;class yy{constructor(e,r,n,i){this.providerService=e,this.changeStore=r,this.openActionsService=n,this.telemetryService=i,this._onDidCloseRepository=new h.EventEmitter,this._onDidOpenRepository=new h.EventEmitter,this._onDidChangeState=new h.EventEmitter,this._scmProviders=[],this._state="uninitialized",this.disposable=h.Disposable.from(P.onDidChange(this.onConfigurationChanged,this),this.providerService.onDidChangeRepositories(this.onRepositoriesChanged,this),this.providerService.onDidChangeRepository(async({repository:a})=>{const s=this.getScmProvider(this.providerService.getVirtualUri(a.uri));s!==void 0&&await this.updateStatusBarCommands(s,void 0)}),this.providerService.onDidSyncRepository(async({repository:a,syncing:s})=>{const l=this.getScmProvider(this.providerService.getVirtualUri(a.uri));l!==void 0&&await this.updateStatusBarCommands(l,{syncing:s})}),this.providerService.onDidRefresh(a=>{for(const s of a)this.update(s)}),this.changeStore.onDidChange(a=>this.update(a[0].rootUri)),...this.registerCommands());const o=this.providerService.repositories;this.onRepositoriesChanged({added:o,removed:[]})}get onDidCloseRepository(){return this._onDidCloseRepository.event}get onDidOpenRepository(){return this._onDidOpenRepository.event}get onDidChangeState(){return this._onDidChangeState.event}get repositories(){return this._scmProviders.map(e=>e.repository).filter(e=>Boolean(e))}dispose(){var e;(e=this.disposable)==null||e.dispose()}get staging(){return this._staging===void 0&&(this._staging=P.get("staging")),this._staging}get state(){return this._state}refresh(){for(const e of this._scmProviders)this.update(e.sourceControl.rootUri)}onConfigurationChanged(e){P.changed(e,"staging")&&(this._staging=void 0,P.changed(e,"staging.enabled")&&this.refresh()),P.changed(e,"commitDirectlyWarning")&&this.refresh()}async onRepositoriesChanged(e){if(e.added.length)for(const r of e.added){const n=await this.update(r.uri);(n==null?void 0:n.repository)&&this._onDidOpenRepository.fire(n.repository)}if(e.removed.length)for(const r of e.removed){const n=this._scmProviders.findIndex(i=>H(i.sourceControl.rootUri)===H(r.uri));if(n!==-1){const i=this._scmProviders[n];i.repository&&this._onDidCloseRepository.fire(i.repository),i.sourceControl.dispose(),this._scmProviders.splice(n,1)}}this._state!=="initialized"&&(this._state="initialized",this._onDidChangeState.fire(this._state)),bi(jn.HasWriteableScmProvider,this._scmProviders.some(r=>!r.isReadonly))}registerCommands(){return[h.commands.registerCommand("remoteHub.createPullRequest",e=>{if(e=this.getSourceControlFrom(e),e!==void 0)return this.telemetryService.sendEvent("command.createPullRequest"),void this.createPullRequest(e)}),h.commands.registerCommand("remoteHub.createDraftPullRequest",e=>{if(e=this.getSourceControlFrom(e),e!==void 0)return this.telemetryService.sendEvent("command.createDraftPullRequest"),void this.createPullRequest(e,{draft:!0})}),h.commands.registerCommand("remoteHub.commit",e=>{if(e=this.getSourceControlFrom(e),e!==void 0)return this.telemetryService.sendEvent("command.commit"),void this.commitChanges(e)}),h.commands.registerCommand("remoteHub.discardAllChanges",async e=>{if(by(e)){const o=e.resourceStates.filter(fc);if(o.length!==0){if(await sp(o))for(const a of o)await this.changeStore.discard(a.resourceUri);else this.telemetryService.sendEvent("command.discardAllChanges.abort",{reason:"aborted"});return}}const r=this.getSourceControlFrom(e);if((r==null?void 0:r.rootUri)===void 0)return;this.telemetryService.sendEvent("command.discardAllChanges");const n=await this.changeStore.getChanges(r.rootUri);await sp(n)?await this.changeStore.discardAll(r.rootUri):this.telemetryService.sendEvent("command.discardAllChanges.abort",{reason:"aborted"})}),h.commands.registerCommand("remoteHub.discardChanges",async(...e)=>{for(const r of e)!fc(r)||(this.telemetryService.sendEvent("command.discardChanges"),await sp([r])?await this.changeStore.discard(r.resourceUri):this.telemetryService.sendEvent("command.discardChanges.abort",{reason:"aborted"}))}),h.commands.registerCommand("remoteHub.stageAllChanges",async e=>{const r=this.getSourceControlFrom(e);(r==null?void 0:r.rootUri)!==void 0&&(this.telemetryService.sendEvent("command.stageAllChanges"),await this.changeStore.stageAll(r.rootUri))}),h.commands.registerCommand("remoteHub.stageChanges",async(...e)=>{for(const r of e)!fc(r)||(this.telemetryService.sendEvent("command.stageChanges"),await this.changeStore.stage(r.resourceUri))}),h.commands.registerCommand("remoteHub.unstageAllChanges",e=>{const r=this.getSourceControlFrom(e);if((r==null?void 0:r.rootUri)!==void 0)return this.telemetryService.sendEvent("command.unstageAllChanges"),void this.changeStore.unstageAll(r.rootUri)}),h.commands.registerCommand("remoteHub.unstageChanges",async(...e)=>{for(const r of e)!fc(r)||(this.telemetryService.sendEvent("command.unstageChanges"),await this.changeStore.unstage(r.resourceUri))}),h.commands.registerCommand("remoteHub.keepChanges",async(...e)=>{for(const r of e)!fc(r)||(this.telemetryService.sendEvent("command.keepChanges"),await this.changeStore.keep(r.resourceUri))}),h.commands.registerCommand("remoteHub.openChanges",e=>{var r;const{command:n}=e;if(!!n)return this.telemetryService.sendEvent("command.openChanges"),void h.commands.executeCommand(n.command,...(r=n.arguments)!=null?r:[])}),h.commands.registerCommand("remoteHub.openFile",async(...e)=>{var r;for(const n of e)if(ap(n)){const i=n,o=this.changeStore.resolveOpenCommand(i.resourceUri,{preserveFocus:!1,preview:!1,viewColumn:h.ViewColumn.Active});this.telemetryService.sendEvent("command.openFile"),await h.commands.executeCommand(o.command,...(r=o.arguments)!=null?r:[])}else if(n instanceof h.Uri){this.telemetryService.sendEvent("command.openFile");const i=n;await h.window.showTextDocument(i)}}),h.commands.registerCommand("remoteHub.createBranch",async e=>{await zh("remoteHub.createBranchFrom",{...e,fromSha:"HEAD"})}),h.commands.registerCommand("remoteHub.createBranchFrom",async e=>{var r;const n=(r=e==null?void 0:e.uri)!=null?r:await pc(this._scmProviders,me("choose repo for create branch placeholder","Choose which repository to create a new branch on"),me("choose repo for create branch title","Create Branch"));if(n===void 0)return;this.telemetryService.sendEvent("command.createBranchFrom");const i=await this.providerService.getMetadata(n);if(i.accessLevel<Se.Write){this.telemetryService.sendEvent("command.createBranchFrom.abort",{reason:"no permissions"}),h.window.showErrorMessage(me("no permissions to create branch ","You don't have access to create branches on this repository."));return}let o,a=!1;if(e==null?void 0:e.fromSha)o=e.fromSha,o==="HEAD"&&(o=i.HEAD.sha);else{const g=await fu.show(this.providerService,n,me("choose branch for create placeholder","Choose which branch to create the new branch from"),me("choose branch for create title","Create Branch \u2022 {0}",i.name));if(!g){this.telemetryService.sendEvent("command.createBranchFrom.abort",{reason:"abandoned branch picker"});return}o=g.sha,a=Boolean(g.useIndex)}let s;try{s=await h.window.withProgress({location:h.ProgressLocation.SourceControl},()=>pu(this.providerService,n,o,me("create branch","Please provide a new branch name"),me("create branch placeholder","New branch name"),me("create branch title","Create Branch \u2022 {0}",i.name)))}catch(g){C.error(g),h.window.showErrorMessage(me("unable to create branch","Unable to create the new branch."));return}if(!s){this.telemetryService.sendEvent("command.createBranchFrom.abort",{reason:"abandoned branch name prompt"});return}const l=await this.providerService.switchTo(n,{type:ke.Branch,id:s});if(!l)return;const u=await this.changeStore.createChangeset(n);u&&await this.openActionsService.setChangesetToApply(l.uri,u);const d=me("switch to branch prompt open","Switch to Branch"),p=me("switch to branch prompt open in new window","Open in New Window"),f=await h.window.showInformationMessage(me("switch to branch prompt",`Created new branch '{0}'.

Any uncommitted changes will be applied to the new branch.

Do you want to switch to the new branch?`,s),{modal:!0,useCustom:!0},d,p);!f||(l.location=f===p?$t.NewWindow:$t.CurrentWindow,a&&await P.setMode(l.uri,V.getIndexDefault(q.Branch)),await sn(l,{skipChangesPrompt:!0}))}),h.commands.registerCommand("remoteHub.applyPatch",async e=>{if(e=this.getSourceControlFrom(e),(e==null?void 0:e.rootUri)===void 0)return;this.telemetryService.sendEvent("command.applyPatch");let r;const n=h.window.activeTextEditor;if((n==null?void 0:n.document.languageId)!=="diff"){const i=await h.window.showOpenDialog({openLabel:me("open patch","Open Patch"),title:me("open patch","Open Patch"),canSelectFiles:!0,canSelectFolders:!1,canSelectMany:!1,filters:{Diff:["diff"],Patch:["*","patch"]}});if(i===void 0||i.length===0)return;r=GE.decode(await h.workspace.fs.readFile(i[0]))}else r=n.document.getText();try{await this.changeStore.applyPatch(e.rootUri,r)}catch{h.window.showErrorMessage(me("invalid patch file","Invalid patch file"))}}),h.commands.registerCommand("remoteHub.exportPatch",async(...e)=>{const r=Array.isArray(e)?e:[e];for(const n of r){const i=this.getSourceControlFrom(n);if((i==null?void 0:i.rootUri)===void 0)return;let o;ap(n)&&(o=n.resourceUri),this.telemetryService.sendEvent("command.exportPatch");const a=await this.changeStore.createPatch(i.rootUri,o),s=await h.workspace.openTextDocument({language:"diff",content:a});await h.window.showTextDocument(s)}}),h.commands.registerCommand("remoteHub.switchToBranch",async e=>{var r,n;const i=(r=e==null?void 0:e.uri)!=null?r:await pc(this._scmProviders,me("choose repo for switch branch placeholder","Choose which repository to switch branches on"),me("choose repo for switch branch title","Switch to Branch or Tag"));if(i===void 0)return;this.telemetryService.sendEvent("command.switchToBranch");const o=[],a=await this.providerService.getMetadata(i);if(e==null?void 0:e.commands)switch(a.accessLevel>=Se.Write&&o.push(new Ii(In({command:"remoteHub.createBranch",title:me("create branch command","$(add) Create New Branch..."),arguments:[{uri:i}]})),new Ii(In({command:"remoteHub.createBranchFrom",title:me("create branch from command","$(add) Create New Branch from..."),arguments:[{uri:i}]}))),a.HEAD.type){case he.Branch:o.push(new Ii(In({command:"remoteHub.openOnRemote",title:me("open branch on remote command","$(globe) Open Branch on {0}...",a.provider.name),arguments:[{provider:a.provider,repo:a.repo,branch:a.HEAD.branch.name}]})));break;case he.RemoteBranch:o.push(new Ii(In({command:"remoteHub.openOnRemote",title:me("open remote branch on remote command","$(globe) Open Remote Branch on {0}...",a.provider.name),arguments:[{provider:a.provider,repo:a.HEAD.branch.remote.repo,branch:a.HEAD.branch.name}]})));break;case he.Tag:o.push(new Ii(In({command:"remoteHub.openOnRemote",title:me("open tag on remote command","$(globe) Open Tag on {0}...",a.provider.name),arguments:[{provider:a.provider,repo:a.repo,tag:a.HEAD.detached.name}]})));break;case he.Commit:o.push(new Ii(In({command:"remoteHub.openOnRemote",title:me("open commit on remote command","$(globe) Open Commit on {0}...",a.provider.name),arguments:[{provider:a.provider,repo:a.repo,sha:a.HEAD.sha}]})));break}const s=(n=a.HEAD.branch)==null?void 0:n.name,l=Boolean(s&&!await this.changeStore.hasChanges(i)),u=await fu.show(this.providerService,i,me("choose switch branch placeholder","Choose which branch to switch to"),me("choose switch branch title","Switch to Branch or Tag \u2022 {0}",a.name),o,{allowResetToSha:l,filterBranches:s?d=>d.name!==s:void 0,ignoreFocusOut:!1});if(!u){this.telemetryService.sendEvent("command.switchToBranch.abort",{reason:"abandoned branch picker"});return}return u instanceof Ii?void u.execute():l&&u.type===ke.Branch&&u.name===s&&u.sha?h.window.withProgress({location:h.ProgressLocation.SourceControl},async()=>{try{await this.providerService.sync(i,this.changeStore,{to:u.sha})}catch(d){C.error(d),h.window.showErrorMessage(me("reset failed","Unable to reset the repository to commit '{0}'.",Ve(u.sha)))}}):void h.window.withProgress({location:h.ProgressLocation.SourceControl},async()=>{const d=await this.providerService.switchTo(i,u.name?{type:u.type,id:u.name}:void 0);if(d!==void 0){if(u.useIndex){const p=await this.providerService.getModeRefType(d.uri);await P.setMode(d.uri,V.getIndexDefault(p))}return sn(d)}})}),h.commands.registerCommand("remoteHub.fetch",async e=>{var r;const n=(r=e==null?void 0:e.uri)!=null?r:await pc(this._scmProviders,me("choose repo for fetch placeholder","Choose which repository to fetch"),me("choose repo for fetch title","Fetch Repository"));if(n!==void 0){this.telemetryService.sendEvent("command.fetch");try{await h.window.withProgress({location:h.ProgressLocation.SourceControl},()=>this.providerService.fetch(n,{force:!0}))}catch(i){h.window.showErrorMessage(me("fetch failed","Unable to fetch repository"))}}}),h.commands.registerCommand("remoteHub.fetchAll",async e=>{const r=this.providerService.repositories;if(r.length===0)return;(e==null?void 0:e.automated)||this.telemetryService.sendEvent("command.fetchAll"),(await h.window.withProgress({location:h.ProgressLocation.SourceControl},async()=>{const i=[];for(const o of r)try{await this.providerService.fetch(o.uri)}catch(a){i.push(a)}return i})).length&&!(e==null?void 0:e.automated)&&h.window.showErrorMessage(r.length?me("fetch all failed","Unable to fetch repositories"):me("fetch failed","Unable to fetch repository"))}),h.commands.registerCommand("remoteHub.pull",async e=>{var r;const n=(r=e==null?void 0:e.uri)!=null?r:await pc(this._scmProviders,me("choose repo for pull placeholder","Choose which repository to pull"),me("choose repo for pull title","Pull Repository"));if(n!==void 0){this.telemetryService.sendEvent("command.pull");try{await this.sync(n,{pull:!0})}catch{}}}),h.commands.registerCommand("remoteHub.sync",async e=>{var r;const n=(r=e==null?void 0:e.uri)!=null?r:await pc(this._scmProviders,me("choose repo for sync placeholder","Choose which repository to sync"),me("choose repo for sync title","Synchronize Repository"));if(n!==void 0){this.telemetryService.sendEvent("command.sync");try{await this.sync(n)}catch{}}}),h.commands.registerCommand("remoteHub.disableCommitDirectlyWarning",()=>{this.telemetryService.sendEvent("command.disableCommitDirectlyWarning"),P.updateEffective("commitDirectlyWarning",O.Off)})]}async sync(e,{pull:r,...n}={pull:!1}){this.telemetryService.sendEvent("sync");try{await h.window.withProgress({location:h.ProgressLocation.SourceControl},()=>this.providerService.sync(e,this.changeStore,n))}catch(i){if(i instanceof mt){const o={title:me("sync confirm","Continue")},a={title:me("sync cancel","Cancel"),isCloseAffordance:!0};await h.window.showWarningMessage(r?me("sync pull",`Pulling in changes may cause conflicts with your uncommitted changes as one of more of those files has changed since you started editing.

Do you want to continue pulling in changes.`):me("sync",`Syncing changes may cause conflicts with your uncommitted changes as one of more of those files has changed since you started editing.

Do you want to continue syncing changes?`),{modal:!0,useCustom:!0},o,a)===o?await h.window.withProgress({location:h.ProgressLocation.SourceControl},()=>this.providerService.sync(e,this.changeStore,{conflictResolution:Br.Merge})):this.telemetryService.sendEvent("sync.abort",{reason:"abandoned"})}else throw C.error(i),this.telemetryService.sendException(i),h.window.showErrorMessage(me("sync failed","Unable to sync the repository.")),i}}async commitChanges(e){try{await h.window.withProgress({location:h.ProgressLocation.SourceControl},()=>this.commitChangesCore(e))}catch(r){if(r instanceof We){h.window.showInformationMessage(me("no changes to commit","There are no changes to commit."));return}C.error(r),h.window.showErrorMessage(me("commit unable","Unable to commit.")),this.telemetryService.sendException(r)}}async commitChangesCore(e){const r=e.rootUri;this.telemetryService.sendEvent("commit",{staging:String(this.staging.enabled)});const n=new Be(`VirtualSourceControl.commitChanges(${r.toString()})`);let i;try{const o=await this.providerService.getMetadata(r);let a,s;const l=this.staging.enabled?this.staging.smart?"auto":!0:!1;for(;;){const d=e.inputBox.value;if(await this.changeStore.hasMergeConflicts(r)){e.inputBox.showValidationMessage(me("commit resolve conflicts","You must resolve any pending conflicts before committing."),h.SourceControlInputBoxValidationType.Error),this.telemetryService.sendEvent("commit.abort",{reason:"aborted conflicts"}),i=": Aborted; Unresolved conflicts";return}const p=await this.providerService.getCommitOperations(r,this.changeStore,{staged:l});if(p.length===0){e.inputBox.showValidationMessage(this.staging.enabled?me("commit no staged changes","There are no staged changes to commit."):me("commit no changes","There are no changes to commit."),h.SourceControlInputBoxValidationType.Information),this.telemetryService.sendEvent("commit.abort",{reason:this.staging.enabled?"aborted no staged changes":"aborted no changes"}),i=`: Aborted; No ${this.staging.enabled?"staged ":""}changes`;return}if(!d){e.inputBox.showValidationMessage(me("specify commit message","You must specify a commit message before committing."),h.SourceControlInputBoxValidationType.Error),this.telemetryService.sendEvent("commit.abort",{reason:"aborted no message"}),i=": Aborted; No message";return}let f,g;if(o.HEAD.type===he.RemoteBranch?(g=o.HEAD.branch.remote.accessLevel<Se.Write,f=g&&o.accessLevel<Se.Write):(f=o.accessLevel<Se.Write,g=f),s===void 0&&f&&(s=await this.providerService.getFork(r),s===void 0)){const x={title:me("fork confirm","Fork Repository")},y={title:me("cancel","Cancel"),isCloseAffordance:!0};if(await h.window.showInformationMessage(me("fork","You\u2019re trying to make changes in a project you don\u2019t have write access to. Do you want to create a fork of this project to commit your proposed changes to?"),{modal:!0,useCustom:!0},x,y)!==x){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned fork prompt"}),i=": Aborted; Abandoned fork prompt";return}if(s=await h.window.withProgress({location:h.ProgressLocation.Notification,title:me("fork progress","Forking {0}...",o.name)},()=>this.providerService.fork(r)),s===void 0){h.window.showErrorMessage(me("unable to fork","Unable to fork repository.")),this.telemetryService.sendEvent("commit.abort",{reason:"aborted fork failed"}),i=": Aborted; Fork failed";return}}if(s||g){if(s===void 0){const y={title:me("remote branch create branch prompt confirm","Commit to New Branch")},b={title:me("cancel","Cancel"),isCloseAffordance:!0};if(await h.window.showErrorMessage(me("remote branch create branch prompt",`You\u2019re trying to make changes to a branch you don\u2019t have write access to.

Do you want to commit your changes to a new branch?`),{modal:!0,useCustom:!0},y,b)!==y){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned remote branch prompt"}),i=": Aborted; Abandoned commit to new branch prompt";return}}let x=0;try{const y=await this.providerService.getBranches(s?this.providerService.createVirtualUri(r,s):r,{query:"patch-"});for(const b of y.branches){const S=/^patch-(?<num>\d+)$/.exec(b.name);if(S==null?void 0:S.groups){const E=Number(S.groups.num);E>x&&(x=E)}}}catch{}if(a=await pu(this.providerService,r,o.HEAD.sha,me("create new branch prompt","Create a new branch to commit your changes to"),me("create new branch placeholder","New branch name"),me("create new branch title","Commit \u2022 Create Branch \u2022 {0}",s?s.name:o.name),s,`patch-${x+1}`),!a){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned create branch prompt"}),i=": Aborted; Abandoned create branch prompt";return}}try{if(P.getUseNewCommitApi())await this.providerService.createAndPushCommit(r,d,p,a,s);else{n.logStep("Creating commit");const x=await this.providerService.createCommit(r,d,p,s);n.logStep("Pushing",{message:`: Created commit ${x}`,suffix:" \u2022 Pushing..."}),await this.providerService.pushCommit(r,x,a,s)}}catch(x){if(x instanceof ot){const y={title:me("detached head prompt confirm","Commit to New Branch")},b={title:me("cancel","Cancel"),isCloseAffordance:!0};if(await h.window.showErrorMessage(me("detached head prompt",`Unable to commit your changes because you are not currently on a branch.

Do you want to commit your changes to a new branch?`),{modal:!0},y,b)!==y){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned detached head prompt"}),i=": Aborted; Abandoned commit to new branch prompt (detached head)";return}if(a=await pu(this.providerService,r,o.HEAD.sha,me("create new branch prompt","Create a new branch to commit your changes to"),me("create new branch placeholder","New branch name"),me("create new branch title","Commit \u2022 Create Branch \u2022 {0}",s?s.name:o.name),s),!a){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned detached head create branch prompt"}),i=": Aborted; Abandoned create branch prompt (detached head)";return}continue}else if(x instanceof de){const y={title:me("push conflicts prompt pull","Pull")},b={title:me("push conflicts prompt sync","Sync (Pull & Push)")},S={title:me("cancel","Cancel"),isCloseAffordance:!0},E=await h.window.showErrorMessage(me("push conflicts prompt",`Changes have been committed since you started editing, so you must merge those changes before you can commit.

Do you want to pull or sync (pull and automatically push) your changes?`),{modal:!0},y,b,S);if(E!==y&&E!==b){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned conflicts prompt"}),i=": Aborted; Abandoned merge changes prompt";return}if(await this.sync(r,{pull:E===y,conflictResolution:Br.Merge}),E===y){i=': Aborted; Chose "pull" from merge changes prompt';return}continue}else throw C.error(x),i=`: Aborted; ${String(x)}`,x}break}if(e.inputBox.value="",s?await this.changeStore.discardAll(r,{staged:l}):await this.changeStore.acceptAll(r,{staged:l}),hp(Lo.HasCommitted,!0),!s&&!a)return;async function u(){if(s){const g={title:me("commit to fork confirm","Switch to Fork")},x={title:me("cancel","Cancel"),isCloseAffordance:!0},y=await h.window.showInformationMessage(me("commit to fork","Committed changes to your fork of {0}. Do you want to switch to your fork to continue making changes?",o.name),{modal:!0,useCustom:!0},g,x);if(this.telemetryService.sendEvent("commit.switchToFork",{confirm:String(y===g)}),y===g){let b;a!==void 0?b={type:ke.Branch,id:a}:o.HEAD.branch!==void 0&&(b={type:ke.Branch,id:o.HEAD.branch.name}),sn({name:s.name,uri:this.providerService.createVirtualUri(r,{repo:s.repo,ref:b}),location:$t.CurrentWindow})}return}const d={title:me("commit to new branch confirm","Switch to Branch")},p={title:me("cancel","Cancel"),isCloseAffordance:!0},f=await h.window.showInformationMessage(me("commit to new branch","Committed changes to new branch '{0}'. Do you want to switch to the new branch to continue making changes?",a),{modal:!0,useCustom:!0},d,p);this.telemetryService.sendEvent("commit.switchToBranch",{confirm:String(f===d)}),f===d&&sn({name:o.name,uri:this.providerService.createVirtualUri(r,{repo:o.repo,ref:a?{type:ke.Branch,id:a}:void 0}),location:$t.CurrentWindow})}c(u,"showSwitchToPrompt"),u.call(this)}finally{n.stop(i?{message:i}:void 0)}}async createPullRequest(e,r){try{await h.window.withProgress({location:h.ProgressLocation.SourceControl},()=>this.createPullRequestCore(e,r))}catch(n){if(n instanceof We){h.window.showInformationMessage(me("no changes to commit","There are no changes to commit."));return}if(n instanceof Zt){h.window.showErrorMessage(me("commit unable","Unable to commit."));return}C.error(n),h.window.showErrorMessage(me("unable to open pr","Unable to open a pull request.")),this.telemetryService.sendException(n)}}async createPullRequestCore(e,r){var n,i;const o=e.rootUri,a=(n=r==null?void 0:r.draft)!=null?n:!1;this.telemetryService.sendEvent("createPullRequest",{draft:String(a),staging:String(this.staging.enabled)});const s=new Be(`VirtualSourceControl.createPullRequest(${o.toString()})`);let l;try{let u=c(function(){this.telemetryService.sendEvent("createPullRequest.abort",{reason:"abandoned branch prompt"}),l=": Aborted; Abandoned commit to new branch prompt"},"handleBranchNotCreated"),d;const p=this.staging.enabled?this.staging.smart?"auto":!0:!1;if(!(r==null?void 0:r.sha)){if(await this.changeStore.hasMergeConflicts(o)){e.inputBox.showValidationMessage(me("commit resolve conflicts","You must resolve any pending conflicts before committing."),h.SourceControlInputBoxValidationType.Error),this.telemetryService.sendEvent("createPullRequest.abort",{reason:"aborted conflicts"}),l=": Aborted; Unresolved conflicts";return}if(d=await this.providerService.getCommitOperations(o,this.changeStore,{staged:this.staging.enabled?this.staging.smart?"auto":!0:!1}),d.length===0){e.inputBox.showValidationMessage(this.staging.enabled?me("commit no staged changes","There are no staged changes to commit."):me("commit no changes","There are no changes to commit."),h.SourceControlInputBoxValidationType.Information),this.telemetryService.sendEvent("createPullRequest.abort",{reason:this.staging.enabled?"aborted no staged changes":"aborted no changes"}),l=`: Aborted; No ${this.staging.enabled?"staged ":""}changes`;return}}const f=e.inputBox.value;if(!f){e.inputBox.showValidationMessage(me("specify commit message","You must specify a commit message before committing."),h.SourceControlInputBoxValidationType.Error),this.telemetryService.sendEvent("createPullRequest.abort",{reason:"aborted no message"}),l=": Aborted; No message";return}const g=await this.providerService.getMetadata(o);let x,y;g.HEAD.type===he.RemoteBranch?(y=g.HEAD.branch.remote.accessLevel<Se.Write,x=y&&g.accessLevel<Se.Write):(x=g.accessLevel<Se.Write,y=x);let b=r==null?void 0:r.fork;if(b===void 0&&x&&(b=await this.providerService.getFork(o),b===void 0)){const re={title:me("fork confirm","Fork Repository")},ne={title:me("cancel","Cancel"),isCloseAffordance:!0};if(await h.window.showInformationMessage(me("fork",`You\u2019re trying to make changes in a project you don\u2019t have write access to.

Do you want to create a fork of this project to commit your proposed changes to?`),{modal:!0,useCustom:!0},re,ne)!==re){this.telemetryService.sendEvent("createPullRequest.abort",{reason:"abandoned fork prompt"}),l=": Aborted; Abandoned fork prompt";return}if(b=await h.window.withProgress({location:h.ProgressLocation.Notification,title:me("fork progress","Forking {0}...",g.name)},()=>this.providerService.fork(o)),b===void 0){h.window.showErrorMessage(me("unable to fork","Unable to fork repository.")),this.telemetryService.sendEvent("createPullRequest.abort",{reason:"aborted fork failed"}),l=": Aborted; Fork failed";return}}const S=await h.window.showInputBox({ignoreFocusOut:!0,placeHolder:me("create pr placeholder","Pull request title"),prompt:me("create pr prompt","Enter a title for the new pull request"),title:me("create pr title","New Pull Request"),value:f});if(!S){this.telemetryService.sendEvent("createPullRequest.abort",{reason:"abandoned title prompt"}),l=": Aborted; Abandoned title prompt";return}async function E(re){let ne=0;try{const ee=await this.providerService.getBranches(b?this.providerService.createVirtualUri(o,b):o,{query:"patch-"});for(const we of ee.branches){const oe=/^patch-(?<num>\d+)$/.exec(we.name);if(oe==null?void 0:oe.groups){const ge=Number(oe.groups.num);ge>ne&&(ne=ge)}}}catch{}return pu(this.providerService,o,re,me("create pr branch prompt","Create a new branch for this pull request"),me("create pr branch placeholder","New branch name"),me("create pr branch title","New Pull Request \u2022 Create Branch \u2022 {0}",b?b.name:g.name),b,`patch-${ne+1}`)}c(E,"createBranch");let D;if(P.getUseNewCommitApi()){if(D=await E.call(this,g.HEAD.sha),!D){u.call(this);return}(d==null?void 0:d.length)&&await this.providerService.createAndPushCommit(o,f,d,D,b)}else{let re;if((d==null?void 0:d.length)?(re=await this.providerService.createCommit(o,f,d,b),s.log({message:`: Created commit ${re}`})):(re=(i=r==null?void 0:r.sha)!=null?i:g.HEAD.sha,s.log({message:`: Using commit ${re}`})),D=await E.call(this,re),!D){u.call(this);return}}const $=await this.providerService.createPullRequest(o,D,S,{draft:a},b);e.inputBox.value="",(d==null?void 0:d.length)&&(b?await this.changeStore.discardAll(o,{staged:p}):await this.changeStore.acceptAll(o,{staged:p}));async function z(){const re={title:me("created pr notification confirm","Switch to Pull Request")},ne={title:me("cancel","Cancel"),isCloseAffordance:!0},ee=await h.window.showInformationMessage(me("created pr notification",'Created [Pull Request #{0}]({1} "Open Pull Request #{0} on {2}") for {3}. Do you want to switch to the new pull request?',$.id,$.uri.toString(!0),g.provider.name,g.name),{modal:!0,useCustom:!0},re,ne);this.telemetryService.sendEvent("createPullRequest.switchToPullRequest",{confirm:String(ee===re)}),ee===re&&sn({name:g.name,uri:this.providerService.createVirtualUri(o,{repo:g.repo,ref:{type:ke.PullRequest,id:$.id}}),location:$t.CurrentWindow})}c(z,"showSwitchToPrompt"),z.call(this)}finally{s.stop(l?{message:l}:void 0)}}async update(e){const r=h.workspace.getWorkspaceFolder(e);if(r===void 0)return;const n=await this.createOrUpdateScmProvider(e,r.name),i=await this.changeStore.getGroupedChanges(e,{predicate:l=>l.fileType===h.FileType.File}),o=await Promise.all(i.conflicts.map(async l=>({type:l.type,resourceUri:l.uri,command:await this.changeStore.resolveDiffCommand(l.uri,l.conflicts.incomingUri,me("diff title with conflicts","{0} (Incoming Changes \u2194 Current Changes)",ce(l.uri)))}))),a=await Promise.all(i.staged.map(async l=>({type:l.type,resourceUri:l.uri,command:await this.changeStore.resolveDiffCommand(l.uri,this.providerService.getProviderUri(l.uri),me("diff title index","{0} (Index)",ce(l.uri)))}))),s=await Promise.all(i.working.map(async l=>({type:l.type,resourceUri:l.uri,decorations:{strikeThrough:l.type===ut.Deleted},command:await this.changeStore.resolveDiffCommand(l.uri,this.providerService.getProviderUri(l.uri),me("diff title working","{0} (Working Tree)",ce(l.uri)))})));return this.ensureMergeConflictsGroup(n).resourceStates=o,this.ensureStagedChangesGroup(n).resourceStates=this.staging.enabled?a:[],this.ensureWorkingChangesGroup(n).resourceStates=this.staging.enabled?s:[...a,...s],n}async createOrUpdateScmProvider(e,r){const n=await this.providerService.getMetadata(e),i=this.providerService.isReadonly(e);let o;const a=n.HEAD.branch?n.HEAD.name:void 0;let s=this.getScmProvider(e);if(s===void 0){r=n.name,o=h.scm.createSourceControl(`remoteHub:${n.provider.id}`,r,e),o.quickDiffProvider={provideOriginalResource:u=>this.providerService.getProviderUri(u)};const l=this.providerService.createIGitRepository(e,o,n,this.changeStore);s={id:n.provider.id,name:n.provider.name,sourceControl:o,groups:[],repository:l,isReadonly:i},this.ensureMergeConflictsGroup(s),this.ensureStagedChangesGroup(s),this.ensureWorkingChangesGroup(s),this._scmProviders.push(s)}else o=s.sourceControl;return n.accessLevel>=Se.Write?(o.acceptInputCommand={command:"remoteHub.commit",title:me("scm input accept command title commit","Commit"),arguments:[o]},a?o.inputBox.placeholder=me("scm input placeholder commit","Message (Ctrl+Enter to commit directly to '{0}' on {1})",a,n.provider.name):o.inputBox.placeholder=me("scm input placeholder commit","Message (Ctrl+Enter to commit directly to {0})",n.provider.name),P.get("commitDirectlyWarning")===O.Off?o.inputBox.validateInput=void 0:o.inputBox.validateInput=l=>{if(P.get("commitDirectlyWarning")===O.Auto&&Ny(Lo.HasCommitted))return;const u=new h.MarkdownString(a?me("scm input validation commit branch directly","Your changes will be committed directly to the '{0}' branch on {1}.",a,n.provider.name):me("scm input validation commit directly","Your changes will be committed directly to {0}.",n.provider.name));return u.isTrusted=!0,u.appendMarkdown(`&nbsp; [${me("scm input validation action","Don't show again")}](command:remoteHub.disableCommitDirectlyWarning '${me("scm input validation action tip","Hide")}')`),{message:u,type:h.SourceControlInputBoxValidationType.Information}}):i?(o.acceptInputCommand=void 0,o.inputBox.placeholder=me("scm input readonly placeholder","Committing is not available for readonly repositories.")):(o.acceptInputCommand={command:"remoteHub.createPullRequest",title:me("scm input accept command title pr","Create a Pull Request"),arguments:[o]},o.inputBox.placeholder=me("scm input placeholder pr","Message (Ctrl+Enter to create a pull request for '{0}'",r)),await this.updateStatusBarCommands(s,{syncing:!1},n),s}async updateStatusBarCommands(e,r,n){var i,o,a;const s=e.sourceControl.rootUri;n=n!=null?n:await this.providerService.getMetadata(s);const{HEAD:l}=n,u=await this.providerService.getIndexMetadata(s),d=(u==null?void 0:u.type)===Oe.Active,p=(u==null?void 0:u.type)===Oe.Active,f=Oe.hasIndex(u==null?void 0:u.type),g=await this.changeStore.hasChanges(s),x=op(l.type),y=[];if(y.push(In({command:"remoteHub.switchToBranch",title:`${x} ${l.name}${g?"*":""}`,tooltip:`${Ve(l.sha)}`,arguments:[{uri:s,commands:!0}]})),l.detached||((r==null?void 0:r.syncing)?y.push(In({command:"",title:"$(sync~spin)",tooltip:me("sync command syncing","Syncing Changes..."),arguments:[]})):y.push(In({command:"remoteHub.sync",title:`$(sync)${((o=(i=n.state)==null?void 0:i.behind)!=null?o:0)>0?` ${(a=n.state)==null?void 0:a.behind}\u2193`:""}`,tooltip:d||p?me("sync index","Sync to latest indexed commit"):me("sync command","Sync (Pull & Push)"),arguments:[{uri:s}]}))),n.pullRequest&&y.push(In({command:"remoteHub.openOnRemote",title:`$(git-pull-request) ${n.pullRequest.id}`,tooltip:me("scm statusbar command open pr",`Open Pull Request #{0} on {1}

{2}`,n.pullRequest.id,n.provider.name,n.pullRequest.title),arguments:[{provider:n.provider,repo:n.repo,pullRequest:{id:n.pullRequest.id}}]})),f){const b=this.providerService.getIndexProvider(s);b&&y.push(...await b.getStatusBarContributions(s))}e.sourceControl.statusBarCommands=y}ensureMergeConflictsGroup(e){const r="conflicts";let n=e.groups.find(i=>i.id===r);return n===void 0&&(n=e.sourceControl.createResourceGroup(r,me("scm group conflicts","Merge Conflicts")),n.hideWhenEmpty=!0,e.groups.push(n)),n}ensureStagedChangesGroup(e){const r="staged";let n=e.groups.find(i=>i.id===r);return n===void 0&&(n=e.sourceControl.createResourceGroup(r,me("scm group staged","Staged Changes")),n.hideWhenEmpty=!0,e.groups.push(n)),n}ensureWorkingChangesGroup(e){const r="changes";let n=e.groups.find(i=>i.id===r);return n===void 0&&(n=e.sourceControl.createResourceGroup(r,me("scm group changes","Changes")),e.groups.push(n)),n}getScmProvider(e){const r=H(e);return this._scmProviders.find(n=>H(n.sourceControl.rootUri)===r)}getSourceControlFrom(e){if(e===void 0){if(this._scmProviders.length!==1)return;e=this._scmProviders[0].sourceControl}let r;if(KE(e))r=e;else if(by(e)){const n=e,i=this._scmProviders.find(o=>o.groups.includes(n));r=i==null?void 0:i.sourceControl}else if(ap(e)){const n=e,i=this._scmProviders.find(o=>o.groups.some(a=>a.resourceStates.includes(n)));r=i==null?void 0:i.sourceControl}else{if(this._scmProviders.length!==1)return;r=this._scmProviders[0].sourceControl}return r}}c(yy,"VirtualSourceControl");function KE(t){return"rootUri"in t&&"inputBox"in t}c(KE,"isSourceControl");function by(t){return t!==void 0&&"id"in t&&"label"in t&&"resourceStates"in t&&Array.isArray(t.resourceStates)}c(by,"isSourceControlResourceGroup");function ap(t){return t!==void 0&&"resourceUri"in t&&t.resourceUri instanceof h.Uri}c(ap,"isSourceControlResourceState");function fc(t){return"type"in t}c(fc,"isTrackedChange");async function sp(t){var e,r,n;if(t.length===0)return!0;let i,o=me("discard","Discard Changes");if(t.length===1){const s=t[0];s.type===ut.Created?(i=me("confirm delete",`Are you sure you want to DELETE {0}?
This is IRREVERSIBLE!
This file will be FOREVER LOST.`,ce((e=s.resourceUri)!=null?e:s.uri)),o=me("delete file","Delete file")):s.type===ut.Deleted?(o=me("restore file","Restore file"),i=me("confirm restore","Are you sure you want to restore {0}?",ce((r=s.resourceUri)!=null?r:s.uri))):i=me("confirm discard","Are you sure you want to discard changes in {0}?",ce((n=s.resourceUri)!=null?n:s.uri))}else t.every(s=>s.type===ut.Created)?i=me("confirm delete multiple",`Are you sure you want to DELETE {0} files?
This is IRREVERSIBLE!
These files will be FOREVER LOST.`,t.length):t.every(s=>s.type===ut.Deleted)?(o=me("restore files","Restore files"),i=me("confirm restore multiple","Are you sure you want to restore {0} files?",t.length)):i=me("confirm discard multiple","Are you sure you want to discard changes in {0} files?",t.length);return await h.window.showWarningMessage(i,{modal:!0,useCustom:!0},o)===o}c(sp,"confirmDiscard");async function pc(t,e,r){if(t.length===0)return;if(t.length===1)return t[0].sourceControl.rootUri;const n=await h.window.showQuickPick(t.map(({sourceControl:i})=>({label:i.label,uri:i.rootUri})),{placeHolder:e,title:r});if(!!n)return n.uri}c(pc,"getOrPickRootUri");async function pu(t,e,r,n,i,o,a,s){const l=new Set;let u;const d=h.window.createInputBox();d.ignoreFocusOut=!0;try{return await new Promise((p,f)=>{u=h.Disposable.from(d.onDidHide(()=>p(void 0)),d.onDidChangeValue(g=>{if(g=g.trim(),!g){d.validationMessage=me("scm create branch prompt validation missing name","Please enter a valid branch name");return}if(l.has(g)){d.validationMessage=me("scm create branch prompt validation already exists","Branch '{0}' already exists",g);return}if(!ir(g)){d.validationMessage=me("scm create branch prompt validation invalid name","'{0}' isn't a valid branch name",g);return}d.validationMessage=void 0}),d.onDidAccept(async()=>{const g=d.value;try{d.enabled=!1,d.busy=!0;const x=await t.createBranch(e,g,r,a);p(x)}catch(x){if(x instanceof fe){d.enabled=!0,d.busy=!1,d.validationMessage=x.duplicate?me("scm create branch prompt validation already exists","Branch '{0}' already exists",g):me("scm create branch prompt validation invalid","Invalid branch name '{0}'",g),l.add(g);return}f(x)}})),d.prompt=n,d.placeholder=i,d.title=o,s&&(d.value=s),d.show()})}finally{d.dispose(),u==null||u.dispose()}}c(pu,"createBranchWithPrompt");class gu{constructor(e,r){this.memento=e,this.scope=r,this._onDidChange=new h.EventEmitter}get onDidChange(){return this._onDidChange.event}async get(e){const r=this.getScoped(e),n=new Be(`MementoStorage.get(${e}): scopedKey=${r}`,{logLevel:ie.Debug});try{return await Promise.resolve(this.memento.get(r))}finally{n.stop()}}async getKeys(e){const r=this.getScoped(e),n=new Be(`MementoStorage.getKeys(${e}): scopedPrefix=${r}`,{logLevel:ie.Debug});try{let i=this.getKeysCore(e);if(this.scope!==void 0){const o=this.scope.length+1;i=i.map(a=>a.substr(o))}return await Promise.resolve(i)}finally{n.stop()}}getKeysCore(e){let r=this.memento.keys();return e&&(r=r.filter(n=>n.startsWith(e))),r}async store(e,r){const n=this.getScoped(e),i=new Be(`MementoStorage.store(${e}): scopedKey=${n}`,{logLevel:ie.Debug});try{return await this.storeCore(e,n,r)}finally{i.stop()}}async storeCore(e,r,n){await this.memento.update(r,n),this._onDidChange.fire({key:e})}async delete(e){const r=this.getScoped(e),n=new Be(`MementoStorage.delete(${e}): scopedKey=${r}`,{logLevel:ie.Debug});try{return await this.storeCore(e,r,void 0)}finally{n.stop()}}async deleteKeys(e){const r=this.getScoped(e),n=new Be(`MementoStorage.deleteKeys(${e}): scopedPrefix=${r}`,{logLevel:ie.Debug});try{const i=[],o=this.scope!==void 0?this.scope.length+1:0,a=this.getKeysCore(r);for(const s of a){const l=o!==0?s.substr(o):s;C.debug(`MementoStorage.deleteKeys(${e}): Deleting key=${l}, scopedKey=${s}`);try{await this.storeCore(l,s,void 0)}catch(u){C.debug(`MementoStorage.deleteKeys(${e}): Failed to delete key=${l}, scopedKey=${s}`),i.push(l)}}if(i.length)throw new Error(`Failed to delete keys: ${i.join(", ")}`)}finally{n.stop()}}with(e){return new gu(this.memento,e)}getScoped(e){return`${this.scope!==void 0?`${this.scope}/`:""}${e!=null?e:""}`}}c(gu,"MementoStorageService");class mu{constructor(e,r){this.storageUri=e,this.scope=r,this._onDidChange=new h.EventEmitter}get onDidChange(){return this._onDidChange.event}async get(e){const r=this.getScoped(e),n=new Be(`ExtFileStorageService.get(${e}): scopedKey=${r}`,{logLevel:ie.Debug});try{return await h.workspace.fs.readFile(h.Uri.joinPath(this.storageUri,r))}catch(i){return}finally{n.stop()}}async store(e,r){const n=this.getScoped(e),i=new Be(`ExtFileStorageService.store(${e}): scopedKey=${n}`,{logLevel:ie.Debug});try{return await this.storeCore(e,n,r)}finally{i.stop()}}async storeCore(e,r,n){await h.workspace.fs.writeFile(h.Uri.joinPath(this.storageUri,r),n),this._onDidChange.fire({key:e})}async delete(e){const r=this.getScoped(e),n=new Be(`ExtFileStorageService.delete(${e}): scopedKey=${r}`,{logLevel:ie.Debug});try{return await h.workspace.fs.delete(h.Uri.joinPath(this.storageUri,r))}finally{n.stop()}}with(e){return new mu(this.storageUri,e)}getScoped(e){return`${this.scope!==void 0?`${this.scope}/`:""}${e}`}}c(mu,"ExtFileStorageService");const Yt=(0,A.loadMessageBundle)();class oi extends h.TimelineItem{static is(e){return e instanceof oi}constructor(e,r,n,i,{dateType:o,showAuthor:a,dateFormatter:s}){var l;const u=n.message.indexOf(`
`),d=u!==-1?`${n.message.substring(0,u)} \u2026`:n.message,p=o==="authored"?n.authorDate:n.commitDate;super(d,(l=p==null?void 0:p.getTime())!=null?l:0);this.id=n.hash,this.contextValue=`vscode-vfs:${r}:file:commit`,this.command=i,a&&(this.description=n.authorName),this.detail=Yt("timeline item detail",`{0} ({1}) \u2014 {2}
{3}

{4}`,n.authorName,n.authorEmail,Ve(n.hash),s.format(p),n.message),this.iconPath=new h.ThemeIcon("git-commit"),this.rootUri=e,this.providerId=r,this.hash=n.hash,this.parents=n.parents,this.message=n.message}}c(oi,"CommitTimelineItem");class Uo extends h.TimelineItem{static is(e){return e instanceof Uo}constructor(e,r,n,i,o,{dateFormatter:a,staged:s}){const l=s?Yt("timeline staged changes","Staged Changes"):Yt("timeline uncommitted changes","Uncommitted Changes");super(l,n.timestamp);this.id=s?"index":"working",this.contextValue=`vscode-vfs:${r}:file:${this.id}`,this.command=o,this.iconPath=new h.ThemeIcon("git-commit"),s?this.detail=Yt("timeline index detail",`{0}  \u2014 {1}
{2}

{3}`,Yt("timeline you","You"),Yt("timeline index","Index"),a.format(new Date(n.timestamp)),Ap(n.type)):this.detail=Yt("timeline working detail",`{0}  \u2014 {1}
{2}

{3}`,Yt("timeline you","You"),Yt("timeline working","Working Tree"),a.format(new Date(n.timestamp)),Ap(n.type)),this.rootUri=e,this.providerId=r,this.hash=s?"~":"",this.parents=i,this.message=l}}c(Uo,"ChangeOperationTimelineItem");class xy{constructor(e,r){this.providerService=e,this.changeStore=r,this._onDidChange=new h.EventEmitter,this.id="github-file-history",this.label=Yt("timeline.source","GitHub File History"),this.debouncer=new Il(500),this.disposable=h.Disposable.from(this.debouncer,e.onDidChangeProviders(this.onProvidersChanged,this),e.onDidChangeRepositories(this.onRepositoriesChanged,this),e.onDidChangeRepository(this.onRepositoryChanged,this),e.onDidRefresh(this.onRefresh,this),r.onDidChange(this.onUrisChanged,this),P.onDidChangeAny(this.onConfigurationChanged,this),...this.registerCommands()),e.hasProviders&&this.ensureProviderRegistration()}get onDidChange(){return this._onDidChange.event}dispose(){var e;(e=this.providerDisposable)==null||e.dispose(),this.disposable.dispose()}onConfigurationChanged(e){(e.affectsConfiguration("git.timeline.date")||e.affectsConfiguration("git.timeline.showAuthor"))&&this.fireChanged()}onProvidersChanged(e){this.ensureProviderRegistration(),this.fireChanged()}onRefresh(e){if(this.rootUri===void 0)return;const r=H(this.rootUri);!e.some(n=>H(n)===r)||this.fireChanged()}onRepositoriesChanged(e){if(this.rootUri===void 0)return;const r=H(this.rootUri);(e.added.some(n=>H(n.uri)===r)||e.removed.some(n=>H(n.uri)===r))&&this.fireChanged()}onRepositoryChanged(e){this.rootUri===void 0||H(this.rootUri)!==H(e.repository.uri)||this.fireChanged()}onUrisChanged(e){if(this.rootUri===void 0)return;const r=H(this.rootUri);e.some(n=>H(n.rootUri)===r)&&this.fireChanged()}async provideTimeline(e,r,n){var i;try{this.rootUri=this.providerService.getVirtualRootUri(e);for(const x of this.providerService.repositories)if(x.uri.path===this.rootUri.path){this.rootUri=x.uri;break}const o=this.providerService.getRelativeFilePath(this.rootUri,e),a=await this.providerService.getMetadata(this.rootUri);if(!a||n.isCancellationRequested)return{items:[]};const s=await this.providerService.getCommits(this.rootUri,{ref:a.HEAD.sha,path:o||void 0,cursor:r.cursor,limit:typeof r.limit=="number"?r.limit:void 0});if(s===void 0||s.commits.length===0||n.isCancellationRequested)return{items:[]};const l=((i=s.paging)==null?void 0:i.more)?{cursor:s.paging.cursor}:void 0,u=new Intl.DateTimeFormat(h.env.language,{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"}),d=P.getAny("git.timeline.date",void 0,"committed"),p=P.getAny("git.timeline.showAuthor",void 0,!0),f=s.commits.map(x=>new oi(this.rootUri,a.provider.id,x,this.resolveDiffCommand(x,a,e,o),{dateType:d,showAuthor:p,dateFormatter:u})),g=r.cursor===void 0?await this.changeStore.getChange(e):void 0;if(g){const x=Boolean(g.staged&&P.get("staging.enabled")),y=new Uo(this.rootUri,a.provider.id,g,[s.commits[0].hash],await this.changeStore.resolveDiffCommand(g.uri,this.providerService.getProviderUri(g.uri),x?Yt("diff title index","{0} (Index)",ce(g.uri)):Yt("diff title working","{0} (Working Tree)",ce(g.uri))),{dateFormatter:u,staged:x});f.splice(0,0,y)}return{items:f,paging:l}}catch(o){return C.error(o),{items:[]}}}ensureProviderRegistration(){this.providerDisposable===void 0&&(this.providerDisposable=h.workspace.registerTimelineProvider([Dt.scheme,...this.providerService.registeredProviders.map(e=>e.id)],this))}fireChanged(){this.debouncer.debounce(()=>this._onDidChange.fire(void 0))}registerCommands(){let e;return[h.commands.registerCommand("remoteHub.timeline.copyCommitId",(r,n,i)=>{!oi.is(r)||h.env.clipboard.writeText(r.hash)}),h.commands.registerCommand("remoteHub.timeline.copyCommitMessage",(r,n,i)=>{!oi.is(r)||h.env.clipboard.writeText(r.message)}),h.commands.registerCommand("remoteHub.timeline.openDiff",async(r,n,i)=>{var o;!oi.is(r)&&!Uo.is(r)||r.command!==void 0&&await h.commands.executeCommand(r.command.command,...(o=r.command.arguments)!=null?o:[])}),h.commands.registerCommand("remoteHub.timeline.openOnGitHub",async r=>{await this.openOnRemote(r)}),h.commands.registerCommand("remoteHub.timeline.openOnAzureRepos",async r=>{await this.openOnRemote(r)}),h.commands.registerCommand("remoteHub.timeline.selectForCompare",async(r,n,i)=>{!n||!oi.is(r)&&!Uo.is(r)||(e={uri:n,left:r},await h.commands.executeCommand("setContext","remoteHub.timeline.selectedForCompare",!0))}),h.commands.registerCommand("remoteHub.timeline.compareWithSelected",async(r,n,i)=>{if(!n||!e||!oi.is(r)&&!Uo.is(r)||H(n)!==H(e.uri))return;const{left:o}=e,a=this.providerService.getRelativeFilePath(r.rootUri,n),s=await this.providerService.getMetadata(r.rootUri),l=ce(n),u=o.parents[0];let d;u===void 0?d=Yt("timeline diff title ref","{0} ({1})",l,Ve(r.hash)):o.hash===""?d=Yt("timeline diff title working","{0} (Working Tree)",l):o.hash==="~"?d=Yt("timeline diff title index","{0} (Index)",l):d=Yt("timeline diff title ref","{0} ({1})",l,Ve(o.hash));let p=o.hash===""||o.hash==="~"?n:this.providerService.createProviderUri(n,{repo:s.repo,ref:{type:ke.Commit,id:u!=null?u:"0000000000000000000000000000000000000000"}},a);u===void 0&&(p=p.with({query:"~"}));const f=r.parents[0];let g;f===void 0?g=Yt("timeline diff title ref","{0} ({1})",l,Ve(r.hash)):f==="~"&&r.hash===""?g=Yt("timeline diff title working","{0} (Working Tree)",l):r.hash==="~"?g=Yt("timeline diff title index","{0} (Index)",l):g=Yt("timeline diff title ref","{0} ({1})",l,Ve(r.hash));const x=Yt("timeline diff title","{0} \u27F7 {1}",d,g),y=r.hash===""||r.hash==="~"?n:this.providerService.createProviderUri(n,{repo:s.repo,ref:{type:ke.Commit,id:r.hash}},a);await h.commands.executeCommand("vscode.diff",p,y,x)})]}resolveDiffCommand(e,r,n,i,o){const a=ce(n),s=e.parents[0];let l;s===void 0?l=Yt("timeline diff title ref","{0} ({1})",a,Ve(e.hash)):e.hash===""?l=Yt("timeline diff title working","{0} (Working Tree)",a):e.hash==="~"?l=Yt("timeline diff title index","{0} (Index)",a):l=Yt("timeline diff title refs","{0} ({1}) \u27F7  {0} ({2})",a,Ve(s),Ve(e.hash));let u=this.providerService.createProviderUri(n,{repo:r.repo,ref:{type:ke.Commit,id:s!=null?s:"0000000000000000000000000000000000000000"}},i);s===void 0&&(u=u.with({query:"~"}));const d=e.hash===""||e.hash==="~"?n:this.providerService.createProviderUri(n,{repo:r.repo,ref:{type:ke.Commit,id:e.hash}},i);return{command:"vscode.diff",title:"Open Comparison",arguments:[u,d,l,o]}}async openOnRemote(e){if(!oi.is(e))return;const r=await this.providerService.getMetadata(e.rootUri);await zh("remoteHub.openOnRemote",{provider:r.provider,repo:r.repo,sha:e.hash})}}c(xy,"VirtualTimelineProvider");class _y{constructor(e,r){this.providerService=e,this.telemetryService=r,this.disposable=h.window.registerUriHandler(this)}dispose(){this.disposable.dispose()}async handleUri(e){var r;const n=new Be(`RemoteUriHandler.handleUri(${e.path}, ${e.toString()})`);try{switch(e.path){case"/open":{this.telemetryService.sendEvent("handleUri.open");let i,o;for(const s of e.query.split("&")){const[l,u]=s.split("=");switch(l){case"url":i=decodeURIComponent(u);break;case"location":o=u===$t.CurrentWindow?$t.CurrentWindow:$t.NewWindow;break}}if(!i){n.log({message:": Unable to find url parameter"}),this.telemetryService.sendEvent("handleUri.open.abort",{reason:"aborted url not found"});return}i=i.trim(),o=o!=null?o:$t.NewWindow;const a=await this.providerService.createWorkspaceForRemoteUrl(i,void 0,o);if(!a){n.log({message:`: Unable to open workspace for ${i}`}),this.telemetryService.sendEvent("handleUri.open.abort",{reason:"aborted invalid url"});return}n.log({message:`: Opening ${i} in ${o}`}),sn(a);break}case"/open-files":{let i;for(const a of e.query.split("&")){const[s,l]=a.split("=");if(s==="url"){i=decodeURIComponent(l);break}}if(!i){n.log({message:": Unable to find url parameter"});return}i=i.trim();const o=await this.providerService.createWorkspaceForRemoteUrl(i);if(!o){n.log({message:`: Unable to open files/folders for ${i}`});return}o.filesToOpen?(n.log({message:`: Opening files/folders for ${i}`}),await((r=yu())==null?void 0:r.openPendingFiles(o.uri,o.filesToOpen))):n.log({message:`: No files/folders found to open for ${i}`});break}case"/login":{b0.fire(e);break}default:{n.log({message:`: Unknown Uri ${e.toString()}`});break}}}finally{n.stop()}}}c(_y,"RemoteUriHandler");const Kr=(0,A.loadMessageBundle)(),gc=c(class{constructor(t,e,r,n){this.providerService=t,this.storageService=e,this.changeStore=r,this.workspaceId=n,this._onDidChange=new h.EventEmitter,this.cache=new Map,this.lock=new ts("WorkspaceRepositories"),this.disposable=h.Disposable.from(this.providerService.onDidChangeRepositories(this.onRepositoriesChanged,this),this.providerService.onDidChangeRepository(this.onRepositoryChanged,this),this.changeStore.onDidChange(this.onChangeStoreChanged,this))}get onDidChange(){return this._onDidChange.event}dispose(){this.disposable.dispose()}async exportDebugInfo(){const t=await h.workspace.openTextDocument({language:"json",content:`Remote Repositories

${this.toStorage(await this.getCore())}`});return void h.window.showTextDocument(t)}onChangeStoreChanged(t){const e=Qf(t.map(r=>r.rootUri),r=>H(r)).map(r=>this.providerService.getRepository(r)).filter(r=>Boolean(r));this.addOrUpdate(e)}onRepositoriesChanged(t){this.addOrUpdate(t.added)}onRepositoryChanged(t){this.addOrUpdate([t.repository])}async get(t){let e=await this.lock.synchronizeRead(async()=>{let r=this.cache.get("workspaceRepositories");return r===void 0&&(r=[...(await this.getCore()).values()].sort((n,i)=>i.timestamp-n.timestamp),this.cache.set("workspaceRepositories",r)),r},"WorkspaceRepositories.get");if(t){const r=H(t);e=e.filter(n=>H(n.canonicalUri)===r)}return e}async getCore(){return this.fromStorage(await this.storageService.get(gc.storageKey))}async getByCanonicalUri(){let t=this.cache.get("groupedWorkspaceRepositories");return t===void 0&&(t=IE(await this.get(),e=>H(e.canonicalUri)),this.cache.set("groupedWorkspaceRepositories",t)),t}async getRecents(t=10){return(await this.get()).slice(0,t)}async getRemoteWorkspaceSourceProvider(){const t=await this.getRecents();if(t.length!==0)return{name:"Recents",label:"Open Recent Repository",icon:"$(history)",placeholder:Kr("pick","Choose a recent repository"),provideSources:function(e,r,n,i){return t.map(o=>({providerId:o.provider.id,name:o.name,icon:"$(repo)",description:Ms(o.timestamp,{ago:!0}),detail:`${o.provider.name}${o.pullRequest?`\xA0\xA0\u2022\xA0\xA0$(git-pull-request) Pull Request #${o.pullRequest.id}`:""}${Dt.isCanonicalUri(o.uri)?"":`\xA0\xA0\u2022\xA0\xA0${op(o.ref.type)} ${o.ref.name}`}\xA0\xA0\u2022\xA0\xA0${Cy(o.changes)}${o.idx?`\xA0\xA0\u2022\xA0\xA0${jE(o.idx.type)}`:""}`,workspace:{uri:o.uri,name:o.name,location:$t.CurrentWindow}}))}}}refresh(){this.cache.clear()}async remove(t){await this.lock.synchronizeWrite(async()=>{const e=await this.getCore(),r=`${t.workspaceId}/${H(t.uri)}`,n=e.get(r);if(n===void 0)return;const i=this.changeStore.getScopedChangeStore(n),o=await i.getChanges(n.uri);if(o.length!==0){const a={title:Kr("remove remote repo prompt confirm","Yes")},s={title:Kr("remove remote repo prompt cancel","No"),isCloseAffordance:!0};if(await h.window.showWarningMessage(o.length===1?Kr("remove remote repo prompt file changed",`This repository contains 1 file with uncommitted changes.

Removing it will cause those changes to be FOREVER LOST.
This is IRREVERSIBLE!

Are you sure you still want to remove it?`):Kr("remove remote repo prompt files changes",`This repository contains {0} files with uncommitted changes.

Removing it will cause those changes to be FOREVER LOST.
This is IRREVERSIBLE!

Are you sure you still want to remove it?`,o.length),{modal:!0,useCustom:!0},a,s)!==a)return;await i.discardAll(n.uri)}this.cache.clear(),e.delete(r);try{await this.storageService.store(gc.storageKey,this.toStorage(e))}catch(a){throw C.error(a,"Failed to save workspace repositories"),a}},"WorkspaceRepositories.remove"),this._onDidChange.fire()}async addOrUpdate(t){await this.lock.synchronizeWrite(async()=>{this.cache.clear();const e=await this.getCore();for(const r of t){const[{HEAD:n,pullRequest:i},o]=await Promise.all([r.getMetadata(),r.getIndexMetadata()]),a=await this.changeStore.getChanges(r.uri);e.set(`${this.workspaceId}/${H(r.uri)}`,{workspaceId:this.workspaceId,uri:r.uri,canonicalUri:r.canonicalUri,name:r.name,provider:r.provider,ref:{type:n.type,name:n.name},idx:(o==null?void 0:o.type)&&Oe.hasIndex(o.type)?{type:o.type}:void 0,pullRequest:i?{id:i.id}:void 0,changes:XE(a),timestamp:Date.now()})}try{await this.storageService.store(gc.storageKey,this.toStorage(e)),bi(jn.HasRecentRepositories,e.size>0)}catch(r){throw C.error(r,"Failed to save workspace repositories"),r}},"WorkspaceRepositories.addOrUpdate"),this._onDidChange.fire()}fromStorage(t){if(!t)return new Map;try{const e=JSON.parse(t,(r,n)=>(r==="uri"||r.endsWith("Uri"))&&rt(n)?h.Uri.from(n):n);return new Map(e.workspaceRepositories)}catch(e){return C.error(e,"Failed to deserialize workspace repositories"),new Map}}toStorage(t){const e={schemaVersion:gc.storageSchemaVersion,workspaceRepositories:[...t]};return JSON.stringify(e)}},"_WorkspaceRepositories");let cp=gc;cp.storageKey="workspaceRepositories",cp.storageSchemaVersion=1;function Sy(t){return t!==void 0&&(t.added!==0||t.changed!==0||t.deleted!==0)}c(Sy,"hasChanges");function ZE(t){return Sy(t.changes)}c(ZE,"hasUncommittedChanges");function XE(t){let e=0,r=0,n=0;for(const i of t)switch(i.type){case ut.Created:e++;break;case ut.Changed:r++;break;case ut.Deleted:n++;break}return e||r||n?{added:e,changed:r,deleted:n,timestamp:Date.now()}:void 0}c(XE,"toChangesSummary");function Cy(t,{compact:e=!0,preamble:r,separator:n=", ",short:i=!1,single:o=!1}={}){if(!Sy(t))return Kr("no changes","Everything up to date");const{added:a,changed:s,deleted:l}=t;if(o){const d=a+s+l;return d===1?Kr("summary change","{0} change",d):Kr("changes changes","{0} changes",d)}let u=`${r!=null?r:""}`;return(a||!e)&&(u+=i?`+${a}`:a===1?Kr("file added","{0} file added",a):Kr("files added","{0} files added",a),(s||l||!e)&&(u+=n)),(s||!e)&&(u+=i?`~${s}`:s===1?Kr("file changed","{0} file changed",s):Kr("files changed","{0} files changed",s),(l||!e)&&(u+=n)),(l||!e)&&(u+=i?`-${l}`:l===1?Kr("file deleted","{0} file deleted",l):Kr("files deleted","{0} files deleted",l)),u}c(Cy,"formatChangesSummary");var QE=Object.defineProperty,YE=Object.getOwnPropertyDescriptor,JE=c((t,e,r,n)=>{for(var i=n>1?void 0:n?YE(e,r):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&QE(e,r,i),i},"view_decorateClass"),Ua;(function(t){t.Change="remoteHub:viewItem:change",t.WorkspaceRepository="remoteHub:viewItem:workspaceRepository",t.WorkspaceRepositories="remoteHub:viewItem:workspaceRepositories",t.Message="remoteHub:viewItem:message"})(Ua||(Ua={}));const Ey=c(class{constructor(t,e){this.view=t,this.parent=e,this.splatted=!1}static is(t){return t instanceof Ey}get id(){}toString(){return`${C.toLoggableName(this)}${this.id!==void 0?`(${this.id})`:""}`}getParent(){var t,e;return((t=this.parent)==null?void 0:t.splatted)?(e=this.parent)==null?void 0:e.getParent():this.parent}triggerChange(t=!1,e=!1,r){return this.splatted&&this.parent!==void 0&&this.parent!==r?this.parent.triggerChange(t,e):this.view.refreshNode(this,t,e)}},"_ViewNode");let La=Ey;JE([Sr((t=!1,e=!1,r)=>JSON.stringify([t,e,r==null?void 0:r.toString()]))],La.prototype,"triggerChange",1);class Ry{constructor(e,r,n,i){this.id=e,this.name=r,this.providerService=n,this.telemetryService=i,this._onDidChangeTreeData=new h.EventEmitter,this.disposables=[];const o=!1;if(C.isDebugging&&o){const a=this.getTreeItem;this.getTreeItem=async function(s){var l;const u=await a.apply(this,[s]),d=s.getParent();return u.tooltip===void 0&&(u.tooltip=new h.MarkdownString(u.label!==void 0&&typeof u.label!="string"?u.label.label:(l=u.label)!=null?l:"")),typeof u.tooltip=="string"?u.tooltip=`${u.tooltip}

---
context: ${u.contextValue}
node: ${s.toString()}${d!==void 0?`
parent: ${d.toString()}`:""}`:u.tooltip.appendMarkdown(`

---

context: \`${u.contextValue}\`\\
node: \`${s.toString()}\`${d!==void 0?`\\
parent: \`${d.toString()}\``:""}`),u}}this.disposables.push(...this.registerCommands()),this.initialize({showCollapseAll:this.showCollapseAll}),setTimeout(()=>this.onConfigurationChanged(),0)}get onDidChangeTreeData(){return this._onDidChangeTreeData.event}get showCollapseAll(){return!0}filterConfigurationChanged(e){return!!P.changed(e,`views.${this.configKey}`)}dispose(){h.Disposable.from(...this.disposables).dispose()}get title(){return this._title}set title(e){this._title=e,this.tree!==void 0&&(this.tree.title=e)}get description(){return this._description}set description(e){this._description=e,this.tree!==void 0&&(this.tree.description=e)}get message(){return this._message}set message(e){this._message=e,this.tree!==void 0&&(this.tree.message=e)}getQualifiedCommand(e){return`${this.id}.${e}`}onConfigurationChanged(e){e!==void 0&&this.root!==void 0&&this.refresh(!0)}initialize(e={}){this.tree=h.window.createTreeView(this.id,{...e,treeDataProvider:this}),this.disposables.push(P.onDidChange(r=>{!this.filterConfigurationChanged(r)||(this._config=void 0,this.onConfigurationChanged(r))},this),this.tree),this._title=this.tree.title}ensureRoot(e=!1){return(this.root===void 0||e)&&(this.telemetryService.sendEvent("view.open",{view:this.id}),this.root=this.getRoot()),this.root}getChildren(e){return e!==void 0?e.getChildren():this.ensureRoot().getChildren()}getParent(e){return e.getParent()}getTreeItem(e){return e.getTreeItem()}get selection(){return this.tree===void 0||this.root===void 0?[]:[...this.tree.selection]}get visible(){return this.tree!==void 0?this.tree.visible:!1}async refresh(e=!1){var r,n;await((n=(r=this.root)==null?void 0:r.refresh)==null?void 0:n.call(r,e)),this.triggerNodeChange()}async refreshNode(e,r=!1,n=!1){var i;const o=await((i=e.refresh)==null?void 0:i.call(e,r));!n&&o===!0||this.triggerNodeChange(e)}async reveal(e,r){if(this.tree!==void 0)try{await this.tree.reveal(e,r)}catch(n){C.error(n)}}async show(){try{await h.commands.executeCommand(`${this.id}.focus`)}catch(e){C.error(e)}}triggerNodeChange(e){this._onDidChangeTreeData.fire(e!==void 0&&e!==this.root?e:void 0)}get config(){return this._config===void 0&&(this._config=P.get("views")[this.configKey]),this._config}}c(Ry,"View");class Ay extends La{constructor(e,r,n,i,o,a,s){super(e,r);this._message=n,this._description=i,this._tooltip=o,this._iconPath=a,this._contextValue=s}getChildren(){return[]}getTreeItem(){var e;const r=new h.TreeItem(this._message,h.TreeItemCollapsibleState.None);return r.contextValue=(e=this._contextValue)!=null?e:Ua.Message,r.description=this._description,r.tooltip=this._tooltip,r.iconPath=this._iconPath,r}}c(Ay,"MessageNode");var eR=Object.defineProperty,tR=Object.getOwnPropertyDescriptor,lp=c((t,e,r,n)=>{for(var i=n>1?void 0:n?tR(e,r):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&eR(e,r,i),i},"workspaceRepositoriesView_decorateClass");const vr=(0,A.loadMessageBundle)(),Ty=c(class extends La{constructor(t,e,r,n,i,o,a){super(t,e);this.changeStore=r,this.canonical=n,this.workspaceRepository=i,this.operation=o,this.canApplyChanges=a}static getId(t,e,r){return`${mc.getId(t,e)}:${this.key}(${r.uri.toString()})`}get id(){return Ty.getId(this.canonical.uri,this.workspaceRepository,this.operation)}getChildren(){return[]}async getTreeItem(){const t=this.view.providerService.getRelativeFilePath(this.workspaceRepository.uri,this.operation.uri),e=new h.TreeItem(t,h.TreeItemCollapsibleState.None);return e.id=this.id,e.contextValue=`${Ua.Change}${this.canApplyChanges?"+apply":""}`,e.resourceUri=this.view.changeStore.getScopedUri(this.operation.uri,this.workspaceRepository),e.command=await this.getDiffCommand(t,!0),e}async getDiffCommand(t,e=!1){if(e||this._command===void 0){const r=Boolean(this.operation.staged&&P.get("staging.enabled"));if(this.workspaceRepository.workspaceId===this.view.workspaceId){const n=this.view.providerService.getProviderUri(this.operation.uri);this._command=await this.changeStore.resolveDiffCommand(this.operation.uri,n,r?vr("diff title index","{0} (Index)",ce(this.operation.uri),this.workspaceRepository.ref.name):vr("diff title working","{0} (Working Tree)",ce(this.operation.uri),this.workspaceRepository.ref.name))}else{const{repo:n}=this.view.providerService.getVirtualUriMetadata(this.workspaceRepository.uri),i=this.view.providerService.createProviderUri(this.operation.uri,{repo:n,ref:{type:ke.Commit,id:this.operation.revision}},t);this._command=await this.changeStore.resolveDiffCommand(this.operation.uri,i,r?vr("diff title changeset index","{0} (Index of {1})",ce(this.operation.uri),this.workspaceRepository.ref.name):vr("diff title changeset working","{0} (Working Tree of {1})",ce(this.operation.uri),this.workspaceRepository.ref.name))}}return this._command}async openChanges(){var t;const e=await this.getDiffCommand(this.view.providerService.getRelativeFilePath(this.workspaceRepository.uri,this.operation.uri));await h.commands.executeCommand(e.command,...(t=e.arguments)!=null?t:[])}async openFile(){const t=this.view.changeStore.getScopedUri(this.operation.uri,this.workspaceRepository.workspaceId);await h.window.showTextDocument(t)}async applyChanges(){const t=await this.view.getRepositoryToApplyChangesetTo(this.workspaceRepository);if(t!==void 0)try{await this.view.changeStore.applyChangeset(t.uri,this.workspaceRepository,this.operation)}catch(e){h.window.showErrorMessage(String(e))}}},"_FileChangeNode");let ky=Ty;ky.key=":changes";const Iy=c(class extends La{constructor(t,e,r,n,i){super(t,e);this.canonical=r,this.workspaceRepository=n,this.root=i}static getId(t,e){return`${vu.getId(t)}:${this.key}(${e.workspaceId}/${e.uri.toString()})`}get id(){return Iy.getId(this.canonical.uri,this.workspaceRepository)}get name(){return this.workspaceRepository.name}get uri(){return this.workspaceRepository.uri}canApplyChanges(){if(!this.canonical.hasActive||h.workspace.getWorkspaceFolder(this.workspaceRepository.uri)!==void 0)return!1;const{changes:e}=this.workspaceRepository;return e!==void 0&&(e.added!==0||e.changed!==0||e.deleted!==0)}async getChildren(){if(this._children===void 0){const t=this.view.changeStore.getScopedChangeStore(this.workspaceRepository),e=await t.getChanges(this.workspaceRepository.uri);this._children=e.map(r=>new ky(this.view,this,t,this.canonical,this.workspaceRepository,r,this.canApplyChanges()))}return this._children}getTreeItem(){const t=this.workspaceRepository.workspaceId===this.view.workspaceId,e=ZE(this.workspaceRepository),r=Dt.isCanonicalUri(this.workspaceRepository.uri)?vr("repositories view repository default ref","{0} (default)",this.workspaceRepository.ref.name):this.workspaceRepository.ref.name,n=new h.TreeItem(this.root?this.canonical.name:r,e?h.TreeItemCollapsibleState.Collapsed:h.TreeItemCollapsibleState.None);return n.id=this.id,n.contextValue=`${Ua.WorkspaceRepository}${t?"+active":""}${this.canApplyChanges()?"+apply":""}`,n.description=`${this.root?`${this.workspaceRepository.ref.name}\xA0\xA0\u2022\xA0\xA0`:""}${Ms(this.workspaceRepository.timestamp,{ago:!0})}`,n.iconPath=t?new h.ThemeIcon("check"):this.root?Fy(this.canonical.provider.id):VE(this.workspaceRepository.ref.type,this.workspaceRepository.pullRequest),n.tooltip=new h.MarkdownString(void 0,!0).appendMarkdown(vr("repositories view repository tooltip",`{0}{1}\\
{2} {3} {4}{5}\\
Last accessed {6}

{7}
`,this.canonical.name,this.workspaceRepository.pullRequest?vr("pull request",`\\
Pull request {0} #{1}`,"$(git-pull-request)",this.workspaceRepository.pullRequest.id):"",rR(this.workspaceRepository.ref.type),op(this.workspaceRepository.ref.type),r,t?` \u2014 _${vr("repositories view repository tooltip active","Active")}_ `:"",Ms(this.workspaceRepository.timestamp,{ago:!0}),Cy(this.workspaceRepository.changes,{preamble:`${vr("repositories view has changes","Has Uncommitted Changes")}\\
`}))),e&&(n.resourceUri=h.Uri.parse("remotehub-view://wsrepo/changes")),n}refresh(t=!1){t&&(this._children=void 0)}async applyAllChanges(){const t=await this.view.getRepositoryToApplyChangesetTo(this.workspaceRepository);if(t!==void 0)try{await this.view.changeStore.applyChangeset(t.uri,this.workspaceRepository)}catch(e){h.window.showErrorMessage(String(e))}}remove(){return this.view.workspaceRepositories.remove(this.workspaceRepository)}},"_WorkspaceRepositoryNode");let mc=Iy;mc.key=":wsrepo",lp([Sr()],mc.prototype,"refresh",1);const Dy=c(class extends La{constructor(t,e,r,n){super(t,e);this.canonical=r,this.workspaceRepositories=n}static getId(t){return`remoteHub${this.key}(${t.toString()})`}get id(){return Dy.getId(this.canonical.uri)}get name(){return this.canonical.name}get uri(){return this.canonical.uri}getChildren(){if(this.children===void 0){const t=this.workspaceRepositories;if(t.length===0)return this.view.message=void 0,[new Ay(this.view,this,vr("repositories view message empty","No GitHub repositories could be found."))];this.view.message=void 0,this.children=t.map(e=>new mc(this.view,this,this.canonical,e,!1))}return this.children}getTreeItem(){const t=this.workspaceRepositories.some(r=>r.workspaceId===this.view.workspaceId),e=new h.TreeItem(this.canonical.name,t?h.TreeItemCollapsibleState.Expanded:h.TreeItemCollapsibleState.Collapsed);return e.contextValue=Ua.WorkspaceRepositories,e.iconPath=Fy(this.canonical.provider.id),e}refresh(t=!1){t&&(this.children=void 0)}},"_CanonicalWorkspaceRepositoryNode");let vu=Dy;vu.key=":wsrepos",lp([Sr()],vu.prototype,"refresh",1);class up extends La{constructor(e){super(e);this.splatted=!0}async getChildren(){if(this.children===void 0){const e=await this.view.workspaceRepositories.getByCanonicalUri();if(e.size===0)return[];this.view.message=void 0;const r=[];for(const[n,i]of e){const o=h.Uri.parse(n);try{const{name:a,provider:s}=this.view.providerService.getVirtualUriMetadata(o),l={uri:o,name:a,provider:s,hasActive:i.some(u=>u.workspaceId===this.view.workspaceId)};i.length===1?r.push(new mc(this.view,this,l,i[0],!0)):r.push(new vu(this.view,this,l,i))}catch(a){if(a instanceof yt)continue;C.error(a)}}this.children=r}return this.children}getTreeItem(){return new h.TreeItem("Repositories",h.TreeItemCollapsibleState.Expanded)}refresh(e=!1){e&&(this.children=void 0)}}c(up,"WorkspaceRepositoriesViewNode"),lp([Sr()],up.prototype,"refresh",1);class Py extends Ry{constructor(e,r,n,i,o){super("remoteHub.views.workspaceRepositories",vr("remote view title","GitHub Repositories"),e,o);this.workspaceRepositories=r,this.changeStore=n,this.workspaceId=i,this.configKey="workspaceRepositories",this.disposables.push(this.workspaceRepositories.onDidChange(this.onRepositoriesChanged,this),h.window.registerFileDecorationProvider({provideFileDecoration:(a,s)=>{if(!(a.scheme!=="remotehub-view"||a.authority!=="wsrepo"||!a.path.includes("/changes")))return{badge:"\u25CF",color:new h.ThemeColor("remoteHub.decorations.workspaceRepositoriesView.hasUncommittedChangesForegroundColor"),tooltip:vr("repositories view decoration has changes","Has Uncommitted Changes")}}}))}getRoot(){return new up(this)}onRepositoriesChanged(){this.refresh(!0)}registerCommands(){return[h.commands.registerCommand(this.getQualifiedCommand("refresh"),()=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.refresh"),this.workspaceRepositories.refresh(),void this.refresh(!0)),this),h.commands.registerCommand(this.getQualifiedCommand("open"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.open"),sn({name:e.name,uri:e.uri,location:$t.CurrentWindow})),this),h.commands.registerCommand(this.getQualifiedCommand("openInNewWindow"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.openInNewWindow"),sn({name:e.name,uri:e.uri,location:$t.NewWindow})),this),h.commands.registerCommand(this.getQualifiedCommand("applyAllChanges"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.applyAllChanges"),e.applyAllChanges()),this),h.commands.registerCommand(this.getQualifiedCommand("remove"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.remove"),e.remove()),this),h.commands.registerCommand(this.getQualifiedCommand("openChanges"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.openChanges"),e.openChanges()),this),h.commands.registerCommand(this.getQualifiedCommand("openFile"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.openFile"),e.openFile()),this),h.commands.registerCommand(this.getQualifiedCommand("applyChanges"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.applyChanges"),e.applyChanges()),this)]}async getRepositoryToApplyChangesetTo(e){const r=H(this.providerService.getVirtualCanonicalRootUri(e.uri)),n=this.providerService.repositories.filter(o=>H(o.canonicalUri)===r);return await nR(n,vr("apply changeset pick repository placeholder","Choose a repository to apply the changeset to"))}}c(Py,"WorkspaceRepositoriesView");function rR(t,e){switch(t){case he.Branch:return e?vr("type pr branch","Pull Request #{0}",e.id):vr("type branch","Branch");case he.RemoteBranch:return e?vr("type pr remote branch","Pull Request #{0}",e.id):vr("type remote branch","Remote Branch");case he.Tag:return vr("type tag","Tag");case he.Commit:return vr("type commit","Commit")}}c(rR,"headTypeToString");function Fy(t){switch(t){case"github":return new h.ThemeIcon("github");case"azurerepos":return new h.ThemeIcon("azure-devops");default:return new h.ThemeIcon("vm")}}c(Fy,"providerToIconPath");async function nR(t,e){if(t.length!==0){if(t.length>1){const r=await h.window.showQuickPick(t.map(n=>({label:n.name,description:n.provider.name,repository:n})),{placeHolder:e});return r?r.repository:void 0}return t[0]}}c(nR,"getRepository");const $y=(0,A.loadMessageBundle)();let wu;function yu(){return wu}c(yu,"getOpenActionsService");var Lo;(function(t){t.HasCommitted="has:committed",t.Version="version"})(Lo||(Lo={}));let dp;function Ny(t){return dp.globalState.get(t)}c(Ny,"getState");async function hp(t,e){return dp.globalState.update(t,e)}c(hp,"updateState");let My=!1;function By(){return My}c(By,"isInsiders");async function iR(t){dp=t,j.configure(t),C.configure(t,P.get("logLevel")),Be.start("Time to root directory",{log:!1});const e=t.extension.packageJSON.displayName;if(t.extension.id.toLowerCase()==="github.remotehub-insiders"){My=!0;const o=h.extensions.getExtension("GitHub.remotehub");if(o!==void 0){const a=o.packageJSON.displayName;C.warn(`${e} was NOT activated because ${a} is also enabled`),setTimeout(()=>void h.window.showErrorMessage($y("more than one version enabled warning","{0} cannot be used while {1} is also enabled. Please ensure that only one version is enabled.",e,a),$y("ok","OK")),0);return}}const r=Bh.configure(t),n=new Is(t),i=t.extension.packageJSON.version;await hp(Lo.Version,i),await t.workspaceState.update(Lo.Version,i);try{const o=new gu(t.globalState),a=o.with(r),s=new mu(t.globalStorageUri,r),l=new Ke(a),u=new Dt(l,n),d=new ns(u,a,s,n,r);d.getWorkspacesWithChanges(),wu=new vy(u,o,d);const p=new yy(u,d,wu,n),f=new Zw(t.globalStorageUri,u),g=new Cv(u,f),x=new cp(u,o,d,r);return t.subscriptions.push(P.onDidChange(y=>{!P.changed(y,"logLevel")||(C.logLevel=P.get("logLevel"))}),u.onDidChangeRepositories(async y=>{for(const b of y.added)try{const S=await b.getMetadata(),{HEAD:E,defaultBranch:D,name:$,provider:z,pullRequest:re}=S,ne=E.name.replace(/\//g,"\u2009\u2215\u2009");let ee=" ";if(re!==void 0)ee=` (PR ${re.id}) `;else if(E.type===he.Tag)ee=` (${ne}) `;else if(E.type===he.Commit)ee=` (${ne}) `;else if(E.type===he.Branch||E.type===he.RemoteBranch){const oe=E.branch.name.replace(/\//g,"\u2009\u2215\u2009");E.branch.name!==D.name&&(ee=` (${oe})`)}const we={uri:b.uri,type:"folder",label:`${$}${ee}[${z.name}]`};h.commands.executeCommand("_workbench.addToRecentlyOpened",we)}catch(S){C.error(S,"Failed to add repository to recently opened")}}),new wy(u,d),new v0,new qs(u,d),new _y(u,n),...h_(u,d,x,t.extension.id,n),...cR(u,d,n),...oR(u,d,p,f,t,n),new xy(u,d),new Py(u,x,d,r,n),f,x,p,wu,d,u,n),n.sendEvent("activate"),Promise.resolve(g)}catch(o){throw C.error(o),o}}c(iR,"activate");function oR(t,e,r,n,i,o){const a=Oy()?new bv(t,o):void 0;return[aR(t,e,a,r,n),...P.get("azureRepos.enabled")?[new Co(i),sR(t,e,a)]:[]]}c(oR,"registerProviders");function aR(t,e,r,n,i){const o=new hu(t,i),a=new lc(t,o,e,i);async function s(){var u;try{let d=(u=h.extensions.getExtension("GitHub.vscode-pull-request-github"))!=null?u:h.extensions.getExtension("GitHub.vscode-pull-request-github-insiders");d||(C.log("[ GHPR] Not currently installed or enabled; waiting..."),await new Promise(b=>{const S=h.extensions.onDidChange(()=>{var E;d=(E=h.extensions.getExtension("GitHub.vscode-pull-request-github"))!=null?E:h.extensions.getExtension("GitHub.vscode-pull-request-github-insiders"),d&&(S.dispose(),b())})})),C.log("[ GHPR] Registering..."),bi(jn.HasPullRequestExtension,!0);const p=await d.activate();if(!p)throw new Error("Unable to get registration api");const f=p.registerGitProvider(n),g=t.onDidChangeRepositories(b=>x(b));async function x(b){const S=b.added.filter(E=>E.provider.id==="github");if(S.length!==0){C.log("[ GHPR] Checking for opened PRs...");for(const E of S){const D=await t.getBestRemoteUri(E.uri,at.PullRequest);if(!!D){g.dispose(),C.log("[ GHPR] Opened PR found; preloading"),h.commands.executeCommand("github.api.preloadPullRequest",D.toString());return}}C.log("[ GHPR] No opened PRs found")}}c(x,"onRepositoriesChanged"),C.log("[ GHPR] Registration complete");const y=t.repositories;return y.length&&x({added:y,removed:[]}),h.Disposable.from(f,g)}catch(d){return C.error(d,"[ GHPR] Registration failed;"),{dispose:()=>{}}}}c(s,"registerWithGHPR");const l=s();return h.Disposable.from(t.register("github","GitHub",o,a,r),o,a,{dispose:async()=>{var u;return void((u=await l)==null?void 0:u.dispose())}})}c(aR,"registerGitHub");function sR(t,e,r){const n=new Xh(t),i=new Fs(t,n,e);return h.Disposable.from(t.register("azurerepos","Azure Repos",n,i,r),n,i)}c(sR,"registerAzDO");function cR(t,e,r){if(!Oy())return[];r.publicLog2("codex.enableRichNav",{});const n=new I0(t,e);return[n,n.register(new hf(r)),...hf.createStatus()]}c(cR,"registerNavigationServiceProviders");function Oy(){return h.env.uiKind===h.UIKind.Desktop||P.get("richNavigation.enabled")===!0}c(Oy,"isRichNavEnabled")})(),module.exports=__webpack_exports__})();
