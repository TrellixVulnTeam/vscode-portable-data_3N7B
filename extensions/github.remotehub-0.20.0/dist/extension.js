var Ay=Object.defineProperty;var a=(m,B)=>Ay(m,"name",{value:B,configurable:!0});(()=>{var __webpack_modules__={879:(m,B)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),B.ByteStream=void 0;class K{constructor(j){this.bytes=j,this.byteIndexCurrent=0}hasMoreBytes(){return this.byteIndexCurrent<this.bytes.length}readBytes(j){const se=this.byteIndexCurrent;return this.byteIndexCurrent+=j,this.bytes.slice(se,this.byteIndexCurrent)}readByte(){let j=this.bytes[this.byteIndexCurrent];return this.byteIndexCurrent++,j}readString(j){let se=[];const ne=this.byteIndexCurrent+j;let ue=this.byteIndexCurrent;for(;ue<ne;){const ce=this.bytes[ue++];if(ce===0)break;let z=0,H=0;for((ce&128)==0?(z=ce,H=0):(ce&224)==192?(z=ce&31,H=1):(ce&240)==224?(z=ce&15,H=2):(ce&248)==240&&(z=ce&15,H=3);H>0;)z=z<<6|this.bytes[ue++]&63,H--;se.push(String.fromCodePoint(z))}return this.byteIndexCurrent=ne,se.join("")}}a(K,"ByteStream"),B.ByteStream=K},7106:(m,B)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),B.ChunkSize=B.HeaderSizeInBytes=B.FileNameMaxLength=void 0,B.FileNameMaxLength=99,B.HeaderSizeInBytes=500,B.ChunkSize=512},5759:(m,B,K)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),B.TarFile=void 0;const q=K(879),j=K(7106),se=K(4108),ne=K(3335);class ue{constructor(z){this.entries=z}static fromBytes(z){const H=new q.ByteStream(z),M=[],X=j.ChunkSize;let pe=0;for(;H.hasMoreBytes()==!0;){const Y=H.readBytes(X);let Ve=!0;for(let qe=0;qe<Y.length;qe++)if(Y[qe]!=0){Ve=!1;break}if(Ve==!0){if(pe++,pe==2)break}else{pe=0;const qe=se.TarFileEntry.fromBytes(Y,H);M.push(qe)}}let F=new ue(M);return F.consolidateLongPathEntries(),F}consolidateLongPathEntries(){var z;const H=ne.TarFileTypeFlag.Instances().LongFilePath.name,M=this.entries;for(let X=0;X<M.length;X++){const pe=M[X];if(((z=pe.header.typeFlag)===null||z===void 0?void 0:z.name)==H){const F=M[X+1];F.header.fileName=pe.dataAsBytes.reduce((Y,Ve)=>Y+=String.fromCharCode(Ve),""),F.header.fileName=F.header.fileName.replace(/\0/g,""),M.splice(X,1),X--}}}}a(ue,"TarFile"),B.TarFile=ue},4108:(m,B,K)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),B.TarFileEntry=void 0;const q=K(7106),j=K(2895);class se{constructor(ue,ce){this.header=ue,this.dataAsBytes=ce}static fromBytes(ue,ce){const z=q.ChunkSize,H=j.TarFileEntryHeader.fromBytes(ue),M=H.fileSizeInBytes,pe=Math.ceil(M/z)*z,F=ce.readBytes(pe).slice(0,M);return new se(H,F)}}a(se,"TarFileEntry"),B.TarFileEntry=se},2895:(m,B,K)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),B.TarFileEntryHeader=void 0;const q=K(879),j=K(3335);class se{constructor(ue,ce,z,H,M,X,pe,F,Y,Ve,qe,at,we,Ee,be,L){this.fileName=ue,this.fileMode=ce,this.userIDOfOwner=z,this.userIDOfGroup=H,this.fileSizeInBytes=M,this.timeModifiedInUnixFormat=X,this.checksum=pe,this.typeFlag=F,this.nameOfLinkedFile=Y,this.uStarIndicator=Ve,this.uStarVersion=qe,this.userNameOfOwner=at,this.groupNameOfOwner=we,this.deviceNumberMajor=Ee,this.deviceNumberMinor=be,this.filenamePrefix=L,this.fullFileName=L.length?L.endsWith("/")?L+ue:L+"/"+ue:ue}static fromBytes(ue){const ce=new q.ByteStream(ue),z=ce.readString(100).trim(),H=ce.readString(8),M=ce.readString(8),X=ce.readString(8),pe=ce.readString(12),F=ce.readBytes(12),Y=ce.readString(8),Ve=ce.readString(1),qe=ce.readString(100),at=ce.readString(6),we=ce.readString(2),Ee=ce.readString(32),be=ce.readString(32),L=ce.readString(8),he=ce.readString(8),te=ce.readString(155),Te=ce.readBytes(12),le=parseInt(pe.trim(),8),de=parseInt(Y,8),Ce=j.TarFileTypeFlag.Instances()._All,Fe="_"+Ve,We=Ce[Fe];return new se(z,H,M,X,le,F,de,We,qe,at,we,Ee,be,L,he,te)}}a(se,"TarFileEntryHeader"),B.TarFileEntryHeader=se},3335:(m,B)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),B.TarFileTypeFlag=void 0;class K{constructor(se,ne){this.value=se,this.id="_"+this.value,this.name=ne}static Instances(){return K._instances==null&&(K._instances=new q),K._instances}}a(K,"TarFileTypeFlag"),B.TarFileTypeFlag=K;class q{constructor(){this.Normal=new K("0","Normal"),this.HardLink=new K("1","Hard Link"),this.SymbolicLink=new K("2","Symbolic Link"),this.CharacterSpecial=new K("3","Character Special"),this.BlockSpecial=new K("4","Block Special"),this.Directory=new K("5","Directory"),this.FIFO=new K("6","FIFO"),this.ContiguousFile=new K("7","Contiguous File"),this.LongFilePath=new K("L","././@LongLink"),this._All=[this.Normal,this.HardLink,this.SymbolicLink,this.CharacterSpecial,this.BlockSpecial,this.Directory,this.FIFO,this.ContiguousFile,this.LongFilePath];for(let se=0;se<this._All.length;se++){const ne=this._All[se];this._All[ne.id]=ne}}}a(q,"TarFileTypeFlag_Instances")},5790:(m,B,K)=>{"use strict";var q;q={value:!0},B.t9=q=q=q=void 0;const j=K(5759);q={enumerable:!0,get:function(){return j.TarFile}};const se=K(4108);q={enumerable:!0,get:function(){return se.TarFileEntry}};const ne=K(2895);q={enumerable:!0,get:function(){return ne.TarFileEntryHeader}},B.t9=ue=>j.TarFile.fromBytes(ue)},271:(m,B,K)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0});var q=K(7185);class j extends q.EventTarget{constructor(){super();throw new TypeError("AbortSignal cannot be constructed directly")}get aborted(){const X=ue.get(this);if(typeof X!="boolean")throw new TypeError(`Expected 'this' to be an 'AbortSignal' object, but got ${this===null?"null":typeof this}`);return X}}a(j,"AbortSignal"),q.defineEventAttribute(j.prototype,"abort");function se(){const M=Object.create(j.prototype);return q.EventTarget.call(M),ue.set(M,!1),M}a(se,"createAbortSignal");function ne(M){ue.get(M)===!1&&(ue.set(M,!0),M.dispatchEvent({type:"abort"}))}a(ne,"abortSignal");const ue=new WeakMap;Object.defineProperties(j.prototype,{aborted:{enumerable:!0}}),typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(j.prototype,Symbol.toStringTag,{configurable:!0,value:"AbortSignal"});class ce{constructor(){z.set(this,se())}get signal(){return H(this)}abort(){ne(H(this))}}a(ce,"AbortController");const z=new WeakMap;function H(M){const X=z.get(M);if(X==null)throw new TypeError(`Expected 'this' to be an 'AbortController' object, but got ${M===null?"null":typeof M}`);return X}a(H,"getSignal"),Object.defineProperties(ce.prototype,{signal:{enumerable:!0},abort:{enumerable:!0}}),typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(ce.prototype,Symbol.toStringTag,{configurable:!0,value:"AbortController"}),B.AbortController=ce,B.AbortSignal=j,B.default=ce,m.exports=ce,m.exports.AbortController=m.exports.default=ce,m.exports.AbortSignal=j},5186:(m,B,K)=>{var q=K(3698),j=K(2505),se=K(6417),ne=Function.bind,ue=ne.bind(ne);function ce(pe,F,Y){var Ve=ue(se,null).apply(null,Y?[F,Y]:[F]);pe.api={remove:Ve},pe.remove=Ve,["before","error","after","wrap"].forEach(function(qe){var at=Y?[F,qe,Y]:[F,qe];pe[qe]=pe.api[qe]=ue(j,null).apply(null,at)})}a(ce,"bindApi");function z(){var pe="h",F={registry:{}},Y=q.bind(null,F,pe);return ce(Y,F,pe),Y}a(z,"HookSingular");function H(){var pe={registry:{}},F=q.bind(null,pe);return ce(F,pe),F}a(H,"HookCollection");var M=!1;function X(){return M||(console.warn('[before-after-hook]: "Hook()" repurposing warning, use "Hook.Collection()". Read more: https://git.io/upgrade-before-after-hook-to-1.4'),M=!0),H()}a(X,"Hook"),X.Singular=z.bind(),X.Collection=H.bind(),m.exports=X,m.exports.Hook=X,m.exports.Singular=X.Singular,m.exports.Collection=X.Collection},2505:m=>{m.exports=B;function B(K,q,j,se){var ne=se;K.registry[j]||(K.registry[j]=[]),q==="before"&&(se=a(function(ue,ce){return Promise.resolve().then(ne.bind(null,ce)).then(ue.bind(null,ce))},"hook")),q==="after"&&(se=a(function(ue,ce){var z;return Promise.resolve().then(ue.bind(null,ce)).then(function(H){return z=H,ne(z,ce)}).then(function(){return z})},"hook")),q==="error"&&(se=a(function(ue,ce){return Promise.resolve().then(ue.bind(null,ce)).catch(function(z){return ne(z,ce)})},"hook")),K.registry[j].push({hook:se,orig:ne})}a(B,"addHook")},3698:m=>{m.exports=B;function B(K,q,j,se){if(typeof j!="function")throw new Error("method for before hook must be a function");return se||(se={}),Array.isArray(q)?q.reverse().reduce(function(ne,ue){return B.bind(null,K,ue,ne,se)},j)():Promise.resolve().then(function(){return K.registry[q]?K.registry[q].reduce(function(ne,ue){return ue.hook.bind(null,ne,se)},j)():j(se)})}a(B,"register")},6417:m=>{m.exports=B;function B(K,q,j){if(!!K.registry[q]){var se=K.registry[q].map(function(ne){return ne.orig}).indexOf(j);se!==-1&&K.registry[q].splice(se,1)}}a(B,"removeHook")},6744:(m,B,K)=>{"use strict";const q=K(3349),j=K(7529),se=K(8050),ne=K(4339),ue=a((ce,z={})=>{let H=[];if(Array.isArray(ce))for(let M of ce){let X=ue.create(M,z);Array.isArray(X)?H.push(...X):H.push(X)}else H=[].concat(ue.create(ce,z));return z&&z.expand===!0&&z.nodupes===!0&&(H=[...new Set(H)]),H},"braces");ue.parse=(ce,z={})=>ne(ce,z),ue.stringify=(ce,z={})=>q(typeof ce=="string"?ue.parse(ce,z):ce,z),ue.compile=(ce,z={})=>(typeof ce=="string"&&(ce=ue.parse(ce,z)),j(ce,z)),ue.expand=(ce,z={})=>{typeof ce=="string"&&(ce=ue.parse(ce,z));let H=se(ce,z);return z.noempty===!0&&(H=H.filter(Boolean)),z.nodupes===!0&&(H=[...new Set(H)]),H},ue.create=(ce,z={})=>ce===""||ce.length<3?[ce]:z.expand!==!0?ue.compile(ce,z):ue.expand(ce,z),m.exports=ue},7529:(m,B,K)=>{"use strict";const q=K(2664),j=K(3083),se=a((ne,ue={})=>{let ce=a((z,H={})=>{let M=j.isInvalidBrace(H),X=z.invalid===!0&&ue.escapeInvalid===!0,pe=M===!0||X===!0,F=ue.escapeInvalid===!0?"\\":"",Y="";if(z.isOpen===!0||z.isClose===!0)return F+z.value;if(z.type==="open")return pe?F+z.value:"(";if(z.type==="close")return pe?F+z.value:")";if(z.type==="comma")return z.prev.type==="comma"?"":pe?z.value:"|";if(z.value)return z.value;if(z.nodes&&z.ranges>0){let Ve=j.reduce(z.nodes),qe=q(...Ve,{...ue,wrap:!1,toRegex:!0});if(qe.length!==0)return Ve.length>1&&qe.length>1?`(${qe})`:qe}if(z.nodes)for(let Ve of z.nodes)Y+=ce(Ve,z);return Y},"walk");return ce(ne)},"compile");m.exports=se},6611:m=>{"use strict";m.exports={MAX_LENGTH:1024*64,CHAR_0:"0",CHAR_9:"9",CHAR_UPPERCASE_A:"A",CHAR_LOWERCASE_A:"a",CHAR_UPPERCASE_Z:"Z",CHAR_LOWERCASE_Z:"z",CHAR_LEFT_PARENTHESES:"(",CHAR_RIGHT_PARENTHESES:")",CHAR_ASTERISK:"*",CHAR_AMPERSAND:"&",CHAR_AT:"@",CHAR_BACKSLASH:"\\",CHAR_BACKTICK:"`",CHAR_CARRIAGE_RETURN:"\r",CHAR_CIRCUMFLEX_ACCENT:"^",CHAR_COLON:":",CHAR_COMMA:",",CHAR_DOLLAR:"$",CHAR_DOT:".",CHAR_DOUBLE_QUOTE:'"',CHAR_EQUAL:"=",CHAR_EXCLAMATION_MARK:"!",CHAR_FORM_FEED:"\f",CHAR_FORWARD_SLASH:"/",CHAR_HASH:"#",CHAR_HYPHEN_MINUS:"-",CHAR_LEFT_ANGLE_BRACKET:"<",CHAR_LEFT_CURLY_BRACE:"{",CHAR_LEFT_SQUARE_BRACKET:"[",CHAR_LINE_FEED:`
`,CHAR_NO_BREAK_SPACE:"\xA0",CHAR_PERCENT:"%",CHAR_PLUS:"+",CHAR_QUESTION_MARK:"?",CHAR_RIGHT_ANGLE_BRACKET:">",CHAR_RIGHT_CURLY_BRACE:"}",CHAR_RIGHT_SQUARE_BRACKET:"]",CHAR_SEMICOLON:";",CHAR_SINGLE_QUOTE:"'",CHAR_SPACE:" ",CHAR_TAB:"	",CHAR_UNDERSCORE:"_",CHAR_VERTICAL_LINE:"|",CHAR_ZERO_WIDTH_NOBREAK_SPACE:"\uFEFF"}},8050:(m,B,K)=>{"use strict";const q=K(2664),j=K(3349),se=K(3083),ne=a((ce="",z="",H=!1)=>{let M=[];if(ce=[].concat(ce),z=[].concat(z),!z.length)return ce;if(!ce.length)return H?se.flatten(z).map(X=>`{${X}}`):z;for(let X of ce)if(Array.isArray(X))for(let pe of X)M.push(ne(pe,z,H));else for(let pe of z)H===!0&&typeof pe=="string"&&(pe=`{${pe}}`),M.push(Array.isArray(pe)?ne(X,pe,H):X+pe);return se.flatten(M)},"append"),ue=a((ce,z={})=>{let H=z.rangeLimit===void 0?1e3:z.rangeLimit,M=a((X,pe={})=>{X.queue=[];let F=pe,Y=pe.queue;for(;F.type!=="brace"&&F.type!=="root"&&F.parent;)F=F.parent,Y=F.queue;if(X.invalid||X.dollar){Y.push(ne(Y.pop(),j(X,z)));return}if(X.type==="brace"&&X.invalid!==!0&&X.nodes.length===2){Y.push(ne(Y.pop(),["{}"]));return}if(X.nodes&&X.ranges>0){let we=se.reduce(X.nodes);if(se.exceedsLimit(...we,z.step,H))throw new RangeError("expanded array length exceeds range limit. Use options.rangeLimit to increase or disable the limit.");let Ee=q(...we,z);Ee.length===0&&(Ee=j(X,z)),Y.push(ne(Y.pop(),Ee)),X.nodes=[];return}let Ve=se.encloseBrace(X),qe=X.queue,at=X;for(;at.type!=="brace"&&at.type!=="root"&&at.parent;)at=at.parent,qe=at.queue;for(let we=0;we<X.nodes.length;we++){let Ee=X.nodes[we];if(Ee.type==="comma"&&X.type==="brace"){we===1&&qe.push(""),qe.push("");continue}if(Ee.type==="close"){Y.push(ne(Y.pop(),qe,Ve));continue}if(Ee.value&&Ee.type!=="open"){qe.push(ne(qe.pop(),Ee.value));continue}Ee.nodes&&M(Ee,X)}return qe},"walk");return se.flatten(M(ce))},"expand");m.exports=ue},4339:(m,B,K)=>{"use strict";const q=K(3349),{MAX_LENGTH:j,CHAR_BACKSLASH:se,CHAR_BACKTICK:ne,CHAR_COMMA:ue,CHAR_DOT:ce,CHAR_LEFT_PARENTHESES:z,CHAR_RIGHT_PARENTHESES:H,CHAR_LEFT_CURLY_BRACE:M,CHAR_RIGHT_CURLY_BRACE:X,CHAR_LEFT_SQUARE_BRACKET:pe,CHAR_RIGHT_SQUARE_BRACKET:F,CHAR_DOUBLE_QUOTE:Y,CHAR_SINGLE_QUOTE:Ve,CHAR_NO_BREAK_SPACE:qe,CHAR_ZERO_WIDTH_NOBREAK_SPACE:at}=K(6611),we=a((Ee,be={})=>{if(typeof Ee!="string")throw new TypeError("Expected a string");let L=be||{},he=typeof L.maxLength=="number"?Math.min(j,L.maxLength):j;if(Ee.length>he)throw new SyntaxError(`Input length (${Ee.length}), exceeds max characters (${he})`);let te={type:"root",input:Ee,nodes:[]},Te=[te],le=te,de=te,Ce=0,Fe=Ee.length,We=0,et=0,ve,Ue={};const Xe=a(()=>Ee[We++],"advance"),Ke=a(Ne=>{if(Ne.type==="text"&&de.type==="dot"&&(de.type="text"),de&&de.type==="text"&&Ne.type==="text"){de.value+=Ne.value;return}return le.nodes.push(Ne),Ne.parent=le,Ne.prev=de,de=Ne,Ne},"push");for(Ke({type:"bos"});We<Fe;)if(le=Te[Te.length-1],ve=Xe(),!(ve===at||ve===qe)){if(ve===se){Ke({type:"text",value:(be.keepEscaping?ve:"")+Xe()});continue}if(ve===F){Ke({type:"text",value:"\\"+ve});continue}if(ve===pe){Ce++;let Ne=!0,Pe;for(;We<Fe&&(Pe=Xe());){if(ve+=Pe,Pe===pe){Ce++;continue}if(Pe===se){ve+=Xe();continue}if(Pe===F&&(Ce--,Ce===0))break}Ke({type:"text",value:ve});continue}if(ve===z){le=Ke({type:"paren",nodes:[]}),Te.push(le),Ke({type:"text",value:ve});continue}if(ve===H){if(le.type!=="paren"){Ke({type:"text",value:ve});continue}le=Te.pop(),Ke({type:"text",value:ve}),le=Te[Te.length-1];continue}if(ve===Y||ve===Ve||ve===ne){let Ne=ve,Pe;for(be.keepQuotes!==!0&&(ve="");We<Fe&&(Pe=Xe());){if(Pe===se){ve+=Pe+Xe();continue}if(Pe===Ne){be.keepQuotes===!0&&(ve+=Pe);break}ve+=Pe}Ke({type:"text",value:ve});continue}if(ve===M){et++;let Ne=de.value&&de.value.slice(-1)==="$"||le.dollar===!0;le=Ke({type:"brace",open:!0,close:!1,dollar:Ne,depth:et,commas:0,ranges:0,nodes:[]}),Te.push(le),Ke({type:"open",value:ve});continue}if(ve===X){if(le.type!=="brace"){Ke({type:"text",value:ve});continue}let Ne="close";le=Te.pop(),le.close=!0,Ke({type:Ne,value:ve}),et--,le=Te[Te.length-1];continue}if(ve===ue&&et>0){if(le.ranges>0){le.ranges=0;let Ne=le.nodes.shift();le.nodes=[Ne,{type:"text",value:q(le)}]}Ke({type:"comma",value:ve}),le.commas++;continue}if(ve===ce&&et>0&&le.commas===0){let Ne=le.nodes;if(et===0||Ne.length===0){Ke({type:"text",value:ve});continue}if(de.type==="dot"){if(le.range=[],de.value+=ve,de.type="range",le.nodes.length!==3&&le.nodes.length!==5){le.invalid=!0,le.ranges=0,de.type="text";continue}le.ranges++,le.args=[];continue}if(de.type==="range"){Ne.pop();let Pe=Ne[Ne.length-1];Pe.value+=de.value+ve,de=Pe,le.ranges--;continue}Ke({type:"dot",value:ve});continue}Ke({type:"text",value:ve})}do if(le=Te.pop(),le.type!=="root"){le.nodes.forEach(pt=>{pt.nodes||(pt.type==="open"&&(pt.isOpen=!0),pt.type==="close"&&(pt.isClose=!0),pt.nodes||(pt.type="text"),pt.invalid=!0)});let Ne=Te[Te.length-1],Pe=Ne.nodes.indexOf(le);Ne.nodes.splice(Pe,1,...le.nodes)}while(Te.length>0);return Ke({type:"eos"}),te},"parse");m.exports=we},3349:(m,B,K)=>{"use strict";const q=K(3083);m.exports=(j,se={})=>{let ne=a((ue,ce={})=>{let z=se.escapeInvalid&&q.isInvalidBrace(ce),H=ue.invalid===!0&&se.escapeInvalid===!0,M="";if(ue.value)return(z||H)&&q.isOpenOrClose(ue)?"\\"+ue.value:ue.value;if(ue.value)return ue.value;if(ue.nodes)for(let X of ue.nodes)M+=ne(X);return M},"stringify");return ne(j)}},3083:(m,B)=>{"use strict";B.isInteger=K=>typeof K=="number"?Number.isInteger(K):typeof K=="string"&&K.trim()!==""?Number.isInteger(Number(K)):!1,B.find=(K,q)=>K.nodes.find(j=>j.type===q),B.exceedsLimit=(K,q,j=1,se)=>se===!1||!B.isInteger(K)||!B.isInteger(q)?!1:(Number(q)-Number(K))/Number(j)>=se,B.escapeNode=(K,q=0,j)=>{let se=K.nodes[q];!se||(j&&se.type===j||se.type==="open"||se.type==="close")&&se.escaped!==!0&&(se.value="\\"+se.value,se.escaped=!0)},B.encloseBrace=K=>K.type!=="brace"?!1:K.commas>>0+K.ranges>>0==0?(K.invalid=!0,!0):!1,B.isInvalidBrace=K=>K.type!=="brace"?!1:K.invalid===!0||K.dollar?!0:K.commas>>0+K.ranges>>0==0||K.open!==!0||K.close!==!0?(K.invalid=!0,!0):!1,B.isOpenOrClose=K=>K.type==="open"||K.type==="close"?!0:K.open===!0||K.close===!0,B.reduce=K=>K.reduce((q,j)=>(j.type==="text"&&q.push(j.value),j.type==="range"&&(j.type="text"),q),[]),B.flatten=(...K)=>{const q=[],j=a(se=>{for(let ne=0;ne<se.length;ne++){let ue=se[ne];Array.isArray(ue)?j(ue,q):ue!==void 0&&q.push(ue)}return q},"flat");return j(K),q}},6724:()=>{},7185:(m,B)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0});const K=new WeakMap,q=new WeakMap;function j(le){const de=K.get(le);return console.assert(de!=null,"'this' is expected an Event object, but got",le),de}a(j,"pd");function se(le){if(le.passiveListener!=null){typeof console!="undefined"&&typeof console.error=="function"&&console.error("Unable to preventDefault inside passive event listener invocation.",le.passiveListener);return}!le.event.cancelable||(le.canceled=!0,typeof le.event.preventDefault=="function"&&le.event.preventDefault())}a(se,"setCancelFlag");function ne(le,de){K.set(this,{eventTarget:le,event:de,eventPhase:2,currentTarget:le,canceled:!1,stopped:!1,immediateStopped:!1,passiveListener:null,timeStamp:de.timeStamp||Date.now()}),Object.defineProperty(this,"isTrusted",{value:!1,enumerable:!0});const Ce=Object.keys(de);for(let Fe=0;Fe<Ce.length;++Fe){const We=Ce[Fe];We in this||Object.defineProperty(this,We,ue(We))}}a(ne,"Event"),ne.prototype={get type(){return j(this).event.type},get target(){return j(this).eventTarget},get currentTarget(){return j(this).currentTarget},composedPath(){const le=j(this).currentTarget;return le==null?[]:[le]},get NONE(){return 0},get CAPTURING_PHASE(){return 1},get AT_TARGET(){return 2},get BUBBLING_PHASE(){return 3},get eventPhase(){return j(this).eventPhase},stopPropagation(){const le=j(this);le.stopped=!0,typeof le.event.stopPropagation=="function"&&le.event.stopPropagation()},stopImmediatePropagation(){const le=j(this);le.stopped=!0,le.immediateStopped=!0,typeof le.event.stopImmediatePropagation=="function"&&le.event.stopImmediatePropagation()},get bubbles(){return Boolean(j(this).event.bubbles)},get cancelable(){return Boolean(j(this).event.cancelable)},preventDefault(){se(j(this))},get defaultPrevented(){return j(this).canceled},get composed(){return Boolean(j(this).event.composed)},get timeStamp(){return j(this).timeStamp},get srcElement(){return j(this).eventTarget},get cancelBubble(){return j(this).stopped},set cancelBubble(le){if(!le)return;const de=j(this);de.stopped=!0,typeof de.event.cancelBubble=="boolean"&&(de.event.cancelBubble=!0)},get returnValue(){return!j(this).canceled},set returnValue(le){le||se(j(this))},initEvent(){}},Object.defineProperty(ne.prototype,"constructor",{value:ne,configurable:!0,writable:!0}),typeof window!="undefined"&&typeof window.Event!="undefined"&&(Object.setPrototypeOf(ne.prototype,window.Event.prototype),q.set(window.Event.prototype,ne));function ue(le){return{get(){return j(this).event[le]},set(de){j(this).event[le]=de},configurable:!0,enumerable:!0}}a(ue,"defineRedirectDescriptor");function ce(le){return{value(){const de=j(this).event;return de[le].apply(de,arguments)},configurable:!0,enumerable:!0}}a(ce,"defineCallDescriptor");function z(le,de){const Ce=Object.keys(de);if(Ce.length===0)return le;function Fe(We,et){le.call(this,We,et)}a(Fe,"CustomEvent"),Fe.prototype=Object.create(le.prototype,{constructor:{value:Fe,configurable:!0,writable:!0}});for(let We=0;We<Ce.length;++We){const et=Ce[We];if(!(et in le.prototype)){const Ue=typeof Object.getOwnPropertyDescriptor(de,et).value=="function";Object.defineProperty(Fe.prototype,et,Ue?ce(et):ue(et))}}return Fe}a(z,"defineWrapper");function H(le){if(le==null||le===Object.prototype)return ne;let de=q.get(le);return de==null&&(de=z(H(Object.getPrototypeOf(le)),le),q.set(le,de)),de}a(H,"getWrapper");function M(le,de){const Ce=H(Object.getPrototypeOf(de));return new Ce(le,de)}a(M,"wrapEvent");function X(le){return j(le).immediateStopped}a(X,"isStopped");function pe(le,de){j(le).eventPhase=de}a(pe,"setEventPhase");function F(le,de){j(le).currentTarget=de}a(F,"setCurrentTarget");function Y(le,de){j(le).passiveListener=de}a(Y,"setPassiveListener");const Ve=new WeakMap,qe=1,at=2,we=3;function Ee(le){return le!==null&&typeof le=="object"}a(Ee,"isObject");function be(le){const de=Ve.get(le);if(de==null)throw new TypeError("'this' is expected an EventTarget object, but got another value.");return de}a(be,"getListeners");function L(le){return{get(){let Ce=be(this).get(le);for(;Ce!=null;){if(Ce.listenerType===we)return Ce.listener;Ce=Ce.next}return null},set(de){typeof de!="function"&&!Ee(de)&&(de=null);const Ce=be(this);let Fe=null,We=Ce.get(le);for(;We!=null;)We.listenerType===we?Fe!==null?Fe.next=We.next:We.next!==null?Ce.set(le,We.next):Ce.delete(le):Fe=We,We=We.next;if(de!==null){const et={listener:de,listenerType:we,passive:!1,once:!1,next:null};Fe===null?Ce.set(le,et):Fe.next=et}},configurable:!0,enumerable:!0}}a(L,"defineEventAttributeDescriptor");function he(le,de){Object.defineProperty(le,`on${de}`,L(de))}a(he,"defineEventAttribute");function te(le){function de(){Te.call(this)}a(de,"CustomEventTarget"),de.prototype=Object.create(Te.prototype,{constructor:{value:de,configurable:!0,writable:!0}});for(let Ce=0;Ce<le.length;++Ce)he(de.prototype,le[Ce]);return de}a(te,"defineCustomEventTarget");function Te(){if(this instanceof Te){Ve.set(this,new Map);return}if(arguments.length===1&&Array.isArray(arguments[0]))return te(arguments[0]);if(arguments.length>0){const le=new Array(arguments.length);for(let de=0;de<arguments.length;++de)le[de]=arguments[de];return te(le)}throw new TypeError("Cannot call a class as a function")}a(Te,"EventTarget"),Te.prototype={addEventListener(le,de,Ce){if(de==null)return;if(typeof de!="function"&&!Ee(de))throw new TypeError("'listener' should be a function or an object.");const Fe=be(this),We=Ee(Ce),ve=Boolean(We?Ce.capture:Ce)?qe:at,Ue={listener:de,listenerType:ve,passive:We&&Boolean(Ce.passive),once:We&&Boolean(Ce.once),next:null};let Xe=Fe.get(le);if(Xe===void 0){Fe.set(le,Ue);return}let Ke=null;for(;Xe!=null;){if(Xe.listener===de&&Xe.listenerType===ve)return;Ke=Xe,Xe=Xe.next}Ke.next=Ue},removeEventListener(le,de,Ce){if(de==null)return;const Fe=be(this),et=(Ee(Ce)?Boolean(Ce.capture):Boolean(Ce))?qe:at;let ve=null,Ue=Fe.get(le);for(;Ue!=null;){if(Ue.listener===de&&Ue.listenerType===et){ve!==null?ve.next=Ue.next:Ue.next!==null?Fe.set(le,Ue.next):Fe.delete(le);return}ve=Ue,Ue=Ue.next}},dispatchEvent(le){if(le==null||typeof le.type!="string")throw new TypeError('"event.type" should be a string.');const de=be(this),Ce=le.type;let Fe=de.get(Ce);if(Fe==null)return!0;const We=M(this,le);let et=null;for(;Fe!=null;){if(Fe.once?et!==null?et.next=Fe.next:Fe.next!==null?de.set(Ce,Fe.next):de.delete(Ce):et=Fe,Y(We,Fe.passive?Fe.listener:null),typeof Fe.listener=="function")try{Fe.listener.call(this,We)}catch(ve){typeof console!="undefined"&&typeof console.error=="function"&&console.error(ve)}else Fe.listenerType!==we&&typeof Fe.listener.handleEvent=="function"&&Fe.listener.handleEvent(We);if(X(We))break;Fe=Fe.next}return Y(We,null),pe(We,0),F(We,null),!We.defaultPrevented}},Object.defineProperty(Te.prototype,"constructor",{value:Te,configurable:!0,writable:!0}),typeof window!="undefined"&&typeof window.EventTarget!="undefined"&&Object.setPrototypeOf(Te.prototype,window.EventTarget.prototype),B.defineEventAttribute=he,B.EventTarget=Te,B.default=Te,m.exports=Te,m.exports.EventTarget=m.exports.default=Te,m.exports.defineEventAttribute=he},1:(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";const Token=__webpack_require__(3416),strtok3=__webpack_require__(5849),{stringToBytes,tarHeaderChecksumMatches,uint32SyncSafeToken}=__webpack_require__(6188),supported=__webpack_require__(9898),minimumBytes=4100;async function fromStream(m){const B=await strtok3.fromStream(m);try{return await fromTokenizer(B)}finally{await B.close()}}a(fromStream,"fromStream");async function fromBuffer(m){if(!(m instanceof Uint8Array||m instanceof ArrayBuffer||Buffer.isBuffer(m)))throw new TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`Buffer\` or \`ArrayBuffer\`, got \`${typeof m}\``);const B=m instanceof Buffer?m:Buffer.from(m);if(!(B&&B.length>1))return;const K=strtok3.fromBuffer(B);return fromTokenizer(K)}a(fromBuffer,"fromBuffer");function _check(m,B,K){K={offset:0,...K};for(const[q,j]of B.entries())if(K.mask){if(j!==(K.mask[q]&m[q+K.offset]))return!1}else if(j!==m[q+K.offset])return!1;return!0}a(_check,"_check");async function fromTokenizer(m){try{return _fromTokenizer(m)}catch(B){if(!(B instanceof strtok3.EndOfStreamError))throw B}}a(fromTokenizer,"fromTokenizer");async function _fromTokenizer(m){let B=Buffer.alloc(minimumBytes);const K=12,q=a((se,ne)=>_check(B,se,ne),"check"),j=a((se,ne)=>q(stringToBytes(se),ne),"checkString");if(m.fileInfo.size||(m.fileInfo.size=Number.MAX_SAFE_INTEGER),await m.peekBuffer(B,{length:K,mayBeLess:!0}),q([66,77]))return{ext:"bmp",mime:"image/bmp"};if(q([11,119]))return{ext:"ac3",mime:"audio/vnd.dolby.dd-raw"};if(q([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(q([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if(q([37,33]))return await m.peekBuffer(B,{length:24,mayBeLess:!0}),j("PS-Adobe-",{offset:2})&&j(" EPSF-",{offset:14})?{ext:"eps",mime:"application/eps"}:{ext:"ps",mime:"application/postscript"};if(q([31,160])||q([31,157]))return{ext:"Z",mime:"application/x-compress"};if(q([255,216,255]))return{ext:"jpg",mime:"image/jpeg"};if(q([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(q([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(q([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(j("ID3")){await m.ignore(6);const se=await m.readToken(uint32SyncSafeToken);return m.position+se>m.fileInfo.size?{ext:"mp3",mime:"audio/mpeg"}:(await m.ignore(se),fromTokenizer(m))}if(j("MP+"))return{ext:"mpc",mime:"audio/x-musepack"};if((B[0]===67||B[0]===70)&&q([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(q([71,73,70]))return{ext:"gif",mime:"image/gif"};if(j("FLIF"))return{ext:"flif",mime:"image/flif"};if(j("8BPS"))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(j("WEBP",{offset:8}))return{ext:"webp",mime:"image/webp"};if(j("MPCK"))return{ext:"mpc",mime:"audio/x-musepack"};if(j("FORM"))return{ext:"aif",mime:"audio/aiff"};if(j("icns",{offset:0}))return{ext:"icns",mime:"image/icns"};if(q([80,75,3,4])){try{for(;m.position+30<m.fileInfo.size;){await m.readBuffer(B,{length:30});const se={compressedSize:B.readUInt32LE(18),uncompressedSize:B.readUInt32LE(22),filenameLength:B.readUInt16LE(26),extraFieldLength:B.readUInt16LE(28)};if(se.filename=await m.readToken(new Token.StringType(se.filenameLength,"utf-8")),await m.ignore(se.extraFieldLength),se.filename==="META-INF/mozilla.rsa")return{ext:"xpi",mime:"application/x-xpinstall"};if(se.filename.endsWith(".rels")||se.filename.endsWith(".xml"))switch(se.filename.split("/")[0]){case"_rels":break;case"word":return{ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"};case"ppt":return{ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"};case"xl":return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};default:break}if(se.filename.startsWith("xl/"))return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};if(se.filename.startsWith("3D/")&&se.filename.endsWith(".model"))return{ext:"3mf",mime:"model/3mf"};if(se.filename==="mimetype"&&se.compressedSize===se.uncompressedSize)switch(await m.readToken(new Token.StringType(se.compressedSize,"utf-8"))){case"application/epub+zip":return{ext:"epub",mime:"application/epub+zip"};case"application/vnd.oasis.opendocument.text":return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};case"application/vnd.oasis.opendocument.spreadsheet":return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};case"application/vnd.oasis.opendocument.presentation":return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"};default:}if(se.compressedSize===0){let ne=-1;for(;ne<0&&m.position<m.fileInfo.size;)await m.peekBuffer(B,{mayBeLess:!0}),ne=B.indexOf("504B0304",0,"hex"),await m.ignore(ne>=0?ne:B.length)}else await m.ignore(se.compressedSize)}}catch(se){if(!(se instanceof strtok3.EndOfStreamError))throw se}return{ext:"zip",mime:"application/zip"}}if(j("OggS")){await m.ignore(28);const se=Buffer.alloc(8);return await m.readBuffer(se),_check(se,[79,112,117,115,72,101,97,100])?{ext:"opus",mime:"audio/opus"}:_check(se,[128,116,104,101,111,114,97])?{ext:"ogv",mime:"video/ogg"}:_check(se,[1,118,105,100,101,111,0])?{ext:"ogm",mime:"video/ogg"}:_check(se,[127,70,76,65,67])?{ext:"oga",mime:"audio/ogg"}:_check(se,[83,112,101,101,120,32,32])?{ext:"spx",mime:"audio/ogg"}:_check(se,[1,118,111,114,98,105,115])?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"}}if(q([80,75])&&(B[2]===3||B[2]===5||B[2]===7)&&(B[3]===4||B[3]===6||B[3]===8))return{ext:"zip",mime:"application/zip"};if(j("ftyp",{offset:4})&&(B[8]&96)!=0){const se=B.toString("binary",8,12).replace("\0"," ").trim();switch(se){case"avif":return{ext:"avif",mime:"image/avif"};case"mif1":return{ext:"heic",mime:"image/heif"};case"msf1":return{ext:"heic",mime:"image/heif-sequence"};case"heic":case"heix":return{ext:"heic",mime:"image/heic"};case"hevc":case"hevx":return{ext:"heic",mime:"image/heic-sequence"};case"qt":return{ext:"mov",mime:"video/quicktime"};case"M4V":case"M4VH":case"M4VP":return{ext:"m4v",mime:"video/x-m4v"};case"M4P":return{ext:"m4p",mime:"video/mp4"};case"M4B":return{ext:"m4b",mime:"audio/mp4"};case"M4A":return{ext:"m4a",mime:"audio/x-m4a"};case"F4V":return{ext:"f4v",mime:"video/mp4"};case"F4P":return{ext:"f4p",mime:"video/mp4"};case"F4A":return{ext:"f4a",mime:"audio/mp4"};case"F4B":return{ext:"f4b",mime:"audio/mp4"};case"crx":return{ext:"cr3",mime:"image/x-canon-cr3"};default:return se.startsWith("3g")?se.startsWith("3g2")?{ext:"3g2",mime:"video/3gpp2"}:{ext:"3gp",mime:"video/3gpp"}:{ext:"mp4",mime:"video/mp4"}}}if(j("MThd"))return{ext:"mid",mime:"audio/midi"};if(j("wOFF")&&(q([0,1,0,0],{offset:4})||j("OTTO",{offset:4})))return{ext:"woff",mime:"font/woff"};if(j("wOF2")&&(q([0,1,0,0],{offset:4})||j("OTTO",{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(q([212,195,178,161])||q([161,178,195,212]))return{ext:"pcap",mime:"application/vnd.tcpdump.pcap"};if(j("DSD "))return{ext:"dsf",mime:"audio/x-dsf"};if(j("LZIP"))return{ext:"lz",mime:"application/x-lzip"};if(j("fLaC"))return{ext:"flac",mime:"audio/x-flac"};if(q([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(j("wvpk"))return{ext:"wv",mime:"audio/wavpack"};if(j("%PDF")){await m.ignore(1350);const se=10*1024*1024,ne=Buffer.alloc(Math.min(se,m.fileInfo.size));return await m.readBuffer(ne,{mayBeLess:!0}),ne.includes(Buffer.from("AIPrivateData"))?{ext:"ai",mime:"application/postscript"}:{ext:"pdf",mime:"application/pdf"}}if(q([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(q([73,73,42,0]))return j("CR",{offset:8})?{ext:"cr2",mime:"image/x-canon-cr2"}:q([28,0,254,0],{offset:8})||q([31,0,11,0],{offset:8})?{ext:"nef",mime:"image/x-nikon-nef"}:q([8,0,0,0],{offset:4})&&(q([45,0,254,0],{offset:8})||q([39,0,254,0],{offset:8}))?{ext:"dng",mime:"image/x-adobe-dng"}:(B=Buffer.alloc(24),await m.peekBuffer(B),(q([16,251,134,1],{offset:4})||q([8,0,0,0],{offset:4}))&&q([0,254,0,4,0,1,0,0,0,1,0,0,0,3,1],{offset:9})?{ext:"arw",mime:"image/x-sony-arw"}:{ext:"tif",mime:"image/tiff"});if(q([77,77,0,42]))return{ext:"tif",mime:"image/tiff"};if(j("MAC "))return{ext:"ape",mime:"audio/ape"};if(q([26,69,223,163])){async function se(){const H=await m.peekNumber(Token.UINT8);let M=128,X=0;for(;(H&M)==0;)++X,M>>=1;const pe=Buffer.alloc(X+1);return await m.readBuffer(pe),pe}a(se,"readField");async function ne(){const H=await se(),M=await se();M[0]^=128>>M.length-1;const X=Math.min(6,M.length);return{id:H.readUIntBE(0,H.length),len:M.readUIntBE(M.length-X,X)}}a(ne,"readElement");async function ue(H,M){for(;M>0;){const X=await ne();if(X.id===17026)return m.readToken(new Token.StringType(X.len,"utf-8"));await m.ignore(X.len),--M}}a(ue,"readChildren");const ce=await ne();switch(await ue(1,ce.len)){case"webm":return{ext:"webm",mime:"video/webm"};case"matroska":return{ext:"mkv",mime:"video/x-matroska"};default:return}}if(q([82,73,70,70])){if(q([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(q([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/vnd.wave"};if(q([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(j("SQLi"))return{ext:"sqlite",mime:"application/x-sqlite3"};if(q([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(j("Cr24"))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(j("MSCF")||j("ISc("))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(q([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(q([197,208,211,198]))return{ext:"eps",mime:"application/eps"};if(q([40,181,47,253]))return{ext:"zst",mime:"application/zstd"};if(q([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(j("#!AMR"))return{ext:"amr",mime:"audio/amr"};if(j("{\\rtf"))return{ext:"rtf",mime:"application/rtf"};if(q([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(j("IMPM"))return{ext:"it",mime:"audio/x-it"};if(j("-lh0-",{offset:2})||j("-lh1-",{offset:2})||j("-lh2-",{offset:2})||j("-lh3-",{offset:2})||j("-lh4-",{offset:2})||j("-lh5-",{offset:2})||j("-lh6-",{offset:2})||j("-lh7-",{offset:2})||j("-lzs-",{offset:2})||j("-lz4-",{offset:2})||j("-lz5-",{offset:2})||j("-lhd-",{offset:2}))return{ext:"lzh",mime:"application/x-lzh-compressed"};if(q([0,0,1,186])){if(q([33],{offset:4,mask:[241]}))return{ext:"mpg",mime:"video/MP1S"};if(q([68],{offset:4,mask:[196]}))return{ext:"mpg",mime:"video/MP2P"}}if(j("ITSF"))return{ext:"chm",mime:"application/vnd.ms-htmlhelp"};if(q([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(j("<?xml "))return{ext:"xml",mime:"application/xml"};if(q([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(q([82,97,114,33,26,7])&&(B[6]===0||B[6]===1))return{ext:"rar",mime:"application/x-rar-compressed"};if(j("solid "))return{ext:"stl",mime:"model/stl"};if(j("BLENDER"))return{ext:"blend",mime:"application/x-blender"};if(j("!<arch>"))return await m.ignore(8),await m.readToken(new Token.StringType(13,"ascii"))==="debian-binary"?{ext:"deb",mime:"application/x-deb"}:{ext:"ar",mime:"application/x-unix-archive"};if(q([137,80,78,71,13,10,26,10])){await m.ignore(8);async function se(){return{length:await m.readToken(Token.INT32_BE),type:await m.readToken(new Token.StringType(4,"binary"))}}a(se,"readChunkHeader");do{const ne=await se();if(ne.length<0)return;switch(ne.type){case"IDAT":return{ext:"png",mime:"image/png"};case"acTL":return{ext:"apng",mime:"image/apng"};default:await m.ignore(ne.length+4)}}while(m.position+8<m.fileInfo.size);return{ext:"png",mime:"image/png"}}if(q([65,82,82,79,87,49,0,0]))return{ext:"arrow",mime:"application/x-apache-arrow"};if(q([103,108,84,70,2,0,0,0]))return{ext:"glb",mime:"model/gltf-binary"};if(q([102,114,101,101],{offset:4})||q([109,100,97,116],{offset:4})||q([109,111,111,118],{offset:4})||q([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(q([73,73,82,79,8,0,0,0,24]))return{ext:"orf",mime:"image/x-olympus-orf"};if(j("gimp xcf "))return{ext:"xcf",mime:"image/x-xcf"};if(q([73,73,85,0,24,0,0,0,136,231,116,216]))return{ext:"rw2",mime:"image/x-panasonic-rw2"};if(q([48,38,178,117,142,102,207,17,166,217])){async function se(){const ne=Buffer.alloc(16);return await m.readBuffer(ne),{id:ne,size:Number(await m.readToken(Token.UINT64_LE))}}for(a(se,"readHeader"),await m.ignore(30);m.position+24<m.fileInfo.size;){const ne=await se();let ue=ne.size-24;if(_check(ne.id,[145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101])){const ce=Buffer.alloc(16);if(ue-=await m.readBuffer(ce),_check(ce,[64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"audio/x-ms-asf"};if(_check(ce,[192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"video/x-ms-asf"};break}await m.ignore(ue)}return{ext:"asf",mime:"application/vnd.ms-asf"}}if(q([171,75,84,88,32,49,49,187,13,10,26,10]))return{ext:"ktx",mime:"image/ktx"};if((q([126,16,4])||q([126,24,4]))&&q([48,77,73,69],{offset:4}))return{ext:"mie",mime:"application/x-mie"};if(q([39,10,0,0,0,0,0,0,0,0,0,0],{offset:2}))return{ext:"shp",mime:"application/x-esri-shape"};if(q([0,0,0,12,106,80,32,32,13,10,135,10]))switch(await m.ignore(20),await m.readToken(new Token.StringType(4,"ascii"))){case"jp2 ":return{ext:"jp2",mime:"image/jp2"};case"jpx ":return{ext:"jpx",mime:"image/jpx"};case"jpm ":return{ext:"jpm",mime:"image/jpm"};case"mjp2":return{ext:"mj2",mime:"image/mj2"};default:return}if(q([255,10])||q([0,0,0,12,74,88,76,32,13,10,135,10]))return{ext:"jxl",mime:"image/jxl"};if(q([0,0,1,186])||q([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(q([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(q([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(q([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(q([208,207,17,224,161,177,26,225]))return{ext:"cfb",mime:"application/x-cfb"};if(await m.peekBuffer(B,{length:Math.min(256,m.fileInfo.size),mayBeLess:!0}),j("BEGIN:")){if(j("VCARD",{offset:6}))return{ext:"vcf",mime:"text/vcard"};if(j("VCALENDAR",{offset:6}))return{ext:"ics",mime:"text/calendar"}}if(j("FUJIFILMCCD-RAW"))return{ext:"raf",mime:"image/x-fujifilm-raf"};if(j("Extended Module:"))return{ext:"xm",mime:"audio/x-xm"};if(j("Creative Voice File"))return{ext:"voc",mime:"audio/x-voc"};if(q([4,0,0,0])&&B.length>=16){const se=B.readUInt32LE(12);if(se>12&&B.length>=se+16)try{const ne=B.slice(16,se+16).toString();if(JSON.parse(ne).files)return{ext:"asar",mime:"application/x-asar"}}catch(ne){}}if(q([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(j("SCRM",{offset:44}))return{ext:"s3m",mime:"audio/x-s3m"};if(q([71],{offset:4})&&(q([71],{offset:192})||q([71],{offset:196})))return{ext:"mts",mime:"video/mp2t"};if(q([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(q([68,73,67,77],{offset:128}))return{ext:"dcm",mime:"application/dicom"};if(q([76,0,0,0,1,20,2,0,0,0,0,0,192,0,0,0,0,0,0,70]))return{ext:"lnk",mime:"application/x.ms.shortcut"};if(q([98,111,111,107,0,0,0,0,109,97,114,107,0,0,0,0]))return{ext:"alias",mime:"application/x.apple.alias"};if(q([76,80],{offset:34})&&(q([0,0,1],{offset:8})||q([1,0,2],{offset:8})||q([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(q([6,6,237,245,216,29,70,229,189,49,239,231,254,116,183,29]))return{ext:"indd",mime:"application/x-indesign"};if(await m.peekBuffer(B,{length:Math.min(512,m.fileInfo.size),mayBeLess:!0}),tarHeaderChecksumMatches(B))return{ext:"tar",mime:"application/x-tar"};if(q([255,254,255,14,83,0,107,0,101,0,116,0,99,0,104,0,85,0,112,0,32,0,77,0,111,0,100,0,101,0,108,0]))return{ext:"skp",mime:"application/vnd.sketchup.skp"};if(j("-----BEGIN PGP MESSAGE-----"))return{ext:"pgp",mime:"application/pgp-encrypted"};if(B.length>=2&&q([255,224],{offset:0,mask:[255,224]})){if(q([16],{offset:1,mask:[22]}))return q([8],{offset:1,mask:[8]})?{ext:"aac",mime:"audio/aac"}:{ext:"aac",mime:"audio/aac"};if(q([2],{offset:1,mask:[6]}))return{ext:"mp3",mime:"audio/mpeg"};if(q([4],{offset:1,mask:[6]}))return{ext:"mp2",mime:"audio/mpeg"};if(q([6],{offset:1,mask:[6]}))return{ext:"mp1",mime:"audio/mpeg"}}}a(_fromTokenizer,"_fromTokenizer");const stream=a(readableStream=>new Promise((resolve,reject)=>{const stream=eval("require")("stream");readableStream.on("error",reject),readableStream.once("readable",async()=>{const m=new stream.PassThrough;let B;stream.pipeline?B=stream.pipeline(readableStream,m,()=>{}):B=readableStream.pipe(m);const K=readableStream.read(minimumBytes)||readableStream.read()||Buffer.alloc(0);try{const q=await fromBuffer(K);m.fileType=q}catch(q){reject(q)}resolve(B)})}),"stream"),fileType={fromStream,fromTokenizer,fromBuffer,stream};Object.defineProperty(fileType,"extensions",{get(){return new Set(supported.extensions)}}),Object.defineProperty(fileType,"mimeTypes",{get(){return new Set(supported.mimeTypes)}}),module.exports=fileType},7769:(m,B,K)=>{"use strict";const q=K(6597),j=K(1);async function se(ue){const ce=await q.fromFile(ue);try{return await j.fromTokenizer(ce)}finally{await ce.close()}}a(se,"fromFile");const ne={fromFile:se};Object.assign(ne,j),Object.defineProperty(ne,"extensions",{get(){return j.extensions}}),Object.defineProperty(ne,"mimeTypes",{get(){return j.mimeTypes}}),m.exports=ne},9898:m=>{"use strict";m.exports={extensions:["jpg","png","apng","gif","webp","flif","xcf","cr2","cr3","orf","arw","dng","nef","rw2","raf","tif","bmp","icns","jxr","psd","indd","zip","tar","rar","gz","bz2","7z","dmg","mp4","mid","mkv","webm","mov","avi","mpg","mp2","mp3","m4a","oga","ogg","ogv","opus","flac","wav","spx","amr","pdf","epub","exe","swf","rtf","wasm","woff","woff2","eot","ttf","otf","ico","flv","ps","xz","sqlite","nes","crx","xpi","cab","deb","ar","rpm","Z","lz","cfb","mxf","mts","blend","bpg","docx","pptx","xlsx","3gp","3g2","jp2","jpm","jpx","mj2","aif","qcp","odt","ods","odp","xml","mobi","heic","cur","ktx","ape","wv","dcm","ics","glb","pcap","dsf","lnk","alias","voc","ac3","m4v","m4p","m4b","f4v","f4p","f4b","f4a","mie","asf","ogm","ogx","mpc","arrow","shp","aac","mp1","it","s3m","xm","ai","skp","avif","eps","lzh","pgp","asar","stl","chm","3mf","zst","jxl","vcf"],mimeTypes:["image/jpeg","image/png","image/gif","image/webp","image/flif","image/x-xcf","image/x-canon-cr2","image/x-canon-cr3","image/tiff","image/bmp","image/vnd.ms-photo","image/vnd.adobe.photoshop","application/x-indesign","application/epub+zip","application/x-xpinstall","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.presentation","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/zip","application/x-tar","application/x-rar-compressed","application/gzip","application/x-bzip2","application/x-7z-compressed","application/x-apple-diskimage","application/x-apache-arrow","video/mp4","audio/midi","video/x-matroska","video/webm","video/quicktime","video/vnd.avi","audio/vnd.wave","audio/qcelp","audio/x-ms-asf","video/x-ms-asf","application/vnd.ms-asf","video/mpeg","video/3gpp","audio/mpeg","audio/mp4","audio/opus","video/ogg","audio/ogg","application/ogg","audio/x-flac","audio/ape","audio/wavpack","audio/amr","application/pdf","application/x-msdownload","application/x-shockwave-flash","application/rtf","application/wasm","font/woff","font/woff2","application/vnd.ms-fontobject","font/ttf","font/otf","image/x-icon","video/x-flv","application/postscript","application/eps","application/x-xz","application/x-sqlite3","application/x-nintendo-nes-rom","application/x-google-chrome-extension","application/vnd.ms-cab-compressed","application/x-deb","application/x-unix-archive","application/x-rpm","application/x-compress","application/x-lzip","application/x-cfb","application/x-mie","application/mxf","video/mp2t","application/x-blender","image/bpg","image/jp2","image/jpx","image/jpm","image/mj2","audio/aiff","application/xml","application/x-mobipocket-ebook","image/heif","image/heif-sequence","image/heic","image/heic-sequence","image/icns","image/ktx","application/dicom","audio/x-musepack","text/calendar","text/vcard","model/gltf-binary","application/vnd.tcpdump.pcap","audio/x-dsf","application/x.ms.shortcut","application/x.apple.alias","audio/x-voc","audio/vnd.dolby.dd-raw","audio/x-m4a","image/apng","image/x-olympus-orf","image/x-sony-arw","image/x-adobe-dng","image/x-nikon-nef","image/x-panasonic-rw2","image/x-fujifilm-raf","video/x-m4v","video/3gpp2","application/x-esri-shape","audio/aac","audio/x-it","audio/x-s3m","audio/x-xm","video/MP1S","video/MP2P","application/vnd.sketchup.skp","image/avif","application/x-lzh-compressed","application/pgp-encrypted","application/x-asar","model/stl","application/vnd.ms-htmlhelp","model/3mf","image/jxl","application/zstd"]}},6188:(m,B)=>{"use strict";B.stringToBytes=K=>[...K].map(q=>q.charCodeAt(0)),B.tarHeaderChecksumMatches=(K,q=0)=>{const j=parseInt(K.toString("utf8",148,154).replace(/\0.*$/,"").trim(),8);if(isNaN(j))return!1;let se=8*32;for(let ne=q;ne<q+148;ne++)se+=K[ne];for(let ne=q+156;ne<q+512;ne++)se+=K[ne];return j===se},B.uint32SyncSafeToken={get:(K,q)=>K[q+3]&127|K[q+2]<<7|K[q+1]<<14|K[q]<<21,len:4}},2664:(m,B,K)=>{"use strict";/*!
 * fill-range <https://github.com/jonschlinkert/fill-range>
 *
 * Copyright (c) 2014-present, Jon Schlinkert.
 * Licensed under the MIT License.
 */const q=K(3837),j=K(5702),se=a(L=>L!==null&&typeof L=="object"&&!Array.isArray(L),"isObject"),ne=a(L=>he=>L===!0?Number(he):String(he),"transform"),ue=a(L=>typeof L=="number"||typeof L=="string"&&L!=="","isValidValue"),ce=a(L=>Number.isInteger(+L),"isNumber"),z=a(L=>{let he=`${L}`,te=-1;if(he[0]==="-"&&(he=he.slice(1)),he==="0")return!1;for(;he[++te]==="0";);return te>0},"zeros"),H=a((L,he,te)=>typeof L=="string"||typeof he=="string"?!0:te.stringify===!0,"stringify"),M=a((L,he,te)=>{if(he>0){let Te=L[0]==="-"?"-":"";Te&&(L=L.slice(1)),L=Te+L.padStart(Te?he-1:he,"0")}return te===!1?String(L):L},"pad"),X=a((L,he)=>{let te=L[0]==="-"?"-":"";for(te&&(L=L.slice(1),he--);L.length<he;)L="0"+L;return te?"-"+L:L},"toMaxLen"),pe=a((L,he)=>{L.negatives.sort((Ce,Fe)=>Ce<Fe?-1:Ce>Fe?1:0),L.positives.sort((Ce,Fe)=>Ce<Fe?-1:Ce>Fe?1:0);let te=he.capture?"":"?:",Te="",le="",de;return L.positives.length&&(Te=L.positives.join("|")),L.negatives.length&&(le=`-(${te}${L.negatives.join("|")})`),Te&&le?de=`${Te}|${le}`:de=Te||le,he.wrap?`(${te}${de})`:de},"toSequence"),F=a((L,he,te,Te)=>{if(te)return j(L,he,{wrap:!1,...Te});let le=String.fromCharCode(L);if(L===he)return le;let de=String.fromCharCode(he);return`[${le}-${de}]`},"toRange"),Y=a((L,he,te)=>{if(Array.isArray(L)){let Te=te.wrap===!0,le=te.capture?"":"?:";return Te?`(${le}${L.join("|")})`:L.join("|")}return j(L,he,te)},"toRegex"),Ve=a((...L)=>new RangeError("Invalid range arguments: "+q.inspect(...L)),"rangeError"),qe=a((L,he,te)=>{if(te.strictRanges===!0)throw Ve([L,he]);return[]},"invalidRange"),at=a((L,he)=>{if(he.strictRanges===!0)throw new TypeError(`Expected step "${L}" to be a number`);return[]},"invalidStep"),we=a((L,he,te=1,Te={})=>{let le=Number(L),de=Number(he);if(!Number.isInteger(le)||!Number.isInteger(de)){if(Te.strictRanges===!0)throw Ve([L,he]);return[]}le===0&&(le=0),de===0&&(de=0);let Ce=le>de,Fe=String(L),We=String(he),et=String(te);te=Math.max(Math.abs(te),1);let ve=z(Fe)||z(We)||z(et),Ue=ve?Math.max(Fe.length,We.length,et.length):0,Xe=ve===!1&&H(L,he,Te)===!1,Ke=Te.transform||ne(Xe);if(Te.toRegex&&te===1)return F(X(L,Ue),X(he,Ue),!0,Te);let Ne={negatives:[],positives:[]},Pe=a(xe=>Ne[xe<0?"negatives":"positives"].push(Math.abs(xe)),"push"),pt=[],It=0;for(;Ce?le>=de:le<=de;)Te.toRegex===!0&&te>1?Pe(le):pt.push(M(Ke(le,It),Ue,Xe)),le=Ce?le-te:le+te,It++;return Te.toRegex===!0?te>1?pe(Ne,Te):Y(pt,null,{wrap:!1,...Te}):pt},"fillNumbers"),Ee=a((L,he,te=1,Te={})=>{if(!ce(L)&&L.length>1||!ce(he)&&he.length>1)return qe(L,he,Te);let le=Te.transform||(Xe=>String.fromCharCode(Xe)),de=`${L}`.charCodeAt(0),Ce=`${he}`.charCodeAt(0),Fe=de>Ce,We=Math.min(de,Ce),et=Math.max(de,Ce);if(Te.toRegex&&te===1)return F(We,et,!1,Te);let ve=[],Ue=0;for(;Fe?de>=Ce:de<=Ce;)ve.push(le(de,Ue)),de=Fe?de-te:de+te,Ue++;return Te.toRegex===!0?Y(ve,null,{wrap:!1,options:Te}):ve},"fillLetters"),be=a((L,he,te,Te={})=>{if(he==null&&ue(L))return[L];if(!ue(L)||!ue(he))return qe(L,he,Te);if(typeof te=="function")return be(L,he,1,{transform:te});if(se(te))return be(L,he,0,te);let le={...Te};return le.capture===!0&&(le.wrap=!0),te=te||le.step||1,ce(te)?ce(L)&&ce(he)?we(L,he,te,le):Ee(L,he,Math.max(Math.abs(te),1),le):te!=null&&!se(te)?at(te,le):be(L,he,1,te)},"fill");m.exports=be},7360:function(m,B){var K,q,j;(function(se,ne){q=[],K=ne,j=typeof K=="function"?K.apply(B,q):K,j!==void 0&&(m.exports=j)})(this,a(function(){function ne(we){var Ee={single:function(be,L,he){if(!be||(Ve(be)||(be=Ee.getPreparedSearch(be)),!L))return null;Ve(L)||(L=Ee.getPrepared(L));var te=he&&he.allowTypo!==void 0?he.allowTypo:we&&we.allowTypo!==void 0?we.allowTypo:!0,Te=te?Ee.algorithm:Ee.algorithmNoTypo;return Te(be,L,be[0])},go:function(be,L,he){if(!be)return H;be=Ee.prepareSearch(be);var te=be[0],Te=he&&he.threshold||we&&we.threshold||-9007199254740991,le=he&&he.limit||we&&we.limit||9007199254740991,de=he&&he.allowTypo!==void 0?he.allowTypo:we&&we.allowTypo!==void 0?we.allowTypo:!0,Ce=de?Ee.algorithm:Ee.algorithmNoTypo,Fe=0,We=0,et=L.length;if(he&&he.keys)for(var ve=he.scoreFn||F,Ue=he.keys,Xe=Ue.length,Ke=et-1;Ke>=0;--Ke){for(var Ne=L[Ke],Pe=new Array(Xe),pt=Xe-1;pt>=0;--pt){var It=Ue[pt],xe=Y(Ne,It);if(!xe){Pe[pt]=null;continue}Ve(xe)||(xe=Ee.getPrepared(xe)),Pe[pt]=Ce(be,xe,te)}Pe.obj=Ne;var Pt=ve(Pe);Pt!==null&&(Pt<Te||(Pe.score=Pt,Fe<le?(at.add(Pe),++Fe):(++We,Pt>at.peek().score&&at.replaceTop(Pe))))}else if(he&&he.key)for(var It=he.key,Ke=et-1;Ke>=0;--Ke){var Ne=L[Ke],xe=Y(Ne,It);if(!!xe){Ve(xe)||(xe=Ee.getPrepared(xe));var ht=Ce(be,xe,te);ht!==null&&(ht.score<Te||(ht={target:ht.target,_targetLowerCodes:null,_nextBeginningIndexes:null,score:ht.score,indexes:ht.indexes,obj:Ne},Fe<le?(at.add(ht),++Fe):(++We,ht.score>at.peek().score&&at.replaceTop(ht))))}}else for(var Ke=et-1;Ke>=0;--Ke){var xe=L[Ke];if(!!xe){Ve(xe)||(xe=Ee.getPrepared(xe));var ht=Ce(be,xe,te);ht!==null&&(ht.score<Te||(Fe<le?(at.add(ht),++Fe):(++We,ht.score>at.peek().score&&at.replaceTop(ht))))}}if(Fe===0)return H;for(var Ot=new Array(Fe),Ke=Fe-1;Ke>=0;--Ke)Ot[Ke]=at.poll();return Ot.total=Fe+We,Ot},goAsync:function(be,L,he){var te=!1,Te=new Promise(function(le,de){if(!be)return le(H);be=Ee.prepareSearch(be);var Ce=be[0],Fe=qe(),We=L.length-1,et=he&&he.threshold||we&&we.threshold||-9007199254740991,ve=he&&he.limit||we&&we.limit||9007199254740991,Ue=he&&he.allowTypo!==void 0?he.allowTypo:we&&we.allowTypo!==void 0?we.allowTypo:!0,Xe=Ue?Ee.algorithm:Ee.algorithmNoTypo,Ke=0,Ne=0;function Pe(){if(te)return de("canceled");var pt=Date.now();if(he&&he.keys)for(var It=he.scoreFn||F,xe=he.keys,Pt=xe.length;We>=0;--We){for(var ht=L[We],Ot=new Array(Pt),Be=Pt-1;Be>=0;--Be){var Le=xe[Be],_t=Y(ht,Le);if(!_t){Ot[Be]=null;continue}Ve(_t)||(_t=Ee.getPrepared(_t)),Ot[Be]=Xe(be,_t,Ce)}Ot.obj=ht;var xt=It(Ot);if(xt!==null&&!(xt<et)&&(Ot.score=xt,Ke<ve?(Fe.add(Ot),++Ke):(++Ne,xt>Fe.peek().score&&Fe.replaceTop(Ot)),We%1e3==0&&Date.now()-pt>=10)){ue?setImmediate(Pe):setTimeout(Pe);return}}else if(he&&he.key)for(var Le=he.key;We>=0;--We){var ht=L[We],_t=Y(ht,Le);if(!!_t){Ve(_t)||(_t=Ee.getPrepared(_t));var qt=Xe(be,_t,Ce);if(qt!==null&&!(qt.score<et)&&(qt={target:qt.target,_targetLowerCodes:null,_nextBeginningIndexes:null,score:qt.score,indexes:qt.indexes,obj:ht},Ke<ve?(Fe.add(qt),++Ke):(++Ne,qt.score>Fe.peek().score&&Fe.replaceTop(qt)),We%1e3==0&&Date.now()-pt>=10)){ue?setImmediate(Pe):setTimeout(Pe);return}}}else for(;We>=0;--We){var _t=L[We];if(!!_t){Ve(_t)||(_t=Ee.getPrepared(_t));var qt=Xe(be,_t,Ce);if(qt!==null&&!(qt.score<et)&&(Ke<ve?(Fe.add(qt),++Ke):(++Ne,qt.score>Fe.peek().score&&Fe.replaceTop(qt)),We%1e3==0&&Date.now()-pt>=10)){ue?setImmediate(Pe):setTimeout(Pe);return}}}if(Ke===0)return le(H);for(var vr=new Array(Ke),Gt=Ke-1;Gt>=0;--Gt)vr[Gt]=Fe.poll();vr.total=Ke+Ne,le(vr)}a(Pe,"step"),ue?setImmediate(Pe):Pe()});return Te.cancel=function(){te=!0},Te},highlight:function(be,L,he){if(be===null)return null;L===void 0&&(L="<b>"),he===void 0&&(he="</b>");for(var te="",Te=0,le=!1,de=be.target,Ce=de.length,Fe=be.indexes,We=0;We<Ce;++We){var et=de[We];if(Fe[Te]===We){if(++Te,le||(le=!0,te+=L),Te===Fe.length){te+=et+he+de.substr(We+1);break}}else le&&(le=!1,te+=he);te+=et}return te},prepare:function(be){if(!!be)return{target:be,_targetLowerCodes:Ee.prepareLowerCodes(be),_nextBeginningIndexes:null,score:null,indexes:null,obj:null}},prepareSlow:function(be){if(!!be)return{target:be,_targetLowerCodes:Ee.prepareLowerCodes(be),_nextBeginningIndexes:Ee.prepareNextBeginningIndexes(be),score:null,indexes:null,obj:null}},prepareSearch:function(be){if(!!be)return Ee.prepareLowerCodes(be)},getPrepared:function(be){if(be.length>999)return Ee.prepare(be);var L=ce.get(be);return L!==void 0||(L=Ee.prepare(be),ce.set(be,L)),L},getPreparedSearch:function(be){if(be.length>999)return Ee.prepareSearch(be);var L=z.get(be);return L!==void 0||(L=Ee.prepareSearch(be),z.set(be,L)),L},algorithm:function(be,L,he){for(var te=L._targetLowerCodes,Te=be.length,le=te.length,de=0,Ce=0,Fe=0,We=0;;){var et=he===te[Ce];if(et){if(M[We++]=Ce,++de,de===Te)break;he=be[Fe===0?de:Fe===de?de+1:Fe===de-1?de-1:de]}if(++Ce,Ce>=le)for(;;){if(de<=1)return null;if(Fe===0){--de;var ve=be[de];if(he===ve)continue;Fe=de}else{if(Fe===1)return null;--Fe,de=Fe,he=be[de+1];var ve=be[de];if(he===ve)continue}We=de,Ce=M[We-1]+1;break}}var de=0,Ue=0,Xe=!1,Ke=0,Ne=L._nextBeginningIndexes;Ne===null&&(Ne=L._nextBeginningIndexes=Ee.prepareNextBeginningIndexes(L.target));var Pe=Ce=M[0]===0?0:Ne[M[0]-1];if(Ce!==le)for(;;)if(Ce>=le){if(de<=0){if(++Ue,Ue>Te-2)break;if(be[Ue]===be[Ue+1])continue;Ce=Pe;continue}--de;var pt=X[--Ke];Ce=Ne[pt]}else{var et=be[Ue===0?de:Ue===de?de+1:Ue===de-1?de-1:de]===te[Ce];if(et){if(X[Ke++]=Ce,++de,de===Te){Xe=!0;break}++Ce}else Ce=Ne[Ce]}{if(Xe)var It=X,xe=Ke;else var It=M,xe=We;for(var Pt=0,ht=-1,Ot=0;Ot<Te;++Ot){var Ce=It[Ot];ht!==Ce-1&&(Pt-=Ce),ht=Ce}Xe?Ue!==0&&(Pt+=-20):(Pt*=1e3,Fe!==0&&(Pt+=-20)),Pt-=le-Te,L.score=Pt,L.indexes=new Array(xe);for(var Ot=xe-1;Ot>=0;--Ot)L.indexes[Ot]=It[Ot];return L}},algorithmNoTypo:function(be,L,he){for(var te=L._targetLowerCodes,Te=be.length,le=te.length,de=0,Ce=0,Fe=0;;){var We=he===te[Ce];if(We){if(M[Fe++]=Ce,++de,de===Te)break;he=be[de]}if(++Ce,Ce>=le)return null}var de=0,et=!1,ve=0,Ue=L._nextBeginningIndexes;Ue===null&&(Ue=L._nextBeginningIndexes=Ee.prepareNextBeginningIndexes(L.target));var Xe=Ce=M[0]===0?0:Ue[M[0]-1];if(Ce!==le)for(;;)if(Ce>=le){if(de<=0)break;--de;var Ke=X[--ve];Ce=Ue[Ke]}else{var We=be[de]===te[Ce];if(We){if(X[ve++]=Ce,++de,de===Te){et=!0;break}++Ce}else Ce=Ue[Ce]}{if(et)var Ne=X,Pe=ve;else var Ne=M,Pe=Fe;for(var pt=0,It=-1,xe=0;xe<Te;++xe){var Ce=Ne[xe];It!==Ce-1&&(pt-=Ce),It=Ce}et||(pt*=1e3),pt-=le-Te,L.score=pt,L.indexes=new Array(Pe);for(var xe=Pe-1;xe>=0;--xe)L.indexes[xe]=Ne[xe];return L}},prepareLowerCodes:function(be){for(var L=be.length,he=[],te=be.toLowerCase(),Te=0;Te<L;++Te)he[Te]=te.charCodeAt(Te);return he},prepareBeginningIndexes:function(be){for(var L=be.length,he=[],te=0,Te=!1,le=!1,de=0;de<L;++de){var Ce=be.charCodeAt(de),Fe=Ce>=65&&Ce<=90,We=Fe||Ce>=97&&Ce<=122||Ce>=48&&Ce<=57,et=Fe&&!Te||!le||!We;Te=Fe,le=We,et&&(he[te++]=de)}return he},prepareNextBeginningIndexes:function(be){for(var L=be.length,he=Ee.prepareBeginningIndexes(be),te=[],Te=he[0],le=0,de=0;de<L;++de)Te>de?te[de]=Te:(Te=he[++le],te[de]=Te===void 0?L:Te);return te},cleanup:pe,new:ne};return Ee}a(ne,"fuzzysortNew");var ue=typeof window=="undefined",ce=new Map,z=new Map,H=[];H.total=0;var M=[],X=[];function pe(){ce.clear(),z.clear(),M=[],X=[]}a(pe,"cleanup");function F(we){for(var Ee=-9007199254740991,be=we.length-1;be>=0;--be){var L=we[be];if(L!==null){var he=L.score;he>Ee&&(Ee=he)}}return Ee===-9007199254740991?null:Ee}a(F,"defaultScoreFn");function Y(we,Ee){var be=we[Ee];if(be!==void 0)return be;var L=Ee;Array.isArray(Ee)||(L=Ee.split("."));for(var he=L.length,te=-1;we&&++te<he;)we=we[L[te]];return we}a(Y,"getValue");function Ve(we){return typeof we=="object"}a(Ve,"isObj");var qe=a(function(){var we=[],Ee=0,be={};function L(){for(var he=0,te=we[he],Te=1;Te<Ee;){var le=Te+1;he=Te,le<Ee&&we[le].score<we[Te].score&&(he=le),we[he-1>>1]=we[he],Te=1+(he<<1)}for(var de=he-1>>1;he>0&&te.score<we[de].score;de=(he=de)-1>>1)we[he]=we[de];we[he]=te}return a(L,"n"),be.add=function(he){var te=Ee;we[Ee++]=he;for(var Te=te-1>>1;te>0&&he.score<we[Te].score;Te=(te=Te)-1>>1)we[te]=we[Te];we[te]=he},be.poll=function(){if(Ee!==0){var he=we[0];return we[0]=we[--Ee],L(),he}},be.peek=function(he){if(Ee!==0)return we[0]},be.replaceTop=function(he){we[0]=he,L()},be},"fastpriorityqueue"),at=qe();return ne()},"UMD"))},645:(m,B)=>{/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */B.read=function(K,q,j,se,ne){var ue,ce,z=ne*8-se-1,H=(1<<z)-1,M=H>>1,X=-7,pe=j?ne-1:0,F=j?-1:1,Y=K[q+pe];for(pe+=F,ue=Y&(1<<-X)-1,Y>>=-X,X+=z;X>0;ue=ue*256+K[q+pe],pe+=F,X-=8);for(ce=ue&(1<<-X)-1,ue>>=-X,X+=se;X>0;ce=ce*256+K[q+pe],pe+=F,X-=8);if(ue===0)ue=1-M;else{if(ue===H)return ce?NaN:(Y?-1:1)*(1/0);ce=ce+Math.pow(2,se),ue=ue-M}return(Y?-1:1)*ce*Math.pow(2,ue-se)},B.write=function(K,q,j,se,ne,ue){var ce,z,H,M=ue*8-ne-1,X=(1<<M)-1,pe=X>>1,F=ne===23?Math.pow(2,-24)-Math.pow(2,-77):0,Y=se?0:ue-1,Ve=se?1:-1,qe=q<0||q===0&&1/q<0?1:0;for(q=Math.abs(q),isNaN(q)||q===1/0?(z=isNaN(q)?1:0,ce=X):(ce=Math.floor(Math.log(q)/Math.LN2),q*(H=Math.pow(2,-ce))<1&&(ce--,H*=2),ce+pe>=1?q+=F/H:q+=F*Math.pow(2,1-pe),q*H>=2&&(ce++,H/=2),ce+pe>=X?(z=0,ce=X):ce+pe>=1?(z=(q*H-1)*Math.pow(2,ne),ce=ce+pe):(z=q*Math.pow(2,pe-1)*Math.pow(2,ne),ce=0));ne>=8;K[j+Y]=z&255,Y+=Ve,z/=256,ne-=8);for(ce=ce<<ne|z,M+=ne;M>0;K[j+Y]=ce&255,Y+=Ve,ce/=256,M-=8);K[j+Y-Ve]|=qe*128}},9924:m=>{"use strict";/*!
 * is-number <https://github.com/jonschlinkert/is-number>
 *
 * Copyright (c) 2014-present, Jon Schlinkert.
 * Released under the MIT License.
 */m.exports=function(B){return typeof B=="number"?B-B==0:typeof B=="string"&&B.trim()!==""?Number.isFinite?Number.isFinite(+B):isFinite(+B):!1}},2307:(m,B,K)=>{m=K.nmd(m);var q=200,j="__lodash_hash_undefined__",se=1,ne=2,ue=9007199254740991,ce="[object Arguments]",z="[object Array]",H="[object AsyncFunction]",M="[object Boolean]",X="[object Date]",pe="[object Error]",F="[object Function]",Y="[object GeneratorFunction]",Ve="[object Map]",qe="[object Number]",at="[object Null]",we="[object Object]",Ee="[object Promise]",be="[object Proxy]",L="[object RegExp]",he="[object Set]",te="[object String]",Te="[object Symbol]",le="[object Undefined]",de="[object WeakMap]",Ce="[object ArrayBuffer]",Fe="[object DataView]",We="[object Float32Array]",et="[object Float64Array]",ve="[object Int8Array]",Ue="[object Int16Array]",Xe="[object Int32Array]",Ke="[object Uint8Array]",Ne="[object Uint8ClampedArray]",Pe="[object Uint16Array]",pt="[object Uint32Array]",It=/[\\^$.*+?()[\]{}|]/g,xe=/^\[object .+?Constructor\]$/,Pt=/^(?:0|[1-9]\d*)$/,ht={};ht[We]=ht[et]=ht[ve]=ht[Ue]=ht[Xe]=ht[Ke]=ht[Ne]=ht[Pe]=ht[pt]=!0,ht[ce]=ht[z]=ht[Ce]=ht[M]=ht[Fe]=ht[X]=ht[pe]=ht[F]=ht[Ve]=ht[qe]=ht[we]=ht[L]=ht[he]=ht[te]=ht[de]=!1;var Ot=typeof global=="object"&&global&&global.Object===Object&&global,Be=typeof self=="object"&&self&&self.Object===Object&&self,Le=Ot||Be||Function("return this")(),_t=B&&!B.nodeType&&B,xt=_t&&!0&&m&&!m.nodeType&&m,qt=xt&&xt.exports===_t,vr=qt&&Ot.process,Gt=function(){try{return vr&&vr.binding&&vr.binding("util")}catch(J){}}(),lr=Gt&&Gt.isTypedArray;function Nr(J,_e){for(var Ge=-1,gt=J==null?0:J.length,dr=0,Ft=[];++Ge<gt;){var yr=J[Ge];_e(yr,Ge,J)&&(Ft[dr++]=yr)}return Ft}a(Nr,"arrayFilter");function rn(J,_e){for(var Ge=-1,gt=_e.length,dr=J.length;++Ge<gt;)J[dr+Ge]=_e[Ge];return J}a(rn,"arrayPush");function Ir(J,_e){for(var Ge=-1,gt=J==null?0:J.length;++Ge<gt;)if(_e(J[Ge],Ge,J))return!0;return!1}a(Ir,"arraySome");function wt(J,_e){for(var Ge=-1,gt=Array(J);++Ge<J;)gt[Ge]=_e(Ge);return gt}a(wt,"baseTimes");function tt(J){return function(_e){return J(_e)}}a(tt,"baseUnary");function Mi(J,_e){return J.has(_e)}a(Mi,"cacheHas");function nt(J,_e){return J==null?void 0:J[_e]}a(nt,"getValue");function Lt(J){var _e=-1,Ge=Array(J.size);return J.forEach(function(gt,dr){Ge[++_e]=[dr,gt]}),Ge}a(Lt,"mapToArray");function it(J,_e){return function(Ge){return J(_e(Ge))}}a(it,"overArg");function ft(J){var _e=-1,Ge=Array(J.size);return J.forEach(function(gt){Ge[++_e]=gt}),Ge}a(ft,"setToArray");var Zt=Array.prototype,er=Function.prototype,Jt=Object.prototype,wn=Le["__core-js_shared__"],pi=er.toString,nn=Jt.hasOwnProperty,ja=function(){var J=/[^.]+$/.exec(wn&&wn.keys&&wn.keys.IE_PROTO||"");return J?"Symbol(src)_1."+J:""}(),qa=Jt.toString,eo=RegExp("^"+pi.call(nn).replace(It,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ir=qt?Le.Buffer:void 0,Li=Le.Symbol,ia=Le.Uint8Array,oa=Jt.propertyIsEnumerable,Qs=Zt.splice,Mr=Li?Li.toStringTag:void 0,gi=Object.getOwnPropertySymbols,So=ir?ir.isBuffer:void 0,za=it(Object.keys,Object),Tn=_i(Le,"DataView"),ut=_i(Le,"Map"),$i=_i(Le,"Promise"),to=_i(Le,"Set"),Eo=_i(Le,"WeakMap"),Fi=_i(Object,"create"),Ys=Xn(Tn),Zs=Xn(ut),Js=Xn($i),on=Xn(to),ur=Xn(Eo),Qt=Li?Li.prototype:void 0,bn=Qt?Qt.valueOf:void 0;function mi(J){var _e=-1,Ge=J==null?0:J.length;for(this.clear();++_e<Ge;){var gt=J[_e];this.set(gt[0],gt[1])}}a(mi,"Hash");function Wa(){this.__data__=Fi?Fi(null):{},this.size=0}a(Wa,"hashClear");function ec(J){var _e=this.has(J)&&delete this.__data__[J];return this.size-=_e?1:0,_e}a(ec,"hashDelete");function hl(J){var _e=this.__data__;if(Fi){var Ge=_e[J];return Ge===j?void 0:Ge}return nn.call(_e,J)?_e[J]:void 0}a(hl,"hashGet");function Ga(J){var _e=this.__data__;return Fi?_e[J]!==void 0:nn.call(_e,J)}a(Ga,"hashHas");function Va(J,_e){var Ge=this.__data__;return this.size+=this.has(J)?0:1,Ge[J]=Fi&&_e===void 0?j:_e,this}a(Va,"hashSet"),mi.prototype.clear=Wa,mi.prototype.delete=ec,mi.prototype.get=hl,mi.prototype.has=Ga,mi.prototype.set=Va;function An(J){var _e=-1,Ge=J==null?0:J.length;for(this.clear();++_e<Ge;){var gt=J[_e];this.set(gt[0],gt[1])}}a(An,"ListCache");function ro(){this.__data__=[],this.size=0}a(ro,"listCacheClear");function fl(J){var _e=this.__data__,Ge=yi(_e,J);if(Ge<0)return!1;var gt=_e.length-1;return Ge==gt?_e.pop():Qs.call(_e,Ge,1),--this.size,!0}a(fl,"listCacheDelete");function pl(J){var _e=this.__data__,Ge=yi(_e,J);return Ge<0?void 0:_e[Ge][1]}a(pl,"listCacheGet");function xo(J){return yi(this.__data__,J)>-1}a(xo,"listCacheHas");function Ka(J,_e){var Ge=this.__data__,gt=yi(Ge,J);return gt<0?(++this.size,Ge.push([J,_e])):Ge[gt][1]=_e,this}a(Ka,"listCacheSet"),An.prototype.clear=ro,An.prototype.delete=fl,An.prototype.get=pl,An.prototype.has=xo,An.prototype.set=Ka;function vi(J){var _e=-1,Ge=J==null?0:J.length;for(this.clear();++_e<Ge;){var gt=J[_e];this.set(gt[0],gt[1])}}a(vi,"MapCache");function Xa(){this.size=0,this.__data__={hash:new mi,map:new(ut||An),string:new mi}}a(Xa,"mapCacheClear");function gl(J){var _e=da(this,J).delete(J);return this.size-=_e?1:0,_e}a(gl,"mapCacheDelete");function Qa(J){return da(this,J).get(J)}a(Qa,"mapCacheGet");function ml(J){return da(this,J).has(J)}a(ml,"mapCacheHas");function Vr(J,_e){var Ge=da(this,J),gt=Ge.size;return Ge.set(J,_e),this.size+=Ge.size==gt?0:1,this}a(Vr,"mapCacheSet"),vi.prototype.clear=Xa,vi.prototype.delete=gl,vi.prototype.get=Qa,vi.prototype.has=ml,vi.prototype.set=Vr;function hn(J){var _e=-1,Ge=J==null?0:J.length;for(this.__data__=new vi;++_e<Ge;)this.add(J[_e])}a(hn,"SetCache");function Ya(J){return this.__data__.set(J,j),this}a(Ya,"setCacheAdd");function Za(J){return this.__data__.has(J)}a(Za,"setCacheHas"),hn.prototype.add=hn.prototype.push=Ya,hn.prototype.has=Za;function Kn(J){var _e=this.__data__=new An(J);this.size=_e.size}a(Kn,"Stack");function aa(){this.__data__=new An,this.size=0}a(aa,"stackClear");function tc(J){var _e=this.__data__,Ge=_e.delete(J);return this.size=_e.size,Ge}a(tc,"stackDelete");function rc(J){return this.__data__.get(J)}a(rc,"stackGet");function Bi(J){return this.__data__.has(J)}a(Bi,"stackHas");function vl(J,_e){var Ge=this.__data__;if(Ge instanceof An){var gt=Ge.__data__;if(!ut||gt.length<q-1)return gt.push([J,_e]),this.size=++Ge.size,this;Ge=this.__data__=new vi(gt)}return Ge.set(J,_e),this.size=Ge.size,this}a(vl,"stackSet"),Kn.prototype.clear=aa,Kn.prototype.delete=tc,Kn.prototype.get=rc,Kn.prototype.has=Bi,Kn.prototype.set=vl;function sa(J,_e){var Ge=Ro(J),gt=!Ge&&wi(J),dr=!Ge&&!gt&&Io(J),Ft=!Ge&&!gt&&!dr&&cs(J),yr=Ge||gt||dr||Ft,Ar=yr?wt(J.length,String):[],Rr=Ar.length;for(var hr in J)(_e||nn.call(J,hr))&&!(yr&&(hr=="length"||dr&&(hr=="offset"||hr=="parent")||Ft&&(hr=="buffer"||hr=="byteLength"||hr=="byteOffset")||is(hr,Rr)))&&Ar.push(hr);return Ar}a(sa,"arrayLikeKeys");function yi(J,_e){for(var Ge=J.length;Ge--;)if(ha(J[Ge][0],_e))return Ge;return-1}a(yi,"assocIndexOf");function nc(J,_e,Ge){var gt=_e(J);return Ro(J)?gt:rn(gt,Ge(J))}a(nc,"baseGetAllKeys");function Rn(J){return J==null?J===void 0?le:at:Mr&&Mr in Object(J)?ns(J):Ao(J)}a(Rn,"baseGetTag");function Ja(J){return bi(J)&&Rn(J)==ce}a(Ja,"baseIsArguments");function ca(J,_e,Ge,gt,dr){return J===_e?!0:J==null||_e==null||!bi(J)&&!bi(_e)?J!==J&&_e!==_e:es(J,_e,Ge,gt,ca,dr)}a(ca,"baseIsEqual");function es(J,_e,Ge,gt,dr,Ft){var yr=Ro(J),Ar=Ro(_e),Rr=yr?z:Ln(J),hr=Ar?z:Ln(_e);Rr=Rr==ce?we:Rr,hr=hr==ce?we:hr;var an=Rr==we,pn=hr==we,Lr=Rr==hr;if(Lr&&Io(J)){if(!Io(_e))return!1;yr=!0,an=!1}if(Lr&&!an)return Ft||(Ft=new Kn),yr||cs(J)?Co(J,_e,Ge,gt,dr,Ft):oc(J,_e,Rr,Ge,gt,dr,Ft);if(!(Ge&se)){var tr=an&&nn.call(J,"__wrapped__"),Kr=pn&&nn.call(_e,"__wrapped__");if(tr||Kr){var Qn=tr?J.value():J,In=Kr?_e.value():_e;return Ft||(Ft=new Kn),dr(Qn,In,Ge,gt,Ft)}}return Lr?(Ft||(Ft=new Kn),la(J,_e,Ge,gt,dr,Ft)):!1}a(es,"baseIsEqualDeep");function ts(J){if(!ss(J)||sc(J))return!1;var _e=cc(J)?eo:xe;return _e.test(Xn(J))}a(ts,"baseIsNative");function rs(J){return bi(J)&&lc(J.length)&&!!ht[Rn(J)]}a(rs,"baseIsTypedArray");function ic(J){if(!os(J))return za(J);var _e=[];for(var Ge in Object(J))nn.call(J,Ge)&&Ge!="constructor"&&_e.push(Ge);return _e}a(ic,"baseKeys");function Co(J,_e,Ge,gt,dr,Ft){var yr=Ge&se,Ar=J.length,Rr=_e.length;if(Ar!=Rr&&!(yr&&Rr>Ar))return!1;var hr=Ft.get(J);if(hr&&Ft.get(_e))return hr==_e;var an=-1,pn=!0,Lr=Ge&ne?new hn:void 0;for(Ft.set(J,_e),Ft.set(_e,J);++an<Ar;){var tr=J[an],Kr=_e[an];if(gt)var Qn=yr?gt(Kr,tr,an,_e,J,Ft):gt(tr,Kr,an,J,_e,Ft);if(Qn!==void 0){if(Qn)continue;pn=!1;break}if(Lr){if(!Ir(_e,function(In,Sn){if(!Mi(Lr,Sn)&&(tr===In||dr(tr,In,Ge,gt,Ft)))return Lr.push(Sn)})){pn=!1;break}}else if(!(tr===Kr||dr(tr,Kr,Ge,gt,Ft))){pn=!1;break}}return Ft.delete(J),Ft.delete(_e),pn}a(Co,"equalArrays");function oc(J,_e,Ge,gt,dr,Ft,yr){switch(Ge){case Fe:if(J.byteLength!=_e.byteLength||J.byteOffset!=_e.byteOffset)return!1;J=J.buffer,_e=_e.buffer;case Ce:return!(J.byteLength!=_e.byteLength||!Ft(new ia(J),new ia(_e)));case M:case X:case qe:return ha(+J,+_e);case pe:return J.name==_e.name&&J.message==_e.message;case L:case te:return J==_e+"";case Ve:var Ar=Lt;case he:var Rr=gt&se;if(Ar||(Ar=ft),J.size!=_e.size&&!Rr)return!1;var hr=yr.get(J);if(hr)return hr==_e;gt|=ne,yr.set(J,_e);var an=Co(Ar(J),Ar(_e),gt,dr,Ft,yr);return yr.delete(J),an;case Te:if(bn)return bn.call(J)==bn.call(_e)}return!1}a(oc,"equalByTag");function la(J,_e,Ge,gt,dr,Ft){var yr=Ge&se,Ar=ua(J),Rr=Ar.length,hr=ua(_e),an=hr.length;if(Rr!=an&&!yr)return!1;for(var pn=Rr;pn--;){var Lr=Ar[pn];if(!(yr?Lr in _e:nn.call(_e,Lr)))return!1}var tr=Ft.get(J);if(tr&&Ft.get(_e))return tr==_e;var Kr=!0;Ft.set(J,_e),Ft.set(_e,J);for(var Qn=yr;++pn<Rr;){Lr=Ar[pn];var In=J[Lr],Sn=_e[Lr];if(gt)var pa=yr?gt(Sn,In,Lr,_e,J,Ft):gt(In,Sn,Lr,J,_e,Ft);if(!(pa===void 0?In===Sn||dr(In,Sn,Ge,gt,Ft):pa)){Kr=!1;break}Qn||(Qn=Lr=="constructor")}if(Kr&&!Qn){var Yn=J.constructor,Do=_e.constructor;Yn!=Do&&"constructor"in J&&"constructor"in _e&&!(typeof Yn=="function"&&Yn instanceof Yn&&typeof Do=="function"&&Do instanceof Do)&&(Kr=!1)}return Ft.delete(J),Ft.delete(_e),Kr}a(la,"equalObjects");function ua(J){return nc(J,Oo,To)}a(ua,"getAllKeys");function da(J,_e){var Ge=J.__data__;return ac(_e)?Ge[typeof _e=="string"?"string":"hash"]:Ge.map}a(da,"getMapData");function _i(J,_e){var Ge=nt(J,_e);return ts(Ge)?Ge:void 0}a(_i,"getNative");function ns(J){var _e=nn.call(J,Mr),Ge=J[Mr];try{J[Mr]=void 0;var gt=!0}catch(Ft){}var dr=qa.call(J);return gt&&(_e?J[Mr]=Ge:delete J[Mr]),dr}a(ns,"getRawTag");var To=gi?function(J){return J==null?[]:(J=Object(J),Nr(gi(J),function(_e){return oa.call(J,_e)}))}:Po,Ln=Rn;(Tn&&Ln(new Tn(new ArrayBuffer(1)))!=Fe||ut&&Ln(new ut)!=Ve||$i&&Ln($i.resolve())!=Ee||to&&Ln(new to)!=he||Eo&&Ln(new Eo)!=de)&&(Ln=a(function(J){var _e=Rn(J),Ge=_e==we?J.constructor:void 0,gt=Ge?Xn(Ge):"";if(gt)switch(gt){case Ys:return Fe;case Zs:return Ve;case Js:return Ee;case on:return he;case ur:return de}return _e},"getTag"));function is(J,_e){return _e=_e==null?ue:_e,!!_e&&(typeof J=="number"||Pt.test(J))&&J>-1&&J%1==0&&J<_e}a(is,"isIndex");function ac(J){var _e=typeof J;return _e=="string"||_e=="number"||_e=="symbol"||_e=="boolean"?J!=="__proto__":J===null}a(ac,"isKeyable");function sc(J){return!!ja&&ja in J}a(sc,"isMasked");function os(J){var _e=J&&J.constructor,Ge=typeof _e=="function"&&_e.prototype||Jt;return J===Ge}a(os,"isPrototype");function Ao(J){return qa.call(J)}a(Ao,"objectToString");function Xn(J){if(J!=null){try{return pi.call(J)}catch(_e){}try{return J+""}catch(_e){}}return""}a(Xn,"toSource");function ha(J,_e){return J===_e||J!==J&&_e!==_e}a(ha,"eq");var wi=Ja(function(){return arguments}())?Ja:function(J){return bi(J)&&nn.call(J,"callee")&&!oa.call(J,"callee")},Ro=Array.isArray;function as(J){return J!=null&&lc(J.length)&&!cc(J)}a(as,"isArrayLike");var Io=So||fn;function fa(J,_e){return ca(J,_e)}a(fa,"isEqual");function cc(J){if(!ss(J))return!1;var _e=Rn(J);return _e==F||_e==Y||_e==H||_e==be}a(cc,"isFunction");function lc(J){return typeof J=="number"&&J>-1&&J%1==0&&J<=ue}a(lc,"isLength");function ss(J){var _e=typeof J;return J!=null&&(_e=="object"||_e=="function")}a(ss,"isObject");function bi(J){return J!=null&&typeof J=="object"}a(bi,"isObjectLike");var cs=lr?tt(lr):rs;function Oo(J){return as(J)?sa(J):ic(J)}a(Oo,"keys");function Po(){return[]}a(Po,"stubArray");function fn(){return!1}a(fn,"stubFalse"),m.exports=fa},850:(m,B,K)=>{"use strict";const q=K(3837),j=K(6744),se=K(9444),ne=K(8702),ue=a(z=>z===""||z==="./","isEmptyString"),ce=a((z,H,M)=>{H=[].concat(H),z=[].concat(z);let X=new Set,pe=new Set,F=new Set,Y=0,Ve=a(we=>{F.add(we.output),M&&M.onResult&&M.onResult(we)},"onResult");for(let we=0;we<H.length;we++){let Ee=se(String(H[we]),{...M,onResult:Ve},!0),be=Ee.state.negated||Ee.state.negatedExtglob;be&&Y++;for(let L of z){let he=Ee(L,!0);!(be?!he.isMatch:he.isMatch)||(be?X.add(he.output):(X.delete(he.output),pe.add(he.output)))}}let at=(Y===H.length?[...F]:[...pe]).filter(we=>!X.has(we));if(M&&at.length===0){if(M.failglob===!0)throw new Error(`No matches found for "${H.join(", ")}"`);if(M.nonull===!0||M.nullglob===!0)return M.unescape?H.map(we=>we.replace(/\\/g,"")):H}return at},"micromatch");ce.match=ce,ce.matcher=(z,H)=>se(z,H),ce.isMatch=(z,H,M)=>se(H,M)(z),ce.any=ce.isMatch,ce.not=(z,H,M={})=>{H=[].concat(H).map(String);let X=new Set,pe=[],Y=ce(z,H,{...M,onResult:a(Ve=>{M.onResult&&M.onResult(Ve),pe.push(Ve.output)},"onResult")});for(let Ve of pe)Y.includes(Ve)||X.add(Ve);return[...X]},ce.contains=(z,H,M)=>{if(typeof z!="string")throw new TypeError(`Expected a string: "${q.inspect(z)}"`);if(Array.isArray(H))return H.some(X=>ce.contains(z,X,M));if(typeof H=="string"){if(ue(z)||ue(H))return!1;if(z.includes(H)||z.startsWith("./")&&z.slice(2).includes(H))return!0}return ce.isMatch(z,H,{...M,contains:!0})},ce.matchKeys=(z,H,M)=>{if(!ne.isObject(z))throw new TypeError("Expected the first argument to be an object");let X=ce(Object.keys(z),H,M),pe={};for(let F of X)pe[F]=z[F];return pe},ce.some=(z,H,M)=>{let X=[].concat(z);for(let pe of[].concat(H)){let F=se(String(pe),M);if(X.some(Y=>F(Y)))return!0}return!1},ce.every=(z,H,M)=>{let X=[].concat(z);for(let pe of[].concat(H)){let F=se(String(pe),M);if(!X.every(Y=>F(Y)))return!1}return!0},ce.all=(z,H,M)=>{if(typeof z!="string")throw new TypeError(`Expected a string: "${q.inspect(z)}"`);return[].concat(H).every(X=>se(X,M)(z))},ce.capture=(z,H,M)=>{let X=ne.isWindows(M),F=se.makeRe(String(z),{...M,capture:!0}).exec(X?ne.toPosixSlashes(H):H);if(F)return F.slice(1).map(Y=>Y===void 0?"":Y)},ce.makeRe=(...z)=>se.makeRe(...z),ce.scan=(...z)=>se.scan(...z),ce.parse=(z,H)=>{let M=[];for(let X of[].concat(z||[]))for(let pe of j(String(X),H))M.push(se.parse(pe,H));return M},ce.braces=(z,H)=>{if(typeof z!="string")throw new TypeError("Expected a string");return H&&H.nobrace===!0||!/\{.*\}/.test(z)?[z]:j(z,H)},ce.braceExpand=(z,H)=>{if(typeof z!="string")throw new TypeError("Expected a string");return ce.braces(z,{...H,expand:!0})},m.exports=ce},447:(m,B,K)=>{var q=K(2479);m.exports=q(j),m.exports.strict=q(se),j.proto=j(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return j(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return se(this)},configurable:!0})});function j(ne){var ue=a(function(){return ue.called?ue.value:(ue.called=!0,ue.value=ne.apply(this,arguments))},"f");return ue.called=!1,ue}a(j,"once");function se(ne){var ue=a(function(){if(ue.called)throw new Error(ue.onceError);return ue.called=!0,ue.value=ne.apply(this,arguments)},"f"),ce=ne.name||"Function wrapped with `once`";return ue.onceError=ce+" shouldn't be called more than once",ue.called=!1,ue}a(se,"onceStrict")},7279:(m,B)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),B.EndOfStreamError=B.defaultMessages=void 0,B.defaultMessages="End-Of-Stream";class K extends Error{constructor(){super(B.defaultMessages)}}a(K,"EndOfStreamError"),B.EndOfStreamError=K},5167:(m,B,K)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),B.StreamReader=B.EndOfStreamError=void 0;const q=K(7279);var j=K(7279);Object.defineProperty(B,"EndOfStreamError",{enumerable:!0,get:function(){return j.EndOfStreamError}});class se{constructor(){this.resolve=()=>null,this.reject=()=>null,this.promise=new Promise((z,H)=>{this.reject=H,this.resolve=z})}}a(se,"Deferred");const ne=1*1024*1024;class ue{constructor(z){if(this.s=z,this.request=null,this.endOfStream=!1,this.peekQueue=[],!z.read||!z.once)throw new Error("Expected an instance of stream.Readable");this.s.once("end",()=>this.reject(new q.EndOfStreamError)),this.s.once("error",H=>this.reject(H)),this.s.once("close",()=>this.reject(new Error("Stream closed")))}async peek(z,H,M){const X=await this.read(z,H,M);return this.peekQueue.push(z.subarray(H,H+X)),X}async read(z,H,M){if(M===0)return 0;if(this.peekQueue.length===0&&this.endOfStream)throw new q.EndOfStreamError;let X=M,pe=0;for(;this.peekQueue.length>0&&X>0;){const F=this.peekQueue.pop();if(!F)throw new Error("peekData should be defined");const Y=Math.min(F.length,X);z.set(F.subarray(0,Y),H+pe),pe+=Y,X-=Y,Y<F.length&&this.peekQueue.push(F.subarray(Y))}for(;X>0&&!this.endOfStream;){const F=Math.min(X,ne),Y=await this._read(z,H+pe,F);if(pe+=Y,Y<F)break;X-=Y}return pe}async _read(z,H,M){if(this.request)throw new Error("Concurrent read operation?");const X=this.s.read(M);return X?(z.set(X,H),X.length):(this.request={buffer:z,offset:H,length:M,deferred:new se},this.s.once("readable",()=>{this.tryRead()}),this.request.deferred.promise)}tryRead(){if(!this.request)throw new Error("this.request should be defined");const z=this.s.read(this.request.length);z?(this.request.buffer.set(z,this.request.offset),this.request.deferred.resolve(z.length),this.request=null):this.s.once("readable",()=>{this.tryRead()})}reject(z){this.endOfStream=!0,this.request&&(this.request.deferred.reject(z),this.request=null)}}a(ue,"StreamReader"),B.StreamReader=ue},9444:(m,B,K)=>{"use strict";m.exports=K(6087)},1006:(m,B,K)=>{"use strict";const q=K(1017),j="\\\\/",se=`[^${j}]`,ne="\\.",ue="\\+",ce="\\?",z="\\/",H="(?=.)",M="[^/]",X=`(?:${z}|$)`,pe=`(?:^|${z})`,F=`${ne}{1,2}${X}`,Y=`(?!${ne})`,Ve=`(?!${pe}${F})`,qe=`(?!${ne}{0,1}${X})`,at=`(?!${F})`,we=`[^.${z}]`,Ee=`${M}*?`,be={DOT_LITERAL:ne,PLUS_LITERAL:ue,QMARK_LITERAL:ce,SLASH_LITERAL:z,ONE_CHAR:H,QMARK:M,END_ANCHOR:X,DOTS_SLASH:F,NO_DOT:Y,NO_DOTS:Ve,NO_DOT_SLASH:qe,NO_DOTS_SLASH:at,QMARK_NO_DOT:we,STAR:Ee,START_ANCHOR:pe},L={...be,SLASH_LITERAL:`[${j}]`,QMARK:se,STAR:`${se}*?`,DOTS_SLASH:`${ne}{1,2}(?:[${j}]|$)`,NO_DOT:`(?!${ne})`,NO_DOTS:`(?!(?:^|[${j}])${ne}{1,2}(?:[${j}]|$))`,NO_DOT_SLASH:`(?!${ne}{0,1}(?:[${j}]|$))`,NO_DOTS_SLASH:`(?!${ne}{1,2}(?:[${j}]|$))`,QMARK_NO_DOT:`[^.${j}]`,START_ANCHOR:`(?:^|[${j}])`,END_ANCHOR:`(?:[${j}]|$)`},he={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};m.exports={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:he,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:q.sep,extglobChars(te){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${te.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(te){return te===!0?L:be}}},3376:(m,B,K)=>{"use strict";const q=K(1006),j=K(8702),{MAX_LENGTH:se,POSIX_REGEX_SOURCE:ne,REGEX_NON_SPECIAL_CHARS:ue,REGEX_SPECIAL_CHARS_BACKREF:ce,REPLACEMENTS:z}=q,H=a((pe,F)=>{if(typeof F.expandRange=="function")return F.expandRange(...pe,F);pe.sort();const Y=`[${pe.join("-")}]`;try{new RegExp(Y)}catch(Ve){return pe.map(qe=>j.escapeRegex(qe)).join("..")}return Y},"expandRange"),M=a((pe,F)=>`Missing ${pe}: "${F}" - use "\\\\${F}" to match literal characters`,"syntaxError"),X=a((pe,F)=>{if(typeof pe!="string")throw new TypeError("Expected a string");pe=z[pe]||pe;const Y={...F},Ve=typeof Y.maxLength=="number"?Math.min(se,Y.maxLength):se;let qe=pe.length;if(qe>Ve)throw new SyntaxError(`Input length: ${qe}, exceeds maximum allowed length: ${Ve}`);const at={type:"bos",value:"",output:Y.prepend||""},we=[at],Ee=Y.capture?"":"?:",be=j.isWindows(F),L=q.globChars(be),he=q.extglobChars(L),{DOT_LITERAL:te,PLUS_LITERAL:Te,SLASH_LITERAL:le,ONE_CHAR:de,DOTS_SLASH:Ce,NO_DOT:Fe,NO_DOT_SLASH:We,NO_DOTS_SLASH:et,QMARK:ve,QMARK_NO_DOT:Ue,STAR:Xe,START_ANCHOR:Ke}=L,Ne=a(nt=>`(${Ee}(?:(?!${Ke}${nt.dot?Ce:te}).)*?)`,"globstar"),Pe=Y.dot?"":Fe,pt=Y.dot?ve:Ue;let It=Y.bash===!0?Ne(Y):Xe;Y.capture&&(It=`(${It})`),typeof Y.noext=="boolean"&&(Y.noextglob=Y.noext);const xe={input:pe,index:-1,start:0,dot:Y.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:we};pe=j.removePrefix(pe,xe),qe=pe.length;const Pt=[],ht=[],Ot=[];let Be=at,Le;const _t=a(()=>xe.index===qe-1,"eos"),xt=xe.peek=(nt=1)=>pe[xe.index+nt],qt=xe.advance=()=>pe[++xe.index]||"",vr=a(()=>pe.slice(xe.index+1),"remaining"),Gt=a((nt="",Lt=0)=>{xe.consumed+=nt,xe.index+=Lt},"consume"),lr=a(nt=>{xe.output+=nt.output!=null?nt.output:nt.value,Gt(nt.value)},"append"),Nr=a(()=>{let nt=1;for(;xt()==="!"&&(xt(2)!=="("||xt(3)==="?");)qt(),xe.start++,nt++;return nt%2==0?!1:(xe.negated=!0,xe.start++,!0)},"negate"),rn=a(nt=>{xe[nt]++,Ot.push(nt)},"increment"),Ir=a(nt=>{xe[nt]--,Ot.pop()},"decrement"),wt=a(nt=>{if(Be.type==="globstar"){const Lt=xe.braces>0&&(nt.type==="comma"||nt.type==="brace"),it=nt.extglob===!0||Pt.length&&(nt.type==="pipe"||nt.type==="paren");nt.type!=="slash"&&nt.type!=="paren"&&!Lt&&!it&&(xe.output=xe.output.slice(0,-Be.output.length),Be.type="star",Be.value="*",Be.output=It,xe.output+=Be.output)}if(Pt.length&&nt.type!=="paren"&&(Pt[Pt.length-1].inner+=nt.value),(nt.value||nt.output)&&lr(nt),Be&&Be.type==="text"&&nt.type==="text"){Be.value+=nt.value,Be.output=(Be.output||"")+nt.value;return}nt.prev=Be,we.push(nt),Be=nt},"push"),tt=a((nt,Lt)=>{const it={...he[Lt],conditions:1,inner:""};it.prev=Be,it.parens=xe.parens,it.output=xe.output;const ft=(Y.capture?"(":"")+it.open;rn("parens"),wt({type:nt,value:Lt,output:xe.output?"":de}),wt({type:"paren",extglob:!0,value:qt(),output:ft}),Pt.push(it)},"extglobOpen"),Mi=a(nt=>{let Lt=nt.close+(Y.capture?")":""),it;if(nt.type==="negate"){let ft=It;nt.inner&&nt.inner.length>1&&nt.inner.includes("/")&&(ft=Ne(Y)),(ft!==It||_t()||/^\)+$/.test(vr()))&&(Lt=nt.close=`)$))${ft}`),nt.inner.includes("*")&&(it=vr())&&/^\.[^\\/.]+$/.test(it)&&(Lt=nt.close=`)${it})${ft})`),nt.prev.type==="bos"&&(xe.negatedExtglob=!0)}wt({type:"paren",extglob:!0,value:Le,output:Lt}),Ir("parens")},"extglobClose");if(Y.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(pe)){let nt=!1,Lt=pe.replace(ce,(it,ft,Zt,er,Jt,wn)=>er==="\\"?(nt=!0,it):er==="?"?ft?ft+er+(Jt?ve.repeat(Jt.length):""):wn===0?pt+(Jt?ve.repeat(Jt.length):""):ve.repeat(Zt.length):er==="."?te.repeat(Zt.length):er==="*"?ft?ft+er+(Jt?It:""):It:ft?it:`\\${it}`);return nt===!0&&(Y.unescape===!0?Lt=Lt.replace(/\\/g,""):Lt=Lt.replace(/\\+/g,it=>it.length%2==0?"\\\\":it?"\\":"")),Lt===pe&&Y.contains===!0?(xe.output=pe,xe):(xe.output=j.wrapOutput(Lt,xe,F),xe)}for(;!_t();){if(Le=qt(),Le==="\0")continue;if(Le==="\\"){const it=xt();if(it==="/"&&Y.bash!==!0||it==="."||it===";")continue;if(!it){Le+="\\",wt({type:"text",value:Le});continue}const ft=/^\\+/.exec(vr());let Zt=0;if(ft&&ft[0].length>2&&(Zt=ft[0].length,xe.index+=Zt,Zt%2!=0&&(Le+="\\")),Y.unescape===!0?Le=qt():Le+=qt(),xe.brackets===0){wt({type:"text",value:Le});continue}}if(xe.brackets>0&&(Le!=="]"||Be.value==="["||Be.value==="[^")){if(Y.posix!==!1&&Le===":"){const it=Be.value.slice(1);if(it.includes("[")&&(Be.posix=!0,it.includes(":"))){const ft=Be.value.lastIndexOf("["),Zt=Be.value.slice(0,ft),er=Be.value.slice(ft+2),Jt=ne[er];if(Jt){Be.value=Zt+Jt,xe.backtrack=!0,qt(),!at.output&&we.indexOf(Be)===1&&(at.output=de);continue}}}(Le==="["&&xt()!==":"||Le==="-"&&xt()==="]")&&(Le=`\\${Le}`),Le==="]"&&(Be.value==="["||Be.value==="[^")&&(Le=`\\${Le}`),Y.posix===!0&&Le==="!"&&Be.value==="["&&(Le="^"),Be.value+=Le,lr({value:Le});continue}if(xe.quotes===1&&Le!=='"'){Le=j.escapeRegex(Le),Be.value+=Le,lr({value:Le});continue}if(Le==='"'){xe.quotes=xe.quotes===1?0:1,Y.keepQuotes===!0&&wt({type:"text",value:Le});continue}if(Le==="("){rn("parens"),wt({type:"paren",value:Le});continue}if(Le===")"){if(xe.parens===0&&Y.strictBrackets===!0)throw new SyntaxError(M("opening","("));const it=Pt[Pt.length-1];if(it&&xe.parens===it.parens+1){Mi(Pt.pop());continue}wt({type:"paren",value:Le,output:xe.parens?")":"\\)"}),Ir("parens");continue}if(Le==="["){if(Y.nobracket===!0||!vr().includes("]")){if(Y.nobracket!==!0&&Y.strictBrackets===!0)throw new SyntaxError(M("closing","]"));Le=`\\${Le}`}else rn("brackets");wt({type:"bracket",value:Le});continue}if(Le==="]"){if(Y.nobracket===!0||Be&&Be.type==="bracket"&&Be.value.length===1){wt({type:"text",value:Le,output:`\\${Le}`});continue}if(xe.brackets===0){if(Y.strictBrackets===!0)throw new SyntaxError(M("opening","["));wt({type:"text",value:Le,output:`\\${Le}`});continue}Ir("brackets");const it=Be.value.slice(1);if(Be.posix!==!0&&it[0]==="^"&&!it.includes("/")&&(Le=`/${Le}`),Be.value+=Le,lr({value:Le}),Y.literalBrackets===!1||j.hasRegexChars(it))continue;const ft=j.escapeRegex(Be.value);if(xe.output=xe.output.slice(0,-Be.value.length),Y.literalBrackets===!0){xe.output+=ft,Be.value=ft;continue}Be.value=`(${Ee}${ft}|${Be.value})`,xe.output+=Be.value;continue}if(Le==="{"&&Y.nobrace!==!0){rn("braces");const it={type:"brace",value:Le,output:"(",outputIndex:xe.output.length,tokensIndex:xe.tokens.length};ht.push(it),wt(it);continue}if(Le==="}"){const it=ht[ht.length-1];if(Y.nobrace===!0||!it){wt({type:"text",value:Le,output:Le});continue}let ft=")";if(it.dots===!0){const Zt=we.slice(),er=[];for(let Jt=Zt.length-1;Jt>=0&&(we.pop(),Zt[Jt].type!=="brace");Jt--)Zt[Jt].type!=="dots"&&er.unshift(Zt[Jt].value);ft=H(er,Y),xe.backtrack=!0}if(it.comma!==!0&&it.dots!==!0){const Zt=xe.output.slice(0,it.outputIndex),er=xe.tokens.slice(it.tokensIndex);it.value=it.output="\\{",Le=ft="\\}",xe.output=Zt;for(const Jt of er)xe.output+=Jt.output||Jt.value}wt({type:"brace",value:Le,output:ft}),Ir("braces"),ht.pop();continue}if(Le==="|"){Pt.length>0&&Pt[Pt.length-1].conditions++,wt({type:"text",value:Le});continue}if(Le===","){let it=Le;const ft=ht[ht.length-1];ft&&Ot[Ot.length-1]==="braces"&&(ft.comma=!0,it="|"),wt({type:"comma",value:Le,output:it});continue}if(Le==="/"){if(Be.type==="dot"&&xe.index===xe.start+1){xe.start=xe.index+1,xe.consumed="",xe.output="",we.pop(),Be=at;continue}wt({type:"slash",value:Le,output:le});continue}if(Le==="."){if(xe.braces>0&&Be.type==="dot"){Be.value==="."&&(Be.output=te);const it=ht[ht.length-1];Be.type="dots",Be.output+=Le,Be.value+=Le,it.dots=!0;continue}if(xe.braces+xe.parens===0&&Be.type!=="bos"&&Be.type!=="slash"){wt({type:"text",value:Le,output:te});continue}wt({type:"dot",value:Le,output:te});continue}if(Le==="?"){if(!(Be&&Be.value==="(")&&Y.noextglob!==!0&&xt()==="("&&xt(2)!=="?"){tt("qmark",Le);continue}if(Be&&Be.type==="paren"){const ft=xt();let Zt=Le;if(ft==="<"&&!j.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");(Be.value==="("&&!/[!=<:]/.test(ft)||ft==="<"&&!/<([!=]|\w+>)/.test(vr()))&&(Zt=`\\${Le}`),wt({type:"text",value:Le,output:Zt});continue}if(Y.dot!==!0&&(Be.type==="slash"||Be.type==="bos")){wt({type:"qmark",value:Le,output:Ue});continue}wt({type:"qmark",value:Le,output:ve});continue}if(Le==="!"){if(Y.noextglob!==!0&&xt()==="("&&(xt(2)!=="?"||!/[!=<:]/.test(xt(3)))){tt("negate",Le);continue}if(Y.nonegate!==!0&&xe.index===0){Nr();continue}}if(Le==="+"){if(Y.noextglob!==!0&&xt()==="("&&xt(2)!=="?"){tt("plus",Le);continue}if(Be&&Be.value==="("||Y.regex===!1){wt({type:"plus",value:Le,output:Te});continue}if(Be&&(Be.type==="bracket"||Be.type==="paren"||Be.type==="brace")||xe.parens>0){wt({type:"plus",value:Le});continue}wt({type:"plus",value:Te});continue}if(Le==="@"){if(Y.noextglob!==!0&&xt()==="("&&xt(2)!=="?"){wt({type:"at",extglob:!0,value:Le,output:""});continue}wt({type:"text",value:Le});continue}if(Le!=="*"){(Le==="$"||Le==="^")&&(Le=`\\${Le}`);const it=ue.exec(vr());it&&(Le+=it[0],xe.index+=it[0].length),wt({type:"text",value:Le});continue}if(Be&&(Be.type==="globstar"||Be.star===!0)){Be.type="star",Be.star=!0,Be.value+=Le,Be.output=It,xe.backtrack=!0,xe.globstar=!0,Gt(Le);continue}let nt=vr();if(Y.noextglob!==!0&&/^\([^?]/.test(nt)){tt("star",Le);continue}if(Be.type==="star"){if(Y.noglobstar===!0){Gt(Le);continue}const it=Be.prev,ft=it.prev,Zt=it.type==="slash"||it.type==="bos",er=ft&&(ft.type==="star"||ft.type==="globstar");if(Y.bash===!0&&(!Zt||nt[0]&&nt[0]!=="/")){wt({type:"star",value:Le,output:""});continue}const Jt=xe.braces>0&&(it.type==="comma"||it.type==="brace"),wn=Pt.length&&(it.type==="pipe"||it.type==="paren");if(!Zt&&it.type!=="paren"&&!Jt&&!wn){wt({type:"star",value:Le,output:""});continue}for(;nt.slice(0,3)==="/**";){const pi=pe[xe.index+4];if(pi&&pi!=="/")break;nt=nt.slice(3),Gt("/**",3)}if(it.type==="bos"&&_t()){Be.type="globstar",Be.value+=Le,Be.output=Ne(Y),xe.output=Be.output,xe.globstar=!0,Gt(Le);continue}if(it.type==="slash"&&it.prev.type!=="bos"&&!er&&_t()){xe.output=xe.output.slice(0,-(it.output+Be.output).length),it.output=`(?:${it.output}`,Be.type="globstar",Be.output=Ne(Y)+(Y.strictSlashes?")":"|$)"),Be.value+=Le,xe.globstar=!0,xe.output+=it.output+Be.output,Gt(Le);continue}if(it.type==="slash"&&it.prev.type!=="bos"&&nt[0]==="/"){const pi=nt[1]!==void 0?"|$":"";xe.output=xe.output.slice(0,-(it.output+Be.output).length),it.output=`(?:${it.output}`,Be.type="globstar",Be.output=`${Ne(Y)}${le}|${le}${pi})`,Be.value+=Le,xe.output+=it.output+Be.output,xe.globstar=!0,Gt(Le+qt()),wt({type:"slash",value:"/",output:""});continue}if(it.type==="bos"&&nt[0]==="/"){Be.type="globstar",Be.value+=Le,Be.output=`(?:^|${le}|${Ne(Y)}${le})`,xe.output=Be.output,xe.globstar=!0,Gt(Le+qt()),wt({type:"slash",value:"/",output:""});continue}xe.output=xe.output.slice(0,-Be.output.length),Be.type="globstar",Be.output=Ne(Y),Be.value+=Le,xe.output+=Be.output,xe.globstar=!0,Gt(Le);continue}const Lt={type:"star",value:Le,output:It};if(Y.bash===!0){Lt.output=".*?",(Be.type==="bos"||Be.type==="slash")&&(Lt.output=Pe+Lt.output),wt(Lt);continue}if(Be&&(Be.type==="bracket"||Be.type==="paren")&&Y.regex===!0){Lt.output=Le,wt(Lt);continue}(xe.index===xe.start||Be.type==="slash"||Be.type==="dot")&&(Be.type==="dot"?(xe.output+=We,Be.output+=We):Y.dot===!0?(xe.output+=et,Be.output+=et):(xe.output+=Pe,Be.output+=Pe),xt()!=="*"&&(xe.output+=de,Be.output+=de)),wt(Lt)}for(;xe.brackets>0;){if(Y.strictBrackets===!0)throw new SyntaxError(M("closing","]"));xe.output=j.escapeLast(xe.output,"["),Ir("brackets")}for(;xe.parens>0;){if(Y.strictBrackets===!0)throw new SyntaxError(M("closing",")"));xe.output=j.escapeLast(xe.output,"("),Ir("parens")}for(;xe.braces>0;){if(Y.strictBrackets===!0)throw new SyntaxError(M("closing","}"));xe.output=j.escapeLast(xe.output,"{"),Ir("braces")}if(Y.strictSlashes!==!0&&(Be.type==="star"||Be.type==="bracket")&&wt({type:"maybe_slash",value:"",output:`${le}?`}),xe.backtrack===!0){xe.output="";for(const nt of xe.tokens)xe.output+=nt.output!=null?nt.output:nt.value,nt.suffix&&(xe.output+=nt.suffix)}return xe},"parse");X.fastpaths=(pe,F)=>{const Y={...F},Ve=typeof Y.maxLength=="number"?Math.min(se,Y.maxLength):se,qe=pe.length;if(qe>Ve)throw new SyntaxError(`Input length: ${qe}, exceeds maximum allowed length: ${Ve}`);pe=z[pe]||pe;const at=j.isWindows(F),{DOT_LITERAL:we,SLASH_LITERAL:Ee,ONE_CHAR:be,DOTS_SLASH:L,NO_DOT:he,NO_DOTS:te,NO_DOTS_SLASH:Te,STAR:le,START_ANCHOR:de}=q.globChars(at),Ce=Y.dot?te:he,Fe=Y.dot?Te:he,We=Y.capture?"":"?:",et={negated:!1,prefix:""};let ve=Y.bash===!0?".*?":le;Y.capture&&(ve=`(${ve})`);const Ue=a(Pe=>Pe.noglobstar===!0?ve:`(${We}(?:(?!${de}${Pe.dot?L:we}).)*?)`,"globstar"),Xe=a(Pe=>{switch(Pe){case"*":return`${Ce}${be}${ve}`;case".*":return`${we}${be}${ve}`;case"*.*":return`${Ce}${ve}${we}${be}${ve}`;case"*/*":return`${Ce}${ve}${Ee}${be}${Fe}${ve}`;case"**":return Ce+Ue(Y);case"**/*":return`(?:${Ce}${Ue(Y)}${Ee})?${Fe}${be}${ve}`;case"**/*.*":return`(?:${Ce}${Ue(Y)}${Ee})?${Fe}${ve}${we}${be}${ve}`;case"**/.*":return`(?:${Ce}${Ue(Y)}${Ee})?${we}${be}${ve}`;default:{const pt=/^(.*?)\.(\w+)$/.exec(Pe);if(!pt)return;const It=Xe(pt[1]);return It?It+we+pt[2]:void 0}}},"create"),Ke=j.removePrefix(pe,et);let Ne=Xe(Ke);return Ne&&Y.strictSlashes!==!0&&(Ne+=`${Ee}?`),Ne},m.exports=X},6087:(m,B,K)=>{"use strict";const q=K(1017),j=K(3921),se=K(3376),ne=K(8702),ue=K(1006),ce=a(H=>H&&typeof H=="object"&&!Array.isArray(H),"isObject"),z=a((H,M,X=!1)=>{if(Array.isArray(H)){const Ee=H.map(L=>z(L,M,X));return a(L=>{for(const he of Ee){const te=he(L);if(te)return te}return!1},"arrayMatcher")}const pe=ce(H)&&H.tokens&&H.input;if(H===""||typeof H!="string"&&!pe)throw new TypeError("Expected pattern to be a non-empty string");const F=M||{},Y=ne.isWindows(M),Ve=pe?z.compileRe(H,M):z.makeRe(H,M,!1,!0),qe=Ve.state;delete Ve.state;let at=a(()=>!1,"isIgnored");if(F.ignore){const Ee={...M,ignore:null,onMatch:null,onResult:null};at=z(F.ignore,Ee,X)}const we=a((Ee,be=!1)=>{const{isMatch:L,match:he,output:te}=z.test(Ee,Ve,M,{glob:H,posix:Y}),Te={glob:H,state:qe,regex:Ve,posix:Y,input:Ee,output:te,match:he,isMatch:L};return typeof F.onResult=="function"&&F.onResult(Te),L===!1?(Te.isMatch=!1,be?Te:!1):at(Ee)?(typeof F.onIgnore=="function"&&F.onIgnore(Te),Te.isMatch=!1,be?Te:!1):(typeof F.onMatch=="function"&&F.onMatch(Te),be?Te:!0)},"matcher");return X&&(we.state=qe),we},"picomatch");z.test=(H,M,X,{glob:pe,posix:F}={})=>{if(typeof H!="string")throw new TypeError("Expected input to be a string");if(H==="")return{isMatch:!1,output:""};const Y=X||{},Ve=Y.format||(F?ne.toPosixSlashes:null);let qe=H===pe,at=qe&&Ve?Ve(H):H;return qe===!1&&(at=Ve?Ve(H):H,qe=at===pe),(qe===!1||Y.capture===!0)&&(Y.matchBase===!0||Y.basename===!0?qe=z.matchBase(H,M,X,F):qe=M.exec(at)),{isMatch:Boolean(qe),match:qe,output:at}},z.matchBase=(H,M,X,pe=ne.isWindows(X))=>(M instanceof RegExp?M:z.makeRe(M,X)).test(q.basename(H)),z.isMatch=(H,M,X)=>z(M,X)(H),z.parse=(H,M)=>Array.isArray(H)?H.map(X=>z.parse(X,M)):se(H,{...M,fastpaths:!1}),z.scan=(H,M)=>j(H,M),z.compileRe=(H,M,X=!1,pe=!1)=>{if(X===!0)return H.output;const F=M||{},Y=F.contains?"":"^",Ve=F.contains?"":"$";let qe=`${Y}(?:${H.output})${Ve}`;H&&H.negated===!0&&(qe=`^(?!${qe}).*$`);const at=z.toRegex(qe,M);return pe===!0&&(at.state=H),at},z.makeRe=(H,M={},X=!1,pe=!1)=>{if(!H||typeof H!="string")throw new TypeError("Expected a non-empty string");let F={negated:!1,fastpaths:!0};return M.fastpaths!==!1&&(H[0]==="."||H[0]==="*")&&(F.output=se.fastpaths(H,M)),F.output||(F=se(H,M)),z.compileRe(F,M,X,pe)},z.toRegex=(H,M)=>{try{const X=M||{};return new RegExp(H,X.flags||(X.nocase?"i":""))}catch(X){if(M&&M.debug===!0)throw X;return/$^/}},z.constants=ue,m.exports=z},3921:(m,B,K)=>{"use strict";const q=K(8702),{CHAR_ASTERISK:j,CHAR_AT:se,CHAR_BACKWARD_SLASH:ne,CHAR_COMMA:ue,CHAR_DOT:ce,CHAR_EXCLAMATION_MARK:z,CHAR_FORWARD_SLASH:H,CHAR_LEFT_CURLY_BRACE:M,CHAR_LEFT_PARENTHESES:X,CHAR_LEFT_SQUARE_BRACKET:pe,CHAR_PLUS:F,CHAR_QUESTION_MARK:Y,CHAR_RIGHT_CURLY_BRACE:Ve,CHAR_RIGHT_PARENTHESES:qe,CHAR_RIGHT_SQUARE_BRACKET:at}=K(1006),we=a(L=>L===H||L===ne,"isPathSeparator"),Ee=a(L=>{L.isPrefix!==!0&&(L.depth=L.isGlobstar?1/0:1)},"depth"),be=a((L,he)=>{const te=he||{},Te=L.length-1,le=te.parts===!0||te.scanToEnd===!0,de=[],Ce=[],Fe=[];let We=L,et=-1,ve=0,Ue=0,Xe=!1,Ke=!1,Ne=!1,Pe=!1,pt=!1,It=!1,xe=!1,Pt=!1,ht=!1,Ot=!1,Be=0,Le,_t,xt={value:"",depth:0,isGlob:!1};const qt=a(()=>et>=Te,"eos"),vr=a(()=>We.charCodeAt(et+1),"peek"),Gt=a(()=>(Le=_t,We.charCodeAt(++et)),"advance");for(;et<Te;){_t=Gt();let wt;if(_t===ne){xe=xt.backslashes=!0,_t=Gt(),_t===M&&(It=!0);continue}if(It===!0||_t===M){for(Be++;qt()!==!0&&(_t=Gt());){if(_t===ne){xe=xt.backslashes=!0,Gt();continue}if(_t===M){Be++;continue}if(It!==!0&&_t===ce&&(_t=Gt())===ce){if(Xe=xt.isBrace=!0,Ne=xt.isGlob=!0,Ot=!0,le===!0)continue;break}if(It!==!0&&_t===ue){if(Xe=xt.isBrace=!0,Ne=xt.isGlob=!0,Ot=!0,le===!0)continue;break}if(_t===Ve&&(Be--,Be===0)){It=!1,Xe=xt.isBrace=!0,Ot=!0;break}}if(le===!0)continue;break}if(_t===H){if(de.push(et),Ce.push(xt),xt={value:"",depth:0,isGlob:!1},Ot===!0)continue;if(Le===ce&&et===ve+1){ve+=2;continue}Ue=et+1;continue}if(te.noext!==!0&&(_t===F||_t===se||_t===j||_t===Y||_t===z)===!0&&vr()===X){if(Ne=xt.isGlob=!0,Pe=xt.isExtglob=!0,Ot=!0,_t===z&&et===ve&&(ht=!0),le===!0){for(;qt()!==!0&&(_t=Gt());){if(_t===ne){xe=xt.backslashes=!0,_t=Gt();continue}if(_t===qe){Ne=xt.isGlob=!0,Ot=!0;break}}continue}break}if(_t===j){if(Le===j&&(pt=xt.isGlobstar=!0),Ne=xt.isGlob=!0,Ot=!0,le===!0)continue;break}if(_t===Y){if(Ne=xt.isGlob=!0,Ot=!0,le===!0)continue;break}if(_t===pe){for(;qt()!==!0&&(wt=Gt());){if(wt===ne){xe=xt.backslashes=!0,Gt();continue}if(wt===at){Ke=xt.isBracket=!0,Ne=xt.isGlob=!0,Ot=!0;break}}if(le===!0)continue;break}if(te.nonegate!==!0&&_t===z&&et===ve){Pt=xt.negated=!0,ve++;continue}if(te.noparen!==!0&&_t===X){if(Ne=xt.isGlob=!0,le===!0){for(;qt()!==!0&&(_t=Gt());){if(_t===X){xe=xt.backslashes=!0,_t=Gt();continue}if(_t===qe){Ot=!0;break}}continue}break}if(Ne===!0){if(Ot=!0,le===!0)continue;break}}te.noext===!0&&(Pe=!1,Ne=!1);let lr=We,Nr="",rn="";ve>0&&(Nr=We.slice(0,ve),We=We.slice(ve),Ue-=ve),lr&&Ne===!0&&Ue>0?(lr=We.slice(0,Ue),rn=We.slice(Ue)):Ne===!0?(lr="",rn=We):lr=We,lr&&lr!==""&&lr!=="/"&&lr!==We&&we(lr.charCodeAt(lr.length-1))&&(lr=lr.slice(0,-1)),te.unescape===!0&&(rn&&(rn=q.removeBackslashes(rn)),lr&&xe===!0&&(lr=q.removeBackslashes(lr)));const Ir={prefix:Nr,input:L,start:ve,base:lr,glob:rn,isBrace:Xe,isBracket:Ke,isGlob:Ne,isExtglob:Pe,isGlobstar:pt,negated:Pt,negatedExtglob:ht};if(te.tokens===!0&&(Ir.maxDepth=0,we(_t)||Ce.push(xt),Ir.tokens=Ce),te.parts===!0||te.tokens===!0){let wt;for(let tt=0;tt<de.length;tt++){const Mi=wt?wt+1:ve,nt=de[tt],Lt=L.slice(Mi,nt);te.tokens&&(tt===0&&ve!==0?(Ce[tt].isPrefix=!0,Ce[tt].value=Nr):Ce[tt].value=Lt,Ee(Ce[tt]),Ir.maxDepth+=Ce[tt].depth),(tt!==0||Lt!=="")&&Fe.push(Lt),wt=nt}if(wt&&wt+1<L.length){const tt=L.slice(wt+1);Fe.push(tt),te.tokens&&(Ce[Ce.length-1].value=tt,Ee(Ce[Ce.length-1]),Ir.maxDepth+=Ce[Ce.length-1].depth)}Ir.slashes=de,Ir.parts=Fe}return Ir},"scan");m.exports=be},8702:(m,B,K)=>{"use strict";const q=K(1017),j=process.platform==="win32",{REGEX_BACKSLASH:se,REGEX_REMOVE_BACKSLASH:ne,REGEX_SPECIAL_CHARS:ue,REGEX_SPECIAL_CHARS_GLOBAL:ce}=K(1006);B.isObject=z=>z!==null&&typeof z=="object"&&!Array.isArray(z),B.hasRegexChars=z=>ue.test(z),B.isRegexChar=z=>z.length===1&&B.hasRegexChars(z),B.escapeRegex=z=>z.replace(ce,"\\$1"),B.toPosixSlashes=z=>z.replace(se,"/"),B.removeBackslashes=z=>z.replace(ne,H=>H==="\\"?"":H),B.supportsLookbehinds=()=>{const z=process.version.slice(1).split(".").map(Number);return z.length===3&&z[0]>=9||z[0]===8&&z[1]>=10},B.isWindows=z=>z&&typeof z.windows=="boolean"?z.windows:j===!0||q.sep==="\\",B.escapeLast=(z,H,M)=>{const X=z.lastIndexOf(H,M);return X===-1?z:z[X-1]==="\\"?B.escapeLast(z,H,X-1):`${z.slice(0,X)}\\${z.slice(X)}`},B.removePrefix=(z,H={})=>{let M=z;return M.startsWith("./")&&(M=M.slice(2),H.prefix="./"),M},B.wrapOutput=(z,H={},M={})=>{const X=M.contains?"":"^",pe=M.contains?"":"$";let F=`${X}(?:${z})${pe}`;return H.negated===!0&&(F=`(?:^(?!${F}).*$)`),F}},842:(m,B,K)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),B.AbstractTokenizer=void 0;const q=K(5167);class j{constructor(ne){this.position=0,this.numBuffer=new Uint8Array(8),this.fileInfo=ne||{}}async readToken(ne,ue=this.position){const ce=Buffer.alloc(ne.len);if(await this.readBuffer(ce,{position:ue})<ne.len)throw new q.EndOfStreamError;return ne.get(ce,0)}async peekToken(ne,ue=this.position){const ce=Buffer.alloc(ne.len);if(await this.peekBuffer(ce,{position:ue})<ne.len)throw new q.EndOfStreamError;return ne.get(ce,0)}async readNumber(ne){if(await this.readBuffer(this.numBuffer,{length:ne.len})<ne.len)throw new q.EndOfStreamError;return ne.get(this.numBuffer,0)}async peekNumber(ne){if(await this.peekBuffer(this.numBuffer,{length:ne.len})<ne.len)throw new q.EndOfStreamError;return ne.get(this.numBuffer,0)}async ignore(ne){if(this.fileInfo.size!==void 0){const ue=this.fileInfo.size-this.position;if(ne>ue)return this.position+=ue,ue}return this.position+=ne,ne}async close(){}normalizeOptions(ne,ue){if(ue&&ue.position!==void 0&&ue.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");return ue?{mayBeLess:ue.mayBeLess===!0,offset:ue.offset?ue.offset:0,length:ue.length?ue.length:ne.length-(ue.offset?ue.offset:0),position:ue.position?ue.position:this.position}:{mayBeLess:!1,offset:0,length:ne.length,position:this.position}}}a(j,"AbstractTokenizer"),B.AbstractTokenizer=j},778:(m,B,K)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),B.BufferTokenizer=void 0;const q=K(5167),j=K(842);class se extends j.AbstractTokenizer{constructor(ue,ce){super(ce);this.uint8Array=ue,this.fileInfo.size=this.fileInfo.size?this.fileInfo.size:ue.length}async readBuffer(ue,ce){if(ce&&ce.position){if(ce.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");this.position=ce.position}const z=await this.peekBuffer(ue,ce);return this.position+=z,z}async peekBuffer(ue,ce){const z=this.normalizeOptions(ue,ce),H=Math.min(this.uint8Array.length-z.position,z.length);if(!z.mayBeLess&&H<z.length)throw new q.EndOfStreamError;return ue.set(this.uint8Array.subarray(z.position,z.position+H),z.offset),H}async close(){}}a(se,"BufferTokenizer"),B.BufferTokenizer=se},7859:(m,B,K)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),B.fromFile=B.FileTokenizer=void 0;const q=K(842),j=K(5167),se=K(7209);class ne extends q.AbstractTokenizer{constructor(z,H){super(H);this.fd=z}async readBuffer(z,H){const M=this.normalizeOptions(z,H);this.position=M.position;const X=await se.read(this.fd,z,M.offset,M.length,M.position);if(this.position+=X.bytesRead,X.bytesRead<M.length&&(!H||!H.mayBeLess))throw new j.EndOfStreamError;return X.bytesRead}async peekBuffer(z,H){const M=this.normalizeOptions(z,H),X=await se.read(this.fd,z,M.offset,M.length,M.position);if(!M.mayBeLess&&X.bytesRead<M.length)throw new j.EndOfStreamError;return X.bytesRead}async close(){return se.close(this.fd)}}a(ne,"FileTokenizer"),B.FileTokenizer=ne;async function ue(ce){const z=await se.stat(ce);if(!z.isFile)throw new Error(`File not a file: ${ce}`);const H=await se.open(ce,"r");return new ne(H,{path:ce,size:z.size})}a(ue,"fromFile"),B.fromFile=ue},7209:(m,B,K)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),B.readFile=B.writeFileSync=B.writeFile=B.read=B.open=B.close=B.stat=B.createReadStream=B.pathExists=void 0;const q=K(7147);B.pathExists=q.existsSync,B.createReadStream=q.createReadStream;async function j(M){return new Promise((X,pe)=>{q.stat(M,(F,Y)=>{F?pe(F):X(Y)})})}a(j,"stat"),B.stat=j;async function se(M){return new Promise((X,pe)=>{q.close(M,F=>{F?pe(F):X()})})}a(se,"close"),B.close=se;async function ne(M,X){return new Promise((pe,F)=>{q.open(M,X,(Y,Ve)=>{Y?F(Y):pe(Ve)})})}a(ne,"open"),B.open=ne;async function ue(M,X,pe,F,Y){return new Promise((Ve,qe)=>{q.read(M,X,pe,F,Y,(at,we,Ee)=>{at?qe(at):Ve({bytesRead:we,buffer:Ee})})})}a(ue,"read"),B.read=ue;async function ce(M,X){return new Promise((pe,F)=>{q.writeFile(M,X,Y=>{Y?F(Y):pe()})})}a(ce,"writeFile"),B.writeFile=ce;function z(M,X){q.writeFileSync(M,X)}a(z,"writeFileSync"),B.writeFileSync=z;async function H(M){return new Promise((X,pe)=>{q.readFile(M,(F,Y)=>{F?pe(F):X(Y)})})}a(H,"readFile"),B.readFile=H},599:(m,B,K)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),B.ReadStreamTokenizer=void 0;const q=K(842),j=K(5167),se=256e3;class ne extends q.AbstractTokenizer{constructor(ce,z){super(z);this.streamReader=new j.StreamReader(ce)}async getFileInfo(){return this.fileInfo}async readBuffer(ce,z){const H=this.normalizeOptions(ce,z),M=H.position-this.position;if(M>0)return await this.ignore(M),this.readBuffer(ce,z);if(M<0)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");if(H.length===0)return 0;const X=await this.streamReader.read(ce,H.offset,H.length);if(this.position+=X,(!z||!z.mayBeLess)&&X<H.length)throw new j.EndOfStreamError;return X}async peekBuffer(ce,z){const H=this.normalizeOptions(ce,z);let M=0;if(H.position){const X=H.position-this.position;if(X>0){const pe=new Uint8Array(H.length+X);return M=await this.peekBuffer(pe,{mayBeLess:H.mayBeLess}),ce.set(pe.subarray(X),H.offset),M-X}else if(X<0)throw new Error("Cannot peek from a negative offset in a stream")}if(H.length>0){try{M=await this.streamReader.peek(ce,H.offset,H.length)}catch(X){if(z&&z.mayBeLess&&X instanceof j.EndOfStreamError)return 0;throw X}if(!H.mayBeLess&&M<H.length)throw new j.EndOfStreamError}return M}async ignore(ce){const z=Math.min(se,ce),H=new Uint8Array(z);let M=0;for(;M<ce;){const X=ce-M,pe=await this.readBuffer(H,{length:Math.min(z,X)});if(pe<0)return pe;M+=pe}return M}}a(ne,"ReadStreamTokenizer"),B.ReadStreamTokenizer=ne},5849:(m,B,K)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),B.fromBuffer=B.fromStream=B.EndOfStreamError=void 0;const q=K(599),j=K(778);var se=K(5167);Object.defineProperty(B,"EndOfStreamError",{enumerable:!0,get:function(){return se.EndOfStreamError}});function ne(ce,z){return z=z||{},new q.ReadStreamTokenizer(ce,z)}a(ne,"fromStream"),B.fromStream=ne;function ue(ce,z){return new j.BufferTokenizer(ce,z)}a(ue,"fromBuffer"),B.fromBuffer=ue},6597:(m,B,K)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),B.fromStream=B.fromBuffer=B.EndOfStreamError=B.fromFile=void 0;const q=K(7209),j=K(5849);var se=K(7859);Object.defineProperty(B,"fromFile",{enumerable:!0,get:function(){return se.fromFile}});var ne=K(5849);Object.defineProperty(B,"EndOfStreamError",{enumerable:!0,get:function(){return ne.EndOfStreamError}}),Object.defineProperty(B,"fromBuffer",{enumerable:!0,get:function(){return ne.fromBuffer}});async function ue(ce,z){if(z=z||{},ce.path){const H=await q.stat(ce.path);z.path=ce.path,z.size=H.size}return j.fromStream(ce,z)}a(ue,"fromStream"),B.fromStream=ue},5702:(m,B,K)=>{"use strict";/*!
 * to-regex-range <https://github.com/micromatch/to-regex-range>
 *
 * Copyright (c) 2015-present, Jon Schlinkert.
 * Released under the MIT License.
 */const q=K(9924),j=a((we,Ee,be)=>{if(q(we)===!1)throw new TypeError("toRegexRange: expected the first argument to be a number");if(Ee===void 0||we===Ee)return String(we);if(q(Ee)===!1)throw new TypeError("toRegexRange: expected the second argument to be a number.");let L={relaxZeros:!0,...be};typeof L.strictZeros=="boolean"&&(L.relaxZeros=L.strictZeros===!1);let he=String(L.relaxZeros),te=String(L.shorthand),Te=String(L.capture),le=String(L.wrap),de=we+":"+Ee+"="+he+te+Te+le;if(j.cache.hasOwnProperty(de))return j.cache[de].result;let Ce=Math.min(we,Ee),Fe=Math.max(we,Ee);if(Math.abs(Ce-Fe)===1){let Xe=we+"|"+Ee;return L.capture?`(${Xe})`:L.wrap===!1?Xe:`(?:${Xe})`}let We=qe(we)||qe(Ee),et={min:we,max:Ee,a:Ce,b:Fe},ve=[],Ue=[];if(We&&(et.isPadded=We,et.maxLen=String(et.max).length),Ce<0){let Xe=Fe<0?Math.abs(Fe):1;Ue=ce(Xe,Math.abs(Ce),et,L),Ce=et.a=0}return Fe>=0&&(ve=ce(Ce,Fe,et,L)),et.negatives=Ue,et.positives=ve,et.result=se(Ue,ve,L),L.capture===!0?et.result=`(${et.result})`:L.wrap!==!1&&ve.length+Ue.length>1&&(et.result=`(?:${et.result})`),j.cache[de]=et,et.result},"toRegexRange");function se(we,Ee,be){let L=z(we,Ee,"-",!1,be)||[],he=z(Ee,we,"",!1,be)||[],te=z(we,Ee,"-?",!0,be)||[];return L.concat(te).concat(he).join("|")}a(se,"collatePatterns");function ne(we,Ee){let be=1,L=1,he=pe(we,be),te=new Set([Ee]);for(;we<=he&&he<=Ee;)te.add(he),be+=1,he=pe(we,be);for(he=F(Ee+1,L)-1;we<he&&he<=Ee;)te.add(he),L+=1,he=F(Ee+1,L)-1;return te=[...te],te.sort(M),te}a(ne,"splitToRanges");function ue(we,Ee,be){if(we===Ee)return{pattern:we,count:[],digits:0};let L=H(we,Ee),he=L.length,te="",Te=0;for(let le=0;le<he;le++){let[de,Ce]=L[le];de===Ce?te+=de:de!=="0"||Ce!=="9"?te+=Ve(de,Ce,be):Te++}return Te&&(te+=be.shorthand===!0?"\\d":"[0-9]"),{pattern:te,count:[Te],digits:he}}a(ue,"rangeToPattern");function ce(we,Ee,be,L){let he=ne(we,Ee),te=[],Te=we,le;for(let de=0;de<he.length;de++){let Ce=he[de],Fe=ue(String(Te),String(Ce),L),We="";if(!be.isPadded&&le&&le.pattern===Fe.pattern){le.count.length>1&&le.count.pop(),le.count.push(Fe.count[0]),le.string=le.pattern+Y(le.count),Te=Ce+1;continue}be.isPadded&&(We=at(Ce,be,L)),Fe.string=We+Fe.pattern+Y(Fe.count),te.push(Fe),Te=Ce+1,le=Fe}return te}a(ce,"splitToPatterns");function z(we,Ee,be,L,he){let te=[];for(let Te of we){let{string:le}=Te;!L&&!X(Ee,"string",le)&&te.push(be+le),L&&X(Ee,"string",le)&&te.push(be+le)}return te}a(z,"filterPatterns");function H(we,Ee){let be=[];for(let L=0;L<we.length;L++)be.push([we[L],Ee[L]]);return be}a(H,"zip");function M(we,Ee){return we>Ee?1:Ee>we?-1:0}a(M,"compare");function X(we,Ee,be){return we.some(L=>L[Ee]===be)}a(X,"contains");function pe(we,Ee){return Number(String(we).slice(0,-Ee)+"9".repeat(Ee))}a(pe,"countNines");function F(we,Ee){return we-we%Math.pow(10,Ee)}a(F,"countZeros");function Y(we){let[Ee=0,be=""]=we;return be||Ee>1?`{${Ee+(be?","+be:"")}}`:""}a(Y,"toQuantifier");function Ve(we,Ee,be){return`[${we}${Ee-we==1?"":"-"}${Ee}]`}a(Ve,"toCharacterClass");function qe(we){return/^-?(0+)\d/.test(we)}a(qe,"hasPadding");function at(we,Ee,be){if(!Ee.isPadded)return we;let L=Math.abs(Ee.maxLen-String(we).length),he=be.relaxZeros!==!1;switch(L){case 0:return"";case 1:return he?"0?":"0";case 2:return he?"0{0,2}":"00";default:return he?`0{0,${L}}`:`0{${L}}`}}a(at,"padZeros"),j.cache={},j.clearCache=()=>j.cache={},m.exports=j},3416:(m,B,K)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),B.AnsiStringType=B.StringType=B.BufferType=B.Uint8ArrayType=B.IgnoreType=B.Float80_LE=B.Float80_BE=B.Float64_LE=B.Float64_BE=B.Float32_LE=B.Float32_BE=B.Float16_LE=B.Float16_BE=B.INT64_BE=B.UINT64_BE=B.INT64_LE=B.UINT64_LE=B.INT32_LE=B.INT32_BE=B.INT24_BE=B.INT24_LE=B.INT16_LE=B.INT16_BE=B.INT8=B.UINT32_BE=B.UINT32_LE=B.UINT24_BE=B.UINT24_LE=B.UINT16_BE=B.UINT16_LE=B.UINT8=void 0;const q=K(645);function j(H){return new DataView(H.buffer,H.byteOffset)}a(j,"dv"),B.UINT8={len:1,get(H,M){return j(H).getUint8(M)},put(H,M,X){return j(H).setUint8(M,X),M+1}},B.UINT16_LE={len:2,get(H,M){return j(H).getUint16(M,!0)},put(H,M,X){return j(H).setUint16(M,X,!0),M+2}},B.UINT16_BE={len:2,get(H,M){return j(H).getUint16(M)},put(H,M,X){return j(H).setUint16(M,X),M+2}},B.UINT24_LE={len:3,get(H,M){const X=j(H);return X.getUint8(M)+(X.getUint16(M+1,!0)<<8)},put(H,M,X){const pe=j(H);return pe.setUint8(M,X&255),pe.setUint16(M+1,X>>8,!0),M+3}},B.UINT24_BE={len:3,get(H,M){const X=j(H);return(X.getUint16(M)<<8)+X.getUint8(M+2)},put(H,M,X){const pe=j(H);return pe.setUint16(M,X>>8),pe.setUint8(M+2,X&255),M+3}},B.UINT32_LE={len:4,get(H,M){return j(H).getUint32(M,!0)},put(H,M,X){return j(H).setUint32(M,X,!0),M+4}},B.UINT32_BE={len:4,get(H,M){return j(H).getUint32(M)},put(H,M,X){return j(H).setUint32(M,X),M+4}},B.INT8={len:1,get(H,M){return j(H).getInt8(M)},put(H,M,X){return j(H).setInt8(M,X),M+2}},B.INT16_BE={len:2,get(H,M){return j(H).getInt16(M)},put(H,M,X){return j(H).setInt16(M,X),M+2}},B.INT16_LE={len:2,get(H,M){return j(H).getInt16(M,!0)},put(H,M,X){return j(H).setInt16(M,X,!0),M+2}},B.INT24_LE={len:3,get(H,M){const X=B.UINT24_LE.get(H,M);return X>8388607?X-16777216:X},put(H,M,X){const pe=j(H);return pe.setUint8(M,X&255),pe.setUint16(M+1,X>>8,!0),M+3}},B.INT24_BE={len:3,get(H,M){const X=B.UINT24_BE.get(H,M);return X>8388607?X-16777216:X},put(H,M,X){const pe=j(H);return pe.setUint16(M,X>>8),pe.setUint8(M+2,X&255),M+3}},B.INT32_BE={len:4,get(H,M){return j(H).getInt32(M)},put(H,M,X){return j(H).setInt32(M,X),M+4}},B.INT32_LE={len:4,get(H,M){return j(H).getInt32(M,!0)},put(H,M,X){return j(H).setInt32(M,X,!0),M+4}},B.UINT64_LE={len:8,get(H,M){return j(H).getBigUint64(M,!0)},put(H,M,X){return j(H).setBigUint64(M,X,!0),M+8}},B.INT64_LE={len:8,get(H,M){return j(H).getBigInt64(M,!0)},put(H,M,X){return j(H).setBigInt64(M,X,!0),M+8}},B.UINT64_BE={len:8,get(H,M){return j(H).getBigUint64(M)},put(H,M,X){return j(H).setBigUint64(M,X),M+8}},B.INT64_BE={len:8,get(H,M){return j(H).getBigInt64(M)},put(H,M,X){return j(H).setBigInt64(M,X),M+8}},B.Float16_BE={len:2,get(H,M){return q.read(H,M,!1,10,this.len)},put(H,M,X){return q.write(H,X,M,!1,10,this.len),M+this.len}},B.Float16_LE={len:2,get(H,M){return q.read(H,M,!0,10,this.len)},put(H,M,X){return q.write(H,X,M,!0,10,this.len),M+this.len}},B.Float32_BE={len:4,get(H,M){return j(H).getFloat32(M)},put(H,M,X){return j(H).setFloat32(M,X),M+4}},B.Float32_LE={len:4,get(H,M){return j(H).getFloat32(M,!0)},put(H,M,X){return j(H).setFloat32(M,X,!0),M+4}},B.Float64_BE={len:8,get(H,M){return j(H).getFloat64(M)},put(H,M,X){return j(H).setFloat64(M,X),M+8}},B.Float64_LE={len:8,get(H,M){return j(H).getFloat64(M,!0)},put(H,M,X){return j(H).setFloat64(M,X,!0),M+8}},B.Float80_BE={len:10,get(H,M){return q.read(H,M,!1,63,this.len)},put(H,M,X){return q.write(H,X,M,!1,63,this.len),M+this.len}},B.Float80_LE={len:10,get(H,M){return q.read(H,M,!0,63,this.len)},put(H,M,X){return q.write(H,X,M,!0,63,this.len),M+this.len}};class se{constructor(M){this.len=M}get(M,X){}}a(se,"IgnoreType"),B.IgnoreType=se;class ne{constructor(M){this.len=M}get(M,X){return M.subarray(X,X+this.len)}}a(ne,"Uint8ArrayType"),B.Uint8ArrayType=ne;class ue{constructor(M){this.len=M}get(M,X){return M.slice(X,X+this.len)}}a(ue,"BufferType"),B.BufferType=ue;class ce{constructor(M,X){this.len=M,this.encoding=X}get(M,X){return Buffer.from(M).toString(this.encoding,X,X+this.len)}}a(ce,"StringType"),B.StringType=ce;class z{constructor(M){this.len=M}static decode(M,X,pe){let F="";for(let Y=X;Y<pe;++Y)F+=z.codePointToString(z.singleByteDecoder(M[Y]));return F}static inRange(M,X,pe){return X<=M&&M<=pe}static codePointToString(M){return M<=65535?String.fromCharCode(M):(M-=65536,String.fromCharCode((M>>10)+55296,(M&1023)+56320))}static singleByteDecoder(M){if(z.inRange(M,0,127))return M;const X=z.windows1252[M-128];if(X===null)throw Error("invaliding encoding");return X}get(M,X=0){return z.decode(M,X,X+this.len)}}a(z,"AnsiStringType"),B.AnsiStringType=z,z.windows1252=[8364,129,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,141,381,143,144,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,157,382,376,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]},8361:(m,B,K)=>{var q=Object.create,j=Object.defineProperty,se=Object.getOwnPropertyDescriptor,ne=Object.getOwnPropertyNames,ue=Object.getOwnPropertySymbols,ce=Object.getPrototypeOf,z=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable,M=a((s,T,f)=>T in s?j(s,T,{enumerable:!0,configurable:!0,writable:!0,value:f}):s[T]=f,"ml"),X=a((s,T)=>{for(var f in T||(T={}))z.call(T,f)&&M(s,f,T[f]);if(ue)for(var f of ue(T))H.call(T,f)&&M(s,f,T[f]);return s},"zt"),pe=a(s=>j(s,"__esModule",{value:!0}),"El"),F=a((s,T)=>()=>(T||s((T={exports:{}}).exports,T),T.exports),"l"),Y=a((s,T)=>{pe(s);for(var f in T)j(s,f,{get:T[f],enumerable:!0})},"jE"),Ve=a((s,T,f)=>{if(T&&typeof T=="object"||typeof T=="function")for(let w of ne(T))!z.call(s,w)&&w!=="default"&&j(s,w,{get:()=>T[w],enumerable:!(f=se(T,w))||f.enumerable});return s},"HE"),qe=a(s=>Ve(pe(j(s!=null?q(ce(s)):{},"default",s&&s.__esModule&&"default"in s?{get:()=>s.default,enumerable:!0}:{value:s,enumerable:!0})),s),"jn"),at=F((s,T)=>{"use strict";var f=function(){function w(){}return a(w,"e"),w.info=function(x){for(var p=[],u=1;u<arguments.length;u++)p[u-1]=arguments[u];w.enableDebug&&console.info(w.TAG+x,p)},w.warn=function(x){for(var p=[],u=1;u<arguments.length;u++)p[u-1]=arguments[u];w.disableWarnings||console.warn(w.TAG+x,p)},w.enableDebug=!1,w.disableWarnings=!1,w.disableErrors=!1,w.TAG="ApplicationInsights:",w}();T.exports=f}),we=F(s=>{"use strict";var T=s&&s.__assign||function(){return T=Object.assign||function(p){for(var u,g=1,v=arguments.length;g<v;g++){u=arguments[g];for(var _ in u)Object.prototype.hasOwnProperty.call(u,_)&&(p[_]=u[_])}return p},T.apply(this,arguments)};Object.defineProperty(s,"__esModule",{value:!0}),s.AsyncScopeManager=s.OpenTelemetryScopeManagerWrapper=void 0;var f=mn(),w=K(2361),x=function(){function p(){}return a(p,"e"),p.prototype.active=function(){var u=this,g=f.CorrelationContextManager.getCurrentContext();return T(T({},g),{getValue:function(v){return u._activeSymbol?v===u._activeSymbol?g:!1:(u._activeSymbol=v,g)},setValue:function(){}})},p.prototype.with=function(u,g){var v=u.parentSpanId,_=u.name,b=p._spanToContext(u,v,_);return f.CorrelationContextManager.runWithContext(b,g)()},p.prototype.bind=function(u){return typeof u=="function"?f.CorrelationContextManager.wrapCallback(u):(u instanceof w.EventEmitter&&f.CorrelationContextManager.wrapEmitter(u),u)},p.prototype.enable=function(){return f.CorrelationContextManager.enable(),this},p.prototype.disable=function(){return f.CorrelationContextManager.disable(),this},p._spanToContext=function(u,g,v){var _=g?"|"+u.spanContext().traceId+"."+g+".":u.spanContext().traceId,b=T(T({},u.spanContext()),{traceFlags:u.spanContext().traceFlags}),y=f.CorrelationContextManager.spanToContextObject(b,_,v);return y},p}();s.OpenTelemetryScopeManagerWrapper=x,s.AsyncScopeManager=new x}),Ee=F((s,T)=>{s=T.exports=Kt;var f;typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?f=a(function(){var ee=Array.prototype.slice.call(arguments,0);ee.unshift("SEMVER"),console.log.apply(console,ee)},"N"):f=a(function(){},"N"),s.SEMVER_SPEC_VERSION="2.0.0";var w=256,x=Number.MAX_SAFE_INTEGER||9007199254740991,p=16,u=s.re=[],g=s.src=[],v=0,_=v++;g[_]="0|[1-9]\\d*";var b=v++;g[b]="[0-9]+";var y=v++;g[y]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var E=v++;g[E]="("+g[_]+")\\.("+g[_]+")\\.("+g[_]+")";var C=v++;g[C]="("+g[b]+")\\.("+g[b]+")\\.("+g[b]+")";var A=v++;g[A]="(?:"+g[_]+"|"+g[y]+")";var R=v++;g[R]="(?:"+g[b]+"|"+g[y]+")";var D=v++;g[D]="(?:-("+g[A]+"(?:\\."+g[A]+")*))";var k=v++;g[k]="(?:-?("+g[R]+"(?:\\."+g[R]+")*))";var G=v++;g[G]="[0-9A-Za-z-]+";var Z=v++;g[Z]="(?:\\+("+g[G]+"(?:\\."+g[G]+")*))";var Q=v++,fe="v?"+g[E]+g[D]+"?"+g[Z]+"?";g[Q]="^"+fe+"$";var Se="[v=\\s]*"+g[C]+g[k]+"?"+g[Z]+"?",Me=v++;g[Me]="^"+Se+"$";var He=v++;g[He]="((?:<|>)?=?)";var Qe=v++;g[Qe]=g[b]+"|x|X|\\*";var Ye=v++;g[Ye]=g[_]+"|x|X|\\*";var mt=v++;g[mt]="[v=\\s]*("+g[Ye]+")(?:\\.("+g[Ye]+")(?:\\.("+g[Ye]+")(?:"+g[D]+")?"+g[Z]+"?)?)?";var Ct=v++;g[Ct]="[v=\\s]*("+g[Qe]+")(?:\\.("+g[Qe]+")(?:\\.("+g[Qe]+")(?:"+g[k]+")?"+g[Z]+"?)?)?";var Vt=v++;g[Vt]="^"+g[He]+"\\s*"+g[mt]+"$";var Bt=v++;g[Bt]="^"+g[He]+"\\s*"+g[Ct]+"$";var Er=v++;g[Er]="(?:^|[^\\d])(\\d{1,"+p+"})(?:\\.(\\d{1,"+p+"}))?(?:\\.(\\d{1,"+p+"}))?(?:$|[^\\d])";var Ht=v++;g[Ht]="(?:~>?)";var Je=v++;g[Je]="(\\s*)"+g[Ht]+"\\s+",u[Je]=new RegExp(g[Je],"g");var ct="$1~",dt=v++;g[dt]="^"+g[Ht]+g[mt]+"$";var Et=v++;g[Et]="^"+g[Ht]+g[Ct]+"$";var kt=v++;g[kt]="(?:\\^)";var zt=v++;g[zt]="(\\s*)"+g[kt]+"\\s+",u[zt]=new RegExp(g[zt],"g");var Tt="$1^",ar=v++;g[ar]="^"+g[kt]+g[mt]+"$";var gr=v++;g[gr]="^"+g[kt]+g[Ct]+"$";var fr=v++;g[fr]="^"+g[He]+"\\s*("+Se+")$|^$";var _r=v++;g[_r]="^"+g[He]+"\\s*("+fe+")$|^$";var or=v++;g[or]="(\\s*)"+g[He]+"\\s*("+Se+"|"+g[mt]+")",u[or]=new RegExp(g[or],"g");var Pr="$1$2$3",En=v++;g[En]="^\\s*("+g[mt]+")\\s+-\\s+("+g[mt]+")\\s*$";var Nt=v++;g[Nt]="^\\s*("+g[Ct]+")\\s+-\\s+("+g[Ct]+")\\s*$";var At=v++;for(g[At]="(<|>)?=?\\s*\\*",nr=0;nr<v;nr++)f(nr,g[nr]),u[nr]||(u[nr]=new RegExp(g[nr]));var nr;s.parse=jr;function jr(ee,me){if((!me||typeof me!="object")&&(me={loose:!!me,includePrerelease:!1}),ee instanceof Kt)return ee;if(typeof ee!="string"||ee.length>w)return null;var Re=me.loose?u[Me]:u[Q];if(!Re.test(ee))return null;try{return new Kt(ee,me)}catch(rt){return null}}a(jr,"Qt"),s.valid=Sc;function Sc(ee,me){var Re=jr(ee,me);return Re?Re.version:null}a(Sc,"$E"),s.clean=oo;function oo(ee,me){var Re=jr(ee.trim().replace(/^[=v]+/,""),me);return Re?Re.version:null}a(oo,"zE"),s.SemVer=Kt;function Kt(ee,me){if((!me||typeof me!="object")&&(me={loose:!!me,includePrerelease:!1}),ee instanceof Kt){if(ee.loose===me.loose)return ee;ee=ee.version}else if(typeof ee!="string")throw new TypeError("Invalid Version: "+ee);if(ee.length>w)throw new TypeError("version is longer than "+w+" characters");if(!(this instanceof Kt))return new Kt(ee,me);f("SemVer",ee,me),this.options=me,this.loose=!!me.loose;var Re=ee.trim().match(me.loose?u[Me]:u[Q]);if(!Re)throw new TypeError("Invalid Version: "+ee);if(this.raw=ee,this.major=+Re[1],this.minor=+Re[2],this.patch=+Re[3],this.major>x||this.major<0)throw new TypeError("Invalid major version");if(this.minor>x||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>x||this.patch<0)throw new TypeError("Invalid patch version");Re[4]?this.prerelease=Re[4].split(".").map(function(rt){if(/^[0-9]+$/.test(rt)){var lt=+rt;if(lt>=0&&lt<x)return lt}return rt}):this.prerelease=[],this.build=Re[5]?Re[5].split("."):[],this.format()}a(Kt,"b"),Kt.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},Kt.prototype.toString=function(){return this.version},Kt.prototype.compare=function(ee){return f("SemVer.compare",this.version,this.options,ee),ee instanceof Kt||(ee=new Kt(ee,this.options)),this.compareMain(ee)||this.comparePre(ee)},Kt.prototype.compareMain=function(ee){return ee instanceof Kt||(ee=new Kt(ee,this.options)),ei(this.major,ee.major)||ei(this.minor,ee.minor)||ei(this.patch,ee.patch)},Kt.prototype.comparePre=function(ee){if(ee instanceof Kt||(ee=new Kt(ee,this.options)),this.prerelease.length&&!ee.prerelease.length)return-1;if(!this.prerelease.length&&ee.prerelease.length)return 1;if(!this.prerelease.length&&!ee.prerelease.length)return 0;var me=0;do{var Re=this.prerelease[me],rt=ee.prerelease[me];if(f("prerelease compare",me,Re,rt),Re===void 0&&rt===void 0)return 0;if(rt===void 0)return 1;if(Re===void 0)return-1;if(Re!==rt)return ei(Re,rt)}while(++me)},Kt.prototype.inc=function(ee,me){switch(ee){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",me);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",me);break;case"prepatch":this.prerelease.length=0,this.inc("patch",me),this.inc("pre",me);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",me),this.inc("pre",me);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var Re=this.prerelease.length;--Re>=0;)typeof this.prerelease[Re]=="number"&&(this.prerelease[Re]++,Re=-2);Re===-1&&this.prerelease.push(0)}me&&(this.prerelease[0]===me?isNaN(this.prerelease[1])&&(this.prerelease=[me,0]):this.prerelease=[me,0]);break;default:throw new Error("invalid increment argument: "+ee)}return this.format(),this.raw=this.version,this},s.inc=Dn;function Dn(ee,me,Re,rt){typeof Re=="string"&&(rt=Re,Re=void 0);try{return new Kt(ee,Re).inc(me,rt).version}catch(lt){return null}}a(Dn,"KE"),s.diff=ao;function ao(ee,me){if(co(ee,me))return null;var Re=jr(ee),rt=jr(me),lt="";if(Re.prerelease.length||rt.prerelease.length){lt="pre";var yt="prerelease"}for(var vt in Re)if((vt==="major"||vt==="minor"||vt==="patch")&&Re[vt]!==rt[vt])return lt+vt;return yt}a(ao,"XE"),s.compareIdentifiers=ei;var Hi=/^[0-9]+$/;function ei(ee,me){var Re=Hi.test(ee),rt=Hi.test(me);return Re&&rt&&(ee=+ee,me=+me),ee===me?0:Re&&!rt?-1:rt&&!Re?1:ee<me?-1:1}a(ei,"Lr"),s.rcompareIdentifiers=Ci;function Ci(ee,me){return ei(me,ee)}a(Ci,"YE"),s.major=Un;function Un(ee,me){return new Kt(ee,me).major}a(Un,"QE"),s.minor=ms;function ms(ee,me){return new Kt(ee,me).minor}a(ms,"WE"),s.patch=vs;function vs(ee,me){return new Kt(ee,me).patch}a(vs,"ZE"),s.compare=jn;function jn(ee,me,Re){return new Kt(ee,Re).compare(new Kt(me,Re))}a(jn,"at"),s.compareLoose=ys;function ys(ee,me){return jn(ee,me,!0)}a(ys,"JE"),s.rcompare=so;function so(ee,me,Re){return jn(me,ee,Re)}a(so,"ey"),s.sort=Sa;function Sa(ee,me){return ee.sort(function(Re,rt){return s.compare(Re,rt,me)})}a(Sa,"ty"),s.rsort=ti;function ti(ee,me){return ee.sort(function(Re,rt){return s.rcompare(Re,rt,me)})}a(ti,"ry"),s.gt=Ui;function Ui(ee,me,Re){return jn(ee,me,Re)>0}a(Ui,"Gn"),s.lt=Ti;function Ti(ee,me,Re){return jn(ee,me,Re)<0}a(Ti,"Wi"),s.eq=co;function co(ee,me,Re){return jn(ee,me,Re)===0}a(co,"To"),s.neq=Ho;function Ho(ee,me,Re){return jn(ee,me,Re)!==0}a(Ho,"ql"),s.gte=Uo;function Uo(ee,me,Re){return jn(ee,me,Re)>=0}a(Uo,"So"),s.lte=vn;function vn(ee,me,Re){return jn(ee,me,Re)<=0}a(vn,"Ao"),s.cmp=ri;function ri(ee,me,Re,rt){switch(me){case"===":return typeof ee=="object"&&(ee=ee.version),typeof Re=="object"&&(Re=Re.version),ee===Re;case"!==":return typeof ee=="object"&&(ee=ee.version),typeof Re=="object"&&(Re=Re.version),ee!==Re;case"":case"=":case"==":return co(ee,Re,rt);case"!=":return Ho(ee,Re,rt);case">":return Ui(ee,Re,rt);case">=":return Uo(ee,Re,rt);case"<":return Ti(ee,Re,rt);case"<=":return vn(ee,Re,rt);default:throw new TypeError("Invalid operator: "+me)}}a(ri,"Zi"),s.Comparator=yn;function yn(ee,me){if((!me||typeof me!="object")&&(me={loose:!!me,includePrerelease:!1}),ee instanceof yn){if(ee.loose===!!me.loose)return ee;ee=ee.value}if(!(this instanceof yn))return new yn(ee,me);f("comparator",ee,me),this.options=me,this.loose=!!me.loose,this.parse(ee),this.semver===bt?this.value="":this.value=this.operator+this.semver.version,f("comp",this)}a(yn,"Ne");var bt={};yn.prototype.parse=function(ee){var me=this.options.loose?u[fr]:u[_r],Re=ee.match(me);if(!Re)throw new TypeError("Invalid comparator: "+ee);this.operator=Re[1],this.operator==="="&&(this.operator=""),Re[2]?this.semver=new Kt(Re[2],this.options.loose):this.semver=bt},yn.prototype.toString=function(){return this.value},yn.prototype.test=function(ee){return f("Comparator.test",ee,this.options.loose),this.semver===bt?!0:(typeof ee=="string"&&(ee=new Kt(ee,this.options)),ri(ee,this.operator,this.semver,this.options))},yn.prototype.intersects=function(ee,me){if(!(ee instanceof yn))throw new TypeError("a Comparator is required");(!me||typeof me!="object")&&(me={loose:!!me,includePrerelease:!1});var Re;if(this.operator==="")return Re=new sr(ee.value,me),uo(this.value,Re,me);if(ee.operator==="")return Re=new sr(this.value,me),uo(ee.semver,Re,me);var rt=(this.operator===">="||this.operator===">")&&(ee.operator===">="||ee.operator===">"),lt=(this.operator==="<="||this.operator==="<")&&(ee.operator==="<="||ee.operator==="<"),yt=this.semver.version===ee.semver.version,vt=(this.operator===">="||this.operator==="<=")&&(ee.operator===">="||ee.operator==="<="),Rt=ri(this.semver,"<",ee.semver,me)&&(this.operator===">="||this.operator===">")&&(ee.operator==="<="||ee.operator==="<"),Ut=ri(this.semver,">",ee.semver,me)&&(this.operator==="<="||this.operator==="<")&&(ee.operator===">="||ee.operator===">");return rt||lt||yt&&vt||Rt||Ut},s.Range=sr;function sr(ee,me){if((!me||typeof me!="object")&&(me={loose:!!me,includePrerelease:!1}),ee instanceof sr)return ee.loose===!!me.loose&&ee.includePrerelease===!!me.includePrerelease?ee:new sr(ee.raw,me);if(ee instanceof yn)return new sr(ee.value,me);if(!(this instanceof sr))return new sr(ee,me);if(this.options=me,this.loose=!!me.loose,this.includePrerelease=!!me.includePrerelease,this.raw=ee,this.set=ee.split(/\s*\|\|\s*/).map(function(Re){return this.parseRange(Re.trim())},this).filter(function(Re){return Re.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+ee);this.format()}a(sr,"U"),sr.prototype.format=function(){return this.range=this.set.map(function(ee){return ee.join(" ").trim()}).join("||").trim(),this.range},sr.prototype.toString=function(){return this.range},sr.prototype.parseRange=function(ee){var me=this.options.loose;ee=ee.trim();var Re=me?u[Nt]:u[En];ee=ee.replace(Re,Ec),f("hyphen replace",ee),ee=ee.replace(u[or],Pr),f("comparator trim",ee,u[or]),ee=ee.replace(u[Je],ct),ee=ee.replace(u[zt],Tt),ee=ee.split(/\s+/).join(" ");var rt=me?u[fr]:u[_r],lt=ee.split(" ").map(function(yt){return qn(yt,this.options)},this).join(" ").split(/\s+/);return this.options.loose&&(lt=lt.filter(function(yt){return!!yt.match(rt)})),lt=lt.map(function(yt){return new yn(yt,this.options)},this),lt},sr.prototype.intersects=function(ee,me){if(!(ee instanceof sr))throw new TypeError("a Range is required");return this.set.some(function(Re){return Re.every(function(rt){return ee.set.some(function(lt){return lt.every(function(yt){return rt.intersects(yt,me)})})})})},s.toComparators=jo;function jo(ee,me){return new sr(ee,me).set.map(function(Re){return Re.map(function(rt){return rt.value}).join(" ").trim().split(" ")})}a(jo,"ny");function qn(ee,me){return f("comp",ee,me),ee=lo(ee,me),f("caret",ee),ee=ni(ee,me),f("tildes",ee),ee=Hr(ee,me),f("xrange",ee),ee=Dr(ee,me),f("stars",ee),ee}a(qn,"iy");function Br(ee){return!ee||ee.toLowerCase()==="x"||ee==="*"}a(Br,"ge");function ni(ee,me){return ee.trim().split(/\s+/).map(function(Re){return _s(Re,me)}).join(" ")}a(ni,"ay");function _s(ee,me){var Re=me.loose?u[Et]:u[dt];return ee.replace(Re,function(rt,lt,yt,vt,Rt){f("tilde",ee,rt,lt,yt,vt,Rt);var Ut;return Br(lt)?Ut="":Br(yt)?Ut=">="+lt+".0.0 <"+(+lt+1)+".0.0":Br(vt)?Ut=">="+lt+"."+yt+".0 <"+lt+"."+(+yt+1)+".0":Rt?(f("replaceTilde pr",Rt),Ut=">="+lt+"."+yt+"."+vt+"-"+Rt+" <"+lt+"."+(+yt+1)+".0"):Ut=">="+lt+"."+yt+"."+vt+" <"+lt+"."+(+yt+1)+".0",f("tilde return",Ut),Ut})}a(_s,"sy");function lo(ee,me){return ee.trim().split(/\s+/).map(function(Re){return ws(Re,me)}).join(" ")}a(lo,"oy");function ws(ee,me){f("caret",ee,me);var Re=me.loose?u[gr]:u[ar];return ee.replace(Re,function(rt,lt,yt,vt,Rt){f("caret",ee,rt,lt,yt,vt,Rt);var Ut;return Br(lt)?Ut="":Br(yt)?Ut=">="+lt+".0.0 <"+(+lt+1)+".0.0":Br(vt)?lt==="0"?Ut=">="+lt+"."+yt+".0 <"+lt+"."+(+yt+1)+".0":Ut=">="+lt+"."+yt+".0 <"+(+lt+1)+".0.0":Rt?(f("replaceCaret pr",Rt),lt==="0"?yt==="0"?Ut=">="+lt+"."+yt+"."+vt+"-"+Rt+" <"+lt+"."+yt+"."+(+vt+1):Ut=">="+lt+"."+yt+"."+vt+"-"+Rt+" <"+lt+"."+(+yt+1)+".0":Ut=">="+lt+"."+yt+"."+vt+"-"+Rt+" <"+(+lt+1)+".0.0"):(f("no pr"),lt==="0"?yt==="0"?Ut=">="+lt+"."+yt+"."+vt+" <"+lt+"."+yt+"."+(+vt+1):Ut=">="+lt+"."+yt+"."+vt+" <"+lt+"."+(+yt+1)+".0":Ut=">="+lt+"."+yt+"."+vt+" <"+(+lt+1)+".0.0"),f("caret return",Ut),Ut})}a(ws,"uy");function Hr(ee,me){return f("replaceXRanges",ee,me),ee.split(/\s+/).map(function(Re){return bs(Re,me)}).join(" ")}a(Hr,"cy");function bs(ee,me){ee=ee.trim();var Re=me.loose?u[Bt]:u[Vt];return ee.replace(Re,function(rt,lt,yt,vt,Rt,Ut){f("xRange",ee,rt,lt,yt,vt,Rt,Ut);var ln=Br(yt),qr=ln||Br(vt),Qr=qr||Br(Rt),Yr=Qr;return lt==="="&&Yr&&(lt=""),ln?lt===">"||lt==="<"?rt="<0.0.0":rt="*":lt&&Yr?(qr&&(vt=0),Rt=0,lt===">"?(lt=">=",qr?(yt=+yt+1,vt=0,Rt=0):(vt=+vt+1,Rt=0)):lt==="<="&&(lt="<",qr?yt=+yt+1:vt=+vt+1),rt=lt+yt+"."+vt+"."+Rt):qr?rt=">="+yt+".0.0 <"+(+yt+1)+".0.0":Qr&&(rt=">="+yt+"."+vt+".0 <"+yt+"."+(+vt+1)+".0"),f("xRange return",rt),rt})}a(bs,"ly");function Dr(ee,me){return f("replaceStars",ee,me),ee.trim().replace(u[At],"")}a(Dr,"py");function Ec(ee,me,Re,rt,lt,yt,vt,Rt,Ut,ln,qr,Qr,Yr){return Br(Re)?me="":Br(rt)?me=">="+Re+".0.0":Br(lt)?me=">="+Re+"."+rt+".0":me=">="+me,Br(Ut)?Rt="":Br(ln)?Rt="<"+(+Ut+1)+".0.0":Br(qr)?Rt="<"+Ut+"."+(+ln+1)+".0":Qr?Rt="<="+Ut+"."+ln+"."+qr+"-"+Qr:Rt="<="+Rt,(me+" "+Rt).trim()}a(Ec,"fy"),sr.prototype.test=function(ee){if(!ee)return!1;typeof ee=="string"&&(ee=new Kt(ee,this.options));for(var me=0;me<this.set.length;me++)if(zn(this.set[me],ee,this.options))return!0;return!1};function zn(ee,me,Re){for(var rt=0;rt<ee.length;rt++)if(!ee[rt].test(me))return!1;if(me.prerelease.length&&!Re.includePrerelease){for(rt=0;rt<ee.length;rt++)if(f(ee[rt].semver),ee[rt].semver!==bt&&ee[rt].semver.prerelease.length>0){var lt=ee[rt].semver;if(lt.major===me.major&&lt.minor===me.minor&&lt.patch===me.patch)return!0}return!1}return!0}a(zn,"dy"),s.satisfies=uo;function uo(ee,me,Re){try{me=new sr(me,Re)}catch(rt){return!1}return me.test(ee)}a(uo,"Ji"),s.maxSatisfying=Ss;function Ss(ee,me,Re){var rt=null,lt=null;try{var yt=new sr(me,Re)}catch(vt){return null}return ee.forEach(function(vt){yt.test(vt)&&(!rt||lt.compare(vt)===-1)&&(rt=vt,lt=new Kt(rt,Re))}),rt}a(Ss,"hy"),s.minSatisfying=xc;function xc(ee,me,Re){var rt=null,lt=null;try{var yt=new sr(me,Re)}catch(vt){return null}return ee.forEach(function(vt){yt.test(vt)&&(!rt||lt.compare(vt)===1)&&(rt=vt,lt=new Kt(rt,Re))}),rt}a(xc,"_y"),s.minVersion=ii;function ii(ee,me){ee=new sr(ee,me);var Re=new Kt("0.0.0");if(ee.test(Re)||(Re=new Kt("0.0.0-0"),ee.test(Re)))return Re;Re=null;for(var rt=0;rt<ee.set.length;++rt){var lt=ee.set[rt];lt.forEach(function(yt){var vt=new Kt(yt.semver.version);switch(yt.operator){case">":vt.prerelease.length===0?vt.patch++:vt.prerelease.push(0),vt.raw=vt.format();case"":case">=":(!Re||Ui(Re,vt))&&(Re=vt);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+yt.operator)}})}return Re&&ee.test(Re)?Re:null}a(ii,"gy"),s.validRange=Ai;function Ai(ee,me){try{return new sr(ee,me).range||"*"}catch(Re){return null}}a(Ai,"vy"),s.ltr=Ri;function Ri(ee,me,Re){return ho(ee,me,"<",Re)}a(Ri,"my"),s.gtr=Es;function Es(ee,me,Re){return ho(ee,me,">",Re)}a(Es,"Ey"),s.outside=ho;function ho(ee,me,Re,rt){ee=new Kt(ee,rt),me=new sr(me,rt);var lt,yt,vt,Rt,Ut;switch(Re){case">":lt=Ui,yt=vn,vt=Ti,Rt=">",Ut=">=";break;case"<":lt=Ti,yt=Uo,vt=Ui,Rt="<",Ut="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(uo(ee,me,rt))return!1;for(var ln=0;ln<me.set.length;++ln){var qr=me.set[ln],Qr=null,Yr=null;if(qr.forEach(function(_n){_n.semver===bt&&(_n=new yn(">=0.0.0")),Qr=Qr||_n,Yr=Yr||_n,lt(_n.semver,Qr.semver,rt)?Qr=_n:vt(_n.semver,Yr.semver,rt)&&(Yr=_n)}),Qr.operator===Rt||Qr.operator===Ut||(!Yr.operator||Yr.operator===Rt)&&yt(ee,Yr.semver)||Yr.operator===Ut&&vt(ee,Yr.semver))return!1}return!0}a(ho,"bo"),s.prerelease=oi;function oi(ee,me){var Re=jr(ee,me);return Re&&Re.prerelease.length?Re.prerelease:null}a(oi,"yy"),s.intersects=ai;function ai(ee,me,Re){return ee=new sr(ee,Re),me=new sr(me,Re),ee.intersects(me)}a(ai,"Ty"),s.coerce=xs;function xs(ee){if(ee instanceof Kt)return ee;if(typeof ee!="string")return null;var me=ee.match(u[Er]);return me==null?null:jr(me[1]+"."+(me[2]||"0")+"."+(me[3]||"0"))}a(xs,"Sy")}),be=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.makePatchingRequire=void 0;var T=K(1017),f=Ee(),w=K(8188),x=Object.keys(process.binding("natives")),p=w.prototype.require;function u(g){var v={};return function(_){var b=p.apply(this,arguments);if(g[_]){var y=w._resolveFilename(_,this);if(v.hasOwnProperty(y))return v[y];var E=void 0;if(x.indexOf(_)<0)try{E=p.call(this,T.join(_,"package.json")).version}catch(G){return b}else E=process.version.substring(1);var C=E.indexOf("-");C>=0&&(E=E.substring(0,C));for(var A=b,R=0,D=g[_];R<D.length;R++){var k=D[R];f.satisfies(E,k.versionSpecifier)&&(A=k.patch(A,y))}return v[y]=A}return b}}a(u,"Cy"),s.makePatchingRequire=u}),L=F((s,T)=>{T.exports={name:"diagnostic-channel",version:"1.0.0",main:"./dist/src/channel.js",types:"./dist/src/channel.d.ts",scripts:{build:"tsc",lint:"tslint -c tslint.json -p tsconfig.json",clean:"rimraf ./dist",test:"mocha ./dist/tests/**/*.js"},homepage:"https://github.com/Microsoft/node-diagnostic-channel",bugs:{url:"https://github.com/Microsoft/node-diagnostic-channel/issues"},repository:{type:"git",url:"https://github.com/Microsoft/node-diagnostic-channel.git"},description:"Provides a context-saving pub/sub channel to connect diagnostic event publishers and subscribers",dependencies:{semver:"^5.3.0"},devDependencies:{"@types/mocha":"^2.2.40","@types/node":"~8.0.0",mocha:"^3.2.0",rimraf:"^2.6.1",tslint:"^5.0.0",typescript:"4.1.2"},files:["dist/src/**/*.d.ts","dist/src/**/*.js","LICENSE","README.md","package.json"],license:"MIT"}}),he=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.channel=s.makePatchingRequire=void 0;var T=be(),f=be();Object.defineProperty(s,"makePatchingRequire",{enumerable:!0,get:function(){return f.makePatchingRequire}});var w=a(function(u){return!0},"Bl"),x=function(){function u(){this.version=L().version,this.subscribers={},this.contextPreservationFunction=function(g){return g},this.knownPatches={},this.currentlyPublishing=!1}return a(u,"e"),u.prototype.shouldPublish=function(g){var v=this.subscribers[g];return v?v.some(function(_){var b=_.filter;return!b||b(!1)}):!1},u.prototype.publish=function(g,v){if(!this.currentlyPublishing){var _=this.subscribers[g];if(_){var b={timestamp:Date.now(),data:v};this.currentlyPublishing=!0,_.forEach(function(y){var E=y.listener,C=y.filter;try{C&&C(!0)&&E(b)}catch(A){}}),this.currentlyPublishing=!1}}},u.prototype.subscribe=function(g,v,_){_===void 0&&(_=w),this.subscribers[g]||(this.subscribers[g]=[]),this.subscribers[g].push({listener:v,filter:_})},u.prototype.unsubscribe=function(g,v,_){_===void 0&&(_=w);var b=this.subscribers[g];if(b){for(var y=0;y<b.length;++y)if(b[y].listener===v&&b[y].filter===_)return b.splice(y,1),!0}return!1},u.prototype.reset=function(){var g=this;this.subscribers={},this.contextPreservationFunction=function(v){return v},Object.getOwnPropertyNames(this.knownPatches).forEach(function(v){return delete g.knownPatches[v]})},u.prototype.bindToContext=function(g){return this.contextPreservationFunction(g)},u.prototype.addContextPreservation=function(g){var v=this.contextPreservationFunction;this.contextPreservationFunction=function(_){return g(v(_))}},u.prototype.registerMonkeyPatch=function(g,v){this.knownPatches[g]||(this.knownPatches[g]=[]),this.knownPatches[g].push(v)},u.prototype.getPatchesObject=function(){return this.knownPatches},u}();global.diagnosticsSource||(global.diagnosticsSource=new x,p=K(8188),p.prototype.require=T.makePatchingRequire(global.diagnosticsSource.getPatchesObject()));var p;s.channel=global.diagnosticsSource}),te=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),Te=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.BaggageImpl=void 0;var T=function(){function f(w){this._entries=w?new Map(w):new Map}return a(f,"e"),f.prototype.getEntry=function(w){var x=this._entries.get(w);if(x)return Object.assign({},x)},f.prototype.getAllEntries=function(){return Array.from(this._entries.entries()).map(function(w){var x=w[0],p=w[1];return[x,p]})},f.prototype.setEntry=function(w,x){var p=new f(this._entries);return p._entries.set(w,x),p},f.prototype.removeEntry=function(w){var x=new f(this._entries);return x._entries.delete(w),x},f.prototype.removeEntries=function(){for(var w=[],x=0;x<arguments.length;x++)w[x]=arguments[x];for(var p=new f(this._entries),u=0,g=w;u<g.length;u++){var v=g[u];p._entries.delete(v)}return p},f.prototype.clear=function(){return new f},f}();s.BaggageImpl=T}),le=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.baggageEntryMetadataSymbol=void 0,s.baggageEntryMetadataSymbol=Symbol("BaggageEntryMetadata")}),de=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.baggageEntryMetadataFromString=s.createBaggage=void 0;var T=ir(),f=Te(),w=le();function x(u){return u===void 0&&(u={}),new f.BaggageImpl(new Map(Object.entries(u)))}a(x,"Ly"),s.createBaggage=x;function p(u){return typeof u!="string"&&(T.diag.error("Cannot create baggage metadata from unknown type: "+typeof u),u=""),{__TYPE__:w.baggageEntryMetadataSymbol,toString:function(){return u}}}a(p,"qy"),s.baggageEntryMetadataFromString=p}),Ce=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),Fe=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),We=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.DiagConsoleLogger=void 0;var T=[{n:"error",c:"error"},{n:"warn",c:"warn"},{n:"info",c:"info"},{n:"debug",c:"debug"},{n:"verbose",c:"trace"}],f=function(){function w(){function x(u){return function(){var g=arguments;if(console){var v=console[u];if(typeof v!="function"&&(v=console.log),typeof v=="function")return v.apply(console,g)}}}a(x,"t");for(var p=0;p<T.length;p++)this[T[p].n]=x(T[p].c)}return a(w,"e"),w}();s.DiagConsoleLogger=f}),et=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.DiagLogLevel=void 0;var T;(function(f){f[f.NONE=0]="NONE",f[f.ERROR=30]="ERROR",f[f.WARN=50]="WARN",f[f.INFO=60]="INFO",f[f.DEBUG=70]="DEBUG",f[f.VERBOSE=80]="VERBOSE",f[f.ALL=9999]="ALL"})(T=s.DiagLogLevel||(s.DiagLogLevel={}))}),ve=F(s=>{"use strict";var T=s&&s.__createBinding||(Object.create?function(w,x,p,u){u===void 0&&(u=p),Object.defineProperty(w,u,{enumerable:!0,get:function(){return x[p]}})}:function(w,x,p,u){u===void 0&&(u=p),w[u]=x[p]}),f=s&&s.__exportStar||function(w,x){for(var p in w)p!=="default"&&!Object.prototype.hasOwnProperty.call(x,p)&&T(x,w,p)};Object.defineProperty(s,"__esModule",{value:!0}),f(We(),s),f(et(),s)}),Ue=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.defaultTextMapSetter=s.defaultTextMapGetter=void 0,s.defaultTextMapGetter={get:function(T,f){if(T!=null)return T[f]},keys:function(T){return T==null?[]:Object.keys(T)}},s.defaultTextMapSetter={set:function(T,f,w){T!=null&&(T[f]=w)}}}),Xe=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),Ke=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),Ne=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.ROOT_CONTEXT=s.createContextKey=void 0;function T(w){return Symbol.for(w)}a(T,"Uy"),s.createContextKey=T;var f=function(){function w(x){var p=this;p._currentContext=x?new Map(x):new Map,p.getValue=function(u){return p._currentContext.get(u)},p.setValue=function(u,g){var v=new w(p._currentContext);return v._currentContext.set(u,g),v},p.deleteValue=function(u){var g=new w(p._currentContext);return g._currentContext.delete(u),g}}return a(w,"e"),w}();s.ROOT_CONTEXT=new f}),Pe=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.TraceFlags=void 0;var T;(function(f){f[f.NONE=0]="NONE",f[f.SAMPLED=1]="SAMPLED"})(T=s.TraceFlags||(s.TraceFlags={}))}),pt=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.wrapSpanContext=s.isSpanContextValid=s.isValidSpanId=s.isValidTraceId=s.INVALID_SPAN_CONTEXT=s.INVALID_TRACEID=s.INVALID_SPANID=void 0;var T=It(),f=Pe(),w=/^([0-9a-f]{32})$/i,x=/^[0-9a-f]{16}$/i;s.INVALID_SPANID="0000000000000000",s.INVALID_TRACEID="00000000000000000000000000000000",s.INVALID_SPAN_CONTEXT={traceId:s.INVALID_TRACEID,spanId:s.INVALID_SPANID,traceFlags:f.TraceFlags.NONE};function p(_){return w.test(_)&&_!==s.INVALID_TRACEID}a(p,"ip"),s.isValidTraceId=p;function u(_){return x.test(_)&&_!==s.INVALID_SPANID}a(u,"ap"),s.isValidSpanId=u;function g(_){return p(_.traceId)&&u(_.spanId)}a(g,"Ky"),s.isSpanContextValid=g;function v(_){return new T.NonRecordingSpan(_)}a(v,"Xy"),s.wrapSpanContext=v}),It=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.NonRecordingSpan=void 0;var T=pt(),f=function(){function w(x){x===void 0&&(x=T.INVALID_SPAN_CONTEXT),this._spanContext=x}return a(w,"e"),w.prototype.spanContext=function(){return this._spanContext},w.prototype.setAttribute=function(x,p){return this},w.prototype.setAttributes=function(x){return this},w.prototype.addEvent=function(x,p){return this},w.prototype.setStatus=function(x){return this},w.prototype.updateName=function(x){return this},w.prototype.end=function(x){},w.prototype.isRecording=function(){return!1},w.prototype.recordException=function(x,p){},w}();s.NonRecordingSpan=f}),xe=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.getSpanContext=s.setSpanContext=s.deleteSpan=s.setSpan=s.getSpan=void 0;var T=Ne(),f=It(),w=T.createContextKey("OpenTelemetry Context Key SPAN");function x(_){return _.getValue(w)||void 0}a(x,"sp"),s.getSpan=x;function p(_,b){return _.setValue(w,b)}a(p,"op"),s.setSpan=p;function u(_){return _.deleteValue(w)}a(u,"Jy"),s.deleteSpan=u;function g(_,b){return p(_,new f.NonRecordingSpan(b))}a(g,"eT"),s.setSpanContext=g;function v(_){var b;return(b=x(_))===null||b===void 0?void 0:b.spanContext()}a(v,"tT"),s.getSpanContext=v}),Pt=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.NoopTracer=void 0;var T=ir(),f=xe(),w=It(),x=pt(),p=function(){function g(){}return a(g,"e"),g.prototype.startSpan=function(v,_,b){var y=Boolean(_==null?void 0:_.root);if(y)return new w.NonRecordingSpan;var E=b&&f.getSpanContext(b);return u(E)&&x.isSpanContextValid(E)?new w.NonRecordingSpan(E):new w.NonRecordingSpan},g.prototype.startActiveSpan=function(v,_,b,y){var E,C,A;if(!(arguments.length<2)){arguments.length===2?A=_:arguments.length===3?(E=_,A=b):(E=_,C=b,A=y);var R=C!=null?C:T.context.active(),D=this.startSpan(v,E,R),k=f.setSpan(R,D);return T.context.with(k,A,void 0,D)}},g}();s.NoopTracer=p;function u(g){return typeof g=="object"&&typeof g.spanId=="string"&&typeof g.traceId=="string"&&typeof g.traceFlags=="number"}a(u,"iT")}),ht=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.ProxyTracer=void 0;var T=Pt(),f=function(){function w(x,p,u){this._provider=x,this.name=p,this.version=u}return a(w,"e"),w.prototype.startSpan=function(x,p,u){return this._getTracer().startSpan(x,p,u)},w.prototype.startActiveSpan=function(x,p,u,g){var v=this._getTracer();return Reflect.apply(v.startActiveSpan,v,arguments)},w.prototype._getTracer=function(){if(this._delegate)return this._delegate;var x=this._provider.getDelegateTracer(this.name,this.version);return x?(this._delegate=x,this._delegate):new T.NoopTracer},w}();s.ProxyTracer=f}),Ot=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.NoopTracerProvider=void 0;var T=Pt(),f=function(){function w(){}return a(w,"e"),w.prototype.getTracer=function(x,p){return new T.NoopTracer},w}();s.NoopTracerProvider=f}),Be=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.ProxyTracerProvider=void 0;var T=ht(),f=Ot(),w=new f.NoopTracerProvider,x=function(){function p(){}return a(p,"e"),p.prototype.getTracer=function(u,g){var v;return(v=this.getDelegateTracer(u,g))!==null&&v!==void 0?v:new T.ProxyTracer(this,u,g)},p.prototype.getDelegate=function(){var u;return(u=this._delegate)!==null&&u!==void 0?u:w},p.prototype.setDelegate=function(u){this._delegate=u},p.prototype.getDelegateTracer=function(u,g){var v;return(v=this._delegate)===null||v===void 0?void 0:v.getTracer(u,g)},p}();s.ProxyTracerProvider=x}),Le=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),_t=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.SamplingDecision=void 0;var T;(function(f){f[f.NOT_RECORD=0]="NOT_RECORD",f[f.RECORD=1]="RECORD",f[f.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"})(T=s.SamplingDecision||(s.SamplingDecision={}))}),xt=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),qt=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.SpanKind=void 0;var T;(function(f){f[f.INTERNAL=0]="INTERNAL",f[f.SERVER=1]="SERVER",f[f.CLIENT=2]="CLIENT",f[f.PRODUCER=3]="PRODUCER",f[f.CONSUMER=4]="CONSUMER"})(T=s.SpanKind||(s.SpanKind={}))}),vr=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),Gt=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),lr=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.SpanStatusCode=void 0;var T;(function(f){f[f.UNSET=0]="UNSET",f[f.OK=1]="OK",f[f.ERROR=2]="ERROR"})(T=s.SpanStatusCode||(s.SpanStatusCode={}))}),Nr=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),rn=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),Ir=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),wt=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),tt=F(s=>{"use strict";var T=s&&s.__spreadArray||function(x,p){for(var u=0,g=p.length,v=x.length;u<g;u++,v++)x[v]=p[u];return x};Object.defineProperty(s,"__esModule",{value:!0}),s.NoopContextManager=void 0;var f=Ne(),w=function(){function x(){}return a(x,"e"),x.prototype.active=function(){return f.ROOT_CONTEXT},x.prototype.with=function(p,u,g){for(var v=[],_=3;_<arguments.length;_++)v[_-3]=arguments[_];return u.call.apply(u,T([g],v))},x.prototype.bind=function(p,u){return u},x.prototype.enable=function(){return this},x.prototype.disable=function(){return this},x}();s.NoopContextManager=w}),Mi=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s._globalThis=void 0,s._globalThis=typeof globalThis=="object"?globalThis:global}),nt=F(s=>{"use strict";var T=s&&s.__createBinding||(Object.create?function(w,x,p,u){u===void 0&&(u=p),Object.defineProperty(w,u,{enumerable:!0,get:function(){return x[p]}})}:function(w,x,p,u){u===void 0&&(u=p),w[u]=x[p]}),f=s&&s.__exportStar||function(w,x){for(var p in w)p!=="default"&&!Object.prototype.hasOwnProperty.call(x,p)&&T(x,w,p)};Object.defineProperty(s,"__esModule",{value:!0}),f(Mi(),s)}),Lt=F(s=>{"use strict";var T=s&&s.__createBinding||(Object.create?function(w,x,p,u){u===void 0&&(u=p),Object.defineProperty(w,u,{enumerable:!0,get:function(){return x[p]}})}:function(w,x,p,u){u===void 0&&(u=p),w[u]=x[p]}),f=s&&s.__exportStar||function(w,x){for(var p in w)p!=="default"&&!Object.prototype.hasOwnProperty.call(x,p)&&T(x,w,p)};Object.defineProperty(s,"__esModule",{value:!0}),f(nt(),s)}),it=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.VERSION=void 0,s.VERSION="1.0.1"}),ft=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.isCompatible=s._makeCompatibilityCheck=void 0;var T=it(),f=/^(\d+)\.(\d+)\.(\d+)(?:-(.*))?$/;function w(x){var p=new Set([x]),u=new Set,g=x.match(f);if(!g)return function(){return!1};var v={major:+g[1],minor:+g[2],patch:+g[3]};function _(y){return u.add(y),!1}a(_,"a");function b(y){return p.add(y),!0}return a(b,"s"),function(y){if(p.has(y))return!0;if(u.has(y))return!1;var E=y.match(f);if(!E)return _(y);var C={major:+E[1],minor:+E[2],patch:+E[3]};return v.major!==C.major?_(y):v.major===0?v.minor===C.minor&&v.patch<=C.patch?b(y):_(y):v.minor<=C.minor?b(y):_(y)}}a(w,"Lp"),s._makeCompatibilityCheck=w,s.isCompatible=w(T.VERSION)}),Zt=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.unregisterGlobal=s.getGlobal=s.registerGlobal=void 0;var T=Lt(),f=it(),w=ft(),x=f.VERSION.split(".")[0],p=Symbol.for("opentelemetry.js.api."+x),u=T._globalThis;function g(b,y,E,C){var A;C===void 0&&(C=!1);var R=u[p]=(A=u[p])!==null&&A!==void 0?A:{version:f.VERSION};if(!C&&R[b]){var D=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+b);return E.error(D.stack||D.message),!1}if(R.version!==f.VERSION){var D=new Error("@opentelemetry/api: All API registration versions must match");return E.error(D.stack||D.message),!1}return R[b]=y,E.debug("@opentelemetry/api: Registered a global for "+b+" v"+f.VERSION+"."),!0}a(g,"OT"),s.registerGlobal=g;function v(b){var y,E,C=(y=u[p])===null||y===void 0?void 0:y.version;if(!(!C||!w.isCompatible(C)))return(E=u[p])===null||E===void 0?void 0:E[b]}a(v,"PT"),s.getGlobal=v;function _(b,y){y.debug("@opentelemetry/api: Unregistering a global for "+b+" v"+f.VERSION+".");var E=u[p];E&&delete E[b]}a(_,"RT"),s.unregisterGlobal=_}),er=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.DiagComponentLogger=void 0;var T=Zt(),f=function(){function x(p){this._namespace=p.namespace||"DiagComponentLogger"}return a(x,"e"),x.prototype.debug=function(){for(var p=[],u=0;u<arguments.length;u++)p[u]=arguments[u];return w("debug",this._namespace,p)},x.prototype.error=function(){for(var p=[],u=0;u<arguments.length;u++)p[u]=arguments[u];return w("error",this._namespace,p)},x.prototype.info=function(){for(var p=[],u=0;u<arguments.length;u++)p[u]=arguments[u];return w("info",this._namespace,p)},x.prototype.warn=function(){for(var p=[],u=0;u<arguments.length;u++)p[u]=arguments[u];return w("warn",this._namespace,p)},x.prototype.verbose=function(){for(var p=[],u=0;u<arguments.length;u++)p[u]=arguments[u];return w("verbose",this._namespace,p)},x}();s.DiagComponentLogger=f;function w(x,p,u){var g=T.getGlobal("diag");if(g)return u.unshift(p),g[x].apply(g,u)}a(w,"ei")}),Jt=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.createLogLevelDiagLogger=void 0;var T=et();function f(w,x){w<T.DiagLogLevel.NONE?w=T.DiagLogLevel.NONE:w>T.DiagLogLevel.ALL&&(w=T.DiagLogLevel.ALL),x=x||{};function p(u,g){var v=x[u];return typeof v=="function"&&w>=g?v.bind(x):function(){}}return a(p,"r"),{error:p("error",T.DiagLogLevel.ERROR),warn:p("warn",T.DiagLogLevel.WARN),info:p("info",T.DiagLogLevel.INFO),debug:p("debug",T.DiagLogLevel.DEBUG),verbose:p("verbose",T.DiagLogLevel.VERBOSE)}}a(f,"wT"),s.createLogLevelDiagLogger=f}),wn=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.DiagAPI=void 0;var T=er(),f=Jt(),w=et(),x=Zt(),p="diag",u=function(){function g(){function v(b){return function(){var y=x.getGlobal("diag");if(y)return y[b].apply(y,arguments)}}a(v,"t");var _=this;_.setLogger=function(b,y){var E,C;if(y===void 0&&(y=w.DiagLogLevel.INFO),b===_){var A=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return _.error((E=A.stack)!==null&&E!==void 0?E:A.message),!1}var R=x.getGlobal("diag"),D=f.createLogLevelDiagLogger(y,b);if(R){var k=(C=new Error().stack)!==null&&C!==void 0?C:"<failed to generate stacktrace>";R.warn("Current logger will be overwritten from "+k),D.warn("Current logger will overwrite one already registered from "+k)}return x.registerGlobal("diag",D,_,!0)},_.disable=function(){x.unregisterGlobal(p,_)},_.createComponentLogger=function(b){return new T.DiagComponentLogger(b)},_.verbose=v("verbose"),_.debug=v("debug"),_.info=v("info"),_.warn=v("warn"),_.error=v("error")}return a(g,"e"),g.instance=function(){return this._instance||(this._instance=new g),this._instance},g}();s.DiagAPI=u}),pi=F(s=>{"use strict";var T=s&&s.__spreadArray||function(v,_){for(var b=0,y=_.length,E=v.length;b<y;b++,E++)v[E]=_[b];return v};Object.defineProperty(s,"__esModule",{value:!0}),s.ContextAPI=void 0;var f=tt(),w=Zt(),x=wn(),p="context",u=new f.NoopContextManager,g=function(){function v(){}return a(v,"e"),v.getInstance=function(){return this._instance||(this._instance=new v),this._instance},v.prototype.setGlobalContextManager=function(_){return w.registerGlobal(p,_,x.DiagAPI.instance())},v.prototype.active=function(){return this._getContextManager().active()},v.prototype.with=function(_,b,y){for(var E,C=[],A=3;A<arguments.length;A++)C[A-3]=arguments[A];return(E=this._getContextManager()).with.apply(E,T([_,b,y],C))},v.prototype.bind=function(_,b){return this._getContextManager().bind(_,b)},v.prototype._getContextManager=function(){return w.getGlobal(p)||u},v.prototype.disable=function(){this._getContextManager().disable(),w.unregisterGlobal(p,x.DiagAPI.instance())},v}();s.ContextAPI=g}),nn=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.TraceAPI=void 0;var T=Zt(),f=Be(),w=pt(),x=xe(),p=wn(),u="trace",g=function(){function v(){this._proxyTracerProvider=new f.ProxyTracerProvider,this.wrapSpanContext=w.wrapSpanContext,this.isSpanContextValid=w.isSpanContextValid,this.deleteSpan=x.deleteSpan,this.getSpan=x.getSpan,this.getSpanContext=x.getSpanContext,this.setSpan=x.setSpan,this.setSpanContext=x.setSpanContext}return a(v,"e"),v.getInstance=function(){return this._instance||(this._instance=new v),this._instance},v.prototype.setGlobalTracerProvider=function(_){return this._proxyTracerProvider.setDelegate(_),T.registerGlobal(u,this._proxyTracerProvider,p.DiagAPI.instance())},v.prototype.getTracerProvider=function(){return T.getGlobal(u)||this._proxyTracerProvider},v.prototype.getTracer=function(_,b){return this.getTracerProvider().getTracer(_,b)},v.prototype.disable=function(){T.unregisterGlobal(u,p.DiagAPI.instance()),this._proxyTracerProvider=new f.ProxyTracerProvider},v}();s.TraceAPI=g}),ja=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.NoopTextMapPropagator=void 0;var T=function(){function f(){}return a(f,"e"),f.prototype.inject=function(w,x){},f.prototype.extract=function(w,x){return w},f.prototype.fields=function(){return[]},f}();s.NoopTextMapPropagator=T}),qa=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.deleteBaggage=s.setBaggage=s.getBaggage=void 0;var T=Ne(),f=T.createContextKey("OpenTelemetry Baggage Key");function w(u){return u.getValue(f)||void 0}a(w,"$T"),s.getBaggage=w;function x(u,g){return u.setValue(f,g)}a(x,"zT"),s.setBaggage=x;function p(u){return u.deleteValue(f)}a(p,"KT"),s.deleteBaggage=p}),eo=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.PropagationAPI=void 0;var T=Zt(),f=ja(),w=Ue(),x=qa(),p=de(),u=wn(),g="propagation",v=new f.NoopTextMapPropagator,_=function(){function b(){this.createBaggage=p.createBaggage,this.getBaggage=x.getBaggage,this.setBaggage=x.setBaggage,this.deleteBaggage=x.deleteBaggage}return a(b,"e"),b.getInstance=function(){return this._instance||(this._instance=new b),this._instance},b.prototype.setGlobalPropagator=function(y){return T.registerGlobal(g,y,u.DiagAPI.instance())},b.prototype.inject=function(y,E,C){return C===void 0&&(C=w.defaultTextMapSetter),this._getGlobalPropagator().inject(y,E,C)},b.prototype.extract=function(y,E,C){return C===void 0&&(C=w.defaultTextMapGetter),this._getGlobalPropagator().extract(y,E,C)},b.prototype.fields=function(){return this._getGlobalPropagator().fields()},b.prototype.disable=function(){T.unregisterGlobal(g,u.DiagAPI.instance())},b.prototype._getGlobalPropagator=function(){return T.getGlobal(g)||v},b}();s.PropagationAPI=_}),ir=F(s=>{"use strict";var T=s&&s.__createBinding||(Object.create?function(_,b,y,E){E===void 0&&(E=y),Object.defineProperty(_,E,{enumerable:!0,get:function(){return b[y]}})}:function(_,b,y,E){E===void 0&&(E=y),_[E]=b[y]}),f=s&&s.__exportStar||function(_,b){for(var y in _)y!=="default"&&!Object.prototype.hasOwnProperty.call(b,y)&&T(b,_,y)};Object.defineProperty(s,"__esModule",{value:!0}),s.diag=s.propagation=s.trace=s.context=s.isValidSpanId=s.isValidTraceId=s.isSpanContextValid=s.INVALID_SPAN_CONTEXT=s.INVALID_TRACEID=s.INVALID_SPANID=s.baggageEntryMetadataFromString=void 0,f(te(),s);var w=de();Object.defineProperty(s,"baggageEntryMetadataFromString",{enumerable:!0,get:function(){return w.baggageEntryMetadataFromString}}),f(Ce(),s),f(Fe(),s),f(ve(),s),f(Ue(),s),f(Xe(),s),f(Ke(),s),f(ht(),s),f(Be(),s),f(Le(),s),f(_t(),s),f(xt(),s),f(qt(),s),f(vr(),s),f(Gt(),s),f(lr(),s),f(Pe(),s),f(Nr(),s),f(rn(),s),f(Ir(),s);var x=pt();Object.defineProperty(s,"INVALID_SPANID",{enumerable:!0,get:function(){return x.INVALID_SPANID}}),Object.defineProperty(s,"INVALID_TRACEID",{enumerable:!0,get:function(){return x.INVALID_TRACEID}}),Object.defineProperty(s,"INVALID_SPAN_CONTEXT",{enumerable:!0,get:function(){return x.INVALID_SPAN_CONTEXT}}),Object.defineProperty(s,"isSpanContextValid",{enumerable:!0,get:function(){return x.isSpanContextValid}}),Object.defineProperty(s,"isValidTraceId",{enumerable:!0,get:function(){return x.isValidTraceId}}),Object.defineProperty(s,"isValidSpanId",{enumerable:!0,get:function(){return x.isValidSpanId}}),f(Ne(),s),f(wt(),s);var p=pi();s.context=p.ContextAPI.getInstance();var u=nn();s.trace=u.TraceAPI.getInstance();var g=eo();s.propagation=g.PropagationAPI.getInstance();var v=wn();s.diag=v.DiagAPI.instance(),s.default={trace:s.trace,context:s.context,propagation:s.propagation,diag:s.diag}}),Li=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.isTracingSuppressed=s.unsuppressTracing=s.suppressTracing=void 0;var T=ir(),f=T.createContextKey("OpenTelemetry SDK Context Key SUPPRESS_TRACING");function w(u){return u.setValue(f,!0)}a(w,"aS"),s.suppressTracing=w;function x(u){return u.deleteValue(f)}a(x,"sS"),s.unsuppressTracing=x;function p(u){return u.getValue(f)===!0}a(p,"oS"),s.isTracingSuppressed=p}),ia=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.BAGGAGE_MAX_TOTAL_LENGTH=s.BAGGAGE_MAX_PER_NAME_VALUE_PAIRS=s.BAGGAGE_MAX_NAME_VALUE_PAIRS=s.BAGGAGE_HEADER=s.BAGGAGE_ITEMS_SEPARATOR=s.BAGGAGE_PROPERTIES_SEPARATOR=s.BAGGAGE_KEY_PAIR_SEPARATOR=void 0,s.BAGGAGE_KEY_PAIR_SEPARATOR="=",s.BAGGAGE_PROPERTIES_SEPARATOR=";",s.BAGGAGE_ITEMS_SEPARATOR=",",s.BAGGAGE_HEADER="baggage",s.BAGGAGE_MAX_NAME_VALUE_PAIRS=180,s.BAGGAGE_MAX_PER_NAME_VALUE_PAIRS=4096,s.BAGGAGE_MAX_TOTAL_LENGTH=8192}),oa=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.parseKeyPairsIntoRecord=s.parsePairKeyValue=s.getKeyPairs=s.serializeKeyPairs=void 0;var T=ir(),f=ia(),w=a(g=>g.reduce((v,_)=>{let b=`${v}${v!==""?f.BAGGAGE_ITEMS_SEPARATOR:""}${_}`;return b.length>f.BAGGAGE_MAX_TOTAL_LENGTH?v:b},""),"cS");s.serializeKeyPairs=w;var x=a(g=>g.getAllEntries().map(([v,_])=>`${encodeURIComponent(v)}=${encodeURIComponent(_.value)}`),"lS");s.getKeyPairs=x;var p=a(g=>{let v=g.split(f.BAGGAGE_PROPERTIES_SEPARATOR);if(v.length<=0)return;let _=v.shift();if(!_)return;let b=_.split(f.BAGGAGE_KEY_PAIR_SEPARATOR);if(b.length!==2)return;let y=decodeURIComponent(b[0].trim()),E=decodeURIComponent(b[1].trim()),C;return v.length>0&&(C=T.baggageEntryMetadataFromString(v.join(f.BAGGAGE_PROPERTIES_SEPARATOR))),{key:y,value:E,metadata:C}},"pS");s.parsePairKeyValue=p;var u=a(g=>typeof g!="string"||g.length===0?{}:g.split(f.BAGGAGE_ITEMS_SEPARATOR).map(v=>s.parsePairKeyValue(v)).filter(v=>v!==void 0&&v.value.length>0).reduce((v,_)=>(v[_.key]=_.value,v),{}),"fS");s.parseKeyPairsIntoRecord=u}),Qs=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.HttpBaggagePropagator=void 0;var T=ir(),f=Li(),w=ia(),x=oa(),p=a(class{inject(u,g,v){let _=T.propagation.getBaggage(u);if(!_||f.isTracingSuppressed(u))return;let b=x.getKeyPairs(_).filter(E=>E.length<=w.BAGGAGE_MAX_PER_NAME_VALUE_PAIRS).slice(0,w.BAGGAGE_MAX_NAME_VALUE_PAIRS),y=x.serializeKeyPairs(b);y.length>0&&v.set(g,w.BAGGAGE_HEADER,y)}extract(u,g,v){let _=v.get(g,w.BAGGAGE_HEADER);if(!_)return u;let b={};return _.length===0||(_.split(w.BAGGAGE_ITEMS_SEPARATOR).forEach(y=>{let E=x.parsePairKeyValue(y);if(E){let C={value:E.value};E.metadata&&(C.metadata=E.metadata),b[E.key]=C}}),Object.entries(b).length===0)?u:T.propagation.setBaggage(u,T.propagation.createBaggage(b))}fields(){return[w.BAGGAGE_HEADER]}},"Qp");s.HttpBaggagePropagator=p}),Mr=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.isAttributeValue=s.sanitizeAttributes=void 0;function T(p){let u={};if(p==null||typeof p!="object")return u;for(let[g,v]of Object.entries(p))f(v)&&(Array.isArray(v)?u[g]=v.slice():u[g]=v);return u}a(T,"hS"),s.sanitizeAttributes=T;function f(p){return p==null?!0:Array.isArray(p)?w(p):x(p)}a(f,"Zp"),s.isAttributeValue=f;function w(p){let u;for(let g of p)if(g!=null){if(!u){if(x(g)){u=typeof g;continue}return!1}if(typeof g!==u)return!1}return!0}a(w,"_S");function x(p){switch(typeof p){case"number":return!0;case"boolean":return!0;case"string":return!0}return!1}a(x,"Jp")}),gi=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.loggingErrorHandler=void 0;var T=ir();function f(){return p=>{T.diag.error(w(p))}}a(f,"vS"),s.loggingErrorHandler=f;function w(p){return typeof p=="string"?p:JSON.stringify(x(p))}a(w,"mS");function x(p){let u={},g=p;for(;g!==null;)Object.getOwnPropertyNames(g).forEach(v=>{if(u[v])return;let _=g[v];_&&(u[v]=String(_))}),g=Object.getPrototypeOf(g);return u}a(x,"ES")}),So=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.globalErrorHandler=s.setGlobalErrorHandler=void 0;var T=gi(),f=T.loggingErrorHandler();function w(p){f=p}a(w,"TS"),s.setGlobalErrorHandler=w;var x=a(p=>{try{f(p)}catch(u){}},"SS");s.globalErrorHandler=x}),za=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.TracesSamplerValues=void 0;var T;(function(f){f.AlwaysOff="always_off",f.AlwaysOn="always_on",f.ParentBasedAlwaysOff="parentbased_always_off",f.ParentBasedAlwaysOn="parentbased_always_on",f.ParentBasedTraceIdRatio="parentbased_traceidratio",f.TraceIdRatio="traceidratio"})(T=s.TracesSamplerValues||(s.TracesSamplerValues={}))}),Tn=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.parseEnvironment=s.DEFAULT_ENVIRONMENT=void 0;var T=ir(),f=za(),w=",",x=["OTEL_BSP_EXPORT_TIMEOUT","OTEL_BSP_MAX_EXPORT_BATCH_SIZE","OTEL_BSP_MAX_QUEUE_SIZE","OTEL_BSP_SCHEDULE_DELAY","OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_EVENT_COUNT_LIMIT","OTEL_SPAN_LINK_COUNT_LIMIT"];function p(C){return x.indexOf(C)>-1}a(p,"OS");var u=["OTEL_NO_PATCH_MODULES","OTEL_PROPAGATORS"];function g(C){return u.indexOf(C)>-1}a(g,"RS"),s.DEFAULT_ENVIRONMENT={CONTAINER_NAME:"",ECS_CONTAINER_METADATA_URI_V4:"",ECS_CONTAINER_METADATA_URI:"",HOSTNAME:"",KUBERNETES_SERVICE_HOST:"",NAMESPACE:"",OTEL_BSP_EXPORT_TIMEOUT:3e4,OTEL_BSP_MAX_EXPORT_BATCH_SIZE:512,OTEL_BSP_MAX_QUEUE_SIZE:2048,OTEL_BSP_SCHEDULE_DELAY:5e3,OTEL_EXPORTER_JAEGER_AGENT_HOST:"",OTEL_EXPORTER_JAEGER_ENDPOINT:"",OTEL_EXPORTER_JAEGER_PASSWORD:"",OTEL_EXPORTER_JAEGER_USER:"",OTEL_EXPORTER_OTLP_ENDPOINT:"",OTEL_EXPORTER_OTLP_TRACES_ENDPOINT:"",OTEL_EXPORTER_OTLP_METRICS_ENDPOINT:"",OTEL_EXPORTER_OTLP_HEADERS:"",OTEL_EXPORTER_OTLP_TRACES_HEADERS:"",OTEL_EXPORTER_OTLP_METRICS_HEADERS:"",OTEL_EXPORTER_ZIPKIN_ENDPOINT:"http://localhost:9411/api/v2/spans",OTEL_LOG_LEVEL:T.DiagLogLevel.INFO,OTEL_NO_PATCH_MODULES:[],OTEL_PROPAGATORS:["tracecontext","baggage"],OTEL_RESOURCE_ATTRIBUTES:"",OTEL_SERVICE_NAME:"",OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT:128,OTEL_SPAN_EVENT_COUNT_LIMIT:128,OTEL_SPAN_LINK_COUNT_LIMIT:128,OTEL_TRACES_EXPORTER:"none",OTEL_TRACES_SAMPLER:f.TracesSamplerValues.ParentBasedAlwaysOn,OTEL_TRACES_SAMPLER_ARG:""};function v(C,A,R,D=-1/0,k=1/0){if(typeof R[C]!="undefined"){let G=Number(R[C]);isNaN(G)||(G<D?A[C]=D:G>k?A[C]=k:A[C]=G)}}a(v,"NS");function _(C,A,R,D=w){let k=R[C];typeof k=="string"&&(A[C]=k.split(D).map(G=>G.trim()))}a(_,"DS");var b={ALL:T.DiagLogLevel.ALL,VERBOSE:T.DiagLogLevel.VERBOSE,DEBUG:T.DiagLogLevel.DEBUG,INFO:T.DiagLogLevel.INFO,WARN:T.DiagLogLevel.WARN,ERROR:T.DiagLogLevel.ERROR,NONE:T.DiagLogLevel.NONE};function y(C,A,R){let D=R[C];if(typeof D=="string"){let k=b[D.toUpperCase()];k!=null&&(A[C]=k)}}a(y,"MS");function E(C){let A={};for(let R in s.DEFAULT_ENVIRONMENT){let D=R;switch(D){case"OTEL_LOG_LEVEL":y(D,A,C);break;default:if(p(D))v(D,A,C);else if(g(D))_(D,A,C);else{let k=C[D];typeof k!="undefined"&&k!==null&&(A[D]=String(k))}}}return A}a(E,"xS"),s.parseEnvironment=E}),ut=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.getEnv=void 0;var T=K(2037),f=Tn();function w(){let x=f.parseEnvironment(process.env);return Object.assign({HOSTNAME:T.hostname()},f.DEFAULT_ENVIRONMENT,x)}a(w,"qS"),s.getEnv=w}),$i=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.hexToBase64=void 0;function T(f){let w=f.length,x="";for(let p=0;p<w;p+=2){let u=f.substring(p,p+2),g=parseInt(u,16);x+=String.fromCharCode(g)}return Buffer.from(x,"ascii").toString("base64")}a(T,"kS"),s.hexToBase64=T}),to=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.RandomIdGenerator=void 0;var T=8,f=16,w=a(class{constructor(){this.generateTraceId=p(f),this.generateSpanId=p(T)}},"of");s.RandomIdGenerator=w;var x=Buffer.allocUnsafe(f);function p(u){return function(){for(let g=0;g<u/4;g++)x.writeUInt32BE(Math.random()*2**32>>>0,g*4);for(let g=0;g<u&&!(x[g]>0);g++)g===u-1&&(x[u-1]=1);return x.toString("hex",0,u)}}a(p,"uf")}),Eo=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.otperformance=void 0;var T=K(4074);s.otperformance=T.performance}),Fi=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.VERSION=void 0,s.VERSION="0.23.0"}),Ys=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.RpcGrpcStatusCodeValues=s.MessagingOperationValues=s.MessagingDestinationKindValues=s.HttpFlavorValues=s.NetTransportValues=s.FaasInvokedProviderValues=s.FaasDocumentOperationValues=s.FaasTriggerValues=s.DbCassandraConsistencyLevelValues=s.DbSystemValues=s.SemanticAttributes=void 0,s.SemanticAttributes={DB_SYSTEM:"db.system",DB_CONNECTION_STRING:"db.connection_string",DB_USER:"db.user",DB_JDBC_DRIVER_CLASSNAME:"db.jdbc.driver_classname",DB_NAME:"db.name",DB_STATEMENT:"db.statement",DB_OPERATION:"db.operation",DB_MSSQL_INSTANCE_NAME:"db.mssql.instance_name",DB_CASSANDRA_KEYSPACE:"db.cassandra.keyspace",DB_CASSANDRA_PAGE_SIZE:"db.cassandra.page_size",DB_CASSANDRA_CONSISTENCY_LEVEL:"db.cassandra.consistency_level",DB_CASSANDRA_TABLE:"db.cassandra.table",DB_CASSANDRA_IDEMPOTENCE:"db.cassandra.idempotence",DB_CASSANDRA_SPECULATIVE_EXECUTION_COUNT:"db.cassandra.speculative_execution_count",DB_CASSANDRA_COORDINATOR_ID:"db.cassandra.coordinator.id",DB_CASSANDRA_COORDINATOR_DC:"db.cassandra.coordinator.dc",DB_HBASE_NAMESPACE:"db.hbase.namespace",DB_REDIS_DATABASE_INDEX:"db.redis.database_index",DB_MONGODB_COLLECTION:"db.mongodb.collection",DB_SQL_TABLE:"db.sql.table",EXCEPTION_TYPE:"exception.type",EXCEPTION_MESSAGE:"exception.message",EXCEPTION_STACKTRACE:"exception.stacktrace",EXCEPTION_ESCAPED:"exception.escaped",FAAS_TRIGGER:"faas.trigger",FAAS_EXECUTION:"faas.execution",FAAS_DOCUMENT_COLLECTION:"faas.document.collection",FAAS_DOCUMENT_OPERATION:"faas.document.operation",FAAS_DOCUMENT_TIME:"faas.document.time",FAAS_DOCUMENT_NAME:"faas.document.name",FAAS_TIME:"faas.time",FAAS_CRON:"faas.cron",FAAS_COLDSTART:"faas.coldstart",FAAS_INVOKED_NAME:"faas.invoked_name",FAAS_INVOKED_PROVIDER:"faas.invoked_provider",FAAS_INVOKED_REGION:"faas.invoked_region",NET_TRANSPORT:"net.transport",NET_PEER_IP:"net.peer.ip",NET_PEER_PORT:"net.peer.port",NET_PEER_NAME:"net.peer.name",NET_HOST_IP:"net.host.ip",NET_HOST_PORT:"net.host.port",NET_HOST_NAME:"net.host.name",PEER_SERVICE:"peer.service",ENDUSER_ID:"enduser.id",ENDUSER_ROLE:"enduser.role",ENDUSER_SCOPE:"enduser.scope",THREAD_ID:"thread.id",THREAD_NAME:"thread.name",CODE_FUNCTION:"code.function",CODE_NAMESPACE:"code.namespace",CODE_FILEPATH:"code.filepath",CODE_LINENO:"code.lineno",HTTP_METHOD:"http.method",HTTP_URL:"http.url",HTTP_TARGET:"http.target",HTTP_HOST:"http.host",HTTP_SCHEME:"http.scheme",HTTP_STATUS_CODE:"http.status_code",HTTP_FLAVOR:"http.flavor",HTTP_USER_AGENT:"http.user_agent",HTTP_REQUEST_CONTENT_LENGTH:"http.request_content_length",HTTP_REQUEST_CONTENT_LENGTH_UNCOMPRESSED:"http.request_content_length_uncompressed",HTTP_RESPONSE_CONTENT_LENGTH:"http.response_content_length",HTTP_RESPONSE_CONTENT_LENGTH_UNCOMPRESSED:"http.response_content_length_uncompressed",HTTP_SERVER_NAME:"http.server_name",HTTP_ROUTE:"http.route",HTTP_CLIENT_IP:"http.client_ip",AWS_DYNAMODB_TABLE_NAMES:"aws.dynamodb.table_names",AWS_DYNAMODB_CONSUMED_CAPACITY:"aws.dynamodb.consumed_capacity",AWS_DYNAMODB_ITEM_COLLECTION_METRICS:"aws.dynamodb.item_collection_metrics",AWS_DYNAMODB_PROVISIONED_READ_CAPACITY:"aws.dynamodb.provisioned_read_capacity",AWS_DYNAMODB_PROVISIONED_WRITE_CAPACITY:"aws.dynamodb.provisioned_write_capacity",AWS_DYNAMODB_CONSISTENT_READ:"aws.dynamodb.consistent_read",AWS_DYNAMODB_PROJECTION:"aws.dynamodb.projection",AWS_DYNAMODB_LIMIT:"aws.dynamodb.limit",AWS_DYNAMODB_ATTRIBUTES_TO_GET:"aws.dynamodb.attributes_to_get",AWS_DYNAMODB_INDEX_NAME:"aws.dynamodb.index_name",AWS_DYNAMODB_SELECT:"aws.dynamodb.select",AWS_DYNAMODB_GLOBAL_SECONDARY_INDEXES:"aws.dynamodb.global_secondary_indexes",AWS_DYNAMODB_LOCAL_SECONDARY_INDEXES:"aws.dynamodb.local_secondary_indexes",AWS_DYNAMODB_EXCLUSIVE_START_TABLE:"aws.dynamodb.exclusive_start_table",AWS_DYNAMODB_TABLE_COUNT:"aws.dynamodb.table_count",AWS_DYNAMODB_SCAN_FORWARD:"aws.dynamodb.scan_forward",AWS_DYNAMODB_SEGMENT:"aws.dynamodb.segment",AWS_DYNAMODB_TOTAL_SEGMENTS:"aws.dynamodb.total_segments",AWS_DYNAMODB_COUNT:"aws.dynamodb.count",AWS_DYNAMODB_SCANNED_COUNT:"aws.dynamodb.scanned_count",AWS_DYNAMODB_ATTRIBUTE_DEFINITIONS:"aws.dynamodb.attribute_definitions",AWS_DYNAMODB_GLOBAL_SECONDARY_INDEX_UPDATES:"aws.dynamodb.global_secondary_index_updates",MESSAGING_SYSTEM:"messaging.system",MESSAGING_DESTINATION:"messaging.destination",MESSAGING_DESTINATION_KIND:"messaging.destination_kind",MESSAGING_TEMP_DESTINATION:"messaging.temp_destination",MESSAGING_PROTOCOL:"messaging.protocol",MESSAGING_PROTOCOL_VERSION:"messaging.protocol_version",MESSAGING_URL:"messaging.url",MESSAGING_MESSAGE_ID:"messaging.message_id",MESSAGING_CONVERSATION_ID:"messaging.conversation_id",MESSAGING_MESSAGE_PAYLOAD_SIZE_BYTES:"messaging.message_payload_size_bytes",MESSAGING_MESSAGE_PAYLOAD_COMPRESSED_SIZE_BYTES:"messaging.message_payload_compressed_size_bytes",MESSAGING_OPERATION:"messaging.operation",MESSAGING_RABBITMQ_ROUTING_KEY:"messaging.rabbitmq.routing_key",MESSAGING_KAFKA_MESSAGE_KEY:"messaging.kafka.message_key",MESSAGING_KAFKA_CONSUMER_GROUP:"messaging.kafka.consumer_group",MESSAGING_KAFKA_CLIENT_ID:"messaging.kafka.client_id",MESSAGING_KAFKA_PARTITION:"messaging.kafka.partition",MESSAGING_KAFKA_TOMBSTONE:"messaging.kafka.tombstone",RPC_SYSTEM:"rpc.system",RPC_SERVICE:"rpc.service",RPC_METHOD:"rpc.method",RPC_GRPC_STATUS_CODE:"rpc.grpc.status_code",RPC_JSONRPC_VERSION:"rpc.jsonrpc.version",RPC_JSONRPC_METHOD:"rpc.jsonrpc.method",RPC_JSONRPC_REQUEST_ID:"rpc.jsonrpc.request_id",RPC_JSONRPC_ERROR_CODE:"rpc.jsonrpc.error_code",RPC_JSONRPC_ERROR_MESSAGE:"rpc.jsonrpc.error_message"};var T;(function(y){y.OTHER_SQL="other_sql",y.MSSQL="mssql",y.MYSQL="mysql",y.ORACLE="oracle",y.DB2="db2",y.POSTGRESQL="postgresql",y.REDSHIFT="redshift",y.HIVE="hive",y.CLOUDSCAPE="cloudscape",y.HSQLDB="hsqldb",y.PROGRESS="progress",y.MAXDB="maxdb",y.HANADB="hanadb",y.INGRES="ingres",y.FIRSTSQL="firstsql",y.EDB="edb",y.CACHE="cache",y.ADABAS="adabas",y.FIREBIRD="firebird",y.DERBY="derby",y.FILEMAKER="filemaker",y.INFORMIX="informix",y.INSTANTDB="instantdb",y.INTERBASE="interbase",y.MARIADB="mariadb",y.NETEZZA="netezza",y.PERVASIVE="pervasive",y.POINTBASE="pointbase",y.SQLITE="sqlite",y.SYBASE="sybase",y.TERADATA="teradata",y.VERTICA="vertica",y.H2="h2",y.COLDFUSION="coldfusion",y.CASSANDRA="cassandra",y.HBASE="hbase",y.MONGODB="mongodb",y.REDIS="redis",y.COUCHBASE="couchbase",y.COUCHDB="couchdb",y.COSMOSDB="cosmosdb",y.DYNAMODB="dynamodb",y.NEO4J="neo4j",y.GEODE="geode",y.ELASTICSEARCH="elasticsearch",y.MEMCACHED="memcached",y.COCKROACHDB="cockroachdb"})(T=s.DbSystemValues||(s.DbSystemValues={}));var f;(function(y){y.ALL="all",y.EACH_QUORUM="each_quorum",y.QUORUM="quorum",y.LOCAL_QUORUM="local_quorum",y.ONE="one",y.TWO="two",y.THREE="three",y.LOCAL_ONE="local_one",y.ANY="any",y.SERIAL="serial",y.LOCAL_SERIAL="local_serial"})(f=s.DbCassandraConsistencyLevelValues||(s.DbCassandraConsistencyLevelValues={}));var w;(function(y){y.DATASOURCE="datasource",y.HTTP="http",y.PUBSUB="pubsub",y.TIMER="timer",y.OTHER="other"})(w=s.FaasTriggerValues||(s.FaasTriggerValues={}));var x;(function(y){y.INSERT="insert",y.EDIT="edit",y.DELETE="delete"})(x=s.FaasDocumentOperationValues||(s.FaasDocumentOperationValues={}));var p;(function(y){y.AWS="aws",y.AZURE="azure",y.GCP="gcp"})(p=s.FaasInvokedProviderValues||(s.FaasInvokedProviderValues={}));var u;(function(y){y.IP_TCP="ip_tcp",y.IP_UDP="ip_udp",y.IP="ip",y.UNIX="unix",y.PIPE="pipe",y.INPROC="inproc",y.OTHER="other"})(u=s.NetTransportValues||(s.NetTransportValues={}));var g;(function(y){y.HTTP_1_0="1.0",y.HTTP_1_1="1.1",y.HTTP_2_0="2.0",y.SPDY="SPDY",y.QUIC="QUIC"})(g=s.HttpFlavorValues||(s.HttpFlavorValues={}));var v;(function(y){y.QUEUE="queue",y.TOPIC="topic"})(v=s.MessagingDestinationKindValues||(s.MessagingDestinationKindValues={}));var _;(function(y){y.RECEIVE="receive",y.PROCESS="process"})(_=s.MessagingOperationValues||(s.MessagingOperationValues={}));var b;(function(y){y[y.OK=0]="OK",y[y.CANCELLED=1]="CANCELLED",y[y.UNKNOWN=2]="UNKNOWN",y[y.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",y[y.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",y[y.NOT_FOUND=5]="NOT_FOUND",y[y.ALREADY_EXISTS=6]="ALREADY_EXISTS",y[y.PERMISSION_DENIED=7]="PERMISSION_DENIED",y[y.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",y[y.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",y[y.ABORTED=10]="ABORTED",y[y.OUT_OF_RANGE=11]="OUT_OF_RANGE",y[y.UNIMPLEMENTED=12]="UNIMPLEMENTED",y[y.INTERNAL=13]="INTERNAL",y[y.UNAVAILABLE=14]="UNAVAILABLE",y[y.DATA_LOSS=15]="DATA_LOSS",y[y.UNAUTHENTICATED=16]="UNAUTHENTICATED"})(b=s.RpcGrpcStatusCodeValues||(s.RpcGrpcStatusCodeValues={}))}),Zs=F(s=>{"use strict";var T=s&&s.__createBinding||(Object.create?function(w,x,p,u){u===void 0&&(u=p),Object.defineProperty(w,u,{enumerable:!0,get:function(){return x[p]}})}:function(w,x,p,u){u===void 0&&(u=p),w[u]=x[p]}),f=s&&s.__exportStar||function(w,x){for(var p in w)p!=="default"&&!Object.prototype.hasOwnProperty.call(x,p)&&T(x,w,p)};Object.defineProperty(s,"__esModule",{value:!0}),f(Ys(),s)}),Js=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.TelemetrySdkLanguageValues=s.OsTypeValues=s.HostArchValues=s.AwsEcsLaunchtypeValues=s.CloudPlatformValues=s.CloudProviderValues=s.ResourceAttributes=void 0,s.ResourceAttributes={CLOUD_PROVIDER:"cloud.provider",CLOUD_ACCOUNT_ID:"cloud.account.id",CLOUD_REGION:"cloud.region",CLOUD_AVAILABILITY_ZONE:"cloud.availability_zone",CLOUD_PLATFORM:"cloud.platform",AWS_ECS_CONTAINER_ARN:"aws.ecs.container.arn",AWS_ECS_CLUSTER_ARN:"aws.ecs.cluster.arn",AWS_ECS_LAUNCHTYPE:"aws.ecs.launchtype",AWS_ECS_TASK_ARN:"aws.ecs.task.arn",AWS_ECS_TASK_FAMILY:"aws.ecs.task.family",AWS_ECS_TASK_REVISION:"aws.ecs.task.revision",AWS_EKS_CLUSTER_ARN:"aws.eks.cluster.arn",AWS_LOG_GROUP_NAMES:"aws.log.group.names",AWS_LOG_GROUP_ARNS:"aws.log.group.arns",AWS_LOG_STREAM_NAMES:"aws.log.stream.names",AWS_LOG_STREAM_ARNS:"aws.log.stream.arns",CONTAINER_NAME:"container.name",CONTAINER_ID:"container.id",CONTAINER_RUNTIME:"container.runtime",CONTAINER_IMAGE_NAME:"container.image.name",CONTAINER_IMAGE_TAG:"container.image.tag",DEPLOYMENT_ENVIRONMENT:"deployment.environment",DEVICE_ID:"device.id",DEVICE_MODEL_IDENTIFIER:"device.model.identifier",DEVICE_MODEL_NAME:"device.model.name",FAAS_NAME:"faas.name",FAAS_ID:"faas.id",FAAS_VERSION:"faas.version",FAAS_INSTANCE:"faas.instance",FAAS_MAX_MEMORY:"faas.max_memory",HOST_ID:"host.id",HOST_NAME:"host.name",HOST_TYPE:"host.type",HOST_ARCH:"host.arch",HOST_IMAGE_NAME:"host.image.name",HOST_IMAGE_ID:"host.image.id",HOST_IMAGE_VERSION:"host.image.version",K8S_CLUSTER_NAME:"k8s.cluster.name",K8S_NODE_NAME:"k8s.node.name",K8S_NODE_UID:"k8s.node.uid",K8S_NAMESPACE_NAME:"k8s.namespace.name",K8S_POD_UID:"k8s.pod.uid",K8S_POD_NAME:"k8s.pod.name",K8S_CONTAINER_NAME:"k8s.container.name",K8S_REPLICASET_UID:"k8s.replicaset.uid",K8S_REPLICASET_NAME:"k8s.replicaset.name",K8S_DEPLOYMENT_UID:"k8s.deployment.uid",K8S_DEPLOYMENT_NAME:"k8s.deployment.name",K8S_STATEFULSET_UID:"k8s.statefulset.uid",K8S_STATEFULSET_NAME:"k8s.statefulset.name",K8S_DAEMONSET_UID:"k8s.daemonset.uid",K8S_DAEMONSET_NAME:"k8s.daemonset.name",K8S_JOB_UID:"k8s.job.uid",K8S_JOB_NAME:"k8s.job.name",K8S_CRONJOB_UID:"k8s.cronjob.uid",K8S_CRONJOB_NAME:"k8s.cronjob.name",OS_TYPE:"os.type",OS_DESCRIPTION:"os.description",OS_NAME:"os.name",OS_VERSION:"os.version",PROCESS_PID:"process.pid",PROCESS_EXECUTABLE_NAME:"process.executable.name",PROCESS_EXECUTABLE_PATH:"process.executable.path",PROCESS_COMMAND:"process.command",PROCESS_COMMAND_LINE:"process.command_line",PROCESS_COMMAND_ARGS:"process.command_args",PROCESS_OWNER:"process.owner",PROCESS_RUNTIME_NAME:"process.runtime.name",PROCESS_RUNTIME_VERSION:"process.runtime.version",PROCESS_RUNTIME_DESCRIPTION:"process.runtime.description",SERVICE_NAME:"service.name",SERVICE_NAMESPACE:"service.namespace",SERVICE_INSTANCE_ID:"service.instance.id",SERVICE_VERSION:"service.version",TELEMETRY_SDK_NAME:"telemetry.sdk.name",TELEMETRY_SDK_LANGUAGE:"telemetry.sdk.language",TELEMETRY_SDK_VERSION:"telemetry.sdk.version",TELEMETRY_AUTO_VERSION:"telemetry.auto.version",WEBENGINE_NAME:"webengine.name",WEBENGINE_VERSION:"webengine.version",WEBENGINE_DESCRIPTION:"webengine.description"};var T;(function(g){g.AWS="aws",g.AZURE="azure",g.GCP="gcp"})(T=s.CloudProviderValues||(s.CloudProviderValues={}));var f;(function(g){g.AWS_EC2="aws_ec2",g.AWS_ECS="aws_ecs",g.AWS_EKS="aws_eks",g.AWS_LAMBDA="aws_lambda",g.AWS_ELASTIC_BEANSTALK="aws_elastic_beanstalk",g.AZURE_VM="azure_vm",g.AZURE_CONTAINER_INSTANCES="azure_container_instances",g.AZURE_AKS="azure_aks",g.AZURE_FUNCTIONS="azure_functions",g.AZURE_APP_SERVICE="azure_app_service",g.GCP_COMPUTE_ENGINE="gcp_compute_engine",g.GCP_CLOUD_RUN="gcp_cloud_run",g.GCP_KUBERNETES_ENGINE="gcp_kubernetes_engine",g.GCP_CLOUD_FUNCTIONS="gcp_cloud_functions",g.GCP_APP_ENGINE="gcp_app_engine"})(f=s.CloudPlatformValues||(s.CloudPlatformValues={}));var w;(function(g){g.EC2="ec2",g.FARGATE="fargate"})(w=s.AwsEcsLaunchtypeValues||(s.AwsEcsLaunchtypeValues={}));var x;(function(g){g.AMD64="amd64",g.ARM32="arm32",g.ARM64="arm64",g.IA64="ia64",g.PPC32="ppc32",g.PPC64="ppc64",g.X86="x86"})(x=s.HostArchValues||(s.HostArchValues={}));var p;(function(g){g.WINDOWS="windows",g.LINUX="linux",g.DARWIN="darwin",g.FREEBSD="freebsd",g.NETBSD="netbsd",g.OPENBSD="openbsd",g.DRAGONFLYBSD="dragonflybsd",g.HPUX="hpux",g.AIX="aix",g.SOLARIS="solaris",g.Z_OS="z_os"})(p=s.OsTypeValues||(s.OsTypeValues={}));var u;(function(g){g.CPP="cpp",g.DOTNET="dotnet",g.ERLANG="erlang",g.GO="go",g.JAVA="java",g.NODEJS="nodejs",g.PHP="php",g.PYTHON="python",g.RUBY="ruby",g.WEBJS="webjs"})(u=s.TelemetrySdkLanguageValues||(s.TelemetrySdkLanguageValues={}))}),on=F(s=>{"use strict";var T=s&&s.__createBinding||(Object.create?function(w,x,p,u){u===void 0&&(u=p),Object.defineProperty(w,u,{enumerable:!0,get:function(){return x[p]}})}:function(w,x,p,u){u===void 0&&(u=p),w[u]=x[p]}),f=s&&s.__exportStar||function(w,x){for(var p in w)p!=="default"&&!Object.prototype.hasOwnProperty.call(x,p)&&T(x,w,p)};Object.defineProperty(s,"__esModule",{value:!0}),f(Js(),s)}),ur=F(s=>{"use strict";var T=s&&s.__createBinding||(Object.create?function(w,x,p,u){u===void 0&&(u=p),Object.defineProperty(w,u,{enumerable:!0,get:function(){return x[p]}})}:function(w,x,p,u){u===void 0&&(u=p),w[u]=x[p]}),f=s&&s.__exportStar||function(w,x){for(var p in w)p!=="default"&&!Object.prototype.hasOwnProperty.call(x,p)&&T(x,w,p)};Object.defineProperty(s,"__esModule",{value:!0}),f(Zs(),s),f(on(),s)}),Qt=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.SDK_INFO=void 0;var T=Fi(),f=ur();s.SDK_INFO={[f.ResourceAttributes.TELEMETRY_SDK_NAME]:"opentelemetry",[f.ResourceAttributes.PROCESS_RUNTIME_NAME]:"node",[f.ResourceAttributes.TELEMETRY_SDK_LANGUAGE]:f.TelemetrySdkLanguageValues.NODEJS,[f.ResourceAttributes.TELEMETRY_SDK_VERSION]:T.VERSION}}),bn=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.unrefTimer=void 0;function T(f){f.unref()}a(T,"uA"),s.unrefTimer=T}),mi=F(s=>{"use strict";var T=s&&s.__createBinding||(Object.create?function(w,x,p,u){u===void 0&&(u=p),Object.defineProperty(w,u,{enumerable:!0,get:function(){return x[p]}})}:function(w,x,p,u){u===void 0&&(u=p),w[u]=x[p]}),f=s&&s.__exportStar||function(w,x){for(var p in w)p!=="default"&&!Object.prototype.hasOwnProperty.call(x,p)&&T(x,w,p)};Object.defineProperty(s,"__esModule",{value:!0}),f(ut(),s),f($i(),s),f(to(),s),f(Eo(),s),f(Qt(),s),f(bn(),s)}),Wa=F(s=>{"use strict";var T=s&&s.__createBinding||(Object.create?function(w,x,p,u){u===void 0&&(u=p),Object.defineProperty(w,u,{enumerable:!0,get:function(){return x[p]}})}:function(w,x,p,u){u===void 0&&(u=p),w[u]=x[p]}),f=s&&s.__exportStar||function(w,x){for(var p in w)p!=="default"&&!Object.prototype.hasOwnProperty.call(x,p)&&T(x,w,p)};Object.defineProperty(s,"__esModule",{value:!0}),f(mi(),s)}),ec=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.isTimeInput=s.isTimeInputHrTime=s.hrTimeToMicroseconds=s.hrTimeToMilliseconds=s.hrTimeToNanoseconds=s.hrTimeToTimeStamp=s.hrTimeDuration=s.timeInputToHrTime=s.hrTime=void 0;var T=Wa(),f=9,w=Math.pow(10,f);function x(R){let D=R/1e3,k=Math.trunc(D),G=Number((D-k).toFixed(f))*w;return[k,G]}a(x,"Ma");function p(){let R=T.otperformance.timeOrigin;if(typeof R!="number"){let D=T.otperformance;R=D.timing&&D.timing.fetchStart}return R}a(p,"Ef");function u(R){let D=x(p()),k=x(typeof R=="number"?R:T.otperformance.now()),G=D[0]+k[0],Z=D[1]+k[1];return Z>w&&(Z-=w,G+=1),[G,Z]}a(u,"yf"),s.hrTime=u;function g(R){if(C(R))return R;if(typeof R=="number")return R<p()?u(R):x(R);if(R instanceof Date)return x(R.getTime());throw TypeError("Invalid input type")}a(g,"fA"),s.timeInputToHrTime=g;function v(R,D){let k=D[0]-R[0],G=D[1]-R[1];return G<0&&(k-=1,G+=w),[k,G]}a(v,"dA"),s.hrTimeDuration=v;function _(R){let D=f,k=`${"0".repeat(D)}${R[1]}Z`,G=k.substr(k.length-D-1);return new Date(R[0]*1e3).toISOString().replace("000Z",G)}a(_,"hA"),s.hrTimeToTimeStamp=_;function b(R){return R[0]*w+R[1]}a(b,"_A"),s.hrTimeToNanoseconds=b;function y(R){return Math.round(R[0]*1e3+R[1]/1e6)}a(y,"gA"),s.hrTimeToMilliseconds=y;function E(R){return Math.round(R[0]*1e6+R[1]/1e3)}a(E,"vA"),s.hrTimeToMicroseconds=E;function C(R){return Array.isArray(R)&&R.length===2&&typeof R[0]=="number"&&typeof R[1]=="number"}a(C,"nu"),s.isTimeInputHrTime=C;function A(R){return C(R)||typeof R=="number"||R instanceof Date}a(A,"mA"),s.isTimeInput=A}),hl=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),Ga=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.ExportResultCode=void 0;var T;(function(f){f[f.SUCCESS=0]="SUCCESS",f[f.FAILED=1]="FAILED"})(T=s.ExportResultCode||(s.ExportResultCode={}))}),Va=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.CompositePropagator=void 0;var T=ir(),f=a(class{constructor(w={}){var x;this._propagators=(x=w.propagators)!==null&&x!==void 0?x:[],this._fields=Array.from(new Set(this._propagators.map(p=>typeof p.fields=="function"?p.fields():[]).reduce((p,u)=>p.concat(u),[])))}inject(w,x,p){for(let u of this._propagators)try{u.inject(w,x,p)}catch(g){T.diag.warn(`Failed to inject with ${u.constructor.name}. Err: ${g.message}`)}}extract(w,x,p){return this._propagators.reduce((u,g)=>{try{return g.extract(u,x,p)}catch(v){T.diag.warn(`Failed to inject with ${g.constructor.name}. Err: ${v.message}`)}return u},w)}fields(){return this._fields.slice()}},"Cf");s.CompositePropagator=f}),An=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.validateValue=s.validateKey=void 0;var T="[_0-9a-z-*/]",f=`[a-z]${T}{0,255}`,w=`[a-z0-9]${T}{0,240}@[a-z]${T}{0,13}`,x=new RegExp(`^(?:${f}|${w})$`),p=/^[ -~]{0,255}[!-~]$/,u=/,|=/;function g(_){return x.test(_)}a(g,"IA"),s.validateKey=g;function v(_){return p.test(_)&&!u.test(_)}a(v,"CA"),s.validateValue=v}),ro=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.TraceState=void 0;var T=An(),f=32,w=512,x=",",p="=",u=a(class{constructor(g){this._internalState=new Map,g&&this._parse(g)}set(g,v){let _=this._clone();return _._internalState.has(g)&&_._internalState.delete(g),_._internalState.set(g,v),_}unset(g){let v=this._clone();return v._internalState.delete(g),v}get(g){return this._internalState.get(g)}serialize(){return this._keys().reduce((g,v)=>(g.push(v+p+this.get(v)),g),[]).join(x)}_parse(g){g.length>w||(this._internalState=g.split(x).reverse().reduce((v,_)=>{let b=_.trim(),y=b.indexOf(p);if(y!==-1){let E=b.slice(0,y),C=b.slice(y+1,_.length);T.validateKey(E)&&T.validateValue(C)&&v.set(E,C)}return v},new Map),this._internalState.size>f&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,f))))}_keys(){return Array.from(this._internalState.keys()).reverse()}_clone(){let g=new u;return g._internalState=new Map(this._internalState),g}},"La");s.TraceState=u}),fl=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.HttpTraceContextPropagator=s.parseTraceParent=s.TRACE_STATE_HEADER=s.TRACE_PARENT_HEADER=void 0;var T=ir(),f=Li(),w=ro();s.TRACE_PARENT_HEADER="traceparent",s.TRACE_STATE_HEADER="tracestate";var x="00",p="(?!ff)[\\da-f]{2}",u="(?![0]{32})[\\da-f]{32}",g="(?![0]{16})[\\da-f]{16}",v="[\\da-f]{2}",_=new RegExp(`^\\s?(${p})-(${u})-(${g})-(${v})(-.*)?\\s?$`);function b(E){let C=_.exec(E);return!C||C[1]==="00"&&C[5]?null:{traceId:C[2],spanId:C[3],traceFlags:parseInt(C[4],16)}}a(b,"Mf"),s.parseTraceParent=b;var y=a(class{inject(E,C,A){let R=T.trace.getSpanContext(E);if(!R||f.isTracingSuppressed(E)||!T.isSpanContextValid(R))return;let D=`${x}-${R.traceId}-${R.spanId}-0${Number(R.traceFlags||T.TraceFlags.NONE).toString(16)}`;A.set(C,s.TRACE_PARENT_HEADER,D),R.traceState&&A.set(C,s.TRACE_STATE_HEADER,R.traceState.serialize())}extract(E,C,A){let R=A.get(C,s.TRACE_PARENT_HEADER);if(!R)return E;let D=Array.isArray(R)?R[0]:R;if(typeof D!="string")return E;let k=b(D);if(!k)return E;k.isRemote=!0;let G=A.get(C,s.TRACE_STATE_HEADER);if(G){let Z=Array.isArray(G)?G.join(","):G;k.traceState=new w.TraceState(typeof Z=="string"?Z:void 0)}return T.trace.setSpanContext(E,k)}fields(){return[s.TRACE_PARENT_HEADER,s.TRACE_STATE_HEADER]}},"xf");s.HttpTraceContextPropagator=y}),pl=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),xo=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.getRPCMetadata=s.deleteRPCMetadata=s.setRPCMetadata=s.RPCType=void 0;var T=ir(),f=T.createContextKey("OpenTelemetry SDK Context Key RPC_METADATA"),w;(function(g){g.HTTP="http"})(w=s.RPCType||(s.RPCType={}));function x(g,v){return g.setValue(f,v)}a(x,"jA"),s.setRPCMetadata=x;function p(g){return g.deleteValue(f)}a(p,"HA"),s.deleteRPCMetadata=p;function u(g){return g.getValue(f)}a(u,"UA"),s.getRPCMetadata=u}),Ka=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.AlwaysOffSampler=void 0;var T=ir(),f=a(class{shouldSample(){return{decision:T.SamplingDecision.NOT_RECORD}}toString(){return"AlwaysOffSampler"}},"Hf");s.AlwaysOffSampler=f}),vi=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.AlwaysOnSampler=void 0;var T=ir(),f=a(class{shouldSample(){return{decision:T.SamplingDecision.RECORD_AND_SAMPLED}}toString(){return"AlwaysOnSampler"}},"Uf");s.AlwaysOnSampler=f}),Xa=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.ParentBasedSampler=void 0;var T=ir(),f=So(),w=Ka(),x=vi(),p=a(class{constructor(u){var g,v,_,b;this._root=u.root,this._root||(f.globalErrorHandler(new Error("ParentBasedSampler must have a root sampler configured")),this._root=new x.AlwaysOnSampler),this._remoteParentSampled=(g=u.remoteParentSampled)!==null&&g!==void 0?g:new x.AlwaysOnSampler,this._remoteParentNotSampled=(v=u.remoteParentNotSampled)!==null&&v!==void 0?v:new w.AlwaysOffSampler,this._localParentSampled=(_=u.localParentSampled)!==null&&_!==void 0?_:new x.AlwaysOnSampler,this._localParentNotSampled=(b=u.localParentNotSampled)!==null&&b!==void 0?b:new w.AlwaysOffSampler}shouldSample(u,g,v,_,b,y){let E=T.trace.getSpanContext(u);return!E||!T.isSpanContextValid(E)?this._root.shouldSample(u,g,v,_,b,y):E.isRemote?E.traceFlags&T.TraceFlags.SAMPLED?this._remoteParentSampled.shouldSample(u,g,v,_,b,y):this._remoteParentNotSampled.shouldSample(u,g,v,_,b,y):E.traceFlags&T.TraceFlags.SAMPLED?this._localParentSampled.shouldSample(u,g,v,_,b,y):this._localParentNotSampled.shouldSample(u,g,v,_,b,y)}toString(){return`ParentBased{root=${this._root.toString()}, remoteParentSampled=${this._remoteParentSampled.toString()}, remoteParentNotSampled=${this._remoteParentNotSampled.toString()}, localParentSampled=${this._localParentSampled.toString()}, localParentNotSampled=${this._localParentNotSampled.toString()}}`}},"Gf");s.ParentBasedSampler=p}),gl=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.TraceIdRatioBasedSampler=void 0;var T=ir(),f=a(class{constructor(w=0){this._ratio=w,this._ratio=this._normalize(w),this._upperBound=Math.floor(this._ratio*4294967295)}shouldSample(w,x){return{decision:T.isValidTraceId(x)&&this._accumulate(x)<this._upperBound?T.SamplingDecision.RECORD_AND_SAMPLED:T.SamplingDecision.NOT_RECORD}}toString(){return`TraceIdRatioBased{${this._ratio}}`}_normalize(w){return typeof w!="number"||isNaN(w)?0:w>=1?1:w<=0?0:w}_accumulate(w){let x=0;for(let p=0;p<w.length/8;p++){let u=p*8,g=parseInt(w.slice(u,u+8),16);x=(x^g)>>>0}return x}},"Vf");s.TraceIdRatioBasedSampler=f}),Qa=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.isUrlIgnored=s.urlMatches=void 0;function T(w,x){return typeof x=="string"?w===x:x.test(w)}a(T,"zf"),s.urlMatches=T;function f(w,x){if(!x)return!1;for(let p of x)if(T(w,p))return!0;return!1}a(f,"VA"),s.isUrlIgnored=f}),ml=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.isWrapped=void 0;function T(f){return typeof f=="function"&&typeof f.__original=="function"&&typeof f.__unwrap=="function"&&f.__wrapped===!0}a(T,"$A"),s.isWrapped=T}),Vr=F(s=>{"use strict";var T=s&&s.__createBinding||(Object.create?function(w,x,p,u){u===void 0&&(u=p),Object.defineProperty(w,u,{enumerable:!0,get:function(){return x[p]}})}:function(w,x,p,u){u===void 0&&(u=p),w[u]=x[p]}),f=s&&s.__exportStar||function(w,x){for(var p in w)p!=="default"&&!Object.prototype.hasOwnProperty.call(x,p)&&T(x,w,p)};Object.defineProperty(s,"__esModule",{value:!0}),s.baggageUtils=void 0,f(Qs(),s),f(Mr(),s),f(So(),s),f(gi(),s),f(ec(),s),f(hl(),s),f(Ga(),s),f(Fi(),s),s.baggageUtils=oa(),f(Wa(),s),f(Va(),s),f(fl(),s),f(pl(),s),f(xo(),s),f(Ka(),s),f(vi(),s),f(Xa(),s),f(gl(),s),f(Li(),s),f(ro(),s),f(Tn(),s),f(za(),s),f(Qa(),s),f(ml(),s),f(Fi(),s)}),hn=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.ExceptionEventName=void 0,s.ExceptionEventName="exception"}),Ya=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.Span=void 0;var T=ir(),f=Vr(),w=ur(),x=hn(),p=a(class{constructor(u,g,v,_,b,y,E=[],C=f.hrTime()){this.attributes={},this.links=[],this.events=[],this.status={code:T.SpanStatusCode.UNSET},this.endTime=[0,0],this._ended=!1,this._duration=[-1,-1],this.name=v,this._spanContext=_,this.parentSpanId=y,this.kind=b,this.links=E,this.startTime=f.timeInputToHrTime(C),this.resource=u.resource,this.instrumentationLibrary=u.instrumentationLibrary,this._spanLimits=u.getSpanLimits(),this._spanProcessor=u.getActiveSpanProcessor(),this._spanProcessor.onStart(this,g)}spanContext(){return this._spanContext}setAttribute(u,g){return g==null||this._isSpanEnded()?this:u.length===0?(T.diag.warn(`Invalid attribute key: ${u}`),this):f.isAttributeValue(g)?Object.keys(this.attributes).length>=this._spanLimits.attributeCountLimit&&!Object.prototype.hasOwnProperty.call(this.attributes,u)?this:(this.attributes[u]=g,this):(T.diag.warn(`Invalid attribute value set for key: ${u}`),this)}setAttributes(u){for(let[g,v]of Object.entries(u))this.setAttribute(g,v);return this}addEvent(u,g,v){return this._isSpanEnded()?this:(this.events.length>=this._spanLimits.eventCountLimit&&(T.diag.warn("Dropping extra events."),this.events.shift()),f.isTimeInput(g)&&(typeof v=="undefined"&&(v=g),g=void 0),typeof v=="undefined"&&(v=f.hrTime()),this.events.push({name:u,attributes:g,time:f.timeInputToHrTime(v)}),this)}setStatus(u){return this._isSpanEnded()?this:(this.status=u,this)}updateName(u){return this._isSpanEnded()?this:(this.name=u,this)}end(u=f.hrTime()){if(this._isSpanEnded()){T.diag.error("You can only call end() on a span once.");return}this._ended=!0,this.endTime=f.timeInputToHrTime(u),this._duration=f.hrTimeDuration(this.startTime,this.endTime),this._duration[0]<0&&T.diag.warn("Inconsistent start and end time, startTime > endTime",this.startTime,this.endTime),this._spanProcessor.onEnd(this)}isRecording(){return this._ended===!1}recordException(u,g=f.hrTime()){let v={};typeof u=="string"?v[w.SemanticAttributes.EXCEPTION_MESSAGE]=u:u&&(u.code?v[w.SemanticAttributes.EXCEPTION_TYPE]=u.code.toString():u.name&&(v[w.SemanticAttributes.EXCEPTION_TYPE]=u.name),u.message&&(v[w.SemanticAttributes.EXCEPTION_MESSAGE]=u.message),u.stack&&(v[w.SemanticAttributes.EXCEPTION_STACKTRACE]=u.stack)),v[w.SemanticAttributes.EXCEPTION_TYPE]||v[w.SemanticAttributes.EXCEPTION_MESSAGE]?this.addEvent(x.ExceptionEventName,v,g):T.diag.warn(`Failed to record an exception ${u}`)}get duration(){return this._duration}get ended(){return this._ended}_isSpanEnded(){return this._ended&&T.diag.warn("Can not execute the operation on ended Span {traceId: %s, spanId: %s}",this._spanContext.traceId,this._spanContext.spanId),this._ended}},"Qf");s.Span=p}),Za=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.buildSamplerFromEnv=s.DEFAULT_CONFIG=void 0;var T=ir(),f=Vr(),w=f.getEnv(),x=f.TracesSamplerValues.AlwaysOn;s.DEFAULT_CONFIG={sampler:p(w),forceFlushTimeoutMillis:3e4,spanLimits:{attributeCountLimit:f.getEnv().OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT,linkCountLimit:f.getEnv().OTEL_SPAN_LINK_COUNT_LIMIT,eventCountLimit:f.getEnv().OTEL_SPAN_EVENT_COUNT_LIMIT}};function p(v=f.getEnv()){switch(v.OTEL_TRACES_SAMPLER){case f.TracesSamplerValues.AlwaysOn:return new f.AlwaysOnSampler;case f.TracesSamplerValues.AlwaysOff:return new f.AlwaysOffSampler;case f.TracesSamplerValues.ParentBasedAlwaysOn:return new f.ParentBasedSampler({root:new f.AlwaysOnSampler});case f.TracesSamplerValues.ParentBasedAlwaysOff:return new f.ParentBasedSampler({root:new f.AlwaysOffSampler});case f.TracesSamplerValues.TraceIdRatio:return new f.TraceIdRatioBasedSampler(g(v));case f.TracesSamplerValues.ParentBasedTraceIdRatio:return new f.ParentBasedSampler({root:new f.TraceIdRatioBasedSampler(g(v))});default:return T.diag.error(`OTEL_TRACES_SAMPLER value "${v.OTEL_TRACES_SAMPLER} invalid, defaulting to ${x}".`),new f.AlwaysOnSampler}}a(p,"Wf"),s.buildSamplerFromEnv=p;var u=1;function g(v){if(v.OTEL_TRACES_SAMPLER_ARG===void 0||v.OTEL_TRACES_SAMPLER_ARG==="")return T.diag.error(`OTEL_TRACES_SAMPLER_ARG is blank, defaulting to ${u}.`),u;let _=Number(v.OTEL_TRACES_SAMPLER_ARG);return isNaN(_)?(T.diag.error(`OTEL_TRACES_SAMPLER_ARG=${v.OTEL_TRACES_SAMPLER_ARG} was given, but it is invalid, defaulting to ${u}.`),u):_<0||_>1?(T.diag.error(`OTEL_TRACES_SAMPLER_ARG=${v.OTEL_TRACES_SAMPLER_ARG} was given, but it is out of range ([0..1]), defaulting to ${u}.`),u):_}a(g,"Zf")}),Kn=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.mergeConfig=void 0;var T=Za();function f(w){let x={sampler:T.buildSamplerFromEnv()},p=Object.assign({},T.DEFAULT_CONFIG,x,w);return p.spanLimits=Object.assign({},T.DEFAULT_CONFIG.spanLimits,w.spanLimits||{}),p}a(f,"QA"),s.mergeConfig=f}),aa=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.Tracer=void 0;var T=ir(),f=Vr(),w=Ya(),x=Kn(),p=a(class{constructor(g,v,_){this._tracerProvider=_;let b=x.mergeConfig(v);this._sampler=b.sampler,this._spanLimits=b.spanLimits,this._idGenerator=v.idGenerator||new f.RandomIdGenerator,this.resource=_.resource,this.instrumentationLibrary=g}startSpan(g,v={},_=T.context.active()){var b,y;if(f.isTracingSuppressed(_))return T.diag.debug("Instrumentation suppressed, returning Noop Span"),T.trace.wrapSpanContext(T.INVALID_SPAN_CONTEXT);let E=u(v,_),C=this._idGenerator.generateSpanId(),A,R,D;!E||!T.trace.isSpanContextValid(E)?A=this._idGenerator.generateTraceId():(A=E.traceId,R=E.traceState,D=E.spanId);let k=(b=v.kind)!==null&&b!==void 0?b:T.SpanKind.INTERNAL,G=(y=v.links)!==null&&y!==void 0?y:[],Z=f.sanitizeAttributes(v.attributes),Q=this._sampler.shouldSample(v.root?T.trace.setSpanContext(_,T.INVALID_SPAN_CONTEXT):_,A,g,k,Z,G),fe=Q.decision===T.SamplingDecision.RECORD_AND_SAMPLED?T.TraceFlags.SAMPLED:T.TraceFlags.NONE,Se={traceId:A,spanId:C,traceFlags:fe,traceState:R};if(Q.decision===T.SamplingDecision.NOT_RECORD)return T.diag.debug("Recording is off, propagating context in a non-recording span"),T.trace.wrapSpanContext(Se);let Me=new w.Span(this,_,g,Se,k,D,G,v.startTime);return Me.setAttributes(Object.assign(Z,Q.attributes)),Me}startActiveSpan(g,v,_,b){let y,E,C;if(arguments.length<2)return;arguments.length===2?C=v:arguments.length===3?(y=v,C=_):(y=v,E=_,C=b);let A=E!=null?E:T.context.active(),R=this.startSpan(g,y,A),D=T.trace.setSpan(A,R);return T.context.with(D,C,void 0,R)}getSpanLimits(){return this._spanLimits}getActiveSpanProcessor(){return this._tracerProvider.getActiveSpanProcessor()}},"ed");s.Tracer=p;function u(g,v){if(!g.root)return T.trace.getSpanContext(v)}a(u,"JA")}),tc=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.defaultServiceName=void 0;function T(){return`unknown_service:${process.argv0}`}a(T,"eb"),s.defaultServiceName=T}),rc=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.detectResources=void 0;var T=Rn(),f=ir(),w=K(3837),x=a(async(u={})=>{let g=Object.assign(u),v=await Promise.all((g.detectors||[]).map(async _=>{try{let b=await _.detect(g);return f.diag.debug(`${_.constructor.name} found resource.`,b),b}catch(b){return f.diag.debug(`${_.constructor.name} failed: ${b.message}`),T.Resource.empty()}}));return p(v),v.reduce((_,b)=>_.merge(b),T.Resource.empty())},"rb");s.detectResources=x;var p=a(u=>{u.forEach(g=>{if(Object.keys(g.attributes).length>0){let v=w.inspect(g.attributes,{depth:2,breakLength:1/0,sorted:!0,compact:!1});f.diag.verbose(v)}})},"nb")}),Bi=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.envDetector=void 0;var T=ir(),f=Vr(),w=ur(),x=es(),p=a(class{constructor(){this._MAX_LENGTH=255,this._COMMA_SEPARATOR=",",this._LABEL_KEY_VALUE_SPLITTER="=",this._ERROR_MESSAGE_INVALID_CHARS="should be a ASCII string with a length greater than 0 and not exceed "+this._MAX_LENGTH+" characters.",this._ERROR_MESSAGE_INVALID_VALUE="should be a ASCII string with a length not exceed "+this._MAX_LENGTH+" characters."}async detect(u){let g={},v=f.getEnv(),_=v.OTEL_RESOURCE_ATTRIBUTES,b=v.OTEL_SERVICE_NAME;if(_)try{let y=this._parseResourceAttributes(_);Object.assign(g,y)}catch(y){T.diag.debug(`EnvDetector failed: ${y.message}`)}return b&&(g[w.ResourceAttributes.SERVICE_NAME]=b),new x.Resource(g)}_parseResourceAttributes(u){if(!u)return{};let g={},v=u.split(this._COMMA_SEPARATOR,-1);for(let _ of v){let b=_.split(this._LABEL_KEY_VALUE_SPLITTER,-1);if(b.length!==2)continue;let[y,E]=b;if(y=y.trim(),E=E.trim().split('^"|"$').join(""),!this._isValidAndNotEmpty(y))throw new Error(`Attribute key ${this._ERROR_MESSAGE_INVALID_CHARS}`);if(!this._isValid(E))throw new Error(`Attribute value ${this._ERROR_MESSAGE_INVALID_VALUE}`);g[y]=E}return g}_isValid(u){return u.length<=this._MAX_LENGTH&&this._isPrintableString(u)}_isPrintableString(u){for(let g=0;g<u.length;g++){let v=u.charAt(g);if(v<=" "||v>="~")return!1}return!0}_isValidAndNotEmpty(u){return u.length>0&&this._isValid(u)}},"ad");s.envDetector=new p}),vl=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.processDetector=void 0;var T=ir(),f=ur(),w=es(),x=a(class{async detect(p){let u={[f.ResourceAttributes.PROCESS_PID]:process.pid,[f.ResourceAttributes.PROCESS_EXECUTABLE_NAME]:process.title||"",[f.ResourceAttributes.PROCESS_COMMAND]:process.argv[1]||"",[f.ResourceAttributes.PROCESS_COMMAND_LINE]:process.argv.join(" ")||""};return this._getResourceAttributes(u,p)}_getResourceAttributes(p,u){return p[f.ResourceAttributes.PROCESS_EXECUTABLE_NAME]===""||p[f.ResourceAttributes.PROCESS_EXECUTABLE_PATH]===""||p[f.ResourceAttributes.PROCESS_COMMAND]===""||p[f.ResourceAttributes.PROCESS_COMMAND_LINE]===""?(T.diag.debug("ProcessDetector failed: Unable to find required process resources. "),w.Resource.empty()):new w.Resource(Object.assign({},p))}},"ud");s.processDetector=new x}),sa=F(s=>{"use strict";var T=s&&s.__createBinding||(Object.create?function(w,x,p,u){u===void 0&&(u=p),Object.defineProperty(w,u,{enumerable:!0,get:function(){return x[p]}})}:function(w,x,p,u){u===void 0&&(u=p),w[u]=x[p]}),f=s&&s.__exportStar||function(w,x){for(var p in w)p!=="default"&&!Object.prototype.hasOwnProperty.call(x,p)&&T(x,w,p)};Object.defineProperty(s,"__esModule",{value:!0}),f(Bi(),s),f(vl(),s)}),yi=F(s=>{"use strict";var T=s&&s.__createBinding||(Object.create?function(w,x,p,u){u===void 0&&(u=p),Object.defineProperty(w,u,{enumerable:!0,get:function(){return x[p]}})}:function(w,x,p,u){u===void 0&&(u=p),w[u]=x[p]}),f=s&&s.__exportStar||function(w,x){for(var p in w)p!=="default"&&!Object.prototype.hasOwnProperty.call(x,p)&&T(x,w,p)};Object.defineProperty(s,"__esModule",{value:!0}),f(tc(),s),f(rc(),s),f(sa(),s)}),nc=F(s=>{"use strict";var T=s&&s.__createBinding||(Object.create?function(w,x,p,u){u===void 0&&(u=p),Object.defineProperty(w,u,{enumerable:!0,get:function(){return x[p]}})}:function(w,x,p,u){u===void 0&&(u=p),w[u]=x[p]}),f=s&&s.__exportStar||function(w,x){for(var p in w)p!=="default"&&!Object.prototype.hasOwnProperty.call(x,p)&&T(x,w,p)};Object.defineProperty(s,"__esModule",{value:!0}),f(yi(),s)}),Rn=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.Resource=void 0;var T=ur(),f=Vr(),w=nc(),x=a(class{constructor(p){this.attributes=p}static empty(){return x.EMPTY}static default(){return new x({[T.ResourceAttributes.SERVICE_NAME]:w.defaultServiceName(),[T.ResourceAttributes.TELEMETRY_SDK_LANGUAGE]:f.SDK_INFO[T.ResourceAttributes.TELEMETRY_SDK_LANGUAGE],[T.ResourceAttributes.TELEMETRY_SDK_NAME]:f.SDK_INFO[T.ResourceAttributes.TELEMETRY_SDK_NAME],[T.ResourceAttributes.TELEMETRY_SDK_VERSION]:f.SDK_INFO[T.ResourceAttributes.TELEMETRY_SDK_VERSION]})}merge(p){if(!p||!Object.keys(p.attributes).length)return this;let u=Object.assign({},this.attributes,p.attributes);return new x(u)}},"wt");s.Resource=x,x.EMPTY=new x({})}),Ja=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),ca=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),es=F(s=>{"use strict";var T=s&&s.__createBinding||(Object.create?function(w,x,p,u){u===void 0&&(u=p),Object.defineProperty(w,u,{enumerable:!0,get:function(){return x[p]}})}:function(w,x,p,u){u===void 0&&(u=p),w[u]=x[p]}),f=s&&s.__exportStar||function(w,x){for(var p in w)p!=="default"&&!Object.prototype.hasOwnProperty.call(x,p)&&T(x,w,p)};Object.defineProperty(s,"__esModule",{value:!0}),f(Rn(),s),f(nc(),s),f(Ja(),s),f(ca(),s)}),ts=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.MultiSpanProcessor=void 0;var T=Vr(),f=a(class{constructor(w){this._spanProcessors=w}forceFlush(){let w=[];for(let x of this._spanProcessors)w.push(x.forceFlush());return new Promise(x=>{Promise.all(w).then(()=>{x()}).catch(p=>{T.globalErrorHandler(p||new Error("MultiSpanProcessor: forceFlush failed")),x()})})}onStart(w,x){for(let p of this._spanProcessors)p.onStart(w,x)}onEnd(w){for(let x of this._spanProcessors)x.onEnd(w)}shutdown(){let w=[];for(let x of this._spanProcessors)w.push(x.shutdown());return new Promise((x,p)=>{Promise.all(w).then(()=>{x()},p)})}},"vd");s.MultiSpanProcessor=f}),rs=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.NoopSpanProcessor=void 0;var T=a(class{onStart(f,w){}onEnd(f){}shutdown(){return Promise.resolve()}forceFlush(){return Promise.resolve()}},"Ed");s.NoopSpanProcessor=T}),ic=F((s,T)=>{var f=200,w="__lodash_hash_undefined__",x=800,p=16,u=9007199254740991,g="[object Arguments]",v="[object Array]",_="[object AsyncFunction]",b="[object Boolean]",y="[object Date]",E="[object Error]",C="[object Function]",A="[object GeneratorFunction]",R="[object Map]",D="[object Number]",k="[object Null]",G="[object Object]",Z="[object Proxy]",Q="[object RegExp]",fe="[object Set]",Se="[object String]",Me="[object Undefined]",He="[object WeakMap]",Qe="[object ArrayBuffer]",Ye="[object DataView]",mt="[object Float32Array]",Ct="[object Float64Array]",Vt="[object Int8Array]",Bt="[object Int16Array]",Er="[object Int32Array]",Ht="[object Uint8Array]",Je="[object Uint8ClampedArray]",ct="[object Uint16Array]",dt="[object Uint32Array]",Et=/[\\^$.*+?()[\]{}|]/g,kt=/^\[object .+?Constructor\]$/,zt=/^(?:0|[1-9]\d*)$/,Tt={};Tt[mt]=Tt[Ct]=Tt[Vt]=Tt[Bt]=Tt[Er]=Tt[Ht]=Tt[Je]=Tt[ct]=Tt[dt]=!0,Tt[g]=Tt[v]=Tt[Qe]=Tt[b]=Tt[Ye]=Tt[y]=Tt[E]=Tt[C]=Tt[R]=Tt[D]=Tt[G]=Tt[Q]=Tt[fe]=Tt[Se]=Tt[He]=!1;var ar=typeof global=="object"&&global&&global.Object===Object&&global,gr=typeof self=="object"&&self&&self.Object===Object&&self,fr=ar||gr||Function("return this")(),_r=typeof s=="object"&&s&&!s.nodeType&&s,or=_r&&typeof T=="object"&&T&&!T.nodeType&&T,Pr=or&&or.exports===_r,En=Pr&&ar.process,Nt=function(){try{var re=or&&or.require&&or.require("util").types;return re||En&&En.binding&&En.binding("util")}catch(ye){}}(),At=Nt&&Nt.isTypedArray;function nr(re,ye,De){switch(De.length){case 0:return re.call(ye);case 1:return re.call(ye,De[0]);case 2:return re.call(ye,De[0],De[1]);case 3:return re.call(ye,De[0],De[1],De[2])}return re.apply(ye,De)}a(nr,"Yb");function jr(re,ye){for(var De=-1,St=Array(re);++De<re;)St[De]=ye(De);return St}a(jr,"Qb");function Sc(re){return function(ye){return re(ye)}}a(Sc,"Wb");function oo(re,ye){return re==null?void 0:re[ye]}a(oo,"Zb");function Kt(re,ye){return function(De){return re(ye(De))}}a(Kt,"Jb");var Dn=Array.prototype,ao=Function.prototype,Hi=Object.prototype,ei=fr["__core-js_shared__"],Ci=ao.toString,Un=Hi.hasOwnProperty,ms=function(){var re=/[^.]+$/.exec(ei&&ei.keys&&ei.keys.IE_PROTO||"");return re?"Symbol(src)_1."+re:""}(),vs=Hi.toString,jn=Ci.call(Object),ys=RegExp("^"+Ci.call(Un).replace(Et,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),so=Pr?fr.Buffer:void 0,Sa=fr.Symbol,ti=fr.Uint8Array,Ui=so?so.allocUnsafe:void 0,Ti=Kt(Object.getPrototypeOf,Object),co=Object.create,Ho=Hi.propertyIsEnumerable,Uo=Dn.splice,vn=Sa?Sa.toStringTag:void 0,ri=function(){try{var re=zi(Object,"defineProperty");return re({},"",{}),re}catch(ye){}}(),yn=so?so.isBuffer:void 0,bt=Math.max,sr=Date.now,jo=zi(fr,"Map"),qn=zi(Object,"create"),Br=function(){function re(){}return a(re,"e"),function(ye){if(!Wn(ye))return{};if(co)return co(ye);re.prototype=ye;var De=new re;return re.prototype=void 0,De}}();function ni(re){var ye=-1,De=re==null?0:re.length;for(this.clear();++ye<De;){var St=re[ye];this.set(St[0],St[1])}}a(ni,"or");function _s(){this.__data__=qn?qn(null):{},this.size=0}a(_s,"cI");function lo(re){var ye=this.has(re)&&delete this.__data__[re];return this.size-=ye?1:0,ye}a(lo,"lI");function ws(re){var ye=this.__data__;if(qn){var De=ye[re];return De===w?void 0:De}return Un.call(ye,re)?ye[re]:void 0}a(ws,"pI");function Hr(re){var ye=this.__data__;return qn?ye[re]!==void 0:Un.call(ye,re)}a(Hr,"fI");function bs(re,ye){var De=this.__data__;return this.size+=this.has(re)?0:1,De[re]=qn&&ye===void 0?w:ye,this}a(bs,"dI"),ni.prototype.clear=_s,ni.prototype.delete=lo,ni.prototype.get=ws,ni.prototype.has=Hr,ni.prototype.set=bs;function Dr(re){var ye=-1,De=re==null?0:re.length;for(this.clear();++ye<De;){var St=re[ye];this.set(St[0],St[1])}}a(Dr,"ct");function Ec(){this.__data__=[],this.size=0}a(Ec,"hI");function zn(re){var ye=this.__data__,De=Rt(ye,re);if(De<0)return!1;var St=ye.length-1;return De==St?ye.pop():Uo.call(ye,De,1),--this.size,!0}a(zn,"_I");function uo(re){var ye=this.__data__,De=Rt(ye,re);return De<0?void 0:ye[De][1]}a(uo,"gI");function Ss(re){return Rt(this.__data__,re)>-1}a(Ss,"vI");function xc(re,ye){var De=this.__data__,St=Rt(De,re);return St<0?(++this.size,De.push([re,ye])):De[St][1]=ye,this}a(xc,"mI"),Dr.prototype.clear=Ec,Dr.prototype.delete=zn,Dr.prototype.get=uo,Dr.prototype.has=Ss,Dr.prototype.set=xc;function ii(re){var ye=-1,De=re==null?0:re.length;for(this.clear();++ye<De;){var St=re[ye];this.set(St[0],St[1])}}a(ii,"tn");function Ai(){this.size=0,this.__data__={hash:new ni,map:new(jo||Dr),string:new ni}}a(Ai,"EI");function Ri(re){var ye=Ii(this,re).delete(re);return this.size-=ye?1:0,ye}a(Ri,"yI");function Es(re){return Ii(this,re).get(re)}a(Es,"TI");function ho(re){return Ii(this,re).has(re)}a(ho,"SI");function oi(re,ye){var De=Ii(this,re),St=De.size;return De.set(re,ye),this.size+=De.size==St?0:1,this}a(oi,"AI"),ii.prototype.clear=Ai,ii.prototype.delete=Ri,ii.prototype.get=Es,ii.prototype.has=ho,ii.prototype.set=oi;function ai(re){var ye=this.__data__=new Dr(re);this.size=ye.size}a(ai,"rn");function xs(){this.__data__=new Dr,this.size=0}a(xs,"bI");function ee(re){var ye=this.__data__,De=ye.delete(re);return this.size=ye.size,De}a(ee,"II");function me(re){return this.__data__.get(re)}a(me,"CI");function Re(re){return this.__data__.has(re)}a(Re,"OI");function rt(re,ye){var De=this.__data__;if(De instanceof Dr){var St=De.__data__;if(!jo||St.length<f-1)return St.push([re,ye]),this.size=++De.size,this;De=this.__data__=new ii(St)}return De.set(re,ye),this.size=De.size,this}a(rt,"PI"),ai.prototype.clear=xs,ai.prototype.delete=ee,ai.prototype.get=me,ai.prototype.has=Re,ai.prototype.set=rt;function lt(re,ye){var De=Os(re),St=!De&&Is(re),Xt=!De&&!St&&Rc(re),cr=!De&&!St&&!Xt&&Ns(re),Ae=De||St||Xt||cr,Wt=Ae?jr(re.length,String):[],pr=Wt.length;for(var xn in re)(ye||Un.call(re,xn))&&!(Ae&&(xn=="length"||Xt&&(xn=="offset"||xn=="parent")||cr&&(xn=="buffer"||xn=="byteLength"||xn=="byteOffset")||Ca(xn,pr)))&&Wt.push(xn);return Wt}a(lt,"RI");function yt(re,ye,De){(De!==void 0&&!Aa(re[ye],De)||De===void 0&&!(ye in re))&&Ut(re,ye,De)}a(yt,"Au");function vt(re,ye,De){var St=re[ye];(!(Un.call(re,ye)&&Aa(St,De))||De===void 0&&!(ye in re))&&Ut(re,ye,De)}a(vt,"NI");function Rt(re,ye){for(var De=re.length;De--;)if(Aa(re[De][0],ye))return De;return-1}a(Rt,"us");function Ut(re,ye,De){ye=="__proto__"&&ri?ri(re,ye,{configurable:!0,enumerable:!0,value:De,writable:!0}):re[ye]=De}a(Ut,"bu");var ln=xa();function qr(re){return re==null?re===void 0?Me:k:vn&&vn in Object(re)?Wo(re):Ml(re)}a(qr,"cs");function Qr(re){return Go(re)&&qr(re)==g}a(Qr,"Hd");function Yr(re){if(!Wn(re)||Nl(re))return!1;var ye=ks(re)?ys:kt;return ye.test(Fl(re))}a(Yr,"wI");function _n(re){return Go(re)&&Ic(re.length)&&!!Tt[qr(re)]}a(_n,"MI");function Dl(re){if(!Wn(re))return Rs(re);var ye=Ac(re),De=[];for(var St in re)St=="constructor"&&(ye||!Un.call(re,St))||De.push(St);return De}a(Dl,"xI");function Cs(re,ye,De,St,Xt){re!==ye&&ln(ye,function(cr,Ae){if(Xt||(Xt=new ai),Wn(cr))qo(re,ye,Ae,De,Cs,St,Xt);else{var Wt=St?St(Ta(re,Ae),cr,Ae+"",re,ye,Xt):void 0;Wt===void 0&&(Wt=cr),yt(re,Ae,Wt)}},Pc)}a(Cs,"Ud");function qo(re,ye,De,St,Xt,cr,Ae){var Wt=Ta(re,De),pr=Ta(ye,De),xn=Ae.get(pr);if(xn){yt(re,De,xn);return}var xr=cr?cr(Wt,pr,De+"",re,ye,Ae):void 0,Wi=xr===void 0;if(Wi){var kc=Os(pr),Cr=!kc&&Rc(pr),Gn=!kc&&!Cr&&Ns(pr);xr=pr,kc||Cr||Gn?Os(Wt)?xr=Wt:Ds(Wt)?xr=zo(Wt):Cr?(Wi=!1,xr=As(pr,!0)):Gn?(Wi=!1,xr=ji(pr,!0)):xr=[]:Oc(pr)||Is(pr)?(xr=Wt,Is(Wt)?xr=Bl(Wt):(!Wn(Wt)||ks(Wt))&&(xr=Tc(pr))):Wi=!1}Wi&&(Ae.set(pr,xr),Xt(xr,pr,St,cr,Ae),Ae.delete(pr)),yt(re,De,xr)}a(qo,"LI");function Ts(re,ye){return Ll(Oi(re,ye,Dc),re+"")}a(Ts,"qI");var Cc=ri?function(re,ye){return ri(re,"toString",{configurable:!0,enumerable:!1,value:Hl(ye),writable:!0})}:Dc;function As(re,ye){if(ye)return re.slice();var De=re.length,St=Ui?Ui(De):new re.constructor(De);return re.copy(St),St}a(As,"jI");function Ea(re){var ye=new re.constructor(re.byteLength);return new ti(ye).set(new ti(re)),ye}a(Ea,"HI");function ji(re,ye){var De=ye?Ea(re.buffer):re.buffer;return new re.constructor(De,re.byteOffset,re.length)}a(ji,"UI");function zo(re,ye){var De=-1,St=re.length;for(ye||(ye=Array(St));++De<St;)ye[De]=re[De];return ye}a(zo,"BI");function Zr(re,ye,De,St){var Xt=!De;De||(De={});for(var cr=-1,Ae=ye.length;++cr<Ae;){var Wt=ye[cr],pr=St?St(De[Wt],re[Wt],Wt,De,re):void 0;pr===void 0&&(pr=re[Wt]),Xt?Ut(De,Wt,pr):vt(De,Wt,pr)}return De}a(Zr,"GI");function qi(re){return Ts(function(ye,De){var St=-1,Xt=De.length,cr=Xt>1?De[Xt-1]:void 0,Ae=Xt>2?De[2]:void 0;for(cr=re.length>3&&typeof cr=="function"?(Xt--,cr):void 0,Ae&&kl(De[0],De[1],Ae)&&(cr=Xt<3?void 0:cr,Xt=1),ye=Object(ye);++St<Xt;){var Wt=De[St];Wt&&re(ye,Wt,St,cr)}return ye})}a(qi,"FI");function xa(re){return function(ye,De,St){for(var Xt=-1,cr=Object(ye),Ae=St(ye),Wt=Ae.length;Wt--;){var pr=Ae[re?Wt:++Xt];if(De(cr[pr],pr,cr)===!1)break}return ye}}a(xa,"VI");function Ii(re,ye){var De=re.__data__;return ih(ye)?De[typeof ye=="string"?"string":"hash"]:De.map}a(Ii,"ls");function zi(re,ye){var De=oo(re,ye);return Yr(De)?De:void 0}a(zi,"Iu");function Wo(re){var ye=Un.call(re,vn),De=re[vn];try{re[vn]=void 0;var St=!0}catch(cr){}var Xt=vs.call(re);return St&&(ye?re[vn]=De:delete re[vn]),Xt}a(Wo,"$I");function Tc(re){return typeof re.constructor=="function"&&!Ac(re)?Br(Ti(re)):{}}a(Tc,"zI");function Ca(re,ye){var De=typeof re;return ye=ye==null?u:ye,!!ye&&(De=="number"||De!="symbol"&&zt.test(re))&&re>-1&&re%1==0&&re<ye}a(Ca,"Bd");function kl(re,ye,De){if(!Wn(De))return!1;var St=typeof ye;return(St=="number"?Ps(De)&&Ca(ye,De.length):St=="string"&&ye in De)?Aa(De[ye],re):!1}a(kl,"KI");function ih(re){var ye=typeof re;return ye=="string"||ye=="number"||ye=="symbol"||ye=="boolean"?re!=="__proto__":re===null}a(ih,"XI");function Nl(re){return!!ms&&ms in re}a(Nl,"YI");function Ac(re){var ye=re&&re.constructor,De=typeof ye=="function"&&ye.prototype||Hi;return re===De}a(Ac,"Gd");function Rs(re){var ye=[];if(re!=null)for(var De in Object(re))ye.push(De);return ye}a(Rs,"QI");function Ml(re){return vs.call(re)}a(Ml,"WI");function Oi(re,ye,De){return ye=bt(ye===void 0?re.length-1:ye,0),function(){for(var St=arguments,Xt=-1,cr=bt(St.length-ye,0),Ae=Array(cr);++Xt<cr;)Ae[Xt]=St[ye+Xt];Xt=-1;for(var Wt=Array(ye+1);++Xt<ye;)Wt[Xt]=St[Xt];return Wt[ye]=De(Ae),nr(re,this,Wt)}}a(Oi,"ZI");function Ta(re,ye){if(!(ye==="constructor"&&typeof re[ye]=="function")&&ye!="__proto__")return re[ye]}a(Ta,"Cu");var Ll=$l(Cc);function $l(re){var ye=0,De=0;return function(){var St=sr(),Xt=p-(St-De);if(De=St,Xt>0){if(++ye>=x)return arguments[0]}else ye=0;return re.apply(void 0,arguments)}}a($l,"eC");function Fl(re){if(re!=null){try{return Ci.call(re)}catch(ye){}try{return re+""}catch(ye){}}return""}a(Fl,"tC");function Aa(re,ye){return re===ye||re!==re&&ye!==ye}a(Aa,"ps");var Is=Qr(function(){return arguments}())?Qr:function(re){return Go(re)&&Un.call(re,"callee")&&!Ho.call(re,"callee")},Os=Array.isArray;function Ps(re){return re!=null&&Ic(re.length)&&!ks(re)}a(Ps,"Ru");function Ds(re){return Go(re)&&Ps(re)}a(Ds,"rC");var Rc=yn||Ul;function ks(re){if(!Wn(re))return!1;var ye=qr(re);return ye==C||ye==A||ye==_||ye==Z}a(ks,"Nu");function Ic(re){return typeof re=="number"&&re>-1&&re%1==0&&re<=u}a(Ic,"Vd");function Wn(re){var ye=typeof re;return re!=null&&(ye=="object"||ye=="function")}a(Wn,"ur");function Go(re){return re!=null&&typeof re=="object"}a(Go,"li");function Oc(re){if(!Go(re)||qr(re)!=G)return!1;var ye=Ti(re);if(ye===null)return!0;var De=Un.call(ye,"constructor")&&ye.constructor;return typeof De=="function"&&De instanceof De&&Ci.call(De)==jn}a(Oc,"nC");var Ns=At?Sc(At):_n;function Bl(re){return Zr(re,Pc(re))}a(Bl,"iC");function Pc(re){return Ps(re)?lt(re,!0):Dl(re)}a(Pc,"zd");var si=qi(function(re,ye,De){Cs(re,ye,De)});function Hl(re){return function(){return re}}a(Hl,"sC");function Dc(re){return re}a(Dc,"Kd");function Ul(){return!1}a(Ul,"oC"),T.exports=si}),Co=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.BatchSpanProcessorBase=void 0;var T=ir(),f=Vr(),w=a(class{constructor(x,p){this._exporter=x,this._finishedSpans=[],this._isShutdown=!1,this._shuttingDownPromise=Promise.resolve();let u=f.getEnv();this._maxExportBatchSize=typeof(p==null?void 0:p.maxExportBatchSize)=="number"?p.maxExportBatchSize:u.OTEL_BSP_MAX_EXPORT_BATCH_SIZE,this._maxQueueSize=typeof(p==null?void 0:p.maxQueueSize)=="number"?p.maxQueueSize:u.OTEL_BSP_MAX_QUEUE_SIZE,this._scheduledDelayMillis=typeof(p==null?void 0:p.scheduledDelayMillis)=="number"?p.scheduledDelayMillis:u.OTEL_BSP_SCHEDULE_DELAY,this._exportTimeoutMillis=typeof(p==null?void 0:p.exportTimeoutMillis)=="number"?p.exportTimeoutMillis:u.OTEL_BSP_EXPORT_TIMEOUT}forceFlush(){return this._isShutdown?this._shuttingDownPromise:this._flushAll()}onStart(x){}onEnd(x){this._isShutdown||this._addToBuffer(x)}shutdown(){return this._isShutdown?this._shuttingDownPromise:(this._isShutdown=!0,this._shuttingDownPromise=new Promise((x,p)=>{Promise.resolve().then(()=>this.onShutdown()).then(()=>this._flushAll()).then(()=>this._exporter.shutdown()).then(x).catch(u=>{p(u)})}),this._shuttingDownPromise)}_addToBuffer(x){this._finishedSpans.length>=this._maxQueueSize||(this._finishedSpans.push(x),this._maybeStartTimer())}_flushAll(){return new Promise((x,p)=>{let u=[],g=Math.ceil(this._finishedSpans.length/this._maxExportBatchSize);for(let v=0,_=g;v<_;v++)u.push(this._flushOneBatch());Promise.all(u).then(()=>{x()}).catch(p)})}_flushOneBatch(){return this._clearTimer(),this._finishedSpans.length===0?Promise.resolve():new Promise((x,p)=>{let u=setTimeout(()=>{p(new Error("Timeout"))},this._exportTimeoutMillis);T.context.with(f.suppressTracing(T.context.active()),()=>{this._exporter.export(this._finishedSpans.splice(0,this._maxExportBatchSize),g=>{var v;clearTimeout(u),g.code===f.ExportResultCode.SUCCESS?x():p((v=g.error)!==null&&v!==void 0?v:new Error("BatchSpanProcessor: span export failed"))})})})}_maybeStartTimer(){this._timer===void 0&&(this._timer=setTimeout(()=>{this._flushOneBatch().then(()=>{this._finishedSpans.length>0&&(this._clearTimer(),this._maybeStartTimer())}).catch(x=>{f.globalErrorHandler(x)})},this._scheduledDelayMillis),f.unrefTimer(this._timer))}_clearTimer(){this._timer!==void 0&&(clearTimeout(this._timer),this._timer=void 0)}},"Qd");s.BatchSpanProcessorBase=w}),oc=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.BatchSpanProcessor=void 0;var T=Co(),f=a(class extends T.BatchSpanProcessorBase{onShutdown(){}},"Zd");s.BatchSpanProcessor=f}),la=F(s=>{"use strict";var T=s&&s.__createBinding||(Object.create?function(w,x,p,u){u===void 0&&(u=p),Object.defineProperty(w,u,{enumerable:!0,get:function(){return x[p]}})}:function(w,x,p,u){u===void 0&&(u=p),w[u]=x[p]}),f=s&&s.__exportStar||function(w,x){for(var p in w)p!=="default"&&!Object.prototype.hasOwnProperty.call(x,p)&&T(x,w,p)};Object.defineProperty(s,"__esModule",{value:!0}),f(oc(),s)}),ua=F(s=>{"use strict";var T=s&&s.__createBinding||(Object.create?function(w,x,p,u){u===void 0&&(u=p),Object.defineProperty(w,u,{enumerable:!0,get:function(){return x[p]}})}:function(w,x,p,u){u===void 0&&(u=p),w[u]=x[p]}),f=s&&s.__exportStar||function(w,x){for(var p in w)p!=="default"&&!Object.prototype.hasOwnProperty.call(x,p)&&T(x,w,p)};Object.defineProperty(s,"__esModule",{value:!0}),f(la(),s)}),da=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.BasicTracerProvider=s.ForceFlushState=void 0;var T=ir(),f=Vr(),w=es(),x=Ao(),p=Za(),u=ts(),g=rs(),v=ic(),_=ua(),b;(function(E){E[E.resolved=0]="resolved",E[E.timeout=1]="timeout",E[E.error=2]="error",E[E.unresolved=3]="unresolved"})(b=s.ForceFlushState||(s.ForceFlushState={}));var y=a(class{constructor(E={}){var C;this._registeredSpanProcessors=[],this._tracers=new Map;let A=v({},p.DEFAULT_CONFIG,E);this.resource=(C=A.resource)!==null&&C!==void 0?C:w.Resource.empty(),this.resource=w.Resource.default().merge(this.resource),this._config=Object.assign({},A,{resource:this.resource});let R=this._buildExporterFromEnv();if(R!==void 0){let D=new _.BatchSpanProcessor(R);this.activeSpanProcessor=D}else this.activeSpanProcessor=new g.NoopSpanProcessor}getTracer(E,C){let A=`${E}@${C||""}`;return this._tracers.has(A)||this._tracers.set(A,new x.Tracer({name:E,version:C},this._config,this)),this._tracers.get(A)}addSpanProcessor(E){this._registeredSpanProcessors.length===0&&this.activeSpanProcessor.shutdown().catch(C=>T.diag.error("Error while trying to shutdown current span processor",C)),this._registeredSpanProcessors.push(E),this.activeSpanProcessor=new u.MultiSpanProcessor(this._registeredSpanProcessors)}getActiveSpanProcessor(){return this.activeSpanProcessor}register(E={}){T.trace.setGlobalTracerProvider(this),E.propagator===void 0&&(E.propagator=this._buildPropagatorFromEnv()),E.contextManager&&T.context.setGlobalContextManager(E.contextManager),E.propagator&&T.propagation.setGlobalPropagator(E.propagator)}forceFlush(){let E=this._config.forceFlushTimeoutMillis,C=this._registeredSpanProcessors.map(A=>new Promise(R=>{let D,k=setTimeout(()=>{R(new Error(`Span processor did not completed within timeout period of ${E} ms`)),D=b.timeout},E);A.forceFlush().then(()=>{clearTimeout(k),D!==b.timeout&&(D=b.resolved,R(D))}).catch(G=>{clearTimeout(k),D=b.error,R(G)})}));return new Promise((A,R)=>{Promise.all(C).then(D=>{let k=D.filter(G=>G!==b.resolved);k.length>0?R(k):A()}).catch(D=>R([D]))})}shutdown(){return this.activeSpanProcessor.shutdown()}_getPropagator(E){var C;return(C=y._registeredPropagators.get(E))===null||C===void 0?void 0:C()}_getSpanExporter(E){var C;return(C=y._registeredExporters.get(E))===null||C===void 0?void 0:C()}_buildPropagatorFromEnv(){let E=Array.from(new Set(f.getEnv().OTEL_PROPAGATORS)),C=E.map(A=>{let R=this._getPropagator(A);return R||T.diag.warn(`Propagator "${A}" requested through environment variable is unavailable.`),R}).reduce((A,R)=>(R&&A.push(R),A),[]);if(C.length!==0)return E.length===1?C[0]:new f.CompositePropagator({propagators:C})}_buildExporterFromEnv(){let E=f.getEnv().OTEL_TRACES_EXPORTER;if(E==="none")return;let C=this._getSpanExporter(E);return C||T.diag.error(`Exporter "${E}" requested through environment variable is unavailable.`),C}},"pr");s.BasicTracerProvider=y,y._registeredPropagators=new Map([["tracecontext",()=>new f.HttpTraceContextPropagator],["baggage",()=>new f.HttpBaggagePropagator]]),y._registeredExporters=new Map}),_i=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.ConsoleSpanExporter=void 0;var T=Vr(),f=a(class{export(w,x){return this._sendSpans(w,x)}shutdown(){return this._sendSpans([]),Promise.resolve()}_exportInfo(w){return{traceId:w.spanContext().traceId,parentId:w.parentSpanId,name:w.name,id:w.spanContext().spanId,kind:w.kind,timestamp:T.hrTimeToMicroseconds(w.startTime),duration:T.hrTimeToMicroseconds(w.duration),attributes:w.attributes,status:w.status,events:w.events}}_sendSpans(w,x){for(let p of w)console.log(this._exportInfo(p));if(x)return x({code:T.ExportResultCode.SUCCESS})}},"nh");s.ConsoleSpanExporter=f}),ns=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.InMemorySpanExporter=void 0;var T=Vr(),f=a(class{constructor(){this._finishedSpans=[],this._stopped=!1}export(w,x){if(this._stopped)return x({code:T.ExportResultCode.FAILED,error:new Error("Exporter has been stopped")});this._finishedSpans.push(...w),setTimeout(()=>x({code:T.ExportResultCode.SUCCESS}),0)}shutdown(){return this._stopped=!0,this._finishedSpans=[],Promise.resolve()}reset(){this._finishedSpans=[]}getFinishedSpans(){return this._finishedSpans}},"sh");s.InMemorySpanExporter=f}),To=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),Ln=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.SimpleSpanProcessor=void 0;var T=ir(),f=Vr(),w=a(class{constructor(x){this._exporter=x,this._isShutdown=!1,this._shuttingDownPromise=Promise.resolve()}forceFlush(){return Promise.resolve()}onStart(x){}onEnd(x){this._isShutdown||T.context.with(f.suppressTracing(T.context.active()),()=>{this._exporter.export([x],p=>{var u;p.code!==f.ExportResultCode.SUCCESS&&f.globalErrorHandler((u=p.error)!==null&&u!==void 0?u:new Error(`SimpleSpanProcessor: span export failed (status ${p})`))})})}shutdown(){return this._isShutdown?this._shuttingDownPromise:(this._isShutdown=!0,this._shuttingDownPromise=new Promise((x,p)=>{Promise.resolve().then(()=>this._exporter.shutdown()).then(x).catch(u=>{p(u)})}),this._shuttingDownPromise)}},"ph");s.SimpleSpanProcessor=w}),is=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),ac=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),sc=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),os=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),Ao=F(s=>{"use strict";var T=s&&s.__createBinding||(Object.create?function(w,x,p,u){u===void 0&&(u=p),Object.defineProperty(w,u,{enumerable:!0,get:function(){return x[p]}})}:function(w,x,p,u){u===void 0&&(u=p),w[u]=x[p]}),f=s&&s.__exportStar||function(w,x){for(var p in w)p!=="default"&&!Object.prototype.hasOwnProperty.call(x,p)&&T(x,w,p)};Object.defineProperty(s,"__esModule",{value:!0}),f(aa(),s),f(da(),s),f(ua(),s),f(_i(),s),f(ns(),s),f(To(),s),f(Ln(),s),f(is(),s),f(rs(),s),f(Ya(),s),f(ac(),s),f(sc(),s),f(os(),s)}),Xn=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.enable=s.azureCoreTracing=s.AzureMonitorSymbol=void 0;var T=he();s.AzureMonitorSymbol="Azure_Monitor_Tracer";var f=!1,w=a(function(p){if(f)return p;try{var u=Ao(),g=ir(),v=new u.BasicTracerProvider,_=v.getTracer("applicationinsights tracer"),b=p.setTracer;p.setTracer=function(y){var E=y.startSpan;y.startSpan=function(C,A,R){var D=E.call(this,C,A,R),k=D.end;return D.end=function(){var G=k.apply(this,arguments);return T.channel.publish("azure-coretracing",D),G},D},y[s.AzureMonitorSymbol]=!0,b.call(this,y)},g.trace.getSpan(g.context.active()),p.setTracer(_),f=!0}catch(y){}return p},"yC");s.azureCoreTracing={versionSpecifier:">= 1.0.0 < 2.0.0",patch:w};function x(){T.channel.registerMonkeyPatch("@azure/core-tracing",s.azureCoreTracing)}a(x,"TC"),s.enable=x}),ha=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.enable=s.bunyan=void 0;var T=he(),f=a(function(x){var p=x.prototype._emit;return x.prototype._emit=function(u,g){var v=p.apply(this,arguments);if(!g){var _=v;_||(_=p.call(this,u,!0)),T.channel.publish("bunyan",{level:u.level,result:_})}return v},x},"SC");s.bunyan={versionSpecifier:">= 1.0.0 < 2.0.0",patch:f};function w(){T.channel.registerMonkeyPatch("bunyan",s.bunyan)}a(w,"AC"),s.enable=w}),wi=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.enable=s.console=void 0;var T=he(),f=K(2781),w=a(function(p){var u=new f.Writable,g=new f.Writable;u.write=function(A){if(!A)return!0;var R=A.toString();return T.channel.publish("console",{message:R}),!0},g.write=function(A){if(!A)return!0;var R=A.toString();return T.channel.publish("console",{message:R,stderr:!0}),!0};for(var v=new p.Console(u,g),_=["log","info","warn","error","dir","time","timeEnd","trace","assert"],b=function(A){var R=p[A];R&&(p[A]=function(){if(v[A])try{v[A].apply(v,arguments)}catch(D){}return R.apply(p,arguments)})},y=0,E=_;y<E.length;y++){var C=E[y];b(C)}return p},"bC");s.console={versionSpecifier:">= 4.0.0",patch:w};function x(){T.channel.registerMonkeyPatch("console",s.console),K(6206)}a(x,"IC"),s.enable=x}),Ro=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.enable=s.mongoCore=void 0;var T=he(),f=a(function(x){var p=x.Server.prototype.connect;return x.Server.prototype.connect=function(){var u=p.apply(this,arguments),g=this.s.pool.write;this.s.pool.write=function(){var _=typeof arguments[1]=="function"?1:2;return typeof arguments[_]=="function"&&(arguments[_]=T.channel.bindToContext(arguments[_])),g.apply(this,arguments)};var v=this.s.pool.logout;return this.s.pool.logout=function(){return typeof arguments[1]=="function"&&(arguments[1]=T.channel.bindToContext(arguments[1])),v.apply(this,arguments)},u},x},"CC");s.mongoCore={versionSpecifier:">= 2.0.0 < 4.0.0",patch:f};function w(){T.channel.registerMonkeyPatch("mongodb-core",s.mongoCore)}a(w,"OC"),s.enable=w}),as=F(s=>{"use strict";var T=s&&s.__assign||function(){return T=Object.assign||function(v){for(var _,b=1,y=arguments.length;b<y;b++){_=arguments[b];for(var E in _)Object.prototype.hasOwnProperty.call(_,E)&&(v[E]=_[E])}return v},T.apply(this,arguments)};Object.defineProperty(s,"__esModule",{value:!0}),s.enable=s.mongo330=s.mongo3=s.mongo2=void 0;var f=he(),w=a(function(v){var _=v.instrument({operationIdGenerator:{next:function(){return f.channel.bindToContext(function(y){return y()})}}}),b={};return _.on("started",function(y){b[y.requestId]||(b[y.requestId]=T(T({},y),{time:new Date}))}),_.on("succeeded",function(y){var E=b[y.requestId];E&&delete b[y.requestId],typeof y.operationId=="function"?y.operationId(function(){return f.channel.publish("mongodb",{startedData:E,event:y,succeeded:!0})}):f.channel.publish("mongodb",{startedData:E,event:y,succeeded:!0})}),_.on("failed",function(y){var E=b[y.requestId];E&&delete b[y.requestId],typeof y.operationId=="function"?y.operationId(function(){return f.channel.publish("mongodb",{startedData:E,event:y,succeeded:!1})}):f.channel.publish("mongodb",{startedData:E,event:y,succeeded:!1})}),v},"PC"),x=a(function(v){var _=v.instrument(),b={},y={};return _.on("started",function(E){b[E.requestId]||(y[E.requestId]=f.channel.bindToContext(function(C){return C()}),b[E.requestId]=T(T({},E),{time:new Date}))}),_.on("succeeded",function(E){var C=b[E.requestId];C&&delete b[E.requestId],typeof E=="object"&&typeof y[E.requestId]=="function"&&(y[E.requestId](function(){return f.channel.publish("mongodb",{startedData:C,event:E,succeeded:!0})}),delete y[E.requestId])}),_.on("failed",function(E){var C=b[E.requestId];C&&delete b[E.requestId],typeof E=="object"&&typeof y[E.requestId]=="function"&&(y[E.requestId](function(){return f.channel.publish("mongodb",{startedData:C,event:E,succeeded:!1})}),delete y[E.requestId])}),v},"RC"),p=a(function(v){var _=v.Server.prototype.connect;return v.Server.prototype.connect=function(){var b=_.apply(this,arguments),y=this.s.coreTopology.s.pool.write;this.s.coreTopology.s.pool.write=function(){var C=typeof arguments[1]=="function"?1:2;return typeof arguments[C]=="function"&&(arguments[C]=f.channel.bindToContext(arguments[C])),y.apply(this,arguments)};var E=this.s.coreTopology.s.pool.logout;return this.s.coreTopology.s.pool.logout=function(){return typeof arguments[1]=="function"&&(arguments[1]=f.channel.bindToContext(arguments[1])),E.apply(this,arguments)},b},v},"NC"),u=a(function(v){p(v);var _=v.instrument(),b={},y={};return _.on("started",function(E){b[E.requestId]||(y[E.requestId]=f.channel.bindToContext(function(C){return C()}),b[E.requestId]=E)}),_.on("succeeded",function(E){var C=b[E.requestId];C&&delete b[E.requestId],typeof E=="object"&&typeof y[E.requestId]=="function"&&(y[E.requestId](function(){return f.channel.publish("mongodb",{startedData:C,event:E,succeeded:!0})}),delete y[E.requestId])}),_.on("failed",function(E){var C=b[E.requestId];C&&delete b[E.requestId],typeof E=="object"&&typeof y[E.requestId]=="function"&&(y[E.requestId](function(){return f.channel.publish("mongodb",{startedData:C,event:E,succeeded:!1})}),delete y[E.requestId])}),v},"DC");s.mongo2={versionSpecifier:">= 2.0.0 <= 3.0.5",patch:w},s.mongo3={versionSpecifier:"> 3.0.5 < 3.3.0",patch:x},s.mongo330={versionSpecifier:">= 3.3.0 < 4.0.0",patch:u};function g(){f.channel.registerMonkeyPatch("mongodb",s.mongo2),f.channel.registerMonkeyPatch("mongodb",s.mongo3),f.channel.registerMonkeyPatch("mongodb",s.mongo330)}a(g,"wC"),s.enable=g}),Io=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.enable=s.mysql=void 0;var T=he(),f=K(1017),w=a(function(p,u){var g=a(function(C,A){return function(R,D){var k=C[R];k&&(C[R]=function(){for(var G=arguments.length-1,Z=arguments.length-1;Z>=0;--Z)if(typeof arguments[Z]=="function"){G=Z;break}else if(typeof arguments[Z]!="undefined")break;var Q=arguments[G],fe={result:null,startTime:null,startDate:null};typeof Q=="function"&&(D?(fe.startTime=process.hrtime(),fe.startDate=new Date,arguments[G]=T.channel.bindToContext(D(fe,Q))):arguments[G]=T.channel.bindToContext(Q));var Se=k.apply(this,arguments);return fe.result=Se,Se})}},"r"),v=a(function(C,A){return g(C.prototype,A+".prototype")},"n"),_=["connect","changeUser","ping","statistics","end"],b=K(3255)(f.dirname(u)+"/lib/Connection");_.forEach(function(C){return v(b,"Connection")(C)}),g(b,"Connection")("createQuery",function(C,A){return function(R){var D=process.hrtime(C.startTime),k=D[0]*1e3+D[1]/1e6|0;T.channel.publish("mysql",{query:C.result,callbackArgs:arguments,err:R,duration:k,time:C.startDate}),A.apply(this,arguments)}});var y=["_enqueueCallback"],E=K(9118)(f.dirname(u)+"/lib/Pool");return y.forEach(function(C){return v(E,"Pool")(C)}),p},"MC");s.mysql={versionSpecifier:">= 2.0.0 < 3.0.0",patch:w};function x(){T.channel.registerMonkeyPatch("mysql",s.mysql)}a(x,"xC"),s.enable=x}),fa=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.enable=s.postgresPool1=void 0;var T=he();function f(x){var p=x.prototype.connect;return x.prototype.connect=function(u){return u&&(arguments[0]=T.channel.bindToContext(u)),p.apply(this,arguments)},x}a(f,"LC"),s.postgresPool1={versionSpecifier:">= 1.0.0 < 3.0.0",patch:f};function w(){T.channel.registerMonkeyPatch("pg-pool",s.postgresPool1)}a(w,"qC"),s.enable=w}),cc=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.enable=s.postgres7=s.postgres6=void 0;var T=he(),f=K(2361);function w(u,g){var v=u.Client.prototype.query,_="__diagnosticOriginalFunc";return u.Client.prototype.query=function(b,y,E){var C={query:{},database:{host:this.connectionParameters.host,port:this.connectionParameters.port},result:null,error:null,duration:0,time:new Date},A=process.hrtime(),R;function D(k){k&&k[_]&&(k=k[_]);var G=T.channel.bindToContext(function(Z,Q){var fe=process.hrtime(A);if(C.result=Q&&{rowCount:Q.rowCount,command:Q.command},C.error=Z,C.duration=Math.ceil(fe[0]*1e3+fe[1]/1e6),T.channel.publish("postgres",C),Z){if(k)return k.apply(this,arguments);R&&R instanceof f.EventEmitter&&R.emit("error",Z)}else k&&k.apply(this,arguments)});try{return Object.defineProperty(G,_,{value:k}),G}catch(Z){return k}}a(D,"f");try{typeof b=="string"?y instanceof Array?(C.query.preparable={text:b,args:y},E=D(E)):(C.query.text=b,E?E=D(E):y=D(y)):(typeof b.name=="string"?C.query.plan=b.name:b.values instanceof Array?C.query.preparable={text:b.text,args:b.values}:C.query.text=b.text,E?E=D(E):y?y=D(y):b.callback=D(b.callback))}catch(k){return v.apply(this,arguments)}return arguments[0]=b,arguments[1]=y,arguments[2]=E,arguments.length=arguments.length>3?arguments.length:3,R=v.apply(this,arguments),R},u}a(w,"kC");function x(u,g){var v=u.Client.prototype.query,_="__diagnosticOriginalFunc";return u.Client.prototype.query=function(b,y,E){var C=this,A=!!E,R={query:{},database:{host:this.connectionParameters.host,port:this.connectionParameters.port},result:null,error:null,duration:0,time:new Date},D=process.hrtime(),k;function G(Z){Z&&Z[_]&&(Z=Z[_]);var Q=T.channel.bindToContext(function(fe,Se){var Me=process.hrtime(D);if(R.result=Se&&{rowCount:Se.rowCount,command:Se.command},R.error=fe,R.duration=Math.ceil(Me[0]*1e3+Me[1]/1e6),T.channel.publish("postgres",R),fe){if(Z)return Z.apply(this,arguments);k&&k instanceof f.EventEmitter&&k.emit("error",fe)}else Z&&Z.apply(this,arguments)});try{return Object.defineProperty(Q,_,{value:Z}),Q}catch(fe){return Z}}a(G,"_");try{typeof b=="string"?y instanceof Array?(R.query.preparable={text:b,args:y},A=typeof E=="function",E=A?G(E):E):(R.query.text=b,E?(A=typeof E=="function",E=A?G(E):E):(A=typeof y=="function",y=A?G(y):y)):(typeof b.name=="string"?R.query.plan=b.name:b.values instanceof Array?R.query.preparable={text:b.text,args:b.values}:R.query.text=b.text,E?(A=typeof E=="function",E=G(E)):y?(A=typeof y=="function",y=A?G(y):y):(A=typeof b.callback=="function",b.callback=A?G(b.callback):b.callback))}catch(Z){return v.apply(this,arguments)}return arguments[0]=b,arguments[1]=y,arguments[2]=E,arguments.length=arguments.length>3?arguments.length:3,k=v.apply(this,arguments),A?k:k.then(function(Z){return G()(void 0,Z),new C._Promise(function(Q,fe){Q(Z)})}).catch(function(Z){return G()(Z,void 0),new C._Promise(function(Q,fe){fe(Z)})})},u}a(x,"jC"),s.postgres6={versionSpecifier:"6.*",patch:w},s.postgres7={versionSpecifier:">=7.* <=8.*",patch:x};function p(){T.channel.registerMonkeyPatch("pg",s.postgres6),T.channel.registerMonkeyPatch("pg",s.postgres7)}a(p,"HC"),s.enable=p}),lc=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.enable=s.redis=void 0;var T=he(),f=a(function(x){var p=x.RedisClient.prototype.internal_send_command;return x.RedisClient.prototype.internal_send_command=function(u){if(u){var g=u.callback;if(!g||!g.pubsubBound){var v=this.address,_=process.hrtime(),b=new Date;u.callback=T.channel.bindToContext(function(y,E){var C=process.hrtime(_),A=C[0]*1e3+C[1]/1e6|0;T.channel.publish("redis",{duration:A,address:v,commandObj:u,err:y,result:E,time:b}),typeof g=="function"&&g.apply(this,arguments)}),u.callback.pubsubBound=!0}}return p.call(this,u)},x},"UC");s.redis={versionSpecifier:">= 2.0.0 < 4.0.0",patch:f};function w(){T.channel.registerMonkeyPatch("redis",s.redis)}a(w,"BC"),s.enable=w}),ss=F(s=>{"use strict";var T=s&&s.__assign||function(){return T=Object.assign||function(p){for(var u,g=1,v=arguments.length;g<v;g++){u=arguments[g];for(var _ in u)Object.prototype.hasOwnProperty.call(u,_)&&(p[_]=u[_])}return p},T.apply(this,arguments)};Object.defineProperty(s,"__esModule",{value:!0}),s.enable=s.tedious=void 0;var f=he(),w=a(function(p){var u=p.Connection.prototype.makeRequest;return p.Connection.prototype.makeRequest=function(){function g(_){var b=process.hrtime(),y={query:{},database:{host:null,port:null},result:null,error:null,duration:0};return f.channel.bindToContext(function(E,C,A){var R=process.hrtime(b);y=T(T({},y),{database:{host:this.connection.config.server,port:this.connection.config.options.port},result:!E&&{rowCount:C,rows:A},query:{text:this.parametersByName.statement.value},error:E,duration:Math.ceil(R[0]*1e3+R[1]/1e6)}),f.channel.publish("tedious",y),_.call(this,E,C,A)})}a(g,"n");var v=arguments[0];arguments[0].callback=g(v.callback),u.apply(this,arguments)},p},"GC");s.tedious={versionSpecifier:">= 6.0.0 < 9.0.0",patch:w};function x(){f.channel.registerMonkeyPatch("tedious",s.tedious)}a(x,"FC"),s.enable=x}),bi=F(s=>{"use strict";var T=s&&s.__extends||function(){var g=a(function(v,_){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,y){b.__proto__=y}||function(b,y){for(var E in y)Object.prototype.hasOwnProperty.call(y,E)&&(b[E]=y[E])},g(v,_)},"e");return function(v,_){g(v,_);function b(){this.constructor=v}a(b,"n"),v.prototype=_===null?Object.create(_):(b.prototype=_.prototype,new b)}}(),f=s&&s.__rest||function(g,v){var _={};for(var b in g)Object.prototype.hasOwnProperty.call(g,b)&&v.indexOf(b)<0&&(_[b]=g[b]);if(g!=null&&typeof Object.getOwnPropertySymbols=="function")for(var y=0,b=Object.getOwnPropertySymbols(g);y<b.length;y++)v.indexOf(b[y])<0&&Object.prototype.propertyIsEnumerable.call(g,b[y])&&(_[b[y]]=g[b[y]]);return _};Object.defineProperty(s,"__esModule",{value:!0}),s.enable=s.winston2=s.winston3=void 0;var w=he(),x=a(function(g){var v=g.Logger.prototype.log,_,b=a(function(y,E,C){var A;return _===g.config.npm.levels?A="npm":_===g.config.syslog.levels?A="syslog":A="unknown",w.channel.publish("winston",{level:y,message:E,meta:C,levelKind:A}),E},"n");return g.Logger.prototype.log=function(){return _=this.levels,!this.filters||this.filters.length===0?this.filters=[b]:this.filters[this.filters.length-1]!==b&&(this.filters=this.filters.filter(function(y){return y!==b}),this.filters.push(b)),v.apply(this,arguments)},g},"zC"),p=a(function(g){var v=a(function(C,A){var R;return C.config.npm.levels[A]!=null?R="npm":C.config.syslog.levels[A]!=null?R="syslog":R="unknown",R},"t"),_=function(C){T(A,C);function A(R,D){var k=C.call(this,D)||this;return k.winston=R,k}return a(A,"o"),A.prototype.log=function(R,D){var k=R.message,G=R.level,Z=R.meta,Q=f(R,["message","level","meta"]);G=typeof Symbol.for=="function"?R[Symbol.for("level")]:G,k=R instanceof Error?R:k;var fe=v(this.winston,G);Z=Z||{};for(var Se in Q)Q.hasOwnProperty(Se)&&(Z[Se]=Q[Se]);w.channel.publish("winston",{message:k,level:G,levelKind:fe,meta:Z}),D()},A}(g.Transport);function b(){var C=arguments[0].levels||g.config.npm.levels,A;for(var R in C)C.hasOwnProperty(R)&&(A=A===void 0||C[R]>C[A]?R:A);this.add(new _(g,{level:A}))}a(b,"n");var y=g.createLogger;g.createLogger=function(){var C=arguments[0].levels||g.config.npm.levels,A;for(var R in C)C.hasOwnProperty(R)&&(A=A===void 0||C[R]>C[A]?R:A);var D=y.apply(this,arguments);D.add(new _(g,{level:A}));var k=D.configure;return D.configure=function(){k.apply(this,arguments),b.apply(this,arguments)},D};var E=g.configure;return g.configure=function(){E.apply(this,arguments),b.apply(this,arguments)},g.add(new _(g)),g},"KC");s.winston3={versionSpecifier:"3.x",patch:p},s.winston2={versionSpecifier:"2.x",patch:x};function u(){w.channel.registerMonkeyPatch("winston",s.winston2),w.channel.registerMonkeyPatch("winston",s.winston3)}a(u,"XC"),s.enable=u}),cs=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.enable=s.tedious=s.pgPool=s.pg=s.winston=s.redis=s.mysql=s.mongodb=s.mongodbCore=s.console=s.bunyan=s.azuresdk=void 0;var T=Xn();s.azuresdk=T;var f=ha();s.bunyan=f;var w=wi();s.console=w;var x=Ro();s.mongodbCore=x;var p=as();s.mongodb=p;var u=Io();s.mysql=u;var g=fa();s.pgPool=g;var v=cc();s.pg=v;var _=lc();s.redis=_;var b=ss();s.tedious=b;var y=bi();s.winston=y;function E(){f.enable(),w.enable(),x.enable(),p.enable(),u.enable(),v.enable(),g.enable(),_.enable(),y.enable(),T.enable(),b.enable()}a(E,"YC"),s.enable=E}),Oo=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.registerContextPreservation=s.IsInitialized=void 0;var T=we(),f=at();s.IsInitialized=!process.env.APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL;var w="DiagnosticChannel";if(s.IsInitialized){x=cs(),p=process.env.APPLICATION_INSIGHTS_NO_PATCH_MODULES||"",u=p.split(","),g={bunyan:x.bunyan,console:x.console,mongodb:x.mongodb,mongodbCore:x.mongodbCore,mysql:x.mysql,redis:x.redis,pg:x.pg,pgPool:x.pgPool,winston:x.winston,azuresdk:x.azuresdk};for(v in g)u.indexOf(v)===-1&&(g[v].enable(),f.info(w,"Subscribed to "+v+" events"));u.length>0&&f.info(w,"Some modules will not be patched",u)}else f.info(w,"Not subscribing to dependency autocollection because APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL was set");var x,p,u,g,v;function _(b){if(s.IsInitialized){var y=he();y.channel.addContextPreservation(b),y.channel.spanContextPropagator=T.AsyncScopeManager}}a(_,"WC"),s.registerContextPreservation=_}),Po=F((s,T)=>{"use strict";T.exports={requestContextHeader:"request-context",requestContextSourceKey:"appId",requestContextTargetKey:"appId",requestIdHeader:"request-id",parentIdHeader:"x-ms-request-id",rootIdHeader:"x-ms-request-root-id",correlationContextHeader:"correlation-context",traceparentHeader:"traceparent",traceStateHeader:"tracestate"}}),fn=F((s,T)=>{"use strict";var f=s&&s.__assign||function(){return f=Object.assign||function(b){for(var y,E=1,C=arguments.length;E<C;E++){y=arguments[E];for(var A in y)Object.prototype.hasOwnProperty.call(y,A)&&(b[A]=y[A])}return b},f.apply(this,arguments)},w=K(3685),x=K(5687),p=K(7310),u=K(2057),g=at(),v=Po(),_=function(){function b(){}return a(b,"e"),b.getCookie=function(y,E){var C="";if(y&&y.length&&typeof E=="string")for(var A=y+"=",R=E.split(";"),D=0;D<R.length;D++){var E=R[D];if(E=b.trim(E),E&&E.indexOf(A)===0){C=E.substring(A.length,R[D].length);break}}return C},b.trim=function(y){return typeof y=="string"?y.replace(/^\s+|\s+$/g,""):""},b.int32ArrayToBase64=function(y){var E=a(function(k,G){return String.fromCharCode(k>>G&255)},"r"),C=a(function(k){return E(k,24)+E(k,16)+E(k,8)+E(k,0)},"n"),A=y.map(C).join(""),R=Buffer.from?Buffer.from(A,"binary"):new Buffer(A,"binary"),D=R.toString("base64");return D.substr(0,D.indexOf("="))},b.random32=function(){return 4294967296*Math.random()|0},b.randomu32=function(){return b.random32()+2147483648},b.w3cTraceId=function(){for(var y=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],E="",C,A=0;A<4;A++)C=b.random32(),E+=y[C&15]+y[C>>4&15]+y[C>>8&15]+y[C>>12&15]+y[C>>16&15]+y[C>>20&15]+y[C>>24&15]+y[C>>28&15];var R=y[8+Math.random()*4|0];return E.substr(0,8)+E.substr(9,4)+"4"+E.substr(13,3)+R+E.substr(16,3)+E.substr(19,12)},b.w3cSpanId=function(){return b.w3cTraceId().substring(16)},b.isValidW3CId=function(y){return y.length===32&&y!=="00000000000000000000000000000000"},b.isArray=function(y){return Object.prototype.toString.call(y)==="[object Array]"},b.isError=function(y){return y instanceof Error},b.isPrimitive=function(y){var E=typeof y;return E==="string"||E==="number"||E==="boolean"},b.isDate=function(y){return Object.prototype.toString.call(y)==="[object Date]"},b.msToTimeSpan=function(y){(isNaN(y)||y<0)&&(y=0);var E=(y/1e3%60).toFixed(7).replace(/0{0,4}$/,""),C=""+Math.floor(y/(1e3*60))%60,A=""+Math.floor(y/(1e3*60*60))%24,R=Math.floor(y/(1e3*60*60*24));E=E.indexOf(".")<2?"0"+E:E,C=C.length<2?"0"+C:C,A=A.length<2?"0"+A:A;var D=R>0?R+".":"";return D+A+":"+C+":"+E},b.extractError=function(y){var E=y;return{message:y.message,code:E.code||E.id||""}},b.extractObject=function(y){return y instanceof Error?b.extractError(y):typeof y.toJSON=="function"?y.toJSON():y},b.validateStringMap=function(y){if(typeof y!="object"){g.info("Invalid properties dropped from payload");return}var E={};for(var C in y){var A="",R=y[C],D=typeof R;if(b.isPrimitive(R))A=R.toString();else if(R===null||D==="undefined")A="";else if(D==="function"){g.info("key: "+C+" was function; will not serialize");continue}else{var k=b.isArray(R)?R:b.extractObject(R);try{b.isPrimitive(k)?A=k:A=JSON.stringify(k)}catch(G){A=R.constructor.name.toString()+" (Error: "+G.message+")",g.info("key: "+C+", could not be serialized")}}E[C]=A.substring(0,b.MAX_PROPERTY_LENGTH)}return E},b.canIncludeCorrelationHeader=function(y,E){var C=y&&y.config&&y.config.correlationHeaderExcludedDomains;if(!C||C.length==0||!E)return!0;for(var A=0;A<C.length;A++){var R=new RegExp(C[A].replace(/\./g,".").replace(/\*/g,".*"));if(R.test(p.parse(E).hostname))return!1}return!0},b.getCorrelationContextTarget=function(y,E){var C=y.headers&&y.headers[v.requestContextHeader];if(C)for(var A=C.split(","),R=0;R<A.length;++R){var D=A[R].split("=");if(D.length==2&&D[0]==E)return D[1]}},b.makeRequest=function(y,E,C,A){E&&E.indexOf("//")===0&&(E="https:"+E);var R=p.parse(E),D=f(f({},C),{host:R.hostname,port:R.port,path:R.pathname}),k=void 0;if(R.protocol==="https:"&&(k=y.proxyHttpsUrl||void 0),R.protocol==="http:"&&(k=y.proxyHttpUrl||void 0),k){k.indexOf("//")===0&&(k="http:"+k);var G=p.parse(k);G.protocol==="https:"?(g.info("Proxies that use HTTPS are not supported"),k=void 0):D=f(f({},D),{host:G.hostname,port:G.port||"80",path:E,headers:f(f({},D.headers),{Host:R.hostname})})}var Z=R.protocol==="https:"&&!k;return Z&&y.httpsAgent!==void 0?D.agent=y.httpsAgent:!Z&&y.httpAgent!==void 0?D.agent=y.httpAgent:Z&&(D.agent=b.tlsRestrictedAgent),Z?x.request(D,A):w.request(D,A)},b.safeIncludeCorrelationHeader=function(y,E,C){var A;if(typeof C=="string")A=C;else if(C instanceof Array)A=C.join(",");else if(C&&typeof C.toString=="function")try{A=C.toString()}catch(R){g.warn("Outgoing request-context header could not be read. Correlation of requests may be lost.",R,C)}A?b.addCorrelationIdHeaderFromString(y,E,A):E.setHeader(v.requestContextHeader,v.requestContextSourceKey+"="+y.config.correlationId)},b.dumpObj=function(y){var E=Object.prototype.toString.call(y),C="";return E==="[object Error]"?C="{ stack: '"+y.stack+"', message: '"+y.message+"', name: '"+y.name+"'":C=JSON.stringify(y),E+C},b.addCorrelationIdHeaderFromString=function(y,E,C){var A=C.split(","),R=v.requestContextSourceKey+"=",D=A.some(function(k){return k.substring(0,R.length)===R});D||E.setHeader(v.requestContextHeader,C+","+v.requestContextSourceKey+"="+y.config.correlationId)},b.MAX_PROPERTY_LENGTH=8192,b.tlsRestrictedAgent=new x.Agent({keepAlive:!0,maxSockets:25,secureOptions:u.SSL_OP_NO_SSLv2|u.SSL_OP_NO_SSLv3|u.SSL_OP_NO_TLSv1|u.SSL_OP_NO_TLSv1_1}),b}();T.exports=_}),J=F((s,T)=>{"use strict";var f=fn(),w=at(),x=function(){function p(){}return a(p,"e"),p.queryCorrelationId=function(u,g){var v=u.profileQueryEndpoint+"/api/profiles/"+u.instrumentationKey+"/appId";if(p.completedLookups.hasOwnProperty(v)){g(p.completedLookups[v]);return}else if(p.pendingLookups[v]){p.pendingLookups[v].push(g);return}p.pendingLookups[v]=[g];var _=a(function(){if(p.pendingLookups[v]){var b={method:"GET",disableAppInsightsAutoCollection:!0};w.info(p.TAG,b);var y=f.makeRequest(u,v,b,function(E){if(E.statusCode===200){var C="";E.setEncoding("utf-8"),E.on("data",function(A){C+=A}),E.on("end",function(){w.info(p.TAG,C);var A=p.correlationIdPrefix+C;p.completedLookups[v]=A,p.pendingLookups[v]&&p.pendingLookups[v].forEach(function(R){return R(A)}),delete p.pendingLookups[v]})}else E.statusCode>=400&&E.statusCode<500?(p.completedLookups[v]=void 0,delete p.pendingLookups[v]):setTimeout(_,u.correlationIdRetryIntervalMs)});y&&(y.on("error",function(E){w.warn(p.TAG,E)}),y.end())}},"i");setTimeout(_,0)},p.cancelCorrelationIdQuery=function(u,g){var v=u.profileQueryEndpoint+"/api/profiles/"+u.instrumentationKey+"/appId",_=p.pendingLookups[v];_&&(p.pendingLookups[v]=_.filter(function(b){return b!=g}),p.pendingLookups[v].length==0&&delete p.pendingLookups[v])},p.generateRequestId=function(u){if(u){u=u[0]=="|"?u:"|"+u,u[u.length-1]!=="."&&(u+=".");var g=(p.currentRootId++).toString(16);return p.appendSuffix(u,g,"_")}else return p.generateRootId()},p.getRootId=function(u){var g=u.indexOf(".");g<0&&(g=u.length);var v=u[0]==="|"?1:0;return u.substring(v,g)},p.generateRootId=function(){return"|"+f.w3cTraceId()+"."},p.appendSuffix=function(u,g,v){if(u.length+g.length<p.requestIdMaxLength)return u+g+v;var _=p.requestIdMaxLength-9;if(u.length>_)for(;_>1;--_){var b=u[_-1];if(b==="."||b==="_")break}if(_<=1)return p.generateRootId();for(g=f.randomu32().toString(16);g.length<8;)g="0"+g;return u.substring(0,_)+g+"#"},p.TAG="CorrelationIdManager",p.correlationIdPrefix="cid-v1:",p.w3cEnabled=!0,p.pendingLookups={},p.completedLookups={},p.requestIdMaxLength=1024,p.currentRootId=f.randomu32(),p}();T.exports=x}),_e=F((s,T)=>{"use strict";var f=fn(),w=J(),x=function(){function p(u,g){if(this.traceFlag=p.DEFAULT_TRACE_FLAG,this.version=p.DEFAULT_VERSION,u&&typeof u=="string")if(u.split(",").length>1)this.traceId=f.w3cTraceId(),this.spanId=f.w3cTraceId().substr(0,16);else{var v=u.trim().split("-"),_=v.length;_>=4?(this.version=v[0],this.traceId=v[1],this.spanId=v[2],this.traceFlag=v[3]):(this.traceId=f.w3cTraceId(),this.spanId=f.w3cTraceId().substr(0,16)),this.version.match(/^[0-9a-f]{2}$/g)||(this.version=p.DEFAULT_VERSION,this.traceId=f.w3cTraceId()),this.version==="00"&&_!==4&&(this.traceId=f.w3cTraceId(),this.spanId=f.w3cTraceId().substr(0,16)),this.version==="ff"&&(this.version=p.DEFAULT_VERSION,this.traceId=f.w3cTraceId(),this.spanId=f.w3cTraceId().substr(0,16)),this.version.match(/^0[0-9a-f]$/g)||(this.version=p.DEFAULT_VERSION),this.traceFlag.match(/^[0-9a-f]{2}$/g)||(this.traceFlag=p.DEFAULT_TRACE_FLAG,this.traceId=f.w3cTraceId()),p.isValidTraceId(this.traceId)||(this.traceId=f.w3cTraceId()),p.isValidSpanId(this.spanId)||(this.spanId=f.w3cTraceId().substr(0,16),this.traceId=f.w3cTraceId()),this.parentId=this.getBackCompatRequestId()}else if(g){this.parentId=g.slice();var b=w.getRootId(g);p.isValidTraceId(b)||(this.legacyRootId=b,b=f.w3cTraceId()),g.indexOf("|")!==-1&&(g=g.substring(1+g.substring(0,g.length-1).lastIndexOf("."),g.length-1)),this.traceId=b,this.spanId=g}else this.traceId=f.w3cTraceId(),this.spanId=f.w3cTraceId().substr(0,16)}return a(p,"e"),p.isValidTraceId=function(u){return u.match(/^[0-9a-f]{32}$/)&&u!=="00000000000000000000000000000000"},p.isValidSpanId=function(u){return u.match(/^[0-9a-f]{16}$/)&&u!=="0000000000000000"},p.formatOpenTelemetryTraceFlags=function(u){var g="0"+u.toString(16);return g.substring(g.length-2)},p.prototype.getBackCompatRequestId=function(){return"|"+this.traceId+"."+this.spanId+"."},p.prototype.toString=function(){return this.version+"-"+this.traceId+"-"+this.spanId+"-"+this.traceFlag},p.prototype.updateSpanId=function(){this.spanId=f.w3cTraceId().substr(0,16)},p.DEFAULT_TRACE_FLAG="01",p.DEFAULT_VERSION="00",p}();T.exports=x}),Ge=F((s,T)=>{"use strict";var f=function(){function w(x){this.fieldmap=[],!!x&&(this.fieldmap=this.parseHeader(x))}return a(w,"e"),w.prototype.toString=function(){var x=this.fieldmap;return!x||x.length==0?null:x.join(", ")},w.validateKeyChars=function(x){var p=x.split("@");if(p.length==2){var u=p[0].trim(),g=p[1].trim(),v=Boolean(u.match(/^[\ ]?[a-z0-9\*\-\_/]{1,241}$/)),_=Boolean(g.match(/^[\ ]?[a-z0-9\*\-\_/]{1,14}$/));return v&&_}else if(p.length==1)return Boolean(x.match(/^[\ ]?[a-z0-9\*\-\_/]{1,256}$/));return!1},w.prototype.parseHeader=function(x){var p=[],u={},g=x.split(",");if(g.length>32)return null;for(var v=0,_=g;v<_.length;v++){var b=_[v],y=b.trim();if(y.length!==0){var E=y.split("=");if(E.length!==2||!w.validateKeyChars(E[0])||u[E[0]])return null;u[E[0]]=!0,p.push(y)}}return p},w.strict=!0,w}();T.exports=f}),gt=F((s,T)=>{"use strict";var f=function(){function w(){}return a(w,"e"),w}();T.exports=f}),dr=F((s,T)=>{"use strict";var f=s&&s.__extends||function(){var p=a(function(u,g){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,_){v.__proto__=_}||function(v,_){for(var b in _)Object.prototype.hasOwnProperty.call(_,b)&&(v[b]=_[b])},p(u,g)},"e");return function(u,g){p(u,g);function v(){this.constructor=u}a(v,"n"),u.prototype=g===null?Object.create(g):(v.prototype=g.prototype,new v)}}(),w=gt(),x=function(p){f(u,p);function u(){var g=p.call(this)||this;return g.ver=2,g.properties={},g.measurements={},g}return a(u,"t"),u}(w);T.exports=x}),Ft=F((s,T)=>{"use strict";var f=function(){function w(){}return a(w,"e"),w}();T.exports=f}),yr=F((s,T)=>{"use strict";var f=function(){function w(){this.applicationVersion="ai.application.ver",this.deviceId="ai.device.id",this.deviceLocale="ai.device.locale",this.deviceModel="ai.device.model",this.deviceOEMName="ai.device.oemName",this.deviceOSVersion="ai.device.osVersion",this.deviceType="ai.device.type",this.locationIp="ai.location.ip",this.operationId="ai.operation.id",this.operationName="ai.operation.name",this.operationParentId="ai.operation.parentId",this.operationSyntheticSource="ai.operation.syntheticSource",this.operationCorrelationVector="ai.operation.correlationVector",this.sessionId="ai.session.id",this.sessionIsFirst="ai.session.isFirst",this.userAccountId="ai.user.accountId",this.userId="ai.user.id",this.userAuthUserId="ai.user.authUserId",this.cloudRole="ai.cloud.role",this.cloudRoleInstance="ai.cloud.roleInstance",this.internalSdkVersion="ai.internal.sdkVersion",this.internalAgentVersion="ai.internal.agentVersion",this.internalNodeName="ai.internal.nodeName"}return a(w,"e"),w}();T.exports=f}),Ar=F((s,T)=>{"use strict";var f=s&&s.__extends||function(){var p=a(function(u,g){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,_){v.__proto__=_}||function(v,_){for(var b in _)Object.prototype.hasOwnProperty.call(_,b)&&(v[b]=_[b])},p(u,g)},"e");return function(u,g){p(u,g);function v(){this.constructor=u}a(v,"n"),u.prototype=g===null?Object.create(g):(v.prototype=g.prototype,new v)}}(),w=Ft(),x=function(p){f(u,p);function u(){return p.call(this)||this}return a(u,"t"),u}(w);T.exports=x}),Rr=F((s,T)=>{"use strict";var f;(function(w){w[w.Measurement=0]="Measurement",w[w.Aggregation=1]="Aggregation"})(f||(f={})),T.exports=f}),hr=F((s,T)=>{"use strict";var f=Rr(),w=function(){function x(){this.kind=f.Measurement}return a(x,"e"),x}();T.exports=w}),an=F((s,T)=>{"use strict";var f=function(){function w(){this.ver=1,this.sampleRate=100,this.tags={}}return a(w,"e"),w}();T.exports=f}),pn=F((s,T)=>{"use strict";var f=s&&s.__extends||function(){var p=a(function(u,g){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,_){v.__proto__=_}||function(v,_){for(var b in _)Object.prototype.hasOwnProperty.call(_,b)&&(v[b]=_[b])},p(u,g)},"e");return function(u,g){p(u,g);function v(){this.constructor=u}a(v,"n"),u.prototype=g===null?Object.create(g):(v.prototype=g.prototype,new v)}}(),w=gt(),x=function(p){f(u,p);function u(){var g=p.call(this)||this;return g.ver=2,g.properties={},g.measurements={},g}return a(u,"t"),u}(w);T.exports=x}),Lr=F((s,T)=>{"use strict";var f=s&&s.__extends||function(){var p=a(function(u,g){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,_){v.__proto__=_}||function(v,_){for(var b in _)Object.prototype.hasOwnProperty.call(_,b)&&(v[b]=_[b])},p(u,g)},"e");return function(u,g){p(u,g);function v(){this.constructor=u}a(v,"n"),u.prototype=g===null?Object.create(g):(v.prototype=g.prototype,new v)}}(),w=gt(),x=function(p){f(u,p);function u(){var g=p.call(this)||this;return g.ver=2,g.exceptions=[],g.properties={},g.measurements={},g}return a(u,"t"),u}(w);T.exports=x}),tr=F((s,T)=>{"use strict";var f=function(){function w(){this.hasFullStack=!0,this.parsedStack=[]}return a(w,"e"),w}();T.exports=f}),Kr=F((s,T)=>{"use strict";var f=s&&s.__extends||function(){var p=a(function(u,g){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,_){v.__proto__=_}||function(v,_){for(var b in _)Object.prototype.hasOwnProperty.call(_,b)&&(v[b]=_[b])},p(u,g)},"e");return function(u,g){p(u,g);function v(){this.constructor=u}a(v,"n"),u.prototype=g===null?Object.create(g):(v.prototype=g.prototype,new v)}}(),w=gt(),x=function(p){f(u,p);function u(){var g=p.call(this)||this;return g.ver=2,g.properties={},g}return a(u,"t"),u}(w);T.exports=x}),Qn=F((s,T)=>{"use strict";var f=s&&s.__extends||function(){var p=a(function(u,g){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,_){v.__proto__=_}||function(v,_){for(var b in _)Object.prototype.hasOwnProperty.call(_,b)&&(v[b]=_[b])},p(u,g)},"e");return function(u,g){p(u,g);function v(){this.constructor=u}a(v,"n"),u.prototype=g===null?Object.create(g):(v.prototype=g.prototype,new v)}}(),w=gt(),x=function(p){f(u,p);function u(){var g=p.call(this)||this;return g.ver=2,g.metrics=[],g.properties={},g}return a(u,"t"),u}(w);T.exports=x}),In=F((s,T)=>{"use strict";var f=s&&s.__extends||function(){var p=a(function(u,g){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,_){v.__proto__=_}||function(v,_){for(var b in _)Object.prototype.hasOwnProperty.call(_,b)&&(v[b]=_[b])},p(u,g)},"e");return function(u,g){p(u,g);function v(){this.constructor=u}a(v,"n"),u.prototype=g===null?Object.create(g):(v.prototype=g.prototype,new v)}}(),w=pn(),x=function(p){f(u,p);function u(){var g=p.call(this)||this;return g.ver=2,g.properties={},g.measurements={},g}return a(u,"t"),u}(w);T.exports=x}),Sn=F((s,T)=>{"use strict";var f=s&&s.__extends||function(){var p=a(function(u,g){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,_){v.__proto__=_}||function(v,_){for(var b in _)Object.prototype.hasOwnProperty.call(_,b)&&(v[b]=_[b])},p(u,g)},"e");return function(u,g){p(u,g);function v(){this.constructor=u}a(v,"n"),u.prototype=g===null?Object.create(g):(v.prototype=g.prototype,new v)}}(),w=gt(),x=function(p){f(u,p);function u(){var g=p.call(this)||this;return g.ver=2,g.success=!0,g.properties={},g.measurements={},g}return a(u,"t"),u}(w);T.exports=x}),pa=F((s,T)=>{"use strict";var f=s&&s.__extends||function(){var p=a(function(u,g){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,_){v.__proto__=_}||function(v,_){for(var b in _)Object.prototype.hasOwnProperty.call(_,b)&&(v[b]=_[b])},p(u,g)},"e");return function(u,g){p(u,g);function v(){this.constructor=u}a(v,"n"),u.prototype=g===null?Object.create(g):(v.prototype=g.prototype,new v)}}(),w=gt(),x=function(p){f(u,p);function u(){var g=p.call(this)||this;return g.ver=2,g.properties={},g.measurements={},g}return a(u,"t"),u}(w);T.exports=x}),Yn=F((s,T)=>{"use strict";var f;(function(w){w[w.Verbose=0]="Verbose",w[w.Information=1]="Information",w[w.Warning=2]="Warning",w[w.Error=3]="Error",w[w.Critical=4]="Critical"})(f||(f={})),T.exports=f}),Do=F((s,T)=>{"use strict";var f=function(){function w(){}return a(w,"e"),w}();T.exports=f}),yl=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.AvailabilityData=dr(),s.Base=Ft(),s.ContextTagKeys=yr(),s.Data=Ar(),s.DataPoint=hr(),s.DataPointType=Rr(),s.Domain=gt(),s.Envelope=an(),s.EventData=pn(),s.ExceptionData=Lr(),s.ExceptionDetails=tr(),s.MessageData=Kr(),s.MetricData=Qn(),s.PageViewData=In(),s.RemoteDependencyData=Sn(),s.RequestData=pa(),s.SeverityLevel=Yn(),s.StackFrame=Do()}),Su=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.domainSupportsProperties=s.RemoteDependencyDataConstants=void 0;var T=yl(),f=function(){function x(){}return a(x,"e"),x.TYPE_HTTP="Http",x.TYPE_AI="Http (tracked component)",x}();s.RemoteDependencyDataConstants=f;function w(x){return"properties"in x||x instanceof T.EventData||x instanceof T.ExceptionData||x instanceof T.MessageData||x instanceof T.MetricData||x instanceof T.PageViewData||x instanceof T.RemoteDependencyData||x instanceof T.RequestData}a(w,"UO"),s.domainSupportsProperties=w}),On=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),Eu=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),_l=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),Zn=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),xu=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),Dt=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),Cu=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),ga=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),ko=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),ma=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),wl=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),Tu=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),Au=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.TelemetryType=s.TelemetryTypeString=s.baseTypeToTelemetryType=s.telemetryTypeToBaseType=void 0;function T(x){switch(x){case w.Event:return"EventData";case w.Exception:return"ExceptionData";case w.Trace:return"MessageData";case w.Metric:return"MetricData";case w.Request:return"RequestData";case w.Dependency:return"RemoteDependencyData";case w.Availability:return"AvailabilityData";case w.PageView:return"PageViewData"}}a(T,"BO"),s.telemetryTypeToBaseType=T;function f(x){switch(x){case"EventData":return w.Event;case"ExceptionData":return w.Exception;case"MessageData":return w.Trace;case"MetricData":return w.Metric;case"RequestData":return w.Request;case"RemoteDependencyData":return w.Dependency;case"AvailabilityData":return w.Availability;case"PageViewData":return w.PageView}}a(f,"GO"),s.baseTypeToTelemetryType=f,s.TelemetryTypeString={Event:"EventData",Exception:"ExceptionData",Trace:"MessageData",Metric:"MetricData",Request:"RequestData",Dependency:"RemoteDependencyData",Availability:"AvailabilityData",PageView:"PageViewData"};var w;(function(x){x[x.Event=0]="Event",x[x.Exception=1]="Exception",x[x.Trace=2]="Trace",x[x.Metric=3]="Metric",x[x.Request=4]="Request",x[x.Dependency=5]="Dependency",x[x.Availability=6]="Availability",x[x.PageView=7]="PageView"})(w=s.TelemetryType||(s.TelemetryType={}))}),Ru=F(s=>{"use strict";var T=s&&s.__createBinding||(Object.create?function(w,x,p,u){u===void 0&&(u=p),Object.defineProperty(w,u,{enumerable:!0,get:function(){return x[p]}})}:function(w,x,p,u){u===void 0&&(u=p),w[u]=x[p]}),f=s&&s.__exportStar||function(w,x){for(var p in w)p!=="default"&&!Object.prototype.hasOwnProperty.call(x,p)&&T(x,w,p)};Object.defineProperty(s,"__esModule",{value:!0}),f(On(),s),f(Eu(),s),f(_l(),s),f(Zn(),s),f(xu(),s),f(Dt(),s),f(Cu(),s),f(ga(),s),f(ko(),s),f(ma(),s),f(wl(),s),f(Tu(),s),f(Au(),s)}),Iu=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),uc=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),va=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),Ou=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),Pu=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),ls=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),$n=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),dc=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),Du=F(s=>{"use strict";var T=s&&s.__createBinding||(Object.create?function(w,x,p,u){u===void 0&&(u=p),Object.defineProperty(w,u,{enumerable:!0,get:function(){return x[p]}})}:function(w,x,p,u){u===void 0&&(u=p),w[u]=x[p]}),f=s&&s.__exportStar||function(w,x){for(var p in w)p!=="default"&&!Object.prototype.hasOwnProperty.call(x,p)&&T(x,w,p)};Object.defineProperty(s,"__esModule",{value:!0}),f(Iu(),s),f(uc(),s),f(va(),s),f(Ou(),s),f(Pu(),s),f(ls(),s),f($n(),s),f(dc(),s)}),$t=F(s=>{"use strict";var T=s&&s.__createBinding||(Object.create?function(w,x,p,u){u===void 0&&(u=p),Object.defineProperty(w,u,{enumerable:!0,get:function(){return x[p]}})}:function(w,x,p,u){u===void 0&&(u=p),w[u]=x[p]}),f=s&&s.__exportStar||function(w,x){for(var p in w)p!=="default"&&!Object.prototype.hasOwnProperty.call(x,p)&&T(x,w,p)};Object.defineProperty(s,"__esModule",{value:!0}),f(Su(),s),f(yl(),s),f(Ru(),s),f(Du(),s)}),bl=F((s,T)=>{"use strict";var f=function(){function w(){}return a(w,"e"),w.prototype.getUrl=function(){return this.url},w.prototype.RequestParser=function(){this.startTime=+new Date},w.prototype._setStatus=function(x,p){var u=+new Date;this.duration=u-this.startTime,this.statusCode=x;var g=this.properties||{};if(p){if(typeof p=="string")g.error=p;else if(p instanceof Error)g.error=p.message;else if(typeof p=="object")for(var v in p)g[v]=p[v]&&p[v].toString&&p[v].toString()}this.properties=g},w.prototype._isSuccess=function(){return 0<this.statusCode&&this.statusCode<400},w}();T.exports=f}),Sl=F((s,T)=>{"use strict";var f=s&&s.__extends||function(){var E=a(function(C,A){return E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(R,D){R.__proto__=D}||function(R,D){for(var k in D)Object.prototype.hasOwnProperty.call(D,k)&&(R[k]=D[k])},E(C,A)},"e");return function(C,A){E(C,A);function R(){this.constructor=C}a(R,"n"),C.prototype=A===null?Object.create(A):(R.prototype=A.prototype,new R)}}(),w=K(7310),x=$t(),p=fn(),u=Po(),g=bl(),v=J(),_=Ge(),b=_e(),y=function(E){f(C,E);function C(A,R){var D=E.call(this)||this;return A&&(D.method=A.method,D.url=D._getAbsoluteUrl(A),D.startTime=+new Date,D.socketRemoteAddress=A.socket&&A.socket.remoteAddress,D.parseHeaders(A,R),A.connection&&(D.connectionRemoteAddress=A.connection.remoteAddress,D.legacySocketRemoteAddress=A.connection.socket&&A.connection.socket.remoteAddress)),D}return a(C,"t"),C.prototype.onError=function(A,R){this._setStatus(void 0,A),R&&(this.duration=R)},C.prototype.onResponse=function(A,R){this._setStatus(A.statusCode,void 0),R&&(this.duration=R)},C.prototype.getRequestTelemetry=function(A){var R={id:this.requestId,name:this.method+" "+w.parse(this.url).pathname,url:this.url,source:this.sourceCorrelationId,duration:this.duration,resultCode:this.statusCode?this.statusCode.toString():null,success:this._isSuccess(),properties:this.properties};if(A&&A.time?R.time=A.time:this.startTime&&(R.time=new Date(this.startTime)),A){for(var D in A)R[D]||(R[D]=A[D]);if(A.properties)for(var D in A.properties)R.properties[D]=A.properties[D]}return R},C.prototype.getRequestTags=function(A){var R={};for(var D in A)R[D]=A[D];return R[C.keys.locationIp]=A[C.keys.locationIp]||this._getIp(),R[C.keys.sessionId]=A[C.keys.sessionId]||this._getId("ai_session"),R[C.keys.userId]=A[C.keys.userId]||this._getId("ai_user"),R[C.keys.userAuthUserId]=A[C.keys.userAuthUserId]||this._getId("ai_authUser"),R[C.keys.operationName]=this.getOperationName(A),R[C.keys.operationParentId]=this.getOperationParentId(A),R[C.keys.operationId]=this.getOperationId(A),R},C.prototype.getOperationId=function(A){return A[C.keys.operationId]||this.operationId},C.prototype.getOperationParentId=function(A){return A[C.keys.operationParentId]||this.parentId||this.getOperationId(A)},C.prototype.getOperationName=function(A){return A[C.keys.operationName]||this.method+" "+w.parse(this.url).pathname},C.prototype.getRequestId=function(){return this.requestId},C.prototype.getCorrelationContextHeader=function(){return this.correlationContextHeader},C.prototype.getTraceparent=function(){return this.traceparent},C.prototype.getTracestate=function(){return this.tracestate},C.prototype.getLegacyRootId=function(){return this.legacyRootId},C.prototype._getAbsoluteUrl=function(A){if(!A.headers)return A.url;var R=A.connection?A.connection.encrypted:null,D=w.parse(A.url),k=D.pathname,G=D.search,Z=R||A.headers["x-forwarded-proto"]=="https"?"https":"http",Q=w.format({protocol:Z,host:A.headers.host,pathname:k,search:G});return Q},C.prototype._getIp=function(){var A=/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/,R=a(function(k){var G=A.exec(k);if(G)return G[0]},"n"),D=R(this.rawHeaders["x-forwarded-for"])||R(this.rawHeaders["x-client-ip"])||R(this.rawHeaders["x-real-ip"])||R(this.connectionRemoteAddress)||R(this.socketRemoteAddress)||R(this.legacySocketRemoteAddress);return!D&&this.connectionRemoteAddress&&this.connectionRemoteAddress.substr&&this.connectionRemoteAddress.substr(0,2)==="::"&&(D="127.0.0.1"),D},C.prototype._getId=function(A){var R=this.rawHeaders&&this.rawHeaders.cookie&&typeof this.rawHeaders.cookie=="string"&&this.rawHeaders.cookie||"",D=C.parseId(p.getCookie(A,R));return D},C.prototype.setBackCompatFromThisTraceContext=function(){this.operationId=this.traceparent.traceId,this.traceparent.legacyRootId&&(this.legacyRootId=this.traceparent.legacyRootId),this.parentId=this.traceparent.parentId,this.traceparent.updateSpanId(),this.requestId=this.traceparent.getBackCompatRequestId()},C.prototype.parseHeaders=function(A,R){if(this.rawHeaders=A.headers||A.rawHeaders,this.userAgent=A.headers&&A.headers["user-agent"],this.sourceCorrelationId=p.getCorrelationContextTarget(A,u.requestContextSourceKey),A.headers){var D=A.headers[u.traceStateHeader]?A.headers[u.traceStateHeader].toString():null,k=A.headers[u.traceparentHeader]?A.headers[u.traceparentHeader].toString():null,G=A.headers[u.requestIdHeader]?A.headers[u.requestIdHeader].toString():null,Z=A.headers[u.parentIdHeader]?A.headers[u.parentIdHeader].toString():null,Q=A.headers[u.rootIdHeader]?A.headers[u.rootIdHeader].toString():null;this.correlationContextHeader=A.headers[u.correlationContextHeader]?A.headers[u.correlationContextHeader].toString():null,v.w3cEnabled&&(k||D)?(this.traceparent=new b(k?k.toString():null),this.tracestate=k&&D&&new _(D?D.toString():null),this.setBackCompatFromThisTraceContext()):G?v.w3cEnabled?(this.traceparent=new b(null,G),this.setBackCompatFromThisTraceContext()):(this.parentId=G,this.requestId=v.generateRequestId(this.parentId),this.operationId=v.getRootId(this.requestId)):v.w3cEnabled?(this.traceparent=new b,this.traceparent.parentId=Z,this.traceparent.legacyRootId=Q||Z,this.setBackCompatFromThisTraceContext()):(this.parentId=Z,this.requestId=v.generateRequestId(Q||this.parentId),this.correlationContextHeader=null,this.operationId=v.getRootId(this.requestId)),R&&(this.requestId=R,this.operationId=v.getRootId(this.requestId))}},C.parseId=function(A){var R=A.split("|");return R.length>0?R[0]:""},C.keys=new x.ContextTagKeys,C}(g);T.exports=y}),gn=F((s,T)=>{"use strict";function f(b){return typeof b=="function"}a(f,"pc");var w=console.error.bind(console);function x(b,y,E){var C=!!b[y]&&b.propertyIsEnumerable(y);Object.defineProperty(b,y,{configurable:!0,enumerable:C,writable:!0,value:E})}a(x,"gi");function p(b){b&&b.logger&&(f(b.logger)?w=b.logger:w("new logger isn't a function, not replacing"))}a(p,"vi");function u(b,y,E){if(!b||!b[y]){w("no original function "+y+" to wrap");return}if(!E){w("no wrapper function"),w(new Error().stack);return}if(!f(b[y])||!f(E)){w("original object and wrapper must be functions");return}var C=b[y],A=E(C,y);return x(A,"__original",C),x(A,"__unwrap",function(){b[y]===A&&x(b,y,C)}),x(A,"__wrapped",!0),x(b,y,A),A}a(u,"Rg");function g(b,y,E){if(b)Array.isArray(b)||(b=[b]);else{w("must provide one or more modules to patch"),w(new Error().stack);return}if(!(y&&Array.isArray(y))){w("must provide one or more functions to wrap on modules");return}b.forEach(function(C){y.forEach(function(A){u(C,A,E)})})}a(g,"ZO");function v(b,y){if(!b||!b[y]){w("no function to unwrap."),w(new Error().stack);return}if(!b[y].__unwrap)w("no original to unwrap to -- has "+y+" already been unwrapped?");else return b[y].__unwrap()}a(v,"Ng");function _(b,y){if(b)Array.isArray(b)||(b=[b]);else{w("must provide one or more modules to patch"),w(new Error().stack);return}if(!(y&&Array.isArray(y))){w("must provide one or more functions to unwrap on modules");return}b.forEach(function(E){y.forEach(function(C){v(E,C)})})}a(_,"JO"),p.wrap=u,p.massWrap=g,p.unwrap=v,p.massUnwrap=_,T.exports=p}),Pn=F((s,T)=>{"use strict";var f=gn(),w=f.wrap,x=f.unwrap,p="wrap@before";function u(y,E,C){var A=!!y[E]&&y.propertyIsEnumerable(E);Object.defineProperty(y,E,{configurable:!0,enumerable:A,writable:!0,value:C})}a(u,"Rs");function g(y,E){for(var C=E.length,A=0;A<C;A++){var R=E[A],D=y[p];if(typeof D=="function")D(R);else if(Array.isArray(D))for(var k=D.length,G=0;G<k;G++)D[G](R)}}a(g,"eP");function v(y,E){var C;return C=y._events&&y._events[E],Array.isArray(C)||(C?C=[C]:C=[]),C}a(v,"Mg");function _(y,E,C){var A=v(y,E),R=A.filter(function(D){return C.indexOf(D)===-1});R.length>0&&g(y,R)}a(_,"tP");function b(y,E){if(y){var C=y;if(typeof y=="function")C=E(y);else if(Array.isArray(y)){C=[];for(var A=0;A<y.length;A++)C[A]=E(y[A])}return C}}a(b,"xg"),T.exports=function(y,E,C){if(!y||!y.on||!y.addListener||!y.removeListener||!y.emit)throw new Error("can only wrap real EEs");if(!E)throw new Error("must have function to run on listener addition");if(!C)throw new Error("must have function to wrap listeners when emitting");function A(D){return function(k,G){var Z=v(this,k).slice();try{var Q=D.call(this,k,G);return _(this,k,Z),Q}finally{this.on.__wrapped||w(this,"on",A),this.addListener.__wrapped||w(this,"addListener",A)}}}a(A,"i");function R(D){return function(k){if(!this._events||!this._events[k])return D.apply(this,arguments);var G=this._events[k];function Z(Q){return function(){this._events[k]=G;try{return Q.apply(this,arguments)}finally{G=this._events[k],this._events[k]=b(G,C)}}}a(Z,"p"),w(this,"removeListener",Z);try{return this._events[k]=b(G,C),D.apply(this,arguments)}finally{x(this,"removeListener"),this._events[k]=G}}}a(R,"a"),y[p]?typeof y[p]=="function"?u(y,p,[y[p],E]):Array.isArray(y[p])&&y[p].push(E):u(y,p,E),y.__wrapped||(w(y,"addListener",A),w(y,"on",A),w(y,"emit",R),u(y,"__unwrap",function(){x(y,"addListener"),x(y,"on"),x(y,"emit"),delete y[p],delete y.__wrapped}),u(y,"__wrapped",!0))}}),El=F((s,T)=>{"use strict";var f=K(3837),w=K(9491),x=Pn(),p=K(852),u="cls@contexts",g="error@context",v=process.env.DEBUG_CLS_HOOKED,_=-1;T.exports={getNamespace:y,createNamespace:E,destroyNamespace:C,reset:A,ERROR_SYMBOL:g};function b(D){this.name=D,this.active=null,this._set=[],this.id=null,this._contexts=new Map,this._indent=0}a(b,"xe"),b.prototype.set=function(D,k){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");if(this.active[D]=k,v){let G=" ".repeat(this._indent<0?0:this._indent);R(G+"CONTEXT-SET KEY:"+D+"="+k+" in ns:"+this.name+" currentUid:"+_+" active:"+f.inspect(this.active,{showHidden:!0,depth:2,colors:!0}))}return k},b.prototype.get=function(D){if(!this.active){if(v){let k=p.currentId(),G=p.triggerAsyncId(),Z=" ".repeat(this._indent<0?0:this._indent);R(`${Z}CONTEXT-GETTING KEY NO ACTIVE NS: (${this.name}) ${D}=undefined currentUid:${_} asyncHooksCurrentId:${k} triggerId:${G} len:${this._set.length}`)}return}if(v){let k=p.executionAsyncId(),G=p.triggerAsyncId(),Z=" ".repeat(this._indent<0?0:this._indent);R(Z+"CONTEXT-GETTING KEY:"+D+"="+this.active[D]+" ("+this.name+") currentUid:"+_+" active:"+f.inspect(this.active,{showHidden:!0,depth:2,colors:!0})),R(`${Z}CONTEXT-GETTING KEY: (${this.name}) ${D}=${this.active[D]} currentUid:${_} asyncHooksCurrentId:${k} triggerId:${G} len:${this._set.length} active:${f.inspect(this.active)}`)}return this.active[D]},b.prototype.createContext=function(){let D=Object.create(this.active?this.active:Object.prototype);if(D._ns_name=this.name,D.id=_,v){let k=p.executionAsyncId(),G=p.triggerAsyncId(),Z=" ".repeat(this._indent<0?0:this._indent);R(`${Z}CONTEXT-CREATED Context: (${this.name}) currentUid:${_} asyncHooksCurrentId:${k} triggerId:${G} len:${this._set.length} context:${f.inspect(D,{showHidden:!0,depth:2,colors:!0})}`)}return D},b.prototype.run=function(D){let k=this.createContext();this.enter(k);try{if(v){let G=p.triggerAsyncId(),Z=p.executionAsyncId(),Q=" ".repeat(this._indent<0?0:this._indent);R(`${Q}CONTEXT-RUN BEGIN: (${this.name}) currentUid:${_} triggerId:${G} asyncHooksCurrentId:${Z} len:${this._set.length} context:${f.inspect(k)}`)}return D(k),k}catch(G){throw G&&(G[g]=k),G}finally{if(v){let G=p.triggerAsyncId(),Z=p.executionAsyncId(),Q=" ".repeat(this._indent<0?0:this._indent);R(`${Q}CONTEXT-RUN END: (${this.name}) currentUid:${_} triggerId:${G} asyncHooksCurrentId:${Z} len:${this._set.length} ${f.inspect(k)}`)}this.exit(k)}},b.prototype.runAndReturn=function(D){let k;return this.run(function(G){k=D(G)}),k},b.prototype.runPromise=function(D){let k=this.createContext();this.enter(k);let G=D(k);if(!G||!G.then||!G.catch)throw new Error("fn must return a promise.");return v&&R("CONTEXT-runPromise BEFORE: ("+this.name+") currentUid:"+_+" len:"+this._set.length+" "+f.inspect(k)),G.then(Z=>(v&&R("CONTEXT-runPromise AFTER then: ("+this.name+") currentUid:"+_+" len:"+this._set.length+" "+f.inspect(k)),this.exit(k),Z)).catch(Z=>{throw Z[g]=k,v&&R("CONTEXT-runPromise AFTER catch: ("+this.name+") currentUid:"+_+" len:"+this._set.length+" "+f.inspect(k)),this.exit(k),Z})},b.prototype.bind=function(D,k){k||(this.active?k=this.active:k=this.createContext());let G=this;return function(){G.enter(k);try{return D.apply(this,arguments)}catch(Z){throw Z&&(Z[g]=k),Z}finally{G.exit(k)}}},b.prototype.enter=function(D){if(w.ok(D,"context must be provided for entering"),v){let k=p.executionAsyncId(),G=p.triggerAsyncId(),Z=" ".repeat(this._indent<0?0:this._indent);R(`${Z}CONTEXT-ENTER: (${this.name}) currentUid:${_} triggerId:${G} asyncHooksCurrentId:${k} len:${this._set.length} ${f.inspect(D)}`)}this._set.push(this.active),this.active=D},b.prototype.exit=function(D){if(w.ok(D,"context must be provided for exiting"),v){let G=p.executionAsyncId(),Z=p.triggerAsyncId(),Q=" ".repeat(this._indent<0?0:this._indent);R(`${Q}CONTEXT-EXIT: (${this.name}) currentUid:${_} triggerId:${Z} asyncHooksCurrentId:${G} len:${this._set.length} ${f.inspect(D)}`)}if(this.active===D){w.ok(this._set.length,"can't remove top context"),this.active=this._set.pop();return}let k=this._set.lastIndexOf(D);k<0?(v&&R("??ERROR?? context exiting but not entered - ignoring: "+f.inspect(D)),w.ok(k>=0,`context not currently entered; can't exit. 
`+f.inspect(this)+`
`+f.inspect(D))):(w.ok(k,"can't remove top context"),this._set.splice(k,1))},b.prototype.bindEmitter=function(D){w.ok(D.on&&D.addListener&&D.emit,"can only bind real EEs");let k=this,G="context@"+this.name;function Z(fe){!fe||(fe[u]||(fe[u]=Object.create(null)),fe[u][G]={namespace:k,context:k.active})}a(Z,"i");function Q(fe){if(!(fe&&fe[u]))return fe;let Se=fe,Me=fe[u];return Object.keys(Me).forEach(function(He){let Qe=Me[He];Se=Qe.namespace.bind(Se,Qe.context)}),Se}a(Q,"a"),x(D,Z,Q)},b.prototype.fromException=function(D){return D[g]};function y(D){return process.namespaces[D]}a(y,"qg");function E(D){w.ok(D,"namespace must be given a name."),v&&R(`NS-CREATING NAMESPACE (${D})`);let k=new b(D);return k.id=_,p.createHook({init(G,Z,Q,fe){if(_=p.executionAsyncId(),k.active){if(k._contexts.set(G,k.active),v){let Se=" ".repeat(k._indent<0?0:k._indent);R(`${Se}INIT [${Z}] (${D}) asyncId:${G} currentUid:${_} triggerId:${Q} active:${f.inspect(k.active,{showHidden:!0,depth:2,colors:!0})} resource:${fe}`)}}else if(_===0){let Se=p.triggerAsyncId(),Me=k._contexts.get(Se);if(Me){if(k._contexts.set(G,Me),v){let He=" ".repeat(k._indent<0?0:k._indent);R(`${He}INIT USING CONTEXT FROM TRIGGERID [${Z}] (${D}) asyncId:${G} currentUid:${_} triggerId:${Se} active:${f.inspect(k.active,{showHidden:!0,depth:2,colors:!0})} resource:${fe}`)}}else if(v){let He=" ".repeat(k._indent<0?0:k._indent);R(`${He}INIT MISSING CONTEXT [${Z}] (${D}) asyncId:${G} currentUid:${_} triggerId:${Se} active:${f.inspect(k.active,{showHidden:!0,depth:2,colors:!0})} resource:${fe}`)}}if(v&&Z==="PROMISE"){R(f.inspect(fe,{showHidden:!0}));let Se=fe.parentId,Me=" ".repeat(k._indent<0?0:k._indent);R(`${Me}INIT RESOURCE-PROMISE [${Z}] (${D}) parentId:${Se} asyncId:${G} currentUid:${_} triggerId:${Q} active:${f.inspect(k.active,{showHidden:!0,depth:2,colors:!0})} resource:${fe}`)}},before(G){_=p.executionAsyncId();let Z;if(Z=k._contexts.get(G)||k._contexts.get(_),Z){if(v){let Q=p.triggerAsyncId(),fe=" ".repeat(k._indent<0?0:k._indent);R(`${fe}BEFORE (${D}) asyncId:${G} currentUid:${_} triggerId:${Q} active:${f.inspect(k.active,{showHidden:!0,depth:2,colors:!0})} context:${f.inspect(Z)}`),k._indent+=2}k.enter(Z)}else if(v){let Q=p.triggerAsyncId(),fe=" ".repeat(k._indent<0?0:k._indent);R(`${fe}BEFORE MISSING CONTEXT (${D}) asyncId:${G} currentUid:${_} triggerId:${Q} active:${f.inspect(k.active,{showHidden:!0,depth:2,colors:!0})} namespace._contexts:${f.inspect(k._contexts,{showHidden:!0,depth:2,colors:!0})}`),k._indent+=2}},after(G){_=p.executionAsyncId();let Z;if(Z=k._contexts.get(G)||k._contexts.get(_),Z){if(v){let Q=p.triggerAsyncId();k._indent-=2;let fe=" ".repeat(k._indent<0?0:k._indent);R(`${fe}AFTER (${D}) asyncId:${G} currentUid:${_} triggerId:${Q} active:${f.inspect(k.active,{showHidden:!0,depth:2,colors:!0})} context:${f.inspect(Z)}`)}k.exit(Z)}else if(v){let Q=p.triggerAsyncId();k._indent-=2;let fe=" ".repeat(k._indent<0?0:k._indent);R(`${fe}AFTER MISSING CONTEXT (${D}) asyncId:${G} currentUid:${_} triggerId:${Q} active:${f.inspect(k.active,{showHidden:!0,depth:2,colors:!0})} context:${f.inspect(Z)}`)}},destroy(G){if(_=p.executionAsyncId(),v){let Z=p.triggerAsyncId(),Q=" ".repeat(k._indent<0?0:k._indent);R(`${Q}DESTROY (${D}) currentUid:${_} asyncId:${G} triggerId:${Z} active:${f.inspect(k.active,{showHidden:!0,depth:2,colors:!0})} context:${f.inspect(k._contexts.get(_))}`)}k._contexts.delete(G)}}).enable(),process.namespaces[D]=k,k}a(E,"nP");function C(D){let k=y(D);w.ok(k,`can't delete nonexistent namespace! "`+D+'"'),w.ok(k.id,"don't assign to process.namespaces directly! "+f.inspect(k)),process.namespaces[D]=null}a(C,"kg");function A(){process.namespaces&&Object.keys(process.namespaces).forEach(function(D){C(D)}),process.namespaces=Object.create(null)}a(A,"iP"),process.namespaces={};function R(...D){v&&process._rawDebug(`${f.format(...D)}`)}a(R,"j")}),No=F((s,T)=>{"use strict";function f(){}a(f,"aP"),T.exports=function(){let w=this._hooks,x=this._state,p=process.nextTick;process.nextTick=function(){if(!x.enabled)return p.apply(process,arguments);let u=new Array(arguments.length);for(let b=0;b<arguments.length;b++)u[b]=arguments[b];let g=u[0];if(typeof g!="function")throw new TypeError("callback is not a function");let v=new f,_=--x.counter;return w.init.call(v,_,0,null,null),u[0]=function(){w.pre.call(v,_);let b=!0;try{g.apply(this,arguments),b=!1}finally{b&&process.listenerCount("uncaughtException")>0&&process.once("uncaughtException",function(){w.post.call(v,_,!0),w.destroy.call(null,_)})}w.post.call(v,_,!1),w.destroy.call(null,_)},p.apply(process,u)}}}),Mo=F((s,T)=>{"use strict";function f(){}a(f,"sP"),T.exports=function(){let w=this._hooks,x=this._state,p=global.Promise,u=p.prototype.then;p.prototype.then=b;function g(y,E,C,A){return typeof y!="function"?A?v(C):_(C):function(){w.pre.call(E,C);try{return y.apply(this,arguments)}finally{w.post.call(E,C,!1),w.destroy.call(null,C)}}}a(g,"a");function v(y){return function(E){return w.destroy.call(null,y),E}}a(v,"s");function _(y){return function(E){throw w.destroy.call(null,y),E}}a(_,"o");function b(y,E){if(!x.enabled)return u.call(this,y,E);let C=new f,A=--x.counter;return w.init.call(C,A,0,null,null),u.call(this,g(y,C,A,!0),g(E,C,A,!1))}a(b,"u")}}),Si=F((s,T)=>{"use strict";var f=K(9512);function w(){}a(w,"oP");function x(){}a(x,"uP");function p(){}a(p,"cP");var u=new Map,g=new Map,v=new Map,_=null,b=!1;T.exports=function(){y(this._hooks,this._state,"setTimeout","clearTimeout",w,u,!0),y(this._hooks,this._state,"setInterval","clearInterval",x,g,!1),y(this._hooks,this._state,"setImmediate","clearImmediate",p,v,!0),global.setTimeout=f.setTimeout,global.setInterval=f.setInterval,global.setImmediate=f.setImmediate,global.clearTimeout=f.clearTimeout,global.clearInterval=f.clearInterval,global.clearImmediate=f.clearImmediate};function y(E,C,A,R,D,k,G){let Z=f[A],Q=f[R];f[A]=function(){if(!C.enabled)return Z.apply(f,arguments);let fe=new Array(arguments.length);for(let Ye=0;Ye<arguments.length;Ye++)fe[Ye]=arguments[Ye];let Se=fe[0];if(typeof Se!="function")throw new TypeError('"callback" argument must be a function');let Me=new D,He=--C.counter,Qe;return E.init.call(Me,He,0,null,null),fe[0]=function(){_=Qe,E.pre.call(Me,He);let Ye=!0;try{Se.apply(this,arguments),Ye=!1}finally{Ye&&process.listenerCount("uncaughtException")>0&&process.once("uncaughtException",function(){E.post.call(Me,He,!0),k.delete(Qe),E.destroy.call(null,He)})}E.post.call(Me,He,!1),_=null,(G||b)&&(b=!1,k.delete(Qe),E.destroy.call(null,He))},Qe=Z.apply(f,fe),k.set(Qe,He),Qe},f[R]=function(fe){if(_===fe&&fe!==null)b=!0;else if(k.has(fe)){let Se=k.get(fe);k.delete(fe),E.destroy.call(null,Se)}Q.apply(f,arguments)}}a(y,"hc")}),hc=F((s,T)=>{T.exports={name:"async-hook-jl",description:"Inspect the life of handle objects in node",version:"1.7.6",author:"Andreas Madsen <amwebdk@gmail.com>",main:"./index.js",scripts:{test:"node ./test/runner.js && eslint ."},repository:{type:"git",url:"git://github.com/jeff-lewis/async-hook-jl.git"},keywords:["async","async hooks","inspect","async wrap"],license:"MIT",dependencies:{"stack-chain":"^1.3.7"},devDependencies:{async:"1.5.x","cli-color":"1.1.x",eslint:"^3.4.0",endpoint:"0.4.x"},engines:{node:"^4.7 || >=6.9 || >=7.3"}}}),fc=F((s,T)=>{"use strict";var f=process.binding("async_wrap"),w=f.Providers.TIMERWRAP,x={nextTick:No(),promise:Mo(),timers:Si()},p=new Set;function u(){this.enabled=!1,this.counter=0}a(u,"_P");function g(){let b=this.initFns=[],y=this.preFns=[],E=this.postFns=[],C=this.destroyFns=[];this.init=function(A,R,D,k){if(R===w){p.add(A);return}for(let G of b)G(A,this,R,D,k)},this.pre=function(A){if(!p.has(A))for(let R of y)R(A,this)},this.post=function(A,R){if(!p.has(A))for(let D of E)D(A,this,R)},this.destroy=function(A){if(p.has(A)){p.delete(A);return}for(let R of C)R(A)}}a(g,"gc"),g.prototype.add=function(b){b.init&&this.initFns.push(b.init),b.pre&&this.preFns.push(b.pre),b.post&&this.postFns.push(b.post),b.destroy&&this.destroyFns.push(b.destroy)};function v(b,y){let E=b.indexOf(y);E!==-1&&b.splice(E,1)}a(v,"Ds"),g.prototype.remove=function(b){b.init&&v(this.initFns,b.init),b.pre&&v(this.preFns,b.pre),b.post&&v(this.postFns,b.post),b.destroy&&v(this.destroyFns,b.destroy)};function _(){this._state=new u,this._hooks=new g,this.version=hc().version,this.providers=f.Providers;for(let b of Object.keys(x))x[b].call(this);process.env.hasOwnProperty("NODE_ASYNC_HOOK_WARNING")&&console.warn("warning: you are using async-hook-jl which is unstable."),f.setupHooks({init:this._hooks.init,pre:this._hooks.pre,post:this._hooks.post,destroy:this._hooks.destroy})}a(_,"Si"),T.exports=_,_.prototype.addHooks=function(b){this._hooks.add(b)},_.prototype.removeHooks=function(b){this._hooks.remove(b)},_.prototype.enable=function(){this._state.enabled=!0,f.enable()},_.prototype.disable=function(){this._state.enabled=!1,f.disable()}}),xl=F((s,T)=>{T.exports={name:"stack-chain",description:"API for combining call site modifiers",version:"1.3.7",author:"Andreas Madsen <amwebdk@gmail.com>",scripts:{test:"tap ./test/simple"},repository:{type:"git",url:"git://github.com/AndreasMadsen/stack-chain.git"},keywords:["stack","chain","trace","call site","concat","format"],devDependencies:{tap:"2.x.x","uglify-js":"2.5.x"},license:"MIT"}}),ku=F((s,T)=>{function f(w){try{return Error.prototype.toString.call(w)}catch(x){try{return"<error: "+x+">"}catch(p){return"<error>"}}}a(f,"vP"),T.exports=function(w,x){var p=[];p.push(f(w));for(var u=0;u<x.length;u++){var g=x[u],v;try{v=g.toString()}catch(_){try{v="<error: "+_+">"}catch(b){v="<error>"}}p.push("    at "+v)}return p.join(`
`)}}),us=F((s,T)=>{var f=ku();function w(){this.extend=new u,this.filter=new u,this.format=new g,this.version=xl().version}a(w,"Wg");var x=!1;w.prototype.callSite=a(function y(E){E||(E={}),x=!0;var C={};Error.captureStackTrace(C,y);var A=C.stack;return x=!1,A=A.slice(E.slice||0),E.extend&&(A=this.extend._modify(C,A)),E.filter&&(A=this.filter._modify(C,A)),A},"e");var p=new w;function u(){this._modifiers=[]}a(u,"Ai"),u.prototype._modify=function(y,E){for(var C=0,A=this._modifiers.length;C<A;C++)E=this._modifiers[C](y,E);return E},u.prototype.attach=function(y){this._modifiers.push(y)},u.prototype.deattach=function(y){var E=this._modifiers.indexOf(y);return E===-1?!1:(this._modifiers.splice(E,1),!0)};function g(){this._formater=f,this._previous=void 0}a(g,"bi"),g.prototype.replace=function(y){y?this._formater=y:this.restore()},g.prototype.restore=function(){this._formater=f,this._previous=void 0},g.prototype._backup=function(){this._previous=this._formater},g.prototype._roolback=function(){this._previous===f?this.replace(void 0):this.replace(this._previous),this._previous=void 0},Error.prepareStackTrace&&p.format.replace(Error.prepareStackTrace);var v=!1;function _(y,E){if(x)return E;if(v)return f(y,E);var C=E.concat();C=p.extend._modify(y,C),C=p.filter._modify(y,C),C=C.slice(0,Error.stackTraceLimit),Object.isExtensible(y)&&Object.getOwnPropertyDescriptor(y,"callSite")===void 0&&(y.callSite={original:E,mutated:C}),v=!0;var A=p.format._formater(y,C);return v=!1,A}a(_,"Zg"),Object.defineProperty(Error,"prepareStackTrace",{get:function(){return _},set:function(y){y===_?p.format._roolback():(p.format._backup(),p.format.replace(y))}});function b(){return this.stack,this.callSite}a(b,"mP"),Object.defineProperty(Error.prototype,"callSite",{get:b,set:function(y){Object.defineProperty(this,"callSite",{value:y,writable:!0,configurable:!0})},configurable:!0}),T.exports=p}),Jn=F((s,T)=>{if(global._stackChain)if(global._stackChain.version===xl().version)T.exports=global._stackChain;else throw new Error("Conflicting version of stack-chain found");else T.exports=global._stackChain=us()}),pc=F((s,T)=>{"use strict";var f=fc();if(global._asyncHook)if(global._asyncHook.version===hc().version)T.exports=global._asyncHook;else throw new Error("Conflicting version of async-hook-jl found");else Jn().filter.attach(function(w,x){return x.filter(function(p){let u=p.getFileName();return!(u&&u.slice(0,__dirname.length)===__dirname)})}),T.exports=global._asyncHook=new f}),gc=F((s,T)=>{"use strict";var f=K(3837),w=K(9491),x=Pn(),p=pc(),u="cls@contexts",g="error@context",v=[];for(let Q in p.providers)v[p.providers[Q]]=Q;var _=process.env.DEBUG_CLS_HOOKED,b=-1;T.exports={getNamespace:E,createNamespace:C,destroyNamespace:A,reset:R,ERROR_SYMBOL:g};function y(Q){this.name=Q,this.active=null,this._set=[],this.id=null,this._contexts=new Map}a(y,"Le"),y.prototype.set=function(Q,fe){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");return _&&D("    SETTING KEY:"+Q+"="+fe+" in ns:"+this.name+" uid:"+b+" active:"+f.inspect(this.active,!0)),this.active[Q]=fe,fe},y.prototype.get=function(Q){if(!this.active){_&&D("    GETTING KEY:"+Q+"=undefined "+this.name+" uid:"+b+" active:"+f.inspect(this.active,!0));return}return _&&D("    GETTING KEY:"+Q+"="+this.active[Q]+" "+this.name+" uid:"+b+" active:"+f.inspect(this.active,!0)),this.active[Q]},y.prototype.createContext=function(){_&&D("   CREATING Context: "+this.name+" uid:"+b+" len:"+this._set.length+"  active:"+f.inspect(this.active,!0,2,!0));let Q=Object.create(this.active?this.active:Object.prototype);return Q._ns_name=this.name,Q.id=b,_&&D("   CREATED Context: "+this.name+" uid:"+b+" len:"+this._set.length+"  context:"+f.inspect(Q,!0,2,!0)),Q},y.prototype.run=function(Q){let fe=this.createContext();this.enter(fe);try{return _&&D(" BEFORE RUN: "+this.name+" uid:"+b+" len:"+this._set.length+" "+f.inspect(fe)),Q(fe),fe}catch(Se){throw Se&&(Se[g]=fe),Se}finally{_&&D(" AFTER RUN: "+this.name+" uid:"+b+" len:"+this._set.length+" "+f.inspect(fe)),this.exit(fe)}},y.prototype.runAndReturn=function(Q){var fe;return this.run(function(Se){fe=Q(Se)}),fe},y.prototype.runPromise=function(Q){let fe=this.createContext();this.enter(fe);let Se=Q(fe);if(!Se||!Se.then||!Se.catch)throw new Error("fn must return a promise.");return _&&D(" BEFORE runPromise: "+this.name+" uid:"+b+" len:"+this._set.length+" "+f.inspect(fe)),Se.then(Me=>(_&&D(" AFTER runPromise: "+this.name+" uid:"+b+" len:"+this._set.length+" "+f.inspect(fe)),this.exit(fe),Me)).catch(Me=>{throw Me[g]=fe,_&&D(" AFTER runPromise: "+this.name+" uid:"+b+" len:"+this._set.length+" "+f.inspect(fe)),this.exit(fe),Me})},y.prototype.bind=function(Q,fe){fe||(this.active?fe=this.active:fe=this.createContext());let Se=this;return function(){Se.enter(fe);try{return Q.apply(this,arguments)}catch(Me){throw Me&&(Me[g]=fe),Me}finally{Se.exit(fe)}}},y.prototype.enter=function(Q){w.ok(Q,"context must be provided for entering"),_&&D("  ENTER "+this.name+" uid:"+b+" len:"+this._set.length+" context: "+f.inspect(Q)),this._set.push(this.active),this.active=Q},y.prototype.exit=function(Q){if(w.ok(Q,"context must be provided for exiting"),_&&D("  EXIT "+this.name+" uid:"+b+" len:"+this._set.length+" context: "+f.inspect(Q)),this.active===Q){w.ok(this._set.length,"can't remove top context"),this.active=this._set.pop();return}let fe=this._set.lastIndexOf(Q);fe<0?(_&&D("??ERROR?? context exiting but not entered - ignoring: "+f.inspect(Q)),w.ok(fe>=0,`context not currently entered; can't exit. 
`+f.inspect(this)+`
`+f.inspect(Q))):(w.ok(fe,"can't remove top context"),this._set.splice(fe,1))},y.prototype.bindEmitter=function(Q){w.ok(Q.on&&Q.addListener&&Q.emit,"can only bind real EEs");let fe=this,Se="context@"+this.name;function Me(Qe){!Qe||(Qe[u]||(Qe[u]=Object.create(null)),Qe[u][Se]={namespace:fe,context:fe.active})}a(Me,"i");function He(Qe){if(!(Qe&&Qe[u]))return Qe;let Ye=Qe,mt=Qe[u];return Object.keys(mt).forEach(function(Ct){let Vt=mt[Ct];Ye=Vt.namespace.bind(Ye,Vt.context)}),Ye}a(He,"a"),x(Q,Me,He)},y.prototype.fromException=function(Q){return Q[g]};function E(Q){return process.namespaces[Q]}a(E,"nv");function C(Q){w.ok(Q,"namespace must be given a name."),_&&D("CREATING NAMESPACE "+Q);let fe=new y(Q);return fe.id=b,p.addHooks({init(Se,Me,He,Qe,Ye){b=Se,Qe?(fe._contexts.set(Se,fe._contexts.get(Qe)),_&&D("PARENTID: "+Q+" uid:"+Se+" parent:"+Qe+" provider:"+He)):fe._contexts.set(b,fe.active),_&&D("INIT "+Q+" uid:"+Se+" parent:"+Qe+" provider:"+v[He]+" active:"+f.inspect(fe.active,!0))},pre(Se,Me){b=Se;let He=fe._contexts.get(Se);He?(_&&D(" PRE "+Q+" uid:"+Se+" handle:"+k(Me)+" context:"+f.inspect(He)),fe.enter(He)):_&&D(" PRE MISSING CONTEXT "+Q+" uid:"+Se+" handle:"+k(Me))},post(Se,Me){b=Se;let He=fe._contexts.get(Se);He?(_&&D(" POST "+Q+" uid:"+Se+" handle:"+k(Me)+" context:"+f.inspect(He)),fe.exit(He)):_&&D(" POST MISSING CONTEXT "+Q+" uid:"+Se+" handle:"+k(Me))},destroy(Se){b=Se,_&&D("DESTROY "+Q+" uid:"+Se+" context:"+f.inspect(fe._contexts.get(b))+" active:"+f.inspect(fe.active,!0)),fe._contexts.delete(Se)}}),process.namespaces[Q]=fe,fe}a(C,"TP");function A(Q){let fe=E(Q);w.ok(fe,`can't delete nonexistent namespace! "`+Q+'"'),w.ok(fe.id,"don't assign to process.namespaces directly! "+f.inspect(fe)),process.namespaces[Q]=null}a(A,"iv");function R(){process.namespaces&&Object.keys(process.namespaces).forEach(function(Q){A(Q)}),process.namespaces=Object.create(null)}a(R,"SP"),process.namespaces={},p._state&&!p._state.enabled&&p.enable();function D(Q){process.env.DEBUG&&process._rawDebug(Q)}a(D,"Q");function k(Q){if(!Q)return Q;if(typeof Q=="function")return Q.name?Q.name:(Q.toString().trim().match(/^function\s*([^\s(]+)/)||[])[1];if(Q.constructor&&Q.constructor.name)return Q.constructor.name}if(a(k,"Ms"),_){G=Jn();for(Z in G.filter._modifiers)G.filter.deattach(Z)}var G,Z}),mc=F((s,T)=>{"use strict";var f=Ee();process&&f.gte(process.versions.node,"8.0.0")?T.exports=El():T.exports=gc()}),Lo=F((s,T)=>{var f=gn().wrap,w=1<<0,x=1<<1,p=1<<2,u=1<<3,g=[],v=0,_=!1,b=[],y,E;function C(Me,He){var Qe=Me.length,Ye=He.length,mt=[];if(Qe===0&&Ye===0)return mt;for(var Ct=0;Ct<Qe;Ct++)mt[Ct]=Me[Ct];if(Ye===0)return mt;for(var Vt=0;Vt<Ye;Vt++){var Bt=!0;for(Ct=0;Ct<Qe;Ct++)if(Me[Ct].uid===He[Vt].uid){Bt=!1;break}Bt&&mt.push(He[Vt])}return mt}a(C,"Rc"),process._fatalException?(A=!1,y=a(function(Me){var He=g.length;if(A||He===0)return!1;var Qe=!1;A=!0;for(var Ye=0;Ye<He;++Ye){var mt=g[Ye];if((mt.flags&u)!=0){var Ct=R&&R[mt.uid];Qe=mt.error(Ct,Me)||Qe}}return A=!1,b.length>0&&(g=b.pop()),R=void 0,Qe&&!_},"hn"),E=a(function(Me,He,Qe){var Ye=[];_=!0;for(var mt=0;mt<Qe;++mt){var Ct=He[mt];if(Ye[Ct.uid]=Ct.data,(Ct.flags&w)!=0){var Vt=Ct.create(Ct.data);Vt!==void 0&&(Ye[Ct.uid]=Vt)}}return _=!1,function(){R=Ye,b.push(g),g=C(He,g),_=!0;for(var Bt=0;Bt<Qe;++Bt)(He[Bt].flags&x)>0&&He[Bt].before(this,Ye[He[Bt].uid]);_=!1;var Er=Me.apply(this,arguments);for(_=!0,Bt=0;Bt<Qe;++Bt)(He[Bt].flags&p)>0&&He[Bt].after(this,Ye[He[Bt].uid]);return _=!1,g=b.pop(),R=void 0,Er}},"Pc"),f(process,"_fatalException",function(Me){return function(He){return y(He)||Me(He)}})):(D=!1,y=a(function(Me){if(D)throw Me;for(var He=!1,Qe=g.length,Ye=0;Ye<Qe;++Ye){var mt=g[Ye];(mt.flags&u)!=0&&(He=mt.error(null,Me)||He)}if(!He&&_)throw Me},"hn"),E=a(function(Me,He,Qe){var Ye=[];_=!0;for(var mt=0;mt<Qe;++mt){var Ct=He[mt];if(Ye[Ct.uid]=Ct.data,(Ct.flags&w)!=0){var Vt=Ct.create(Ct.data);Vt!==void 0&&(Ye[Ct.uid]=Vt)}}return _=!1,function(){var Bt=!1,Er=!1;b.push(g),g=C(He,g),_=!0;for(var Ht=0;Ht<Qe;++Ht)(He[Ht].flags&x)>0&&He[Ht].before(this,Ye[He[Ht].uid]);_=!1;var Je;try{Je=Me.apply(this,arguments)}catch(ct){Bt=!0;for(var Ht=0;Ht<Qe;++Ht)if((g[Ht].flags&u)!=0)try{Er=g[Ht].error(Ye[He[Ht].uid],ct)||Er}catch(Et){throw D=!0,Et}if(!Er)throw process.removeListener("uncaughtException",y),process._originalNextTick(function(){process.addListener("uncaughtException",y)}),ct}finally{if(!Bt||Er){for(_=!0,Ht=0;Ht<Qe;++Ht)(He[Ht].flags&p)>0&&He[Ht].after(this,Ye[He[Ht].uid]);_=!1}g=b.pop()}return Je}},"Pc"),process.addListener("uncaughtException",y));var A,R,D;function k(Me,He,Qe){_=!0;for(var Ye=0;Ye<Qe;++Ye){var mt=He[Ye];mt.create&&mt.create(mt.data)}return _=!1,function(){b.push(g),g=C(He,g);var Ct=Me.apply(this,arguments);return g=b.pop(),Ct}}a(k,"CP");function G(Me){var He=g.length;if(He===0)return Me;for(var Qe=g.slice(),Ye=0;Ye<He;++Ye)if(Qe[Ye].flags>0)return E(Me,Qe,He);return k(Me,Qe,He)}a(G,"OP");function Z(Me,He){typeof Me.create=="function"&&(this.create=Me.create,this.flags|=w),typeof Me.before=="function"&&(this.before=Me.before,this.flags|=x),typeof Me.after=="function"&&(this.after=Me.after,this.flags|=p),typeof Me.error=="function"&&(this.error=Me.error,this.flags|=u),this.uid=++v,this.data=He===void 0?null:He}a(Z,"Ze"),Z.prototype.create=void 0,Z.prototype.before=void 0,Z.prototype.after=void 0,Z.prototype.error=void 0,Z.prototype.data=void 0,Z.prototype.uid=0,Z.prototype.flags=0;function Q(Me,He){if(typeof Me!="object"||!Me)throw new TypeError("callbacks argument must be an object");return Me instanceof Z?Me:new Z(Me,He)}a(Q,"cv");function fe(Me,He){var Qe;Me instanceof Z?Qe=Me:Qe=Q(Me,He);for(var Ye=!1,mt=0;mt<g.length;mt++)if(Qe===g[mt]){Ye=!0;break}return Ye||g.push(Qe),Qe}a(fe,"PP");function Se(Me){for(var He=0;He<g.length;He++)if(Me===g[He]){g.splice(He,1);break}}a(Se,"RP"),process.createAsyncListener=Q,process.addAsyncListener=fe,process.removeAsyncListener=Se,T.exports=G}),Fn=F((s,T)=>{"use strict";T.exports=(f,w)=>class extends f{constructor(x){var p,u;super(v);var g=this;try{x.apply(p,u)}catch(_){u[1](_)}return g;function v(_,b){p=this,u=[y,E];function y(C){return w(g,!1),_(C)}a(y,"p");function E(C){return w(g,!1),b(C)}a(E,"f")}}}}),Nu=F(()=>{"use strict";if(process.addAsyncListener)throw new Error("Don't require polyfill unless needed");var s=gn(),T=Ee(),f=s.wrap,w=s.massWrap,x=Lo(),p=K(3837),u=T.gte(process.version,"6.0.0"),g=T.gte(process.version,"7.0.0"),v=T.gte(process.version,"8.0.0"),_=T.gte(process.version,"11.0.0"),b=K(1808);g&&!b._normalizeArgs?b._normalizeArgs=function(Je){if(Je.length===0)return[{},null];var ct=Je[0],dt={};typeof ct=="object"&&ct!==null?dt=ct:Ht(ct)?dt.path=ct:(dt.port=ct,Je.length>1&&typeof Je[1]=="string"&&(dt.host=Je[1]));var Et=Je[Je.length-1];return typeof Et!="function"?[dt,null]:[dt,Et]}:!g&&!b._normalizeConnectArgs&&(b._normalizeConnectArgs=function(Je){var ct={};function dt(kt){return(kt=Number(kt))>=0?kt:!1}a(dt,"r"),typeof Je[0]=="object"&&Je[0]!==null?ct=Je[0]:typeof Je[0]=="string"&&dt(Je[0])===!1?ct.path=Je[0]:(ct.port=Je[0],typeof Je[1]=="string"&&(ct.host=Je[1]));var Et=Je[Je.length-1];return typeof Et=="function"?[ct,Et]:[ct]}),"_setUpListenHandle"in b.Server.prototype?f(b.Server.prototype,"_setUpListenHandle",y):f(b.Server.prototype,"_listen2",y);function y(Je){return function(){this.on("connection",function(ct){ct._handle&&(ct._handle.onread=x(ct._handle.onread))});try{return Je.apply(this,arguments)}finally{this._handle&&this._handle.onconnection&&(this._handle.onconnection=x(this._handle.onconnection))}}}a(y,"_v");function E(Je){if(Je&&Je._handle){var ct=Je._handle;ct._originalOnread||(ct._originalOnread=ct.onread),ct.onread=x(ct._originalOnread)}}a(E,"gv"),f(b.Socket.prototype,"connect",function(Je){return function(){var ct;v&&Array.isArray(arguments[0])&&Object.getOwnPropertySymbols(arguments[0]).length>0?ct=arguments[0]:ct=g?b._normalizeArgs(arguments):b._normalizeConnectArgs(arguments),ct[1]&&(ct[1]=x(ct[1]));var dt=Je.apply(this,ct);return E(this),dt}});var C=K(3685);f(C.Agent.prototype,"addRequest",function(Je){return function(ct){var dt=ct.onSocket;return ct.onSocket=x(function(Et){return E(Et),dt.apply(this,arguments)}),Je.apply(this,arguments)}});var A=K(2081);function R(Je){Array.isArray(Je.stdio)&&Je.stdio.forEach(function(ct){ct&&ct._handle&&(ct._handle.onread=x(ct._handle.onread),f(ct._handle,"close",Bt))}),Je._handle&&(Je._handle.onexit=x(Je._handle.onexit))}a(R,"vv"),A.ChildProcess?f(A.ChildProcess.prototype,"spawn",function(Je){return function(){var ct=Je.apply(this,arguments);return R(this),ct}}):w(A,["execFile","fork","spawn"],function(Je){return function(){var ct=Je.apply(this,arguments);return R(ct),ct}}),process._fatalException||(process._originalNextTick=process.nextTick);var D=[];process._nextDomainTick&&D.push("_nextDomainTick"),process._tickDomainCallback&&D.push("_tickDomainCallback"),w(process,D,Vt),f(process,"nextTick",Bt);var k=["setTimeout","setInterval"];global.setImmediate&&k.push("setImmediate");var G=K(9512),Z=global.setTimeout===G.setTimeout;w(G,k,Bt),Z&&w(global,k,Bt);var Q=K(9523);w(Q,["lookup","resolve","resolve4","resolve6","resolveCname","resolveMx","resolveNs","resolveTxt","resolveSrv","reverse"],Vt),Q.resolveNaptr&&f(Q,"resolveNaptr",Vt);var fe=K(7147);w(fe,["watch","rename","truncate","chown","fchown","chmod","fchmod","stat","lstat","fstat","link","symlink","readlink","realpath","unlink","rmdir","mkdir","readdir","close","open","utimes","futimes","fsync","write","read","readFile","writeFile","appendFile","watchFile","unwatchFile","exists"],Vt),fe.lchown&&f(fe,"lchown",Vt),fe.lchmod&&f(fe,"lchmod",Vt),fe.ftruncate&&f(fe,"ftruncate",Vt);var Se;try{Se=K(9796)}catch(Je){}Se&&Se.Deflate&&Se.Deflate.prototype&&(Me=Object.getPrototypeOf(Se.Deflate.prototype),Me._transform?f(Me,"_transform",Vt):Me.write&&Me.flush&&Me.end&&w(Me,["write","flush","end"],Vt));var Me,He;try{He=K(6113)}catch(Je){}He&&(Qe=["pbkdf2","randomBytes"],_||Qe.push("pseudoRandomBytes"),w(He,Qe,Vt));var Qe,Ye=!!global.Promise&&Promise.toString()==="function Promise() { [native code] }"&&Promise.toString.toString()==="function toString() { [native code] }";Ye&&(mt=process.addAsyncListener({create:function(){Ye=!1}}),global.Promise.resolve(!0).then(function(){Ye=!1}),process.removeAsyncListener(mt));var mt;Ye&&Ct();function Ct(){var Je=global.Promise;function ct(Tt){if(!(this instanceof ct))return Je(Tt);if(typeof Tt!="function")return new Je(Tt);var ar,gr,fr=new Je(_r);fr.__proto__=ct.prototype;try{Tt.apply(ar,gr)}catch(or){gr[1](or)}return fr;function _r(or,Pr){ar=this,gr=[En,Nt];function En(At){return Et(fr,!1),or(At)}a(En,"_");function Nt(At){return Et(fr,!1),Pr(At)}a(Nt,"g")}}if(a(ct,"t"),p.inherits(ct,Je),f(Je.prototype,"then",zt),Je.prototype.chain&&f(Je.prototype,"chain",zt),u)global.Promise=Fn()(Je,Et);else{var dt=["all","race","reject","resolve","accept","defer"];dt.forEach(function(Tt){typeof Je[Tt]=="function"&&(ct[Tt]=Je[Tt])}),global.Promise=ct}function Et(Tt,ar){(!Tt.__asl_wrapper||ar)&&(Tt.__asl_wrapper=x(kt))}a(Et,"n");function kt(Tt,ar,gr,fr){var _r;try{return _r=ar.call(Tt,gr),{returnVal:_r,error:!1}}catch(or){return{errorVal:or,error:!0}}finally{_r instanceof Je?fr.__asl_wrapper=function(){var or=_r.__asl_wrapper||kt;return or.apply(this,arguments)}:Et(fr,!0)}}a(kt,"i");function zt(Tt){return function(){var ar=this,gr=Tt.apply(ar,Array.prototype.map.call(arguments,fr));return gr.__asl_wrapper=function(_r,or,Pr,En){return ar.__asl_wrapper?(ar.__asl_wrapper(_r,function(){},null,gr),gr.__asl_wrapper(_r,or,Pr,En)):kt(_r,or,Pr,En)},gr;function fr(_r){return typeof _r!="function"?_r:x(function(or){var Pr=(ar.__asl_wrapper||kt)(this,_r,or,gr);if(Pr.error)throw Pr.errorVal;return Pr.returnVal})}}}a(zt,"a")}a(Ct,"qP");function Vt(Je){var ct=a(function(){var dt,Et=arguments.length-1;if(typeof arguments[Et]=="function"){dt=Array(arguments.length);for(var kt=0;kt<arguments.length-1;kt++)dt[kt]=arguments[kt];dt[Et]=x(arguments[Et])}return Je.apply(this,dt||arguments)},"t");switch(Je.length){case 1:return function(dt){return arguments.length!==1?ct.apply(this,arguments):(typeof dt=="function"&&(dt=x(dt)),Je.call(this,dt))};case 2:return function(dt,Et){return arguments.length!==2?ct.apply(this,arguments):(typeof Et=="function"&&(Et=x(Et)),Je.call(this,dt,Et))};case 3:return function(dt,Et,kt){return arguments.length!==3?ct.apply(this,arguments):(typeof kt=="function"&&(kt=x(kt)),Je.call(this,dt,Et,kt))};case 4:return function(dt,Et,kt,zt){return arguments.length!==4?ct.apply(this,arguments):(typeof zt=="function"&&(zt=x(zt)),Je.call(this,dt,Et,kt,zt))};case 5:return function(dt,Et,kt,zt,Tt){return arguments.length!==5?ct.apply(this,arguments):(typeof Tt=="function"&&(Tt=x(Tt)),Je.call(this,dt,Et,kt,zt,Tt))};case 6:return function(dt,Et,kt,zt,Tt,ar){return arguments.length!==6?ct.apply(this,arguments):(typeof ar=="function"&&(ar=x(ar)),Je.call(this,dt,Et,kt,zt,Tt,ar))};default:return ct}}a(Vt,"et");function Bt(Je){var ct=a(function(){var dt;if(typeof arguments[0]=="function"){dt=Array(arguments.length),dt[0]=x(arguments[0]);for(var Et=1;Et<arguments.length;Et++)dt[Et]=arguments[Et]}return Je.apply(this,dt||arguments)},"t");switch(Je.length){case 1:return function(dt){return arguments.length!==1?ct.apply(this,arguments):(typeof dt=="function"&&(dt=x(dt)),Je.call(this,dt))};case 2:return function(dt,Et){return arguments.length!==2?ct.apply(this,arguments):(typeof dt=="function"&&(dt=x(dt)),Je.call(this,dt,Et))};case 3:return function(dt,Et,kt){return arguments.length!==3?ct.apply(this,arguments):(typeof dt=="function"&&(dt=x(dt)),Je.call(this,dt,Et,kt))};case 4:return function(dt,Et,kt,zt){return arguments.length!==4?ct.apply(this,arguments):(typeof dt=="function"&&(dt=x(dt)),Je.call(this,dt,Et,kt,zt))};case 5:return function(dt,Et,kt,zt,Tt){return arguments.length!==5?ct.apply(this,arguments):(typeof dt=="function"&&(dt=x(dt)),Je.call(this,dt,Et,kt,zt,Tt))};case 6:return function(dt,Et,kt,zt,Tt,ar){return arguments.length!==6?ct.apply(this,arguments):(typeof dt=="function"&&(dt=x(dt)),Je.call(this,dt,Et,kt,zt,Tt,ar))};default:return ct}}a(Bt,"js");function Er(Je){return(Je=Number(Je))>=0?Je:!1}a(Er,"kP");function Ht(Je){return typeof Je=="string"&&Er(Je)===!1}a(Ht,"jP")}),Mu=F((s,T)=>{"use strict";var f=K(9491),w=Pn(),x="cls@contexts",p="error@context";process.addAsyncListener||Nu();function u(y){this.name=y,this.active=null,this._set=[],this.id=null}a(u,"Ve"),u.prototype.set=function(y,E){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");return this.active[y]=E,E},u.prototype.get=function(y){if(this.active)return this.active[y]},u.prototype.createContext=function(){return Object.create(this.active)},u.prototype.run=function(y){var E=this.createContext();this.enter(E);try{return y(E),E}catch(C){throw C&&(C[p]=E),C}finally{this.exit(E)}},u.prototype.runAndReturn=function(y){var E;return this.run(function(C){E=y(C)}),E},u.prototype.bind=function(y,E){E||(this.active?E=this.active:E=this.createContext());var C=this;return function(){C.enter(E);try{return y.apply(this,arguments)}catch(A){throw A&&(A[p]=E),A}finally{C.exit(E)}}},u.prototype.enter=function(y){f.ok(y,"context must be provided for entering"),this._set.push(this.active),this.active=y},u.prototype.exit=function(y){if(f.ok(y,"context must be provided for exiting"),this.active===y){f.ok(this._set.length,"can't remove top context"),this.active=this._set.pop();return}var E=this._set.lastIndexOf(y);f.ok(E>=0,"context not currently entered; can't exit"),f.ok(E,"can't remove top context"),this._set.splice(E,1)},u.prototype.bindEmitter=function(y){f.ok(y.on&&y.addListener&&y.emit,"can only bind real EEs");var E=this,C="context@"+this.name;function A(D){!D||(D[x]||(D[x]=Object.create(null)),D[x][C]={namespace:E,context:E.active})}a(A,"n");function R(D){if(!(D&&D[x]))return D;var k=D,G=D[x];return Object.keys(G).forEach(function(Z){var Q=G[Z];k=Q.namespace.bind(k,Q.context)}),k}a(R,"i"),w(y,A,R)},u.prototype.fromException=function(y){return y[p]};function g(y){return process.namespaces[y]}a(g,"Tv");function v(y){f.ok(y,"namespace must be given a name!");var E=new u(y);return E.id=process.addAsyncListener({create:function(){return E.active},before:function(C,A){A&&E.enter(A)},after:function(C,A){A&&E.exit(A)},error:function(C){C&&E.exit(C)}}),process.namespaces[y]=E,E}a(v,"UP");function _(y){var E=g(y);f.ok(E,"can't delete nonexistent namespace!"),f.ok(E.id,"don't assign to process.namespaces directly!"),process.removeAsyncListener(E.id),process.namespaces[y]=null}a(_,"Sv");function b(){process.namespaces&&Object.keys(process.namespaces).forEach(function(y){_(y)}),process.namespaces=Object.create(null)}a(b,"Av"),process.namespaces||b(),T.exports={getNamespace:g,createNamespace:v,destroyNamespace:_,reset:b}}),mn=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.CorrelationContextManager=void 0;var T=at(),f=Oo(),w=_e(),x=Ge(),p=Sl(),u=function(){function v(){}return a(v,"e"),v.getCurrentContext=function(){if(!v.enabled)return null;var _=v.session.get(v.CONTEXT_NAME);return _===void 0?null:_},v.generateContextObject=function(_,b,y,E,C,A){return b=b||_,this.enabled?{operation:{name:y,id:_,parentId:b,traceparent:C,tracestate:A},customProperties:new g(E)}:null},v.spanToContextObject=function(_,b,y){var E=new w;return E.traceId=_.traceId,E.spanId=_.spanId,E.traceFlag=w.formatOpenTelemetryTraceFlags(_.traceFlags)||w.DEFAULT_TRACE_FLAG,E.parentId=b,v.generateContextObject(E.traceId,E.parentId,y,null,E)},v.runWithContext=function(_,b){var y;return v.enabled?v.session.bind(b,(y={},y[v.CONTEXT_NAME]=_,y))():b()},v.wrapEmitter=function(_){v.enabled&&v.session.bindEmitter(_)},v.wrapCallback=function(_,b){var y;return v.enabled?v.session.bind(_,b?(y={},y[v.CONTEXT_NAME]=b,y):void 0):_},v.enable=function(_){if(!this.enabled){if(!this.isNodeVersionCompatible()){this.enabled=!1;return}v.hasEverEnabled||(this.forceClsHooked=_,this.hasEverEnabled=!0,typeof this.cls=="undefined"&&(v.forceClsHooked===!0||v.forceClsHooked===void 0&&v.shouldUseClsHooked()?this.cls=mc():this.cls=Mu()),v.session=this.cls.createNamespace("AI-CLS-Session"),f.registerContextPreservation(function(b){return v.session.bind(b)})),this.enabled=!0}},v.startOperation=function(_,b){var y=_&&_.traceContext||null,E=_&&_.traceId?_:null,C=_&&_.headers;if(E){var A=new w("00-"+E.traceId+"-"+E.spanId+"-01"),R=new x(E.traceState?E.traceState.serialize():null),D=v.generateContextObject(E.traceId,"|"+E.traceId+"."+E.spanId+".",typeof b=="string"?b:"",void 0,A,R);return D}if(y){var A=new w(y.traceparent),R=new x(y.tracestate),k=typeof b=="object"?new p(b):null,D=v.generateContextObject(A.traceId,A.parentId,typeof b=="string"?b:k.getOperationName({}),k&&k.getCorrelationContextHeader()||void 0,A,R);return D}if(C){var A=new w(C.traceparent?C.traceparent.toString():null),R=new x(C.tracestate?C.tracestate.toString():null),k=new p(_),D=v.generateContextObject(A.traceId,A.parentId,k.getOperationName({}),k.getCorrelationContextHeader(),A,R);return D}return T.warn("startOperation was called with invalid arguments",arguments),null},v.disable=function(){this.enabled=!1},v.reset=function(){v.hasEverEnabled&&(v.session=null,v.session=this.cls.createNamespace("AI-CLS-Session"))},v.isNodeVersionCompatible=function(){var _=process.versions.node.split(".");return parseInt(_[0])>3||parseInt(_[0])>2&&parseInt(_[1])>2},v.shouldUseClsHooked=function(){var _=process.versions.node.split(".");return parseInt(_[0])>8||parseInt(_[0])>=8&&parseInt(_[1])>=2},v.canUseClsHooked=function(){var _=process.versions.node.split("."),b=parseInt(_[0])>8||parseInt(_[0])>=8&&parseInt(_[1])>=0,y=parseInt(_[0])<8||parseInt(_[0])<=8&&parseInt(_[1])<2,E=parseInt(_[0])>4||parseInt(_[0])>=4&&parseInt(_[1])>=7;return!(b&&y)&&E},v.enabled=!1,v.hasEverEnabled=!1,v.forceClsHooked=void 0,v.CONTEXT_NAME="ApplicationInsights-Context",v}();s.CorrelationContextManager=u;var g=function(){function v(_){this.props=[],this.addHeaderData(_)}return a(v,"e"),v.prototype.addHeaderData=function(_){var b=_?_.split(", "):[];this.props=b.map(function(y){var E=y.split("=");return{key:E[0],value:E[1]}}).concat(this.props)},v.prototype.serializeToHeader=function(){return this.props.map(function(_){return _.key+"="+_.value}).join(", ")},v.prototype.getProperty=function(_){for(var b=0;b<this.props.length;++b){var y=this.props[b];if(y.key===_)return y.value}},v.prototype.setProperty=function(_,b){if(v.bannedCharacters.test(_)||v.bannedCharacters.test(b)){T.warn("Correlation context property keys and values must not contain ',' or '='. setProperty was called with key: "+_+" and value: "+b);return}for(var y=0;y<this.props.length;++y){var E=this.props[y];if(E.key===_){E.value=b;return}}this.props.push({key:_,value:b})},v.bannedCharacters=/[,=]/,v}()}),br=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.dispose=s.enable=void 0;var T=$t(),f=he(),w=[],x=a(function(g){var v=g.data.message;w.forEach(function(_){v instanceof Error?_.trackException({exception:v}):(v.lastIndexOf(`
`)==v.length-1&&(v=v.substring(0,v.length-1)),_.trackTrace({message:v,severity:g.data.stderr?T.SeverityLevel.Warning:T.SeverityLevel.Information}))})},"Bc");function p(g,v){g?(w.length===0&&f.channel.subscribe("console",x),w.push(v)):(w=w.filter(function(_){return _!=v}),w.length===0&&f.channel.unsubscribe("console",x))}a(p,"VP"),s.enable=p;function u(){f.channel.unsubscribe("console",x),w=[]}a(u,"$P"),s.dispose=u}),Bn=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.dispose=s.enable=void 0;var T=$t(),f=he(),w=[],x={10:T.SeverityLevel.Verbose,20:T.SeverityLevel.Verbose,30:T.SeverityLevel.Information,40:T.SeverityLevel.Warning,50:T.SeverityLevel.Error,60:T.SeverityLevel.Critical},p=a(function(v){var _=v.data.result;w.forEach(function(b){var y=x[v.data.level];_ instanceof Error?b.trackException({exception:_}):b.trackTrace({message:_,severity:y})})},"Fc");function u(v,_){v?(w.length===0&&f.channel.subscribe("bunyan",p),w.push(_)):(w=w.filter(function(b){return b!=_}),w.length===0&&f.channel.unsubscribe("bunyan",p))}a(u,"KP"),s.enable=u;function g(){f.channel.unsubscribe("bunyan",p),w=[]}a(g,"XP"),s.dispose=g}),Xr=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.dispose=s.enable=void 0;var T=$t(),f=he(),w=[],x={syslog:function(v){var _={emerg:T.SeverityLevel.Critical,alert:T.SeverityLevel.Critical,crit:T.SeverityLevel.Critical,error:T.SeverityLevel.Error,warning:T.SeverityLevel.Warning,notice:T.SeverityLevel.Information,info:T.SeverityLevel.Information,debug:T.SeverityLevel.Verbose};return _[v]===void 0?T.SeverityLevel.Information:_[v]},npm:function(v){var _={error:T.SeverityLevel.Error,warn:T.SeverityLevel.Warning,info:T.SeverityLevel.Information,verbose:T.SeverityLevel.Verbose,debug:T.SeverityLevel.Verbose,silly:T.SeverityLevel.Verbose};return _[v]===void 0?T.SeverityLevel.Information:_[v]},unknown:function(v){return T.SeverityLevel.Information}},p=a(function(v){var _=v.data.message;w.forEach(function(b){if(_ instanceof Error)b.trackException({exception:_,properties:v.data.meta});else{var y=x[v.data.levelKind](v.data.level);b.trackTrace({message:_,severity:y,properties:v.data.meta})}})},"$c");function u(v,_){v?(w.length===0&&f.channel.subscribe("winston",p),w.push(_)):(w=w.filter(function(b){return b!=_}),w.length===0&&f.channel.unsubscribe("winston",p))}a(u,"QP"),s.enable=u;function g(){f.channel.unsubscribe("winston",p),w=[]}a(g,"WP"),s.dispose=g}),Or=F((s,T)=>{"use strict";var f=Oo(),w=function(){function x(p){if(x.INSTANCE)throw new Error("Console logging adapter tracking should be configured from the applicationInsights object");this._client=p,x.INSTANCE=this}return a(x,"e"),x.prototype.enable=function(p,u){f.IsInitialized&&(br().enable(p&&u,this._client),Bn().enable(p,this._client),Xr().enable(p,this._client))},x.prototype.isInitialized=function(){return this._isInitialized},x.prototype.dispose=function(){x.INSTANCE=null,this.enable(!1,!1)},x._methodNames=["debug","info","log","warn","error"],x}();T.exports=w}),Lu=F((s,T)=>{"use strict";var f=function(){function w(x){if(w.INSTANCE)throw new Error("Exception tracking should be configured from the applicationInsights object");w.INSTANCE=this,this._client=x;var p=process.versions.node.split(".");w._canUseUncaughtExceptionMonitor=parseInt(p[0])>13||parseInt(p[0])===13&&parseInt(p[1])>=7}return a(w,"e"),w.prototype.isInitialized=function(){return this._isInitialized},w.prototype.enable=function(x){var p=this;if(x){this._isInitialized=!0;var u=this;if(!this._exceptionListenerHandle){var g=a(function(v,_,b){b===void 0&&(b=new Error(w._FALLBACK_ERROR_MESSAGE)),p._client.trackException({exception:b}),p._client.flush({isAppCrashing:!0}),v&&_&&process.listeners(_).length===1&&(console.error(b),process.exit(1))},"i");w._canUseUncaughtExceptionMonitor?(this._exceptionListenerHandle=g.bind(this,!1,void 0),process.on(w.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME,this._exceptionListenerHandle)):(this._exceptionListenerHandle=g.bind(this,!0,w.UNCAUGHT_EXCEPTION_HANDLER_NAME),this._rejectionListenerHandle=g.bind(this,!1,void 0),process.on(w.UNCAUGHT_EXCEPTION_HANDLER_NAME,this._exceptionListenerHandle),process.on(w.UNHANDLED_REJECTION_HANDLER_NAME,this._rejectionListenerHandle))}}else this._exceptionListenerHandle&&(w._canUseUncaughtExceptionMonitor?process.removeListener(w.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME,this._exceptionListenerHandle):(process.removeListener(w.UNCAUGHT_EXCEPTION_HANDLER_NAME,this._exceptionListenerHandle),process.removeListener(w.UNHANDLED_REJECTION_HANDLER_NAME,this._rejectionListenerHandle)),this._exceptionListenerHandle=void 0,this._rejectionListenerHandle=void 0,delete this._exceptionListenerHandle,delete this._rejectionListenerHandle)},w.prototype.dispose=function(){w.INSTANCE=null,this.enable(!1),this._isInitialized=!1},w.INSTANCE=null,w.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME="uncaughtExceptionMonitor",w.UNCAUGHT_EXCEPTION_HANDLER_NAME="uncaughtException",w.UNHANDLED_REJECTION_HANDLER_NAME="unhandledRejection",w._RETHROW_EXIT_MESSAGE="Application Insights Rethrow Exception Handler",w._FALLBACK_ERROR_MESSAGE="A promise was rejected without providing an error. Application Insights generated this error stack for you.",w._canUseUncaughtExceptionMonitor=!1,w}();T.exports=f}),$r=F(s=>{"use strict";var T;Object.defineProperty(s,"__esModule",{value:!0}),s.HeartBeatMetricName=s.DependencyTypeName=s.SpanAttribute=s.TelemetryTypeStringToQuickPulseDocumentType=s.TelemetryTypeStringToQuickPulseType=s.QuickPulseType=s.QuickPulseDocumentType=s.PerformanceToQuickPulseCounter=s.MetricId=s.PerformanceCounter=s.QuickPulseCounter=s.DEFAULT_LIVEMETRICS_HOST=s.DEFAULT_LIVEMETRICS_ENDPOINT=s.DEFAULT_BREEZE_ENDPOINT=void 0,s.DEFAULT_BREEZE_ENDPOINT="https://dc.services.visualstudio.com",s.DEFAULT_LIVEMETRICS_ENDPOINT="https://rt.services.visualstudio.com",s.DEFAULT_LIVEMETRICS_HOST="rt.services.visualstudio.com";var f;(function(p){p.COMMITTED_BYTES="\\Memory\\Committed Bytes",p.PROCESSOR_TIME="\\Processor(_Total)\\% Processor Time",p.REQUEST_RATE="\\ApplicationInsights\\Requests/Sec",p.REQUEST_FAILURE_RATE="\\ApplicationInsights\\Requests Failed/Sec",p.REQUEST_DURATION="\\ApplicationInsights\\Request Duration",p.DEPENDENCY_RATE="\\ApplicationInsights\\Dependency Calls/Sec",p.DEPENDENCY_FAILURE_RATE="\\ApplicationInsights\\Dependency Calls Failed/Sec",p.DEPENDENCY_DURATION="\\ApplicationInsights\\Dependency Call Duration",p.EXCEPTION_RATE="\\ApplicationInsights\\Exceptions/Sec"})(f=s.QuickPulseCounter||(s.QuickPulseCounter={}));var w;(function(p){p.PRIVATE_BYTES="\\Process(??APP_WIN32_PROC??)\\Private Bytes",p.AVAILABLE_BYTES="\\Memory\\Available Bytes",p.PROCESSOR_TIME="\\Processor(_Total)\\% Processor Time",p.PROCESS_TIME="\\Process(??APP_WIN32_PROC??)\\% Processor Time",p.REQUEST_RATE="\\ASP.NET Applications(??APP_W3SVC_PROC??)\\Requests/Sec",p.REQUEST_DURATION="\\ASP.NET Applications(??APP_W3SVC_PROC??)\\Request Execution Time"})(w=s.PerformanceCounter||(s.PerformanceCounter={}));var x;(function(p){p.REQUESTS_DURATION="requests/duration",p.DEPENDENCIES_DURATION="dependencies/duration",p.EXCEPTIONS_COUNT="exceptions/count",p.TRACES_COUNT="traces/count"})(x=s.MetricId||(s.MetricId={})),s.PerformanceToQuickPulseCounter=(T={},T[w.PROCESSOR_TIME]=f.PROCESSOR_TIME,T[w.REQUEST_RATE]=f.REQUEST_RATE,T[w.REQUEST_DURATION]=f.REQUEST_DURATION,T[f.COMMITTED_BYTES]=f.COMMITTED_BYTES,T[f.REQUEST_FAILURE_RATE]=f.REQUEST_FAILURE_RATE,T[f.DEPENDENCY_RATE]=f.DEPENDENCY_RATE,T[f.DEPENDENCY_FAILURE_RATE]=f.DEPENDENCY_FAILURE_RATE,T[f.DEPENDENCY_DURATION]=f.DEPENDENCY_DURATION,T[f.EXCEPTION_RATE]=f.EXCEPTION_RATE,T),s.QuickPulseDocumentType={Event:"Event",Exception:"Exception",Trace:"Trace",Metric:"Metric",Request:"Request",Dependency:"RemoteDependency",Availability:"Availability",PageView:"PageView"},s.QuickPulseType={Event:"EventTelemetryDocument",Exception:"ExceptionTelemetryDocument",Trace:"TraceTelemetryDocument",Metric:"MetricTelemetryDocument",Request:"RequestTelemetryDocument",Dependency:"DependencyTelemetryDocument",Availability:"AvailabilityTelemetryDocument",PageView:"PageViewTelemetryDocument"},s.TelemetryTypeStringToQuickPulseType={EventData:s.QuickPulseType.Event,ExceptionData:s.QuickPulseType.Exception,MessageData:s.QuickPulseType.Trace,MetricData:s.QuickPulseType.Metric,RequestData:s.QuickPulseType.Request,RemoteDependencyData:s.QuickPulseType.Dependency,AvailabilityData:s.QuickPulseType.Availability,PageViewData:s.QuickPulseType.PageView},s.TelemetryTypeStringToQuickPulseDocumentType={EventData:s.QuickPulseDocumentType.Event,ExceptionData:s.QuickPulseDocumentType.Exception,MessageData:s.QuickPulseDocumentType.Trace,MetricData:s.QuickPulseDocumentType.Metric,RequestData:s.QuickPulseDocumentType.Request,RemoteDependencyData:s.QuickPulseDocumentType.Dependency,AvailabilityData:s.QuickPulseDocumentType.Availability,PageViewData:s.QuickPulseDocumentType.PageView},s.SpanAttribute={HttpHost:"http.host",HttpMethod:"http.method",HttpPort:"http.port",HttpStatusCode:"http.status_code",HttpUrl:"http.url",HttpUserAgent:"http.user_agent",GrpcMethod:"grpc.method",GrpcService:"rpc.service"},s.DependencyTypeName={Grpc:"GRPC",Http:"HTTP",InProc:"InProc"},s.HeartBeatMetricName="HeartBeat"}),ya=F((s,T)=>{"use strict";var f=K(2037),w=$r(),x=function(){function p(u,g,v){g===void 0&&(g=6e4),v===void 0&&(v=!1),this._lastIntervalRequestExecutionTime=0,this._lastIntervalDependencyExecutionTime=0,p.INSTANCE||(p.INSTANCE=this),this._isInitialized=!1,this._client=u,this._collectionInterval=g,this._enableLiveMetricsCounters=v}return a(p,"e"),p.prototype.enable=function(u,g){var v=this;this._isEnabled=u,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),u?this._handle||(this._lastCpus=f.cpus(),this._lastRequests={totalRequestCount:p._totalRequestCount,totalFailedRequestCount:p._totalFailedRequestCount,time:+new Date},this._lastDependencies={totalDependencyCount:p._totalDependencyCount,totalFailedDependencyCount:p._totalFailedDependencyCount,time:+new Date},this._lastExceptions={totalExceptionCount:p._totalExceptionCount,time:+new Date},typeof process.cpuUsage=="function"&&(this._lastAppCpuUsage=process.cpuUsage()),this._lastHrtime=process.hrtime(),this._collectionInterval=g||this._collectionInterval,this._handle=setInterval(function(){return v.trackPerformance()},this._collectionInterval),this._handle.unref()):this._handle&&(clearInterval(this._handle),this._handle=void 0)},p.countRequest=function(u,g){var v;if(p.isEnabled()){if(typeof u=="string")v=+new Date("1970-01-01T"+u+"Z");else if(typeof u=="number")v=u;else return;p._intervalRequestExecutionTime+=v,g===!1&&p._totalFailedRequestCount++,p._totalRequestCount++}},p.countException=function(){p._totalExceptionCount++},p.countDependency=function(u,g){var v;if(p.isEnabled()){if(typeof u=="string")v=+new Date("1970-01-01T"+u+"Z");else if(typeof u=="number")v=u;else return;p._intervalDependencyExecutionTime+=v,g===!1&&p._totalFailedDependencyCount++,p._totalDependencyCount++}},p.prototype.isInitialized=function(){return this._isInitialized},p.isEnabled=function(){return p.INSTANCE&&p.INSTANCE._isEnabled},p.prototype.trackPerformance=function(){this._trackCpu(),this._trackMemory(),this._trackNetwork(),this._trackDependencyRate(),this._trackExceptionRate()},p.prototype._trackCpu=function(){var u=f.cpus();if(u&&u.length&&this._lastCpus&&u.length===this._lastCpus.length){for(var g=0,v=0,_=0,b=0,y=0,E=0;!!u&&E<u.length;E++){var C=u[E],A=this._lastCpus[E],R="% cpu("+E+") ",D=C.model,k=C.speed,G=C.times,Z=A.times,Q=G.user-Z.user||0;g+=Q;var fe=G.sys-Z.sys||0;v+=fe;var Se=G.nice-Z.nice||0;_+=Se;var Me=G.idle-Z.idle||0;b+=Me;var He=G.irq-Z.irq||0;y+=He}var Qe=void 0;if(typeof process.cpuUsage=="function"){var Ye=process.cpuUsage(),mt=process.hrtime(),Ct=Ye.user-this._lastAppCpuUsage.user+(Ye.system-this._lastAppCpuUsage.system)||0;if(typeof this._lastHrtime!="undefined"&&this._lastHrtime.length===2){var Vt=(mt[0]-this._lastHrtime[0])*1e6+(mt[1]-this._lastHrtime[1])/1e3||0;Qe=100*Ct/(Vt*u.length)}this._lastAppCpuUsage=Ye,this._lastHrtime=mt}var Bt=g+v+_+b+y||1;this._client.trackMetric({name:w.PerformanceCounter.PROCESSOR_TIME,value:(Bt-b)/Bt*100}),this._client.trackMetric({name:w.PerformanceCounter.PROCESS_TIME,value:Qe||g/Bt*100})}this._lastCpus=u},p.prototype._trackMemory=function(){var u=f.freemem(),g=process.memoryUsage().rss,v=f.totalmem()-u;this._client.trackMetric({name:w.PerformanceCounter.PRIVATE_BYTES,value:g}),this._client.trackMetric({name:w.PerformanceCounter.AVAILABLE_BYTES,value:u}),this._enableLiveMetricsCounters&&this._client.trackMetric({name:w.QuickPulseCounter.COMMITTED_BYTES,value:v})},p.prototype._trackNetwork=function(){var u=this._lastRequests,g={totalRequestCount:p._totalRequestCount,totalFailedRequestCount:p._totalFailedRequestCount,time:+new Date},v=g.totalRequestCount-u.totalRequestCount||0,_=g.totalFailedRequestCount-u.totalFailedRequestCount||0,b=g.time-u.time,y=b/1e3,E=(p._intervalRequestExecutionTime-this._lastIntervalRequestExecutionTime)/v||0;if(this._lastIntervalRequestExecutionTime=p._intervalRequestExecutionTime,b>0){var C=v/y,A=_/y;this._client.trackMetric({name:w.PerformanceCounter.REQUEST_RATE,value:C}),(!this._enableLiveMetricsCounters||v>0)&&this._client.trackMetric({name:w.PerformanceCounter.REQUEST_DURATION,value:E}),this._enableLiveMetricsCounters&&this._client.trackMetric({name:w.QuickPulseCounter.REQUEST_FAILURE_RATE,value:A})}this._lastRequests=g},p.prototype._trackDependencyRate=function(){if(this._enableLiveMetricsCounters){var u=this._lastDependencies,g={totalDependencyCount:p._totalDependencyCount,totalFailedDependencyCount:p._totalFailedDependencyCount,time:+new Date},v=g.totalDependencyCount-u.totalDependencyCount||0,_=g.totalFailedDependencyCount-u.totalFailedDependencyCount||0,b=g.time-u.time,y=b/1e3,E=(p._intervalDependencyExecutionTime-this._lastIntervalDependencyExecutionTime)/v||0;if(this._lastIntervalDependencyExecutionTime=p._intervalDependencyExecutionTime,b>0){var C=v/y,A=_/y;this._client.trackMetric({name:w.QuickPulseCounter.DEPENDENCY_RATE,value:C}),this._client.trackMetric({name:w.QuickPulseCounter.DEPENDENCY_FAILURE_RATE,value:A}),(!this._enableLiveMetricsCounters||v>0)&&this._client.trackMetric({name:w.QuickPulseCounter.DEPENDENCY_DURATION,value:E})}this._lastDependencies=g}},p.prototype._trackExceptionRate=function(){if(this._enableLiveMetricsCounters){var u=this._lastExceptions,g={totalExceptionCount:p._totalExceptionCount,time:+new Date},v=g.totalExceptionCount-u.totalExceptionCount||0,_=g.time-u.time,b=_/1e3;if(_>0){var y=v/b;this._client.trackMetric({name:w.QuickPulseCounter.EXCEPTION_RATE,value:y})}this._lastExceptions=g}},p.prototype.dispose=function(){p.INSTANCE=null,this.enable(!1),this._isInitialized=!1},p._totalRequestCount=0,p._totalFailedRequestCount=0,p._totalDependencyCount=0,p._totalFailedDependencyCount=0,p._totalExceptionCount=0,p._intervalDependencyExecutionTime=0,p._intervalRequestExecutionTime=0,p}();T.exports=x}),Cl=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.AggregatedMetricCounter=void 0;var T=function(){function f(w){this.dimensions=w,this.totalCount=0,this.lastTotalCount=0,this.intervalExecutionTime=0,this.lastTime=+new Date,this.lastIntervalExecutionTime=0}return a(f,"e"),f}();s.AggregatedMetricCounter=T}),$u=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.PreaggregatedMetricPropertyNames=void 0,s.PreaggregatedMetricPropertyNames={cloudRoleInstance:"cloud/roleInstance",cloudRoleName:"cloud/roleName",operationSynthetic:"operation/synthetic",requestSuccess:"Request.Success",requestResultCode:"request/resultCode",dependencyType:"Dependency.Type",dependencyTarget:"dependency/target",dependencySuccess:"Dependency.Success",dependencyResultCode:"dependency/resultCode",traceSeverityLevel:"trace/severityLevel"}}),Tl=F((s,T)=>{"use strict";var f=s&&s.__assign||function(){return f=Object.assign||function(g){for(var v,_=1,b=arguments.length;_<b;_++){v=arguments[_];for(var y in v)Object.prototype.hasOwnProperty.call(v,y)&&(g[y]=v[y])}return g},f.apply(this,arguments)},w=$r(),x=Cl(),p=$u(),u=function(){function g(v,_){_===void 0&&(_=6e4),g.INSTANCE||(g.INSTANCE=this),this._isInitialized=!1,g._dependencyCountersCollection=[],g._requestCountersCollection=[],g._exceptionCountersCollection=[],g._traceCountersCollection=[],this._client=v,this._collectionInterval=_}return a(g,"e"),g.prototype.enable=function(v,_){var b=this;this._isEnabled=v,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),v?this._handle||(this._collectionInterval=_||this._collectionInterval,this._handle=setInterval(function(){return b.trackPreAggregatedMetrics()},this._collectionInterval),this._handle.unref()):this._handle&&(clearInterval(this._handle),this._handle=void 0)},g.countException=function(v){if(g.isEnabled()){var _=g._getAggregatedCounter(v,this._exceptionCountersCollection);_.totalCount++}},g.countTrace=function(v){if(g.isEnabled()){var _=g._getAggregatedCounter(v,this._traceCountersCollection);_.totalCount++}},g.countRequest=function(v,_){if(g.isEnabled()){var b,y=g._getAggregatedCounter(_,this._requestCountersCollection);if(typeof v=="string")b=+new Date("1970-01-01T"+v+"Z");else if(typeof v=="number")b=v;else return;y.intervalExecutionTime+=b,y.totalCount++}},g.countDependency=function(v,_){if(g.isEnabled()){var b=g._getAggregatedCounter(_,this._dependencyCountersCollection),y;if(typeof v=="string")y=+new Date("1970-01-01T"+v+"Z");else if(typeof v=="number")y=v;else return;b.intervalExecutionTime+=y,b.totalCount++}},g.prototype.isInitialized=function(){return this._isInitialized},g.isEnabled=function(){return g.INSTANCE&&g.INSTANCE._isEnabled},g.prototype.trackPreAggregatedMetrics=function(){this._trackRequestMetrics(),this._trackDependencyMetrics(),this._trackExceptionMetrics(),this._trackTraceMetrics()},g._getAggregatedCounter=function(v,_){for(var b=!1,y=0;y<_.length;y++){if(v===_[y].dimensions)return _[y];if(Object.keys(v).length===Object.keys(_[y].dimensions).length){for(var E in v)if(v[E]!=_[y].dimensions[E]){b=!0;break}if(!b)return _[y];b=!1}}var C=new x.AggregatedMetricCounter(v);return _.push(C),C},g.prototype._trackRequestMetrics=function(){for(var v=0;v<g._requestCountersCollection.length;v++){var _=g._requestCountersCollection[v];_.time=+new Date;var b=_.totalCount-_.lastTotalCount||0,y=_.time-_.lastTime,E=(_.intervalExecutionTime-_.lastIntervalExecutionTime)/b||0;_.lastIntervalExecutionTime=_.intervalExecutionTime,y>0&&b>0&&this._trackPreAggregatedMetric({name:"Server response time",dimensions:_.dimensions,value:E,count:b,aggregationInterval:y,metricType:w.MetricId.REQUESTS_DURATION}),_.lastTotalCount=_.totalCount,_.lastTime=_.time}},g.prototype._trackDependencyMetrics=function(){for(var v=0;v<g._dependencyCountersCollection.length;v++){var _=g._dependencyCountersCollection[v];_.time=+new Date;var b=_.totalCount-_.lastTotalCount||0,y=_.time-_.lastTime,E=(_.intervalExecutionTime-_.lastIntervalExecutionTime)/b||0;_.lastIntervalExecutionTime=_.intervalExecutionTime,y>0&&b>0&&this._trackPreAggregatedMetric({name:"Dependency duration",dimensions:_.dimensions,value:E,count:b,aggregationInterval:y,metricType:w.MetricId.DEPENDENCIES_DURATION}),_.lastTotalCount=_.totalCount,_.lastTime=_.time}},g.prototype._trackExceptionMetrics=function(){for(var v=0;v<g._exceptionCountersCollection.length;v++){var _=g._exceptionCountersCollection[v],b=_.totalCount-_.lastTotalCount||0,y=_.time-_.lastTime;this._trackPreAggregatedMetric({name:"Exceptions",dimensions:_.dimensions,value:b,count:b,aggregationInterval:y,metricType:w.MetricId.EXCEPTIONS_COUNT}),_.lastTotalCount=_.totalCount,_.lastTime=_.time}},g.prototype._trackTraceMetrics=function(){for(var v=0;v<g._traceCountersCollection.length;v++){var _=g._traceCountersCollection[v],b=_.totalCount-_.lastTotalCount||0,y=_.time-_.lastTime;this._trackPreAggregatedMetric({name:"Traces",dimensions:_.dimensions,value:b,count:b,aggregationInterval:y,metricType:w.MetricId.TRACES_COUNT}),_.lastTotalCount=_.totalCount,_.lastTime=_.time}},g.prototype._trackPreAggregatedMetric=function(v){var _={};for(var b in v.dimensions)_[p.PreaggregatedMetricPropertyNames[b]]=v.dimensions[b];_=f(f({},_),{"_MS.MetricId":v.metricType,"_MS.AggregationIntervalMs":String(v.aggregationInterval),"_MS.IsAutocollected":"True"});var y={name:v.name,value:v.value,count:v.count,properties:_,kind:"Aggregation"};this._client.trackMetric(y)},g.prototype.dispose=function(){g.INSTANCE=null,this.enable(!1),this._isInitialized=!1},g}();T.exports=u}),ds=F((s,T)=>{"use strict";var f=K(2037),w=K(7147),x=K(1017),p=$t(),u=at(),g=function(){function v(_){this.keys=new p.ContextTagKeys,this.tags={},this._loadApplicationContext(_),this._loadDeviceContext(),this._loadInternalContext()}return a(v,"e"),v.prototype._loadApplicationContext=function(_){if(_=_||x.resolve(__dirname,"../../../../package.json"),!v.appVersion[_]){v.appVersion[_]="unknown";try{var b=JSON.parse(w.readFileSync(_,"utf8"));b&&typeof b.version=="string"&&(v.appVersion[_]=b.version)}catch(y){u.info("unable to read app version: ",y)}}this.tags[this.keys.applicationVersion]=v.appVersion[_]},v.prototype._loadDeviceContext=function(){this.tags[this.keys.deviceId]="",this.tags[this.keys.cloudRoleInstance]=f&&f.hostname(),this.tags[this.keys.deviceOSVersion]=f&&f.type()+" "+f.release(),this.tags[this.keys.cloudRole]=v.DefaultRoleName,this.tags["ai.device.osArchitecture"]=f&&f.arch(),this.tags["ai.device.osPlatform"]=f&&f.platform()},v.prototype._loadInternalContext=function(){var _=x.resolve(__dirname,"../../package.json");if(!v.sdkVersion){v.sdkVersion="unknown";try{var b=JSON.parse(w.readFileSync(_,"utf8"));b&&typeof b.version=="string"&&(v.sdkVersion=b.version)}catch(y){u.info("unable to read app version: ",y)}}this.tags[this.keys.internalSdkVersion]="node:"+v.sdkVersion},v.DefaultRoleName="Web",v.appVersion={},v.sdkVersion=null,v}();T.exports=g}),hs=F((s,T)=>{"use strict";var f=s&&s.__extends||function(){var b=a(function(y,E){return b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(C,A){C.__proto__=A}||function(C,A){for(var R in A)Object.prototype.hasOwnProperty.call(A,R)&&(C[R]=A[R])},b(y,E)},"e");return function(y,E){b(y,E);function C(){this.constructor=y}a(C,"n"),y.prototype=E===null?Object.create(E):(C.prototype=E.prototype,new C)}}(),w=K(7310),x=$t(),p=fn(),u=Po(),g=bl(),v=J(),_=function(b){f(y,b);function y(E,C){var A=b.call(this)||this;return C&&C.method&&E&&(A.method=C.method,A.url=y._getUrlFromRequestOptions(E,C),A.startTime=+new Date),A}return a(y,"t"),y.prototype.onError=function(E){this._setStatus(void 0,E)},y.prototype.onResponse=function(E){this._setStatus(E.statusCode,void 0),this.correlationId=p.getCorrelationContextTarget(E,u.requestContextTargetKey)},y.prototype.getDependencyTelemetry=function(E,C){var A=w.parse(this.url);A.search=void 0,A.hash=void 0;var R=this.method.toUpperCase()+" "+A.pathname,D=x.RemoteDependencyDataConstants.TYPE_HTTP,k=A.hostname;A.port&&(k+=":"+A.port),this.correlationId?(D=x.RemoteDependencyDataConstants.TYPE_AI,this.correlationId!==v.correlationIdPrefix&&(k+=" | "+this.correlationId)):D=x.RemoteDependencyDataConstants.TYPE_HTTP;var G={id:C,name:R,data:this.url,duration:this.duration,success:this._isSuccess(),resultCode:this.statusCode?this.statusCode.toString():null,properties:this.properties||{},dependencyTypeName:D,target:k};if(E&&E.time?G.time=E.time:this.startTime&&(G.time=new Date(this.startTime)),E){for(var Z in E)G[Z]||(G[Z]=E[Z]);if(E.properties)for(var Z in E.properties)G.properties[Z]=E.properties[Z]}return G},y._getUrlFromRequestOptions=function(E,C){if(typeof E=="string")if(E.indexOf("http://")===0||E.indexOf("https://")===0)E=w.parse(E);else{var A=w.parse(E);A.host==="443"?E=w.parse("https://"+E):E=w.parse("http://"+E)}else{if(E&&typeof w.URL=="function"&&E instanceof w.URL)return w.format(E);var R=E;E={},R&&Object.keys(R).forEach(function(G){E[G]=R[G]})}if(E.path){var D=w.parse(E.path);E.pathname=D.pathname,E.search=D.search}if(E.host&&E.port){var k=w.parse("http://"+E.host);!k.port&&E.port&&(E.hostname=E.host,delete E.host)}return E.protocol=E.protocol||C.agent&&C.agent.protocol||C.protocol||void 0,E.hostname=E.hostname||"localhost",w.format(E)},y}(g);T.exports=_}),fs=F(s=>{"use strict";var T=s&&s.__assign||function(){return T=Object.assign||function(u){for(var g,v=1,_=arguments.length;v<_;v++){g=arguments[v];for(var b in g)Object.prototype.hasOwnProperty.call(g,b)&&(u[b]=g[b])}return u},T.apply(this,arguments)};Object.defineProperty(s,"__esModule",{value:!0}),s.spanToTelemetryContract=void 0;var f=ir(),w=$r();function x(u){var g=T({},u);return Object.keys(w.SpanAttribute).forEach(function(v){delete g[v]}),g}a(x,"Qc");function p(u){var g="|"+u.spanContext().traceId+"."+u.spanContext().spanId+".",v=Math.round(u._duration[0]*1e3+u._duration[1]/1e6),_=u.attributes["peer.address"]?u.attributes["peer.address"].toString():"",b=u.attributes.component?u.attributes.component.toString():"",y=b.toUpperCase()===w.DependencyTypeName.Http||!!u.attributes[w.SpanAttribute.HttpUrl],E=b.toLowerCase()===w.DependencyTypeName.Grpc;if(y){var C=u.attributes[w.SpanAttribute.HttpMethod]||"GET",A=new URL(u.attributes[w.SpanAttribute.HttpUrl].toString()),R=u.attributes[w.SpanAttribute.HttpHost]||A.host,D=u.attributes[w.SpanAttribute.HttpPort]||A.port||null,k=A.pathname||"/",G=C+" "+k,Z=w.DependencyTypeName.Http,Q=D?(R+":"+D).toString():R.toString(),fe=A.toString(),Se=u.attributes[w.SpanAttribute.HttpStatusCode]||u.status.code||0,Me=Se<400;return{id:g,name:G,dependencyTypeName:Z,target:Q,data:fe,success:Me,duration:v,url:fe,resultCode:String(Se),properties:x(u.attributes)}}else if(E){var C=u.attributes[w.SpanAttribute.GrpcMethod]||"rpc",He=u.attributes[w.SpanAttribute.GrpcService],Qe=He?C+" "+He:u.name;return{id:g,duration:v,name:Qe,target:He.toString(),data:He.toString()||Qe,url:He.toString()||Qe,dependencyTypeName:w.DependencyTypeName.Grpc,resultCode:String(u.status.code||0),success:u.status.code===0,properties:x(u.attributes)}}else{var Ye=u.name,mt=u.links&&u.links.map(function(Ct){return{operation_Id:Ct.context.traceId,id:Ct.context.spanId}});return{id:g,duration:v,name:Ye,target:_,data:_||Ye,url:_||Ye,dependencyTypeName:u.kind===f.SpanKind.INTERNAL?w.DependencyTypeName.InProc:b||u.name,resultCode:String(u.status.code||0),success:u.status.code===0,properties:T(T({},x(u.attributes)),{"_MS.links":mt||void 0})}}}a(p,"gR"),s.spanToTelemetryContract=p}),Fu=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.enable=s.subscriber=void 0;var T=ir(),f=he(),w=_e(),x=fs(),p=we(),u=[],g=a(function(_){var b=_.data,y=x.spanToTelemetryContract(b),E=b.spanContext(),C=new w;C.traceId=E.traceId,C.spanId=E.spanId,C.traceFlag=w.formatOpenTelemetryTraceFlags(E.traceFlags),C.parentId=b.parentSpanId?"|"+E.traceId+"."+b.parentSpanId+".":null,p.AsyncScopeManager.with(b,function(){u.forEach(function(A){b.kind===T.SpanKind.SERVER?A.trackRequest(y):(b.kind===T.SpanKind.CLIENT||b.kind===T.SpanKind.INTERNAL)&&A.trackDependency(y)})})},"ER");s.subscriber=g;function v(_,b){_?(u.length===0&&f.channel.subscribe("azure-coretracing",s.subscriber),u.push(b)):(u=u.filter(function(y){return y!=b}),u.length===0&&f.channel.unsubscribe("azure-coretracing",s.subscriber))}a(v,"yR"),s.enable=v}),Bu=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.enable=s.subscriber=void 0;var T=he(),f=[],w=a(function(p){p.data.event.commandName!=="ismaster"&&f.forEach(function(u){var g=p.data.startedData&&p.data.startedData.databaseName||"Unknown database";u.trackDependency({target:g,data:p.data.event.commandName,name:p.data.event.commandName,duration:p.data.event.duration,success:p.data.succeeded,resultCode:p.data.succeeded?"0":"1",time:p.data.startedData.time,dependencyTypeName:"mongodb"})})},"TR");s.subscriber=w;function x(p,u){p?(f.length===0&&T.channel.subscribe("mongodb",s.subscriber),f.push(u)):(f=f.filter(function(g){return g!=u}),f.length===0&&T.channel.unsubscribe("mongodb",s.subscriber))}a(x,"SR"),s.enable=x}),Hu=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.enable=s.subscriber=void 0;var T=he(),f=[],w=a(function(p){f.forEach(function(u){var g=p.data.query||{},v=g.sql||"Unknown query",_=!p.data.err,b=g._connection||{},y=b.config||{},E=y.socketPath?y.socketPath:(y.host||"localhost")+":"+y.port;u.trackDependency({target:E,data:v,name:v,duration:p.data.duration,success:_,resultCode:_?"0":"1",time:p.data.time,dependencyTypeName:"mysql"})})},"AR");s.subscriber=w;function x(p,u){p?(f.length===0&&T.channel.subscribe("mysql",s.subscriber),f.push(u)):(f=f.filter(function(g){return g!=u}),f.length===0&&T.channel.unsubscribe("mysql",s.subscriber))}a(x,"bR"),s.enable=x}),Uu=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.enable=s.subscriber=void 0;var T=he(),f=[],w=a(function(p){f.forEach(function(u){p.data.commandObj.command!=="info"&&u.trackDependency({target:p.data.address,name:p.data.commandObj.command,data:p.data.commandObj.command,duration:p.data.duration,success:!p.data.err,resultCode:p.data.err?"1":"0",time:p.data.time,dependencyTypeName:"redis"})})},"IR");s.subscriber=w;function x(p,u){p?(f.length===0&&T.channel.subscribe("redis",s.subscriber),f.push(u)):(f=f.filter(function(g){return g!=u}),f.length===0&&T.channel.unsubscribe("redis",s.subscriber))}a(x,"CR"),s.enable=x}),Ur=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.enable=s.subscriber=void 0;var T=he(),f=[],w=a(function(p){f.forEach(function(u){var g=p.data.query,v=g.preparable&&g.preparable.text||g.plan||g.text||"unknown query",_=!p.data.error,b=p.data.database.host+":"+p.data.database.port;u.trackDependency({target:b,data:v,name:v,duration:p.data.duration,success:_,resultCode:_?"0":"1",time:p.data.time,dependencyTypeName:"postgres"})})},"OR");s.subscriber=w;function x(p,u){p?(f.length===0&&T.channel.subscribe("postgres",s.subscriber),f.push(u)):(f=f.filter(function(g){return g!=u}),f.length===0&&T.channel.unsubscribe("postgres",s.subscriber))}a(x,"PR"),s.enable=x}),_a=F((s,T)=>{"use strict";var f=s&&s.__spreadArrays||function(){for(var A=0,R=0,D=arguments.length;R<D;R++)A+=arguments[R].length;for(var k=Array(A),G=0,R=0;R<D;R++)for(var Z=arguments[R],Q=0,fe=Z.length;Q<fe;Q++,G++)k[G]=Z[Q];return k},w=K(3685),x=K(5687),p=at(),u=fn(),g=Po(),v=hs(),_=mn(),b=J(),y=_e(),E=Oo(),C=function(){function A(R){if(A.INSTANCE)throw new Error("Client request tracking should be configured from the applicationInsights object");A.INSTANCE=this,this._client=R}return a(A,"e"),A.prototype.enable=function(R){this._isEnabled=R,this._isEnabled&&!this._isInitialized&&this._initialize(),E.IsInitialized&&(Fu().enable(!0,this._client),Bu().enable(R,this._client),Hu().enable(R,this._client),Uu().enable(R,this._client),Ur().enable(R,this._client))},A.prototype.isInitialized=function(){return this._isInitialized},A.prototype._initialize=function(){var R=this;this._isInitialized=!0;var D=w.request,k=x.request,G=a(function(Z,Q){var fe=!Q[A.disableCollectionRequestOption]&&!Z[A.alreadyAutoCollectedFlag];Q.headers&&Q.headers["user-agent"]&&Q.headers["user-agent"].toString().indexOf("azsdk-js")!==-1&&(fe=!1),Z[A.alreadyAutoCollectedFlag]=!0,Z&&Q&&fe&&(_.CorrelationContextManager.wrapEmitter(Z),A.trackRequest(R._client,{options:Q,request:Z}))},"i");w.request=function(Z){for(var Q=[],fe=1;fe<arguments.length;fe++)Q[fe-1]=arguments[fe];var Se=D.call.apply(D,f([w,Z],Q));return G(Se,Z),Se},x.request=function(Z){for(var Q=[],fe=1;fe<arguments.length;fe++)Q[fe-1]=arguments[fe];var Se=k.call.apply(k,f([x,Z],Q));return G(Se,Z),Se},w.get=function(Z){for(var Q,fe=[],Se=1;Se<arguments.length;Se++)fe[Se-1]=arguments[Se];var Me=(Q=w.request).call.apply(Q,f([w,Z],fe));return Me.end(),Me},x.get=function(Z){for(var Q,fe=[],Se=1;Se<arguments.length;Se++)fe[Se-1]=arguments[Se];var Me=(Q=x.request).call.apply(Q,f([x,Z],fe));return Me.end(),Me}},A.trackRequest=function(R,D){if(!D.options||!D.request||!R){p.info("AutoCollectHttpDependencies.trackRequest was called with invalid parameters: ",!D.options,!D.request,!R);return}var k=new v(D.options,D.request),G=_.CorrelationContextManager.getCurrentContext(),Z,Q;if(G&&G.operation&&G.operation.traceparent&&y.isValidTraceId(G.operation.traceparent.traceId))G.operation.traceparent.updateSpanId(),Z=G.operation.traceparent.getBackCompatRequestId();else if(b.w3cEnabled){var fe=new y;Q=fe.toString(),Z=fe.getBackCompatRequestId()}else Z=G&&G.operation&&G.operation.parentId+A.requestNumber+++".";if(u.canIncludeCorrelationHeader(R,k.getUrl())&&D.request.getHeader&&D.request.setHeader&&R.config&&R.config.correlationId){var Se=D.request.getHeader(g.requestContextHeader);try{u.safeIncludeCorrelationHeader(R,D.request,Se)}catch(Qe){p.warn("Request-Context header could not be set. Correlation of requests may be lost",Qe)}if(G&&G.operation)try{if(D.request.setHeader(g.requestIdHeader,Z),R.config.ignoreLegacyHeaders||(D.request.setHeader(g.parentIdHeader,G.operation.id),D.request.setHeader(g.rootIdHeader,Z)),Q||G.operation.traceparent)D.request.setHeader(g.traceparentHeader,Q||G.operation.traceparent.toString());else if(b.w3cEnabled){var fe=new y().toString();D.request.setHeader(g.traceparentHeader,fe)}if(G.operation.tracestate){var Me=G.operation.tracestate.toString();Me&&D.request.setHeader(g.traceStateHeader,Me)}var He=G.customProperties.serializeToHeader();He&&D.request.setHeader(g.correlationContextHeader,He)}catch(Qe){p.warn("Correlation headers could not be set. Correlation of requests may be lost.",Qe)}}D.request.on&&(D.request.on("response",function(Qe){k.onResponse(Qe);var Ye=k.getDependencyTelemetry(D,Z);Ye.contextObjects=Ye.contextObjects||{},Ye.contextObjects["http.RequestOptions"]=D.options,Ye.contextObjects["http.ClientRequest"]=D.request,Ye.contextObjects["http.ClientResponse"]=Qe,R.trackDependency(Ye)}),D.request.on("error",function(Qe){k.onError(Qe);var Ye=k.getDependencyTelemetry(D,Z);Ye.contextObjects=Ye.contextObjects||{},Ye.contextObjects["http.RequestOptions"]=D.options,Ye.contextObjects["http.ClientRequest"]=D.request,Ye.contextObjects.Error=Qe,R.trackDependency(Ye)}),D.request.on("abort",function(){k.onError(new Error);var Qe=k.getDependencyTelemetry(D,Z);Qe.contextObjects=Qe.contextObjects||{},Qe.contextObjects["http.RequestOptions"]=D.options,Qe.contextObjects["http.ClientRequest"]=D.request,R.trackDependency(Qe)}))},A.prototype.dispose=function(){A.INSTANCE=null,this.enable(!1),this._isInitialized=!1},A.disableCollectionRequestOption="disableAppInsightsAutoCollection",A.requestNumber=1,A.alreadyAutoCollectedFlag="_appInsightsAutoCollected",A}();T.exports=C}),ju=F((s,T)=>{"use strict";var f=K(2037),w=$r(),x=fn(),p=ds(),u=_a(),g="http://169.254.169.254/metadata/instance/compute",v="api-version=2017-12-01",_="format=json",b="ENETUNREACH",y=function(){function E(C){this._collectionInterval=9e5,this._vmData={},this._azInst_vmId="",this._azInst_subscriptionId="",this._azInst_osType="",E.INSTANCE||(E.INSTANCE=this),this._isInitialized=!1,this._client=C}return a(E,"e"),E.prototype.enable=function(C,A){var R=this;this._isEnabled=C,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),C?this._handle||(this._handle=setInterval(function(){return R.trackHeartBeat(A,function(){})},this._collectionInterval),this._handle.unref()):this._handle&&(clearInterval(this._handle),this._handle=null)},E.prototype.isInitialized=function(){return this._isInitialized},E.isEnabled=function(){return E.INSTANCE&&E.INSTANCE._isEnabled},E.prototype.trackHeartBeat=function(C,A){var R=this,D=!1,k={},G=p.sdkVersion;k.sdk=G,k.osType=f.type(),process.env.WEBSITE_SITE_NAME?(k.appSrv_SiteName=process.env.WEBSITE_SITE_NAME||"",k.appSrv_wsStamp=process.env.WEBSITE_HOME_STAMPNAME||"",k.appSrv_wsHost=process.env.WEBSITE_HOSTNAME||""):process.env.FUNCTIONS_WORKER_RUNTIME?k.azfunction_appId=process.env.WEBSITE_HOSTNAME:C&&(this._isVM===void 0?(D=!0,this._getAzureComputeMetadata(C,function(){R._isVM&&Object.keys(R._vmData).length>0&&(k.azInst_vmId=R._vmData.vmId||"",k.azInst_subscriptionId=R._vmData.subscriptionId||"",k.azInst_osType=R._vmData.osType||"",R._azInst_vmId=R._vmData.vmId||"",R._azInst_subscriptionId=R._vmData.subscriptionId||"",R._azInst_osType=R._vmData.osType||""),R._client.trackMetric({name:w.HeartBeatMetricName,value:0,properties:k}),A()})):this._isVM&&(k.azInst_vmId=this._azInst_vmId,k.azInst_subscriptionId=this._azInst_subscriptionId,k.azInst_osType=this._azInst_osType)),D||(this._client.trackMetric({name:w.HeartBeatMetricName,value:0,properties:k}),A())},E.prototype.dispose=function(){E.INSTANCE=null,this.enable(!1),this._isInitialized=!1},E.prototype._getAzureComputeMetadata=function(C,A){var R,D=this,k=g+"?"+v+"&"+_,G=(R={method:"GET"},R[u.disableCollectionRequestOption]=!0,R.headers={Metadata:"True"},R),Z=x.makeRequest(C,k,G,function(Q){if(Q.statusCode===200){D._isVM=!0;var fe="";Q.on("data",function(Se){fe+=Se}),Q.on("end",function(){D._vmData=D._isJSON(fe)?JSON.parse(fe):{},A()})}else A()});Z&&(Z.on("error",function(Q){Q&&Q.message&&Q.message.indexOf(b)>-1&&(D._isVM=!1),A()}),Z.end())},E.prototype._isJSON=function(C){try{return JSON.parse(C)&&!!C}catch(A){return!1}},E}();T.exports=y}),Al=F((s,T)=>{"use strict";var f=K(3685),w=K(5687),x=at(),p=fn(),u=Po(),g=Sl(),v=mn(),_=ya(),b=function(){function y(E){if(y.INSTANCE)throw new Error("Server request tracking should be configured from the applicationInsights object");y.INSTANCE=this,this._client=E}return a(y,"e"),y.prototype.enable=function(E){this._isEnabled=E,(this._isAutoCorrelating||this._isEnabled||_.isEnabled())&&!this._isInitialized&&(this.useAutoCorrelation(this._isAutoCorrelating),this._initialize())},y.prototype.useAutoCorrelation=function(E,C){E&&!this._isAutoCorrelating?v.CorrelationContextManager.enable(C):!E&&this._isAutoCorrelating&&v.CorrelationContextManager.disable(),this._isAutoCorrelating=E},y.prototype.isInitialized=function(){return this._isInitialized},y.prototype.isAutoCorrelating=function(){return this._isAutoCorrelating},y.prototype._generateCorrelationContext=function(E){if(this._isAutoCorrelating)return v.CorrelationContextManager.generateContextObject(E.getOperationId(this._client.context.tags),E.getRequestId(),E.getOperationName(this._client.context.tags),E.getCorrelationContextHeader(),E.getTraceparent(),E.getTracestate())},y.prototype._initialize=function(){var E=this;this._isInitialized=!0;var C=a(function(k){if(k){if(typeof k!="function")throw new Error("onRequest handler must be a function");return function(G,Z){v.CorrelationContextManager.wrapEmitter(G),v.CorrelationContextManager.wrapEmitter(Z);var Q=G&&!G[y.alreadyAutoCollectedFlag];if(G&&Q){var fe=new g(G),Se=E._generateCorrelationContext(fe);v.CorrelationContextManager.runWithContext(Se,function(){E._isEnabled&&(G[y.alreadyAutoCollectedFlag]=!0,y.trackRequest(E._client,{request:G,response:Z},fe)),typeof k=="function"&&k(G,Z)})}else typeof k=="function"&&k(G,Z)}}},"r"),A=a(function(k){var G=k.addListener.bind(k);k.addListener=function(Z,Q){switch(Z){case"request":case"checkContinue":return G(Z,C(Q));default:return G(Z,Q)}},k.on=k.addListener},"n"),R=f.createServer;f.createServer=function(k,G){if(G&&typeof G=="function"){var Z=R(k,C(G));return A(Z),Z}else{var Z=R(C(k));return A(Z),Z}};var D=w.createServer;w.createServer=function(k,G){var Z=D(k,C(G));return A(Z),Z}},y.trackRequestSync=function(E,C){if(!C.request||!C.response||!E){x.info("AutoCollectHttpRequests.trackRequestSync was called with invalid parameters: ",!C.request,!C.response,!E);return}y.addResponseCorrelationIdHeader(E,C.response);var A=v.CorrelationContextManager.getCurrentContext(),R=new g(C.request,A&&A.operation.parentId);A&&(A.operation.id=R.getOperationId(E.context.tags)||A.operation.id,A.operation.name=R.getOperationName(E.context.tags)||A.operation.name,A.operation.parentId=R.getRequestId()||A.operation.parentId,A.customProperties.addHeaderData(R.getCorrelationContextHeader())),y.endRequest(E,R,C,C.duration,C.error)},y.trackRequest=function(E,C,A){if(!C.request||!C.response||!E){x.info("AutoCollectHttpRequests.trackRequest was called with invalid parameters: ",!C.request,!C.response,!E);return}var R=v.CorrelationContextManager.getCurrentContext(),D=A||new g(C.request,R&&R.operation.parentId);p.canIncludeCorrelationHeader(E,D.getUrl())&&y.addResponseCorrelationIdHeader(E,C.response),R&&!A&&(R.operation.id=D.getOperationId(E.context.tags)||R.operation.id,R.operation.name=D.getOperationName(E.context.tags)||R.operation.name,R.operation.parentId=D.getOperationParentId(E.context.tags)||R.operation.parentId,R.customProperties.addHeaderData(D.getCorrelationContextHeader())),C.response.once&&C.response.once("finish",function(){y.endRequest(E,D,C,null,null)}),C.request.on&&C.request.on("error",function(k){y.endRequest(E,D,C,null,k)}),C.request.on&&C.request.on("aborted",function(){var k="The request has been aborted and the network socket has closed.";y.endRequest(E,D,C,null,k)})},y.addResponseCorrelationIdHeader=function(E,C){if(E.config&&E.config.correlationId&&C.getHeader&&C.setHeader&&!C.headersSent){var A=C.getHeader(u.requestContextHeader);p.safeIncludeCorrelationHeader(E,C,A)}},y.endRequest=function(E,C,A,R,D){D?C.onError(D,R):C.onResponse(A.response,R);var k=C.getRequestTelemetry(A);if(k.tagOverrides=C.getRequestTags(E.context.tags),A.tagOverrides)for(var G in A.tagOverrides)k.tagOverrides[G]=A.tagOverrides[G];var Z=C.getLegacyRootId();Z&&(k.properties.ai_legacyRootId=Z),k.contextObjects=k.contextObjects||{},k.contextObjects["http.ServerRequest"]=A.request,k.contextObjects["http.ServerResponse"]=A.response,E.trackRequest(k)},y.prototype.dispose=function(){y.INSTANCE=null,this.enable(!1),this._isInitialized=!1,v.CorrelationContextManager.disable(),this._isAutoCorrelating=!1},y.alreadyAutoCollectedFlag="_appInsightsAutoCollected",y}();T.exports=b}),vc=F((s,T)=>{"use strict";var f=s&&s.__assign||function(){return f=Object.assign||function(b){for(var y,E=1,C=arguments.length;E<C;E++){y=arguments[E];for(var A in y)Object.prototype.hasOwnProperty.call(y,A)&&(b[A]=y[A])}return b},f.apply(this,arguments)},w=K(2037),x=$t(),p=$r(),u=fn(),g=at(),v=u.w3cTraceId(),_=function(){function b(){}return a(b,"e"),b.createQuickPulseEnvelope=function(y,E,C,A){var R=w&&typeof w.hostname=="function"&&w.hostname()||"Unknown",D=A.tags&&A.keys&&A.keys.cloudRoleInstance&&A.tags[A.keys.cloudRoleInstance]||R,k=A.tags&&A.keys&&A.keys.cloudRole&&A.tags[A.keys.cloudRole]||null,G={Documents:E.length>0?E:null,InstrumentationKey:C.instrumentationKey||"",Metrics:y.length>0?y:null,InvariantVersion:1,Timestamp:"/Date("+Date.now()+")/",Version:A.tags[A.keys.internalSdkVersion],StreamId:v,MachineName:R,Instance:D,RoleName:k};return G},b.createQuickPulseMetric=function(y){var E;return E={Name:y.name,Value:y.value,Weight:y.count||1},E},b.telemetryEnvelopeToQuickPulseDocument=function(y){switch(y.data.baseType){case x.TelemetryTypeString.Event:return b.createQuickPulseEventDocument(y);case x.TelemetryTypeString.Exception:return b.createQuickPulseExceptionDocument(y);case x.TelemetryTypeString.Trace:return b.createQuickPulseTraceDocument(y);case x.TelemetryTypeString.Dependency:return b.createQuickPulseDependencyDocument(y);case x.TelemetryTypeString.Request:return b.createQuickPulseRequestDocument(y)}return null},b.createQuickPulseEventDocument=function(y){var E=b.createQuickPulseDocument(y),C=y.data.baseData.name,A=f(f({},E),{Name:C});return A},b.createQuickPulseTraceDocument=function(y){var E=b.createQuickPulseDocument(y),C=y.data.baseData.severityLevel||0,A=f(f({},E),{Message:y.data.baseData.message,SeverityLevel:x.SeverityLevel[C]});return A},b.createQuickPulseExceptionDocument=function(y){var E=b.createQuickPulseDocument(y),C=y.data.baseData.exceptions,A="",R="",D="";C&&C.length>0&&(C[0].parsedStack&&C[0].parsedStack.length>0?C[0].parsedStack.forEach(function(G){A+=G.assembly+`
`}):C[0].stack&&C[0].stack.length>0&&(A=C[0].stack),R=C[0].message,D=C[0].typeName);var k=f(f({},E),{Exception:A,ExceptionMessage:R,ExceptionType:D});return k},b.createQuickPulseRequestDocument=function(y){var E=b.createQuickPulseDocument(y),C=y.data.baseData,A=f(f({},E),{Name:C.name,Success:C.success,Duration:C.duration,ResponseCode:C.responseCode,OperationName:C.name});return A},b.createQuickPulseDependencyDocument=function(y){var E=b.createQuickPulseDocument(y),C=y.data.baseData,A=f(f({},E),{Name:C.name,Target:C.target,Success:C.success,Duration:C.duration,ResultCode:C.resultCode,CommandName:C.data,OperationName:E.OperationId,DependencyTypeName:C.type});return A},b.createQuickPulseDocument=function(y){var E,C,A,R;y.data.baseType?(C=p.TelemetryTypeStringToQuickPulseType[y.data.baseType],E=p.TelemetryTypeStringToQuickPulseDocumentType[y.data.baseType]):g.warn("Document type invalid; not sending live metric document",y.data.baseType),A=y.tags[b.keys.operationId],R=b.aggregateProperties(y);var D={DocumentType:E,__type:C,OperationId:A,Version:"1.0",Properties:R};return D},b.aggregateProperties=function(y){var E=[],C=y.data.baseData.measurements||{};for(var A in C)if(C.hasOwnProperty(A)){var R=C[A],D={key:A,value:R};E.push(D)}var k=y.data.baseData.properties||{};for(var A in k)if(k.hasOwnProperty(A)){var R=k[A],D={key:A,value:R};E.push(D)}return E},b.keys=new x.ContextTagKeys,b}();T.exports=_}),Sr=F((s,T)=>{"use strict";var f=a(function(){return(Date.now()+621355968e5)*1e4},"XR");T.exports={getTransmissionTime:f}}),ps=F((s,T)=>{"use strict";var f=s&&s.__awaiter||function(y,E,C,A){function R(D){return D instanceof C?D:new C(function(k){k(D)})}return a(R,"i"),new(C||(C=Promise))(function(D,k){function G(fe){try{Q(A.next(fe))}catch(Se){k(Se)}}a(G,"o");function Z(fe){try{Q(A.throw(fe))}catch(Se){k(Se)}}a(Z,"u");function Q(fe){fe.done?D(fe.value):R(fe.value).then(G,Z)}a(Q,"c"),Q((A=A.apply(y,E||[])).next())})},w=s&&s.__generator||function(y,E){var C={label:0,sent:function(){if(D[0]&1)throw D[1];return D[1]},trys:[],ops:[]},A,R,D,k;return k={next:G(0),throw:G(1),return:G(2)},typeof Symbol=="function"&&(k[Symbol.iterator]=function(){return this}),k;function G(Q){return function(fe){return Z([Q,fe])}}function Z(Q){if(A)throw new TypeError("Generator is already executing.");for(;C;)try{if(A=1,R&&(D=Q[0]&2?R.return:Q[0]?R.throw||((D=R.return)&&D.call(R),0):R.next)&&!(D=D.call(R,Q[1])).done)return D;switch(R=0,D&&(Q=[Q[0]&2,D.value]),Q[0]){case 0:case 1:D=Q;break;case 4:return C.label++,{value:Q[1],done:!1};case 5:C.label++,R=Q[1],Q=[0];continue;case 7:Q=C.ops.pop(),C.trys.pop();continue;default:if(D=C.trys,!(D=D.length>0&&D[D.length-1])&&(Q[0]===6||Q[0]===2)){C=0;continue}if(Q[0]===3&&(!D||Q[1]>D[0]&&Q[1]<D[3])){C.label=Q[1];break}if(Q[0]===6&&C.label<D[1]){C.label=D[1],D=Q;break}if(D&&C.label<D[2]){C.label=D[2],C.ops.push(Q);break}D[2]&&C.ops.pop(),C.trys.pop();continue}Q=E.call(y,C)}catch(fe){Q=[6,fe],R=0}finally{A=D=0}if(Q[0]&5)throw Q[1];return{value:Q[0]?Q[1]:void 0,done:!0}}},x=K(5687),p=_a(),u=at(),g=Sr(),v=fn(),_={method:"POST",time:"x-ms-qps-transmission-time",pollingIntervalHint:"x-ms-qps-service-polling-interval-hint",endpointRedirect:"x-ms-qps-service-endpoint-redirect",instanceName:"x-ms-qps-instance-name",streamId:"x-ms-qps-stream-id",machineName:"x-ms-qps-machine-name",roleName:"x-ms-qps-role-name",streamid:"x-ms-qps-stream-id",invariantVersion:"x-ms-qps-invariant-version",subscribed:"x-ms-qps-subscribed"},b=function(){function y(E){this._config=E,this._consecutiveErrors=0}return a(y,"e"),y.prototype.ping=function(E,C,A){var R=[{name:_.streamId,value:E.StreamId},{name:_.machineName,value:E.MachineName},{name:_.roleName,value:E.RoleName},{name:_.instanceName,value:E.Instance},{name:_.invariantVersion,value:E.InvariantVersion.toString()}];this._submitData(E,C,A,"ping",R)},y.prototype.post=function(E,C,A){return f(this,void 0,void 0,function(){return w(this,function(R){switch(R.label){case 0:return[4,this._submitData([E],C,A,"post")];case 1:return R.sent(),[2]}})})},y.prototype._submitData=function(E,C,A,R,D){return f(this,void 0,void 0,function(){var k,G,Z,Q,fe,Se=this;return w(this,function(Me){return k=JSON.stringify(E),G=(Q={},Q[p.disableCollectionRequestOption]=!0,Q.host=C&&C.length>0?C:this._config.quickPulseHost,Q.method=_.method,Q.path="/QuickPulseService.svc/"+R+"?ikey="+this._config.instrumentationKey,Q.headers=(fe={Expect:"100-continue"},fe[_.time]=g.getTransmissionTime(),fe["Content-Type"]="application/json",fe["Content-Length"]=Buffer.byteLength(k),fe),Q),D&&D.length>0&&D.forEach(function(He){return G.headers[He.name]=He.value}),this._config.httpsAgent?G.agent=this._config.httpsAgent:G.agent=v.tlsRestrictedAgent,Z=x.request(G,function(He){if(He.statusCode==200){var Qe=He.headers[_.subscribed]==="true",Ye=He.headers[_.endpointRedirect]?He.headers[_.endpointRedirect].toString():null,mt=He.headers[_.pollingIntervalHint]?parseInt(He.headers[_.pollingIntervalHint].toString()):null;Se._consecutiveErrors=0,A(Qe,He,Ye,mt)}else Se._onError("StatusCode:"+He.statusCode+" StatusMessage:"+He.statusMessage),A()}),Z.on("error",function(He){Se._onError(He),A()}),Z.write(k),Z.end(),[2]})})},y.prototype._onError=function(E){this._consecutiveErrors++;var C="Transient error connecting to the Live Metrics endpoint. This packet will not appear in your Live Metrics Stream. Error:";this._consecutiveErrors%y.MAX_QPS_FAILURES_BEFORE_WARN==0?(C="Live Metrics endpoint could not be reached "+this._consecutiveErrors+" consecutive times. Most recent error:",u.warn(y.TAG,C,E)):u.info(y.TAG,C,E)},y.TAG="QuickPulseSender",y.MAX_QPS_FAILURES_BEFORE_WARN=25,y}();T.exports=b}),$o=F((s,T)=>{"use strict";var f=s&&s.__awaiter||function(b,y,E,C){function A(R){return R instanceof E?R:new E(function(D){D(R)})}return a(A,"i"),new(E||(E=Promise))(function(R,D){function k(Q){try{Z(C.next(Q))}catch(fe){D(fe)}}a(k,"o");function G(Q){try{Z(C.throw(Q))}catch(fe){D(fe)}}a(G,"u");function Z(Q){Q.done?R(Q.value):A(Q.value).then(k,G)}a(Z,"c"),Z((C=C.apply(b,y||[])).next())})},w=s&&s.__generator||function(b,y){var E={label:0,sent:function(){if(R[0]&1)throw R[1];return R[1]},trys:[],ops:[]},C,A,R,D;return D={next:k(0),throw:k(1),return:k(2)},typeof Symbol=="function"&&(D[Symbol.iterator]=function(){return this}),D;function k(Z){return function(Q){return G([Z,Q])}}function G(Z){if(C)throw new TypeError("Generator is already executing.");for(;E;)try{if(C=1,A&&(R=Z[0]&2?A.return:Z[0]?A.throw||((R=A.return)&&R.call(A),0):A.next)&&!(R=R.call(A,Z[1])).done)return R;switch(A=0,R&&(Z=[Z[0]&2,R.value]),Z[0]){case 0:case 1:R=Z;break;case 4:return E.label++,{value:Z[1],done:!1};case 5:E.label++,A=Z[1],Z=[0];continue;case 7:Z=E.ops.pop(),E.trys.pop();continue;default:if(R=E.trys,!(R=R.length>0&&R[R.length-1])&&(Z[0]===6||Z[0]===2)){E=0;continue}if(Z[0]===3&&(!R||Z[1]>R[0]&&Z[1]<R[3])){E.label=Z[1];break}if(Z[0]===6&&E.label<R[1]){E.label=R[1],R=Z;break}if(R&&E.label<R[2]){E.label=R[2],E.ops.push(Z);break}R[2]&&E.ops.pop(),E.trys.pop();continue}Z=y.call(b,E)}catch(Q){Z=[6,Q],A=0}finally{C=R=0}if(Z[0]&5)throw Z[1];return{value:Z[0]?Z[1]:void 0,done:!0}}},x=at(),p=vc(),u=ps(),g=$r(),v=ds(),_=function(){function b(y,E){this._isCollectingData=!1,this._lastSuccessTime=Date.now(),this._lastSendSucceeded=!0,this._metrics={},this._documents=[],this._collectors=[],this._redirectedHost=null,this._pollingIntervalHint=-1,this.config=y,this.context=E||new v,this._sender=new u(this.config),this._isEnabled=!1}return a(b,"e"),b.prototype.addCollector=function(y){this._collectors.push(y)},b.prototype.trackMetric=function(y){this._addMetric(y)},b.prototype.addDocument=function(y){var E=p.telemetryEnvelopeToQuickPulseDocument(y);E&&this._documents.push(E)},b.prototype.enable=function(y){y&&!this._isEnabled?(this._isEnabled=!0,this._goQuickPulse()):!y&&this._isEnabled&&(this._isEnabled=!1,clearTimeout(this._handle),this._handle=void 0)},b.prototype.enableCollectors=function(y){this._collectors.forEach(function(E){E.enable(y)})},b.prototype._addMetric=function(y){var E=y.value,C=y.count||1,A=g.PerformanceToQuickPulseCounter[y.name];A&&(this._metrics[A]?(this._metrics[A].Value=(this._metrics[A].Value*this._metrics[A].Weight+E*C)/(this._metrics[A].Weight+C),this._metrics[A].Weight+=C):(this._metrics[A]=p.createQuickPulseMetric(y),this._metrics[A].Name=A,this._metrics[A].Weight=1))},b.prototype._resetQuickPulseBuffer=function(){delete this._metrics,this._metrics={},this._documents.length=0},b.prototype._goQuickPulse=function(){return f(this,void 0,void 0,function(){var y,E,C,A,R=this;return w(this,function(D){switch(D.label){case 0:return y=Object.keys(this._metrics).map(function(k){return R._metrics[k]}),E=p.createQuickPulseEnvelope(y,this._documents.slice(),this.config,this.context),this._resetQuickPulseBuffer(),this._isCollectingData?[4,this._post(E)]:[3,2];case 1:return D.sent(),[3,3];case 2:this._ping(E),D.label=3;case 3:return C=this._pollingIntervalHint>0?this._pollingIntervalHint:b.PING_INTERVAL,A=this._isCollectingData?b.POST_INTERVAL:C,this._isCollectingData&&Date.now()-this._lastSuccessTime>=b.MAX_POST_WAIT_TIME&&!this._lastSendSucceeded?(this._isCollectingData=!1,A=b.FALLBACK_INTERVAL):!this._isCollectingData&&Date.now()-this._lastSuccessTime>=b.MAX_PING_WAIT_TIME&&!this._lastSendSucceeded&&(A=b.FALLBACK_INTERVAL),this._lastSendSucceeded=null,this._handle=setTimeout(this._goQuickPulse.bind(this),A),this._handle.unref(),[2]}})})},b.prototype._ping=function(y){this._sender.ping(y,this._redirectedHost,this._quickPulseDone.bind(this))},b.prototype._post=function(y){return f(this,void 0,void 0,function(){return w(this,function(E){switch(E.label){case 0:return[4,this._sender.post(y,this._redirectedHost,this._quickPulseDone.bind(this))];case 1:return E.sent(),[2]}})})},b.prototype._quickPulseDone=function(y,E,C,A){y!=null?(this._isCollectingData!==y&&(x.info("Live Metrics sending data",y),this.enableCollectors(y)),this._isCollectingData=y,C&&C.length>0&&(this._redirectedHost=C,x.info("Redirecting endpoint to: ",C)),A&&A>0&&(this._pollingIntervalHint=A),E&&E.statusCode<300&&E.statusCode>=200?(this._lastSuccessTime=Date.now(),this._lastSendSucceeded=!0):this._lastSendSucceeded=!1):this._lastSendSucceeded=!1},b.MAX_POST_WAIT_TIME=2e4,b.MAX_PING_WAIT_TIME=6e4,b.FALLBACK_INTERVAL=6e4,b.PING_INTERVAL=5e3,b.POST_INTERVAL=1e3,b}();T.exports=_}),Rl=F((s,T)=>{"use strict";var f=$r(),w=function(){function x(){}return a(x,"e"),x.parse=function(p){if(!p)return{};var u=p.split(x._FIELDS_SEPARATOR),g=u.reduce(function(_,b){var y=b.split(x._FIELD_KEY_VALUE_SEPARATOR);if(y.length===2){var E=y[0].toLowerCase(),C=y[1];_[E]=C}return _},{});if(Object.keys(g).length>0){if(g.endpointsuffix){var v=g.location?g.location+".":"";g.ingestionendpoint=g.ingestionendpoint||"https://"+v+"dc."+g.endpointsuffix,g.liveendpoint=g.liveendpoint||"https://"+v+"live."+g.endpointsuffix}g.ingestionendpoint=g.ingestionendpoint||f.DEFAULT_BREEZE_ENDPOINT,g.liveendpoint=g.liveendpoint||f.DEFAULT_LIVEMETRICS_ENDPOINT}return g},x._FIELDS_SEPARATOR=";",x._FIELD_KEY_VALUE_SEPARATOR="=",x}();T.exports=w}),sn=F((s,T)=>{"use strict";var f=J(),w=Rl(),x=at(),p=$r(),u=K(7310),g=function(){function v(_){var b=this;this.endpointBase=p.DEFAULT_BREEZE_ENDPOINT;var y=process.env[v.ENV_connectionString],E=w.parse(_),C=w.parse(y),A=!E.instrumentationkey&&Object.keys(E).length>0?null:_;this.instrumentationKey=E.instrumentationkey||A||C.instrumentationkey||v._getInstrumentationKey(),v._validateInstrumentationKey(this.instrumentationKey),this.endpointUrl=(E.ingestionendpoint||C.ingestionendpoint||this.endpointBase)+"/v2.1/track",this.maxBatchSize=250,this.maxBatchIntervalMs=15e3,this.disableAppInsights=!1,this.samplingPercentage=100,this.correlationIdRetryIntervalMs=30*1e3,this.correlationHeaderExcludedDomains=["*.core.windows.net","*.core.chinacloudapi.cn","*.core.cloudapi.de","*.core.usgovcloudapi.net","*.core.microsoft.scloud","*.core.eaglex.ic.gov"],this.setCorrelationId=function(R){return b.correlationId=R},this.proxyHttpUrl=process.env[v.ENV_http_proxy]||void 0,this.proxyHttpsUrl=process.env[v.ENV_https_proxy]||void 0,this.httpAgent=void 0,this.httpsAgent=void 0,this.profileQueryEndpoint=E.ingestionendpoint||C.ingestionendpoint||process.env[v.ENV_profileQueryEndpoint]||this.endpointBase,this._quickPulseHost=E.liveendpoint||C.liveendpoint||process.env[v.ENV_quickPulseHost]||p.DEFAULT_LIVEMETRICS_HOST,this._quickPulseHost.match(/^https?:\/\//)&&(this._quickPulseHost=u.parse(this._quickPulseHost).host)}return a(v,"e"),Object.defineProperty(v.prototype,"profileQueryEndpoint",{get:function(){return this._profileQueryEndpoint},set:function(_){f.cancelCorrelationIdQuery(this,this.setCorrelationId),this._profileQueryEndpoint=_,this.correlationId=f.correlationIdPrefix,f.queryCorrelationId(this,this.setCorrelationId)},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"quickPulseHost",{get:function(){return this._quickPulseHost},set:function(_){this._quickPulseHost=_},enumerable:!1,configurable:!0}),v._getInstrumentationKey=function(){var _=process.env[v.ENV_iKey]||process.env[v.ENV_azurePrefix+v.ENV_iKey]||process.env[v.legacy_ENV_iKey]||process.env[v.ENV_azurePrefix+v.legacy_ENV_iKey];if(!_||_=="")throw new Error("Instrumentation key not found, pass the key in the config to this method or set the key in the environment variable APPINSIGHTS_INSTRUMENTATIONKEY before starting the server");return _},v._validateInstrumentationKey=function(_){var b="^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$",y=new RegExp(b);return y.test(_)},v.ENV_azurePrefix="APPSETTING_",v.ENV_iKey="APPINSIGHTS_INSTRUMENTATIONKEY",v.legacy_ENV_iKey="APPINSIGHTS_INSTRUMENTATION_KEY",v.ENV_profileQueryEndpoint="APPINSIGHTS_PROFILE_QUERY_ENDPOINT",v.ENV_quickPulseHost="APPINSIGHTS_QUICKPULSE_HOST",v.ENV_connectionString="APPLICATIONINSIGHTS_CONNECTION_STRING",v.ENV_nativeMetricsDisablers="APPLICATION_INSIGHTS_DISABLE_EXTENDED_METRIC",v.ENV_nativeMetricsDisableAll="APPLICATION_INSIGHTS_DISABLE_ALL_EXTENDED_METRICS",v.ENV_http_proxy="http_proxy",v.ENV_https_proxy="https_proxy",v}();T.exports=g}),qu=F(s=>{"use strict";var T=s&&s.__assign||function(){return T=Object.assign||function(u){for(var g,v=1,_=arguments.length;v<_;v++){g=arguments[v];for(var b in g)Object.prototype.hasOwnProperty.call(g,b)&&(u[b]=g[b])}return u},T.apply(this,arguments)};Object.defineProperty(s,"__esModule",{value:!0}),s.AutoCollectNativePerformance=void 0;var f=sn(),w=ds(),x=at(),p=function(){function u(g){this._disabledMetrics={},u.INSTANCE&&u.INSTANCE.dispose(),u.INSTANCE=this,this._client=g}return a(u,"e"),u.isNodeVersionCompatible=function(){var g=process.versions.node.split(".");return parseInt(g[0])>=6},u.prototype.enable=function(g,v,_){var b=this;if(v===void 0&&(v={}),_===void 0&&(_=6e4),!!u.isNodeVersionCompatible()){if(u._metricsAvailable==null&&g&&!this._isInitialized)try{var y=K(9166);u._emitter=new y,u._metricsAvailable=!0,x.info("Native metrics module successfully loaded!")}catch(E){u._metricsAvailable=!1;return}this._isEnabled=g,this._disabledMetrics=v,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),this._isEnabled&&u._emitter?(u._emitter.enable(!0,_),this._handle||(this._handle=setInterval(function(){return b._trackNativeMetrics()},_),this._handle.unref())):u._emitter&&(u._emitter.enable(!1),this._handle&&(clearInterval(this._handle),this._handle=void 0))}},u.prototype.dispose=function(){this.enable(!1)},u.parseEnabled=function(g){var v=process.env[f.ENV_nativeMetricsDisableAll],_=process.env[f.ENV_nativeMetricsDisablers];if(v)return{isEnabled:!1,disabledMetrics:{}};if(_){var b=_.split(","),y={};if(b.length>0)for(var E=0,C=b;E<C.length;E++){var A=C[E];y[A]=!0}return typeof g=="object"?{isEnabled:!0,disabledMetrics:T(T({},g),y)}:{isEnabled:g,disabledMetrics:y}}return typeof g=="boolean"?{isEnabled:g,disabledMetrics:{}}:{isEnabled:!0,disabledMetrics:g}},u.prototype._trackNativeMetrics=function(){var g=!0;typeof this._isEnabled!="object"&&(g=this._isEnabled),g&&(this._trackGarbageCollection(),this._trackEventLoop(),this._trackHeapUsage())},u.prototype._trackGarbageCollection=function(){var g;if(!this._disabledMetrics.gc){var v=u._emitter.getGCData();for(var _ in v){var b=v[_].metrics,y=_+" Garbage Collection Duration",E=Math.sqrt(b.sumSquares/b.count-Math.pow(b.total/b.count,2))||0;this._client.trackMetric({name:y,value:b.total,count:b.count,max:b.max,min:b.min,stdDev:E,tagOverrides:(g={},g[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+w.sdkVersion,g)})}}},u.prototype._trackEventLoop=function(){var g;if(!this._disabledMetrics.loop){var v=u._emitter.getLoopData(),_=v.loopUsage;if(_.count!=0){var b="Event Loop CPU Time",y=Math.sqrt(_.sumSquares/_.count-Math.pow(_.total/_.count,2))||0;this._client.trackMetric({name:b,value:_.total,count:_.count,min:_.min,max:_.max,stdDev:y,tagOverrides:(g={},g[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+w.sdkVersion,g)})}}},u.prototype._trackHeapUsage=function(){var g,v,_;if(!this._disabledMetrics.heap){var b=process.memoryUsage(),y=b.heapUsed,E=b.heapTotal,C=b.rss;this._client.trackMetric({name:"Memory Usage (Heap)",value:y,count:1,tagOverrides:(g={},g[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+w.sdkVersion,g)}),this._client.trackMetric({name:"Memory Total (Heap)",value:E,count:1,tagOverrides:(v={},v[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+w.sdkVersion,v)}),this._client.trackMetric({name:"Memory Usage (Non-Heap)",value:C-E,count:1,tagOverrides:(_={},_[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+w.sdkVersion,_)})}},u}();s.AutoCollectNativePerformance=p}),Ei=F((s,T)=>{"use strict";var f=at(),w=function(){function x(p,u,g,v){this._buffer=[],this._lastSend=0,this._isDisabled=p,this._getBatchSize=u,this._getBatchIntervalMs=g,this._sender=v}return a(x,"e"),x.prototype.setUseDiskRetryCaching=function(p,u,g){this._sender.setDiskRetryMode(p,u,g)},x.prototype.send=function(p){var u=this;if(!this._isDisabled()){if(!p){f.warn("Cannot send null/undefined telemetry");return}if(this._buffer.push(p),this._buffer.length>=this._getBatchSize()){this.triggerSend(!1);return}!this._timeoutHandle&&this._buffer.length>0&&(this._timeoutHandle=setTimeout(function(){u._timeoutHandle=null,u.triggerSend(!1)},this._getBatchIntervalMs()))}},x.prototype.triggerSend=function(p,u){var g=this._buffer.length<1;g||(p?(this._sender.saveOnCrash(this._buffer),typeof u=="function"&&u("data saved on crash")):this._sender.send(this._buffer,u)),this._lastSend=+new Date,this._buffer=[],clearTimeout(this._timeoutHandle),this._timeoutHandle=null,g&&typeof u=="function"&&u("no data to send")},x}();T.exports=w}),yc=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.azureRoleEnvironmentTelemetryProcessor=void 0;function T(f,w){process.env.WEBSITE_SITE_NAME&&(f.tags[w.keys.cloudRole]=process.env.WEBSITE_SITE_NAME)}a(T,"pN"),s.azureRoleEnvironmentTelemetryProcessor=T}),no=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.getSamplingHashCode=s.samplingTelemetryProcessor=void 0;var T=$t();function f(x,p){var u=x.sampleRate,g=!1;return u==null||u>=100||x.data&&T.TelemetryType.Metric===T.baseTypeToTelemetryType(x.data.baseType)?!0:(p.correlationContext&&p.correlationContext.operation?g=w(p.correlationContext.operation.id)<u:g=Math.random()*100<u,g)}a(f,"fN"),s.samplingTelemetryProcessor=f;function w(x){var p=-2147483648,u=2147483647,g=5381;if(!x)return 0;for(;x.length<8;)x=x+x;for(var v=0;v<x.length;v++)g=((g<<5)+g|0)+x.charCodeAt(v)|0;return g=g<=p?u:Math.abs(g),g/u*100}a(w,"Fm"),s.getSamplingHashCode=w}),cn=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.performanceMetricsTelemetryProcessor=void 0;var T=ya(),f=$t();function w(x,p){switch(p&&p.addDocument(x),x.data.baseType){case f.TelemetryTypeString.Exception:T.countException();break;case f.TelemetryTypeString.Request:var u=x.data.baseData;T.countRequest(u.duration,u.success);break;case f.TelemetryTypeString.Dependency:var g=x.data.baseData;T.countDependency(g.duration,g.success);break}return!0}a(w,"dN"),s.performanceMetricsTelemetryProcessor=w}),_c=F(s=>{"use strict";var T=s&&s.__assign||function(){return T=Object.assign||function(u){for(var g,v=1,_=arguments.length;v<_;v++){g=arguments[v];for(var b in g)Object.prototype.hasOwnProperty.call(g,b)&&(u[b]=g[b])}return u},T.apply(this,arguments)};Object.defineProperty(s,"__esModule",{value:!0}),s.preAggregatedMetricsTelemetryProcessor=void 0;var f=$t(),w=Tl(),x=$t();function p(u,g){if(w.isEnabled())switch(u.data.baseType){case x.TelemetryTypeString.Exception:var v=u.data.baseData;v.properties=T(T({},v.properties),{"_MS.ProcessedByMetricExtractors":"(Name:'Exceptions', Ver:'1.1')"});var _={cloudRoleInstance:u.tags[g.keys.cloudRoleInstance],cloudRoleName:u.tags[g.keys.cloudRole]};w.countException(_);break;case x.TelemetryTypeString.Trace:var b=u.data.baseData;b.properties=T(T({},b.properties),{"_MS.ProcessedByMetricExtractors":"(Name:'Traces', Ver:'1.1')"});var y={cloudRoleInstance:u.tags[g.keys.cloudRoleInstance],cloudRoleName:u.tags[g.keys.cloudRole],traceSeverityLevel:f.SeverityLevel[b.severity]};w.countTrace(y);break;case x.TelemetryTypeString.Request:var E=u.data.baseData;E.properties=T(T({},E.properties),{"_MS.ProcessedByMetricExtractors":"(Name:'Requests', Ver:'1.1')"});var C={cloudRoleInstance:u.tags[g.keys.cloudRoleInstance],cloudRoleName:u.tags[g.keys.cloudRole],operationSynthetic:u.tags[g.keys.operationSyntheticSource],requestSuccess:E.success,requestResultCode:E.responseCode};w.countRequest(E.duration,C);break;case x.TelemetryTypeString.Dependency:var A=u.data.baseData;A.properties=T(T({},A.properties),{"_MS.ProcessedByMetricExtractors":"(Name:'Dependencies', Ver:'1.1')"});var R={cloudRoleInstance:u.tags[g.keys.cloudRoleInstance],cloudRoleName:u.tags[g.keys.cloudRole],operationSynthetic:u.tags[g.keys.operationSyntheticSource],dependencySuccess:A.success,dependencyType:A.type,dependencyTarget:A.target,dependencyResultCode:A.resultCode};w.countDependency(A.duration,R);break}return!0}a(p,"_N"),s.preAggregatedMetricsTelemetryProcessor=p}),xi=F(s=>{"use strict";var T=s&&s.__createBinding||(Object.create?function(w,x,p,u){u===void 0&&(u=p),Object.defineProperty(w,u,{enumerable:!0,get:function(){return x[p]}})}:function(w,x,p,u){u===void 0&&(u=p),w[u]=x[p]}),f=s&&s.__exportStar||function(w,x){for(var p in w)p!=="default"&&!Object.prototype.hasOwnProperty.call(x,p)&&T(x,w,p)};Object.defineProperty(s,"__esModule",{value:!0}),f(yc(),s),f(no(),s),f(cn(),s),f(_c(),s)}),Il=F((s,T)=>{"use strict";var f=s&&s.__awaiter||function(C,A,R,D){function k(G){return G instanceof R?G:new R(function(Z){Z(G)})}return a(k,"i"),new(R||(R=Promise))(function(G,Z){function Q(Me){try{Se(D.next(Me))}catch(He){Z(He)}}a(Q,"o");function fe(Me){try{Se(D.throw(Me))}catch(He){Z(He)}}a(fe,"u");function Se(Me){Me.done?G(Me.value):k(Me.value).then(Q,fe)}a(Se,"c"),Se((D=D.apply(C,A||[])).next())})},w=s&&s.__generator||function(C,A){var R={label:0,sent:function(){if(G[0]&1)throw G[1];return G[1]},trys:[],ops:[]},D,k,G,Z;return Z={next:Q(0),throw:Q(1),return:Q(2)},typeof Symbol=="function"&&(Z[Symbol.iterator]=function(){return this}),Z;function Q(Se){return function(Me){return fe([Se,Me])}}function fe(Se){if(D)throw new TypeError("Generator is already executing.");for(;R;)try{if(D=1,k&&(G=Se[0]&2?k.return:Se[0]?k.throw||((G=k.return)&&G.call(k),0):k.next)&&!(G=G.call(k,Se[1])).done)return G;switch(k=0,G&&(Se=[Se[0]&2,G.value]),Se[0]){case 0:case 1:G=Se;break;case 4:return R.label++,{value:Se[1],done:!1};case 5:R.label++,k=Se[1],Se=[0];continue;case 7:Se=R.ops.pop(),R.trys.pop();continue;default:if(G=R.trys,!(G=G.length>0&&G[G.length-1])&&(Se[0]===6||Se[0]===2)){R=0;continue}if(Se[0]===3&&(!G||Se[1]>G[0]&&Se[1]<G[3])){R.label=Se[1];break}if(Se[0]===6&&R.label<G[1]){R.label=G[1],G=Se;break}if(G&&R.label<G[2]){R.label=G[2],R.ops.push(Se);break}G[2]&&R.ops.pop(),R.trys.pop();continue}Se=A.call(C,R)}catch(Me){Se=[6,Me],k=0}finally{D=G=0}if(Se[0]&5)throw Se[1];return{value:Se[0]?Se[1]:void 0,done:!0}}},x=K(7147),p=K(2037),u=K(1017),g=K(9796),v=K(2081),_=at(),b=_a(),y=fn(),E=function(){function C(A,R,D){if(this._redirectedHost=null,this._config=A,this._onSuccess=R,this._onError=D,this._enableDiskRetryMode=!1,this._resendInterval=C.WAIT_BETWEEN_RESEND,this._maxBytesOnDisk=C.MAX_BYTES_ON_DISK,this._numConsecutiveFailures=0,this._numConsecutiveRedirects=0,this._resendTimer=null,this._fileCleanupTimer=null,this._tempDir=u.join(p.tmpdir(),C.TEMPDIR_PREFIX+this._config.instrumentationKey),!C.OS_PROVIDES_FILE_PROTECTION)if(C.USE_ICACLS){try{C.OS_PROVIDES_FILE_PROTECTION=x.existsSync(C.ICACLS_PATH)}catch(k){}C.OS_PROVIDES_FILE_PROTECTION||_.warn(C.TAG,"Could not find ICACLS in expected location! This is necessary to use disk retry mode on Windows.")}else C.OS_PROVIDES_FILE_PROTECTION=!0}return a(C,"e"),C.prototype.setDiskRetryMode=function(A,R,D){var k=this;this._enableDiskRetryMode=C.OS_PROVIDES_FILE_PROTECTION&&A,typeof R=="number"&&R>=0&&(this._resendInterval=Math.floor(R)),typeof D=="number"&&D>=0&&(this._maxBytesOnDisk=Math.floor(D)),A&&!C.OS_PROVIDES_FILE_PROTECTION&&(this._enableDiskRetryMode=!1,_.warn(C.TAG,"Ignoring request to enable disk retry mode. Sufficient file protection capabilities were not detected.")),this._enableDiskRetryMode?this._fileCleanupTimer||(this._fileCleanupTimer=setTimeout(function(){k._fileCleanupTask()},C.CLEANUP_TIMEOUT),this._fileCleanupTimer.unref()):this._fileCleanupTimer&&clearTimeout(this._fileCleanupTimer)},C.prototype.send=function(A,R){return f(this,void 0,void 0,function(){var D,k,G,Z,Q=this;return w(this,function(fe){return A&&(D=this._redirectedHost||this._config.endpointUrl,k={method:"POST",withCredentials:!1,headers:{"Content-Type":"application/x-json-stream"}},G="",A.forEach(function(Se){var Me=Q._stringify(Se);typeof Me=="string"&&(G+=Me+`
`)}),G.length>0&&(G=G.substring(0,G.length-1)),Z=Buffer.from?Buffer.from(G):new Buffer(G),g.gzip(Z,function(Se,Me){var He=Me;Se?(_.warn(Se),He=Z,k.headers["Content-Length"]=Z.length.toString()):(k.headers["Content-Encoding"]="gzip",k.headers["Content-Length"]=Me.length.toString()),_.info(C.TAG,k),k[b.disableCollectionRequestOption]=!0;var Qe=a(function(mt){mt.setEncoding("utf-8");var Ct="";mt.on("data",function(Vt){Ct+=Vt}),mt.on("end",function(){if(Q._numConsecutiveFailures=0,Q._enableDiskRetryMode){if(mt.statusCode===200)Q._resendTimer||(Q._resendTimer=setTimeout(function(){Q._resendTimer=null,Q._sendFirstFileOnDisk()},Q._resendInterval),Q._resendTimer.unref());else if(Q._isRetriable(mt.statusCode))try{var Vt=JSON.parse(Ct),Bt=[];Vt.errors.forEach(function(Ht){Q._isRetriable(Ht.statusCode)&&Bt.push(A[Ht.index])}),Bt.length>0&&Q._storeToDisk(Bt)}catch(Ht){Q._storeToDisk(A)}}if(mt.statusCode===307||mt.statusCode===308)if(Q._numConsecutiveRedirects++,Q._numConsecutiveRedirects<10){var Er=mt.headers.location?mt.headers.location.toString():null;Er&&(Q._redirectedHost=Er,Q.send(A,R))}else typeof R=="function"&&R("Error sending telemetry because of circular redirects.");else Q._numConsecutiveRedirects=0,typeof R=="function"&&R(Ct),_.info(C.TAG,Ct),typeof Q._onSuccess=="function"&&Q._onSuccess(Ct)})},"d"),Ye=y.makeRequest(Q._config,D,k,Qe);Ye.on("error",function(mt){if(Q._numConsecutiveFailures++,!Q._enableDiskRetryMode||Q._numConsecutiveFailures>0&&Q._numConsecutiveFailures%C.MAX_CONNECTION_FAILURES_BEFORE_WARN==0){var Ct="Ingestion endpoint could not be reached. This batch of telemetry items has been lost. Use Disk Retry Caching to enable resending of failed telemetry. Error:";Q._enableDiskRetryMode&&(Ct="Ingestion endpoint could not be reached "+Q._numConsecutiveFailures+" consecutive times. There may be resulting telemetry loss. Most recent error:"),_.warn(C.TAG,Ct,y.dumpObj(mt))}else{var Ct="Transient failure to reach ingestion endpoint. This batch of telemetry items will be retried. Error:";_.info(C.TAG,Ct,y.dumpObj(mt))}Q._onErrorHelper(mt),typeof R=="function"&&(mt&&R(y.dumpObj(mt)),R("Error sending telemetry")),Q._enableDiskRetryMode&&Q._storeToDisk(A)}),Ye.write(He),Ye.end()})),[2]})})},C.prototype.saveOnCrash=function(A){this._enableDiskRetryMode&&this._storeToDiskSync(this._stringify(A))},C.prototype._isRetriable=function(A){return A===206||A===408||A===429||A===439||A===500||A===503},C.prototype._runICACLS=function(A,R){var D=v.spawn(C.ICACLS_PATH,A,{windowsHide:!0});D.on("error",function(k){return R(k)}),D.on("close",function(k,G){return R(k===0?null:new Error("Setting ACL restrictions did not succeed (ICACLS returned code "+k+")"))})},C.prototype._runICACLSSync=function(A){if(v.spawnSync){var R=v.spawnSync(C.ICACLS_PATH,A,{windowsHide:!0});if(R.error)throw R.error;if(R.status!==0)throw new Error("Setting ACL restrictions did not succeed (ICACLS returned code "+R.status+")")}else throw new Error("Could not synchronously call ICACLS under current version of Node.js")},C.prototype._getACLIdentity=function(A){if(C.ACL_IDENTITY)return A(null,C.ACL_IDENTITY);var R=v.spawn(C.POWERSHELL_PATH,["-Command","[System.Security.Principal.WindowsIdentity]::GetCurrent().Name"],{windowsHide:!0,stdio:["ignore","pipe","pipe"]}),D="";R.stdout.on("data",function(k){return D+=k}),R.on("error",function(k){return A(k,null)}),R.on("close",function(k,G){return C.ACL_IDENTITY=D&&D.trim(),A(k===0?null:new Error("Getting ACL identity did not succeed (PS returned code "+k+")"),C.ACL_IDENTITY)})},C.prototype._getACLIdentitySync=function(){if(C.ACL_IDENTITY)return C.ACL_IDENTITY;if(v.spawnSync){var A=v.spawnSync(C.POWERSHELL_PATH,["-Command","[System.Security.Principal.WindowsIdentity]::GetCurrent().Name"],{windowsHide:!0,stdio:["ignore","pipe","pipe"]});if(A.error)throw A.error;if(A.status!==0)throw new Error("Getting ACL identity did not succeed (PS returned code "+A.status+")");return C.ACL_IDENTITY=A.stdout&&A.stdout.toString().trim(),C.ACL_IDENTITY}else throw new Error("Could not synchronously get ACL identity under current version of Node.js")},C.prototype._getACLArguments=function(A,R){return[A,"/grant","*S-1-5-32-544:(OI)(CI)F","/grant",R+":(OI)(CI)F","/inheritance:r"]},C.prototype._applyACLRules=function(A,R){var D=this;if(!C.USE_ICACLS)return R(null);if(C.ACLED_DIRECTORIES[A]===void 0)C.ACLED_DIRECTORIES[A]=!1,this._getACLIdentity(function(k,G){if(k)return C.ACLED_DIRECTORIES[A]=!1,R(k);D._runICACLS(D._getACLArguments(A,G),function(Z){return C.ACLED_DIRECTORIES[A]=!Z,R(Z)})});else return R(C.ACLED_DIRECTORIES[A]?null:new Error("Setting ACL restrictions did not succeed (cached result)"))},C.prototype._applyACLRulesSync=function(A){if(C.USE_ICACLS){if(C.ACLED_DIRECTORIES[A]===void 0){this._runICACLSSync(this._getACLArguments(A,this._getACLIdentitySync())),C.ACLED_DIRECTORIES[A]=!0;return}else if(!C.ACLED_DIRECTORIES[A])throw new Error("Setting ACL restrictions did not succeed (cached result)")}},C.prototype._confirmDirExists=function(A,R){var D=this;x.lstat(A,function(k,G){k&&k.code==="ENOENT"?x.mkdir(A,function(Z){Z&&Z.code!=="EEXIST"?R(Z):D._applyACLRules(A,R)}):!k&&G.isDirectory()?D._applyACLRules(A,R):R(k||new Error("Path existed but was not a directory"))})},C.prototype._getShallowDirectorySize=function(A,R){x.readdir(A,function(D,k){if(D)return R(D,-1);var G=null,Z=0,Q=0;if(k.length===0){R(null,0);return}for(var fe=0;fe<k.length;fe++)x.stat(u.join(A,k[fe]),function(Se,Me){Q++,Se?G=Se:Me.isFile()&&(Z+=Me.size),Q===k.length&&(G?R(G,-1):R(G,Z))})})},C.prototype._getShallowDirectorySizeSync=function(A){for(var R=x.readdirSync(A),D=0,k=0;k<R.length;k++)D+=x.statSync(u.join(A,R[k])).size;return D},C.prototype._storeToDisk=function(A){var R=this;_.info(C.TAG,"Checking existence of data storage directory: "+this._tempDir),this._confirmDirExists(this._tempDir,function(D){if(D){_.warn(C.TAG,"Error while checking/creating directory: "+(D&&D.message)),R._onErrorHelper(D);return}R._getShallowDirectorySize(R._tempDir,function(k,G){if(k||G<0){_.warn(C.TAG,"Error while checking directory size: "+(k&&k.message)),R._onErrorHelper(k);return}else if(G>R._maxBytesOnDisk){_.warn(C.TAG,"Not saving data due to max size limit being met. Directory size in bytes is: "+G);return}var Z=new Date().getTime()+".ai.json",Q=u.join(R._tempDir,Z);_.info(C.TAG,"saving data to disk at: "+Q),x.writeFile(Q,R._stringify(A),{mode:384},function(fe){return R._onErrorHelper(fe)})})})},C.prototype._storeToDiskSync=function(A){try{_.info(C.TAG,"Checking existence of data storage directory: "+this._tempDir),x.existsSync(this._tempDir)||x.mkdirSync(this._tempDir),this._applyACLRulesSync(this._tempDir);var R=this._getShallowDirectorySizeSync(this._tempDir);if(R>this._maxBytesOnDisk){_.info(C.TAG,"Not saving data due to max size limit being met. Directory size in bytes is: "+R);return}var D=new Date().getTime()+".ai.json",k=u.join(this._tempDir,D);_.info(C.TAG,"saving data before crash to disk at: "+k),x.writeFileSync(k,A,{mode:384})}catch(G){_.warn(C.TAG,"Error while saving data to disk: "+(G&&G.message)),this._onErrorHelper(G)}},C.prototype._sendFirstFileOnDisk=function(){var A=this;x.exists(this._tempDir,function(R){R&&x.readdir(A._tempDir,function(D,k){if(D)A._onErrorHelper(D);else if(k=k.filter(function(Q){return u.basename(Q).indexOf(".ai.json")>-1}),k.length>0){var G=k[0],Z=u.join(A._tempDir,G);x.readFile(Z,function(Q,fe){Q?A._onErrorHelper(Q):x.unlink(Z,function(Se){if(Se)A._onErrorHelper(Se);else try{var Me=JSON.parse(fe.toString());A.send(Me)}catch(He){_.warn("Failed to read persisted file",He)}})})}})})},C.prototype._onErrorHelper=function(A){typeof this._onError=="function"&&this._onError(A)},C.prototype._stringify=function(A){try{return JSON.stringify(A)}catch(R){_.warn("Failed to serialize payload",R,A)}},C.prototype._fileCleanupTask=function(){var A=this;x.exists(this._tempDir,function(R){R&&x.readdir(A._tempDir,function(D,k){D?A._onErrorHelper(D):(k=k.filter(function(G){return u.basename(G).indexOf(".ai.json")>-1}),k.length>0&&k.forEach(function(G){var Z=new Date(parseInt(G.split(".ai.json")[0])),Q=new Date(+new Date-C.FILE_RETEMPTION_PERIOD)>Z;if(Q){var fe=u.join(A._tempDir,G);x.unlink(fe,function(Se){Se&&A._onErrorHelper(Se)})}}))})})},C.TAG="Sender",C.ICACLS_PATH=process.env.systemdrive+"/windows/system32/icacls.exe",C.POWERSHELL_PATH=process.env.systemdrive+"/windows/system32/windowspowershell/v1.0/powershell.exe",C.ACLED_DIRECTORIES={},C.ACL_IDENTITY=null,C.WAIT_BETWEEN_RESEND=60*1e3,C.MAX_BYTES_ON_DISK=50*1024*1024,C.MAX_CONNECTION_FAILURES_BEFORE_WARN=5,C.CLEANUP_TIMEOUT=60*60*1e3,C.FILE_RETEMPTION_PERIOD=7*24*60*60*1e3,C.TEMPDIR_PREFIX="appInsights-node",C.OS_PROVIDES_FILE_PROTECTION=!1,C.USE_ICACLS=p.type()==="Windows_NT",C}();T.exports=E}),Fr=F((s,T)=>{"use strict";var f=$t(),w=fn(),x=mn(),p=function(){function g(){}return a(g,"e"),g.createEnvelope=function(v,_,b,y,E){var C=null;switch(_){case f.TelemetryType.Trace:C=g.createTraceData(v);break;case f.TelemetryType.Dependency:C=g.createDependencyData(v);break;case f.TelemetryType.Event:C=g.createEventData(v);break;case f.TelemetryType.Exception:C=g.createExceptionData(v);break;case f.TelemetryType.Request:C=g.createRequestData(v);break;case f.TelemetryType.Metric:C=g.createMetricData(v);break;case f.TelemetryType.Availability:C=g.createAvailabilityData(v);break;case f.TelemetryType.PageView:C=g.createPageViewData(v);break}if(b&&f.domainSupportsProperties(C.baseData)){if(C&&C.baseData)if(!C.baseData.properties)C.baseData.properties=b;else for(var A in b)C.baseData.properties[A]||(C.baseData.properties[A]=b[A]);C.baseData.properties=w.validateStringMap(C.baseData.properties)}var R=E&&E.instrumentationKey||"",D=new f.Envelope;return D.data=C,D.iKey=R,D.name="Microsoft.ApplicationInsights."+R.replace(/-/g,"")+"."+C.baseType.substr(0,C.baseType.length-4),D.tags=this.getTags(y,v.tagOverrides),D.time=new Date().toISOString(),D.ver=1,D.sampleRate=E?E.samplingPercentage:100,_===f.TelemetryType.Metric&&(D.sampleRate=100),D},g.createTraceData=function(v){var _=new f.MessageData;_.message=v.message,_.properties=v.properties,isNaN(v.severity)?_.severityLevel=f.SeverityLevel.Information:_.severityLevel=v.severity;var b=new f.Data;return b.baseType=f.telemetryTypeToBaseType(f.TelemetryType.Trace),b.baseData=_,b},g.createDependencyData=function(v){var _=new f.RemoteDependencyData;typeof v.name=="string"&&(_.name=v.name.length>1024?v.name.slice(0,1021)+"...":v.name),_.data=v.data,_.target=v.target,_.duration=w.msToTimeSpan(v.duration),_.success=v.success,_.type=v.dependencyTypeName,_.properties=v.properties,_.resultCode=v.resultCode?v.resultCode+"":"",v.id?_.id=v.id:_.id=w.w3cTraceId();var b=new f.Data;return b.baseType=f.telemetryTypeToBaseType(f.TelemetryType.Dependency),b.baseData=_,b},g.createEventData=function(v){var _=new f.EventData;_.name=v.name,_.properties=v.properties,_.measurements=v.measurements;var b=new f.Data;return b.baseType=f.telemetryTypeToBaseType(f.TelemetryType.Event),b.baseData=_,b},g.createExceptionData=function(v){var _=new f.ExceptionData;_.properties=v.properties,isNaN(v.severity)?_.severityLevel=f.SeverityLevel.Error:_.severityLevel=v.severity,_.measurements=v.measurements,_.exceptions=[];var b=v.exception.stack,y=new f.ExceptionDetails;y.message=v.exception.message,y.typeName=v.exception.name,y.parsedStack=this.parseStack(b),y.hasFullStack=w.isArray(y.parsedStack)&&y.parsedStack.length>0,_.exceptions.push(y);var E=new f.Data;return E.baseType=f.telemetryTypeToBaseType(f.TelemetryType.Exception),E.baseData=_,E},g.createRequestData=function(v){var _=new f.RequestData;v.id?_.id=v.id:_.id=w.w3cTraceId(),_.name=v.name,_.url=v.url,_.source=v.source,_.duration=w.msToTimeSpan(v.duration),_.responseCode=v.resultCode?v.resultCode+"":"",_.success=v.success,_.properties=v.properties;var b=new f.Data;return b.baseType=f.telemetryTypeToBaseType(f.TelemetryType.Request),b.baseData=_,b},g.createMetricData=function(v){var _=new f.MetricData;_.metrics=[];var b=new f.DataPoint;b.count=isNaN(v.count)?1:v.count,b.kind=f.DataPointType.Aggregation,b.max=isNaN(v.max)?v.value:v.max,b.min=isNaN(v.min)?v.value:v.min,b.name=v.name,b.stdDev=isNaN(v.stdDev)?0:v.stdDev,b.value=v.value,_.metrics.push(b),_.properties=v.properties;var y=new f.Data;return y.baseType=f.telemetryTypeToBaseType(f.TelemetryType.Metric),y.baseData=_,y},g.createAvailabilityData=function(v){var _=new f.AvailabilityData;v.id?_.id=v.id:_.id=w.w3cTraceId(),_.name=v.name,_.duration=w.msToTimeSpan(v.duration),_.success=v.success,_.runLocation=v.runLocation,_.message=v.message,_.measurements=v.measurements,_.properties=v.properties;var b=new f.Data;return b.baseType=f.telemetryTypeToBaseType(f.TelemetryType.Availability),b.baseData=_,b},g.createPageViewData=function(v){var _=new f.PageViewData;_.name=v.name,_.duration=w.msToTimeSpan(v.duration),_.url=v.url,_.measurements=v.measurements,_.properties=v.properties;var b=new f.Data;return b.baseType=f.telemetryTypeToBaseType(f.TelemetryType.PageView),b.baseData=_,b},g.getTags=function(v,_){var b=x.CorrelationContextManager.getCurrentContext(),y={};if(v&&v.tags)for(var E in v.tags)y[E]=v.tags[E];if(_)for(var E in _)y[E]=_[E];return b&&(y[v.keys.operationId]=y[v.keys.operationId]||b.operation.id,y[v.keys.operationName]=y[v.keys.operationName]||b.operation.name,y[v.keys.operationParentId]=y[v.keys.operationParentId]||b.operation.parentId),y},g.parseStack=function(v){var _=void 0;if(typeof v=="string"){var b=v.split(`
`);_=[];for(var y=0,E=0,C=0;C<=b.length;C++){var A=b[C];if(u.regex.test(A)){var R=new u(b[C],y++);E+=R.sizeInBytes,_.push(R)}}var D=32*1024;if(E>D)for(var k=0,G=_.length-1,Z=0,Q=k,fe=G;k<G;){var Se=_[k].sizeInBytes,Me=_[G].sizeInBytes;if(Z+=Se+Me,Z>D){var He=fe-Q+1;_.splice(Q,He);break}Q=k,fe=G,k++,G--}}return _},g}(),u=function(){function g(v,_){this.sizeInBytes=0,this.level=_,this.method="<no_method>",this.assembly=w.trim(v);var b=v.match(g.regex);b&&b.length>=5&&(this.method=w.trim(b[2])||this.method,this.fileName=w.trim(b[4])||"<no_filename>",this.line=parseInt(b[5])||0),this.sizeInBytes+=this.method.length,this.sizeInBytes+=this.fileName.length,this.sizeInBytes+=this.assembly.length,this.sizeInBytes+=g.baseSize,this.sizeInBytes+=this.level.toString().length,this.sizeInBytes+=this.line.toString().length}return a(g,"e"),g.regex=/^(\s+at)?(.*?)(\@|\s\(|\s)([^\(\n]+):(\d+):(\d+)(\)?)$/,g.baseSize=58,g}();T.exports=p}),Fo=F((s,T)=>{"use strict";var f=K(7310),w=sn(),x=ds(),p=$t(),u=Ei(),g=xi(),v=mn(),_=Il(),b=fn(),y=at(),E=Fr(),C=function(){function A(R){this._telemetryProcessors=[],this._enableAzureProperties=!1;var D=new w(R);this.config=D,this.context=new x,this.commonProperties={};var k=new _(this.config);this.channel=new u(function(){return D.disableAppInsights},function(){return D.maxBatchSize},function(){return D.maxBatchIntervalMs},k)}return a(A,"e"),A.prototype.trackAvailability=function(R){this.track(R,p.TelemetryType.Availability)},A.prototype.trackPageView=function(R){this.track(R,p.TelemetryType.PageView)},A.prototype.trackTrace=function(R){this.track(R,p.TelemetryType.Trace)},A.prototype.trackMetric=function(R){this.track(R,p.TelemetryType.Metric)},A.prototype.trackException=function(R){R&&R.exception&&!b.isError(R.exception)&&(R.exception=new Error(R.exception.toString())),this.track(R,p.TelemetryType.Exception)},A.prototype.trackEvent=function(R){this.track(R,p.TelemetryType.Event)},A.prototype.trackRequest=function(R){this.track(R,p.TelemetryType.Request)},A.prototype.trackDependency=function(R){R&&!R.target&&R.data&&(R.target=f.parse(R.data).host),this.track(R,p.TelemetryType.Dependency)},A.prototype.flush=function(R){this.channel.triggerSend(R?!!R.isAppCrashing:!1,R?R.callback:void 0)},A.prototype.track=function(R,D){if(R&&p.telemetryTypeToBaseType(D)){var k=E.createEnvelope(R,D,this.commonProperties,this.context,this.config);R.time&&(k.time=R.time.toISOString()),this._enableAzureProperties&&g.azureRoleEnvironmentTelemetryProcessor(k,this.context);var G=this.runTelemetryProcessors(k,R.contextObjects);G=G&&g.samplingTelemetryProcessor(k,{correlationContext:v.CorrelationContextManager.getCurrentContext()}),g.preAggregatedMetricsTelemetryProcessor(k,this.context),G&&(g.performanceMetricsTelemetryProcessor(k,this.quickPulseClient),this.channel.send(k))}else y.warn("track() requires telemetry object and telemetryType to be specified.")},A.prototype.setAutoPopulateAzureProperties=function(R){this._enableAzureProperties=R},A.prototype.addTelemetryProcessor=function(R){this._telemetryProcessors.push(R)},A.prototype.clearTelemetryProcessors=function(){this._telemetryProcessors=[]},A.prototype.runTelemetryProcessors=function(R,D){var k=!0,G=this._telemetryProcessors.length;if(G===0)return k;D=D||{},D.correlationContext=v.CorrelationContextManager.getCurrentContext();for(var Z=0;Z<G;++Z)try{var Q=this._telemetryProcessors[Z];if(Q&&Q.apply(null,[R,D])===!1){k=!1;break}}catch(fe){k=!0,y.warn("One of telemetry processors failed, telemetry item will be sent.",fe,R)}return k&&(R&&R.tags&&(R.tags=b.validateStringMap(R.tags)),R&&R.data&&R.data.baseData&&R.data.baseData.properties&&(R.data.baseData.properties=b.validateStringMap(R.data.baseData.properties))),k},A}();T.exports=C}),zu=F((s,T)=>{"use strict";var f=s&&s.__extends||function(){var v=a(function(_,b){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(y,E){y.__proto__=E}||function(y,E){for(var C in E)Object.prototype.hasOwnProperty.call(E,C)&&(y[C]=E[C])},v(_,b)},"e");return function(_,b){v(_,b);function y(){this.constructor=_}a(y,"n"),_.prototype=b===null?Object.create(b):(y.prototype=b.prototype,new y)}}(),w=Fo(),x=Al(),p=_a(),u=at(),g=function(v){f(_,v);function _(){return v!==null&&v.apply(this,arguments)||this}return a(_,"t"),_.prototype.trackNodeHttpRequestSync=function(b){b&&b.request&&b.response&&b.duration?x.trackRequestSync(this,b):u.warn("trackNodeHttpRequestSync requires NodeHttpRequestTelemetry object with request, response and duration specified.")},_.prototype.trackNodeHttpRequest=function(b){(b.duration||b.error)&&u.warn("trackNodeHttpRequest will ignore supplied duration and error parameters. These values are collected from the request and response objects."),b&&b.request&&b.response?x.trackRequest(this,b):u.warn("trackNodeHttpRequest requires NodeHttpRequestTelemetry object with request and response specified.")},_.prototype.trackNodeHttpDependency=function(b){b&&b.request?p.trackRequest(this,b):u.warn("trackNodeHttpDependency requires NodeHttpDependencyTelemetry object with request specified.")},_}(w);T.exports=g}),Ol=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),wa=F(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.dispose=s.Configuration=s.wrapWithCorrelationContext=s.startOperation=s.getCorrelationContext=s.start=s.setup=s.liveMetricsClient=s.defaultClient=s.DistributedTracingModes=void 0;var T=mn(),f=Or(),w=Lu(),x=ya(),p=Tl(),u=ju(),g=_a(),v=Al(),_=J(),b=at(),y=$o(),E=qu();s.TelemetryClient=zu(),s.Contracts=$t(),s.azureFunctionsTypes=Ol();var C;(function(Nt){Nt[Nt.AI=0]="AI",Nt[Nt.AI_AND_W3C=1]="AI_AND_W3C"})(C=s.DistributedTracingModes||(s.DistributedTracingModes={}));var A=!0,R=!1,D=!0,k=!0,G=!0,Z=!1,Q=!0,fe=!0,Se=!0,Me=!0,He,Qe=!1,Ye=!0,mt,Ct=void 0,Vt=void 0,Bt,Er,Ht,Je,ct,dt,Et,kt,zt=!1,Tt;function ar(Nt){return s.defaultClient?b.info("The default client is already setup"):(s.defaultClient=new s.TelemetryClient(Nt),Bt=new f(s.defaultClient),Er=new w(s.defaultClient),Ht=new x(s.defaultClient),Je=new p(s.defaultClient),ct=new u(s.defaultClient),Et=new v(s.defaultClient),kt=new g(s.defaultClient),dt||(dt=new E.AutoCollectNativePerformance(s.defaultClient))),s.defaultClient&&s.defaultClient.channel&&s.defaultClient.channel.setUseDiskRetryCaching(Se,Ct,Vt),Pr}a(ar,"GN"),s.setup=ar;function gr(){return s.defaultClient?(zt=!0,Bt.enable(A,R),Er.enable(D),Ht.enable(k),Je.enable(G),ct.enable(Z,s.defaultClient.config),dt.enable(Ye,mt),Et.useAutoCorrelation(Me,He),Et.enable(Q),kt.enable(fe),s.liveMetricsClient&&Qe&&s.liveMetricsClient.enable(Qe)):b.warn("Start cannot be called before setup"),Pr}a(gr,"PE"),s.start=gr;function fr(){return Me?T.CorrelationContextManager.getCurrentContext():null}a(fr,"FN"),s.getCorrelationContext=fr;function _r(Nt,At){return T.CorrelationContextManager.startOperation(Nt,At)}a(_r,"VN"),s.startOperation=_r;function or(Nt,At){return T.CorrelationContextManager.wrapCallback(Nt,At)}a(or,"$N"),s.wrapWithCorrelationContext=or;var Pr=function(){function Nt(){}return a(Nt,"e"),Nt.setDistributedTracingMode=function(At){return _.w3cEnabled=At===C.AI_AND_W3C,Nt},Nt.setAutoCollectConsole=function(At,nr){return nr===void 0&&(nr=!1),A=At,R=nr,zt&&Bt.enable(At,nr),Nt},Nt.setAutoCollectExceptions=function(At){return D=At,zt&&Er.enable(At),Nt},Nt.setAutoCollectPerformance=function(At,nr){nr===void 0&&(nr=!0),k=At;var jr=E.AutoCollectNativePerformance.parseEnabled(nr);return Ye=jr.isEnabled,mt=jr.disabledMetrics,zt&&(Ht.enable(At),dt.enable(jr.isEnabled,jr.disabledMetrics)),Nt},Nt.setAutoCollectPreAggregatedMetrics=function(At){return G=At,zt&&Je.enable(At),Nt},Nt.setAutoCollectHeartbeat=function(At){return Z=At,zt&&ct.enable(At,s.defaultClient.config),Nt},Nt.setAutoCollectRequests=function(At){return Q=At,zt&&Et.enable(At),Nt},Nt.setAutoCollectDependencies=function(At){return fe=At,zt&&kt.enable(At),Nt},Nt.setAutoDependencyCorrelation=function(At,nr){return Me=At,He=nr,zt&&Et.useAutoCorrelation(At,nr),Nt},Nt.setUseDiskRetryCaching=function(At,nr,jr){return Se=At,Ct=nr,Vt=jr,s.defaultClient&&s.defaultClient.channel&&s.defaultClient.channel.setUseDiskRetryCaching(At,nr,jr),Nt},Nt.setInternalLogging=function(At,nr){return At===void 0&&(At=!1),nr===void 0&&(nr=!0),b.enableDebug=At,b.disableWarnings=!nr,Nt},Nt.setSendLiveMetrics=function(At){return At===void 0&&(At=!1),s.defaultClient?(!s.liveMetricsClient&&At?(s.liveMetricsClient=new y(s.defaultClient.config,null),Tt=new x(s.liveMetricsClient,1e3,!0),s.liveMetricsClient.addCollector(Tt),s.defaultClient.quickPulseClient=s.liveMetricsClient):s.liveMetricsClient&&s.liveMetricsClient.enable(At),Qe=At,Nt):(b.warn("Live metrics client cannot be setup without the default client"),Nt)},Nt.start=gr,Nt}();s.Configuration=Pr;function En(){_.w3cEnabled=!0,s.defaultClient=null,zt=!1,Bt&&Bt.dispose(),Er&&Er.dispose(),Ht&&Ht.dispose(),Je&&Je.dispose(),ct&&ct.dispose(),dt&&dt.dispose(),Et&&Et.dispose(),kt&&kt.dispose(),s.liveMetricsClient&&(s.liveMetricsClient.enable(!1),Qe=!1,s.liveMetricsClient=void 0)}a(En,"zN"),s.dispose=En});Y(B,{default:()=>Bo});var wc=qe(K(2037)),io=qe(K(9496)),mr=qe(K(9496)),bc=qe(K(9496)),Hn;(function(s){s.ON="on",s.ERROR="error",s.OFF="off"})(Hn||(Hn={}));function gs(){let s="telemetry",T="enableTelemetry";return bc.env.isTelemetryEnabled!==void 0?bc.env.isTelemetryEnabled?Hn.ON:Hn.OFF:bc.workspace.getConfiguration(s).get(T)?Hn.ON:Hn.OFF}a(gs,"Fi");var ba=a(class{constructor(s,T,f,w,x){this.extensionId=s,this.extensionVersion=T,this.telemetryAppender=f,this.osShim=w,this.firstParty=!1,this.userOptIn=!1,this.errorOptIn=!1,this.disposables=[],this.firstParty=!!x,this.updateUserOptStatus(),mr.env.onDidChangeTelemetryEnabled!==void 0?(this.disposables.push(mr.env.onDidChangeTelemetryEnabled(()=>this.updateUserOptStatus())),this.disposables.push(mr.workspace.onDidChangeConfiguration(()=>this.updateUserOptStatus()))):this.disposables.push(mr.workspace.onDidChangeConfiguration(()=>this.updateUserOptStatus()))}updateUserOptStatus(){let s=gs();this.userOptIn=s===Hn.ON,this.errorOptIn=s===Hn.ERROR||s===Hn.ON,(this.userOptIn||this.errorOptIn)&&this.telemetryAppender.instantiateAppender()}cleanRemoteName(s){if(!s)return"none";let T="other";return["ssh-remote","dev-container","attached-container","wsl"].forEach(f=>{s.indexOf(`${f}+`)===0&&(T=f)}),T}get extension(){return this._extension===void 0&&(this._extension=mr.extensions.getExtension(this.extensionId)),this._extension}cloneAndChange(s,T){if(s===null||typeof s!="object"||typeof T!="function")return s;let f={};for(let w in s)f[w]=T(w,s[w]);return f}shouldSendErrorTelemetry(){return this.errorOptIn===!1?!1:this.firstParty?this.cleanRemoteName(mr.env.remoteName)!=="other"?!0:!(this.extension===void 0||this.extension.extensionKind===mr.ExtensionKind.Workspace||mr.env.uiKind===mr.UIKind.Web):!0}getCommonProperties(){let s=Object.create(null);if(s["common.os"]=this.osShim.platform,s["common.platformversion"]=(this.osShim.release||"").replace(/^(\d+)(\.\d+)?(\.\d+)?(.*)/,"$1$2$3"),s["common.extname"]=this.extensionId,s["common.extversion"]=this.extensionVersion,mr&&mr.env){switch(s["common.vscodemachineid"]=mr.env.machineId,s["common.vscodesessionid"]=mr.env.sessionId,s["common.vscodeversion"]=mr.version,s["common.isnewappinstall"]=mr.env.isNewAppInstall?mr.env.isNewAppInstall.toString():"false",s["common.product"]=mr.env.appHost,mr.env.uiKind){case mr.UIKind.Web:s["common.uikind"]="web";break;case mr.UIKind.Desktop:s["common.uikind"]="desktop";break;default:s["common.uikind"]="unknown"}s["common.remotename"]=this.cleanRemoteName(mr.env.remoteName)}return s}anonymizeFilePaths(s,T){let f;if(s==null)return"";let w=[];mr.env.appRoot!==""&&w.push(new RegExp(mr.env.appRoot.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi")),this.extension&&w.push(new RegExp(this.extension.extensionPath.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi"));let x=s;if(T){let p=[];for(let _ of w)for(;(f=_.exec(s))&&f;)p.push([f.index,_.lastIndex]);let u=/^[\\/]?(node_modules|node_modules\.asar)[\\/]/,g=/(file:\/\/)?([a-zA-Z]:(\\\\|\\|\/)|(\\\\|\\|\/))?([\w-._]+(\\\\|\\|\/))+[\w-._]*/g,v=0;for(x="";(f=g.exec(s))&&f;)f[0]&&!u.test(f[0])&&p.every(([_,b])=>f.index<_||f.index>=b)&&(x+=s.substring(v,f.index)+"<REDACTED: user-file-path>",v=g.lastIndex);v<s.length&&(x+=s.substr(v))}for(let p of w)x=x.replace(p,"");return x}removePropertiesWithPossibleUserInfo(s){if(typeof s!="object")return;let T=Object.create(null);for(let f of Object.keys(s)){let w=s[f];if(!w)continue;let x=/@[a-zA-Z0-9-.]+/;/\S*(key|token|sig|password|passwd|pwd)[="':\s]+\S*/.test(w.toLowerCase())?T[f]="<REDACTED: secret>":x.test(w)?T[f]="<REDACTED: email>":T[f]=w}return T}sendTelemetryEvent(s,T,f){if(this.userOptIn&&s!==""){T=X(X({},T),this.getCommonProperties());let w=this.cloneAndChange(T,(x,p)=>this.anonymizeFilePaths(p,this.firstParty));this.telemetryAppender.logEvent(`${this.extensionId}/${s}`,{properties:this.removePropertiesWithPossibleUserInfo(w),measurements:f})}}sendTelemetryErrorEvent(s,T,f,w){if(this.errorOptIn&&s!==""){T=X(X({},T),this.getCommonProperties());let x=this.cloneAndChange(T,(p,u)=>this.shouldSendErrorTelemetry()?this.anonymizeFilePaths(u,this.firstParty):w===void 0||w.indexOf(p)!==-1?"REDACTED":this.anonymizeFilePaths(u,this.firstParty));this.telemetryAppender.logEvent(`${this.extensionId}/${s}`,{properties:this.removePropertiesWithPossibleUserInfo(x),measurements:f})}}sendTelemetryException(s,T,f){if(this.shouldSendErrorTelemetry()&&this.errorOptIn&&s){T=X(X({},T),this.getCommonProperties());let w=this.cloneAndChange(T,(x,p)=>this.anonymizeFilePaths(p,this.firstParty));s.stack&&(s.stack=this.anonymizeFilePaths(s.stack,this.firstParty)),this.telemetryAppender.logException(s,{properties:this.removePropertiesWithPossibleUserInfo(w),measurements:f})}}dispose(){return this.telemetryAppender.flush(),Promise.all(this.disposables.map(s=>s.dispose()))}},"ao"),Pl=a(class{constructor(s){this._key=s,this._isInstantiated=!1,gs()!==Hn.OFF&&this.instantiateAppender()}logEvent(s,T){!this._appInsightsClient||this._appInsightsClient.trackEvent({name:s,properties:T==null?void 0:T.properties,measurements:T==null?void 0:T.measurements})}logException(s,T){!this._appInsightsClient||this._appInsightsClient.trackException({exception:s,properties:T==null?void 0:T.properties,measurements:T==null?void 0:T.measurements})}flush(){return this._appInsightsClient&&(this._appInsightsClient.flush(),this._appInsightsClient=void 0),Promise.resolve(void 0)}instantiateAppender(){this._isInstantiated||Promise.resolve().then(()=>qe(wa())).then(s=>{s.defaultClient?(this._appInsightsClient=new s.TelemetryClient(this._key),this._appInsightsClient.channel.setUseDiskRetryCaching(!0)):(s.setup(this._key).setAutoCollectRequests(!1).setAutoCollectPerformance(!1).setAutoCollectExceptions(!1).setAutoCollectDependencies(!1).setAutoDependencyCorrelation(!1).setAutoCollectConsole(!1).setUseDiskRetryCaching(!0).start(),this._appInsightsClient=s.defaultClient),io&&io.env&&(this._appInsightsClient.context.tags[this._appInsightsClient.context.keys.userId]=io.env.machineId,this._appInsightsClient.context.tags[this._appInsightsClient.context.keys.sessionId]=io.env.sessionId,this._appInsightsClient.context.tags[this._appInsightsClient.context.keys.cloudRole]=io.env.appName,this._appInsightsClient.context.tags[this._appInsightsClient.context.keys.cloudRoleInstance]=io.env.appName),this._key&&this._key.indexOf("AIF-")===0&&(this._appInsightsClient.config.endpointUrl="https://vortex.data.microsoft.com/collect/v1"),this._isInstantiated=!0})}},"NE"),Bo=a(class extends ba{constructor(s,T,f,w){let x=new Pl(f);f&&f.indexOf("AIF-")===0&&(w=!0);super(s,T,x,{release:wc.release(),platform:wc.platform()},w)}},"_l")},3255:m=>{function B(K){var q=new Error("Cannot find module '"+K+"'");throw q.code="MODULE_NOT_FOUND",q}a(B,"webpackEmptyContext"),B.keys=()=>[],B.resolve=B,B.id=3255,m.exports=B},9118:m=>{function B(K){var q=new Error("Cannot find module '"+K+"'");throw q.code="MODULE_NOT_FOUND",q}a(B,"webpackEmptyContext"),B.keys=()=>[],B.resolve=B,B.id=9118,m.exports=B},800:(m,B,K)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),B.config=B.loadMessageBundle=B.localize=B.format=B.setPseudo=B.isPseudo=B.isDefined=B.BundleFormat=B.MessageFormat=void 0;var q=K(1926),j;(function(pe){pe.file="file",pe.bundle="bundle",pe.both="both"})(j=B.MessageFormat||(B.MessageFormat={}));var se;(function(pe){pe.standalone="standalone",pe.languagePack="languagePack"})(se=B.BundleFormat||(B.BundleFormat={}));var ne;(function(pe){function F(Y){var Ve=Y;return Ve&&ue(Ve.key)&&ue(Ve.comment)}a(F,"is"),pe.is=F})(ne||(ne={}));function ue(pe){return typeof pe!="undefined"}a(ue,"isDefined"),B.isDefined=ue,B.isPseudo=!1;function ce(pe){B.isPseudo=pe}a(ce,"setPseudo"),B.setPseudo=ce;function z(pe,F){var Y;return B.isPseudo&&(pe="\uFF3B"+pe.replace(/[aouei]/g,"$&$&")+"\uFF3D"),F.length===0?Y=pe:Y=pe.replace(/\{(\d+)\}/g,function(Ve,qe){var at=qe[0],we=F[at],Ee=Ve;return typeof we=="string"?Ee=we:(typeof we=="number"||typeof we=="boolean"||we===void 0||we===null)&&(Ee=String(we)),Ee}),Y}a(z,"format"),B.format=z;function H(pe,F){for(var Y=[],Ve=2;Ve<arguments.length;Ve++)Y[Ve-2]=arguments[Ve];return z(F,Y)}a(H,"localize"),B.localize=H;function M(pe){return q.default().loadMessageBundle(pe)}a(M,"loadMessageBundle"),B.loadMessageBundle=M;function X(pe){return q.default().config(pe)}a(X,"config"),B.config=X},1926:(m,B)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0});var K;function q(){if(K===void 0)throw new Error("No runtime abstraction layer installed");return K}a(q,"RAL"),function(j){function se(ne){if(ne===void 0)throw new Error("No runtime abstraction layer provided");K=ne}a(se,"install"),j.install=se}(q||(q={})),B.default=q},8472:(m,B,K)=>{"use strict";var q;q={value:!0},q=B.loadMessageBundle=void 0;var j=K(1017),se=K(7147),ne=K(1926),ue=K(800),ce=K(800);q={enumerable:!0,get:function(){return ce.MessageFormat}},q={enumerable:!0,get:function(){return ce.BundleFormat}};var z=Object.prototype.toString;function H(ve){return z.call(ve)==="[object Number]"}a(H,"isNumber");function M(ve){return z.call(ve)==="[object String]"}a(M,"isString");function X(ve){return ve===!0||ve===!1}a(X,"isBoolean");function pe(ve){return JSON.parse(se.readFileSync(ve,"utf8"))}a(pe,"readJsonFileSync");var F,Y;function Ve(){if(Y={locale:void 0,language:void 0,languagePackSupport:!1,cacheLanguageResolution:!0,messageFormat:ue.MessageFormat.bundle},M(process.env.VSCODE_NLS_CONFIG))try{var ve=JSON.parse(process.env.VSCODE_NLS_CONFIG),Ue=void 0;if(ve.availableLanguages){var Xe=ve.availableLanguages["*"];M(Xe)&&(Ue=Xe)}if(M(ve.locale)&&(Y.locale=ve.locale.toLowerCase()),Ue===void 0?Y.language=Y.locale:Ue!=="en"&&(Y.language=Ue),X(ve._languagePackSupport)&&(Y.languagePackSupport=ve._languagePackSupport),M(ve._cacheRoot)&&(Y.cacheRoot=ve._cacheRoot),M(ve._languagePackId)&&(Y.languagePackId=ve._languagePackId),M(ve._translationsConfigFile)){Y.translationsConfigFile=ve._translationsConfigFile;try{Y.translationsConfig=pe(Y.translationsConfigFile)}catch(Ne){if(ve._corruptedFile){var Ke=j.dirname(ve._corruptedFile);se.exists(Ke,function(Pe){Pe&&se.writeFile(ve._corruptedFile,"corrupted","utf8",function(pt){console.error(pt)})})}}}}catch(Ne){}ue.setPseudo(Y.locale==="pseudo"),F=Object.create(null)}a(Ve,"initializeSettings"),Ve();function qe(){return Y.languagePackSupport===!0&&Y.cacheRoot!==void 0&&Y.languagePackId!==void 0&&Y.translationsConfigFile!==void 0&&Y.translationsConfig!==void 0}a(qe,"supportsLanguagePack");function at(ve){return function(Ue,Xe){for(var Ke=[],Ne=2;Ne<arguments.length;Ne++)Ke[Ne-2]=arguments[Ne];if(H(Ue)){if(Ue>=ve.length){console.error(`Broken localize call found. Index out of bounds. Stacktrace is
: `+new Error("").stack);return}return ue.format(ve[Ue],Ke)}else{if(M(Xe))return console.warn("Message "+Xe+" didn't get externalized correctly."),ue.format(Xe,Ke);console.error(`Broken localize call found. Stacktrace is
: `+new Error("").stack)}}}a(at,"createScopedLocalizeFunction");function we(ve){var Ue;if(Y.cacheLanguageResolution&&Ue)Ue=Ue;else{if(ue.isPseudo||!Y.language)Ue=".nls.json";else for(var Xe=Y.language;Xe;){var Ke=".nls."+Xe+".json";if(se.existsSync(ve+Ke)){Ue=Ke;break}else{var Ne=Xe.lastIndexOf("-");Ne>0?Xe=Xe.substring(0,Ne):(Ue=".nls.json",Xe=null)}}Y.cacheLanguageResolution&&(Ue=Ue)}return ve+Ue}a(we,"resolveLanguage");function Ee(ve){for(var Ue=Y.language;Ue;){var Xe=j.join(ve,"nls.bundle."+Ue+".json");if(se.existsSync(Xe))return Xe;var Ke=Ue.lastIndexOf("-");Ke>0?Ue=Ue.substring(0,Ke):Ue=void 0}if(Ue===void 0){var Xe=j.join(ve,"nls.bundle.json");if(se.existsSync(Xe))return Xe}}a(Ee,"findInTheBoxBundle");function be(ve){try{se.mkdirSync(ve)}catch(Xe){if(Xe.code==="EEXIST")return;if(Xe.code==="ENOENT"){var Ue=j.dirname(ve);Ue!==ve&&(be(Ue),se.mkdirSync(ve))}else throw Xe}}a(be,"mkdir");function L(ve){var Ue=pe(j.join(ve,"nls.metadata.json")),Xe=Object.create(null);for(var Ke in Ue){var Ne=Ue[Ke];Xe[Ke]=Ne.messages}return Xe}a(L,"createDefaultNlsBundle");function he(ve,Ue){var Xe=Y.translationsConfig[ve.id];if(!!Xe){var Ke=pe(Xe).contents,Ne=pe(j.join(Ue,"nls.metadata.json")),Pe=Object.create(null);for(var pt in Ne){var It=Ne[pt],xe=Ke[ve.outDir+"/"+pt];if(xe){for(var Pt=[],ht=0;ht<It.keys.length;ht++){var Ot=It.keys[ht],Be=M(Ot)?Ot:Ot.key,Le=xe[Be];Le===void 0&&(Le=It.messages[ht]),Pt.push(Le)}Pe[pt]=Pt}else Pe[pt]=It.messages}return Pe}}a(he,"createNLSBundle");function te(ve){var Ue=new Date;se.utimes(ve,Ue,Ue,function(){})}a(te,"touch");function Te(ve,Ue){return F[ve]=Ue,Ue}a(Te,"cacheBundle");function le(ve,Ue){var Xe,Ke=j.join(Y.cacheRoot,ve.id+"-"+ve.hash+".json"),Ne=!1,Pe=!1;try{return Xe=JSON.parse(se.readFileSync(Ke,{encoding:"utf8",flag:"r"})),te(Ke),Xe}catch(pt){if(pt.code==="ENOENT")Pe=!0;else if(pt instanceof SyntaxError)console.log("Syntax error parsing message bundle: "+pt.message+"."),se.unlink(Ke,function(It){It&&console.error("Deleting corrupted bundle "+Ke+" failed.")}),Ne=!0;else throw pt}if(Xe=he(ve,Ue),!Xe||Ne)return Xe;if(Pe)try{se.writeFileSync(Ke,JSON.stringify(Xe),{encoding:"utf8",flag:"wx"})}catch(pt){if(pt.code==="EEXIST")return Xe;throw pt}return Xe}a(le,"loadNlsBundleOrCreateFromI18n");function de(ve){try{return L(ve)}catch(Ue){console.log("Generating default bundle from meta data failed.",Ue);return}}a(de,"loadDefaultNlsBundle");function Ce(ve,Ue){var Xe;if(qe())try{Xe=le(ve,Ue)}catch(Ne){console.log("Load or create bundle failed ",Ne)}if(!Xe){if(Y.languagePackSupport)return de(Ue);var Ke=Ee(Ue);if(Ke)try{return pe(Ke)}catch(Ne){console.log("Loading in the box message bundle failed.",Ne)}Xe=de(Ue)}return Xe}a(Ce,"loadNlsBundle");function Fe(ve){for(var Ue,Xe=j.dirname(ve);Ue=j.join(Xe,"nls.metadata.header.json"),!se.existsSync(Ue);){var Ke=j.dirname(Xe);if(Ke===Xe){Ue=void 0;break}else Xe=Ke}return Ue}a(Fe,"tryFindMetaDataHeaderFile");function We(ve){if(!ve)return ue.localize;var Ue=j.extname(ve);if(Ue&&(ve=ve.substr(0,ve.length-Ue.length)),Y.messageFormat===ue.MessageFormat.both||Y.messageFormat===ue.MessageFormat.bundle){var Xe=Fe(ve);if(Xe){var Ke=j.dirname(Xe),Ne=F[Ke];if(Ne===void 0)try{var Pe=JSON.parse(se.readFileSync(Xe,"utf8"));try{var pt=Ce(Pe,Ke);Ne=Te(Ke,pt?{header:Pe,nlsBundle:pt}:null)}catch(ht){console.error("Failed to load nls bundle",ht),Ne=Te(Ke,null)}}catch(ht){console.error("Failed to read header file",ht),Ne=Te(Ke,null)}if(Ne){var It=ve.substr(Ke.length+1).replace(/\\/g,"/"),xe=Ne.nlsBundle[It];return xe===void 0?(console.error("Messages for file "+ve+" not found. See console for details."),function(){return"Messages not found."}):at(xe)}}}if(Y.messageFormat===ue.MessageFormat.both||Y.messageFormat===ue.MessageFormat.file)try{var Pt=pe(we(ve));return Array.isArray(Pt)?at(Pt):ue.isDefined(Pt.messages)&&ue.isDefined(Pt.keys)?at(Pt.messages):(console.error("String bundle '"+ve+"' uses an unsupported format."),function(){return"File bundle has unsupported format. See console for details"})}catch(ht){ht.code!=="ENOENT"&&console.error("Failed to load single file bundle",ht)}return console.error("Failed to load message bundle for file "+ve),function(){return"Failed to load message bundle. See console for details."}}a(We,"loadMessageBundle"),B.loadMessageBundle=We;function et(ve){return ve&&(M(ve.locale)&&(Y.locale=ve.locale.toLowerCase(),Y.language=Y.locale,F=Object.create(null)),ve.messageFormat!==void 0&&(Y.messageFormat=ve.messageFormat),ve.bundleFormat===ue.BundleFormat.standalone&&Y.languagePackSupport===!0&&(Y.languagePackSupport=!1)),ue.setPseudo(Y.locale==="pseudo"),We}a(et,"config"),q=et,ne.default.install(Object.freeze({loadMessageBundle:We,config:et}))},6822:(m,B,K)=>{"use strict";m.exports=K(8472)},2479:m=>{m.exports=B;function B(K,q){if(K&&q)return B(K)(q);if(typeof K!="function")throw new TypeError("need wrapper function");return Object.keys(K).forEach(function(se){j[se]=K[se]}),j;function j(){for(var se=new Array(arguments.length),ne=0;ne<se.length;ne++)se[ne]=arguments[ne];var ue=K.apply(this,se),ce=se[se.length-1];return typeof ue=="function"&&ue!==ce&&Object.keys(ce).forEach(function(z){ue[z]=ce[z]}),ue}a(j,"wrapper")}a(B,"wrappy")},9166:m=>{"use strict";m.exports=require("applicationinsights-native-metrics")},9496:m=>{"use strict";m.exports=require("vscode")},9491:m=>{"use strict";m.exports=require("assert")},852:m=>{"use strict";m.exports=require("async_hooks")},2081:m=>{"use strict";m.exports=require("child_process")},6206:m=>{"use strict";m.exports=require("console")},2057:m=>{"use strict";m.exports=require("constants")},6113:m=>{"use strict";m.exports=require("crypto")},9523:m=>{"use strict";m.exports=require("dns")},2361:m=>{"use strict";m.exports=require("events")},7147:m=>{"use strict";m.exports=require("fs")},3685:m=>{"use strict";m.exports=require("http")},5687:m=>{"use strict";m.exports=require("https")},8188:m=>{"use strict";m.exports=require("module")},1808:m=>{"use strict";m.exports=require("net")},2037:m=>{"use strict";m.exports=require("os")},1017:m=>{"use strict";m.exports=require("path")},4074:m=>{"use strict";m.exports=require("perf_hooks")},2781:m=>{"use strict";m.exports=require("stream")},9512:m=>{"use strict";m.exports=require("timers")},7310:m=>{"use strict";m.exports=require("url")},3837:m=>{"use strict";m.exports=require("util")},9796:m=>{"use strict";m.exports=require("zlib")}},__webpack_module_cache__={};function __webpack_require__(m){var B=__webpack_module_cache__[m];if(B!==void 0)return B.exports;var K=__webpack_module_cache__[m]={id:m,loaded:!1,exports:{}};return __webpack_modules__[m].call(K.exports,K,K.exports,__webpack_require__),K.loaded=!0,K.exports}a(__webpack_require__,"__webpack_require__"),(()=>{__webpack_require__.n=m=>{var B=m&&m.__esModule?()=>m.default:()=>m;return __webpack_require__.d(B,{a:B}),B}})(),(()=>{var m=Object.getPrototypeOf?K=>Object.getPrototypeOf(K):K=>K.__proto__,B;__webpack_require__.t=function(K,q){if(q&1&&(K=this(K)),q&8||typeof K=="object"&&K&&(q&4&&K.__esModule||q&16&&typeof K.then=="function"))return K;var j=Object.create(null);__webpack_require__.r(j);var se={};B=B||[null,m({}),m([]),m(m)];for(var ne=q&2&&K;typeof ne=="object"&&!~B.indexOf(ne);ne=m(ne))Object.getOwnPropertyNames(ne).forEach(ue=>se[ue]=()=>K[ue]);return se.default=()=>K,__webpack_require__.d(j,se),j}})(),(()=>{__webpack_require__.d=(m,B)=>{for(var K in B)__webpack_require__.o(B,K)&&!__webpack_require__.o(m,K)&&Object.defineProperty(m,K,{enumerable:!0,get:B[K]})}})(),(()=>{__webpack_require__.o=(m,B)=>Object.prototype.hasOwnProperty.call(m,B)})(),(()=>{__webpack_require__.r=m=>{typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(m,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(m,"__esModule",{value:!0})}})(),(()=>{__webpack_require__.nmd=m=>(m.paths=[],m.children||(m.children=[]),m)})();var __webpack_exports__={};(()=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{StateKeys:()=>Ua,activate:()=>py,getOpenActionsService:()=>wu,getState:()=>Op,isInsiders:()=>Dp,updateState:()=>Jd});var m=__webpack_require__(9496),B=__webpack_require__(8472),K;(function(t){t.Off="off",t.Auto="auto",t.Always="always"})(K||(K={}));var q;(function(t){t.None="none",t.Latest="latest",t.Match="match",t.TipPlusLatest="tip+latest"})(q||(q={})),function(t){function e(r){return r===t.None||r===t.Latest||r===t.Match||r===t.TipPlusLatest?r:t.None}a(e,"sanitize"),t.sanitize=e}(q||(q={}));var j;(function(t){t.Browse="browse",t.Edit="edit"})(j||(j={})),function(t){function e(n){return n===t.Browse||n===t.Edit?n:t.Edit}a(e,"sanitize"),t.sanitize=e;function r(n){return n===t.Browse?t.Edit:t.Browse}a(r,"toggle"),t.toggle=r}(j||(j={}));var se;(function(t){function e(r,n){return r.display===n.display&&r.index===n.index}a(e,"equals"),t.equals=e})(se||(se={}));var ne;(function(t){t.Branch="branch",t.RemoteBranch="remoteBranch",t.PullRequestBranch="pullRequestBranch",t.PullRequestRemoteBranch="pullRequestRemoteBranch",t.Tag="tag",t.Commit="commit"})(ne||(ne={}));var ue;(function(t){const e=new Map([[ne.Branch,q.None],[ne.RemoteBranch,q.None],[ne.PullRequestBranch,q.Match],[ne.PullRequestRemoteBranch,q.Match],[ne.Commit,q.Match],[ne.Tag,q.Match]]),r=new Map([[ne.Branch,j.Edit],[ne.RemoteBranch,j.Edit],[ne.PullRequestBranch,j.Browse],[ne.PullRequestRemoteBranch,j.Browse],[ne.Commit,j.Browse],[ne.Tag,j.Browse]]);function n(o){var c,l;return{display:(c=r.get(o))!=null?c:j.Edit,index:(l=e.get(o))!=null?l:q.None}}a(n,"getDefault"),t.getDefault=n;function i(o){switch(o){case ne.Branch:case ne.RemoteBranch:return{display:j.Browse,index:q.Latest};case ne.PullRequestBranch:case ne.PullRequestRemoteBranch:return{display:j.Browse,index:q.Match};case ne.Commit:case ne.Tag:return{display:j.Browse,index:q.Match};default:return{display:j.Edit,index:q.None}}}a(i,"getIndexDefault"),t.getIndexDefault=i})(ue||(ue={}));const ce=null;var z=__webpack_require__(2307),H=__webpack_require__.n(z);const M="remoteHub",X="modes",pe="indexMemento";class F{constructor(){this._onDidChange=new m.EventEmitter,this._onDidChangeAny=new m.EventEmitter,this.memoryState=new Map}static configure(e){Y.state=e.workspaceState,e.subscriptions.push(m.workspace.onDidChangeConfiguration(Y.onConfigurationChanged,Y))}get onDidChange(){return this._onDidChange.event}get onDidChangeAny(){return this._onDidChangeAny.event}onConfigurationChanged(e){if(!e.affectsConfiguration(M)){this._onDidChangeAny.fire(e);return}this._onDidChangeAny.fire(e),this._onDidChange.fire(e)}set state(e){if(this._state=e,this.modes=this._state.get(X),this.modes===void 0&&(this.modes=Object.create(null)),this.memoryState.size!==0){for(const r of this.memoryState.entries())this.modes[r[0]]=r[1];this._state.update(X,this.modes).then(()=>{this.memoryState.clear()},void 0)}this.indexMemento=this._state.get(pe),this.indexMemento===void 0&&(this.indexMemento=Object.create(null))}get(e,r,n){return n===void 0?m.workspace.getConfiguration(e===void 0?void 0:M,r).get(e===void 0?M:e):m.workspace.getConfiguration(e===void 0?void 0:M,r).get(e===void 0?M:e,n)}getMode(e,r,n){var i;const o=e.toString();let c=this.modes!==void 0?this.modes[o]:void 0;if(c!==void 0)return{display:j.sanitize(c.display),index:q.sanitize(c.index)};if(c=this.memoryState.get(o),c!==void 0)return c;if(r===ne.Branch||r===ne.RemoteBranch)switch((i=m.workspace.getConfiguration("remoteHub.richNavigation.indexMode",e))==null?void 0:i.get("branch")){case"none":return{display:j.Edit,index:q.None};case"latest":return{display:j.Browse,index:q.Latest};case"tipPlusLatest":return{display:j.Edit,index:q.TipPlusLatest}}if(!n)return ue.getDefault(r)}setMode(e,r){const n=e.toString();return this._state===void 0||this.modes===void 0?(this.memoryState.set(n,r),Promise.resolve()):(this.modes[n]=r,this._state.update(X,this.modes))}getIndexMemento(e){if(this.indexMemento!==void 0)return this.indexMemento[e.toString()]}setIndexMemento(e,r){return this.indexMemento===void 0||this._state===void 0?Promise.resolve():(this.indexMemento[e.toString()]=r,this._state.update(pe,this.indexMemento))}getAny(e,r,n){return n===void 0?m.workspace.getConfiguration(void 0,r).get(e):m.workspace.getConfiguration(void 0,r).get(e,n)}changed(e,r,n){var i;return(i=e==null?void 0:e.affectsConfiguration(`${M}.${r}`,n))!=null?i:!0}inspect(e,r){return m.workspace.getConfiguration(e===void 0?void 0:M,r).inspect(e===void 0?M:e)}inspectAny(e,r){return m.workspace.getConfiguration(void 0,r).inspect(e)}async migrate(e,r,n){const i=Y.inspect(e);if(i===void 0)return!1;let o=!1;return i.globalValue!==void 0&&(await this.update(r,n.migrationFn!=null?n.migrationFn(i.globalValue):i.globalValue,m.ConfigurationTarget.Global),o=!0),i.workspaceValue!==void 0&&(await this.update(r,n.migrationFn!=null?n.migrationFn(i.workspaceValue):i.workspaceValue,m.ConfigurationTarget.Workspace),o=!0),i.workspaceFolderValue!==void 0&&(await this.update(r,n.migrationFn!=null?n.migrationFn(i.workspaceFolderValue):i.workspaceFolderValue,m.ConfigurationTarget.WorkspaceFolder),o=!0),!o&&n.fallbackValue!==void 0&&(await this.update(r,n.fallbackValue,m.ConfigurationTarget.Global),o=!0),o}async migrateIfMissing(e,r,n){const i=Y.inspect(e);if(i===void 0)return;const o=Y.inspect(r);i.globalValue!==void 0&&(o===void 0||o.globalValue===void 0)&&await this.update(r,n.migrationFn!=null?n.migrationFn(i.globalValue):i.globalValue,m.ConfigurationTarget.Global),i.workspaceValue!==void 0&&(o===void 0||o.workspaceValue===void 0)&&await this.update(r,n.migrationFn!=null?n.migrationFn(i.workspaceValue):i.workspaceValue,m.ConfigurationTarget.Workspace),i.workspaceFolderValue!==void 0&&(o===void 0||o.workspaceFolderValue===void 0)&&await this.update(r,n.migrationFn!=null?n.migrationFn(i.workspaceFolderValue):i.workspaceFolderValue,m.ConfigurationTarget.WorkspaceFolder)}name(e){return e}update(e,r,n){return m.workspace.getConfiguration(M).update(e,r,n)}updateAny(e,r,n,i){return m.workspace.getConfiguration(void 0,n===m.ConfigurationTarget.Global?void 0:i).update(e,r,n)}updateEffective(e,r){const n=Y.inspect(e);return n.workspaceFolderValue!==void 0?r===n.workspaceFolderValue?Promise.resolve(void 0):Y.update(e,r,m.ConfigurationTarget.WorkspaceFolder):n.workspaceValue!==void 0?r===n.workspaceValue?Promise.resolve(void 0):Y.update(e,r,m.ConfigurationTarget.Workspace):n.globalValue===r||n.globalValue===void 0&&r===n.defaultValue?Promise.resolve(void 0):Y.update(e,H()(r,n.defaultValue)?void 0:r,m.ConfigurationTarget.Global)}getUseNewCommitApi(){let e=this.get("experimental.useNewCommitApi");return e===null&&(e=Dp()),e}}a(F,"Configuration");const Y=new F,Ve="";var qe;(function(t){t.Off="off",t.Error="error",t.Warn="warn",t.Info="info",t.Debug="debug"})(qe||(qe={}));var at;(function(t){t[t.Off=0]="Off",t[t.Error=1]="Error",t[t.Warn=2]="Warn",t[t.Info=3]="Info",t[t.Debug=4]="Debug"})(at||(at={}));const we="GitHub Repositories",Ee="[RemoteHub]",be=a(class{static configure(t,e){this._isDebugging=t.extensionMode===m.ExtensionMode.Development,this.logLevel=e}static enabled(t){return this.level>=this.toOrderedLevel(t)}static get logLevel(){return this._logLevel}static set logLevel(t){var e,r;this._logLevel=t,this.level=this.toOrderedLevel(t),t===qe.Off?((e=this.output)==null||e.dispose(),this.output=void 0):this.output=(r=this.output)!=null?r:m.window.createOutputChannel(we)}static toOrderedLevel(t){switch(t){case qe.Off:return 0;case qe.Error:return 1;case qe.Warn:return 2;case qe.Info:return 3;case qe.Debug:return 4}}static get isDebugging(){return this._isDebugging}static debug(t,...e){be.isDebugging&&console.log(this.timestamp,Ee,t!=null?t:Ve,...e),!(this.output===void 0||this.level<4)&&this.output.appendLine(`${this.timestamp} ${t!=null?t:Ve}${this.toLoggableParams(!0,e)}`)}static error(t,e,...r){if(!(this.level<1&&!be.isDebugging)){if(e===void 0){const n=t instanceof Error?t.stack:void 0;if(n){const i=/.*\s*?at\s(.+?)\s/.exec(n);i!==null&&(e=i[1])}}be.isDebugging&&console.error(this.timestamp,Ee,e!=null?e:Ve,...r,t),!(this.output===void 0||this.level<1)&&this.output.appendLine(`${this.timestamp} ${e!=null?e:Ve}${this.toLoggableParams(!1,r)}
${String(t)}`)}}static log(t,...e){be.isDebugging&&console.log(this.timestamp,Ee,t!=null?t:Ve,...e),!(this.output===void 0||this.level<3)&&this.output.appendLine(`${this.timestamp} ${t!=null?t:Ve}${this.toLoggableParams(!1,e)}`)}static warn(t,...e){be.isDebugging&&console.warn(this.timestamp,Ee,t!=null?t:Ve,...e),!(this.output===void 0||this.level<2)&&this.output.appendLine(`${this.timestamp} ${t!=null?t:Ve}${this.toLoggableParams(!1,e)}`)}static showOutputChannel(){var t;(t=this.output)==null||t.show()}static toLoggable(t,e){if(typeof t!="object")return String(t);if(t instanceof m.Uri)return`Uri(${t.toString(!0)})`;try{return JSON.stringify(t,e)}catch{return"<error>"}}static toLoggableName(t){var e,r,n;let i;if(typeof t=="function"){if(t.prototype===void 0||t.prototype.constructor===void 0)return t.name;i=(e=t.prototype.constructor.name)!=null?e:Ve}else i=(n=(r=t.constructor)==null?void 0:r.name)!=null?n:Ve;const o=i.indexOf("_");return o===-1?i:i.substr(o+1)}static get timestamp(){const t=new Date;return`[${t.toISOString().replace(/T/," ").replace(/\..+/,Ve)}:${`00${t.getUTCMilliseconds()}`.slice(-3)}]`}static toLoggableParams(t,e){if(e.length===0||t&&this.level<4&&!be.isDebugging)return Ve;const r=e.map(n=>this.toLoggable(n)).join(", ");return r.length!==0?` \u2014 ${r}`:Ve}},"_Logger");let L=be;L.level=0,L._logLevel=qe.Off;const he=47;function te(t){if(t===void 0)return;const e=t.path.endsWith("/");return!e&&!t.fragment?t.toString():t.with({path:e?t.path.slice(0,-1):t.path,fragment:""}).toString()}a(te,"asKey");function Te(t){if(t===void 0)return;const e=t.path.endsWith("/");return!e&&!t.query&&!t.fragment?t.toString():t.with({path:e?t.path.slice(0,-1):t.path,query:"",fragment:""}).toString()}a(Te,"asFileKey");function le(t,e){return`${(e==null?void 0:e.excludeScheme)?"":`${t.scheme}-`}${t.authority}${t.path.endsWith("/")?t.path.slice(0,-1):t.path}`}a(le,"asFileStorageKey");function de(t){const e=t.path;let r=0,n=-1,i=!0;for(let o=e.length-1;o>=0;--o)if(e.charCodeAt(o)===he){if(!i){r=o+1;break}}else n===-1&&(i=!1,n=o+1);return n===-1?"":e.slice(r,n)}a(de,"basename");function Ce(t){const e=t.path;if(e.length===1)return"/";let r,n=-1,i=!0;for(let o=e.length-1;o>=1;--o)if(r=e.charCodeAt(o),r===he){if(!i){n=o;break}}else i=!1;return n===-1?"/":e.slice(0,n)}a(Ce,"dirname");function Fe(t){const e=t.path.lastIndexOf("/");return e===-1?t.with({path:"/"}):t.with({path:t.path.substring(0,e)})}a(Fe,"getParent");function We(t,e){const r=typeof e=="string"?e:e.path;return r.startsWith(t.path)?m.Uri.joinPath(t,r.substr(t.path.length)):m.Uri.joinPath(t,r)}a(We,"joinRelativePath");function et(t,e){return typeof e=="string"?(e.startsWith("/")||(e=`/${e}`),ve(t,e)&&t.path.substr(e.length+(e.endsWith("/")?0:1)).split("/").length===1):ve(t,e)&&t.path.substr(e.path.length+(e.path.endsWith("/")?0:1)).split("/").length===1}a(et,"isChild");function ve(t,e){return typeof e=="string"?(e.startsWith("/")||(e=`/${e}`),e.length===1||t.path.startsWith(e.endsWith("/")?e:`${e}/`)):e.scheme===t.scheme&&e.authority===t.authority&&(e.path.length===1||t.path.startsWith(e.path.endsWith("/")?e.path:`${e.path}/`))}a(ve,"isDescendent");function Ue(t){return t&&typeof t=="object"&&"scheme"in t}a(Ue,"isSerializedUri");const Xe=a(class{constructor(t){this.storageService=t,this._onDidChange=new m.EventEmitter,this.cache=new Map}get onDidChange(){return this._onDidChange.event}async delete(t){const e=te(t),r=this.cache.has(e);this.cache.delete(e);try{await this.storageService.delete(this.getStorageKey(e))}catch(n){throw L.error(n,`Failed to delete repository metadata for ${e}`),n}!r||setTimeout(()=>this._onDidChange.fire({uri:t}),0)}async get(t){this.assertMatchingScheme(t);const e=te(t),r=this.cache.get(e);if(r!==void 0)return r;let n;try{n=this.fromStorage(await this.storageService.get(this.getStorageKey(e)))}catch(i){throw L.error(i,`Failed to get repository metadata for ${e}`),i}return n?this.cache.set(e,{revision:n}):this.cache.delete(e),{revision:n}}async set(t,e,r,n){this.assertMatchingScheme(t);const i=(await this.get(t)).revision!==e?"revision":void 0,o=te(t);if(r!==void 0&&!this.validate(r))throw new Error(`Metadata validation failed for ${t.toString()}`);const c={revision:e,cachedMetadata:r};this.cache.set(o,c);try{await this.storageService.store(this.getStorageKey(o),this.toStorage(e))}catch(l){throw this.cache.delete(o),L.error(l,`Failed to save repository metadata for ${o}`),l}(n==null?void 0:n.silent)||setTimeout(()=>this._onDidChange.fire({uri:t,reason:i}),0)}refresh(){this.cache.clear()}validate(t){var e,r,n,i,o,c,l,d;return typeof t.version=="number"&&t.version>=Xe.schemaVersion&&typeof t.timestamp=="number"&&typeof((e=t.provider)==null?void 0:e.id)=="string"&&typeof t.provider.name=="string"&&typeof t.name=="string"&&t.repo&&typeof t.user=="string"&&typeof t.accessLevel=="number"&&typeof((r=t.HEAD)==null?void 0:r.type)=="number"&&typeof((n=t.HEAD)==null?void 0:n.name)=="string"&&typeof((i=t.HEAD)==null?void 0:i.sha)=="string"&&(typeof((o=t.HEAD.detached)==null?void 0:o.name)=="string"&&typeof((c=t.HEAD.detached)==null?void 0:c.type)=="number"||typeof((l=t.HEAD.branch)==null?void 0:l.name)=="string")&&typeof((d=t.defaultBranch)==null?void 0:d.name)=="string"&&typeof t.defaultBranch.sha=="string"}assertMatchingScheme(t){if(t.scheme!==Qt.scheme)throw new Error(`Uri scheme '${t.scheme}' must match configured scheme '${Qt.scheme}'; uri=${t.toString()}`)}getStorageKey(t){return`metadata/${t}`}fromStorage(t){if(!t)return;const e=JSON.parse(t,(r,n)=>(r==="uri"||r.endsWith("Uri"))&&Ue(n)?m.Uri.from(n):n);return e==null?void 0:e.revision}toStorage(t){const e={schemaVersion:Xe.storageSchemaVersion,revision:t};return JSON.stringify(e)}},"_MetadataStore");let Ke=Xe;Ke.schemaVersion=6,Ke.storageSchemaVersion=1;var Ne;(function(t){t[t.Admin=100]="Admin",t[t.Maintain=40]="Maintain",t[t.WriteToPullRequest=31]="WriteToPullRequest",t[t.Write=30]="Write",t[t.Triage=20]="Triage",t[t.Read=10]="Read",t[t.None=0]="None"})(Ne||(Ne={}));var Pe;(function(t){t[t.Branch=0]="Branch",t[t.RemoteBranch=1]="RemoteBranch",t[t.Tag=2]="Tag",t[t.Commit=3]="Commit"})(Pe||(Pe={}));class pt extends Error{constructor(e,r){super(typeof e=="string"?e:e.message);this.reauthenticate=r;var n;this.original=typeof e!="string"?e:void 0,(n=Error.captureStackTrace)==null||n.call(Error,this,pt)}}a(pt,"InvalidCredentialsError");class It extends Error{constructor(e,r,n){super(e.message);this.original=e,this.name=r,this.id=n;var i;(i=Error.captureStackTrace)==null||i.call(Error,this,It)}}a(It,"PullRequestNotFoundError");class xe extends Error{constructor(e,r){super(e.message);this.original=e,this.name=r;var n;(n=Error.captureStackTrace)==null||n.call(Error,this,xe)}}a(xe,"RepositoryForbiddenError");class Pt extends Error{constructor(e,r){super(e.message);this.original=e,this.name=r;var n;(n=Error.captureStackTrace)==null||n.call(Error,this,Pt)}}a(Pt,"RepositoryNotFoundError");class ht extends Error{constructor(e,r){super(e.message);this.original=e,this.name=r;var n;(n=Error.captureStackTrace)==null||n.call(Error,this,ht)}}a(ht,"RepositoryEmptyError");class Ot extends Error{constructor(e){super(e);var r;(r=Error.captureStackTrace)==null||r.call(Error,this,Ot)}}a(Ot,"DetachedHEADError");class Be extends Error{constructor(e,r){super(e.message);this.original=e,this.duplicate=r;var n;(n=Error.captureStackTrace)==null||n.call(Error,this,Be)}}a(Be,"InvalidBranchNameError");class Le extends Error{constructor(e){super(e.message);this.original=e;var r;(r=Error.captureStackTrace)==null||r.call(Error,this,Le)}}a(Le,"MergeConflictError");class _t extends Error{constructor(e){super(e);var r;(r=Error.captureStackTrace)==null||r.call(Error,this,_t)}}a(_t,"NothingToCommitError");class xt extends Error{constructor(e=!1){super(e?"Unable to sync the repository":"Unable to fetch the repository");var r;(r=Error.captureStackTrace)==null||r.call(Error,this,xt)}}a(xt,"SyncOrFetchError");class qt extends Error{constructor(){super("Sync operation will result in conflicts");var e;(e=Error.captureStackTrace)==null||e.call(Error,this,qt)}}a(qt,"SyncConflictsError");class vr extends Error{constructor(){super("Failed to create and push commit");var e;(e=Error.captureStackTrace)==null||e.call(Error,this,vr)}}a(vr,"CommitFailedError");class Gt extends Error{constructor(e){var r;const n=typeof e=="string"?e:Qt.getProviderId(e);super(`No provider registered with ${n}`);this.id=n,(r=Error.captureStackTrace)==null||r.call(Error,this,Gt)}}a(Gt,"ProviderNotFoundError");const lr=/^[0-9a-f]{40}$/i;function Nr(t){return t!==void 0&&lr.test(t)}a(Nr,"isSha");const rn=/^[^/](?!.*\/\.)(?!.*\.\.)(?!.*\/\/)(?!.*@\{)[^\000-\037\177 ~^:?*[\\]+[^./]$/;function Ir(t){return rn.test(t)}a(Ir,"isValidBranchName");function wt(t){return t===""||t==="~"||t==="HEAD"?t:t.endsWith("^")?`${t.substr(0,7)}^`:t.substr(0,7)}a(wt,"shortenRef");var tt;(function(t){t[t.Branch=0]="Branch",t[t.Tag=1]="Tag",t[t.Commit=2]="Commit",t[t.PullRequest=3]="PullRequest",t[t.Tree=4]="Tree"})(tt||(tt={}));class Mi{constructor(e,r,n,i,o){this.providerService=e,this.uri=r,this.id=n,this.name=i,this.provider={id:o.id,name:o.name}}get canonicalUri(){return this.providerService.getVirtualCanonicalRootUri(this.uri)}createRelativeUri(e){return this.providerService.createRelativeUri(this.uri,e)}async getMetadata(){const e=await this.providerService.getMetadata(this.uri);if(!e)throw new Error(`Unable to find metadata for ${this.uri.toString()}`);return e}async getIndexMetadata(){return this.providerService.getIndexMetadata(this.uri)}getUriMetadata(){return this.providerService.getVirtualUriMetadata(this.uri)}}a(Mi,"VirtualRepository");var nt;(function(t){t[t.Repository=0]="Repository",t[t.PullRequest=1]="PullRequest",t[t.Branch=2]="Branch",t[t.Commit=3]="Commit",t[t.File=4]="File",t[t.Tag=5]="Tag"})(nt||(nt={}));var Lt;(function(t){t[t.Clone=-1]="Clone",t[t.Repository=0]="Repository",t[t.PullRequest=1]="PullRequest",t[t.Branch=2]="Branch",t[t.Commit=3]="Commit",t[t.Tag=4]="Tag"})(Lt||(Lt={}));var it;(function(t){t[t.Open=0]="Open",t[t.Closed=1]="Closed",t[t.Merged=2]="Merged"})(it||(it={}));var ft;(function(t){t[t.NotIndexed=0]="NotIndexed",t[t.Indexed=1]="Indexed",t[t.Match=2]="Match",t[t.Active=3]="Active"})(ft||(ft={})),function(t){function e(r){return r!==void 0&&(r===t.Indexed||r===t.Match||r===t.Active)}a(e,"hasIndex"),t.hasIndex=e}(ft||(ft={}));var Zt;(function(t){function e(r){return r!==void 0&&r.type===3}a(e,"isActive"),t.isActive=e})(Zt||(Zt={}));var er;(function(t){t[t.Latest=1]="Latest",t[t.SHA=2]="SHA"})(er||(er={}));var Jt;(function(t){function e(r){const n=Qt.decodeAuthority(r).metadata;if(!(n===void 0||n.idx===void 0)){if(n.idx==="latest")return{type:1};if(Nr(n.idx))return{type:2,sha:n.idx}}}a(e,"decode"),t.decode=e})(Jt||(Jt={}));function*wn(t,e){for(const r of t)yield*e(r)}a(wn,"flatMap");function*pi(t,e){for(const r of t)e(r)&&(yield r)}a(pi,"filter");function*nn(t,e){for(const r of t){const n=e(r);n!=null&&(yield n)}}a(nn,"filterMap");function ja(t,e){for(const r of t)if(e(r))return r}a(ja,"find");function qa(t,e){let r="";const n=t[Symbol.iterator]();let i=n.next();if(i.done)return r;for(;;){const o=i.value.toString();if(i=n.next(),i.done){r+=o;break}r+=o,r+=e}return r}a(qa,"join");function*eo(t,e){for(const r of t)yield e(r)}a(eo,"map");function ir(t,e){for(const r of t)if(e(r))return!0;return!1}a(ir,"some");function*Li(...t){for(const e of t)for(const r of e)yield r}a(Li,"union");function*ia(t){const e=new Set;for(const r of t)e.has(r)||(e.add(r),yield r)}a(ia,"unique");const oa="";function Qs(...t){if(t.length===1){const e=t[0];return e===void 0?oa:typeof e=="string"?e:typeof e=="number"||typeof e=="boolean"||e instanceof Error?String(e):e instanceof m.Uri?e.toString():JSON.stringify(e)}return JSON.stringify(t)}a(Qs,"defaultResolver");function Mr(t){return(e,r,n)=>{let i;if(typeof n.value=="function"?i=n.value:typeof n.get=="function"&&(i=n.get),i===void 0)throw new Error("Not supported");const o=`$serialize$${r}`;n.value=function(...c){const l=c.length===0?o:`${o}$${(t!=null?t:Qs)(...c)}`;Object.prototype.hasOwnProperty.call(this,l)||Object.defineProperty(this,l,{configurable:!1,enumerable:!1,writable:!0,value:void 0});let d=this[l];const h=a(()=>i.apply(this,c),"run");return d===void 0?d=h():d=d.then(h,h),this[l]=d,d}}}a(Mr,"serialize");const gi=require("process");let So=0;function za(){return So===Number.MAX_SAFE_INTEGER&&(So=0),++So}a(za,"getNextInstanceId");const Tn=a(class{constructor(t,e,...r){this.context=t,this.instance=`[${za().toString().padStart(5)}] `;var n,i,o,c,l,d;let h;if(typeof(e==null?void 0:e.log)=="boolean"?h=e.log?{}:void 0:h=(n=e==null?void 0:e.log)!=null?n:{},this.logLevel=(i=e==null?void 0:e.logLevel)!=null?i:qe.Info,this.time=(0,gi.hrtime)(),h){if(!L.enabled(this.logLevel))return;r.length?$i(this.logLevel,`${this.instance}${(o=h.prefix)!=null?o:""}${t}${(c=h.message)!=null?c:""}`,...r):$i(this.logLevel,`${this.instance}${(l=h.prefix)!=null?l:""}${t}${(d=h.message)!=null?d:""}`)}}log(t){this.logCore(this.context,t,!1)}logStep(t,e){(!t||e)&&this.logCore(this.context,e,!1),this.step=t?{time:(0,gi.hrtime)(),label:t}:void 0}restart(t){this.logCore(this.context,t,!0),this.step=void 0,this.time=(0,gi.hrtime)()}stop(t){this.restart(t)}logCore(t,e,r){var n,i,o,c,l,d,h;if(!L.enabled(this.logLevel))return;let S="";if(this.step){const[$,N]=(0,gi.hrtime)(this.step.time),U=$*1e3+Math.floor(N/1e6);S=`${this.step.label?`${this.step.label} took `:""}${U} ms`}if(!r){$i(this.logLevel,`${this.instance}${(n=e==null?void 0:e.prefix)!=null?n:""}${t}${(i=e==null?void 0:e.message)!=null?i:""}${S?` ${S}`:""}${(o=e==null?void 0:e.suffix)!=null?o:""}`);return}const[O,I]=(0,gi.hrtime)(this.time),P=O*1e3+Math.floor(I/1e6);$i(P>500?qe.Warn:this.logLevel,`${this.instance}${(c=e==null?void 0:e.prefix)!=null?c:""}${t}${(l=e==null?void 0:e.message)!=null?l:""}${(d=e==null?void 0:e.took)!=null?d:" took "}${P} ms${S?` (${S})`:""}${(h=e==null?void 0:e.suffix)!=null?h:""}`)}static start(t,e,...r){var n;(n=Tn.watches.get(t))==null||n.log(),Tn.watches.set(t,new Tn(t,e,...r))}static log(t,e){var r;(r=Tn.watches.get(t))==null||r.log(e)}static stop(t,e){var r;(r=Tn.watches.get(t))==null||r.stop(e),Tn.watches.delete(t)}},"_Stopwatch");let ut=Tn;ut.watches=new Map;function $i(t,e,...r){switch(t){case qe.Warn:L.warn(e,...r);break;case qe.Info:L.log(e,...r);break;default:L.debug(e,...r);break}}a($i,"log");function to(t){return Buffer.from(t,"utf8").toString("hex")}a(to,"encodeUtf8Hex");function Eo(t){return Buffer.from(t,"hex").toString("utf8")}a(Eo,"decodeUtf8Hex");var Fi=__webpack_require__(6724),Ys=Object.defineProperty,Zs=Object.getOwnPropertyDescriptor,Js=a((t,e,r,n)=>{for(var i=n>1?void 0:n?Zs(e,r):e,o=t.length-1,c;o>=0;o--)(c=t[o])&&(i=(n?c(e,r,i):c(i))||i);return n&&i&&Ys(e,r,i),i},"__decorateClass"),on;(function(t){t[t.Abort=0]="Abort",t[t.KeepCurrent=1]="KeepCurrent",t[t.DiscardCurrent=2]="DiscardCurrent",t[t.Merge=3]="Merge"})(on||(on={}));const ur=a(class{constructor(t,e){this.metadataStore=t,this.telemetryService=e,this._providers=new Map,this._onDidChangeProviders=new m.EventEmitter,this._repositories=new Map,this._onDidChangeRepositories=new m.EventEmitter,this._onDidChangeRepository=new m.EventEmitter,this._onDidSyncRepository=new m.EventEmitter,this._onDidRefresh=new m.EventEmitter,this._onWillRefresh=new m.EventEmitter,this.pendingMetadataRequests=new Map,this.disposable=m.Disposable.from(m.workspace.onDidChangeWorkspaceFolders(this.onWorkspaceFoldersChanged,this),t.onDidChange(r=>this.onMetadataChanged(r)))}get onDidChangeProviders(){return this._onDidChangeProviders.event}get onDidChangeRepositories(){return this._onDidChangeRepositories.event}get onDidChangeRepository(){return this._onDidChangeRepository.event}get onDidSyncRepository(){return this._onDidSyncRepository.event}get onDidRefresh(){return this._onDidRefresh.event}get onWillRefresh(){return this._onWillRefresh.event}dispose(){this.disposable.dispose(),this._providers.clear(),this._repositories.clear()}onMetadataChanged(t){const e=this._repositories.get(te(t.uri));!e||(L.log(`VirtualProviderService.onMetadataChanged(${t.uri.toString()}, reason=${t.reason}): Firing onDidChangeRepository...`),this._onDidChangeRepository.fire({repository:e,reason:t.reason==="revision"?"HEAD":void 0}))}onWorkspaceFoldersChanged(t){if(t.added.length)for(const e of t.added){const r=te(e.uri);if(e.uri.scheme!==ur.scheme||this._repositories.has(r))continue;const n=this.getProvider(e.uri);if(!n)continue;this._repositories.set(r,null);const{repo:i,name:o}=this.getVirtualUriMetadata(e.uri),c=new Mi(this,e.uri,i,o,n);this._repositories.set(r,c),this._onDidChangeRepositories.fire({added:[c],removed:[]}),this.telemetryService.sendEvent("repository.opened",{provider:n.id,repositories:this._repositories.size.toString()})}if(t.removed.length)for(const e of t.removed){const r=te(e.uri);if(e.uri.scheme!==ur.scheme||!this._repositories.has(r))continue;const n=this._repositories.get(r);this._repositories.delete(r),n&&(this._onDidChangeRepositories.fire({added:[],removed:[n]}),this.telemetryService.sendEvent("repository.closed",{repositories:this._repositories.size.toString()}))}Si(Pn.HasVirtualFolders,this._repositories.size!==0),Si(Pn.VirtualFolderProviders,qa(ia(eo(this.getRepositories(),e=>e.provider.id)),","))}get hasProviders(){return this._providers.size!==0}get registeredProviders(){return[...eo(this._providers.values(),t=>({id:t.id,name:t.name}))]}get repositories(){return[...this.getRepositories()]}register(t,e,r,n,i){var o;if(this._providers.has(t))throw new Error(`Provider '${t}' has already been registered`);const c={id:t,name:e,provider:r,fs:n,index:i};return this._providers.set(t,c),this._onDidChangeProviders.fire({added:[c],removed:[]}),this.telemetryService.sendEvent("provider.registered",{provider:t}),this.onWorkspaceFoldersChanged({added:(o=m.workspace.workspaceFolders)!=null?o:[],removed:[]}),{dispose:()=>{this._providers.delete(t);const l=[];for(const[d,h]of[...this._repositories])(h==null?void 0:h.provider.id)===t&&(this._repositories.delete(d),l.push(h));this._onDidChangeRepositories.fire({added:[],removed:l}),this._onDidChangeProviders.fire({added:[],removed:[c]})}}}refresh(){if(this._providers.size===0)return;const t=[],e=[];for(const r of this._providers.values())t.push(...eo(this.getRepositories(r.id),n=>n.uri)),r.index!==void 0&&e.push(r.index);this._onWillRefresh.fire(t),this.metadataStore.refresh(),e.forEach(r=>r.refresh(t)),this._onDidRefresh.fire(t)}getRegisteredProvider(t){const e=this.getProvider(t);return e?{id:e.id,name:e.name}:void 0}getRepository(t,e){const r=m.workspace.getWorkspaceFolder(t);if(!r||r.uri.scheme!==ur.scheme)return;const n=this._repositories.get(te(r.uri));if(!(e!==void 0&&(n==null?void 0:n.provider.id)!==e))return n!=null?n:void 0}getRepositories(t){return pi(this._repositories.values(),e=>e!==null&&(!t||e.provider.id===t))}getOpenUris(t,e){const r=new Map,n=m.workspace.textDocuments;if(n.length===0)return r;for(const i of n)i.uri.scheme===t&&e.some(o=>ve(i.uri,o))&&r.set(te(i.uri),i.uri);return r}hasProvider(t,e){const r=typeof t=="string"?t:ur.getProviderId(t),n=this._providers.get(r);return e!==void 0&&(n==null?void 0:n.id)!==e?!1:n!==void 0}isReadonly(t){var e;return Boolean((e=this.getProvider(t))==null?void 0:e.provider.isReadonly)}getProvider(t){const e=typeof t=="string"?t:ur.getProviderId(t);return this._providers.get(e)}getRepositoryProvider(t){var e;const r=(e=this.getProvider(t))==null?void 0:e.provider;if(r)return r;throw new Gt(t)}getFileSystemProvider(t){var e;const r=(e=this.getProvider(t))==null?void 0:e.fs;if(r)return r;throw new Gt(t)}getRemoteWorkspaceSourceProviders(t){var e,r,n,i;return t?(i=(n=(e=this.getProvider(t))==null?void 0:(r=e.provider).getRemoteWorkspaceSourceProviders)==null?void 0:n.call(r))!=null?i:[]:[...wn(this._providers.values(),o=>{var c,l,d;return(d=(l=(c=o.provider).getRemoteWorkspaceSourceProviders)==null?void 0:l.call(c))!=null?d:[]})]}isInWorkspace(t){return this.getVirtualWorkspaceUri(t)!==void 0}getAuthentication(t){const e=this.getProvider(t);if(!e)throw new Gt(t);return e==null?void 0:e.provider.getAuthentication(t)}canOpenRemoteUrl(t,e){if(e){const r=this.getProvider(e),n=r==null?void 0:r.provider.canOpenRemoteUrl(t);return n!==void 0?{provider:r,urlType:n}:void 0}for(const r of this._providers.values()){const n=r.provider.canOpenRemoteUrl(t);if(n!==void 0)return{provider:r,urlType:n}}}async createWorkspaceForRemoteUrl(t,e,r=$t.CurrentWindow){var n;const i=this.canOpenRemoteUrl(t,e);return(n=i==null?void 0:i.provider)==null?void 0:n.provider.createWorkspaceForRemoteUrl(t,r)}createProviderUri(t,e,r){return this.getProviderUri(this.getRepositoryProvider(t).createVirtualUri(ur.baseVirtualWorkspaceUri,e,r))}createRelativeProviderUri(t,e){return this.getProviderUri(this.createRelativeUri(t,e))}createRelativeUri(t,e){const r=this.getProviderRootUri(t);let n=`${r.path}/`;n.endsWith("/")&&(n=n.slice(0,-1));const i=r.with({path:`${r.path}/${e.startsWith("/")?e.substr(1):e}`});return t.scheme===ur.scheme?this.getVirtualUri(i):i}createRelativeVirtualUri(t,e){return this.getVirtualUri(this.createRelativeUri(t,e))}createVirtualUri(t,e,r){return this.getRepositoryProvider(t).createVirtualUri(ur.baseVirtualWorkspaceUri,e,r)}async getBestRemoteUri(t,e){const{provider:r,repo:n,ref:i}=this.getVirtualUriMetadata(t);if(e===Lt.Repository)return this.getRemoteUri(r.id,{repo:n});if(e===Lt.Clone)return this.getRemoteUri(r.id,{repo:n,clone:!0});if(e===Lt.PullRequest||e===void 0&&(i==null?void 0:i.type)===tt.PullRequest){if((i==null?void 0:i.type)===tt.PullRequest)return this.getRemoteUri(r.id,{repo:n,pullRequest:{id:i.id}});const{pullRequest:o}=await this.getMetadata(t);if(e===Lt.PullRequest&&o)return this.getRemoteUri(r.id,{repo:n,pullRequest:{id:o.id}})}if(e===Lt.Branch||e===void 0&&(i==null?void 0:i.type)===tt.Branch){if((i==null?void 0:i.type)===tt.Branch)return this.getRemoteUri(r.id,{repo:n,branch:i.id});const{HEAD:o}=await this.getMetadata(t);if(o.type===Pe.Branch||o.type===Pe.RemoteBranch&&e===Lt.Branch)return this.getRemoteUri(r.id,{repo:n,branch:o.branch.name})}if(e===Lt.Tag||e===void 0&&(i==null?void 0:i.type)===tt.Tag){if((i==null?void 0:i.type)===tt.Tag)return this.getRemoteUri(r.id,{repo:n,tag:i.id});const{HEAD:o}=await this.getMetadata(t);if(o.type===Pe.Tag)return this.getRemoteUri(r.id,{repo:n,tag:o.detached.name})}if(e===Lt.Commit||e===void 0&&((i==null?void 0:i.type)===tt.Commit||(i==null?void 0:i.type)===tt.Tree&&Nr(i.id))){if((i==null?void 0:i.type)===tt.Commit||(i==null?void 0:i.type)===tt.Tree&&Nr(i.id))return this.getRemoteUri(r.id,{repo:n,sha:i.id});const{HEAD:o}=await this.getMetadata(t);if(e===Lt.Commit||o.type===Pe.Commit)return this.getRemoteUri(r.id,{repo:n,sha:o.sha})}if(e===void 0)return this.getRemoteUri(r.id,{repo:n})}getCanonicalUri(t){let{authority:e}=t;const r=e.indexOf(ur.authoritySeparator);return r!==-1&&(e=e.substr(0,r)),t.with({authority:e})}getRemoteUri(t,e){var r,n;return(n=(r=this.getRepositoryProvider(t)).getRemoteUri)==null?void 0:n.call(r,e)}getProviderUri(t){return t.scheme!==ur.scheme?t:t.with({scheme:ur.getProviderId(t)})}getProviderRootUri(t){return t=this.getProviderUri(t),this.getRepositoryProvider(t).getProviderRootUri(t)}getRelativeFilePath(t,e){return e=this.getProviderUri(e!=null?e:t),this.getRepositoryProvider(e).getRelativeFilePath(t,e)}getVirtualUriMetadata(t){return this.getRepositoryProvider(t).getVirtualUriMetadata(t)}getVirtualUri(t){return t.scheme===ur.scheme?t:t.with({scheme:ur.scheme})}getVirtualCanonicalRootUri(t){const e=this.getVirtualUri(this.getProviderRootUri(t));let{authority:r}=e;const n=r.indexOf(ur.authoritySeparator);return n!==-1&&(r=r.substr(0,n)),e.with({authority:r})}getVirtualRootUri(t){return this.getVirtualUri(this.getProviderRootUri(t))}getVirtualWorkspaceUri(t){var e;return(e=m.workspace.getWorkspaceFolder(this.getVirtualUri(t)))==null?void 0:e.uri}createIGitRepository(t,e,r,n){var i,o;return(o=(i=this.getRepositoryProvider(t)).createIGitRepository)==null?void 0:o.call(i,t,e,r,n)}async getCommitOperations(t,e,r){let n;return(r==null?void 0:r.staged)?(n=await e.getStagedChanges(t),n.length===0&&r.staged==="auto"&&(n=await e.getChanges(t))):n=await e.getChanges(t),n.map(o=>{const c=this.getRelativeFilePath(t,o.uri);switch(o.type){case Dt.Created:return{type:o.type,path:c,fileType:o.fileType,content:e.readFile(o.uri).then(l=>l!=null?l:new Uint8Array)};case Dt.Changed:return{type:o.type,path:c,fileType:o.fileType,content:e.readFile(o.uri).then(l=>l!=null?l:new Uint8Array)};case Dt.Deleted:return{type:o.type,path:c,fileType:o.fileType,content:void 0}}})}async getMetadata(t){return{...await this.getMetadataCore(this.getVirtualRootUri(t)),path:this.getRelativeFilePath(t,t)}}async getIndexMetadata(t){const e=this.getProvider(t);return(e==null?void 0:e.index)?e.index.getIndexMetadata(t):void 0}getModeConfig(t,e,r){return Y.getMode(this.getVirtualRootUri(t),e,Boolean(r))}async getModeRefType(t,e){return t=this.getVirtualRootUri(t),this.getRepositoryProvider(t).getModeRefType(t,e)}getIndexProvider(t){var e;return(e=this.getProvider(t))==null?void 0:e.index}async getMetadataCore(t){const e=te(t);let r=this.pendingMetadataRequests.get(e);if(r)return r;let{revision:n,cachedMetadata:i}=await this.metadataStore.get(t);if(i!==void 0)return i;const o=this.getProvider(t);if(!o)throw new Gt(t);const c=Jt.decode(t);(c==null?void 0:c.type)===er.SHA&&(n=c.sha),r=o.provider.createMetadata(t,n),this.pendingMetadataRequests.set(e,r);try{const l=await r;return await this.updateMetadataCore(t,l,{silent:!0}),l}finally{this.pendingMetadataRequests.delete(e)}}async updateMetadata(t,e){const r=new ut(`VirtualProviderService.updateMetadata(${t.toString()})`,{},e.HEAD.sha);try{await this.metadataStore.set(this.getVirtualUri(t),e.HEAD.sha,e)}finally{r.stop()}}updateMetadataCore(t,e,r){return this.metadataStore.set(this.getVirtualUri(t),e.HEAD.sha,e,r)}async clone(t){const e=await this.getBestRemoteUri(t,Lt.Clone);if(!e)throw new Error("No url found for clone");if($n)return void m.env.openExternal(m.Uri.parse(`${m.env.uriScheme}://vscode.git/clone?url=${encodeURIComponent(e.toString(!0))}`));const r=a(async n=>{try{await n.activate(),await m.commands.executeCommand("git.clone",e.toString(!0))}catch(i){L.error(i,"Unable to clone repository")}},"cloneRepository");if(m.workspace.isTrusted){const n=m.extensions.getExtension("vscode.git");if(n)await r(n);else throw new Error("Git extension not found")}else{const n=m.extensions.onDidChange(async()=>{const o=m.extensions.getExtension("vscode.git");o&&(await r(o),n.dispose())});await m.workspace.requestWorkspaceTrust()||n.dispose()}}createBranch(t,e,r,n){return this.getRepositoryProvider(t).createBranch(t,e,r,n)}createCommit(t,e,r,n){return this.getRepositoryProvider(t).createCommit(t,e,r,n)}createAndPushCommit(t,e,r,n,i){return this.getRepositoryProvider(t).createAndPushCommit(t,e,r,n,i)}createPullRequest(t,e,r,n,i){return this.getRepositoryProvider(t).createPullRequest(t,e,r,n,i)}fetch(t,e){return this.getRepositoryProvider(t).fetch(t,e)}fork(t){return this.getRepositoryProvider(t).fork(t)}getBranches(t,e){return this.getRepositoryProvider(t).getBranches(t,e)}getCommit(t,e){return this.getRepositoryProvider(t).getCommit(t,e)}getCommits(t,e){var r;return(r=this.getRepositoryProvider(t))==null?void 0:r.getCommits(t,e)}compareCommits(t,e){var r;return(r=this.getRepositoryProvider(t))==null?void 0:r.compareCommits(t,e)}getFileContent(t,e,r){return this.getRepositoryProvider(t).getFileContent(t,e,r)}getFork(t){return this.getRepositoryProvider(t).getFork(t)}async getIncomingChanges(t){var e,r,n;return(n=(r=(e=this.getRepositoryProvider(t)).getIncomingChanges)==null?void 0:r.call(e,t))!=null?n:[]}getPullRequest(t,e){return this.getRepositoryProvider(t).getPullRequest(t,e)}getTags(t,e){return this.getRepositoryProvider(t).getTags(t,e)}getSnapshots(t,e){var r,n;return(n=(r=this.getIndexProvider(t))==null?void 0:r.getSnapshots(t,e))!=null?n:Promise.resolve([])}async getTarGz(t){var e,r;return(r=(e=this.getRepositoryProvider(t)).getTarGz)==null?void 0:r.call(e,t)}pushCommit(t,e,r,n){return this.getRepositoryProvider(t).pushCommit(t,e,r,n)}switchTo(t,e,r){return this.getRepositoryProvider(t).switchTo(t,e,r)}async sync(t,e,r){const n=this._repositories.get(te(t));n&&this._onDidSyncRepository.fire({repository:n,syncing:!0});try{const i=this.getProvider(t);if(i===void 0)throw new Gt(t);let{to:o,reason:c,...l}=r!=null?r:{};return o===void 0&&i.index&&(o=await i.index.resolveIndexRef(t,c==="user")),await i.provider.sync(t,e,{conflictResolution:0,...l,to:o})}finally{n&&this._onDidSyncRepository.fire({repository:n,syncing:!1})}}stat(t){return this.getFileSystemProvider(t).stat(t)}readDirectory(t){return this.getFileSystemProvider(t).readDirectory(t)}readFile(t){return this.getFileSystemProvider(t).readFile(t)}watch(t,e){return this.getFileSystemProvider(t).watch(t,e)}provideFileSearchResults(t,e,r){return this.getFileSystemProvider(e.folder).provideFileSearchResults(t,e,r)}provideTextSearchResults(t,e,r,n){return this.getFileSystemProvider(e.folder).provideTextSearchResults(t,e,r,n)}static decodeAuthority(t,e){const[r,n]=t.authority.split(ur.authoritySeparator);let i;if(n)try{const o=JSON.parse(Eo(n));i=e?e(o):o}catch{}return{scheme:r,metadata:i}}static encodeAuthority(t,e){const r=e?`${ur.authoritySeparator}${to(JSON.stringify(e))}`:"";return`${t}${r}`}static getProviderId(t){const{authority:e}=t,r=e.indexOf(ur.authoritySeparator);return r!==-1?e.substr(0,r):e}static isCanonicalUri(t){return t.authority.indexOf(ur.authoritySeparator)===-1}},"_VirtualProviderService");let Qt=ur;Qt.scheme="vscode-vfs",Qt.authoritySeparator="+",Qt.baseVirtualWorkspaceUri=m.Uri.parse(`${ur.scheme}://`),Js([Mr()],Qt.prototype,"getMetadataCore",1);function bn(){}a(bn,"Diff"),bn.prototype={diff:a(function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=n.callback;typeof n=="function"&&(i=n,n={}),this.options=n;var o=this;function c(N){return i?(setTimeout(function(){i(void 0,N)},0),!0):N}a(c,"done"),e=this.castInput(e),r=this.castInput(r),e=this.removeEmpty(this.tokenize(e)),r=this.removeEmpty(this.tokenize(r));var l=r.length,d=e.length,h=1,S=l+d,O=[{newPos:-1,components:[]}],I=this.extractCommon(O[0],r,e,0);if(O[0].newPos+1>=l&&I+1>=d)return c([{value:this.join(r),count:r.length}]);function P(){for(var N=-1*h;N<=h;N+=2){var U=void 0,W=O[N-1],V=O[N+1],ie=(V?V.newPos:0)-N;W&&(O[N-1]=void 0);var oe=W&&W.newPos+1<l,ge=V&&0<=ie&&ie<d;if(!oe&&!ge){O[N]=void 0;continue}if(!oe||ge&&W.newPos<V.newPos?(U=Wa(V),o.pushComponent(U.components,void 0,!0)):(U=W,U.newPos++,o.pushComponent(U.components,!0,void 0)),ie=o.extractCommon(U,r,e,N),U.newPos+1>=l&&ie+1>=d)return c(mi(o,U.components,r,e,o.useLongestToken));O[N]=U}h++}if(a(P,"execEditLength"),i)a(function N(){setTimeout(function(){if(h>S)return i();P()||N()},0)},"exec")();else for(;h<=S;){var $=P();if($)return $}},"diff"),pushComponent:a(function(e,r,n){var i=e[e.length-1];i&&i.added===r&&i.removed===n?e[e.length-1]={count:i.count+1,added:r,removed:n}:e.push({count:1,added:r,removed:n})},"pushComponent"),extractCommon:a(function(e,r,n,i){for(var o=r.length,c=n.length,l=e.newPos,d=l-i,h=0;l+1<o&&d+1<c&&this.equals(r[l+1],n[d+1]);)l++,d++,h++;return h&&e.components.push({count:h}),e.newPos=l,d},"extractCommon"),equals:a(function(e,r){return this.options.comparator?this.options.comparator(e,r):e===r||this.options.ignoreCase&&e.toLowerCase()===r.toLowerCase()},"equals"),removeEmpty:a(function(e){for(var r=[],n=0;n<e.length;n++)e[n]&&r.push(e[n]);return r},"removeEmpty"),castInput:a(function(e){return e},"castInput"),tokenize:a(function(e){return e.split("")},"tokenize"),join:a(function(e){return e.join("")},"join")};function mi(t,e,r,n,i){for(var o=0,c=e.length,l=0,d=0;o<c;o++){var h=e[o];if(h.removed){if(h.value=t.join(n.slice(d,d+h.count)),d+=h.count,o&&e[o-1].added){var O=e[o-1];e[o-1]=e[o],e[o]=O}}else{if(!h.added&&i){var S=r.slice(l,l+h.count);S=S.map(function(P,$){var N=n[d+$];return N.length>P.length?N:P}),h.value=t.join(S)}else h.value=t.join(r.slice(l,l+h.count));l+=h.count,h.added||(d+=h.count)}}var I=e[c-1];return c>1&&typeof I.value=="string"&&(I.added||I.removed)&&t.equals("",I.value)&&(e[c-2].value+=I.value,e.pop()),e}a(mi,"buildValues");function Wa(t){return{newPos:t.newPos,components:t.components.slice(0)}}a(Wa,"clonePath");var ec=new bn;function hl(t,e,r){return ec.diff(t,e,r)}a(hl,"diffChars");function Ga(t,e){if(typeof t=="function")e.callback=t;else if(t)for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}a(Ga,"generateOptions");var Va=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,An=/\S/,ro=new bn;ro.equals=function(t,e){return this.options.ignoreCase&&(t=t.toLowerCase(),e=e.toLowerCase()),t===e||this.options.ignoreWhitespace&&!An.test(t)&&!An.test(e)},ro.tokenize=function(t){for(var e=t.split(/([^\S\r\n]+|[()[\]{}'"\r\n]|\b)/),r=0;r<e.length-1;r++)!e[r+1]&&e[r+2]&&Va.test(e[r])&&Va.test(e[r+2])&&(e[r]+=e[r+2],e.splice(r+1,2),r--);return e};function fl(t,e,r){return r=Ga(r,{ignoreWhitespace:!0}),ro.diff(t,e,r)}a(fl,"diffWords");function pl(t,e,r){return ro.diff(t,e,r)}a(pl,"diffWordsWithSpace");var xo=new bn;xo.tokenize=function(t){var e=[],r=t.split(/(\n|\r\n)/);r[r.length-1]||r.pop();for(var n=0;n<r.length;n++){var i=r[n];n%2&&!this.options.newlineIsToken?e[e.length-1]+=i:(this.options.ignoreWhitespace&&(i=i.trim()),e.push(i))}return e};function Ka(t,e,r){return xo.diff(t,e,r)}a(Ka,"diffLines");function vi(t,e,r){var n=Ga(r,{ignoreWhitespace:!0});return xo.diff(t,e,n)}a(vi,"diffTrimmedLines");var Xa=new bn;Xa.tokenize=function(t){return t.split(/(\S.+?[.!?])(?=\s+|$)/)};function gl(t,e,r){return Xa.diff(t,e,r)}a(gl,"diffSentences");var Qa=new bn;Qa.tokenize=function(t){return t.split(/([{}:;,]|\s+)/)};function ml(t,e,r){return Qa.diff(t,e,r)}a(ml,"diffCss");function Vr(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Vr=a(function(e){return typeof e},"_typeof"):Vr=a(function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},"_typeof"),Vr(t)}a(Vr,"_typeof");function hn(t){return Ya(t)||Za(t)||Kn(t)||tc()}a(hn,"_toConsumableArray");function Ya(t){if(Array.isArray(t))return aa(t)}a(Ya,"_arrayWithoutHoles");function Za(t){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(t))return Array.from(t)}a(Za,"_iterableToArray");function Kn(t,e){if(!!t){if(typeof t=="string")return aa(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return aa(t,e)}}a(Kn,"_unsupportedIterableToArray");function aa(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}a(aa,"_arrayLikeToArray");function tc(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}a(tc,"_nonIterableSpread");var rc=Object.prototype.toString,Bi=new bn;Bi.useLongestToken=!0,Bi.tokenize=xo.tokenize,Bi.castInput=function(t){var e=this.options,r=e.undefinedReplacement,n=e.stringifyReplacer,i=n===void 0?function(o,c){return typeof c=="undefined"?r:c}:n;return typeof t=="string"?t:JSON.stringify(sa(t,null,null,i),i,"  ")},Bi.equals=function(t,e){return bn.prototype.equals.call(Bi,t.replace(/,([\r\n])/g,"$1"),e.replace(/,([\r\n])/g,"$1"))};function vl(t,e,r){return Bi.diff(t,e,r)}a(vl,"diffJson");function sa(t,e,r,n,i){e=e||[],r=r||[],n&&(t=n(i,t));var o;for(o=0;o<e.length;o+=1)if(e[o]===t)return r[o];var c;if(rc.call(t)==="[object Array]"){for(e.push(t),c=new Array(t.length),r.push(c),o=0;o<t.length;o+=1)c[o]=sa(t[o],e,r,n,i);return e.pop(),r.pop(),c}if(t&&t.toJSON&&(t=t.toJSON()),Vr(t)==="object"&&t!==null){e.push(t),c={},r.push(c);var l=[],d;for(d in t)t.hasOwnProperty(d)&&l.push(d);for(l.sort(),o=0;o<l.length;o+=1)d=l[o],c[d]=sa(t[d],e,r,n,d);e.pop(),r.pop()}else c=t;return c}a(sa,"canonicalize");var yi=new bn;yi.tokenize=function(t){return t.slice()},yi.join=yi.removeEmpty=function(t){return t};function nc(t,e,r){return yi.diff(t,e,r)}a(nc,"diffArrays");function Rn(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.split(/\r\n|[\n\v\f\r\x85]/),n=t.match(/\r\n|[\n\v\f\r\x85]/g)||[],i=[],o=0;function c(){var h={};for(i.push(h);o<r.length;){var S=r[o];if(/^(\-\-\-|\+\+\+|@@)\s/.test(S))break;var O=/^(?:Index:|diff(?: -r \w+)+)\s+(.+?)\s*$/.exec(S);O&&(h.index=O[1]),o++}for(l(h),l(h),h.hunks=[];o<r.length;){var I=r[o];if(/^(Index:|diff|\-\-\-|\+\+\+)\s/.test(I))break;if(/^@@/.test(I))h.hunks.push(d());else{if(I&&e.strict)throw new Error("Unknown line "+(o+1)+" "+JSON.stringify(I));o++}}}a(c,"parseIndex");function l(h){var S=/^(---|\+\+\+)\s+(.*)$/.exec(r[o]);if(S){var O=S[1]==="---"?"old":"new",I=S[2].split("	",2),P=I[0].replace(/\\\\/g,"\\");/^".*"$/.test(P)&&(P=P.substr(1,P.length-2)),h[O+"FileName"]=P,h[O+"Header"]=(I[1]||"").trim(),o++}}a(l,"parseFileHeader");function d(){var h=o,S=r[o++],O=S.split(/@@ -(\d+)(?:,(\d+))? \+(\d+)(?:,(\d+))? @@/),I={oldStart:+O[1],oldLines:typeof O[2]=="undefined"?1:+O[2],newStart:+O[3],newLines:typeof O[4]=="undefined"?1:+O[4],lines:[],linedelimiters:[]};I.oldLines===0&&(I.oldStart+=1),I.newLines===0&&(I.newStart+=1);for(var P=0,$=0;o<r.length&&!(r[o].indexOf("--- ")===0&&o+2<r.length&&r[o+1].indexOf("+++ ")===0&&r[o+2].indexOf("@@")===0);o++){var N=r[o].length==0&&o!=r.length-1?" ":r[o][0];if(N==="+"||N==="-"||N===" "||N==="\\")I.lines.push(r[o]),I.linedelimiters.push(n[o]||`
`),N==="+"?P++:N==="-"?$++:N===" "&&(P++,$++);else break}if(!P&&I.newLines===1&&(I.newLines=0),!$&&I.oldLines===1&&(I.oldLines=0),e.strict){if(P!==I.newLines)throw new Error("Added line count did not match for hunk at line "+(h+1));if($!==I.oldLines)throw new Error("Removed line count did not match for hunk at line "+(h+1))}return I}for(a(d,"parseHunk");o<r.length;)c();return i}a(Rn,"parsePatch");function Ja(t,e,r){var n=!0,i=!1,o=!1,c=1;return a(function l(){if(n&&!o){if(i?c++:n=!1,t+c<=r)return c;o=!0}if(!i)return o||(n=!0),e<=t-c?-c++:(i=!0,l())},"iterator")}a(Ja,"distanceIterator");function ca(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(typeof e=="string"&&(e=Rn(e)),Array.isArray(e)){if(e.length>1)throw new Error("applyPatch only works with a single input.");e=e[0]}var n=t.split(/\r\n|[\n\v\f\r\x85]/),i=t.match(/\r\n|[\n\v\f\r\x85]/g)||[],o=e.hunks,c=r.compareLine||function(Mn,Vn,ki,Ni){return Vn===Ni},l=0,d=r.fuzzFactor||0,h=0,S=0,O,I;function P(Mn,Vn){for(var ki=0;ki<Mn.lines.length;ki++){var Ni=Mn.lines[ki],Xs=Ni.length>0?Ni[0]:" ",bu=Ni.length>0?Ni.substr(1):Ni;if(Xs===" "||Xs==="-"){if(!c(Vn+1,n[Vn],Xs,bu)&&(l++,l>d))return!1;Vn++}}return!0}a(P,"hunkFits");for(var $=0;$<o.length;$++){for(var N=o[$],U=n.length-N.oldLines,W=0,V=S+N.oldStart-1,ie=Ja(V,h,U);W!==void 0;W=ie())if(P(N,V+W)){N.offset=S+=W;break}if(W===void 0)return!1;h=N.offset+N.oldStart+N.oldLines}for(var oe=0,ge=0;ge<o.length;ge++){var ke=o[ge],Ie=ke.oldStart+ke.offset+oe-1;oe+=ke.newLines-ke.oldLines;for(var Oe=0;Oe<ke.lines.length;Oe++){var Ze=ke.lines[Oe],$e=Ze.length>0?Ze[0]:" ",ze=Ze.length>0?Ze.substr(1):Ze,st=ke.linedelimiters[Oe];if($e===" ")Ie++;else if($e==="-")n.splice(Ie,1),i.splice(Ie,1);else if($e==="+")n.splice(Ie,0,ze),i.splice(Ie,0,st),Ie++;else if($e==="\\"){var Mt=ke.lines[Oe-1]?ke.lines[Oe-1][0]:null;Mt==="+"?O=!0:Mt==="-"&&(I=!0)}}}if(O)for(;!n[n.length-1];)n.pop(),i.pop();else I&&(n.push(""),i.push(`
`));for(var tn=0;tn<n.length-1;tn++)n[tn]=n[tn]+i[tn];return n.join("")}a(ca,"applyPatch");function es(t,e){typeof t=="string"&&(t=Rn(t));var r=0;function n(){var i=t[r++];if(!i)return e.complete();e.loadFile(i,function(o,c){if(o)return e.complete(o);var l=ca(c,i,e);e.patched(i,l,function(d){if(d)return e.complete(d);n()})})}a(n,"processIndex"),n()}a(es,"applyPatches");function ts(t,e,r,n,i,o,c){c||(c={}),typeof c.context=="undefined"&&(c.context=4);var l=Ka(r,n,c);l.push({value:"",lines:[]});function d(W){return W.map(function(V){return" "+V})}a(d,"contextLines");for(var h=[],S=0,O=0,I=[],P=1,$=1,N=a(function(V){var ie=l[V],oe=ie.lines||ie.value.replace(/\n$/,"").split(`
`);if(ie.lines=oe,ie.added||ie.removed){var ge;if(!S){var ke=l[V-1];S=P,O=$,ke&&(I=c.context>0?d(ke.lines.slice(-c.context)):[],S-=I.length,O-=I.length)}(ge=I).push.apply(ge,hn(oe.map(function(tn){return(ie.added?"+":"-")+tn}))),ie.added?$+=oe.length:P+=oe.length}else{if(S)if(oe.length<=c.context*2&&V<l.length-2){var Ie;(Ie=I).push.apply(Ie,hn(d(oe)))}else{var Oe,Ze=Math.min(oe.length,c.context);(Oe=I).push.apply(Oe,hn(d(oe.slice(0,Ze))));var $e={oldStart:S,oldLines:P-S+Ze,newStart:O,newLines:$-O+Ze,lines:I};if(V>=l.length-2&&oe.length<=c.context){var ze=/\n$/.test(r),st=/\n$/.test(n),Mt=oe.length==0&&I.length>$e.oldLines;!ze&&Mt&&r.length>0&&I.splice($e.oldLines,0,"\\ No newline at end of file"),(!ze&&!Mt||!st)&&I.push("\\ No newline at end of file")}h.push($e),S=0,O=0,I=[]}P+=oe.length,$+=oe.length}},"_loop"),U=0;U<l.length;U++)N(U);return{oldFileName:t,newFileName:e,oldHeader:i,newHeader:o,hunks:h}}a(ts,"structuredPatch");function rs(t){var e=[];t.oldFileName==t.newFileName&&e.push("Index: "+t.oldFileName),e.push("==================================================================="),e.push("--- "+t.oldFileName+(typeof t.oldHeader=="undefined"?"":"	"+t.oldHeader)),e.push("+++ "+t.newFileName+(typeof t.newHeader=="undefined"?"":"	"+t.newHeader));for(var r=0;r<t.hunks.length;r++){var n=t.hunks[r];n.oldLines===0&&(n.oldStart-=1),n.newLines===0&&(n.newStart-=1),e.push("@@ -"+n.oldStart+","+n.oldLines+" +"+n.newStart+","+n.newLines+" @@"),e.push.apply(e,n.lines)}return e.join(`
`)+`
`}a(rs,"formatPatch");function ic(t,e,r,n,i,o,c){return rs(ts(t,e,r,n,i,o,c))}a(ic,"createTwoFilesPatch");function Co(t,e,r,n,i,o){return ic(t,t,e,r,n,i,o)}a(Co,"createPatch");function oc(t,e){return t.length!==e.length?!1:la(t,e)}a(oc,"arrayEqual");function la(t,e){if(e.length>t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}a(la,"arrayStartsWith");function ua(t){var e=fa(t.lines),r=e.oldLines,n=e.newLines;r!==void 0?t.oldLines=r:delete t.oldLines,n!==void 0?t.newLines=n:delete t.newLines}a(ua,"calcLineCount");function da(t,e,r){t=_i(t,r),e=_i(e,r);var n={};(t.index||e.index)&&(n.index=t.index||e.index),(t.newFileName||e.newFileName)&&(ns(t)?ns(e)?(n.oldFileName=To(n,t.oldFileName,e.oldFileName),n.newFileName=To(n,t.newFileName,e.newFileName),n.oldHeader=To(n,t.oldHeader,e.oldHeader),n.newHeader=To(n,t.newHeader,e.newHeader)):(n.oldFileName=t.oldFileName,n.newFileName=t.newFileName,n.oldHeader=t.oldHeader,n.newHeader=t.newHeader):(n.oldFileName=e.oldFileName||t.oldFileName,n.newFileName=e.newFileName||t.newFileName,n.oldHeader=e.oldHeader||t.oldHeader,n.newHeader=e.newHeader||t.newHeader)),n.hunks=[];for(var i=0,o=0,c=0,l=0;i<t.hunks.length||o<e.hunks.length;){var d=t.hunks[i]||{oldStart:1/0},h=e.hunks[o]||{oldStart:1/0};if(Ln(d,h))n.hunks.push(is(d,c)),i++,l+=d.newLines-d.oldLines;else if(Ln(h,d))n.hunks.push(is(h,l)),o++,c+=h.newLines-h.oldLines;else{var S={oldStart:Math.min(d.oldStart,h.oldStart),oldLines:0,newStart:Math.min(d.newStart+c,h.oldStart+l),newLines:0,lines:[]};ac(S,d.oldStart,d.lines,h.oldStart,h.lines),o++,i++,n.hunks.push(S)}}return n}a(da,"merge");function _i(t,e){if(typeof t=="string"){if(/^@@/m.test(t)||/^Index:/m.test(t))return Rn(t)[0];if(!e)throw new Error("Must provide a base reference or pass in a patch");return ts(void 0,void 0,e,t)}return t}a(_i,"loadPatch");function ns(t){return t.newFileName&&t.newFileName!==t.oldFileName}a(ns,"fileNameChanged");function To(t,e,r){return e===r?e:(t.conflict=!0,{mine:e,theirs:r})}a(To,"selectField");function Ln(t,e){return t.oldStart<e.oldStart&&t.oldStart+t.oldLines<e.oldStart}a(Ln,"hunkBefore");function is(t,e){return{oldStart:t.oldStart,oldLines:t.oldLines,newStart:t.newStart+e,newLines:t.newLines,lines:t.lines}}a(is,"cloneHunk");function ac(t,e,r,n,i){var o={offset:e,lines:r,index:0},c={offset:n,lines:i,index:0};for(Xn(t,o,c),Xn(t,c,o);o.index<o.lines.length&&c.index<c.lines.length;){var l=o.lines[o.index],d=c.lines[c.index];if((l[0]==="-"||l[0]==="+")&&(d[0]==="-"||d[0]==="+"))sc(t,o,c);else if(l[0]==="+"&&d[0]===" "){var h;(h=t.lines).push.apply(h,hn(wi(o)))}else if(d[0]==="+"&&l[0]===" "){var S;(S=t.lines).push.apply(S,hn(wi(c)))}else l[0]==="-"&&d[0]===" "?os(t,o,c):d[0]==="-"&&l[0]===" "?os(t,c,o,!0):l===d?(t.lines.push(l),o.index++,c.index++):Ao(t,wi(o),wi(c))}ha(t,o),ha(t,c),ua(t)}a(ac,"mergeLines");function sc(t,e,r){var n=wi(e),i=wi(r);if(as(n)&&as(i)){if(la(n,i)&&Io(r,n,n.length-i.length)){var o;(o=t.lines).push.apply(o,hn(n));return}else if(la(i,n)&&Io(e,i,i.length-n.length)){var c;(c=t.lines).push.apply(c,hn(i));return}}else if(oc(n,i)){var l;(l=t.lines).push.apply(l,hn(n));return}Ao(t,n,i)}a(sc,"mutualChange");function os(t,e,r,n){var i=wi(e),o=Ro(r,i);if(o.merged){var c;(c=t.lines).push.apply(c,hn(o.merged))}else Ao(t,n?o:i,n?i:o)}a(os,"removal");function Ao(t,e,r){t.conflict=!0,t.lines.push({conflict:!0,mine:e,theirs:r})}a(Ao,"conflict");function Xn(t,e,r){for(;e.offset<r.offset&&e.index<e.lines.length;){var n=e.lines[e.index++];t.lines.push(n),e.offset++}}a(Xn,"insertLeading");function ha(t,e){for(;e.index<e.lines.length;){var r=e.lines[e.index++];t.lines.push(r)}}a(ha,"insertTrailing");function wi(t){for(var e=[],r=t.lines[t.index][0];t.index<t.lines.length;){var n=t.lines[t.index];if(r==="-"&&n[0]==="+"&&(r="+"),r===n[0])e.push(n),t.index++;else break}return e}a(wi,"collectChange");function Ro(t,e){for(var r=[],n=[],i=0,o=!1,c=!1;i<e.length&&t.index<t.lines.length;){var l=t.lines[t.index],d=e[i];if(d[0]==="+")break;if(o=o||l[0]!==" ",n.push(d),i++,l[0]==="+")for(c=!0;l[0]==="+";)r.push(l),l=t.lines[++t.index];d.substr(1)===l.substr(1)?(r.push(l),t.index++):c=!0}if((e[i]||"")[0]==="+"&&o&&(c=!0),c)return r;for(;i<e.length;)n.push(e[i++]);return{merged:n,changes:r}}a(Ro,"collectContext");function as(t){return t.reduce(function(e,r){return e&&r[0]==="-"},!0)}a(as,"allRemoves");function Io(t,e,r){for(var n=0;n<r;n++){var i=e[e.length-r+n].substr(1);if(t.lines[t.index+n]!==" "+i)return!1}return t.index+=r,!0}a(Io,"skipRemoveSuperset");function fa(t){var e=0,r=0;return t.forEach(function(n){if(typeof n!="string"){var i=fa(n.mine),o=fa(n.theirs);e!==void 0&&(i.oldLines===o.oldLines?e+=i.oldLines:e=void 0),r!==void 0&&(i.newLines===o.newLines?r+=i.newLines:r=void 0)}else r!==void 0&&(n[0]==="+"||n[0]===" ")&&r++,e!==void 0&&(n[0]==="-"||n[0]===" ")&&e++}),{oldLines:e,newLines:r}}a(fa,"calcOldNewLineCount");function cc(t){for(var e=[],r,n,i=0;i<t.length;i++)r=t[i],r.added?n=1:r.removed?n=-1:n=0,e.push([n,r.value]);return e}a(cc,"convertChangesToDMP");function lc(t){for(var e=[],r=0;r<t.length;r++){var n=t[r];n.added?e.push("<ins>"):n.removed&&e.push("<del>"),e.push(ss(n.value)),n.added?e.push("</ins>"):n.removed&&e.push("</del>")}return e.join("")}a(lc,"convertChangesToXML");function ss(t){var e=t;return e=e.replace(/&/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/"/g,"&quot;"),e}a(ss,"escapeHTML");function bi(t,e){let r={};for(let o=0;o<e.length;o++){const c=e[o];r[c]?r[c].push(o):r[c]=[o]}let i=[{buffer1index:-1,buffer2index:-1,chain:null}];for(let o=0;o<t.length;o++){const c=t[o],l=r[c]||[];let d=0,h=i[0];for(let S=0;S<l.length;S++){const O=l[S];let I;for(I=d;I<i.length&&!(i[I].buffer2index<O&&(I===i.length-1||i[I+1].buffer2index>O));I++);if(I<i.length){const P={buffer1index:o,buffer2index:O,chain:i[I]};if(d===i.length?i.push(h):i[d]=h,d=I+1,h=P,d===i.length)break}}i[d]=h}return i[i.length-1]}a(bi,"LCS");function cs(t,e){const r=bi(t,e);let n=[],i=t.length,o=e.length,c={common:[]};function l(){c.common.length&&(c.common.reverse(),n.push(c),c={common:[]})}a(l,"processCommon");for(let d=r;d!==null;d=d.chain){let h={buffer1:[],buffer2:[]};for(;--i>d.buffer1index;)h.buffer1.push(t[i]);for(;--o>d.buffer2index;)h.buffer2.push(e[o]);(h.buffer1.length||h.buffer2.length)&&(l(),h.buffer1.reverse(),h.buffer2.reverse(),n.push(h)),i>=0&&c.common.push(t[i])}return l(),n.reverse(),n}a(cs,"diffComm");function Oo(t,e){const r=bi(t,e);let n=[],i=t.length,o=e.length;for(let c=r;c!==null;c=c.chain){const l=i-c.buffer1index-1,d=o-c.buffer2index-1;i=c.buffer1index,o=c.buffer2index,(l||d)&&n.push({buffer1:[i+1,l],buffer1Content:t.slice(i+1,i+1+l),buffer2:[o+1,d],buffer2Content:e.slice(o+1,o+1+d)})}return n.reverse(),n}a(Oo,"diffIndices");function Po(t,e){const r=bi(t,e);let n=[],i=t.length,o=e.length;function c(l,d,h){let S=[];for(let O=0;O<h;O++)S.push(l[d+O]);return{offset:d,length:h,chunk:S}}a(c,"chunkDescription");for(let l=r;l!==null;l=l.chain){const d=i-l.buffer1index-1,h=o-l.buffer2index-1;i=l.buffer1index,o=l.buffer2index,(d||h)&&n.push({buffer1:c(t,l.buffer1index+1,d),buffer2:c(e,l.buffer2index+1,h)})}return n.reverse(),n}a(Po,"diffPatch");function fn(t,e,r){let n=[];function i(d,h){n.push({ab:h,oStart:d.buffer1[0],oLength:d.buffer1[1],abStart:d.buffer2[0],abLength:d.buffer2[1]})}a(i,"addHunk"),Oo(e,t).forEach(d=>i(d,"a")),Oo(e,r).forEach(d=>i(d,"b")),n.sort((d,h)=>d.oStart-h.oStart);let o=[],c=0;function l(d){d>c&&(o.push({stable:!0,buffer:"o",bufferStart:c,bufferLength:d-c,bufferContent:e.slice(c,d)}),c=d)}for(a(l,"advanceTo");n.length;){let d=n.shift(),h=d.oStart,S=d.oStart+d.oLength,O=[d];for(l(h);n.length;){const I=n[0],P=I.oStart;if(P>S)break;S=Math.max(S,P+I.oLength),O.push(n.shift())}if(O.length===1){if(d.abLength>0){const I=d.ab==="a"?t:r;o.push({stable:!0,buffer:d.ab,bufferStart:d.abStart,bufferLength:d.abLength,bufferContent:I.slice(d.abStart,d.abStart+d.abLength)})}}else{let I={a:[t.length,-1,e.length,-1],b:[r.length,-1,e.length,-1]};for(;O.length;){d=O.shift();const V=d.oStart,ie=V+d.oLength,oe=d.abStart,ge=oe+d.abLength;let ke=I[d.ab];ke[0]=Math.min(oe,ke[0]),ke[1]=Math.max(ge,ke[1]),ke[2]=Math.min(V,ke[2]),ke[3]=Math.max(ie,ke[3])}const P=I.a[0]+(h-I.a[2]),$=I.a[1]+(S-I.a[3]),N=I.b[0]+(h-I.b[2]),U=I.b[1]+(S-I.b[3]);let W={stable:!1,aStart:P,aLength:$-P,aContent:t.slice(P,$),oStart:h,oLength:S-h,oContent:e.slice(h,S),bStart:N,bLength:U-N,bContent:r.slice(N,U)};o.push(W)}c=S}return l(e.length),o}a(fn,"diff3MergeRegions");function J(t,e,r,n){n=Object.assign({excludeFalseConflicts:!0,stringSeparator:/\s+/},n);const o=typeof t=="string",c=typeof e=="string",l=typeof r=="string";o&&(t=t.split(n.stringSeparator)),c&&(e=e.split(n.stringSeparator)),l&&(r=r.split(n.stringSeparator));let d=[];const h=fn(t,e,r);let S=[];function O(){S.length&&d.push({ok:S}),S=[]}a(O,"flushOk");function I(P,$){if(P.length!==$.length)return!1;for(let N=0;N<P.length;N++)if(P[N]!==$[N])return!1;return!0}return a(I,"isFalseConflict"),h.forEach(P=>{P.stable?S.push(...P.bufferContent):n.excludeFalseConflicts&&I(P.aContent,P.bContent)?S.push(...P.aContent):(O(),d.push({conflict:{a:P.aContent,aIndex:P.aStart,o:P.oContent,oIndex:P.oStart,b:P.bContent,bIndex:P.bStart}}))}),O(),d}a(J,"diff3Merge");function _e(t,e,r,n){n=Object.assign({excludeFalseConflicts:!0,stringSeparator:/\s+/,label:{}},n);const o=J(t,e,r,n);let c=!1,l=[];return o.forEach(d=>{d.ok?l=l.concat(d.ok):d.conflict&&(c=!0,l.push(`<<<<<<<${n.label.a?` ${n.label.a}`:""}`),l=l.concat(d.conflict.a),l.push(`|||||||${n.label.o?` ${n.label.o}`:""}`),l=l.concat(d.conflict.o),l.push("======="),l=l.concat(d.conflict.b),l.push(`>>>>>>>${n.label.b?` ${n.label.b}`:""}`))}),{conflict:c,result:l}}a(_e,"mergeDiff3");function Ge(t,e,r,n){n=Object.assign({excludeFalseConflicts:!0,stringSeparator:/\s+/},n);const o=J(t,e,r,n);let c=!1,l=[];for(let d=0;d<o.length;d++){const h=o[d];h.ok?l=l.concat(h.ok):(c=!0,l=l.concat([`
<<<<<<<<<
`],h.conflict.a,[`
=========
`],h.conflict.b,[`
>>>>>>>>>
`]))}return{conflict:c,result:l}}a(Ge,"node_diff3_merge");function gt(t,e,r,n){n=Object.assign({excludeFalseConflicts:!1,stringSeparator:/\s+/},n);const o=J(t,e,r,n);let c=!1,l=[];for(let d=0;d<o.length;d++){const h=o[d];if(h.ok)l=l.concat(h.ok);else{const S=cs(h.conflict.a,h.conflict.b);for(let O=0;O<S.length;O++){let I=S[O];I.common?l=l.concat(I.common):(c=!0,l=l.concat([`
<<<<<<<<<
`],I.buffer1,[`
=========
`],I.buffer2,[`
>>>>>>>>>
`]))}}}return{conflict:c,result:l}}a(gt,"mergeDigIn");function dr(t,e){let r=[],n=0;function i(o){for(;n<o;)r.push(t[n]),n++}a(i,"advanceTo");for(let o=0;o<e.length;o++){let c=e[o];i(c.buffer1.offset);for(let l=0;l<c.buffer2.chunk.length;l++)r.push(c.buffer2.chunk[l]);n+=c.buffer1.length}return i(t.length),r}a(dr,"patch");function Ft(t){return t.map(e=>({buffer1:{offset:e.buffer1.offset,length:e.buffer1.length},buffer2:{chunk:e.buffer2.chunk}}))}a(Ft,"stripPatch");function yr(t){return t.map(e=>({buffer1:e.buffer2,buffer2:e.buffer1}))}a(yr,"invertPatch");function Ar(t,e,r){return ca(t,e,r)}a(Ar,"diffs_applyPatch");function Rr(t,e){const r=[];for(const n of Rn(t,e))r.push({...n,oldFileName:n.newFileName,oldHeader:n.newHeader,newFileName:n.oldFileName,newHeader:n.oldHeader,hunks:n.hunks.map(i=>({...i,oldLines:i.newLines,oldStart:i.newStart,newLines:i.oldLines,newStart:i.oldStart,lines:i.lines.map(o=>o[0]==="-"?`+${o.slice(1)}`:o[0]==="+"?`-${o.slice(1)}`:o)}))}),r.push(n);return r}a(Rr,"reversePatch");function hr(t,e,r){let n=`
`;const i=t.match(/(?:\r?\n)/g);if(i!==null&&i.length!==0){const d=i.filter(h=>h===`\r
`).length;n=d>i.length-d?`\r
`:`
`}const o=Ge(t,e,r,{excludeFalseConflicts:!0,stringSeparator:/\r?\n/}),c=o.result;let l=!1;if(o.conflict){let d;const h=[];let S=0;for(const P of c)P===`
<<<<<<<<<
`?d={start:S,separator:S,end:S}:P===`
=========
`?d.separator=S:P===`
>>>>>>>>>
`&&(d.end=S,h.push(d)),S++;let O=0,I=0;for(const P of h)c.splice(P.start-O,1),O++,I=P.end-P.separator+1,c.splice(P.separator-O,I),O+=I;h.length&&(l=!0)}return{conflicts:l,mergedContent:c.join(n)}}a(hr,"diffs_merge");function an(t){return t!==void 0&&typeof t.then=="function"}a(an,"isPromise");const pn="";function Lr(...t){if(t.length===1){const e=t[0];return e===void 0?pn:typeof e=="string"?e:typeof e=="number"||typeof e=="boolean"||e instanceof Error?String(e):e instanceof m.Uri?e.toString():JSON.stringify(e)}return JSON.stringify(t)}a(Lr,"gate_defaultResolver");function tr(t){return(e,r,n)=>{let i;if(typeof n.value=="function"?i=n.value:typeof n.get=="function"&&(i=n.get),i===void 0)throw new Error("Not supported");const o=`$gate$${r}`;n.value=function(...c){const l=c.length===0?o:`${o}$${(t!=null?t:Lr)(...c)}`;Object.prototype.hasOwnProperty.call(this,l)||Object.defineProperty(this,l,{configurable:!1,enumerable:!1,writable:!0,value:void 0});let d=this[l];if(d===void 0){let h;try{if(h=i.apply(this,c),h==null||!an(h))return h;this[l]=d=h.then(S=>(this[l]=void 0,S)).catch(S=>{throw this[l]=void 0,S})}catch(S){throw this[l]=void 0,S}}return d}}}a(tr,"gate");let Kr=0;function Qn(){return Kr===Number.MAX_SAFE_INTEGER&&(Kr=0),String(++Kr)}a(Qn,"getNextLockId");class In{constructor(){this.id=Qn()}async synchronize(e){let r;const n=this.promise;this.promise=new Promise(i=>r=i),await n;try{return await e()}finally{r()}}}a(In,"Lock");class Sn{constructor(e){this.lock=new In,this.readers=new Set,this.counter=0,this._id=e!=null?e:this.lock.id}get id(){return this._id}getNextCounter(){return this.counter===Number.MAX_SAFE_INTEGER&&(this.counter=0),++this.counter}async synchronizeRead(e,r){let n;const i=new ut(`Reader(${this.getNextCounter()}|${this.id})`,{log:{prefix:"(A) ",message:r?` \u2022 ${r}`:""},logLevel:qe.Debug});let o;await this.lock.synchronize(async()=>{this.writer&&await this.writer,o=new Promise(c=>n=c),this.readers.add(o)}),i.restart({prefix:"(L) ",suffix:r?` \u2022 ${r}`:"",took:" waited for "});try{return await e()}finally{i.stop({prefix:"(U) ",suffix:r?` \u2022 ${r}`:"",took:" locked for "}),o!==void 0&&this.readers.delete(o),n()}}async synchronizeWrite(e,r){let n;const i=new ut(`Writer(${this.getNextCounter()}|${this.id})`,{log:{prefix:"(A) ",message:r?` \u2022 ${r}`:""},logLevel:qe.Debug});await this.lock.synchronize(async()=>{if(this.writer&&await this.writer,this.readers.size){const o=[...this.readers];this.readers.clear(),await Promise.all(o)}this.writer=new Promise(o=>n=o)}),i.restart({prefix:"(L) ",suffix:r?` \u2022 ${r}`:"",took:" waited for "});try{return await e()}finally{i.stop({prefix:"(U) ",suffix:r?` \u2022 ${r}`:"",took:" locked for "}),n(),this.writer=void 0}}}a(Sn,"ReaderWriterLock");class pa{constructor(){this.locks=new Map}async synchronizeRead(e,r,n){let i=this.locks.get(e);return i===void 0&&(i=new Sn(String(e)),this.locks.set(e,i)),i.synchronizeRead(r,n)}async synchronizeWrite(e,r,n){let i=this.locks.get(e);return i===void 0&&(i=new Sn(String(e)),this.locks.set(e,i)),i.synchronizeWrite(r,n)}}a(pa,"KeyedReaderWriterLock");async function Yn(t){return(await Promise.resolve().then(__webpack_require__.t.bind(__webpack_require__,6113,23))).createHash("sha1").update(t).digest("base64")}a(Yn,"sha1");var Do=Object.defineProperty,yl=Object.getOwnPropertyDescriptor,Su=a((t,e,r,n)=>{for(var i=n>1?void 0:n?yl(e,r):e,o=t.length-1,c;o>=0;o--)(c=t[o])&&(i=(n?c(e,r,i):c(i))||i);return n&&i&&Do(e,r,i),i},"changeStore_decorateClass");const On=(0,B.loadMessageBundle)(),Eu=m.FileSystemError.FileNotFound().code,_l=`===================================================================
`,Zn=new TextDecoder,xu=new TextEncoder;var Dt;(function(t){t[t.Changed=1]="Changed",t[t.Created=2]="Created",t[t.Deleted=3]="Deleted"})(Dt||(Dt={}));function Cu(t){return t&&"type"in t&&"uri"in t&&"uri"in t&&"fileType"in t&&"revision"in t&&"timestamp"in t}a(Cu,"isOperation");function ga(t,e,r){return{type:t.type,rootUri:e,uri:r!=null?r:t.uri}}a(ga,"toEvent");const ko=a(class{constructor(t,e,r,n,i,o){this.providerService=t,this.storageService=e,this.fileStorageService=r,this.telemetryService=n,this.workspaceId=i,this._onDidChange=new m.EventEmitter,this.cache=new Map,this.lock=new pa,this.scopedStores=new Map,o===void 0&&(ko._instance=this,this.disposable=m.Disposable.from(this.providerService.onDidRefresh(()=>this.cache.clear())))}static get instance(){return this._instance}get onDidChange(){return this._onDidChange.event}dispose(){var t;(t=this.disposable)==null||t.dispose()}async exportDebugInfo(t){var e;async function r(n){const i=await m.workspace.openTextDocument({language:"json",content:`ChangeStore Operations for ${n.toString(!0)}

${this.toStorage(await this.getWorkingOperations(n))}`});return void m.window.showTextDocument(i)}if(a(r,"exportCore"),t===void 0)for(const n of(e=m.workspace.workspaceFolders)!=null?e:[])await r.call(this,n.uri);else return r.call(this,t)}async getWorkspaceProvidersWithChanges(){var t,e;const r=new Map;for(const n of(t=m.workspace.workspaceFolders)!=null?t:[])if(n.uri.scheme===Qt.scheme&&await this.hasChanges(n.uri)){const i=(e=this.providerService.getRepository(n.uri))==null?void 0:e.provider;if(!i)continue;r.set(i.id,i)}return[...r.values()]}async getWorkspacesWithChanges(){var t;const e=new ut("ChangeStore.getWorkspacesWithChanges()");try{const r=[];for(const n of(t=m.workspace.workspaceFolders)!=null?t:[])n.uri.scheme===Qt.scheme&&await this.hasChanges(n.uri)&&r.push(n.uri);return r.length>0?r:void 0}finally{e.stop()}}async acceptAll(t,e){const r=`ChangeStore.acceptAll(${t.toString()}, ${e==null?void 0:e.staged})`;L.log(r);const n=[];await this.lock.synchronizeWrite(te(t),async()=>{const i=await this.getWorkingOperations(t),o=[];let c=[];const l=(e==null?void 0:e.staged)&&!(e.staged==="auto"&&!i.some(d=>d.staged));for(const d of i){if(l&&!d.staged){c.push(d);continue}d.fileType===m.FileType.File&&await this.discardWorkingContent(t,d.uri);let h;if(d.type===2&&d.fileType===m.FileType.Directory&&(i.some(S=>et(S.uri,d.uri))||(h={type:3,rootUri:t,uri:d.uri})),n.push(h!=null?h:ga(d,t)),d.type===2){let S=d.uri;for(;;){const{parent:O}=this.findParent(S,i,I=>I.type===2);if(O){o.push(O),S=O.uri;continue}break}}}c.length>0&&o.length>0&&(c=c.filter(d=>o.includes(d)?(n.push(ga(d,t)),!1):!0)),await this.saveWorkingOperations(t,c)},r),n.length!==0&&this._onDidChange.fire(n)}async discard(t){const e=this.providerService.getVirtualWorkspaceUri(t);if(e===void 0)return;const r=`ChangeStore.discard(${t.toString()})`;L.log(r);const n=[];await this.lock.synchronizeWrite(te(e),async()=>this.discardCore(e,t,n),r),n.length!==0&&this._onDidChange.fire(n)}async discardCore(t,e,r){L.debug(`ChangeStore.discardCore(${e.toString()})`);const n=await this.getWorkingOperations(t);if(n.length===0)return;const i=Te(e),o=n.findIndex(d=>Te(d.uri)===i);if(o===-1)return;const[c]=n.splice(o,1);let l;switch(c.type){case 2:l=3;break;case 3:l=2;break;default:l=c.type;break}if(r.push({type:l,rootUri:t,uri:e}),c.type===2){let d=c.uri;for(;;){const{parent:h,parentIndex:S}=this.findNewParentWithOnlyChild(d,n);if(h){n.splice(S,1),r.push({type:3,rootUri:t,uri:h.uri}),d=h.uri;continue}break}}await this.saveWorkingOperations(t,n),c.fileType===m.FileType.File&&await this.discardWorkingContent(t,e)}async discardAll(t,e){const r=this.getUriScope(t);if(r)return this.getScopedChangeStore(r).discardAll(t,e);const n=`ChangeStore.discardAll(${t.toString()}, ${e==null?void 0:e.staged})`;L.log(n);const i=[];await this.lock.synchronizeWrite(te(t),async()=>{const o=await this.getWorkingOperations(t),c=[];let l=[];const d=(e==null?void 0:e.staged)&&!(e.staged==="auto"&&!o.some(h=>h.staged));for(const h of o){if(d&&!h.staged){l.push(h);continue}h.fileType===m.FileType.File&&await this.discardWorkingContent(t,h.uri);let S;switch(h.type){case 2:S=3;break;case 3:S=2;break;default:S=h.type;break}if(i.push({type:S,rootUri:t,uri:h.uri}),h.type===2){let O=h.uri;for(;;){const{parent:I}=this.findNewParentWithOnlyChild(O,o);if(I){c.push(I),O=I.uri;continue}break}}}l.length>0&&c.length>0&&(l=l.filter(h=>c.includes(h)?(i.push({type:3,rootUri:t,uri:h.uri}),!1):!0)),await this.saveWorkingOperations(t,l)},n),i.length!==0&&this._onDidChange.fire(i)}async stage(t){const e=this.providerService.getVirtualWorkspaceUri(t);if(e===void 0)return;const r=`ChangeStore.stage(${t.toString()})`;L.log(r);const n=[];await this.lock.synchronizeWrite(te(e),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(t,e);i!==void 0&&await this.spliceOperation(t,o,{...i,staged:!0,timestamp:Date.now()},n)},r),n.length!==0&&this._onDidChange.fire(n)}async stageAll(t){const e=`ChangeStore.stageAll(${t.toString()})`;L.log(e);const r=[];await this.lock.synchronizeWrite(te(t),async()=>{const n=(await this.getWorkingOperations(t)).map(i=>({...i,staged:!0,timestamp:Date.now()}));n.length!==0&&(await this.saveWorkingOperations(t,n),r.push(...n.map(i=>ga(i,t))))},e),r.length!==0&&this._onDidChange.fire(r)}async unstage(t){const e=this.providerService.getVirtualWorkspaceUri(t);if(e===void 0)return;const r=`ChangeStore.unstage(${t.toString()})`;L.log(r);const n=[];await this.lock.synchronizeWrite(te(e),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(t,e);i!==void 0&&await this.spliceOperation(t,o,{...i,staged:!1,timestamp:Date.now()},n)},r),n.length!==0&&this._onDidChange.fire(n)}async unstageAll(t){const e=`ChangeStore.unstageAll(${t.toString()})`;L.log(e);const r=[];await this.lock.synchronizeWrite(te(t),async()=>{const n=(await this.getWorkingOperations(t)).map(i=>({...i,staged:!1,timestamp:Date.now()}));n.length!==0&&(await this.saveWorkingOperations(t,n),r.push(...n.map(i=>ga(i,t))))},e),r.length!==0&&this._onDidChange.fire(r)}async hasChanges(t){const e=this.getUriScope(t);if(e)return this.getScopedChangeStore(e).hasChanges(t);const r=te(t),n=this.cache.get(r);return n!==void 0?n.length!==0:this.lock.synchronizeRead(r,async()=>(await this.getWorkingOperations(t)).length!==0,`ChangeStore.hasChanges(${t.toString()})`)}maybeHasChanges(t,e){const r=this.getUriScope(t);if(r)return this.getScopedChangeStore(r).maybeHasChanges(t,e);const n=te(t),i=this.cache.get(n);if(i===void 0)return;if(i.length===0)return!1;if(e===void 0)return!0;const o=Te(e);return i.some(c=>Te(c.uri)===o)}async hasMergeConflicts(t){return this.lock.synchronizeRead(te(t),async()=>(await this.getWorkingOperations(t)).some(e=>e.conflicts!==void 0),`ChangeStore.hasMergeConflicts(${t.toString()})`)}async hasStagedChanges(t){return this.lock.synchronizeRead(te(t),async()=>(await this.getWorkingOperations(t)).some(e=>e.staged&&e.conflicts===void 0),`ChangeStore.hasStagedChanges(${t.toString()})`)}async hasWorkingChanges(t){return this.lock.synchronizeRead(te(t),async()=>(await this.getWorkingOperations(t)).some(e=>!e.staged&&e.conflicts===void 0),`ChangeStore.hasWorkingChanges(${t.toString()})`)}async getChange(t){const e=this.getUriScope(t);if(e)return this.getScopedChangeStore(e).getChange(t);const r=this.providerService.getVirtualRootUri(t);if(r!==void 0)return this.lock.synchronizeRead(te(r),async()=>{const{operation:n}=await this.getWorkingOperation(t,r);return n},`ChangeStore.getChange(${t.toString()})`)}async getChanges(t,e){const r=this.getUriScope(t);return r?this.getScopedChangeStore(r).getChanges(t,e):this.lock.synchronizeRead(te(t),async()=>{let n=await this.getWorkingOperations(t);if((e==null?void 0:e.excludeConflicts)||(e==null?void 0:e.predicate)){const{excludeConflicts:i,predicate:o}=e;n=n.filter(c=>{var l;return(!i||c.conflicts===void 0)&&((l=o==null?void 0:o(c))!=null?l:!0)})}return n},`ChangeStore.getChanges(${t.toString()})`)}async getGroupedChanges(t,e){const r=this.getUriScope(t);return r?this.getScopedChangeStore(r).getGroupedChanges(t,e):this.lock.synchronizeRead(te(t),async()=>{var n,i;const o=await this.getWorkingOperations(t),c={conflicts:[],staged:[],working:[]};for(const l of o)!((i=(n=e==null?void 0:e.predicate)==null?void 0:n.call(e,l))!=null?i:!0)||(l.conflicts?c.conflicts.push(l):l.staged?c.staged.push(l):c.working.push(l));return c},`ChangeStore.getChangesByType(${t.toString()})`)}async getContent(t){const e=this.providerService.getVirtualRootUri(t);if(e===void 0)throw new Error(`Unable to find content for ${t.toString()}; Repository not found`);const r=te(e),n=this.cache.get(r);if((n==null?void 0:n.length)===0)throw new Error(`Unable to find content for ${t.toString()}`);return this.lock.synchronizeRead(r,async()=>{const i=Zn.decode(await this.getWorkingContent(e,t));if(i!==void 0)return i;throw new Error(`Unable to find content for ${t.toString()}`)},`ChangeStore.getContent(${t.toString()}}`)}async getMergeConflicts(t,e){return this.lock.synchronizeRead(te(t),async()=>(await this.getWorkingOperations(t)).filter(n=>{var i,o;return n.conflicts!==void 0&&((o=(i=e==null?void 0:e.predicate)==null?void 0:i.call(e,n))!=null?o:!0)}),`ChangeStore.getMergeConflicts(${t.toString()})`)}async getStagedChanges(t,e){return this.lock.synchronizeRead(te(t),async()=>(await this.getWorkingOperations(t)).filter(n=>{var i,o;return n.staged&&n.conflicts===void 0&&((o=(i=e==null?void 0:e.predicate)==null?void 0:i.call(e,n))!=null?o:!0)}),`ChangeStore.getStagedChanges(${t.toString()})`)}async getWorkingChanges(t,e){return this.lock.synchronizeRead(te(t),async()=>(await this.getWorkingOperations(t)).filter(n=>{var i,o;return!n.staged&&n.conflicts===void 0&&((o=(i=e==null?void 0:e.predicate)==null?void 0:i.call(e,n))!=null?o:!0)}),`ChangeStore.getWorkingChanges(${t.toString()})`)}async applyChangeset(t,e,r,n){var i;let o;Cu(r)?o=r:n=n!=null?n:r,L.log(`ChangeStore.applyChangeset${t.toString()}`,e.workspaceId,e.uri,o==null?void 0:o.uri,n==null?void 0:n.save);const c=this.getScopedChangeStore(e.workspaceId),l=(i=e.patch)!=null?i:await c.createPatch(e.uri,o==null?void 0:o.uri);await this.applyPatchCore(t,l,{...n,getIncomingContent:async d=>{const h=this.getScopedUri(this.providerService.createRelativeVirtualUri(e.uri,d),e.workspaceId);return Zn.decode(await m.workspace.fs.readFile(h))},merge:async(d,h,S)=>{try{const O=this.providerService.getProviderUri(d),I=Zn.decode(await m.workspace.fs.readFile(O)),P=this.getScopedUri(this.providerService.createRelativeVirtualUri(e.uri,h),e.workspaceId),$=Zn.decode(await m.workspace.fs.readFile(P));return{...hr(S,I,$),baseUri:O,incomingUri:P}}catch(O){throw new Error(`Unable to apply patch to ${h}: ${String(O)}`)}}})}async applyPatch(t,e,r){if(L.log(`ChangeStore.applyPatch(${t.toString()})`,r==null?void 0:r.save),!e.startsWith("diff --"))throw new Error("Invalid patch");return this.applyPatchCore(t,e,r)}async applyPatchCore(t,e,r={}){const n=`ChangeStore.applyPatchCore(${t.toString()})`;L.debug(n,r==null?void 0:r.save);const i=new m.WorkspaceEdit,o=[],c=new Map;async function l(I){var P;const $=te(I),N=m.workspace.textDocuments.find(U=>te(U.uri)===$);return(P=N==null?void 0:N.getText())!=null?P:Zn.decode(await m.workspace.fs.readFile(I))}a(l,"getContent");async function d(I){try{const P=await m.workspace.fs.stat(I);return Boolean(P)}catch{return!1}}a(d,"exists");async function h(I,P,$){let N=Ar("",$,{fuzzFactor:0});if(N===!1){if(!r.getIncomingContent)throw new Error(`Unable to apply patch to ${P}`);N=await r.getIncomingContent(P)}i.createFile(I,{overwrite:!0}),i.replace(I,new m.Range(0,0,Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),N)}a(h,"applyCreate");async function S(I,P,$,N){const U=await l(I);let W=Ar(U,$,{fuzzFactor:1});if(W===!1){if(r.merge===void 0)throw new Error(`Unable to apply patch to ${P}; Resulted in conflicts`);const V={title:On("apply patch failed prompt confirm","Merge")},ie={title:On("apply patch failed prompt cancel","Skip File"),isCloseAffordance:!0};if(await m.window.showWarningMessage(On("apply patch failed prompt",`Unable to apply changes to '{0}'.

Do you want to retry by merging the files?`,P),{modal:!0,useCustom:!0},V,ie)!==V)return;const ge=await r.merge(I,P,U);W=ge.mergedContent,ge.conflicts&&c.set(te(I),{type:N,baseUri:ge.baseUri,incomingUri:ge.incomingUri})}i.replace(I,new m.Range(0,0,Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),W)}a(S,"applyModification");const O=(r==null?void 0:r.reverse)?Rr(e,{}):Rn(e,{});for(const I of O)if(I.oldFileName==="/dev/null"){if(!I.newFileName)continue;const P=I.newFileName.startsWith("b/")?I.newFileName.substr(2):I.newFileName,$=this.providerService.createRelativeVirtualUri(t,P);o.push(te($)),!await d($)?await h($,P,I):await S($,P,I,2)}else if(I.newFileName==="/dev/null"){if(!I.oldFileName)continue;const P=I.oldFileName.startsWith("a/")?I.oldFileName.substr(2):I.oldFileName,$=this.providerService.createRelativeVirtualUri(t,P);await d($)&&i.deleteFile($)}else if(I.oldFileName===I.newFileName){if(!I.newFileName)continue;const P=this.providerService.createRelativeVirtualUri(t,I.newFileName);o.push(te(P)),!await d(P)?await h(P,I.newFileName,I):await S(P,I.newFileName,I,1)}else throw new Error(`Unable to apply patch to ${I.oldFileName}; Renames aren't currently supported`);if(await m.workspace.applyEdit(i),r.save&&o.length)for(const I of o){const P=m.workspace.textDocuments.find($=>te($.uri)===I);await(P==null?void 0:P.save())}c.size&&setTimeout(async()=>{const I=[];await this.lock.synchronizeWrite(te(t),async()=>{const P=await this.getWorkingOperations(t);if(P.length===0)return;let $=-1;for(const N of P){$++;const U=c.get(te(N.uri));U!==void 0&&await this.spliceOperation(N.uri,$,{...N,conflicts:{baseUri:U.baseUri,incomingUri:U.incomingUri,status:[N.type,U.type]},timestamp:Date.now()},I)}},n),I.length!==0&&this._onDidChange.fire(I)},0)}async createChangeset(t){L.log(`ChangeStore.createChangeset${t.toString()})`);const e=await this.createPatch(t);return e?{workspaceId:this.workspaceId,uri:t,patch:e}:void 0}async createPatch(t,e,r){if(L.log(`ChangeStore.createPatch${t.toString()})`,e),e===void 0){let o=await this.getWorkingOperations(t);if((r==null?void 0:r.staged)&&(o=o.filter(l=>l.staged)),o.length===0)return"";const c=[];for(const l of o){const d=await this.createPatchCore(t,l);c.push(d)}return c.join("")}const{operation:n}=await this.getWorkingOperation(e,t);if(n===void 0)throw new Error(`Unable to create patch for ${e.toString()}`);return(r==null?void 0:r.staged)&&n.staged?"":await this.createPatchCore(t,n)}async createPatchCore(t,e){const r=this.providerService.getRelativeFilePath(t,e.uri),n=`diff --git a/${r} b/${r}`;if(e.type===2){let d=await this.getContent(e.uri),h;!d.endsWith(`
`)&&!d.endsWith(`\r
`)?h=`
\\ No newline at end of file`:h="";let S=0;return d=d.replace(/\r?\n/g,O=>(S++,`${O}+`)),`${n}
new file mode 100644
--- /dev/null
+++ b/${r}
@@ -0,0 +1,${S} @@
+${d}${h}`}if(e.type===3){let d=Zn.decode(await m.workspace.fs.readFile(this.providerService.getProviderUri(e.uri))),h=0;return d=d.replace(/\r?\n/g,S=>(h++,`${S}-`)),`${n}
deleted file mode 100644
--- a/${r}
+++ /dev/null
@@ -1,${h} +0,0 @@
-${d}`}const i=await this.getContent(e.uri),o=Zn.decode(await m.workspace.fs.readFile(this.providerService.getProviderUri(e.uri))),c=Co(r,o,i),l=c.indexOf(_l);return`${n}
${c.substr(l+_l.length)}`}async keep(t,e){const r=this.providerService.getVirtualWorkspaceUri(t);if(r===void 0)return;const n=`ChangeStore.keep(${t.toString()})`;L.log(n,e);const i=[];await this.lock.synchronizeWrite(te(r),async()=>{const{operation:o,index:c}=await this.getWorkingOperation(t,r);if(o===void 0)return;if(e===void 0&&o.conflicts){const[,d]=o.conflicts.status;switch(d){case 1:switch(o.type){case 1:case 2:case 3:await this.spliceOperation(t,c,{...o,conflicts:void 0,timestamp:Date.now()},i);break}break;case 2:switch(o.type){case 1:case 3:await this.spliceOperation(t,c,{...o,conflicts:void 0,timestamp:Date.now()},i);break;case 2:await this.spliceOperation(t,c,{...o,type:1,size:o.size,hash:o.hash,originalHash:o.originalHash,conflicts:void 0,timestamp:Date.now()},i);break}break;case 3:switch(o.type){case 3:await this.discardCore(r,t,i);break;case 1:await this.spliceOperation(t,c,{...o,type:2,originalHash:void 0,conflicts:void 0,timestamp:Date.now()},i);break;case 2:await this.spliceOperation(t,c,{...o,conflicts:void 0,timestamp:Date.now()},i);break}break}return}if(e===void 0)return;switch(e.type){case 1:switch(o.type){case 3:await this.spliceOperation(t,c,{...o,type:3,size:void 0,hash:void 0,originalHash:void 0,conflicts:void 0,timestamp:Date.now()},i);return;case 2:break;case 1:break}break;case 2:switch(o.type){case 1:case 3:return;case 2:break}break;case 3:switch(o.type){case 3:return this.discardCore(r,t,i);case 1:await this.spliceOperation(t,c,{...o,type:2,originalHash:void 0,conflicts:void 0,timestamp:Date.now()},i);return;case 2:return}}const l=e!==void 0?await m.workspace.fs.readFile(e.providerUri):void 0;await this.spliceOperation(t,c,{...o,type:1,originalHash:l!==void 0?await Yn(l):o.originalHash,conflicts:void 0,timestamp:Date.now()},i)},n),i.length!==0&&this._onDidChange.fire(i)}async merge(t,e,r){const n=this.providerService.getVirtualWorkspaceUri(t);if(n===void 0)return;const i=`ChangeStore.merge(${t.toString()})`;L.log(i,e,r);const o=[];await this.lock.synchronizeWrite(te(n),async()=>{const{operation:c,index:l}=await this.getWorkingOperation(t,n);if(c===void 0)return;switch(e.type){case 1:switch(c.type){case 3:return void this.spliceOperation(t,l,{...c,type:3,size:void 0,hash:void 0,originalHash:void 0,conflicts:{baseUri:r.providerUri,incomingUri:e.providerUri,status:[c.type,e.type]},timestamp:Date.now()},o);case 2:break;case 1:break}break;case 2:switch(c.type){case 3:case 1:return;case 2:break}break;case 3:switch(c.type){case 3:return this.discardCore(n,t,o);case 1:return void this.spliceOperation(t,l,{...c,type:2,originalHash:void 0,conflicts:{baseUri:void 0,incomingUri:e.providerUri,status:[c.type,e.type]},timestamp:Date.now()},o);case 2:return}}const d=await this.getWorkingContent(n,t),h=await m.workspace.fs.readFile(r.providerUri),S=await m.workspace.fs.readFile(e.providerUri),O=hr(Zn.decode(d),Zn.decode(h),Zn.decode(S));await this.writeFileCore(n,t,o,xu.encode(O.mergedContent),S!=null?S:new Uint8Array(0),O.conflicts?{baseUri:r.providerUri,incomingUri:e.providerUri,status:[c.type,e.type]}:void 0)},i),o.length!==0&&this._onDidChange.fire(o)}async resolveDiffCommand(t,e,r,n){let i;const o=this.providerService.getVirtualRootUri(t);return o!==void 0&&({operation:i}=await this.getWorkingOperation(t,o)),(i==null?void 0:i.type)===3?this.resolveOpenCommand(e):((i==null?void 0:i.type)===2&&(e=e.with({query:"~"})),{command:"vscode.diff",title:"Open Changes",arguments:[e,t,r,n]})}resolveOpenCommand(t,e){return{command:"vscode.open",title:"Open File",arguments:[t,e]}}getScopedUri(t,e){const r=typeof e=="string"?e:e.workspaceId;return r===this.workspaceId?t:t.with({fragment:r})}getUriScope(t){return t.fragment||void 0}getScopedChangeStore(t){const e=typeof t=="string"?t:t.workspaceId;L.log(`ChangeStore.getScopedChangeStore(${e})`);let r=this.scopedStores.get(e);return r===void 0&&(r=e===this.workspaceId?new ko.ScopedChangeStore(this,e,this.workspaceId):new ko.ScopedChangeStore(new ko(this.providerService,this.storageService.with(e),this.fileStorageService.with(e),this.telemetryService,this.workspaceId,e),e,this.workspaceId),this.scopedStores.set(e,r)),r}async stat(t){const e=this.getUriScope(t);if(e)return this.getScopedChangeStore(e).stat(t);const r=this.providerService.getVirtualRootUri(t);if(r===void 0)return;const n=te(r),i=this.cache.get(n);if((i==null?void 0:i.length)!==0)return this.lock.synchronizeRead(n,async()=>{var o;const{operation:c}=await this.getWorkingOperation(t,r);if(c!==void 0){if(c.type===3)throw m.FileSystemError.FileNotFound(`The ${c.fileType===m.FileType.Directory?"folder":"file"} has been deleted.`);return{type:c.fileType,size:(o=c.size)!=null?o:0,ctime:0,mtime:c.timestamp}}},`ChangeStore.stat(${t.toString()}`)}async readFile(t){const e=this.getUriScope(t);if(e)return this.getScopedChangeStore(e).readFile(t);const r=new ut(`ChangeStore.readFile(${t.toString()})`);try{const n=this.providerService.getVirtualRootUri(t);if(n===void 0)return;const i=te(n),o=this.cache.get(i);return(o==null?void 0:o.length)===0?void 0:await this.lock.synchronizeRead(i,()=>{const c=this.cache.get(i);if((c==null?void 0:c.length)===0){r.log({message:": Not found; no operations"});return}return this.getWorkingContent(n,t)},r.context)}finally{r.stop()}}async createDirectory(t){const e=this.providerService.getVirtualWorkspaceUri(t);if(e===void 0)return;const r=new ut(`ChangeStore.createDirectory(${t.toString()})`);try{const n=[];if(await this.lock.synchronizeWrite(te(e),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(t,e),c=await this.providerService.getMetadata(t);await this.spliceOperation(t,o,i===void 0?{type:2,uri:t,fileType:m.FileType.Directory,revision:c.HEAD.sha,timestamp:Date.now(),size:0,hash:"",originalHash:void 0}:{...i,timestamp:Date.now()},n)},r.context),n.length===0)return;this._onDidChange.fire(n)}finally{r.stop()}}async deleteDirectory(t){const e=this.providerService.getVirtualWorkspaceUri(t);if(e===void 0)return;const r=new ut(`ChangeStore.deleteDirectory(${t.toString()})`);try{const n=[];if(await this.lock.synchronizeWrite(te(e),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(t,e);if((i==null?void 0:i.type)===2)return this.discardCore(e,t,n);const c=await this.providerService.getMetadata(t);await this.spliceOperation(t,o,{type:3,uri:t,fileType:m.FileType.Directory,revision:c.HEAD.sha,timestamp:Date.now(),size:void 0,hash:void 0,originalHash:void 0},n)},r.context),n.length===0)return;this._onDidChange.fire(n)}finally{r.stop()}}async updateDirectoryEntries(t,e){const r=this.providerService.getVirtualWorkspaceUri(t);if(r===void 0)return e;const n=new ut(`ChangeStore.updateDirectoryEntries(${t.toString()})`,{},e.length);try{const i=te(r),o=this.cache.get(i);return(o==null?void 0:o.length)===0?e:await this.lock.synchronizeRead(i,async()=>{const{path:c}=We(r,t),l=await this.getWorkingOperations(r);for(const d of l)switch(d.type){case 1:break;case 2:{if(et(d.uri,c)){const h=this.providerService.getRelativeFilePath(t,d.uri);e.push([h,d.fileType])}break}case 3:{if(et(d.uri,c)){const h=this.providerService.getRelativeFilePath(t,d.uri),S=e.findIndex(([O])=>O===h);S!==-1&&e.splice(S,1)}break}}return e},n.context)}finally{n.stop()}}async writeFile(t,e,r,n){const i=this.providerService.getVirtualWorkspaceUri(t);if(i===void 0)return;const o=new ut(`ChangeStore.writeFile(${t.toString()})`,{},e.length,n);try{const c=[];if(await this.lock.synchronizeWrite(te(i),async()=>this.writeFileCore(i,t,c,e,r,n),o.context),c.length===0)return;this._onDidChange.fire(c)}finally{o.stop()}}async writeFileCore(t,e,r,n,i,o){const c=new ut(`ChangeStore.writeFileCore(${e.toString()})`,{},n.length,o);try{const[{operation:l,index:d},h,S]=await Promise.all([this.getWorkingOperation(e,t),Yn(n),Yn(i)]);if(h===S&&(l==null?void 0:l.type)===1)return this.discardCore(t,e,r);if(h===(l==null?void 0:l.hash)&&S===(l==null?void 0:l.originalHash))return;const[{HEAD:O}]=await Promise.all([this.providerService.getMetadata(e),this.saveWorkingContent(t,e,n)]);await this.spliceOperation(e,d,l===void 0?{type:1,uri:e,fileType:m.FileType.File,revision:O.sha,timestamp:Date.now(),size:n.byteLength,hash:h,originalHash:S,conflicts:o,staged:!1}:{...l,revision:O.sha,timestamp:Date.now(),size:n.byteLength,hash:h,originalHash:S,conflicts:o,staged:!1},r)}finally{c.stop()}}async createFile(t,e){const r=this.providerService.getVirtualWorkspaceUri(t);if(r===void 0)return;const n=new ut(`ChangeStore.createFile(${t.toString()})`,{},e.length);try{const i=[];if(await this.lock.synchronizeWrite(te(r),async()=>{const[{operation:o,index:c},l,d]=await Promise.all([this.getWorkingOperation(t,r),Yn(e),this.providerService.getMetadata(t),this.saveWorkingContent(r,t,e)]);await this.spliceOperation(t,c,o===void 0?{type:2,uri:t,fileType:m.FileType.File,revision:d.HEAD.sha,timestamp:Date.now(),size:e.byteLength,hash:l,originalHash:l}:{...o,type:2,revision:d.HEAD.sha,timestamp:Date.now(),size:e.byteLength,hash:l},i)},n.context),i.length===0)return;this._onDidChange.fire(i)}finally{n.stop()}}async deleteFile(t){const e=this.providerService.getVirtualWorkspaceUri(t);if(e===void 0)return;const r=new ut(`ChangeStore.deleteFile(${t.toString()})`);try{const n=[];if(await this.lock.synchronizeWrite(te(e),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(t,e);if((i==null?void 0:i.type)===2)return this.discardCore(e,t,n);const[c]=await Promise.all([this.providerService.getMetadata(t),this.discardWorkingContent(e,t)]);await this.spliceOperation(t,o,{type:3,uri:t,fileType:m.FileType.File,revision:c.HEAD.sha,timestamp:Date.now(),size:void 0,hash:void 0,originalHash:void 0},n)},r.context),n.length===0)return;this._onDidChange.fire(n)}finally{r.stop()}}findParent(t,e,r){const n=Fe(t),{operation:i,index:o}=this.findWorkingOperation(n,e);return i!==void 0&&r(i,e)?{parent:i,parentIndex:o}:{parent:void 0,parentIndex:-1}}findNewParentWithOnlyChild(t,e){const r=Te(t);return this.findParent(t,e,(n,i)=>n.type===2&&!i.some(o=>et(o.uri,n.uri)&&Te(o.uri)!==r))}async getWorkingOperation(t,e){return this.findWorkingOperation(t,await this.getWorkingOperations(e))}findWorkingOperation(t,e){if(e.length===0)return{operation:void 0,index:-1};const r=Te(t);let n=-1;const i=e.find((o,c)=>Te(o.uri)!==r?!1:(n=c,!0));return i===void 0?{operation:void 0,index:-1}:{operation:i,index:n}}async getWorkingOperations(t){const e=te(t);let r=this.cache.get(e);return r===void 0&&(r=this.fromStorage(await this.storageService.get(this.getOperationsStorageKey(e))),this.cache.set(e,r)),r}async saveWorkingOperations(t,e){L.debug(`ChangeStore.saveWorkingOperations(${t.toString()})`,e.length);const r=te(t);this.cache.set(r,e);try{await this.storageService.store(this.getOperationsStorageKey(r),this.toStorage(e))}catch(n){throw this.cache.delete(r),L.error(n,`Failed to save repository changes for ${r}`),n}}getOperationsStorageKey(t){return`operations/${t}`}async getWorkingContent(t,e){try{return await this.fileStorageService.get(this.getFileStorageKey(t,e))}catch(r){throw L.error(r),this.telemetryService.sendException(r),r}}async discardWorkingContent(t,e){L.debug(`ChangeStore.discardWorkingContent(${e.toString()})`);try{return await this.fileStorageService.delete(this.getFileStorageKey(t,e))}catch(r){if(r instanceof m.FileSystemError&&r.code===Eu)return;throw L.error(r),this.telemetryService.sendException(r),r}}async saveWorkingContent(t,e,r){L.debug(`ChangeStore.saveWorkingContent(${e.toString()})`,r.length);try{return await this.fileStorageService.store(this.getFileStorageKey(t,e),r)}catch(n){throw L.error(n),this.telemetryService.sendException(n),n}}getFileStorageKey(t,e){return`changestore/${le(e)}`}async spliceOperation(t,e,r,n){const i=this.providerService.getVirtualWorkspaceUri(t);if(i===void 0)return;const o=await this.getWorkingOperations(i);e!==-1?o.splice(e,1,r):o.push(r),await this.saveWorkingOperations(i,o),n.push(ga(r,i,t))}fromStorage(t){if(!t)return[];try{const e=JSON.parse(t,(r,n)=>(r==="uri"||r.endsWith("Uri"))&&Ue(n)?typeof n=="string"?m.Uri.parse(n):m.Uri.from(n):n);return Array.isArray(e)?e:e.operations}catch(e){throw L.error(e,"Failed to deserialize ChangeStore operations"),e}}toStorage(t){const e={schemaVersion:ko.operationsStorageSchemaVersion,operations:t};return JSON.stringify(e)}},"_ChangeStore");let ma=ko;ma.operationsStorageSchemaVersion=1,ma.ScopedChangeStore=class{constructor(t,e,r){this.changeStore=t,this.scope=e,this.workspaceId=r}createPatch(t,e,r){return this.changeStore.createPatch(this.stripUriScope(t),this.stripUriScope(e),r)}discardAll(t,e){return this.changeStore.discardAll(this.stripUriScope(t),e)}getChange(t){return this.changeStore.getChange(this.stripUriScope(t))}getChanges(t,e){return this.changeStore.getChanges(this.stripUriScope(t),e)}async getGroupedChanges(t,e){return this.changeStore.getGroupedChanges(this.stripUriScope(t),e)}hasChanges(t){return this.changeStore.hasChanges(this.stripUriScope(t))}maybeHasChanges(t,e){return this.changeStore.maybeHasChanges(this.stripUriScope(t),this.stripUriScope(e))}async stat(t){const r=this.changeStore.getUriScope(t)!==this.workspaceId,n=await this.changeStore.stat(this.stripUriScope(t));return n!==void 0&&r&&(n.permissions=m.FilePermission.Readonly),n}readFile(t){return this.changeStore.readFile(this.stripUriScope(t))}resolveDiffCommand(t,e,r,n){return this.changeStore.resolveDiffCommand(this.changeStore.getScopedUri(t,this.scope),this.changeStore.getScopedUri(e,this.scope),r,n)}stripUriScope(t){return t===void 0||!t.fragment?t:t.with({fragment:""})}},Su([tr()],ma.prototype,"getWorkingOperations",1);function wl(t){switch(t){case 1:return On("change type changed","Modified");case 2:return On("change type created","Added");case 3:return On("change type deleted","Deleted")}}a(wl,"getStatusText");function Tu(t){const[e,r]=t;switch(e){case 1:switch(r){case 1:case 2:return On("conflict status changed both","Modified by Both");case 3:return On("conflict status deleted them","Deleted by Incoming")}break;case 2:switch(r){case 1:case 2:return On("conflict status created both","Added by Both");case 3:return On("conflict status deleted them","Deleted by Incoming")}break;case 3:switch(r){case 1:case 2:return On("conflict status deleted us","Deleted by Current");case 3:return On("conflict status deleted both","Deleted by Both")}break}}a(Tu,"getConflictStatusText");var Au=__webpack_require__(8361),Ru=__webpack_require__.n(Au);const Iu="Type of classified event does not match event properties",uc=a(class{constructor(t){this.sharedProperties={},uc._instance=this,this.reporter=new(Ru())(t.extension.id,t.extension.packageJSON.version,uc.aiKey,!0)}static get instance(){return this._instance}dispose(){this.reporter.dispose()}publicLog2(t,e){e!==Iu&&this.reporter.sendTelemetryEvent(t,{...this.sharedProperties,...e})}sendEvent(t,e,r){this.reporter.sendTelemetryEvent(t,{...this.sharedProperties,...e},r)}sendErrorEvent(t,e,r){this.reporter.sendTelemetryErrorEvent(t,{...this.sharedProperties,...e},r)}sendException(t,e,r){this.reporter.sendTelemetryException(t,{...this.sharedProperties,...e},r)}setSharedProperty(t,e){this.sharedProperties[t]=e}},"_TelemetryService");let va=uc;va.aiKey="AIF-d9b70cd4-b9f9-4d70-929b-a071c400b217";function Ou(t,e){m.env.appHost==="github.dev"&&(L.debug(`Executing ${t}`),e={...e,errorDetail:e.errorDetail instanceof Error?e.errorDetail.name:void 0},m.commands.executeCommand(t,e).then(r=>{},r=>{L.debug(`Failed to execute ${t}`,r)}))}a(Ou,"reportWorkbenchLoadResult");function Pu(t,e){if(t===e)return-1;let r=0;for(;t[r]===e[r];)r++;return r}a(Pu,"indexOfDifference");const ls=(0,B.loadMessageBundle)();let $n;var dc;(function(t){function e(r){const n=Sl(r);return $n=m.env.uiKind===m.UIKind.Web,L.warn(`Running on the ${$n?"web":"desktop"}${r.extensionRuntime!==m.ExtensionRuntime.Node?" in a webworker":""}; workspaceId=${n}; storageUri=${r.globalStorageUri.toString(!0)}`),n}a(e,"configure"),t.configure=e})(dc||(dc={}));function Du(){var t,e;return(e=(t=m.workspace.workspaceFolders)==null?void 0:t.every(r=>r.uri.scheme===Qt.scheme))!=null?e:!1}a(Du,"isVirtualWorkspace");var $t;(function(t){t.CurrentWindow="currentWindow",t.NewWindow="newWindow",t.AddToWorkspace="addToWorkspace"})($t||($t={}));const bl=/\/workspaceStorage\/(?<id>[^/]+)/i;function Sl(t){var e;if(t.storageUri===void 0)return"";const r=bl.exec(t.storageUri.path);let n;if((e=r==null?void 0:r.groups)==null?void 0:e.id)n=r.groups.id;else{n=t.storageUri.path;const i=Pu(t.globalStorageUri.path,n),o=`/${t.extension.id}`;n.endsWith(o)?n=n.slice(i,-o.length):n=n.substr(i)}return/-[0-9]$/.test(n)?n.slice(0,-2):n}a(Sl,"getWorkspaceId");async function gn(t,e){var r,n,i,o,c;if(va.instance.sendEvent("openWorkspace",{location:t.location}),t.location===$t.AddToWorkspace){const d=(n=(r=m.workspace.workspaceFolders)==null?void 0:r.length)!=null?n:0;return void m.workspace.updateWorkspaceFolders(d,0,{uri:t.uri,name:t.name})}if(t.location===$t.CurrentWindow&&!(e==null?void 0:e.skipChangesPrompt)){const d=await ma.instance.getWorkspaceProvidersWithChanges();if(d.length){const h={title:ls("continue","Continue")},S={title:ls("cancel","Cancel"),isCloseAffordance:!0};if(await m.window.showWarningMessage($n?ls("open folder uncommitted changes web",`You have uncommitted changes.

If you want to see your changes on {0} or from other browsers or machines, commit them before leaving this workspace. Otherwise, you can re-open this workspace anytime and pick up right where you left off.

Do you want to continue opening a new workspace?`,d.map(I=>I.name).join(", ")):ls("open folder uncommitted changes",`You have uncommitted changes.

If you want to see your changes on {0} or from other machines, commit them before leaving this workspace. Otherwise, you can re-open this workspace anytime and pick up right where you left off.

Do you want to continue opening a new workspace?`,d.map(I=>I.name).join(", ")),{modal:!0,useCustom:!0},h,S)!==h){va.instance.sendEvent("openWorkspace.abort",{reason:"abandoned uncommitted changes prompt"});return}}}const l=m.env.remoteName?!0:void 0;return t.filesToOpen&&(t.location===$t.CurrentWindow&&l===void 0&&((i=m.workspace.workspaceFolders)==null?void 0:i.length)===1&&m.workspace.workspaceFolders[0].uri.toString()===t.uri.toString()?await((o=wu())==null?void 0:o.openPendingFiles(t.uri,t.filesToOpen)):await((c=wu())==null?void 0:c.setPendingFilesToOpen(t.uri,t.filesToOpen))),va.instance.sendEvent("openWorkspace.success",{location:t.location,forceLocalWindow:String(l)}),void m.commands.executeCommand("vscode.openFolder",t.uri,{forceNewWindow:t.location===$t.NewWindow,forceLocalWindow:l})}a(gn,"openWorkspace");var Pn;(function(t){t.HasVirtualFolders="remoteHub:hasVirtualFolders",t.HasSearchIndexes="remoteHub:hasSearchIndexes",t.EnabledSomeSearchIndexes="remoteHub:enabledSomeSearchIndexes",t.EnabledAllSearchIndexes="remoteHub:enabledAllSearchIndexes",t.VirtualFolderProviders="remoteHub:virtualFolderProviders",t.HasPullRequestExtension="remoteHub:hasPullRequestExtension",t.HasWriteableScmProvider="remoteHub:hasWriteableScmProvider",t.HasRecentRepositories="remoteHub:hasRecentRepositories"})(Pn||(Pn={}));const El=new Map;function No(t){return t==="isWeb"?$n:t==="remoteName"?m.env.remoteName:t==="virtualWorkspace"?Du():t.startsWith("config.")?Y.getAny(t.substr(7)):El.get(t)}a(No,"getContext");function Mo(t){return t==="isWeb"||t==="remoteName"||t==="virtualWorkspace"||t.startsWith("config.")||t.startsWith("remoteHub:")||t.startsWith("continueOn:")}a(Mo,"isSupportedContextKey");async function Si(t,e){El.set(t,e),!t.startsWith("continueOn:")&&await m.commands.executeCommand("setContext",t,e)}a(Si,"setContext");class hc{constructor(e){this.menuItem=e}get label(){return`${this.menuItem.icon?`${this.menuItem.icon} `:""}${this.menuItem.title}`}get description(){return this.menuItem.extension.builtin?"Built-in":this.menuItem.extension.name||this.menuItem.extension.id}async execute(e){return void await m.commands.executeCommand(this.menuItem.command,e)}}a(hc,"ContinueOnCommandQuickPickItem");var fc;(function(t){async function e(r,n,i){const o=xl(r).map(d=>new hc(d)),c=m.window.createQuickPick(),l=[];try{return await new Promise(h=>{l.push(c.onDidHide(()=>h(void 0)),c.onDidAccept(()=>{if(c.activeItems.length!==0){const[S]=c.activeItems;h(S)}})),c.title=i,c.placeholder=n,c.items=o,c.show()})}finally{c.dispose(),l.forEach(d=>void d.dispose())}}a(e,"show"),t.show=e})(fc||(fc={}));function xl(t){var e,r,n,i,o;const c=new Map,[,l]=t.split(".");for(const h of m.extensions.all){const{name:S,displayName:O,contributes:I}=h.packageJSON;if(!I)continue;const P=(r=(e=I.virtualWorkspaces)==null?void 0:e.menus)==null?void 0:r.continueOn;if(P==null?void 0:P.length){const $=new Map(((n=I.commands)!=null?n:[]).map(N=>[N.command,N]));for(const N of P){if(!N.command)continue;if(c.has(N.command)){L.warn(`Duplicate 'continueOn' menu command: ${N.command}`);continue}const U=$.get(N.command);if(!U){L.warn(`Unable to find 'continueOn' menu command: ${N.command}`);continue}if(!ku(N.when))continue;const W=(o=(i=N.group)==null?void 0:i.lastIndexOf("@"))!=null?o:-1;c.set(N.command,{extension:{id:S,name:O,builtin:S===l},command:U.command,title:U.title,icon:typeof U.icon=="string"?U.icon:void 0,group:W>0?N.group.substr(0,W):N.group,order:W>0?Number(N.group.substr(W+1)):0,category:U.category})}}}function d(h,S){const O=h.group,I=S.group;if(O!==I){if(!O)return 1;if(!I||O==="navigation")return-1;if(I==="navigation")return 1;const P=O.localeCompare(I);if(P!==0)return P}return h.order<S.order?-1:h.order>S.order?1:h.title.localeCompare(S.title)}return a(d,"compareMenuItems"),[...c.values()].sort(d)}a(xl,"getContinueOnContributions");function ku(t){return t?t.split("&&").every(e=>{const r=/^(?:(!)?(\S+)|(\S+)\s?(==|!=|=~)\s?(\S+))$/.exec(e.trim());if(!r)return!0;const[,n,i,o,c,l]=r;if(i){if(i==="false")return!1;if(!Mo(i))return!0;const d=No(i);return n?!d:d}if(o&&c&&l)switch(c){case"==":return!Mo(o)||!Mo(l)||No(o)==No(l);case"!=":return!Mo(o)||!Mo(l)||No(o)!=No(l);case"=~":{if(!Mo(o))return!0;const d=No(o);try{return new RegExp(l.slice(1,-1)).test(String(d!=null?d:""))}catch{return!1}}}return!0}):!0}a(ku,"evaluateWhenClause");class us{constructor(e){this.defaultDelay=e}dispose(){this.cancelTimeout()}debounce(e,r=this.defaultDelay){return this.task=e,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((n,i)=>{this.resolver=n,this.rejecter=i}).then(()=>{if(this.completionPromise=void 0,this.resolver=void 0,this.task){const n=this.task;return this.task=void 0,n()}})),this.timeout=setTimeout(()=>{var n;this.timeout=void 0,(n=this.resolver)==null||n.call(this,void 0)},r),this.completionPromise}cancel(){var e;this.cancelTimeout(),this.completionPromise&&((e=this.rejecter)==null||e.call(this,new Error("Canceled")),this.completionPromise=void 0)}cancelTimeout(){this.timeout!==void 0&&(clearTimeout(this.timeout),this.timeout=void 0)}}a(us,"TaskDebouncer");const Jn=(0,B.loadMessageBundle)(),pc=Symbol("QuickPickGoBack");var gc;(function(t){async function e(r,n,i,o,c,l){const d=r.getRemoteWorkspaceSourceProviders();let h=[];d.length===0?h=[]:h=d.map($=>new mc($));const S=await n.getRemoteWorkspaceSourceProvider();if(S){const $=await S.provideSources();$&&h.push(...$.filter(N=>Y.get("azureRepos.enabled")?!0:N.providerId==="github").map(N=>({label:`${N.icon?`${N.icon} `:""}${N.name}`,description:N.description,detail:N.detail,url:N.url,workspace:N.url?void 0:N.workspace,buttons:[Fn.OpenInNewWindow]})))}const O=m.window.createQuickPick();O.ignoreFocusOut=!0;const I=[];let P=i;try{for(;;){const $=await new Promise(N=>{I.push(O.onDidHide(()=>N(void 0)),O.onDidChangeValue(U=>{U=U.trim(),U.length===0?O.items=h:O.activeItems.length===0||O.activeItems[0]instanceof Lo?O.items=[new Lo(r,U),...h]:O.items=h}),O.onDidAccept(()=>{if(O.activeItems.length!==0){const[U]=O.activeItems;(!(U instanceof Lo)||U.validate())&&N(U)}}),O.onDidChangeActive(()=>{if(P!==void 0||!(l==null?void 0:l.allowAddToWorkspace))return;const[U]=O.activeItems;let W=!0;if(U===void 0?W=Boolean(O.value):W=U instanceof Lo,W){if(O.buttons.length===1)return;O.buttons=[Fn.AddToWorkspace]}else{if(O.buttons.length===0)return;O.buttons=[]}}),O.onDidTriggerButton(U=>{if(U===Fn.AddToWorkspace){const[W]=O.activeItems;if(!(W instanceof Lo))return;W.validate()&&(P=$t.AddToWorkspace,N(W))}}),O.onDidTriggerItemButton(U=>{switch(U.button){case Fn.OpenInNewWindow:P=$t.NewWindow,N(U.item);break;default:break}})),O.title=c,O.placeholder=o,O.matchOnDescription=!0,O.items=h,O.sortByLabel=!1,O.show()});if($ instanceof mc){const N=await $.show(P,$.placeholder,c,l);if(N===pc)continue;return N}return[$,P]}}finally{O.dispose(),I.forEach($=>void $.dispose())}}a(e,"show"),t.show=e})(gc||(gc={}));class mc{constructor(e){this.provider=e}get label(){return`${this.provider.icon?`${this.provider.icon} `:""}${this.provider.label}`}get placeholder(){return this.provider.placeholder}async show(e,r,n,i){const o=m.window.createQuickPick(),c=new us(500),l=[c];async function d(U,W,V,ie,oe){const ge=await U.provideSources(W,V,ie,oe);return ge==null?void 0:ge.map(ke=>({label:`${ke.icon?`${ke.icon} `:""}${ke.name}`,description:ke.description,detail:ke.detail,url:ke.url,workspace:ke.workspace,buttons:[Fn.OpenInNewWindow]}))}a(d,"getItems");async function h(U){var W;P=void 0;const V=o.activeItems;o.items=(W=U!=null?U:await N)!=null?W:[],I&&V.length!==0&&(o.activeItems=o.items.filter(ie=>V.some(oe=>oe.url===ie.url))),o.busy=!1}a(h,"setItems");let S,O;if(this.provider.provideOrganization&&this.provider.provideProject){if(S=await this.provider.provideOrganization(),!S)return[void 0,void 0];if(O=await this.provider.provideProject(S),!O)return[void 0,void 0]}let I=!1,P,$=e;const N=d(this.provider,S,O,void 0,{sort:"updated"});try{const U=await new Promise(W=>{l.push(o.onDidHide(()=>W(void 0)),o.onDidChangeValue(V=>{I=!1,V=V.trim(),o.busy=!0;const ie=c.debounce(V?()=>d(this.provider,S,O,V,{sort:"stars"}):()=>N);P===void 0&&(P=ie.then(oe=>h(oe)))}),o.onDidAccept(()=>{if(o.activeItems.length!==0){const[V]=o.activeItems;W(V)}}),o.onDidChangeActive(()=>{if(I=o.activeItems.length!==0,$!==void 0||!(i==null?void 0:i.allowAddToWorkspace))return;const[V]=o.activeItems;if(V===void 0){if(o.buttons.length===1)return;o.buttons=[m.QuickInputButtons.Back]}else{if(o.buttons.length===2)return;o.buttons=[m.QuickInputButtons.Back,Fn.AddToWorkspace]}}),o.onDidTriggerButton(V=>{if(V===m.QuickInputButtons.Back){W(pc);return}if(V===Fn.AddToWorkspace){const[ie]=o.activeItems;if(ie===void 0)return;$=$t.AddToWorkspace,W(ie)}}),o.onDidTriggerItemButton(V=>{switch(V.button){case Fn.OpenInNewWindow:$=$t.NewWindow,W(V.item);break;default:break}})),o.title=n,o.placeholder=r,o.matchOnDetail=!0,o.ignoreFocusOut=!0,o.sortByLabel=!1,o.buttons=[m.QuickInputButtons.Back],o.busy=!0,o.show(),P=c.debounce(()=>N,0).then(V=>h(V))});return U===pc?U:[U,$]}finally{o.dispose(),l.forEach(U=>void U.dispose())}}}a(mc,"RemoteSourceProviderPickerItem");class Lo{constructor(e,r){this.url=r,this.alwaysShow=!0,this.canOpenResult=e.canOpenRemoteUrl(r)}get buttons(){return[Fn.OpenInNewWindow]}get label(){if(this.canOpenResult){const{provider:e,urlType:r}=this.canOpenResult;switch(r){case nt.Branch:return Jn("remote url picker open branch","Open Branch from {0} Repository",e.name);case nt.Tag:return Jn("remote url picker open tag","Open Tag from {0} Repository",e.name);case nt.Commit:return Jn("remote url picker open commit","Open Commit from {0} Repository",e.name);case nt.File:return Jn("remote url picker open file","Open File from {0} Repository",e.name);case nt.PullRequest:return Jn("remote url picker open pull request","Open Pull Request from {0} Repository",e.name);default:return Jn("remote url picker open repository","Open {0} Repository",e.name)}}return Jn("remote url picker open unknown","Enter a Remote Url")}get description(){return this.url}validate(){return this.canOpenResult!==void 0}}a(Lo,"RemoteUrlQuickPickItem");var Fn;(function(t){t.AddToWorkspace={iconPath:new m.ThemeIcon("plus"),tooltip:Jn("remote url picker button add to workspace","Add to Workspace")},t.OpenInNewWindow={iconPath:new m.ThemeIcon("empty-window"),tooltip:Jn("remote picker open in new window","Open in New Window")}})(Fn||(Fn={}));var Nu=Object.defineProperty,Mu=Object.getOwnPropertyDescriptor,mn=a((t,e,r,n)=>{for(var i=n>1?void 0:n?Mu(e,r):e,o=t.length-1,c;o>=0;o--)(c=t[o])&&(i=(n?c(e,r,i):c(i))||i);return n&&i&&Nu(e,r,i),i},"messages_decorateClass");const br=(0,B.loadMessageBundle)();class Bn{showGitHubStatus500Message(){return m.window.showErrorMessage(br("github 500 error notification","GitHub failed to respond and might be experiencing issues. Visit the [GitHub status page](https://githubstatus.com) for more information."),br("ok","OK")),Promise.resolve()}async showStatus401Message(e){if(!e)return void m.window.showErrorMessage(br("401 error notification","The provided credentials are either invalid or expired."),br("ok","OK"));const r=br("401 error notification confirm","Reauthenticate");await m.window.showErrorMessage(br("401 error notification with reauth","The provided credentials are either invalid or expired. Would you like to reauthenticate?"),r)===r&&e()}async showStatus403Message(e){if(!e)return void m.window.showErrorMessage(br("403 error notification","The provided credentials do not have the required access."),br("ok","OK"));const r=br("403 error notification confirm","Reauthenticate");await m.window.showErrorMessage(br("403 error notification with reauth","The provided credentials do not have the required access. Would you like to reauthenticate to grant additional access?"),r)===r&&e()}async showRepositoryEmptyMessage(e){const r=br("repository empty open","Open Repository");await m.window.showErrorMessage(br("repository empty","Repository '{0}' is empty and cannot be opened. Would you like to open another repository?",e),r)===r&&m.commands.executeCommand("remoteHub.openRepository")}async showPullRequestNotFoundMessage(e,r){const n=br("pull request not found open","Open Pull Request");await m.window.showErrorMessage(br("pull request not found","Unable to find pull request {1} on repository '{0}'. Would you like to open another pull request?",e,r),n)===n&&m.commands.executeCommand("remoteHub.openRepository")}async showPullRequestHeadNotFoundMessage(e,r){const n=br("pull request head not found ok","OK");await m.window.showWarningMessage(br("pull request head not found","Unable to find the source branch for pull request {1} on repository '{0}'.",e,r),n)}async showRepositoryForbiddenMessage(e){const r=br("repository forbidden open","Open Repository");await m.window.showErrorMessage(br("repository forbidden","You don't have access to repository '{0}'. Would you like to open another repository?",e),r)===r&&m.commands.executeCommand("remoteHub.openRepository")}async showRepositoryNotFoundMessage(e){const r=br("repository not found confirm","Open Repository");await m.window.showErrorMessage(br("repository not found","Unable to find repository '{0}'. Would you like to open another repository?",e),r)===r&&m.commands.executeCommand("remoteHub.openRepository")}async showUnableToOpenRepositoryMessage(e){const r=br("unable to open repo confirm","Open Repository");await m.window.showErrorMessage(br("unable to open repo","Unable to open repository. {0}. Would you like to open another repository?",String(e)),r)===r&&m.commands.executeCommand("remoteHub.openRepository")}}a(Bn,"Messages"),mn([tr(()=>"")],Bn.prototype,"showGitHubStatus500Message",1),mn([tr(()=>"")],Bn.prototype,"showStatus401Message",1),mn([tr(()=>"")],Bn.prototype,"showStatus403Message",1),mn([tr()],Bn.prototype,"showRepositoryEmptyMessage",1),mn([tr()],Bn.prototype,"showPullRequestNotFoundMessage",1),mn([tr()],Bn.prototype,"showPullRequestHeadNotFoundMessage",1),mn([tr()],Bn.prototype,"showRepositoryForbiddenMessage",1),mn([tr()],Bn.prototype,"showRepositoryNotFoundMessage",1),mn([tr()],Bn.prototype,"showUnableToOpenRepositoryMessage",1);const Xr=new Bn,Or=(0,B.loadMessageBundle)();function Lu(t,e,r,n,i){async function o(l){const[d,h]=await gc.show(t,r,l,Or("open repo placeholder","Enter a remote url, or select a remote provider"),l===$t.AddToWorkspace?Or("open repo title add to workspace","Add Remote Repository to Workspace"):Or("open repo title current window","Open Remote Repository"),{allowAddToWorkspace:!1});if(!d){i.sendEvent("openRepository.abort",{reason:"abandoned"});return}try{let S;if(d.workspace)S=d.workspace,S.location=h!=null?h:S.location;else if(S=await t.createWorkspaceForRemoteUrl(d.url,void 0,h!=null?h:l),!S){i.sendEvent("openRepository.abort",{reason:"aborted invalid url"});return}await gn(S)}catch(S){if(i.sendException(S),S instanceof pt){const{reauthenticate:O}=S;Xr.showStatus401Message(()=>O());return}if(S instanceof Pt){Xr.showRepositoryNotFoundMessage(S.name);return}if(S instanceof xe){Xr.showRepositoryForbiddenMessage(S.name);return}if(S instanceof ht){Xr.showRepositoryEmptyMessage(S.name);return}if(S instanceof It){Xr.showPullRequestNotFoundMessage(S.name,S.id);return}L.error(S)}}a(o,"openRepository");async function c(l,d,h){if(h==null?void 0:h.workspaceFolder){const O=t.getRepository(h.workspaceFolder,d);if(O!==void 0)return O}const S=d?t.repositories.filter(O=>O.provider.id===d):t.repositories;if(S.length!==0){if(S.length>1){const O=await m.window.showQuickPick(S.map(I=>({label:I.name,description:I.provider.name,repository:I})),{placeHolder:l});return O?O.repository:void 0}return S[0]}}return a(c,"getRepository"),[m.commands.registerCommand("remoteHub.openRepository",()=>(i.sendEvent("command.openRepository"),o())),m.commands.registerCommand("remoteHub.continueOn.openRepository",()=>(i.sendEvent("command.continueOn.openRepository"),o())),m.commands.registerCommand("remoteHub.addRepositoryToWorkspace",()=>{i.sendEvent("command.continueOn.openRepository")}),m.commands.registerCommand("remoteHub.continueOn.addRepositoryToWorkspace",()=>{i.sendEvent("command.continueOn.openRepository")}),m.commands.registerCommand("remoteHub.continueOn",async()=>{const l=await c(Or("continue on choose repository placeholder","Choose which repository to continue working on elsewhere"));if(l===void 0)return;i.sendEvent("command.continueOn");const d=await fc.show(n,Or("continue on placeholder","Choose how you would like to continue working"),Or("continue on title","Continue '{0}' on",l.name));if(!d){i.sendEvent("command.continueOn.abort",{reason:"abandoned"});return}if(await e.hasChanges(l.uri)){const O={title:Or("continue","Continue")},I={title:Or("cancel","Cancel"),isCloseAffordance:!0};if(await m.window.showWarningMessage(Or("continue on uncommitted changes",`You have uncommitted changes.

Unless you commit those changes, you won't be able see them from elsewhere.`),{modal:!0,useCustom:!0},O,I)!==O){i.sendEvent("command.continueOn.abort",{reason:"abandoned uncommitted changes prompt"});return}}const h=t.getRemoteUri(l.provider.id,{repo:l.id}),{HEAD:S}=await l.getMetadata();await d.execute({provider:l.provider,workspaceFolder:l.uri,name:l.name,url:h==null?void 0:h.toString(!0),ref:S.name})}),m.commands.registerCommand("remoteHub.openOnDesktop",async l=>{if(!$n)return;const d=await c(Or("continue on desktop choose repository placeholder","Choose which repository to open on the desktop"),void 0,l);if(d===void 0)return;const h=await t.getBestRemoteUri(d.uri);h!==void 0&&(i.sendEvent("command.openOnDesktop"),m.env.openExternal(m.Uri.parse(`${m.env.uriScheme}://${n}/open?url=${encodeURIComponent(h.toString(!0))}`)))}),m.commands.registerCommand("remoteHub.openOnWeb",async l=>{if($n)return;const d=await c(Or("continue on web choose repository placeholder","Choose which repository to open on the web"),void 0,l);if(d===void 0)return;const h=await t.getBestRemoteUri(d.uri);h!==void 0&&(i.sendEvent("command.openOnWeb"),m.env.openExternal(h))}),m.commands.registerCommand("remoteHub.goToRepository",async()=>{var l,d,h;i.sendEvent("command.goToRepository");const S=await c(Or("open on remote choose repository placeholder","Choose which repository to open on the remote"));if(!S)return;const O=await t.getMetadata(S.uri);let I;const P={provider:S.provider,repo:S.id,path:((l=m.window.activeTextEditor)==null?void 0:l.document.uri)?t.getRelativeFilePath((d=m.window.activeTextEditor)==null?void 0:d.document.uri):void 0};return O.HEAD.type===Pe.Branch&&(((h=m.window.activeTextEditor)==null?void 0:h.document)||O.defaultBranch.name!==O.HEAD.name)?I={...P,branch:O.HEAD.name}:O.HEAD.type===Pe.Tag?I={...P,tag:O.HEAD.name}:O.HEAD.type===Pe.Commit?I={...P,sha:O.HEAD.name}:I={...P},m.commands.executeCommand("remoteHub.openOnRemote",I)}),m.commands.registerCommand("remoteHub.openOnRemote",async l=>{i.sendEvent("command.openOnRemote");const{provider:d,...h}=l,S=t.getRemoteUri(d.id,h);if(S){await m.env.openExternal(S);return}m.window.showErrorMessage(Or("open on remote command provider not supported","Unable to open the resource on {0}",l.provider.name))}),m.commands.registerCommand("remoteHub.clone",async l=>{const d=await c(Or("clone placeholder","Choose which repository to clone"),void 0,l);if(d!==void 0){if(i.sendEvent("command.clone"),l===void 0&&await e.hasChanges(d.uri)){const h={title:Or("continue","Continue")},S={title:Or("cancel","Cancel"),isCloseAffordance:!0};if(await m.window.showWarningMessage(Or("clone uncommitted changes",`You have uncommitted changes.

Unless you commit those changes, you won't be able see them in your local clone.`),{modal:!0,useCustom:!0},h,S)!==h){i.sendEvent("command.clone.abort",{reason:"abandoned uncommitted changes prompt"});return}}await t.clone(d.uri)}}),m.commands.registerCommand("remoteHub.refresh",()=>void t.refresh()),m.commands.registerCommand("remoteHub.enableDebugLogging",()=>Y.updateEffective("logLevel",qe.Debug)),m.commands.registerCommand("remoteHub.disableDebugLogging",()=>Y.updateEffective("logLevel",qe.Warn)),m.commands.registerCommand("remoteHub.exportDebugInfo",async()=>{await r.exportDebugInfo(),await e.exportDebugInfo()}),m.commands.registerCommand("remoteHub.setContext",async(l,d)=>{if(!l.startsWith("continueOn:"))throw new Error("Key must start with 'continueOn:'");await Si(l,d)}),m.commands.registerCommand("remoteHub.notebook.continueOn",async()=>{const l={title:Or("continue on","Continue Working On...")};await m.window.showInformationMessage(Or("notebook continue on","Running notebook cells is not available in the web editor. To run this cell, you will need to continue in an environment that can run code, like a codespace or local VS Code."),{modal:!0},l)===l&&await m.commands.executeCommand("remoteHub.continueOn")}),m.commands.registerCommand("remoteHub.remoteHelp.getStarted",()=>$n?"https://aka.ms/vscode-web-docs":"https://aka.ms/vscode-remote/remote-repositories/getting-started")]}a(Lu,"registerCommands");function $r(t){return t}a($r,"command");async function ya(t,e){return m.commands.executeCommand(t,e)}a(ya,"executeCommand");class Cl{constructor(){this._timeout=0,this._disposable=Y.onDidChange(this.onConfigurationChanged,this),this.maybeQueueFetch()}dispose(){this._disposable.dispose(),this._timeout&&clearTimeout(this._timeout)}get config(){var e;if(this._config===void 0){const r=Y.get("autoFetch");this._config={enabled:(e=r.enabled)!=null?e:!0,interval:r.interval*1e3}}return this._config}onConfigurationChanged(e){!Y.changed(e,"autoFetch")||(this._config=void 0,this.maybeQueueFetch())}async fetchAll(){try{await ya("remoteHub.fetchAll",{automated:!0})}catch(e){L.error(e,"Autofetch failed")}this.maybeQueueFetch()}maybeQueueFetch(){this._timeout&&(clearTimeout(this._timeout),this._timeout=0),!!this.config.enabled&&(this._timeout=setTimeout(()=>this.fetchAll(),this.config.interval))}}a(Cl,"AutoFetchService");const $u=require("buffer");var Tl=__webpack_require__(6113),ds=__webpack_require__.n(Tl);const hs=new Uint8Array(256);let fs=hs.length;function Fu(){return fs>hs.length-16&&(ds().randomFillSync(hs),fs=0),hs.slice(fs,fs+=16)}a(Fu,"rng");const Bu=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Hu(t){return typeof t=="string"&&Bu.test(t)}a(Hu,"validate");const Uu=Hu,Ur=[];for(let t=0;t<256;++t)Ur.push((t+256).toString(16).substr(1));function _a(t,e=0){const r=(Ur[t[e+0]]+Ur[t[e+1]]+Ur[t[e+2]]+Ur[t[e+3]]+"-"+Ur[t[e+4]]+Ur[t[e+5]]+"-"+Ur[t[e+6]]+Ur[t[e+7]]+"-"+Ur[t[e+8]]+Ur[t[e+9]]+"-"+Ur[t[e+10]]+Ur[t[e+11]]+Ur[t[e+12]]+Ur[t[e+13]]+Ur[t[e+14]]+Ur[t[e+15]]).toLowerCase();if(!Uu(r))throw TypeError("Stringified UUID is invalid");return r}a(_a,"stringify");const ju=_a;function Al(t,e,r){t=t||{};const n=t.random||(t.rng||Fu)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){r=r||0;for(let i=0;i<16;++i)e[r+i]=n[i];return e}return ju(n)}a(Al,"v4");const vc=Al;var Sr=__webpack_require__(2781),ps=__webpack_require__(3685),$o=__webpack_require__(7310),Rl=__webpack_require__(5687),sn=__webpack_require__(9796);const qu=Sr.Readable,Ei=Symbol("buffer"),yc=Symbol("type");class no{constructor(){this[yc]="";const e=arguments[0],r=arguments[1],n=[];let i=0;if(e){const c=e,l=Number(c.length);for(let d=0;d<l;d++){const h=c[d];let S;h instanceof Buffer?S=h:ArrayBuffer.isView(h)?S=Buffer.from(h.buffer,h.byteOffset,h.byteLength):h instanceof ArrayBuffer?S=Buffer.from(h):h instanceof no?S=h[Ei]:S=Buffer.from(typeof h=="string"?h:String(h)),i+=S.length,n.push(S)}}this[Ei]=Buffer.concat(n);let o=r&&r.type!==void 0&&String(r.type).toLowerCase();o&&!/[^\u0020-\u007E]/.test(o)&&(this[yc]=o)}get size(){return this[Ei].length}get type(){return this[yc]}text(){return Promise.resolve(this[Ei].toString())}arrayBuffer(){const e=this[Ei],r=e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);return Promise.resolve(r)}stream(){const e=new qu;return e._read=function(){},e.push(this[Ei]),e.push(null),e}toString(){return"[object Blob]"}slice(){const e=this.size,r=arguments[0],n=arguments[1];let i,o;r===void 0?i=0:r<0?i=Math.max(e+r,0):i=Math.min(r,e),n===void 0?o=e:n<0?o=Math.max(e+n,0):o=Math.min(n,e);const c=Math.max(o-i,0),d=this[Ei].slice(i,i+c),h=new no([],{type:arguments[2]});return h[Ei]=d,h}}a(no,"Blob"),Object.defineProperties(no.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}}),Object.defineProperty(no.prototype,Symbol.toStringTag,{value:"Blob",writable:!1,enumerable:!1,configurable:!0});function cn(t,e,r){Error.call(this,t),this.message=t,this.type=e,r&&(this.code=this.errno=r.code),Error.captureStackTrace(this,this.constructor)}a(cn,"FetchError"),cn.prototype=Object.create(Error.prototype),cn.prototype.constructor=cn,cn.prototype.name="FetchError";let _c;try{_c=require("encoding").convert}catch(t){}const xi=Symbol("Body internals"),Il=Sr.PassThrough;function Fr(t){var e=this,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.size;let i=n===void 0?0:n;var o=r.timeout;let c=o===void 0?0:o;t==null?t=null:Ol(t)?t=Buffer.from(t.toString()):wa(t)||Buffer.isBuffer(t)||(Object.prototype.toString.call(t)==="[object ArrayBuffer]"?t=Buffer.from(t):ArrayBuffer.isView(t)?t=Buffer.from(t.buffer,t.byteOffset,t.byteLength):t instanceof Sr||(t=Buffer.from(String(t)))),this[xi]={body:t,disturbed:!1,error:null},this.size=i,this.timeout=c,t instanceof Sr&&t.on("error",function(l){const d=l.name==="AbortError"?l:new cn(`Invalid response body while trying to fetch ${e.url}: ${l.message}`,"system",l);e[xi].error=d})}a(Fr,"Body"),Fr.prototype={get body(){return this[xi].body},get bodyUsed(){return this[xi].disturbed},arrayBuffer(){return Fo.call(this).then(function(t){return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)})},blob(){let t=this.headers&&this.headers.get("content-type")||"";return Fo.call(this).then(function(e){return Object.assign(new no([],{type:t.toLowerCase()}),{[Ei]:e})})},json(){var t=this;return Fo.call(this).then(function(e){try{return JSON.parse(e.toString())}catch(r){return Fr.Promise.reject(new cn(`invalid json response body at ${t.url} reason: ${r.message}`,"invalid-json"))}})},text(){return Fo.call(this).then(function(t){return t.toString()})},buffer(){return Fo.call(this)},textConverted(){var t=this;return Fo.call(this).then(function(e){return zu(e,t.headers)})}},Object.defineProperties(Fr.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0}}),Fr.mixIn=function(t){for(const e of Object.getOwnPropertyNames(Fr.prototype))if(!(e in t)){const r=Object.getOwnPropertyDescriptor(Fr.prototype,e);Object.defineProperty(t,e,r)}};function Fo(){var t=this;if(this[xi].disturbed)return Fr.Promise.reject(new TypeError(`body used already for: ${this.url}`));if(this[xi].disturbed=!0,this[xi].error)return Fr.Promise.reject(this[xi].error);let e=this.body;if(e===null)return Fr.Promise.resolve(Buffer.alloc(0));if(wa(e)&&(e=e.stream()),Buffer.isBuffer(e))return Fr.Promise.resolve(e);if(!(e instanceof Sr))return Fr.Promise.resolve(Buffer.alloc(0));let r=[],n=0,i=!1;return new Fr.Promise(function(o,c){let l;t.timeout&&(l=setTimeout(function(){i=!0,c(new cn(`Response timeout while trying to fetch ${t.url} (over ${t.timeout}ms)`,"body-timeout"))},t.timeout)),e.on("error",function(d){d.name==="AbortError"?(i=!0,c(d)):c(new cn(`Invalid response body while trying to fetch ${t.url}: ${d.message}`,"system",d))}),e.on("data",function(d){if(!(i||d===null)){if(t.size&&n+d.length>t.size){i=!0,c(new cn(`content size at ${t.url} over limit: ${t.size}`,"max-size"));return}n+=d.length,r.push(d)}}),e.on("end",function(){if(!i){clearTimeout(l);try{o(Buffer.concat(r,n))}catch(d){c(new cn(`Could not create Buffer from response body for ${t.url}: ${d.message}`,"system",d))}}})})}a(Fo,"consumeBody");function zu(t,e){if(typeof _c!="function")throw new Error("The package `encoding` must be installed to use the textConverted() function");const r=e.get("content-type");let n="utf-8",i,o;return r&&(i=/charset=([^;]*)/i.exec(r)),o=t.slice(0,1024).toString(),!i&&o&&(i=/<meta.+?charset=(['"])(.+?)\1/i.exec(o)),!i&&o&&(i=/<meta[\s]+?http-equiv=(['"])content-type\1[\s]+?content=(['"])(.+?)\2/i.exec(o),i||(i=/<meta[\s]+?content=(['"])(.+?)\1[\s]+?http-equiv=(['"])content-type\3/i.exec(o),i&&i.pop()),i&&(i=/charset=(.*)/i.exec(i.pop()))),!i&&o&&(i=/<\?xml.+?encoding=(['"])(.+?)\1/i.exec(o)),i&&(n=i.pop(),(n==="gb2312"||n==="gbk")&&(n="gb18030")),_c(t,"UTF-8",n).toString()}a(zu,"convertBody");function Ol(t){return typeof t!="object"||typeof t.append!="function"||typeof t.delete!="function"||typeof t.get!="function"||typeof t.getAll!="function"||typeof t.has!="function"||typeof t.set!="function"?!1:t.constructor.name==="URLSearchParams"||Object.prototype.toString.call(t)==="[object URLSearchParams]"||typeof t.sort=="function"}a(Ol,"isURLSearchParams");function wa(t){return typeof t=="object"&&typeof t.arrayBuffer=="function"&&typeof t.type=="string"&&typeof t.stream=="function"&&typeof t.constructor=="function"&&typeof t.constructor.name=="string"&&/^(Blob|File)$/.test(t.constructor.name)&&/^(Blob|File)$/.test(t[Symbol.toStringTag])}a(wa,"isBlob");function wc(t){let e,r,n=t.body;if(t.bodyUsed)throw new Error("cannot clone body after it is used");return n instanceof Sr&&typeof n.getBoundary!="function"&&(e=new Il,r=new Il,n.pipe(e),n.pipe(r),t[xi].body=e,n=r),n}a(wc,"clone");function io(t){return t===null?null:typeof t=="string"?"text/plain;charset=UTF-8":Ol(t)?"application/x-www-form-urlencoded;charset=UTF-8":wa(t)?t.type||null:Buffer.isBuffer(t)||Object.prototype.toString.call(t)==="[object ArrayBuffer]"||ArrayBuffer.isView(t)?null:typeof t.getBoundary=="function"?`multipart/form-data;boundary=${t.getBoundary()}`:t instanceof Sr?null:"text/plain;charset=UTF-8"}a(io,"extractContentType");function mr(t){const e=t.body;return e===null?0:wa(e)?e.size:Buffer.isBuffer(e)?e.length:e&&typeof e.getLengthSync=="function"&&(e._lengthRetrievers&&e._lengthRetrievers.length==0||e.hasKnownLength&&e.hasKnownLength())?e.getLengthSync():null}a(mr,"getTotalBytes");function bc(t,e){const r=e.body;r===null?t.end():wa(r)?r.stream().pipe(t):Buffer.isBuffer(r)?(t.write(r),t.end()):r.pipe(t)}a(bc,"writeToStream"),Fr.Promise=global.Promise;const Hn=/[^\^_`a-zA-Z\-0-9!#$%&'*+.|~]/,gs=/[^\t\x20-\x7e\x80-\xff]/;function ba(t){if(t=`${t}`,Hn.test(t)||t==="")throw new TypeError(`${t} is not a legal HTTP header name`)}a(ba,"validateName");function Pl(t){if(t=`${t}`,gs.test(t))throw new TypeError(`${t} is not a legal HTTP header value`)}a(Pl,"validateValue");function Bo(t,e){e=e.toLowerCase();for(const r in t)if(r.toLowerCase()===e)return r}a(Bo,"lib_find");const s=Symbol("map");class T{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:void 0;if(this[s]=Object.create(null),e instanceof T){const r=e.raw(),n=Object.keys(r);for(const i of n)for(const o of r[i])this.append(i,o);return}if(e!=null)if(typeof e=="object"){const r=e[Symbol.iterator];if(r!=null){if(typeof r!="function")throw new TypeError("Header pairs must be iterable");const n=[];for(const i of e){if(typeof i!="object"||typeof i[Symbol.iterator]!="function")throw new TypeError("Each header pair must be iterable");n.push(Array.from(i))}for(const i of n){if(i.length!==2)throw new TypeError("Each header pair must be a name/value tuple");this.append(i[0],i[1])}}else for(const n of Object.keys(e)){const i=e[n];this.append(n,i)}}else throw new TypeError("Provided initializer must be an object")}get(e){e=`${e}`,ba(e);const r=Bo(this[s],e);return r===void 0?null:this[s][r].join(", ")}forEach(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,n=f(this),i=0;for(;i<n.length;){var o=n[i];const c=o[0],l=o[1];e.call(r,l,c,this),n=f(this),i++}}set(e,r){e=`${e}`,r=`${r}`,ba(e),Pl(r);const n=Bo(this[s],e);this[s][n!==void 0?n:e]=[r]}append(e,r){e=`${e}`,r=`${r}`,ba(e),Pl(r);const n=Bo(this[s],e);n!==void 0?this[s][n].push(r):this[s][e]=[r]}has(e){return e=`${e}`,ba(e),Bo(this[s],e)!==void 0}delete(e){e=`${e}`,ba(e);const r=Bo(this[s],e);r!==void 0&&delete this[s][r]}raw(){return this[s]}keys(){return x(this,"key")}values(){return x(this,"value")}[Symbol.iterator](){return x(this,"key+value")}}a(T,"Headers"),T.prototype.entries=T.prototype[Symbol.iterator],Object.defineProperty(T.prototype,Symbol.toStringTag,{value:"Headers",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(T.prototype,{get:{enumerable:!0},forEach:{enumerable:!0},set:{enumerable:!0},append:{enumerable:!0},has:{enumerable:!0},delete:{enumerable:!0},keys:{enumerable:!0},values:{enumerable:!0},entries:{enumerable:!0}});function f(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"key+value";return Object.keys(t[s]).sort().map(e==="key"?function(n){return n.toLowerCase()}:e==="value"?function(n){return t[s][n].join(", ")}:function(n){return[n.toLowerCase(),t[s][n].join(", ")]})}a(f,"getHeaders");const w=Symbol("internal");function x(t,e){const r=Object.create(p);return r[w]={target:t,kind:e,index:0},r}a(x,"createHeadersIterator");const p=Object.setPrototypeOf({next(){if(!this||Object.getPrototypeOf(this)!==p)throw new TypeError("Value of `this` is not a HeadersIterator");var t=this[w];const e=t.target,r=t.kind,n=t.index,i=f(e,r),o=i.length;return n>=o?{value:void 0,done:!0}:(this[w].index=n+1,{value:i[n],done:!1})}},Object.getPrototypeOf(Object.getPrototypeOf([][Symbol.iterator]())));Object.defineProperty(p,Symbol.toStringTag,{value:"HeadersIterator",writable:!1,enumerable:!1,configurable:!0});function u(t){const e=Object.assign({__proto__:null},t[s]),r=Bo(t[s],"Host");return r!==void 0&&(e[r]=e[r][0]),e}a(u,"exportNodeCompatibleHeaders");function g(t){const e=new T;for(const r of Object.keys(t))if(!Hn.test(r))if(Array.isArray(t[r]))for(const n of t[r])gs.test(n)||(e[s][r]===void 0?e[s][r]=[n]:e[s][r].push(n));else gs.test(t[r])||(e[s][r]=[t[r]]);return e}a(g,"createHeadersLenient");const v=Symbol("Response internals"),_=ps.STATUS_CODES;class b{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Fr.call(this,e,r);const n=r.status||200,i=new T(r.headers);if(e!=null&&!i.has("Content-Type")){const o=io(e);o&&i.append("Content-Type",o)}this[v]={url:r.url,status:n,statusText:r.statusText||_[n],headers:i,counter:r.counter}}get url(){return this[v].url||""}get status(){return this[v].status}get ok(){return this[v].status>=200&&this[v].status<300}get redirected(){return this[v].counter>0}get statusText(){return this[v].statusText}get headers(){return this[v].headers}clone(){return new b(wc(this),{url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected})}}a(b,"Response"),Fr.mixIn(b.prototype),Object.defineProperties(b.prototype,{url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}}),Object.defineProperty(b.prototype,Symbol.toStringTag,{value:"Response",writable:!1,enumerable:!1,configurable:!0});const y=Symbol("Request internals"),E=$o.parse,C=$o.format,A="destroy"in Sr.Readable.prototype;function R(t){return typeof t=="object"&&typeof t[y]=="object"}a(R,"isRequest");function D(t){const e=t&&typeof t=="object"&&Object.getPrototypeOf(t);return!!(e&&e.constructor.name==="AbortSignal")}a(D,"isAbortSignal");class k{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n;R(e)?n=E(e.url):(e&&e.href?n=E(e.href):n=E(`${e}`),e={});let i=r.method||e.method||"GET";if(i=i.toUpperCase(),(r.body!=null||R(e)&&e.body!==null)&&(i==="GET"||i==="HEAD"))throw new TypeError("Request with GET/HEAD method cannot have body");let o=r.body!=null?r.body:R(e)&&e.body!==null?wc(e):null;Fr.call(this,o,{timeout:r.timeout||e.timeout||0,size:r.size||e.size||0});const c=new T(r.headers||e.headers||{});if(o!=null&&!c.has("Content-Type")){const d=io(o);d&&c.append("Content-Type",d)}let l=R(e)?e.signal:null;if("signal"in r&&(l=r.signal),l!=null&&!D(l))throw new TypeError("Expected signal to be an instanceof AbortSignal");this[y]={method:i,redirect:r.redirect||e.redirect||"follow",headers:c,parsedURL:n,signal:l},this.follow=r.follow!==void 0?r.follow:e.follow!==void 0?e.follow:20,this.compress=r.compress!==void 0?r.compress:e.compress!==void 0?e.compress:!0,this.counter=r.counter||e.counter||0,this.agent=r.agent||e.agent}get method(){return this[y].method}get url(){return C(this[y].parsedURL)}get headers(){return this[y].headers}get redirect(){return this[y].redirect}get signal(){return this[y].signal}clone(){return new k(this)}}a(k,"Request"),Fr.mixIn(k.prototype),Object.defineProperty(k.prototype,Symbol.toStringTag,{value:"Request",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(k.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0}});function G(t){const e=t[y].parsedURL,r=new T(t[y].headers);if(r.has("Accept")||r.set("Accept","*/*"),!e.protocol||!e.hostname)throw new TypeError("Only absolute URLs are supported");if(!/^https?:$/.test(e.protocol))throw new TypeError("Only HTTP(S) protocols are supported");if(t.signal&&t.body instanceof Sr.Readable&&!A)throw new Error("Cancellation of streamed requests with AbortSignal is not supported in node < 8");let n=null;if(t.body==null&&/^(POST|PUT)$/i.test(t.method)&&(n="0"),t.body!=null){const o=mr(t);typeof o=="number"&&(n=String(o))}n&&r.set("Content-Length",n),r.has("User-Agent")||r.set("User-Agent","node-fetch/1.0 (+https://github.com/bitinn/node-fetch)"),t.compress&&!r.has("Accept-Encoding")&&r.set("Accept-Encoding","gzip,deflate");let i=t.agent;return typeof i=="function"&&(i=i(e)),!r.has("Connection")&&!i&&r.set("Connection","close"),Object.assign({},e,{method:t.method,headers:u(r),agent:i})}a(G,"getNodeRequestOptions");function Z(t){Error.call(this,t),this.type="aborted",this.message=t,Error.captureStackTrace(this,this.constructor)}a(Z,"AbortError"),Z.prototype=Object.create(Error.prototype),Z.prototype.constructor=Z,Z.prototype.name="AbortError";const Q=Sr.PassThrough,fe=$o.resolve;function Se(t,e){if(!Se.Promise)throw new Error("native promise missing, set fetch.Promise to your favorite alternative");return Fr.Promise=Se.Promise,new Se.Promise(function(r,n){const i=new k(t,e),o=G(i),c=(o.protocol==="https:"?Rl:ps).request,l=i.signal;let d=null;const h=a(function(){let N=new Z("The user aborted a request.");n(N),i.body&&i.body instanceof Sr.Readable&&i.body.destroy(N),!(!d||!d.body)&&d.body.emit("error",N)},"abort");if(l&&l.aborted){h();return}const S=a(function(){h(),P()},"abortAndFinalize"),O=c(o);let I;l&&l.addEventListener("abort",S);function P(){O.abort(),l&&l.removeEventListener("abort",S),clearTimeout(I)}a(P,"finalize"),i.timeout&&O.once("socket",function($){I=setTimeout(function(){n(new cn(`network timeout at: ${i.url}`,"request-timeout")),P()},i.timeout)}),O.on("error",function($){n(new cn(`request to ${i.url} failed, reason: ${$.message}`,"system",$)),P()}),O.on("response",function($){clearTimeout(I);const N=g($.headers);if(Se.isRedirect($.statusCode)){const oe=N.get("Location"),ge=oe===null?null:fe(i.url,oe);switch(i.redirect){case"error":n(new cn(`uri requested responds with a redirect, redirect mode is set to error: ${i.url}`,"no-redirect")),P();return;case"manual":if(ge!==null)try{N.set("Location",ge)}catch(Ie){n(Ie)}break;case"follow":if(ge===null)break;if(i.counter>=i.follow){n(new cn(`maximum redirect reached at: ${i.url}`,"max-redirect")),P();return}const ke={headers:new T(i.headers),follow:i.follow,counter:i.counter+1,agent:i.agent,compress:i.compress,method:i.method,body:i.body,signal:i.signal,timeout:i.timeout,size:i.size};if($.statusCode!==303&&i.body&&mr(i)===null){n(new cn("Cannot follow redirect with body being a readable stream","unsupported-redirect")),P();return}($.statusCode===303||($.statusCode===301||$.statusCode===302)&&i.method==="POST")&&(ke.method="GET",ke.body=void 0,ke.headers.delete("content-length")),r(Se(new k(ge,ke))),P();return}}$.once("end",function(){l&&l.removeEventListener("abort",S)});let U=$.pipe(new Q);const W={url:i.url,status:$.statusCode,statusText:$.statusMessage,headers:N,size:i.size,timeout:i.timeout,counter:i.counter},V=N.get("Content-Encoding");if(!i.compress||i.method==="HEAD"||V===null||$.statusCode===204||$.statusCode===304){d=new b(U,W),r(d);return}const ie={flush:sn.Z_SYNC_FLUSH,finishFlush:sn.Z_SYNC_FLUSH};if(V=="gzip"||V=="x-gzip"){U=U.pipe(sn.createGunzip(ie)),d=new b(U,W),r(d);return}if(V=="deflate"||V=="x-deflate"){$.pipe(new Q).once("data",function(ge){(ge[0]&15)==8?U=U.pipe(sn.createInflate()):U=U.pipe(sn.createInflateRaw()),d=new b(U,W),r(d)});return}if(V=="br"&&typeof sn.createBrotliDecompress=="function"){U=U.pipe(sn.createBrotliDecompress()),d=new b(U,W),r(d);return}d=new b(U,W),r(d)}),bc(O,i)})}a(Se,"fetch"),Se.isRedirect=function(t){return t===301||t===302||t===303||t===307||t===308},Se.Promise=global.Promise;const Me=Se;var He=__webpack_require__(271),Qe=__webpack_require__.n(He);const Ye=Me;async function mt(t,e,r){const n=new(Qe());r.onCancellationRequested(()=>{n.abort()});try{return await Me(t,{...e,signal:n.signal})}catch(i){throw r.isCancellationRequested?new m.CancellationError:i}}a(mt,"fetchWithCancellation");const Ct=B.loadMessageBundle(),Vt="https://app.vssps.visualstudio.com/oauth2",Bt="https://vscode.dev/codeExchangeProxyEndpoints/azuredevops",Er="B6B1E9E6-B408-45D9-A6EA-AF1FFBAB6A0F",Ht=["vso.code"];function Je(t){return(t.query.includes("&")?t.query:decodeURIComponent(t.query)).split("&").reduce((r,n)=>{const i=n.split("=");return r[i[0]]=i[1],r},{})}a(Je,"parseQuery");const ct=new m.EventEmitter,dt=new m.EventEmitter,Et="Network failure",kt="AzDO",zt="azuredevops";class Tt{constructor(e){this._tokens=[],this._refreshTimeouts=new Map,this._disposables=[],this._pendingStates=new Map,this._codeExchangePromises=new Map,this.secretStorage=e.secrets,this.extensionId=e.extension.id}async initialize(){await this.secretStorage.get(kt)&&(L.debug("Detected outdated auth session format. Removing and will ask for new auth session... "),await this.secretStorage.delete(kt));const r=await this.secretStorage.get(zt);if(r)try{const i=this.parseStoredData(r).map(async o=>{var c;if(!o.refreshToken)return Promise.resolve();try{await this.refreshToken(o.refreshToken,o.scope,o.id)}catch(l){l.message===Et?await this.handleRefreshNetworkError(o.id,o.refreshToken,o.scope)||(this._tokens.push({accessToken:void 0,refreshToken:o.refreshToken,account:{label:(c=o.account.label)!=null?c:o.account.displayName,id:o.account.id},scope:o.scope,sessionId:o.id}),this.pollForReconnect(o.id,o.refreshToken,o.scope)):await this.removeSession(o.id)}});await Promise.all(i)}catch(n){L.log("Failed to initialize stored data"),await this.clearSessions()}this._disposables.push(this.secretStorage.onDidChange(()=>this.checkForUpdates))}parseStoredData(e){return JSON.parse(e)}async storeTokenData(){const e=this._tokens.map(r=>({id:r.sessionId,refreshToken:r.refreshToken,scope:r.scope,account:r.account}));await this.secretStorage.store(zt,JSON.stringify(e))}async checkForUpdates(){const e=[];let r=[];const n=await this.secretStorage.get(zt);if(n)try{const i=this.parseStoredData(n);let o=i.map(async c=>{if(!this._tokens.some(d=>d.scope===c.scope&&d.sessionId===c.id)&&c.refreshToken)try{const d=await this.refreshToken(c.refreshToken,c.scope,c.id);e.push(this.convertToSessionSync(d))}catch(d){d.message===Et||await this.removeSession(c.id)}});o=o.concat(this._tokens.map(async c=>{i.some(d=>c.scope===d.scope&&c.sessionId===d.id)||(await this.removeSession(c.sessionId),r.push(this.convertToSessionSync(c)))})),await Promise.all(o)}catch(i){L.error(i),r=this._tokens.map(this.convertToSessionSync),this.clearSessions()}else this._tokens.length&&(r=this._tokens.map(this.convertToSessionSync),L.log("No stored keychain data, clearing local data"),this._tokens=[],this._refreshTimeouts.forEach(i=>{clearTimeout(i)}),this._refreshTimeouts.clear());(e.length||r.length)&&ct.fire({added:e,removed:r,changed:[]})}convertToSessionSync(e){return{id:e.sessionId,accessToken:e.accessToken,account:e.account,scopes:e.scope.split(" ")}}async convertToSession(e){const r=await this.resolveAccessToken(e);return{id:e.sessionId,accessToken:r,account:e.account,scopes:e.scope.split(" ")}}async resolveAccessToken(e){if(e.accessToken&&(!e.expiresAt||e.expiresAt>Date.now()))return e.expiresAt?L.log(`Token available from cache, expires in ${e.expiresAt-Date.now()} milliseconds`):L.log("Token available from cache"),Promise.resolve(e.accessToken);try{L.log("Token expired or unavailable, trying refresh");const r=await this.refreshToken(e.refreshToken,e.scope,e.sessionId);if(r.accessToken)return r.accessToken;throw new Error("No access token returned.")}catch(r){throw new Error("Unavailable due to network problems")}}getTokenClaims(e){try{return JSON.parse($u.Buffer.from(e.split(".")[1],"base64").toString())}catch(r){throw L.error(r),new Error("Unable to read token claims")}}get sessions(){return Promise.all(this._tokens.map(e=>this.convertToSession(e)))}async getSessions(e){if(!e)return this.sessions;const r=e.sort().join(" "),n=this._tokens.filter(i=>i.scope===r);return Promise.all(n.map(i=>this.convertToSession(i)))}createSession(e){return L.log("Logging in..."),this.loginWithoutLocalServer(e)}dispose(){this._disposables.forEach(e=>e.dispose()),this._disposables=[]}isTestEnvironment(e){return/\.azurewebsites\.net$/.test(e.authority)||e.authority.startsWith("localhost:")}async loginWithoutLocalServer(e){var r;const n=await m.env.asExternalUri(m.Uri.parse(`${m.env.uriScheme}://${this.extensionId}/login`));if(this.isTestEnvironment(n)){const h=await m.window.showInputBox({prompt:'Azure Repos Personal Access Token (you must have "vso.code" in your scopes)',ignoreFocusOut:!0});if(!h)throw new Error("Sign in failed: No token provided");return{id:"test",accessToken:h,scopes:Ht,account:{id:"test",label:"Test Account"}}}const i=n.toString(),o=m.Uri.parse(`${Vt}/authorize?client_id=${Er}&response_type=Assertion&state=${encodeURIComponent(i)}&scope=${encodeURIComponent(Ht.join(" "))}&redirect_uri=${encodeURIComponent(Bt)}`),c=new Promise((h,S)=>{const O=setTimeout(()=>{clearTimeout(O),S("Login timed out.")},1e3*60*5)}),l=(r=this._pendingStates.get(e))!=null?r:[];this._pendingStates.set(e,[...l,i]);let d=this._codeExchangePromises.get(e);return d||(d=this.handleCodeResponse(e),this._codeExchangePromises.set(e,d)),m.env.openExternal(o),Promise.race([d,c]).finally(()=>{this._pendingStates.delete(e),this._codeExchangePromises.delete(e)})}async handleCodeResponse(e){let r;return new Promise((n,i)=>{r=dt.event(async o=>{try{L.log(`Received Uri: ${o.toString()}`);const c=Je(o);if(!c)throw new Error(`No access info found in query: ${JSON.stringify(c)}`);const l=c,d=await this.getTokenFromResponse(l,e);this.setToken(d,e);const h=await this.convertToSession(d);n(h)}catch(c){L.error(c),i(c)}})}).then(n=>(r.dispose(),n)).catch(n=>{throw r.dispose(),n})}setToken(e,r){const n=this._tokens.findIndex(i=>i.sessionId===e.sessionId);return n>-1?this._tokens.splice(n,1,e):this._tokens.push(e),this.clearSessionTimeout(e.sessionId),e.expiresIn&&this._refreshTimeouts.set(e.sessionId,setTimeout(async()=>{try{const i=await this.refreshToken(e.refreshToken,r,e.sessionId);ct.fire({added:[],removed:[],changed:[this.convertToSessionSync(i)]})}catch(i){i.message===Et?await this.handleRefreshNetworkError(e.sessionId,e.refreshToken,r)||this.pollForReconnect(e.sessionId,e.refreshToken,e.scope):(await this.removeSession(e.sessionId),ct.fire({added:[],removed:[this.convertToSessionSync(e)],changed:[]}))}},1e3*(e.expiresIn*2/3))),this.storeTokenData()}async getTokenFromResponse(e,r,n){var i;const o=this.getTokenClaims(e.access_token),c=await Ye("https://app.vssps.visualstudio.com/_apis/profile/profiles/me?api-version=6.0",{headers:{Authorization:`Bearer ${e.access_token}`,"Content-Type":"application/json"}});let l;if(c.ok)l=(await c.json()).displayName;else{const d=await c.text();L.error(d),l="User"}return{expiresIn:e.expires_in,expiresAt:e.expires_in?Date.now()+e.expires_in*1e3:void 0,accessToken:e.access_token,refreshToken:e.refresh_token,scope:r,sessionId:n!=null?n:`${o.nameid}/${vc()}`,account:{label:l,id:`${o.nameid}/${(i=o.aui)!=null?i:""}`}}}async refreshToken(e,r,n){L.log("Refreshing token...");const i=`refresh_token=${encodeURIComponent(e)}`;let o;try{o=await Ye(Bt,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","Content-Length":i.length.toString()},body:i})}catch(c){throw L.error("Refreshing token failed"),new Error(Et)}try{if(o.ok){const c=await o.json(),l=await this.getTokenFromResponse({access_token:c.access_token,expires_in:c.expires_in,refresh_token:c.refresh_token},r,n);return this.setToken(l,r),L.log("Token refresh success"),l}throw new Error("Bad request.")}catch(c){throw await m.window.showErrorMessage(Ct("signOut","You have been signed out because reading stored authentication information failed.")),L.error(`Refreshing token failed: ${o.statusText}`),new Error("Refreshing token failed")}}clearSessionTimeout(e){const r=this._refreshTimeouts.get(e);r&&(clearTimeout(r),this._refreshTimeouts.delete(e))}removeInMemorySessionData(e){const r=this._tokens.findIndex(i=>i.sessionId===e);let n;return r>-1&&(n=this._tokens[r],this._tokens.splice(r,1)),this.clearSessionTimeout(e),n}pollForReconnect(e,r,n){this.clearSessionTimeout(e),this._refreshTimeouts.set(e,setTimeout(async()=>{try{const i=await this.refreshToken(r,n,e);ct.fire({added:[],removed:[],changed:[this.convertToSessionSync(i)]})}catch(i){this.pollForReconnect(e,r,n)}},1e3*60*30))}handleRefreshNetworkError(e,r,n,i=1){return new Promise((o,c)=>{if(i===3)return L.error("Token refresh failed after 3 attempts"),o(!1);const l=5*i*i;this.clearSessionTimeout(e),this._refreshTimeouts.set(e,setTimeout(async()=>{try{const d=await this.refreshToken(r,n,e);return ct.fire({added:[],removed:[],changed:[this.convertToSessionSync(d)]}),o(!0)}catch(d){return o(await this.handleRefreshNetworkError(e,r,n,i+1))}},1e3*l))})}async removeSession(e){L.log(`Logging out of session '${e}'`);const r=this.removeInMemorySessionData(e);let n;return r&&(n=this.convertToSessionSync(r)),this._tokens.length===0?await this.secretStorage.delete(zt):this.storeTokenData(),n}async clearSessions(){L.log("Logging out of all sessions"),this._tokens=[],await this.secretStorage.delete(zt),this._refreshTimeouts.forEach(e=>{clearTimeout(e)}),this._refreshTimeouts.clear()}}a(Tt,"AzureDevOpsAuthService");const ar=a(class{constructor(t){this.onDidChangeSessions=ct.event,this.loginService=new Tt(t),this.initializePromise=this.loginService.initialize(),this.disposable=m.authentication.registerAuthenticationProvider(ar.id,"Azure Repos",this)}dispose(){this.disposable.dispose()}async getSessions(t){return await this.initializePromise,this.loginService.getSessions(t)}async createSession(t){await this.initializePromise;const e=await this.loginService.createSession(t.sort().join(" "));return ct.fire({added:[e],removed:[],changed:[]}),e}async removeSession(t){await this.initializePromise;const e=await this.loginService.removeSession(t);e&&ct.fire({added:[],removed:[e],changed:[]})}},"_AzDOAuthenticationProvider");let gr=ar;gr.id="azurerepos";var fr=__webpack_require__(7360),_r=__webpack_require__(850),or=__webpack_require__.n(_r);function Pr(t,e,r){if(!(e==null?void 0:e.length)&&!(r==null?void 0:r.length))return new Set(t);let n;if(e==null?void 0:e.length){const i=new Set([...e,...e.map(c=>`${c}/**`)]),o=or()(t,[...i],{dot:!0,nocase:!0});n=new Set(o)}if(r==null?void 0:r.length){const i=new Set([...r,...r.map(o=>`${o}/**`)]);if(n===void 0){const o=or().not(t,[...i],{dot:!0,nocase:!0});n=new Set(o)}else or()(t,[...i],{dot:!0,nocase:!0}).forEach(n.delete,n)}return n}a(Pr,"globFilter");var En=Object.defineProperty,Nt=Object.getOwnPropertyDescriptor,At=a((t,e,r,n)=>{for(var i=n>1?void 0:n?Nt(e,r):e,o=t.length-1,c;o>=0;o--)(c=t[o])&&(i=(n?c(e,r,i):c(i))||i);return n&&i&&En(e,r,i),i},"fs_decorateClass");const nr=(0,B.loadMessageBundle)(),jr=m.FileSystemError.FileNotFound().code,Sc=/(\/|\\)/g;class oo{constructor(e,r,n){this.providerService=e,this.azdo=r,this.changeStore=n,this._onDidChangeFile=new m.EventEmitter,this.contentCache=new Map,this.fileSearchCache=new Map,this.pendingUriRequests=new Map,this.pendingUriRequestsEventDelay=10,this.implicitlyWatchedUris=new Map,this.watchedUris=new Map,this.pathTypeMap={},this.disposable=m.Disposable.from(m.workspace.registerFileSystemProvider(this.scheme,this,{isCaseSensitive:!0,isReadonly:!0}),m.workspace.registerFileSearchProvider(this.scheme,this),m.workspace.registerTextSearchProvider(this.scheme,this),m.workspace.onDidCloseTextDocument(i=>this.onTextDocumentClosed(i.uri)),e.onDidChangeRepository(i=>{i.reason==="HEAD"&&this.onRefreshOrRepositoryChanged([i.repository.uri])}),e.onDidRefresh(i=>this.onRefreshOrRepositoryChanged(i)))}get onDidChangeFile(){return this._onDidChangeFile.event}get scheme(){return this.azdo.scheme}dispose(){var e;(e=this.disposable)==null||e.dispose()}onRefreshOrRepositoryChanged(e){if(e=e.filter(r=>Qt.getProviderId(r)===this.scheme).map(r=>this.providerService.getProviderUri(r)),e.length!==0){L.log(`AzDOFS.onRefreshOrRepositoryChanged(${e.map(r=>r.toString()).join(", ")})`),this.fileSearchCache.clear();for(const[r,n]of[...this.pendingUriRequests])e.some(i=>ve(n.uri,i))&&(this.pendingUriRequests.delete(r),n.outdated=!0);for(const[r,{uri:n}]of[...this.contentCache])e.some(i=>ve(n,i))&&this.contentCache.delete(r);this.updateOpenOrWatchedUris(e)}}onTextDocumentClosed(e){e.scheme===this.scheme&&this.contentCache.delete(te(e))}updateOpenOrWatchedUris(e){const r=this.providerService.getOpenUris(this.scheme,e);for(const[i,o]of[...this.watchedUris,...this.implicitlyWatchedUris])e.some(c=>ve(o,c))&&(this.implicitlyWatchedUris.delete(i),r.set(i,o));L.debug(`AzDOFS.updateOpenOrWatchedUris(${e.map(i=>i.toString()).join(", ")}): uris=${r.size}`);for(const i of e)r.set(te(i),i);const n=[...r.values()].map(i=>({type:m.FileChangeType.Changed,uri:i}));setTimeout(()=>{L.debug(`AzDOFS.updateOpenOrWatchedUris: Firing events=${n.map(i=>i.uri.toString()).join(", ")}`),this._onDidChangeFile.fire(n)},0)}watch(e,r){const n=te(e);return this.watchedUris.set(n,e),{dispose:()=>{this.watchedUris.delete(n)}}}async stat(e){const r=te(e);this.implicitlyWatchedUris.set(r,e);const n={uri:e,outdated:!1};try{this.pendingUriRequests.set(`stat:${r}`,n);const i=await this.providerService.getMetadata(e),o=m.FilePermission.Readonly;if(!i.path)return{type:m.FileType.Directory,mtime:0,ctime:0,size:0,permissions:o};if(i.path in this.pathTypeMap||await this.updateWorkspaceItemMap(i,e.path,!0),i.path in this.pathTypeMap)return this.pathTypeMap[i.path]===m.FileType.Directory?{type:m.FileType.Directory,mtime:0,ctime:0,size:0,permissions:o}:{type:m.FileType.File,mtime:0,ctime:0,size:0,permissions:o};if(this.implicitlyWatchedUris.delete(r),e.query!=="~")throw m.FileSystemError.FileNotFound(e);return{type:m.FileType.File,size:0,ctime:0,mtime:Date.now(),permissions:m.FilePermission.Readonly}}finally{this.pendingUriRequests.delete(`stat:${r}`),(n==null?void 0:n.outdated)&&setTimeout(()=>{L.log(`AzDOFS.stat(${e.toString()}): Repository changed; firing change event...`),this._onDidChangeFile.fire([{type:m.FileChangeType.Changed,uri:e}])},this.pendingUriRequestsEventDelay)}}async updateWorkspaceItemMap(e,r,n){const i=new Array,o=await this.azdo.getRepoItems(e,r,{recursionLevel:"OneLevel"});for(const c of o){const l=c.path.substring(1);if(l!==e.path||n){const d=c.isFolder===!0?m.FileType.Directory:m.FileType.File;this.pathTypeMap[l]=d,i.push([l,d])}}return i}async readDirectory(e){this.implicitlyWatchedUris.set(te(e),e);const r=this.providerService.getVirtualRootUri(e),n=await this.providerService.getMetadata(e);return(await this.updateWorkspaceItemMap(n,e.path,!1)).map(o=>[this.providerService.getRelativeFilePath(e,We(r,o[0])),o[1]])}createDirectory(e){throw m.FileSystemError.NoPermissions()}async readFile(e){var r;const n=te(e);this.implicitlyWatchedUris.set(n,e);let i=this.contentCache.get(n);if(i!==void 0)return i.content;const o={uri:e,outdated:!1};try{return this.pendingUriRequests.set(n,o),i={content:this.azdo.getFileContent(e),uri:e},this.contentCache.set(n,i),await i.content}catch(c){if(this.implicitlyWatchedUris.delete(n),i!==void 0&&i.content===((r=this.contentCache.get(n))==null?void 0:r.content)&&this.contentCache.delete(n),e.query==="~"&&c instanceof m.FileSystemError&&c.code===jr)return new Uint8Array(0);throw c}finally{this.pendingUriRequests.delete(n),(o==null?void 0:o.outdated)&&setTimeout(()=>{L.log(`AzDOFS.readFile(${e.toString()}): Repository changed; firing change event...`),this._onDidChangeFile.fire([{type:m.FileChangeType.Changed,uri:e}])},this.pendingUriRequestsEventDelay)}}writeFile(e,r,n){throw m.FileSystemError.NoPermissions()}delete(e,r){throw m.FileSystemError.NoPermissions()}rename(e,r,n){throw m.FileSystemError.NoPermissions()}copy(e,r,n){throw m.FileSystemError.NoPermissions()}async provideFileSearchResults(e,{folder:r,maxResults:n,includes:i,excludes:o},c){const l=`${te(r)}|${JSON.stringify({includes:i,excludes:o})}`;let d=this.fileSearchCache.get(l);if(d===void 0){const S=await this.providerService.getMetadata(r),O=await this.azdo.getRepoItems(S,"",{recursionLevel:"Full"});let I=[];for(const P of O)P.isFolder||I.push(P.path);if(I.length===0||c.isCancellationRequested)return[];((i==null?void 0:i.length)||(o==null?void 0:o.length))&&(I=[...Pr(I,i,o)]),d=I.map(P=>fr.prepareSlow(P)),this.fileSearchCache.set(l,d)}let h;return e.pattern===""?h=d.map(S=>m.Uri.joinPath(r,S.target)):(h=fr.go(e.pattern.replace(Sc,"/"),d,{allowTypo:!0,limit:n}).map(S=>m.Uri.joinPath(r,S.target)),fr.cleanup()),n!==void 0&&n!==0&&n<h.length&&(h=h.slice(0,n)),h}async provideTextSearchResults(e,r,n,i){const o=[];(e.isCaseSensitive||e.isRegExp||e.isWordMatch)&&o.push({text:nr("azdo flags not supported","Search flags are not supported."),type:m.TextSearchCompleteMessageType.Warning});const c=await this.azdo.searchCodeQuery(e.pattern,r.folder,{maxResults:r.maxResults,context:{before:r.beforeContext,after:r.afterContext}});if(c.warnings&&c.warnings.forEach(d=>{o.push({text:d,type:m.TextSearchCompleteMessageType.Warning})}),c===void 0)return{limitHit:!0,message:o};let l;for(const d of c.matches)l=m.Uri.joinPath(r.folder,d.path),n.report({uri:l,ranges:d.ranges,preview:{text:d.preview,matches:d.matches}});return{limitHit:!1,message:o}}}a(oo,"AzDOFS"),At([Mr()],oo.prototype,"stat",1),At([Mr()],oo.prototype,"readDirectory",1),At([Mr()],oo.prototype,"readFile",1);var Kt;(function(t){t[t.Force=0]="Force",t[t.ForceWithLease=1]="ForceWithLease"})(Kt||(Kt={}));var Dn;(function(t){t[t.Head=0]="Head",t[t.RemoteHead=1]="RemoteHead",t[t.Tag=2]="Tag"})(Dn||(Dn={}));var ao;(function(t){t[t.INDEX_MODIFIED=0]="INDEX_MODIFIED",t[t.INDEX_ADDED=1]="INDEX_ADDED",t[t.INDEX_DELETED=2]="INDEX_DELETED",t[t.INDEX_RENAMED=3]="INDEX_RENAMED",t[t.INDEX_COPIED=4]="INDEX_COPIED",t[t.MODIFIED=5]="MODIFIED",t[t.DELETED=6]="DELETED",t[t.UNTRACKED=7]="UNTRACKED",t[t.IGNORED=8]="IGNORED",t[t.INTENT_TO_ADD=9]="INTENT_TO_ADD",t[t.ADDED_BY_US=10]="ADDED_BY_US",t[t.ADDED_BY_THEM=11]="ADDED_BY_THEM",t[t.DELETED_BY_US=12]="DELETED_BY_US",t[t.DELETED_BY_THEM=13]="DELETED_BY_THEM",t[t.BOTH_ADDED=14]="BOTH_ADDED",t[t.BOTH_DELETED=15]="BOTH_DELETED",t[t.BOTH_MODIFIED=16]="BOTH_MODIFIED"})(ao||(ao={}));var Hi;(function(t){t.BadConfigFile="BadConfigFile",t.AuthenticationFailed="AuthenticationFailed",t.NoUserNameConfigured="NoUserNameConfigured",t.NoUserEmailConfigured="NoUserEmailConfigured",t.NoRemoteRepositorySpecified="NoRemoteRepositorySpecified",t.NotAGitRepository="NotAGitRepository",t.NotAtRepositoryRoot="NotAtRepositoryRoot",t.Conflict="Conflict",t.StashConflict="StashConflict",t.UnmergedChanges="UnmergedChanges",t.PushRejected="PushRejected",t.RemoteConnectionError="RemoteConnectionError",t.DirtyWorkTree="DirtyWorkTree",t.CantOpenResource="CantOpenResource",t.GitNotFound="GitNotFound",t.CantCreatePipe="CantCreatePipe",t.PermissionDenied="PermissionDenied",t.CantAccessRemote="CantAccessRemote",t.RepositoryNotFound="RepositoryNotFound",t.RepositoryIsLocked="RepositoryIsLocked",t.BranchNotFullyMerged="BranchNotFullyMerged",t.NoRemoteReference="NoRemoteReference",t.InvalidBranchName="InvalidBranchName",t.BranchAlreadyExists="BranchAlreadyExists",t.NoLocalChanges="NoLocalChanges",t.NoStashFound="NoStashFound",t.LocalChangesOverwritten="LocalChangesOverwritten",t.NoUpstreamBranch="NoUpstreamBranch",t.IsInSubmodule="IsInSubmodule",t.WrongCase="WrongCase",t.CantLockRef="CantLockRef",t.CantRebaseMultipleBranches="CantRebaseMultipleBranches",t.PatchDoesNotApply="PatchDoesNotApply",t.NoPathFound="NoPathFound",t.UnknownPath="UnknownPath"})(Hi||(Hi={}));function ei(t){return Buffer.from(t,"base64")}a(ei,"fromBase64");function Ci(t){return Buffer.from(t).toString("base64")}a(Ci,"toBase64");var Un=Object.defineProperty,ms=Object.getOwnPropertyDescriptor,vs=a((t,e,r,n)=>{for(var i=n>1?void 0:n?ms(e,r):e,o=t.length-1,c;o>=0;o--)(c=t[o])&&(i=(n?c(e,r,i):c(i))||i);return n&&i&&Un(e,r,i),i},"provider_decorateClass");const jn=/^https?:\/\/dev\.azure\.com(?:\/defaultcollection)?\/(?<organization>[^/]+)(?:\/(?<project>[^_/][^/]*))?(?:\/_git)?\/(?<repo>[^/?#]+)(?:\/commit\/(?<commit>[0-9a-f]{40})|\/pullrequest\/(?<pull>\d+))?/i,ys=(0,B.loadMessageBundle)(),so=1,Sa=Object.freeze({id:"azurerepos",name:"Azure Repos"});function ti(t){const{scheme:e,metadata:r}=Qt.decodeAuthority(t),[,n,i,o,...c]=t.path.split("/");return{scheme:e,provider:Sa,name:`${n}/${i}/${o}`,repo:{organization:n,project:i,name:o},path:c.join("/")||"",ref:r==null?void 0:r.ref,idx:r==null?void 0:r.idx}}a(ti,"getAzDOMetadata");function Ui(t,e){const{repo:r}=e!=null?e:ti(t);return t.with({path:`/${r.organization}/${r.project}/${r.name}`,query:"",fragment:""})}a(Ui,"getAzDORootUri");function Ti(t,e,r){const{repo:{organization:n,name:i}}=t instanceof m.Uri?ti(t):t;return m.Uri.parse(`azurerepos://${Qt.encodeAuthority("azurerepos",{v:so,ref:{type:tt.Commit,id:e}})}/${n}/${i}/${r}`)}a(Ti,"getAzDORevisionUri");function co(t){var e,r,n,i,o,c;const l=jn.exec(t);if((l==null?void 0:l.groups)===void 0)return;const{organization:d,project:h,repo:S,commit:O}=l.groups,I=Je(m.Uri.parse(t)),P=/^GB(?<branchName>.+)/i.exec((e=I.version)!=null?e:""),$=/^GT(?<tagName>.+)/i.exec((r=I.version)!=null?r:""),N=/^GC(?<commit>[0-9a-f]{40})/i.exec((n=I.version)!=null?n:""),U=I.path&&I.path!=="/"?I.path:void 0;return{organization:d,project:h,repo:S,branch:(i=P==null?void 0:P.groups)==null?void 0:i.branchName,tag:(o=$==null?void 0:$.groups)==null?void 0:o.tagName,commit:O!=null?O:(c=N==null?void 0:N.groups)==null?void 0:c.commit,path:U}}a(co,"parseAzureReposUrl");class Ho{constructor(e){this.providerService=e}get isReadonly(){return!0}get scheme(){return"azurerepos"}dispose(){}async ensureAuthenticated(e=!1){const r=new ut("AzDO.ensureAuthenticated");try{if(this._session===void 0){async function n(){try{return await m.authentication.getSession(gr.id,Ht,{createIfNone:!0,forceNewSession:e})}catch{try{const o=await m.authentication.getSession(gr.id,Ht,{createIfNone:!1});if(o!==void 0)return o}catch{}return new Promise(o=>{async function c(){const d=await m.authentication.getSession(gr.id,Ht,{createIfNone:!0});d!==void 0&&o(d)}a(c,"getSession");const l=m.authentication.onDidChangeSessions(async d=>{d.provider.id===gr.id&&(l.dispose(),await c())})})}}a(n,"waitUntilAuthenticated"),this._session=await n();const i=m.authentication.onDidChangeSessions(o=>{if(this._session===void 0){i.dispose();return}o.provider.id===gr.id&&(this.clearAuthenticationSession(),i.dispose())})}return this._session}finally{r.stop()}}async getAuthentication(e){const r=await this.ensureAuthenticated();return{provider:Sa,session:r,getRichNavigationHeaders:()=>({"X-Git-AzureDevOps":`Basic ${this.getBase64AuthenticationSessionToken(r)}`})}}getBase64AuthenticationSessionToken(e){if(this._sessionTokenBase64===void 0){if(e===void 0)return this.ensureAuthenticated().then(r=>(this._sessionTokenBase64=Ci(`PAT:${r.accessToken}`),this._sessionTokenBase64));this._sessionTokenBase64=Ci(`PAT:${e.accessToken}`)}return this._sessionTokenBase64}clearAuthenticationSession(){this._session=void 0,this._sessionTokenBase64=void 0}async reauthenticate(){this.clearAuthenticationSession(),await this.ensureAuthenticated(!0)}async sendGetRequest(e,r,n,i){const c=`${n?`https://dev.azure.com/${e}/${n}/_apis/`:`https://dev.azure.com/${e}/_apis/`}${r}${i?`?${i}&`:"?"}api-version=5.1`;try{const l=await this.getBase64AuthenticationSessionToken();if(!l)throw new pt("Unauthenticated",()=>this.reauthenticate());const d=await Ye(c,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Basic ${l}`}});if(d.status===401)throw new pt("Unauthenticated",()=>this.reauthenticate());if(d.status===404)return;const h=await d.json();return h!=null?h:void 0}catch(l){throw L.error(l),l instanceof pt&&Xr.showStatus401Message(l.reauthenticate),l}}async sendPostRequest(e,r){try{const n=await this.getBase64AuthenticationSessionToken();if(!n)throw new pt("Unauthenticated",()=>this.reauthenticate());const i=await Ye(e,{method:"POST",body:r,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Basic ${n}`}});if(i.status===401)throw new pt("Unauthenticated",()=>this.reauthenticate());const o=await i.json();return o!=null?o:void 0}catch(n){throw L.error(n),n instanceof pt&&Xr.showStatus401Message(n.reauthenticate),n}}canOpenRemoteUrl(e){const r=co(e);if(r===void 0)return;const{branch:n,tag:i,commit:o,path:c}=r;return c?nt.File:n?nt.Branch:i?nt.Tag:o?nt.Commit:nt.Repository}async createWorkspaceForRemoteUrl(e,r=$t.CurrentWindow){const n=co(e);if(n===void 0)return;const{organization:i,project:o,repo:c,branch:l,tag:d,commit:h,path:S}=n;let O;l?O={type:tt.Branch,id:l}:d?O={type:tt.Tag,id:d}:h&&(O={type:tt.Commit,id:h});const I=this.providerService.createVirtualUri("azurerepos",{repo:{organization:i,project:o!=null?o:c,name:c},ref:O});return{name:(await this.providerService.getMetadata(I)).name,uri:I,location:r,filesToOpen:S?[S]:void 0}}createVirtualUri(e,{repo:r,ref:n,idx:i},o){if((n==null?void 0:n.type)===tt.Tree)throw new Error(`Invalid ref type '${n.type}'`);const c=n!==void 0||i!==void 0?{v:so}:void 0;return c&&(n&&(c.ref={type:n.type,id:n.id}),i&&(c.idx=i)),e.with({authority:Qt.encodeAuthority("azurerepos",c),path:`/${r.organization}/${r.project}/${r.name}${(o==null?void 0:o.startsWith("/"))?o:`/${o!=null?o:""}`}`})}getRemoteUri(e){const r=`https://dev.azure.com/${e.repo.organization}/${e.repo.project}/_git/${e.repo.name}`,n=e.path?`&path=/${e.path}`:"";return e.pullRequest?m.Uri.parse(r):e.branch?m.Uri.parse(`${r}?version=GB${e.branch}${n}`):e.tag?m.Uri.parse(`${r}?version=GT${e.tag}${n}`):e.sha?m.Uri.parse(`${r}?version=GC${e.sha}${n}`):m.Uri.parse(r)}getProviderRootUri(e){return Ui(e)}getRelativeFilePath(e,r){const{path:n}=ti(e),{path:i}=ti(We(e,r));return n.length!==0&&i!==n&&i.startsWith(n)?i.slice(n.length+1):i}getVirtualUriMetadata(e){const{provider:r,name:n,repo:i,ref:o}=ti(e);return{provider:r,name:n,repo:i,ref:o}}async validateBranchOrTagCasing(e,r,n,i){const o=`git/repositories/${n}/refs`,c="includeLinks=true",l=await this.sendGetRequest(e,o,r,c);if((l==null?void 0:l.value)===void 0){L.warn("Could not get branches, might be incorrect auth token");return}const d=l.value;if(d.length===0)return i?{type:tt.Branch,id:i}:void 0;const h=`refs/heads/${i.toLowerCase()}`,S=`refs/tags/${i.toLowerCase()}`;for(const O of d){const I=O.name;if(I.toLowerCase()==h)return{type:tt.Branch,id:I.substr(11)};if(I.toLowerCase()==S)return{type:tt.Tag,id:I.substr(10)}}}async getModeRefType(e,r){const{HEAD:n,pullRequest:i}=await(r!=null?r:this.getMetadata(e));switch(n.type){case Pe.Branch:return i!==void 0?ne.PullRequestBranch:ne.Branch;case Pe.RemoteBranch:return i!==void 0?ne.PullRequestRemoteBranch:ne.RemoteBranch;case Pe.Tag:return ne.Tag;case Pe.Commit:return ne.Commit}}async createMetadata(e,r){var n,i,o,c;const l=new ut(`AzDO.createMetadata(${e.toString()}, ${r})`);let d;try{let{provider:h,name:S,repo:{organization:O,project:I,name:P},ref:$}=ti(e);if(!$||$.type===tt.Commit&&/HEAD/i.test($.id))$={type:tt.Commit,id:"HEAD"};else if(($.type===tt.Branch||$.type===tt.Tag)&&($=await this.validateBranchOrTagCasing(O,I,P,$.id),$===void 0))throw new Error(`Cannot get metadata for Uri(${e.toString(!0)}); Unable to find the specified branch or tag`);const N=await this.getRepositoryInfo(O,I,P,$);if(N===void 0)throw d=" \u2022 Aborted; Unable to get repository info",new Error(`Cannot get metadata for Uri(${e.toString()}); Unable to get repository info`);let U;if(r)U=r;else if($.type===tt.Commit)U=$.id;else if(U=(i=(n=N.ref)==null?void 0:n.sha)!=null?i:N.defaultBranch.sha,U===void 0)throw d=" \u2022 Aborted; Unable to get repository revision",new Error(`Cannot get metadata for Uri(${e.toString()}); Unable to get repository info`);let W;((o=N.ref)==null?void 0:o.prefix)==="refs/heads/"?W={type:Pe.Branch,name:N.ref.name,sha:U,branch:{name:N.ref.name,sha:N.ref.sha}}:((c=N.ref)==null?void 0:c.prefix)==="refs/tags/"?W={type:Pe.Tag,name:N.ref.name,sha:U,detached:{type:Pe.Tag,name:N.ref.name}}:W={type:Pe.Commit,name:wt(U),sha:U,detached:{type:Pe.Commit,name:wt(U)}};const V={version:Ke.schemaVersion,timestamp:Date.now(),provider:h,name:S,repo:N.repo,user:N.user,accessLevel:N.accessLevel,HEAD:W,defaultBranch:N.defaultBranch,pullRequest:N.pullRequest};return d=` \u2022 HEAD=${W.sha}`,V}finally{l.stop(d?{suffix:d}:void 0)}}getMetadata(e){return this.providerService.getMetadata(e)}getRemoteWorkspaceSourceProviders(){return[{name:"Azure Repos",icon:"$(azure-devops)",label:ys("open repo from","Open Repository from {0}","Azure Repos"),placeholder:ys("pick repo","Choose a repository"),provideOrganization:async()=>{var e;return(e=await this.getOrganization())==null?void 0:e.label},provideProject:async e=>{var r;return(r=await this.getTeamProject(e))==null?void 0:r.label},provideSources:async(e,r,n,i)=>{if(n)return;const o=await this.searchRepositoriesQuery(e,r);return o==null?void 0:o.map(c=>({providerId:"azurerepos",name:c.name,icon:"$(repo)",description:`${c.fork?`$(repo-forked) ${c.fork}`:""}${c.stars>0?`${c.fork?" \u2022 ":""}$(star-full) ${c.stars}`:""}`,detail:c.description,url:c.url}))}}]}async createBranch(e,r,n,i){throw new Error("Branch creation is currently not supported")}async createCommit(e,r,n,i){throw new Error("Commit creation is currently not supported")}async createAndPushCommit(e,r,n,i,o){throw new Error("Commit creation is currently not supported")}async createPullRequest(e,r,n,i,o){throw new Error("PR creation is currently not supported")}async fetch(e,r){const{fetched:n,metadata:i}=await this.fetchCore(e,!1,r);n&&await this.providerService.updateMetadata(e,i)}async fetchCore(e,r,n){var i,o,c,l;const{force:d,to:h}={...n,force:r||(n==null?void 0:n.force)},S=new ut(`AzDO.fetch(${e.toString()}, force=${d}, to=${h})`);let O;try{const I=await this.getMetadata(e);if(I.HEAD.detached)return O=" \u2022 Skipped; detached HEAD",{fetched:!1,metadata:I};if(I.HEAD.type===Pe.RemoteBranch)return O=" \u2022 Skipped; remote branch",{fetched:!1,metadata:I};const P=await this.getBranchTips(e);if(!P)throw O=" \u2022 Unable to fetch branch tips",new xt(r);if(!d&&!h&&((i=P.defaultBranch)==null?void 0:i.sha)!==void 0&&P.defaultBranch.sha===I.defaultBranch.sha&&((o=P.branch)==null?void 0:o.sha)!==void 0&&P.branch.sha===I.HEAD.branch.sha)return O=" \u2022 No changes detected",{fetched:!1,metadata:I};let $;if(((c=P.defaultBranch)==null?void 0:c.sha)!==void 0&&P.defaultBranch.sha!==I.defaultBranch.sha&&($={defaultBranch:{...I.defaultBranch,sha:P.defaultBranch.sha}}),((l=P.branch)==null?void 0:l.sha)===void 0){if(O=" \u2022 Unable to find branch tip",d)throw new xt(r);return $!==void 0?{fetched:!0,metadata:{...I,...$}}:{fetched:!1,metadata:I}}return P.branch.sha!==I.HEAD.branch.sha&&($={...$,HEAD:{...I.HEAD,branch:{...I.HEAD.branch,sha:P.branch.sha},detached:void 0}}),P.branch.sha===I.HEAD.sha?(O=" \u2022 Up to date",I.state!==void 0||$!==void 0?{fetched:!0,metadata:{...I,...$,state:void 0}}:{fetched:!1,metadata:I}):$!==void 0?{fetched:!0,metadata:{...I,...$}}:{fetched:!1,metadata:I}}finally{S.stop(O?{suffix:O}:void 0)}}async fork(e){throw new Error("Forks are currently not supported")}async getBranches(e,r){try{const n=await this.getRefs(e,{...r,filter:"heads",filterContains:r==null?void 0:r.query});if(n.length===0)return{branches:[]};const i=[];for(const o of n)!o.name.startsWith("refs/heads/")||i.push({type:Dn.Head,name:o.name.substr(11),commit:o.objectId,commitUrl:o.url});return{branches:i}}catch(n){return{branches:[]}}}async getCommit(e,r){try{const{repo:{organization:n,project:i,name:o}}=await this.getMetadata(e),c=`git/repositories/${o}/commits/${r}`,l=await this.sendGetRequest(n,c,i);return l===void 0?void 0:{hash:l.commitId,message:l.comment,parents:l.parents,authorDate:new Date(l.author.date),authorEmail:l.author.email,authorName:l.author.name,commitDate:new Date(l.committer.date)}}catch(n){return}}async getCommits(e,r){var n,i;try{const{repo:{organization:o,project:c,name:l}}=await this.getMetadata(e),d=`git/repositories/${l}/commits`;let h=`searchCriteria.itemVersion.version=${(n=r==null?void 0:r.cursor)!=null?n:r==null?void 0:r.ref}&searchCriteria.itemVersion.versionType=commit`;(r==null?void 0:r.path)&&(h+=`&searchCriteria.itemPath=${r.path}`);const S=(i=r==null?void 0:r.limit)!=null?i:100;h+=`&searchCriteria.$top=${S+1}`;const O=await this.sendGetRequest(o,d,c,h);if((O==null?void 0:O.value)===void 0)return;const I=O.value.map(($,N)=>({hash:$.commitId,message:$.comment,parents:O.value[N+1]?[O.value[N+1].commitId]:[],authorDate:new Date($.author.date),authorEmail:$.author.email,authorName:$.author.name,commitDate:new Date($.committer.date)}));let P;return I.length>S&&(I.splice(I.length-1,1),P={cursor:I[I.length-1].hash,more:!0}),{commits:I,paging:P}}catch(o){return}}async getFileContent(e,r,n){var i,o;try{const{HEAD:c,repo:{organization:l,project:d,id:h},path:S}=await this.providerService.getMetadata(e);n=n!=null?n:S;const O=`git/repositories/${h}/items`;let I="";n&&(I+=`path=${n}&includeContent=true`),r||Nr((i=c.branch)==null?void 0:i.name)?I+=`&versionDescriptor.version=${r!=null?r:(o=c.branch)==null?void 0:o.name}&versionDescriptor.versionType=commit`:c.type===Pe.Branch?I+=`&versionDescriptor.version=${c.branch.name}&versionDescriptor.versionType=branch`:c.type===Pe.Tag&&(I+=`&versionDescriptor.version=${c.name}&versionDescriptor.versionType=tag`);const P=await this.sendGetRequest(l,O,d,I);if(P)return new TextEncoder().encode(P.content);throw m.FileSystemError.FileNotFound(e)}catch(c){throw L.logLevel===qe.Debug&&L.error(c),c}}async getFork(e){throw new Error("Forks are currently not supported")}async getIncomingChanges(e){var r,n;return(n=(r=(await this.getMetadata(e)).state)==null?void 0:r.incomingChanges)!=null?n:[]}async compareCommits(e,r){throw new Error("Comparing commits is currently not supported")}async getObjectDetails(e,r,n){throw new Error("Not able to get object detail")}async getPullRequest(e,r){throw new Error("PRs are currently not supported")}async getRepoItems(e,r,n){const i=`git/repositories/${e.repo.name}/items`,[,,,,...o]=r.split("/");let c=`scopePath=${o.join("/")}&recursionLevel=${n.recursionLevel}&includeContentMetadata=true`;e.HEAD.type===Pe.Commit?c+=`&versionDescriptor.version=${e.HEAD.sha}&versionDescriptor.versionType=commit`:e.HEAD.type===Pe.Branch?c+=`&versionDescriptor.version=${e.HEAD.branch.name}&versionDescriptor.versionType=branch`:e.HEAD.type===Pe.Tag&&(c+=`&versionDescriptor.version=${e.HEAD.name}&versionDescriptor.versionType=tag`);const l=await this.sendGetRequest(e.repo.organization,i,e.repo.project,c);return l&&Array.isArray(l==null?void 0:l.value)?l==null?void 0:l.value:(L.debug(`AzDOProvider.getRepoItems returned ${l===void 0?"empty":"invalid"} result ${l==null?void 0:l.value} for path ${r}`),[])}async getTags(e,r){try{const n=await this.getRefs(e,{...r,filter:"tags",filterContains:r==null?void 0:r.query});if(n.length===0)return{tags:[]};const i=[];for(const o of n)!o.name.startsWith("refs/tags/")||i.push({type:Dn.Tag,name:o.name.substr(10),commit:o.objectId,commitUrl:o.url});return{tags:i}}catch(n){return{tags:[]}}}async getTarGz(e,r){throw new Error("Getting zip is currently not supported")}async pushCommit(e,r,n,i){throw new Error("Commit pushing is not currently supported")}async getRefs(e,r){var n;const{repo:{organization:i,project:o,name:c}}=ti(e),l=`git/repositories/${c}/refs`;let d="includeLinks=true";(r==null?void 0:r.filter)&&(d+=`&filter=${r.filter}`),(r==null?void 0:r.filterContains)&&(d+=`&filterContains=${r.filterContains}`),(r==null?void 0:r.limit)&&(d+=`&$top=${r.limit}`);const h=await this.sendGetRequest(i,l,o,d);return(n=h==null?void 0:h.value)!=null?n:[]}async getOrganization(){const e=a(async()=>{const r=await this.getAccounts();return r?r.sort((n,i)=>n.accountName.localeCompare(i.accountName)).map(n=>({label:n.accountName})):[]},"getQuickPickItems");return m.window.showQuickPick(e(),{placeHolder:"Choose an Azure DevOps Organization",title:"Choose an Azure DevOps Organization",ignoreFocusOut:!0})}async getTeamProject(e){const r=a(async()=>{const n=await this.sendGetRequest(e,"projects");return(n==null?void 0:n.value)?n.value.sort((i,o)=>i.name.localeCompare(o.name)).map(i=>({label:i.name,description:i.description})):[]},"getQuickPickItems");return m.window.showQuickPick(r(),{placeholder:"Choose an Azure DevOps project",title:"Choose an Azure DevOps project",ignoreFocusOut:!0})}async searchRepositoriesQuery(e,r){try{const n=await this.sendGetRequest(e,"git/repositories",r);return n?n.value.filter(i=>i.defaultBranch&&!i.isDisabled).sort((i,o)=>i.name.localeCompare(o.name)).map(i=>({name:i.name,description:void 0,url:i.webUrl,fork:void 0,stars:0})):void 0}catch(n){throw L.error(n),n}}async getAccounts(){var e;try{const r=await this.getBase64AuthenticationSessionToken();if(!r)throw new pt("Unauthenticated",()=>this.reauthenticate());const i=`https://app.vssps.visualstudio.com/_apis/accounts?memberId=${(e=this._session)==null?void 0:e.account.id.split("/")[0]}&api-version=6.0`,o=await Ye(i,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Basic ${r}`}});if(o.status===401)throw new pt("Unauthenticated",()=>this.reauthenticate());return(await o.json()).value}catch(r){L.error(r);return}}async searchCodeQuery(e,r,n){var i;const{repo:{organization:o,project:c,name:l},HEAD:d,defaultBranch:h}=await this.getMetadata(r),S=`https://almsearch.dev.azure.com/${o}/${c}/_apis/search/codesearchresults?api-version=6.1-preview.1`,O=d.branch?d.branch.name:h.name,I={searchText:e,$skip:0,$top:1e3,filters:{Project:[c],Repository:[l],Path:["/"],Branch:[O]},$orderBy:[{field:"filename",sortOrder:"ASC"}],includeSnippet:!0},P=await this.sendPostRequest(S,JSON.stringify(I)),$=new m.Range(0,0,0,0),N=[];let U;for(const W of(i=P==null?void 0:P.results)!=null?i:[])for(const V of W.matches.content){U={path:W.path,ranges:[],preview:"",matches:[]};const ie=Math.max(0,V.line-1),oe=V.charOffset,ge=oe+V.length;U.preview=V.codeSnippet?V.codeSnippet:`CharOffset: ${V.charOffset}, Type: ${V.type}`,U.ranges.push(new m.Range(ie,oe,ie,ge)),U.matches.push($),N.push(U)}return{matches:N,limitHit:!1}}async switchTo(e,r,n){const{name:i,repo:o,HEAD:{branch:c}}=await this.getMetadata(e);let l;if(!(r!==void 0&&(typeof r=="string"?r.startsWith("refs/heads/")?l={type:tt.Branch,id:r.substr(11)}:r.startsWith("refs/tags/")?l={type:tt.Tag,id:r.substr(10)}:l={type:tt.Branch,id:r}:l={...r,type:r.type===tt.Tree?tt.Branch:r.type},(c==null?void 0:c.name)===l.id)))return{name:i,uri:this.providerService.createVirtualUri(e,{repo:o,ref:l}),location:(n==null?void 0:n.openInNewWindow)?$t.NewWindow:$t.CurrentWindow}}async sync(e,r,n){var i,o,c,l,d,h;const S=new ut(`AzDO.sync(${e.toString()}, resolution=${n.conflictResolution}, to=${n.to})`);let O;try{const{metadata:I}=await this.fetchCore(e,!0,{to:n.to});if(I.HEAD.detached){O=" \u2022 Skipped; detached HEAD";return}if(((o=(i=I==null?void 0:I.state)==null?void 0:i.behind)!=null?o:0)>0&&await r.hasChanges(e)){S.logStep("Fetching upstream changes");const P=[],$=(l=(c=I.state)==null?void 0:c.incomingChanges)!=null?l:[];if($.length>0){const N=await r.getChanges(e);for(const U of N){const W=this.providerService.getRelativeFilePath(e,U.uri),V=$.find(ie=>ie.uri.path===U.uri.path);if(V!==void 0){P.push({path:W,current:U,incomingType:V.type});break}}}if(P.length>0)switch(n.conflictResolution){case on.KeepCurrent:S.logStep("Syncing (keep) upstream changes",{message:`: ${P.length} conflicts; \u2022`,suffix:" \u2022 Syncing (keep) upstream changes..."});for(const N of P)await r.keep(N.current.uri,{type:N.incomingType,providerUri:Ti(I,I.HEAD.branch.sha,N.path)});break;case on.DiscardCurrent:S.logStep("Syncing (discard) upstream changes",{message:`: ${P.length} conflicts; \u2022`,suffix:" \u2022 Syncing (discard) upstream changes..."});for(const N of P)await r.discard(N.current.uri);break;case on.Merge:S.logStep("Syncing (merge) upstream changes",{message:`: ${P.length} conflicts; \u2022`,suffix:" \u2022 Syncing (merge) upstream changes..."});for(const N of P)await r.merge(N.current.uri,{type:N.incomingType,providerUri:Ti(I,I.HEAD.branch.sha,N.path)},{providerUri:Ti(I,I.HEAD.sha,N.path)});break;case on.Abort:default:throw S.logStep("Syncing (abort) upstream changes",{message:`: ${P.length} conflicts; \u2022`,suffix:" \u2022 Syncing (abort) upstream changes..."}),await this.providerService.updateMetadata(e,I),new qt}}O=` \u2022 to=${(d=n.to)!=null?d:I.HEAD.branch.sha}`,await this.fastForwardTo(e,(h=n.to)!=null?h:I.HEAD.branch.sha,I)}finally{S.stop(O?{suffix:O}:void 0)}}async fastForwardTo(e,r,n){if(n.HEAD.detached)throw new Ot("Unable to fast-forward; no current branch");n.HEAD.sha===r&&n.state===void 0||(L.log(`Fast forward to ${r}; rootUri=${e.toString()}`),await this.providerService.updateMetadata(e,{...n,HEAD:{...n.HEAD,detached:void 0,sha:r},state:void 0,timestamp:Date.now()}),r!==n.HEAD.branch.sha&&await this.fetchCore(e,!1,{to:r}))}async getBranchTips(e,r){try{const{repo:{organization:n,project:i,name:o},HEAD:{branch:c}}=await this.getMetadata(e);r===void 0?r=c?`heads/${c.name}`:"":r.startsWith("refs/")&&(r=r.slice(5));const l=`git/repositories/${o}/refs`,d=`includeLinks=true&filter=${r}`,h=await this.sendGetRequest(n,l,i,d),S=h==null?void 0:h.value;if(S===[])return;const O={target:{oid:S[0].objectId}},I=`git/repositories/${o}`,P=await this.sendGetRequest(n,I,i);let $=P==null?void 0:P.defaultBranch;$.startsWith("refs/")&&($=$.slice(5));const N=`git/repositories/${o}/refs`,U=`includeLinks=true&filter=${$}`,W=await this.sendGetRequest(n,N,i,U),V=W==null?void 0:W.value;if(V===[])return;const ie={target:{oid:V[0].objectId}};if(!ie&&!O)return;const oe=ie?{sha:ie.target.oid}:void 0,ge=O?{sha:O.target.oid}:void 0;return{defaultBranch:oe,branch:ge}}catch(n){return}}async getRepositoryId(e,r,n){const i=`git/repositories/${n}`,o=await this.sendGetRequest(e,i,r);if(o){if(o.id)return o.id;throw new Error("Sign in page was returned for repoId. Check the token sent")}throw new Error("Can't get Repo Id")}async getRepositoryInfo(e,r,n,i){const o=await this.getRepositoryId(e,r,n),c=`git/repositories/${o}`,l=await this.sendGetRequest(e,c,r);if(!l)return;l.defaultBranch.startsWith("refs/heads/")&&(l.defaultBranch=l.defaultBranch.substr(11));const d=`git/repositories/${n}/stats/branches`,h=`name=${l.defaultBranch}`,S=await this.sendGetRequest(e,d,r,h);if(!S)return;const O={user:"jepetty",repo:{organization:e,project:r,name:n,id:o},accessLevel:Ne.Read,defaultBranch:{name:S.name,sha:S.commit.commitId}};if(i.type===tt.Branch){const I=`git/repositories/${n}/stats/branches`,P=`name=${i.id}`,$=await this.sendGetRequest(e,I,r,P);if($)return{...O,ref:{name:$.name,sha:$.commit.commitId,prefix:"refs/heads/"}}}else if(i.type===tt.Tag){const I=`git/repositories/${o}/items`,P=`versionDescriptor.version=${i.id}&versionDescriptor.versionType=tag`,$=await this.sendGetRequest(e,I,r,P);if($&&$.value.length===1)return{...O,ref:{name:i.id,sha:$.value[0].commitId,prefix:"refs/tags/"}}}else{if(i.type===tt.Commit)return i.id==="HEAD"&&(i.id=l.defaultBranch),{...O,ref:{name:i.id,sha:Nr(i.id)?i.id:S.commit.commitId,prefix:Nr(i.id)?"":"refs/heads/"}};throw new Error("Not supported yet :(")}}}a(Ho,"AzDORepositoryProvider"),vs([tr()],Ho.prototype,"ensureAuthenticated",1);class Uo{constructor(e,r){this.providerService=e,this.changeStore=r,this.providers=[],this.handledRepositories=new Set,this.services=new Map,this.disposable=m.Disposable.from(e.onDidChangeRepositories(n=>{for(const i of n.added)this.repositoryOpened(i);for(const i of n.removed)this.repositoryClosed(i)}));for(const n of this.providerService.repositories)this.repositoryOpened(n)}dispose(){this.disposable.dispose()}register(e){const r=this.providers.length;return this.providers.push(e),{dispose:()=>this.providers.splice(r,1)}}async repositoryOpened(e){const r=te(e.uri);if(!this.handledRepositories.has(r)){this.handledRepositories.add(r);for(const n of this.providers){const i=await n.createNavigationService(this.providerService,e,this.changeStore);if(i!==void 0){const o=i();this.services.set(r,{service:o});break}}}}repositoryClosed(e){const r=te(e.uri);this.handledRepositories.delete(r);const n=this.services.get(r);n!==void 0&&(n.service.dispose(),this.services.delete(te(e.uri)))}}a(Uo,"CodeNavigationServices");/*! (c) Andrea Giammarchi - ISC */var vn={};try{(function(t,e){if(new t("q=%2B").get("q")!==e||new t({q:e}).get("q")!==e||new t([["q",e]]).get("q")!==e||new t(`q=
`).toString()!=="q=%0A"||new t({q:" &"}).toString()!=="q=+%26"||new t({q:"%zx"}).toString()!=="q=%25zx")throw t;vn.URLSearchParams=t})(URLSearchParams,"+")}catch(t){(function(e,r,n){"use strict";var i=e.create,o=e.defineProperty,c=/[!'\(\)~]|%20|%00/g,l=/%(?![0-9a-fA-F]{2})/g,d=/\+/g,h={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"},S={append:function(V,ie){$(this._ungap,V,ie)},delete:function(V){delete this._ungap[V]},get:function(V){return this.has(V)?this._ungap[V][0]:null},getAll:function(V){return this.has(V)?this._ungap[V].slice(0):[]},has:function(V){return V in this._ungap},set:function(V,ie){this._ungap[V]=[r(ie)]},forEach:function(V,ie){var oe=this;for(var ge in oe._ungap)oe._ungap[ge].forEach(ke,ge);function ke(Ie){V.call(ie,Ie,r(ge),oe)}a(ke,"invoke")},toJSON:function(){return{}},toString:function(){var V=[];for(var ie in this._ungap)for(var oe=U(ie),ge=0,ke=this._ungap[ie];ge<ke.length;ge++)V.push(oe+"="+U(ke[ge]));return V.join("&")}};for(var O in S)o(I.prototype,O,{configurable:!0,writable:!0,value:S[O]});vn.URLSearchParams=I;function I(V){var ie=i(null);switch(o(this,"_ungap",{value:ie}),!0){case!V:break;case typeof V=="string":V.charAt(0)==="?"&&(V=V.slice(1));for(var oe=V.split("&"),ge=0,ke=oe.length;ge<ke;ge++){var Ie=oe[ge],Oe=Ie.indexOf("=");-1<Oe?$(ie,N(Ie.slice(0,Oe)),N(Ie.slice(Oe+1))):Ie.length&&$(ie,N(Ie),"")}break;case n(V):for(var ge=0,ke=V.length;ge<ke;ge++){var Ie=V[ge];$(ie,Ie[0],Ie[1])}break;case"forEach"in V:V.forEach(P,ie);break;default:for(var Ze in V)$(ie,Ze,V[Ze])}}a(I,"URLSearchParams");function P(V,ie){$(this,ie,V)}a(P,"addEach");function $(V,ie,oe){var ge=n(oe)?oe.join(","):oe;ie in V?V[ie].push(ge):V[ie]=[ge]}a($,"appendTo");function N(V){return decodeURIComponent(V.replace(l,"%25").replace(d," "))}a(N,"decode");function U(V){return encodeURIComponent(V).replace(c,W)}a(U,"encode");function W(V){return h[V]}a(W,"replacer")})(Object,String,Array.isArray)}(function(t){var e=!1;try{e=!!Symbol.iterator}catch(n){}"forEach"in t||(t.forEach=a(function(i,o){var c=this,l=Object.create(null);this.toString().replace(/=[\s\S]*?(?:&|$)/g,"=").split("=").forEach(function(d){!d.length||d in l||(l[d]=c.getAll(d)).forEach(function(h){i.call(o,h,d,c)})})},"forEach")),"keys"in t||(t.keys=a(function(){return r(this,function(i,o){this.push(o)})},"keys")),"values"in t||(t.values=a(function(){return r(this,function(i,o){this.push(i)})},"values")),"entries"in t||(t.entries=a(function(){return r(this,function(i,o){this.push([o,i])})},"entries")),e&&!(Symbol.iterator in t)&&(t[Symbol.iterator]=t.entries),"sort"in t||(t.sort=a(function(){for(var i=this.entries(),o=i.next(),c=o.done,l=[],d=Object.create(null),h,S,O;!c;)O=o.value,S=O[0],l.push(S),S in d||(d[S]=[]),d[S].push(O[1]),o=i.next(),c=o.done;for(l.sort(),h=0;h<l.length;h++)this.delete(l[h]);for(h=0;h<l.length;h++)S=l[h],this.append(S,d[S].shift())},"sort"));function r(n,i){var o=[];return n.forEach(i,o),e?o[Symbol.iterator]():{next:function(){var c=o.shift();return{done:c===void 0,value:c}}}}a(r,"iterator"),function(n){var i=n.defineProperty,o=n.getOwnPropertyDescriptor,c=a(function(O){function I(N,U){t.append.call(this,N,U),N=this.toString(),O.set.call(this._usp,N?"?"+N:"")}a(I,"append");function P(N){t.delete.call(this,N),N=this.toString(),O.set.call(this._usp,N?"?"+N:"")}a(P,"del");function $(N,U){t.set.call(this,N,U),N=this.toString(),O.set.call(this._usp,N?"?"+N:"")}return a($,"set"),function(N,U){return N.append=I,N.delete=P,N.set=$,i(N,"_usp",{configurable:!0,writable:!0,value:U})}},"createSearchParamsPollute"),l=a(function(O){return function(I,P){return i(I,"_searchParams",{configurable:!0,writable:!0,value:O(P,I)}),P}},"createSearchParamsCreate"),d=a(function(O){var I=O.append;O.append=t.append,URLSearchParams.call(O,O._usp.search.slice(1)),O.append=I},"updateSearchParams"),h=a(function(O,I){if(!(O instanceof I))throw new TypeError("'searchParams' accessed on an object that does not implement interface "+I.name)},"verifySearchParams"),S=a(function(O){var I=O.prototype,P=o(I,"searchParams"),$=o(I,"href"),N=o(I,"search"),U;!P&&N&&N.set&&(U=l(c(N)),n.defineProperties(I,{href:{get:function(){return $.get.call(this)},set:function(W){var V=this._searchParams;$.set.call(this,W),V&&d(V)}},search:{get:function(){return N.get.call(this)},set:function(W){var V=this._searchParams;N.set.call(this,W),V&&d(V)}},searchParams:{get:function(){return h(this,O),this._searchParams||U(this,new URLSearchParams(this.search.slice(1)))},set:function(W){h(this,O),U(this,W)}}}))},"upgradeClass");try{S(HTMLAnchorElement),/^function|object$/.test(typeof URL)&&URL.prototype&&S(URL)}catch(O){}}(Object)})(vn.URLSearchParams.prototype,Object);const ri=vn.URLSearchParams;var yn=__webpack_require__(6822);const bt=(0,B.loadMessageBundle)(),sr=60,jo=sr*60,qn=jo*24,Br=qn*7,ni=qn*30,_s=qn*365;function lo(t,e){typeof t!="number"&&(t=t.getTime());const r=Math.round((new Date().getTime()-t)/1e3);if(r<-30)return bt("date.fromNow.in","in {0}",lo(new Date().getTime()+r*1e3,{ago:!1,short:e==null?void 0:e.short}));if(r<30)return(e==null?void 0:e.ago)?(e==null?void 0:e.short)?bt("date.fromNow.seconds.short.ago","secs ago"):bt("date.fromNow.seconds.ago","A few seconds ago"):(e==null?void 0:e.short)?bt("date.fromNow.now.short","now"):bt("date.fromNow.now","Just now");let n;return r<sr?(n=r,(e==null?void 0:e.ago)?n===1?(e==null?void 0:e.short)?bt("date.fromNow.seconds.singular.short.ago","{0} sec ago",n):bt("date.fromNow.seconds.singular.ago","{0} second ago",n):(e==null?void 0:e.short)?bt("date.fromNow.seconds.plural.short.ago","{0} secs ago",n):bt("date.fromNow.seconds.plural.ago","{0} seconds ago",n):n===1?(e==null?void 0:e.short)?bt("date.fromNow.seconds.singular.short","{0} sec",n):bt("date.fromNow.seconds.singular","{0} second",n):(e==null?void 0:e.short)?bt("date.fromNow.seconds.plural.short","{0} secs",n):bt("date.fromNow.seconds.plural","{0} seconds",n)):r<jo?(n=Math.floor(r/sr),(e==null?void 0:e.ago)?n===1?(e==null?void 0:e.short)?bt("date.fromNow.minutes.singular.short.ago","{0} min ago",n):bt("date.fromNow.minutes.singular.ago","{0} minute ago",n):(e==null?void 0:e.short)?bt("date.fromNow.minutes.plural.short.ago","{0} mins ago",n):bt("date.fromNow.minutes.plural.ago","{0} minutes ago",n):n===1?(e==null?void 0:e.short)?bt("date.fromNow.minutes.singular.short","{0} min",n):bt("date.fromNow.minutes.singular","{0} minute",n):(e==null?void 0:e.short)?bt("date.fromNow.minutes.plural.short","{0} mins",n):bt("date.fromNow.minutes.plural","{0} minutes",n)):r<qn?(n=Math.floor(r/jo),(e==null?void 0:e.ago)?n===1?(e==null?void 0:e.short)?bt("date.fromNow.hours.singular.short.ago","{0} hr ago",n):bt("date.fromNow.hours.singular.ago","{0} hour ago",n):(e==null?void 0:e.short)?bt("date.fromNow.hours.plural.short.ago","{0} hrs ago",n):bt("date.fromNow.hours.plural.ago","{0} hours ago",n):n===1?(e==null?void 0:e.short)?bt("date.fromNow.hours.singular.short","{0} hr",n):bt("date.fromNow.hours.singular","{0} hour",n):(e==null?void 0:e.short)?bt("date.fromNow.hours.plural.short","{0} hrs",n):bt("date.fromNow.hours.plural","{0} hours",n)):r<Br?(n=Math.floor(r/qn),(e==null?void 0:e.ago)?n===1?bt("date.fromNow.days.singular.ago","{0} day ago",n):bt("date.fromNow.days.plural.ago","{0} days ago",n):n===1?bt("date.fromNow.days.singular","{0} day",n):bt("date.fromNow.days.plural","{0} days",n)):r<ni?(n=Math.floor(r/Br),(e==null?void 0:e.ago)?n===1?(e==null?void 0:e.short)?bt("date.fromNow.weeks.singular.short.ago","{0} wk ago",n):bt("date.fromNow.weeks.singular.ago","{0} week ago",n):(e==null?void 0:e.short)?bt("date.fromNow.weeks.plural.short.ago","{0} wks ago",n):bt("date.fromNow.weeks.plural.ago","{0} weeks ago",n):n===1?(e==null?void 0:e.short)?bt("date.fromNow.weeks.singular.short","{0} wk",n):bt("date.fromNow.weeks.singular","{0} week",n):(e==null?void 0:e.short)?bt("date.fromNow.weeks.plural.short","{0} wks",n):bt("date.fromNow.weeks.plural","{0} weeks",n)):r<_s?(n=Math.floor(r/ni),(e==null?void 0:e.ago)?n===1?(e==null?void 0:e.short)?bt("date.fromNow.months.singular.short.ago","{0} mo ago",n):bt("date.fromNow.months.singular.ago","{0} month ago",n):(e==null?void 0:e.short)?bt("date.fromNow.months.plural.short.ago","{0} mos ago",n):bt("date.fromNow.months.plural.ago","{0} months ago",n):n===1?(e==null?void 0:e.short)?bt("date.fromNow.months.singular.short","{0} mo",n):bt("date.fromNow.months.singular","{0} month",n):(e==null?void 0:e.short)?bt("date.fromNow.months.plural.short","{0} mos",n):bt("date.fromNow.months.plural","{0} months",n)):(n=Math.floor(r/_s),(e==null?void 0:e.ago)?n===1?(e==null?void 0:e.short)?bt("date.fromNow.years.singular.short.ago","{0} yr ago",n):bt("date.fromNow.years.singular.ago","{0} year ago",n):(e==null?void 0:e.short)?bt("date.fromNow.years.plural.short.ago","{0} yrs ago",n):bt("date.fromNow.years.plural.ago","{0} years ago",n):n===1?(e==null?void 0:e.short)?bt("date.fromNow.years.singular.short","{0} yr",n):bt("date.fromNow.years.singular","{0} year",n):(e==null?void 0:e.short)?bt("date.fromNow.years.plural.short","{0} yrs",n):bt("date.fromNow.years.plural","{0} years",n))}a(lo,"fromNow");var ws,Hr;(function(t){t.None=0,t.First=1,t.AsOld=t.First,t.Last=2,t.AsNew=t.Last})(Hr||(Hr={}));class bs{constructor(){this[ws]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return(e=this._head)==null?void 0:e.value}get last(){var e;return(e=this._tail)==null?void 0:e.value}has(e){return this._map.has(e)}get(e,r=Hr.None){const n=this._map.get(e);if(!!n)return r!==Hr.None&&this.touch(n,r),n.value}set(e,r,n=Hr.None){let i=this._map.get(e);if(i)i.value=r,n!==Hr.None&&this.touch(i,n);else{switch(i={key:e,value:r,next:void 0,previous:void 0},n){case Hr.None:this.addItemLast(i);break;case Hr.First:this.addItemFirst(i);break;case Hr.Last:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i),this._size++}return this}delete(e){return Boolean(this.remove(e))}remove(e){const r=this._map.get(e);if(!!r)return this._map.delete(e),this.removeItem(r),this._size--,r.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,r){const n=this._state;let i=this._head;for(;i;){if(r?e.bind(r)(i.value,i.key,this):e(i.value,i.key,this),this._state!==n)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){const e=this._state;let r=this._head;const n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(r){const i={value:r.key,done:!1};return r=r.next,i}return{value:void 0,done:!0}}};return n}values(){const e=this._state;let r=this._head;const n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(r){const i={value:r.value,done:!1};return r=r.next,i}return{value:void 0,done:!0}}};return n}entries(){const e=this._state;let r=this._head;const n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(r){const i={value:[r.key,r.value],done:!1};return r=r.next,i}return{value:void 0,done:!0}}};return n}[(ws=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let r=this._head,n=this.size;for(;r&&n>e;)this._map.delete(r.key),r=r.next,n--;this._head=r,this._size=n,r&&(r.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const r=e.next,n=e.previous;if(!r||!n)throw new Error("Invalid list");r.previous=n,n.next=r}e.next=void 0,e.previous=void 0,this._state++}touch(e,r){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(r!==Hr.First&&r!==Hr.Last)){if(r===Hr.First){if(e===this._head)return;const n=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(n.previous=i,i.next=n),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(r===Hr.Last){if(e===this._tail)return;const n=e.next,i=e.previous;e===this._head?(n.previous=void 0,this._head=n):(n.previous=i,i.next=n),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){const e=[];return this.forEach((r,n)=>{e.push([n,r])}),e}fromJSON(e){this.clear();for(const[r,n]of e)this.set(r,n)}}a(bs,"LinkedMap");class Dr extends bs{constructor(e,r=1){super();this._limit=e,this._ratio=Math.min(Math.max(0,r),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,r=Hr.AsNew){return super.get(e,r)}peek(e){return super.get(e,Hr.None)}set(e,r){return super.set(e,r,Hr.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}a(Dr,"LRUCache");function Ec(t,e,r){return new oi(new ii(t),new ii(e)).ComputeDiff(r).changes}a(Ec,"stringDiff");class zn{constructor(e,r,n,i){this.originalStart=e,this.originalLength=r,this.modifiedStart=n,this.modifiedLength=i}getOriginalEnd(){return this.originalStart+this.originalLength}getModifiedEnd(){return this.modifiedStart+this.modifiedLength}}a(zn,"DiffChange");var uo;(function(t){t[t.MAX_SAFE_SMALL_INTEGER=1073741824]="MAX_SAFE_SMALL_INTEGER",t[t.MIN_SAFE_SMALL_INTEGER=-1073741824]="MIN_SAFE_SMALL_INTEGER",t[t.MAX_UINT_8=255]="MAX_UINT_8",t[t.MAX_UINT_16=65535]="MAX_UINT_16",t[t.MAX_UINT_32=4294967295]="MAX_UINT_32",t[t.UNICODE_SUPPLEMENTARY_PLANE_BEGIN=65536]="UNICODE_SUPPLEMENTARY_PLANE_BEGIN"})(uo||(uo={}));function Ss(t,e){return(e<<5)-e+t|0}a(Ss,"numberHash");function xc(t,e){e=Ss(149417,e);for(let r=0,n=t.length;r<n;r++)e=Ss(t.charCodeAt(r),e);return e}a(xc,"stringHash");class ii{constructor(e){this.source=e}getElements(){const e=this.source,r=new Int32Array(e.length);for(let n=0,i=e.length;n<i;n++)r[n]=e.charCodeAt(n);return r}}a(ii,"StringDiffSequence");class Ai{static Assert(e,r){if(!e)throw new Error(r)}}a(Ai,"Debug");class Ri{static Copy(e,r,n,i,o){for(let c=0;c<o;c++)n[i+c]=e[r+c]}static Copy2(e,r,n,i,o){for(let c=0;c<o;c++)n[i+c]=e[r+c]}}a(Ri,"MyArray");var Es;(function(t){t[t.MaxDifferencesHistory=1447]="MaxDifferencesHistory"})(Es||(Es={}));class ho{constructor(){this.m_changes=[],this.m_originalStart=1073741824,this.m_modifiedStart=1073741824,this.m_originalCount=0,this.m_modifiedCount=0}MarkNextChange(){(this.m_originalCount>0||this.m_modifiedCount>0)&&this.m_changes.push(new zn(this.m_originalStart,this.m_originalCount,this.m_modifiedStart,this.m_modifiedCount)),this.m_originalCount=0,this.m_modifiedCount=0,this.m_originalStart=1073741824,this.m_modifiedStart=1073741824}AddOriginalElement(e,r){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,r),this.m_originalCount++}AddModifiedElement(e,r){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,r),this.m_modifiedCount++}getChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes}getReverseChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes.reverse(),this.m_changes}}a(ho,"DiffChangeHelper");class oi{constructor(e,r,n=null){this.ContinueProcessingPredicate=n,this._originalSequence=e,this._modifiedSequence=r;const[i,o,c]=oi._getElements(e),[l,d,h]=oi._getElements(r);this._hasStrings=c&&h,this._originalStringElements=i,this._originalElementsOrHash=o,this._modifiedStringElements=l,this._modifiedElementsOrHash=d,this.m_forwardHistory=[],this.m_reverseHistory=[]}static _isStringArray(e){return e.length>0&&typeof e[0]=="string"}static _getElements(e){const r=e.getElements();if(oi._isStringArray(r)){const n=new Int32Array(r.length);for(let i=0,o=r.length;i<o;i++)n[i]=xc(r[i],0);return[r,n,!0]}return r instanceof Int32Array?[[],r,!1]:[[],new Int32Array(r),!1]}ElementsAreEqual(e,r){return this._originalElementsOrHash[e]!==this._modifiedElementsOrHash[r]?!1:this._hasStrings?this._originalStringElements[e]===this._modifiedStringElements[r]:!0}ElementsAreStrictEqual(e,r){if(!this.ElementsAreEqual(e,r))return!1;const n=oi._getStrictElement(this._originalSequence,e),i=oi._getStrictElement(this._modifiedSequence,r);return n===i}static _getStrictElement(e,r){return typeof e.getStrictElement=="function"?e.getStrictElement(r):null}OriginalElementsAreEqual(e,r){return this._originalElementsOrHash[e]!==this._originalElementsOrHash[r]?!1:this._hasStrings?this._originalStringElements[e]===this._originalStringElements[r]:!0}ModifiedElementsAreEqual(e,r){return this._modifiedElementsOrHash[e]!==this._modifiedElementsOrHash[r]?!1:this._hasStrings?this._modifiedStringElements[e]===this._modifiedStringElements[r]:!0}ComputeDiff(e){return this._ComputeDiff(0,this._originalElementsOrHash.length-1,0,this._modifiedElementsOrHash.length-1,e)}_ComputeDiff(e,r,n,i,o){const c=[!1];let l=this.ComputeDiffRecursive(e,r,n,i,c);return o&&(l=this.PrettifyChanges(l)),{quitEarly:c[0],changes:l}}ComputeDiffRecursive(e,r,n,i,o){for(o[0]=!1;e<=r&&n<=i&&this.ElementsAreEqual(e,n);)e++,n++;for(;r>=e&&i>=n&&this.ElementsAreEqual(r,i);)r--,i--;if(e>r||n>i){let O;return n<=i?(Ai.Assert(e===r+1,"originalStart should only be one more than originalEnd"),O=[new zn(e,0,n,i-n+1)]):e<=r?(Ai.Assert(n===i+1,"modifiedStart should only be one more than modifiedEnd"),O=[new zn(e,r-e+1,n,0)]):(Ai.Assert(e===r+1,"originalStart should only be one more than originalEnd"),Ai.Assert(n===i+1,"modifiedStart should only be one more than modifiedEnd"),O=[]),O}const c=[0],l=[0],d=this.ComputeRecursionPoint(e,r,n,i,c,l,o),h=c[0],S=l[0];if(d!==null)return d;if(!o[0]){const O=this.ComputeDiffRecursive(e,h,n,S,o);let I=[];return o[0]?I=[new zn(h+1,r-(h+1)+1,S+1,i-(S+1)+1)]:I=this.ComputeDiffRecursive(h+1,r,S+1,i,o),this.ConcatenateChanges(O,I)}return[new zn(e,r-e+1,n,i-n+1)]}WALKTRACE(e,r,n,i,o,c,l,d,h,S,O,I,P,$,N,U,W,V){let ie=null,oe=null,ge=new ho,ke=r,Ie=n,Oe=P[0]-U[0]-i,Ze=-1073741824,$e=this.m_forwardHistory.length-1;do{const ze=Oe+e;ze===ke||ze<Ie&&h[ze-1]<h[ze+1]?(O=h[ze+1],$=O-Oe-i,O<Ze&&ge.MarkNextChange(),Ze=O,ge.AddModifiedElement(O+1,$),Oe=ze+1-e):(O=h[ze-1]+1,$=O-Oe-i,O<Ze&&ge.MarkNextChange(),Ze=O-1,ge.AddOriginalElement(O,$+1),Oe=ze-1-e),$e>=0&&(h=this.m_forwardHistory[$e],e=h[0],ke=1,Ie=h.length-1)}while(--$e>=-1);if(ie=ge.getReverseChanges(),V[0]){let ze=P[0]+1,st=U[0]+1;if(ie!==null&&ie.length>0){const Mt=ie[ie.length-1];ze=Math.max(ze,Mt.getOriginalEnd()),st=Math.max(st,Mt.getModifiedEnd())}oe=[new zn(ze,I-ze+1,st,N-st+1)]}else{ge=new ho,ke=c,Ie=l,Oe=P[0]-U[0]-d,Ze=1073741824,$e=W?this.m_reverseHistory.length-1:this.m_reverseHistory.length-2;do{const ze=Oe+o;ze===ke||ze<Ie&&S[ze-1]>=S[ze+1]?(O=S[ze+1]-1,$=O-Oe-d,O>Ze&&ge.MarkNextChange(),Ze=O+1,ge.AddOriginalElement(O+1,$+1),Oe=ze+1-o):(O=S[ze-1],$=O-Oe-d,O>Ze&&ge.MarkNextChange(),Ze=O,ge.AddModifiedElement(O+1,$+1),Oe=ze-1-o),$e>=0&&(S=this.m_reverseHistory[$e],o=S[0],ke=1,Ie=S.length-1)}while(--$e>=-1);oe=ge.getChanges()}return this.ConcatenateChanges(ie,oe)}ComputeRecursionPoint(e,r,n,i,o,c,l){let d=0,h=0,S=0,O=0,I=0,P=0;e--,n--,o[0]=0,c[0]=0,this.m_forwardHistory=[],this.m_reverseHistory=[];const $=r-e+(i-n),N=$+1,U=new Int32Array(N),W=new Int32Array(N),V=i-n,ie=r-e,oe=e-n,ge=r-i,Ie=(ie-V)%2==0;U[V]=e,W[ie]=r,l[0]=!1;for(let Oe=1;Oe<=$/2+1;Oe++){let Ze=0,$e=0;S=this.ClipDiagonalBound(V-Oe,Oe,V,N),O=this.ClipDiagonalBound(V+Oe,Oe,V,N);for(let st=S;st<=O;st+=2){st===S||st<O&&U[st-1]<U[st+1]?d=U[st+1]:d=U[st-1]+1,h=d-(st-V)-oe;const Mt=d;for(;d<r&&h<i&&this.ElementsAreEqual(d+1,h+1);)d++,h++;if(U[st]=d,d+h>Ze+$e&&(Ze=d,$e=h),!Ie&&Math.abs(st-ie)<=Oe-1&&d>=W[st])return o[0]=d,c[0]=h,Mt<=W[st]&&1447>0&&Oe<=1447+1?this.WALKTRACE(V,S,O,oe,ie,I,P,ge,U,W,d,r,o,h,i,c,Ie,l):null}const ze=(Ze-e+($e-n)-Oe)/2;if(this.ContinueProcessingPredicate!==null&&!this.ContinueProcessingPredicate(Ze,ze))return l[0]=!0,o[0]=Ze,c[0]=$e,ze>0&&1447>0&&Oe<=1447+1?this.WALKTRACE(V,S,O,oe,ie,I,P,ge,U,W,d,r,o,h,i,c,Ie,l):(e++,n++,[new zn(e,r-e+1,n,i-n+1)]);I=this.ClipDiagonalBound(ie-Oe,Oe,ie,N),P=this.ClipDiagonalBound(ie+Oe,Oe,ie,N);for(let st=I;st<=P;st+=2){st===I||st<P&&W[st-1]>=W[st+1]?d=W[st+1]-1:d=W[st-1],h=d-(st-ie)-ge;const Mt=d;for(;d>e&&h>n&&this.ElementsAreEqual(d,h);)d--,h--;if(W[st]=d,Ie&&Math.abs(st-V)<=Oe&&d<=U[st])return o[0]=d,c[0]=h,Mt>=U[st]&&1447>0&&Oe<=1447+1?this.WALKTRACE(V,S,O,oe,ie,I,P,ge,U,W,d,r,o,h,i,c,Ie,l):null}if(Oe<=1447){let st=new Int32Array(O-S+2);st[0]=V-S+1,Ri.Copy2(U,S,st,1,O-S+1),this.m_forwardHistory.push(st),st=new Int32Array(P-I+2),st[0]=ie-I+1,Ri.Copy2(W,I,st,1,P-I+1),this.m_reverseHistory.push(st)}}return this.WALKTRACE(V,S,O,oe,ie,I,P,ge,U,W,d,r,o,h,i,c,Ie,l)}PrettifyChanges(e){for(let r=0;r<e.length;r++){const n=e[r],i=r<e.length-1?e[r+1].originalStart:this._originalElementsOrHash.length,o=r<e.length-1?e[r+1].modifiedStart:this._modifiedElementsOrHash.length,c=n.originalLength>0,l=n.modifiedLength>0;for(;n.originalStart+n.originalLength<i&&n.modifiedStart+n.modifiedLength<o&&(!c||this.OriginalElementsAreEqual(n.originalStart,n.originalStart+n.originalLength))&&(!l||this.ModifiedElementsAreEqual(n.modifiedStart,n.modifiedStart+n.modifiedLength));){const h=this.ElementsAreStrictEqual(n.originalStart,n.modifiedStart);if(this.ElementsAreStrictEqual(n.originalStart+n.originalLength,n.modifiedStart+n.modifiedLength)&&!h)break;n.originalStart++,n.modifiedStart++}let d=[null];if(r<e.length-1&&this.ChangesOverlap(e[r],e[r+1],d)){e[r]=d[0],e.splice(r+1,1),r--;continue}}for(let r=e.length-1;r>=0;r--){const n=e[r];let i=0,o=0;if(r>0){const O=e[r-1];i=O.originalStart+O.originalLength,o=O.modifiedStart+O.modifiedLength}const c=n.originalLength>0,l=n.modifiedLength>0;let d=0,h=this._boundaryScore(n.originalStart,n.originalLength,n.modifiedStart,n.modifiedLength);for(let O=1;;O++){const I=n.originalStart-O,P=n.modifiedStart-O;if(I<i||P<o||c&&!this.OriginalElementsAreEqual(I,I+n.originalLength)||l&&!this.ModifiedElementsAreEqual(P,P+n.modifiedLength))break;const N=(I===i&&P===o?5:0)+this._boundaryScore(I,n.originalLength,P,n.modifiedLength);N>h&&(h=N,d=O)}n.originalStart-=d,n.modifiedStart-=d;const S=[null];if(r>0&&this.ChangesOverlap(e[r-1],e[r],S)){e[r-1]=S[0],e.splice(r,1),r++;continue}}if(this._hasStrings)for(let r=1,n=e.length;r<n;r++){const i=e[r-1],o=e[r],c=o.originalStart-i.originalStart-i.originalLength,l=i.originalStart,d=o.originalStart+o.originalLength,h=d-l,S=i.modifiedStart,O=o.modifiedStart+o.modifiedLength,I=O-S;if(c<5&&h<20&&I<20){const P=this._findBetterContiguousSequence(l,h,S,I,c);if(P){const[$,N]=P;($!==i.originalStart+i.originalLength||N!==i.modifiedStart+i.modifiedLength)&&(i.originalLength=$-i.originalStart,i.modifiedLength=N-i.modifiedStart,o.originalStart=$+c,o.modifiedStart=N+c,o.originalLength=d-o.originalStart,o.modifiedLength=O-o.modifiedStart)}}}return e}_findBetterContiguousSequence(e,r,n,i,o){if(r<o||i<o)return null;const c=e+r-o+1,l=n+i-o+1;let d=0,h=0,S=0;for(let O=e;O<c;O++)for(let I=n;I<l;I++){const P=this._contiguousSequenceScore(O,I,o);P>0&&P>d&&(d=P,h=O,S=I)}return d>0?[h,S]:null}_contiguousSequenceScore(e,r,n){let i=0;for(let o=0;o<n;o++){if(!this.ElementsAreEqual(e+o,r+o))return 0;i+=this._originalStringElements[e+o].length}return i}_OriginalIsBoundary(e){return e<=0||e>=this._originalElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._originalStringElements[e])}_OriginalRegionIsBoundary(e,r){if(this._OriginalIsBoundary(e)||this._OriginalIsBoundary(e-1))return!0;if(r>0){const n=e+r;if(this._OriginalIsBoundary(n-1)||this._OriginalIsBoundary(n))return!0}return!1}_ModifiedIsBoundary(e){return e<=0||e>=this._modifiedElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._modifiedStringElements[e])}_ModifiedRegionIsBoundary(e,r){if(this._ModifiedIsBoundary(e)||this._ModifiedIsBoundary(e-1))return!0;if(r>0){const n=e+r;if(this._ModifiedIsBoundary(n-1)||this._ModifiedIsBoundary(n))return!0}return!1}_boundaryScore(e,r,n,i){const o=this._OriginalRegionIsBoundary(e,r)?1:0,c=this._ModifiedRegionIsBoundary(n,i)?1:0;return o+c}ConcatenateChanges(e,r){let n=[];if(e.length===0||r.length===0)return r.length>0?r:e;if(this.ChangesOverlap(e[e.length-1],r[0],n)){const i=new Array(e.length+r.length-1);return Ri.Copy(e,0,i,0,e.length-1),i[e.length-1]=n[0],Ri.Copy(r,1,i,e.length,r.length-1),i}else{const i=new Array(e.length+r.length);return Ri.Copy(e,0,i,0,e.length),Ri.Copy(r,0,i,e.length,r.length),i}}ChangesOverlap(e,r,n){if(Ai.Assert(e.originalStart<=r.originalStart,"Left change is not less than or equal to right change"),Ai.Assert(e.modifiedStart<=r.modifiedStart,"Left change is not less than or equal to right change"),e.originalStart+e.originalLength>=r.originalStart||e.modifiedStart+e.modifiedLength>=r.modifiedStart){const i=e.originalStart;let o=e.originalLength;const c=e.modifiedStart;let l=e.modifiedLength;return e.originalStart+e.originalLength>=r.originalStart&&(o=r.originalStart+r.originalLength-e.originalStart),e.modifiedStart+e.modifiedLength>=r.modifiedStart&&(l=r.modifiedStart+r.modifiedLength-e.modifiedStart),n[0]=new zn(i,o,c,l),!0}else return n[0]=null,!1}ClipDiagonalBound(e,r,n,i){if(e>=0&&e<i)return e;const o=n,c=i-n-1,l=r%2==0;if(e<0){const d=o%2==0;return l===d?0:1}else{const d=c%2==0;return l===d?i-1:i-2}}}a(oi,"LcsDiff");var ai;(function(t){function e(n,i){return n instanceof rt?i:new m.Position(i.line,i.character)}a(e,"makePosition"),t.makePosition=e;function r(n,i){return n instanceof rt?i:new m.Range(i.start.line,i.start.character,i.end.line,i.end.character)}a(r,"makeRange"),t.makeRange=r})(ai||(ai={}));var xs;(function(t){t[t.index2code=1]="index2code",t[t.code2Index=2]="code2Index"})(xs||(xs={}));const ee=a(class{constructor(t,e,r,n){this.diffCache=new Dr(32),this.indexDocumentCache=new Dr(32),this.codeDocumentCache=new Dr(32),this.providerService=t,this.rootUri=e,this.index=r,this.code=n,this.changes=this.computeChanges()}async computeChanges(){if(this.index===this.code)return new Map;const t=await this.providerService.compareCommits(this.rootUri,{base:this.index,compare:this.code});return t===void 0?new Map:new Map(t.map(e=>[e.uri.toString(),e.type]))}async needsMapping(t){const e=t.uri;if(!e.toString().startsWith(this.rootUri.toString()))return!1;if((await this.changes).get(e.toString())!==void 0)return!0;const i=await this.getIndexDocument(e);return i===void 0?!0:this.getDiff(1,i,t).length!==0}async mapPositionFromCodeToIndex(t,e){const r=t.uri;if(!r.toString().startsWith(this.rootUri.toString()))return;const i=(await this.changes).get(r.toString());if(i===Dt.Created||i===Dt.Deleted)return;const o=await this.getIndexDocument(r);if(o===void 0)return;const c=this.getDiff(2,o,t);if(c.length===0)return e;const l=t.offsetAt(new m.Position(e.line,e.character));let d=l;for(const I of c){if(I.modifiedStart<=l&&l<I.modifiedStart+I.modifiedLength)return;if(d<I.modifiedStart)break;d=d-(I.modifiedLength-I.originalLength)}const h=o.positionAt(d),S=this.getWordAtOffset(o.lineAt(h.line).text,h.character),O=this.getWordAtOffset(t.lineAt(e.line).text,e.character);if(!(S===void 0||O===void 0||S!==O))return new m.Position(h.line,h.character)}async mapRangeFromIndexToCode(t,e){const r=t instanceof m.Uri?t:t.uri;if(!r.toString().startsWith(this.rootUri.toString()))return;const i=(await this.changes).get(r.toString());if(i===Dt.Created||i===Dt.Deleted)return;const[o,c]=await Promise.all([this.getIndexDocument(r),this.getCodeDocument(t)]);if(o===void 0||c===void 0)return;const l=this.getDiff(1,o,c);if(l.length===0)return e;const d=o.offsetAt(e.start);let h=d;const S=o.offsetAt(e.end);let O=S;for(const U of l){if(O<U.originalStart)break;const W=U.modifiedLength-U.originalLength;if(U.originalStart<=d){if(d<U.originalStart+U.originalLength)return;h+=W}else if(S<U.originalStart+U.originalLength)return;if(U.originalStart<=S){if(S<U.originalStart+U.originalLength)return;O+=W}}const I=c.positionAt(h),P=c.positionAt(O),$=o.getText(e),N=c.getText(ai.makeRange(c,{start:I,end:P}));if($===N)return new m.Range(I.line,I.character,P.line,P.character)}async getIndexDocument(t){return this.getDocument(this.indexDocumentCache,t,this.index)}async getCodeDocument(t){return t instanceof m.Uri?this.getDocument(this.codeDocumentCache,t,this.code):t}async getDocument(t,e,r){let n=t.get(e.toString());if(n!==null)return n!==void 0||(n=this._getDocument(e,r),t.set(e.toString(),n),n.then(i=>{i===void 0&&t.set(e.toString(),null)},void 0)),n}async _getDocument(t,e){const r=t.toString().substr(this.rootUri.toString().length);return this.providerService.getFileContent(this.rootUri,e,r).then(n=>new rt(t,Number.MAX_VALUE,ee.textDecoder.decode(n)),()=>{})}getDiff(t,e,r){if(e.uri.toString()!==r.uri.toString())throw new Error(`Original (${e.uri.toString()}) and modified (${r.uri.toString()}) are pointing to a different document`);const n=`${t}${e.uri.toString()}`;let i=this.diffCache.get(n);return i!==void 0&&i.original===e.version&&i.modified===r.version||(i={original:e.version,modified:r.version,changes:Ec(e.getText(),r.getText(),!0)},this.diffCache.set(n,i)),i.changes}getWordAtOffset(t,e){let r="findStart",n=0,i=t.length,o=0;for(;o<t.length&&r!=="endFound";){switch(o===e&&(r="findEnd"),t[o]){case" ":case"	":case"(":case")":case"[":case"]":case"{":case"}":case"'":case'"':case"`":switch(r){case"findStart":n=o+1;break;case"findEnd":i=o,r="endFound";break}break}o++}return r==="endFound"?t.substring(n,i):void 0}},"_DiffMapper");let me=ee;me.textDecoder=new TextDecoder("utf8");var Re;(function(t){t[t.LineFeed=10]="LineFeed",t[t.CarriageReturn=13]="CarriageReturn"})(Re||(Re={}));class rt{static computeLineOffsets(e,r,n=0){const i=r?[n]:[];for(let o=0;o<e.length;o++){const c=e.charCodeAt(o);(c===13||c===10)&&(c===13&&o+1<e.length&&e.charCodeAt(o+1)===10&&o++,i.push(n+o+1))}return i}constructor(e,r,n){this._content=n,this.uri=e,this.version=r,this._lineOffsets=void 0}getLineOffsets(){return this._lineOffsets===void 0&&(this._lineOffsets=rt.computeLineOffsets(this._content,!0)),this._lineOffsets}getText(e){if(e){const r=this.offsetAt(e.start),n=this.offsetAt(e.end);return this._content.substring(r,n)}return this._content}lineAt(e){const r=this.getLineOffsets();if(e>=r.length)return{lineNumber:e,text:""};const n=r[e],i=r[e+1];if(i===void 0)return{lineNumber:e,text:this._content.substring(n)};const o=this._content.substring(n,i);let c=o.length-1;for(;c>=0&&(o[c]===`
`||o[c]==="\r");)c--;return{lineNumber:e,text:o.substr(0,c+1)}}positionAt(e){e=Math.max(Math.min(e,this._content.length),0);const r=this.getLineOffsets();let n=0,i=r.length;if(i===0)return{line:0,character:e};for(;n<i;){const c=Math.floor((n+i)/2);r[c]>e?i=c:n=c+1}const o=n-1;return{line:o,character:e-r[o]}}offsetAt(e){const r=this.getLineOffsets();if(e.line>=r.length)return this._content.length;if(e.line<0)return 0;const n=r[e.line],i=e.line+1<r.length?r[e.line+1]:this._content.length;return Math.max(Math.min(n+e.character,i),n)}get lineCount(){return this.getLineOffsets().length}}a(rt,"TextDocument");var lt;(function(t){t.MIN_VALUE=-2147483648,t.MAX_VALUE=2147483647})(lt||(lt={}));var yt;(function(t){t.MIN_VALUE=0,t.MAX_VALUE=2147483647})(yt||(yt={}));var vt;(function(t){function e(n,i){return n===Number.MAX_VALUE&&(n=yt.MAX_VALUE),i===Number.MAX_VALUE&&(i=yt.MAX_VALUE),{line:n,character:i}}a(e,"create"),t.create=e;function r(n){var i=n;return Ae.objectLiteral(i)&&Ae.uinteger(i.line)&&Ae.uinteger(i.character)}a(r,"is"),t.is=r})(vt||(vt={}));var Rt;(function(t){function e(n,i,o,c){if(Ae.uinteger(n)&&Ae.uinteger(i)&&Ae.uinteger(o)&&Ae.uinteger(c))return{start:vt.create(n,i),end:vt.create(o,c)};if(vt.is(n)&&vt.is(i))return{start:n,end:i};throw new Error("Range#create called with invalid arguments["+n+", "+i+", "+o+", "+c+"]")}a(e,"create"),t.create=e;function r(n){var i=n;return Ae.objectLiteral(i)&&vt.is(i.start)&&vt.is(i.end)}a(r,"is"),t.is=r})(Rt||(Rt={}));var Ut;(function(t){function e(n,i){return{uri:n,range:i}}a(e,"create"),t.create=e;function r(n){var i=n;return Ae.defined(i)&&Rt.is(i.range)&&(Ae.string(i.uri)||Ae.undefined(i.uri))}a(r,"is"),t.is=r})(Ut||(Ut={}));var ln;(function(t){function e(n,i,o,c){return{targetUri:n,targetRange:i,targetSelectionRange:o,originSelectionRange:c}}a(e,"create"),t.create=e;function r(n){var i=n;return Ae.defined(i)&&Rt.is(i.targetRange)&&Ae.string(i.targetUri)&&(Rt.is(i.targetSelectionRange)||Ae.undefined(i.targetSelectionRange))&&(Rt.is(i.originSelectionRange)||Ae.undefined(i.originSelectionRange))}a(r,"is"),t.is=r})(ln||(ln={}));var qr;(function(t){function e(n,i,o,c){return{red:n,green:i,blue:o,alpha:c}}a(e,"create"),t.create=e;function r(n){var i=n;return Ae.numberRange(i.red,0,1)&&Ae.numberRange(i.green,0,1)&&Ae.numberRange(i.blue,0,1)&&Ae.numberRange(i.alpha,0,1)}a(r,"is"),t.is=r})(qr||(qr={}));var Qr;(function(t){function e(n,i){return{range:n,color:i}}a(e,"create"),t.create=e;function r(n){var i=n;return Rt.is(i.range)&&qr.is(i.color)}a(r,"is"),t.is=r})(Qr||(Qr={}));var Yr;(function(t){function e(n,i,o){return{label:n,textEdit:i,additionalTextEdits:o}}a(e,"create"),t.create=e;function r(n){var i=n;return Ae.string(i.label)&&(Ae.undefined(i.textEdit)||ji.is(i))&&(Ae.undefined(i.additionalTextEdits)||Ae.typedArray(i.additionalTextEdits,ji.is))}a(r,"is"),t.is=r})(Yr||(Yr={}));var _n;(function(t){t.Comment="comment",t.Imports="imports",t.Region="region"})(_n||(_n={}));var Dl;(function(t){function e(n,i,o,c,l){var d={startLine:n,endLine:i};return Ae.defined(o)&&(d.startCharacter=o),Ae.defined(c)&&(d.endCharacter=c),Ae.defined(l)&&(d.kind=l),d}a(e,"create"),t.create=e;function r(n){var i=n;return Ae.uinteger(i.startLine)&&Ae.uinteger(i.startLine)&&(Ae.undefined(i.startCharacter)||Ae.uinteger(i.startCharacter))&&(Ae.undefined(i.endCharacter)||Ae.uinteger(i.endCharacter))&&(Ae.undefined(i.kind)||Ae.string(i.kind))}a(r,"is"),t.is=r})(Dl||(Dl={}));var Cs;(function(t){function e(n,i){return{location:n,message:i}}a(e,"create"),t.create=e;function r(n){var i=n;return Ae.defined(i)&&Ut.is(i.location)&&Ae.string(i.message)}a(r,"is"),t.is=r})(Cs||(Cs={}));var qo;(function(t){t.Error=1,t.Warning=2,t.Information=3,t.Hint=4})(qo||(qo={}));var Ts;(function(t){t.Unnecessary=1,t.Deprecated=2})(Ts||(Ts={}));var Cc;(function(t){function e(r){var n=r;return n!=null&&Ae.string(n.href)}a(e,"is"),t.is=e})(Cc||(Cc={}));var As;(function(t){function e(n,i,o,c,l,d){var h={range:n,message:i};return Ae.defined(o)&&(h.severity=o),Ae.defined(c)&&(h.code=c),Ae.defined(l)&&(h.source=l),Ae.defined(d)&&(h.relatedInformation=d),h}a(e,"create"),t.create=e;function r(n){var i,o=n;return Ae.defined(o)&&Rt.is(o.range)&&Ae.string(o.message)&&(Ae.number(o.severity)||Ae.undefined(o.severity))&&(Ae.integer(o.code)||Ae.string(o.code)||Ae.undefined(o.code))&&(Ae.undefined(o.codeDescription)||Ae.string((i=o.codeDescription)===null||i===void 0?void 0:i.href))&&(Ae.string(o.source)||Ae.undefined(o.source))&&(Ae.undefined(o.relatedInformation)||Ae.typedArray(o.relatedInformation,Cs.is))}a(r,"is"),t.is=r})(As||(As={}));var Ea;(function(t){function e(n,i){for(var o=[],c=2;c<arguments.length;c++)o[c-2]=arguments[c];var l={title:n,command:i};return Ae.defined(o)&&o.length>0&&(l.arguments=o),l}a(e,"create"),t.create=e;function r(n){var i=n;return Ae.defined(i)&&Ae.string(i.title)&&Ae.string(i.command)}a(r,"is"),t.is=r})(Ea||(Ea={}));var ji;(function(t){function e(o,c){return{range:o,newText:c}}a(e,"replace"),t.replace=e;function r(o,c){return{range:{start:o,end:o},newText:c}}a(r,"insert"),t.insert=r;function n(o){return{range:o,newText:""}}a(n,"del"),t.del=n;function i(o){var c=o;return Ae.objectLiteral(c)&&Ae.string(c.newText)&&Rt.is(c.range)}a(i,"is"),t.is=i})(ji||(ji={}));var zo;(function(t){function e(n,i,o){var c={label:n};return i!==void 0&&(c.needsConfirmation=i),o!==void 0&&(c.description=o),c}a(e,"create"),t.create=e;function r(n){var i=n;return i!==void 0&&Ae.objectLiteral(i)&&Ae.string(i.label)&&(Ae.boolean(i.needsConfirmation)||i.needsConfirmation===void 0)&&(Ae.string(i.description)||i.description===void 0)}a(r,"is"),t.is=r})(zo||(zo={}));var Zr;(function(t){function e(r){var n=r;return typeof n=="string"}a(e,"is"),t.is=e})(Zr||(Zr={}));var qi;(function(t){function e(o,c,l){return{range:o,newText:c,annotationId:l}}a(e,"replace"),t.replace=e;function r(o,c,l){return{range:{start:o,end:o},newText:c,annotationId:l}}a(r,"insert"),t.insert=r;function n(o,c){return{range:o,newText:"",annotationId:c}}a(n,"del"),t.del=n;function i(o){var c=o;return ji.is(c)&&(zo.is(c.annotationId)||Zr.is(c.annotationId))}a(i,"is"),t.is=i})(qi||(qi={}));var xa;(function(t){function e(n,i){return{textDocument:n,edits:i}}a(e,"create"),t.create=e;function r(n){var i=n;return Ae.defined(i)&&Rs.is(i.textDocument)&&Array.isArray(i.edits)}a(r,"is"),t.is=r})(xa||(xa={}));var Ii;(function(t){function e(n,i,o){var c={kind:"create",uri:n};return i!==void 0&&(i.overwrite!==void 0||i.ignoreIfExists!==void 0)&&(c.options=i),o!==void 0&&(c.annotationId=o),c}a(e,"create"),t.create=e;function r(n){var i=n;return i&&i.kind==="create"&&Ae.string(i.uri)&&(i.options===void 0||(i.options.overwrite===void 0||Ae.boolean(i.options.overwrite))&&(i.options.ignoreIfExists===void 0||Ae.boolean(i.options.ignoreIfExists)))&&(i.annotationId===void 0||Zr.is(i.annotationId))}a(r,"is"),t.is=r})(Ii||(Ii={}));var zi;(function(t){function e(n,i,o,c){var l={kind:"rename",oldUri:n,newUri:i};return o!==void 0&&(o.overwrite!==void 0||o.ignoreIfExists!==void 0)&&(l.options=o),c!==void 0&&(l.annotationId=c),l}a(e,"create"),t.create=e;function r(n){var i=n;return i&&i.kind==="rename"&&Ae.string(i.oldUri)&&Ae.string(i.newUri)&&(i.options===void 0||(i.options.overwrite===void 0||Ae.boolean(i.options.overwrite))&&(i.options.ignoreIfExists===void 0||Ae.boolean(i.options.ignoreIfExists)))&&(i.annotationId===void 0||Zr.is(i.annotationId))}a(r,"is"),t.is=r})(zi||(zi={}));var Wo;(function(t){function e(n,i,o){var c={kind:"delete",uri:n};return i!==void 0&&(i.recursive!==void 0||i.ignoreIfNotExists!==void 0)&&(c.options=i),o!==void 0&&(c.annotationId=o),c}a(e,"create"),t.create=e;function r(n){var i=n;return i&&i.kind==="delete"&&Ae.string(i.uri)&&(i.options===void 0||(i.options.recursive===void 0||Ae.boolean(i.options.recursive))&&(i.options.ignoreIfNotExists===void 0||Ae.boolean(i.options.ignoreIfNotExists)))&&(i.annotationId===void 0||Zr.is(i.annotationId))}a(r,"is"),t.is=r})(Wo||(Wo={}));var Tc;(function(t){function e(r){var n=r;return n&&(n.changes!==void 0||n.documentChanges!==void 0)&&(n.documentChanges===void 0||n.documentChanges.every(function(i){return Ae.string(i.kind)?Ii.is(i)||zi.is(i)||Wo.is(i):xa.is(i)}))}a(e,"is"),t.is=e})(Tc||(Tc={}));var Ca=function(){function t(e,r){this.edits=e,this.changeAnnotations=r}return a(t,"TextEditChangeImpl"),t.prototype.insert=function(e,r,n){var i,o;if(n===void 0?i=ji.insert(e,r):Zr.is(n)?(o=n,i=qi.insert(e,r,n)):(this.assertChangeAnnotations(this.changeAnnotations),o=this.changeAnnotations.manage(n),i=qi.insert(e,r,o)),this.edits.push(i),o!==void 0)return o},t.prototype.replace=function(e,r,n){var i,o;if(n===void 0?i=ji.replace(e,r):Zr.is(n)?(o=n,i=qi.replace(e,r,n)):(this.assertChangeAnnotations(this.changeAnnotations),o=this.changeAnnotations.manage(n),i=qi.replace(e,r,o)),this.edits.push(i),o!==void 0)return o},t.prototype.delete=function(e,r){var n,i;if(r===void 0?n=ji.del(e):Zr.is(r)?(i=r,n=qi.del(e,r)):(this.assertChangeAnnotations(this.changeAnnotations),i=this.changeAnnotations.manage(r),n=qi.del(e,i)),this.edits.push(n),i!==void 0)return i},t.prototype.add=function(e){this.edits.push(e)},t.prototype.all=function(){return this.edits},t.prototype.clear=function(){this.edits.splice(0,this.edits.length)},t.prototype.assertChangeAnnotations=function(e){if(e===void 0)throw new Error("Text edit change is not configured to manage change annotations.")},t}(),kl=function(){function t(e){this._annotations=e===void 0?Object.create(null):e,this._counter=0,this._size=0}return a(t,"ChangeAnnotations"),t.prototype.all=function(){return this._annotations},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),t.prototype.manage=function(e,r){var n;if(Zr.is(e)?n=e:(n=this.nextId(),r=e),this._annotations[n]!==void 0)throw new Error("Id "+n+" is already in use.");if(r===void 0)throw new Error("No annotation provided for id "+n);return this._annotations[n]=r,this._size++,n},t.prototype.nextId=function(){return this._counter++,this._counter.toString()},t}(),ih=function(){function t(e){var r=this;this._textEditChanges=Object.create(null),e!==void 0?(this._workspaceEdit=e,e.documentChanges?(this._changeAnnotations=new kl(e.changeAnnotations),e.changeAnnotations=this._changeAnnotations.all(),e.documentChanges.forEach(function(n){if(xa.is(n)){var i=new Ca(n.edits,r._changeAnnotations);r._textEditChanges[n.textDocument.uri]=i}})):e.changes&&Object.keys(e.changes).forEach(function(n){var i=new Ca(e.changes[n]);r._textEditChanges[n]=i})):this._workspaceEdit={}}return a(t,"WorkspaceChange"),Object.defineProperty(t.prototype,"edit",{get:function(){return this.initDocumentChanges(),this._changeAnnotations!==void 0&&(this._changeAnnotations.size===0?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),t.prototype.getTextEditChange=function(e){if(Rs.is(e)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var r={uri:e.uri,version:e.version},n=this._textEditChanges[r.uri];if(!n){var i=[],o={textDocument:r,edits:i};this._workspaceEdit.documentChanges.push(o),n=new Ca(i,this._changeAnnotations),this._textEditChanges[r.uri]=n}return n}else{if(this.initChanges(),this._workspaceEdit.changes===void 0)throw new Error("Workspace edit is not configured for normal text edit changes.");var n=this._textEditChanges[e];if(!n){var i=[];this._workspaceEdit.changes[e]=i,n=new Ca(i),this._textEditChanges[e]=n}return n}},t.prototype.initDocumentChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._changeAnnotations=new kl,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},t.prototype.initChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._workspaceEdit.changes=Object.create(null))},t.prototype.createFile=function(e,r,n){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var i;zo.is(r)||Zr.is(r)?i=r:n=r;var o,c;if(i===void 0?o=Ii.create(e,n):(c=Zr.is(i)?i:this._changeAnnotations.manage(i),o=Ii.create(e,n,c)),this._workspaceEdit.documentChanges.push(o),c!==void 0)return c},t.prototype.renameFile=function(e,r,n,i){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var o;zo.is(n)||Zr.is(n)?o=n:i=n;var c,l;if(o===void 0?c=zi.create(e,r,i):(l=Zr.is(o)?o:this._changeAnnotations.manage(o),c=zi.create(e,r,i,l)),this._workspaceEdit.documentChanges.push(c),l!==void 0)return l},t.prototype.deleteFile=function(e,r,n){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var i;zo.is(r)||Zr.is(r)?i=r:n=r;var o,c;if(i===void 0?o=Wo.create(e,n):(c=Zr.is(i)?i:this._changeAnnotations.manage(i),o=Wo.create(e,n,c)),this._workspaceEdit.documentChanges.push(o),c!==void 0)return c},t}(),Nl;(function(t){function e(n){return{uri:n}}a(e,"create"),t.create=e;function r(n){var i=n;return Ae.defined(i)&&Ae.string(i.uri)}a(r,"is"),t.is=r})(Nl||(Nl={}));var Ac;(function(t){function e(n,i){return{uri:n,version:i}}a(e,"create"),t.create=e;function r(n){var i=n;return Ae.defined(i)&&Ae.string(i.uri)&&Ae.integer(i.version)}a(r,"is"),t.is=r})(Ac||(Ac={}));var Rs;(function(t){function e(n,i){return{uri:n,version:i}}a(e,"create"),t.create=e;function r(n){var i=n;return Ae.defined(i)&&Ae.string(i.uri)&&(i.version===null||Ae.integer(i.version))}a(r,"is"),t.is=r})(Rs||(Rs={}));var Ml;(function(t){function e(n,i,o,c){return{uri:n,languageId:i,version:o,text:c}}a(e,"create"),t.create=e;function r(n){var i=n;return Ae.defined(i)&&Ae.string(i.uri)&&Ae.string(i.languageId)&&Ae.integer(i.version)&&Ae.string(i.text)}a(r,"is"),t.is=r})(Ml||(Ml={}));var Oi;(function(t){t.PlainText="plaintext",t.Markdown="markdown"})(Oi||(Oi={})),function(t){function e(r){var n=r;return n===t.PlainText||n===t.Markdown}a(e,"is"),t.is=e}(Oi||(Oi={}));var Ta;(function(t){function e(r){var n=r;return Ae.objectLiteral(r)&&Oi.is(n.kind)&&Ae.string(n.value)}a(e,"is"),t.is=e})(Ta||(Ta={}));var Ll;(function(t){t.Text=1,t.Method=2,t.Function=3,t.Constructor=4,t.Field=5,t.Variable=6,t.Class=7,t.Interface=8,t.Module=9,t.Property=10,t.Unit=11,t.Value=12,t.Enum=13,t.Keyword=14,t.Snippet=15,t.Color=16,t.File=17,t.Reference=18,t.Folder=19,t.EnumMember=20,t.Constant=21,t.Struct=22,t.Event=23,t.Operator=24,t.TypeParameter=25})(Ll||(Ll={}));var $l;(function(t){t.PlainText=1,t.Snippet=2})($l||($l={}));var Fl;(function(t){t.Deprecated=1})(Fl||(Fl={}));var Aa;(function(t){function e(n,i,o){return{newText:n,insert:i,replace:o}}a(e,"create"),t.create=e;function r(n){var i=n;return i&&Ae.string(i.newText)&&Rt.is(i.insert)&&Rt.is(i.replace)}a(r,"is"),t.is=r})(Aa||(Aa={}));var Is;(function(t){t.asIs=1,t.adjustIndentation=2})(Is||(Is={}));var Os;(function(t){function e(r){return{label:r}}a(e,"create"),t.create=e})(Os||(Os={}));var Ps;(function(t){function e(r,n){return{items:r||[],isIncomplete:!!n}}a(e,"create"),t.create=e})(Ps||(Ps={}));var Ds;(function(t){function e(n){return n.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}a(e,"fromPlainText"),t.fromPlainText=e;function r(n){var i=n;return Ae.string(i)||Ae.objectLiteral(i)&&Ae.string(i.language)&&Ae.string(i.value)}a(r,"is"),t.is=r})(Ds||(Ds={}));var Rc;(function(t){function e(r){var n=r;return!!n&&Ae.objectLiteral(n)&&(Ta.is(n.contents)||Ds.is(n.contents)||Ae.typedArray(n.contents,Ds.is))&&(r.range===void 0||Rt.is(r.range))}a(e,"is"),t.is=e})(Rc||(Rc={}));var ks;(function(t){function e(r,n){return n?{label:r,documentation:n}:{label:r}}a(e,"create"),t.create=e})(ks||(ks={}));var Ic;(function(t){function e(r,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var c={label:r};return Ae.defined(n)&&(c.documentation=n),Ae.defined(i)?c.parameters=i:c.parameters=[],c}a(e,"create"),t.create=e})(Ic||(Ic={}));var Wn;(function(t){t.Text=1,t.Read=2,t.Write=3})(Wn||(Wn={}));var Go;(function(t){function e(r,n){var i={range:r};return Ae.number(n)&&(i.kind=n),i}a(e,"create"),t.create=e})(Go||(Go={}));var Oc;(function(t){t.File=1,t.Module=2,t.Namespace=3,t.Package=4,t.Class=5,t.Method=6,t.Property=7,t.Field=8,t.Constructor=9,t.Enum=10,t.Interface=11,t.Function=12,t.Variable=13,t.Constant=14,t.String=15,t.Number=16,t.Boolean=17,t.Array=18,t.Object=19,t.Key=20,t.Null=21,t.EnumMember=22,t.Struct=23,t.Event=24,t.Operator=25,t.TypeParameter=26})(Oc||(Oc={}));var Ns;(function(t){t.Deprecated=1})(Ns||(Ns={}));var Bl;(function(t){function e(r,n,i,o,c){var l={name:r,kind:n,location:{uri:o,range:i}};return c&&(l.containerName=c),l}a(e,"create"),t.create=e})(Bl||(Bl={}));var Pc;(function(t){function e(n,i,o,c,l,d){var h={name:n,detail:i,kind:o,range:c,selectionRange:l};return d!==void 0&&(h.children=d),h}a(e,"create"),t.create=e;function r(n){var i=n;return i&&Ae.string(i.name)&&Ae.number(i.kind)&&Rt.is(i.range)&&Rt.is(i.selectionRange)&&(i.detail===void 0||Ae.string(i.detail))&&(i.deprecated===void 0||Ae.boolean(i.deprecated))&&(i.children===void 0||Array.isArray(i.children))&&(i.tags===void 0||Array.isArray(i.tags))}a(r,"is"),t.is=r})(Pc||(Pc={}));var si;(function(t){t.Empty="",t.QuickFix="quickfix",t.Refactor="refactor",t.RefactorExtract="refactor.extract",t.RefactorInline="refactor.inline",t.RefactorRewrite="refactor.rewrite",t.Source="source",t.SourceOrganizeImports="source.organizeImports",t.SourceFixAll="source.fixAll"})(si||(si={}));var Hl;(function(t){function e(n,i){var o={diagnostics:n};return i!=null&&(o.only=i),o}a(e,"create"),t.create=e;function r(n){var i=n;return Ae.defined(i)&&Ae.typedArray(i.diagnostics,As.is)&&(i.only===void 0||Ae.typedArray(i.only,Ae.string))}a(r,"is"),t.is=r})(Hl||(Hl={}));var Dc;(function(t){function e(n,i,o){var c={title:n},l=!0;return typeof i=="string"?(l=!1,c.kind=i):Ea.is(i)?c.command=i:c.edit=i,l&&o!==void 0&&(c.kind=o),c}a(e,"create"),t.create=e;function r(n){var i=n;return i&&Ae.string(i.title)&&(i.diagnostics===void 0||Ae.typedArray(i.diagnostics,As.is))&&(i.kind===void 0||Ae.string(i.kind))&&(i.edit!==void 0||i.command!==void 0)&&(i.command===void 0||Ea.is(i.command))&&(i.isPreferred===void 0||Ae.boolean(i.isPreferred))&&(i.edit===void 0||Tc.is(i.edit))}a(r,"is"),t.is=r})(Dc||(Dc={}));var Ul;(function(t){function e(n,i){var o={range:n};return Ae.defined(i)&&(o.data=i),o}a(e,"create"),t.create=e;function r(n){var i=n;return Ae.defined(i)&&Rt.is(i.range)&&(Ae.undefined(i.command)||Ea.is(i.command))}a(r,"is"),t.is=r})(Ul||(Ul={}));var re;(function(t){function e(n,i){return{tabSize:n,insertSpaces:i}}a(e,"create"),t.create=e;function r(n){var i=n;return Ae.defined(i)&&Ae.uinteger(i.tabSize)&&Ae.boolean(i.insertSpaces)}a(r,"is"),t.is=r})(re||(re={}));var ye;(function(t){function e(n,i,o){return{range:n,target:i,data:o}}a(e,"create"),t.create=e;function r(n){var i=n;return Ae.defined(i)&&Rt.is(i.range)&&(Ae.undefined(i.target)||Ae.string(i.target))}a(r,"is"),t.is=r})(ye||(ye={}));var De;(function(t){function e(n,i){return{range:n,parent:i}}a(e,"create"),t.create=e;function r(n){var i=n;return i!==void 0&&Rt.is(i.range)&&(i.parent===void 0||t.is(i.parent))}a(r,"is"),t.is=r})(De||(De={}));var St=null,Xt;(function(t){function e(o,c,l,d){return new cr(o,c,l,d)}a(e,"create"),t.create=e;function r(o){var c=o;return!!(Ae.defined(c)&&Ae.string(c.uri)&&(Ae.undefined(c.languageId)||Ae.string(c.languageId))&&Ae.uinteger(c.lineCount)&&Ae.func(c.getText)&&Ae.func(c.positionAt)&&Ae.func(c.offsetAt))}a(r,"is"),t.is=r;function n(o,c){for(var l=o.getText(),d=i(c,function($,N){var U=$.range.start.line-N.range.start.line;return U===0?$.range.start.character-N.range.start.character:U}),h=l.length,S=d.length-1;S>=0;S--){var O=d[S],I=o.offsetAt(O.range.start),P=o.offsetAt(O.range.end);if(P<=h)l=l.substring(0,I)+O.newText+l.substring(P,l.length);else throw new Error("Overlapping edit");h=I}return l}a(n,"applyEdits"),t.applyEdits=n;function i(o,c){if(o.length<=1)return o;var l=o.length/2|0,d=o.slice(0,l),h=o.slice(l);i(d,c),i(h,c);for(var S=0,O=0,I=0;S<d.length&&O<h.length;){var P=c(d[S],h[O]);P<=0?o[I++]=d[S++]:o[I++]=h[O++]}for(;S<d.length;)o[I++]=d[S++];for(;O<h.length;)o[I++]=h[O++];return o}a(i,"mergeSort")})(Xt||(Xt={}));var cr=function(){function t(e,r,n,i){this._uri=e,this._languageId=r,this._version=n,this._content=i,this._lineOffsets=void 0}return a(t,"FullTextDocument"),Object.defineProperty(t.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),t.prototype.getText=function(e){if(e){var r=this.offsetAt(e.start),n=this.offsetAt(e.end);return this._content.substring(r,n)}return this._content},t.prototype.update=function(e,r){this._content=e.text,this._version=r,this._lineOffsets=void 0},t.prototype.getLineOffsets=function(){if(this._lineOffsets===void 0){for(var e=[],r=this._content,n=!0,i=0;i<r.length;i++){n&&(e.push(i),n=!1);var o=r.charAt(i);n=o==="\r"||o===`
`,o==="\r"&&i+1<r.length&&r.charAt(i+1)===`
`&&i++}n&&r.length>0&&e.push(r.length),this._lineOffsets=e}return this._lineOffsets},t.prototype.positionAt=function(e){e=Math.max(Math.min(e,this._content.length),0);var r=this.getLineOffsets(),n=0,i=r.length;if(i===0)return vt.create(0,e);for(;n<i;){var o=Math.floor((n+i)/2);r[o]>e?i=o:n=o+1}var c=n-1;return vt.create(c,e-r[c])},t.prototype.offsetAt=function(e){var r=this.getLineOffsets();if(e.line>=r.length)return this._content.length;if(e.line<0)return 0;var n=r[e.line],i=e.line+1<r.length?r[e.line+1]:this._content.length;return Math.max(Math.min(n+e.character,i),n)},Object.defineProperty(t.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),t}(),Ae;(function(t){var e=Object.prototype.toString;function r(P){return typeof P!="undefined"}a(r,"defined"),t.defined=r;function n(P){return typeof P=="undefined"}a(n,"undefined"),t.undefined=n;function i(P){return P===!0||P===!1}a(i,"boolean"),t.boolean=i;function o(P){return e.call(P)==="[object String]"}a(o,"string"),t.string=o;function c(P){return e.call(P)==="[object Number]"}a(c,"number"),t.number=c;function l(P,$,N){return e.call(P)==="[object Number]"&&$<=P&&P<=N}a(l,"numberRange"),t.numberRange=l;function d(P){return e.call(P)==="[object Number]"&&-2147483648<=P&&P<=2147483647}a(d,"integer"),t.integer=d;function h(P){return e.call(P)==="[object Number]"&&0<=P&&P<=2147483647}a(h,"uinteger"),t.uinteger=h;function S(P){return e.call(P)==="[object Function]"}a(S,"func"),t.func=S;function O(P){return P!==null&&typeof P=="object"}a(O,"objectLiteral"),t.objectLiteral=O;function I(P,$){return Array.isArray(P)&&P.every($)}a(I,"typedArray"),t.typedArray=I})(Ae||(Ae={}));var Wt;(function(t){function e(n){return typeof n=="string"||n instanceof String}a(e,"string"),t.string=e;function r(n){return typeof n=="number"||n instanceof Number}a(r,"number"),t.number=r})(Wt||(Wt={}));var pr;(function(t){function e(r){const n=r;return n!=null&&(Wt.number(n.value)||Wt.string(n.value))&&Wt.string(n.target)}a(e,"is"),t.is=e})(pr||(pr={}));class xn extends m.Diagnostic{constructor(e,r,n,i){super(e,r,n);this.data=i,this.hasDiagnosticCode=!1}}a(xn,"ProtocolDiagnostic");var xr;(function(t){const e=Object.prototype.toString;function r(S){return typeof S!="undefined"}a(r,"defined"),t.defined=r;function n(S){return S===!0||S===!1}a(n,"boolean"),t.boolean=n;function i(S){return e.call(S)==="[object String]"}a(i,"string"),t.string=i;function o(S){return e.call(S)==="[object Number]"}a(o,"number"),t.number=o;function c(S){return S!==null&&typeof S=="object"}a(c,"objectLiteral"),t.objectLiteral=c;function l(S){return Array.isArray(S)}a(l,"array"),t.array=l;function d(S){return l(S)&&S.every(O=>i(O))}a(d,"stringArray"),t.stringArray=d;function h(S,O){return Array.isArray(S)&&S.every(O)}a(h,"typedArray"),t.typedArray=h})(xr||(xr={}));var Wi;(function(t){function e(r){const n=r;return n&&xr.string(n.language)&&xr.string(n.value)}a(e,"is"),t.is=e})(Wi||(Wi={}));function kc(t){const e=a(ae=>m.Uri.parse(ae),"nullConverter"),r=t!=null?t:e;function n(ae){return r(ae)}a(n,"asUri");function i(ae){return ae.map(o)}a(i,"asDiagnostics");function o(ae){const ot=new xn(O(ae.range),ae.message,P(ae.severity),ae.data);return ae.code!==void 0&&(Cc.is(ae.codeDescription)?ot.code={value:ae.code,target:n(ae.codeDescription.href)}:pr.is(ae.code)?(ot.hasDiagnosticCode=!0,ot.code={value:ae.code.value,target:n(ae.code.target)}):ot.code=ae.code),ae.source&&(ot.source=ae.source),ae.relatedInformation&&(ot.relatedInformation=c(ae.relatedInformation)),Array.isArray(ae.tags)&&(ot.tags=d(ae.tags)),ot}a(o,"asDiagnostic");function c(ae){return ae.map(l)}a(c,"asRelatedInformation");function l(ae){return new m.DiagnosticRelatedInformation(Oe(ae.location),ae.message)}a(l,"asDiagnosticRelatedInformation");function d(ae){if(!ae)return;const ot=[];for(const jt of ae){const dn=h(jt);dn!==void 0&&ot.push(dn)}return ot.length>0?ot:void 0}a(d,"asDiagnosticTags");function h(ae){switch(ae){case Ts.Unnecessary:return m.DiagnosticTag.Unnecessary;case Ts.Deprecated:return m.DiagnosticTag.Deprecated;default:return}}a(h,"asDiagnosticTag");function S(ae){if(!!ae)return new m.Position(ae.line,ae.character)}a(S,"asPosition");function O(ae){if(!!ae)return new m.Range(S(ae.start),S(ae.end))}a(O,"asRange");function I(ae){return ae.map(ot=>O(ot))}a(I,"asRanges");function P(ae){if(ae==null)return m.DiagnosticSeverity.Error;switch(ae){case qo.Error:return m.DiagnosticSeverity.Error;case qo.Warning:return m.DiagnosticSeverity.Warning;case qo.Information:return m.DiagnosticSeverity.Information;case qo.Hint:return m.DiagnosticSeverity.Hint}return m.DiagnosticSeverity.Error}a(P,"asDiagnosticSeverity");function $(ae){if(xr.string(ae))return new m.MarkdownString(ae);if(Wi.is(ae))return new m.MarkdownString().appendCodeblock(ae.value,ae.language);if(Array.isArray(ae)){const jt=[];for(const dn of ae){const dl=new m.MarkdownString;Wi.is(dn)?dl.appendCodeblock(dn.value,dn.language):dl.appendMarkdown(dn),jt.push(dl)}return jt}let ot;switch(ae.kind){case Oi.Markdown:return new m.MarkdownString(ae.value);case Oi.PlainText:return ot=new m.MarkdownString,ot.appendText(ae.value),ot;default:return ot=new m.MarkdownString,ot.appendText(`Unsupported Markup content received. Kind is: ${ae.kind}`),ot}}a($,"asHoverContent");function N(ae){if(xr.string(ae))return ae;switch(ae.kind){case Oi.Markdown:return new m.MarkdownString(ae.value);case Oi.PlainText:return ae.value;default:return`Unsupported Markup content received. Kind is: ${ae.kind}`}}a(N,"asDocumentation");function U(ae){if(!!ae)return new m.Hover($(ae.contents),O(ae.range))}a(U,"asHover");function W(ae){if(!!ae)return new m.TextEdit(O(ae.range),ae.newText)}a(W,"asTextEdit");function V(ae){if(!!ae)return ae.map(W)}a(V,"asTextEdits");function ie(ae){if(!ae)return;const ot=new m.SignatureHelp;return xr.number(ae.activeSignature)?ot.activeSignature=ae.activeSignature:ot.activeSignature=0,xr.number(ae.activeParameter)?ot.activeParameter=ae.activeParameter:ot.activeParameter=0,ae.signatures&&(ot.signatures=oe(ae.signatures)),ot}a(ie,"asSignatureHelp");function oe(ae){return ae.map(ge)}a(oe,"asSignatureInformations");function ge(ae){const ot=new m.SignatureInformation(ae.label);return ae.documentation!==void 0&&(ot.documentation=N(ae.documentation)),ae.parameters!==void 0&&(ot.parameters=ke(ae.parameters)),ae.activeParameter!==void 0&&(ot.activeParameter=ae.activeParameter),ot}a(ge,"asSignatureInformation");function ke(ae){return ae.map(Ie)}a(ke,"asParameterInformations");function Ie(ae){const ot=new m.ParameterInformation(ae.label);return ae.documentation&&(ot.documentation=N(ae.documentation)),ot}a(Ie,"asParameterInformation");function Oe(ae){if(!!ae)return new m.Location(r(ae.uri),O(ae.range))}a(Oe,"asLocation");function Ze(ae){if(!!ae)return st(ae)}a(Ze,"asDeclarationResult");function $e(ae){if(!!ae)return st(ae)}a($e,"asDefinitionResult");function ze(ae){if(!ae)return;const ot={targetUri:r(ae.targetUri),targetRange:O(ae.targetSelectionRange),originSelectionRange:O(ae.originSelectionRange),targetSelectionRange:O(ae.targetSelectionRange)};if(!ot.targetSelectionRange)throw new Error("targetSelectionRange must not be undefined or null");return ot}a(ze,"asLocationLink");function st(ae){if(!!ae)return xr.array(ae)?ae.length===0?[]:ln.is(ae[0])?ae.map(dn=>ze(dn)):ae.map(jt=>Oe(jt)):ln.is(ae)?[ze(ae)]:Oe(ae)}a(st,"asLocationResult");function Mt(ae){if(!!ae)return ae.map(ot=>Oe(ot))}a(Mt,"asReferences");function tn(ae){if(!!ae)return ae.map(Mn)}a(tn,"asDocumentHighlights");function Mn(ae){const ot=new m.DocumentHighlight(O(ae.range));return xr.number(ae.kind)&&(ot.kind=Vn(ae.kind)),ot}a(Mn,"asDocumentHighlight");function Vn(ae){switch(ae){case Wn.Text:return m.DocumentHighlightKind.Text;case Wn.Read:return m.DocumentHighlightKind.Read;case Wn.Write:return m.DocumentHighlightKind.Write}return m.DocumentHighlightKind.Text}a(Vn,"asDocumentHighlightKind");function ki(ae,ot){if(!!ae)return ae.map(jt=>Np(jt,ot))}a(ki,"asSymbolInformations");function Ni(ae){return ae<=Oc.TypeParameter?ae-1:m.SymbolKind.Property}a(Ni,"asSymbolKind");function Xs(ae){switch(ae){case Ns.Deprecated:return m.SymbolTag.Deprecated;default:return}}a(Xs,"asSymbolTag");function bu(ae){if(ae==null)return;const ot=[];for(const jt of ae){const dn=Xs(jt);dn!==void 0&&ot.push(dn)}return ot.length===0?void 0:ot}a(bu,"asSymbolTags");function Np(ae,ot){const jt=new m.SymbolInformation(ae.name,Ni(ae.kind),O(ae.location.range),ae.location.uri?r(ae.location.uri):ot);return Mp(jt,ae),ae.containerName&&(jt.containerName=ae.containerName),jt}a(Np,"asSymbolInformation");function _y(ae){if(ae!=null)return ae.map(eh)}a(_y,"asDocumentSymbols");function eh(ae){var ot;const jt=new m.DocumentSymbol(ae.name,(ot=ae.detail)!=null?ot:"",Ni(ae.kind),O(ae.range),O(ae.selectionRange));if(Mp(jt,ae),ae.children!==void 0&&ae.children.length>0){const dn=[];for(const dl of ae.children)dn.push(eh(dl));jt.children=dn}return jt}a(eh,"asDocumentSymbol");function Mp(ae,ot){ae.tags=bu(ot.tags),ot.deprecated&&(ae.tags?ae.tags.includes(m.SymbolTag.Deprecated)||(ae.tags=ae.tags.concat(m.SymbolTag.Deprecated)):ae.tags=[m.SymbolTag.Deprecated])}a(Mp,"fillTags");function th(ae){const ot={title:ae.title,command:ae.command};return ae.arguments&&(ot.arguments=ae.arguments),ot}a(th,"asCommand");function wy(ae){if(!!ae)return ae.map(th)}a(wy,"asCommands");const bo=new Map;bo.set(si.Empty,m.CodeActionKind.Empty),bo.set(si.QuickFix,m.CodeActionKind.QuickFix),bo.set(si.Refactor,m.CodeActionKind.Refactor),bo.set(si.RefactorExtract,m.CodeActionKind.RefactorExtract),bo.set(si.RefactorInline,m.CodeActionKind.RefactorInline),bo.set(si.RefactorRewrite,m.CodeActionKind.RefactorRewrite),bo.set(si.Source,m.CodeActionKind.Source),bo.set(si.SourceOrganizeImports,m.CodeActionKind.SourceOrganizeImports);function rh(ae){if(ae==null)return;let ot=bo.get(ae);if(ot)return ot;const jt=ae.split(".");ot=m.CodeActionKind.Empty;for(const dn of jt)ot=ot.append(dn);return ot}a(rh,"asCodeActionKind");function by(ae){if(ae!=null)return ae.map(ot=>rh(ot))}a(by,"asCodeActionKinds");function Sy(ae){if(ae==null)return;const ot=new m.CodeAction(ae.title);return ae.kind!==void 0&&(ot.kind=rh(ae.kind)),ae.diagnostics&&(ot.diagnostics=i(ae.diagnostics)),ae.edit&&(ot.edit=Lp(ae.edit)),ae.command&&(ot.command=th(ae.command)),ae.isPreferred!==void 0&&(ot.isPreferred=ae.isPreferred),ot}a(Sy,"asCodeAction");function Lp(ae){if(!ae)return;const ot=new m.WorkspaceEdit;return ae.documentChanges?ae.documentChanges.forEach(jt=>{if(Ii.is(jt))ot.createFile(r(jt.uri),jt.options);else if(zi.is(jt))ot.renameFile(r(jt.oldUri),r(jt.newUri),jt.options);else if(Wo.is(jt))ot.deleteFile(r(jt.uri),jt.options);else if(xa.is(jt))ot.set(r(jt.textDocument.uri),V(jt.edits));else throw new Error(`Unknown workspace edit change received:
${JSON.stringify(jt,void 0,4)}`)}):ae.changes&&Object.keys(ae.changes).forEach(jt=>{ot.set(r(jt),V(ae.changes[jt]))}),ot}a(Lp,"asWorkspaceEdit");function $p(ae){return new m.Color(ae.red,ae.green,ae.blue,ae.alpha)}a($p,"asColor");function Fp(ae){return new m.ColorInformation(O(ae.range),$p(ae.color))}a(Fp,"asColorInformation");function Ey(ae){if(Array.isArray(ae))return ae.map(Fp)}a(Ey,"asColorInformations");function Bp(ae){const ot=new m.ColorPresentation(ae.label);return ot.additionalTextEdits=V(ae.additionalTextEdits),ae.textEdit&&(ot.textEdit=W(ae.textEdit)),ot}a(Bp,"asColorPresentation");function xy(ae){if(Array.isArray(ae))return ae.map(Bp)}a(xy,"asColorPresentations");function Hp(ae){if(ae)switch(ae){case _n.Comment:return m.FoldingRangeKind.Comment;case _n.Imports:return m.FoldingRangeKind.Imports;case _n.Region:return m.FoldingRangeKind.Region}}a(Hp,"asFoldingRangeKind");function Up(ae){return new m.FoldingRange(ae.startLine,ae.endLine,Hp(ae.kind))}a(Up,"asFoldingRange");function Cy(ae){if(Array.isArray(ae))return ae.map(Up)}a(Cy,"asFoldingRanges");function nh(ae){return new m.SelectionRange(O(ae.range),ae.parent?nh(ae.parent):void 0)}a(nh,"asSelectionRange");function Ty(ae){if(!Array.isArray(ae))return[];const ot=[];for(const jt of ae)ot.push(nh(jt));return ot}return a(Ty,"asSelectionRanges"),{asUri:n,asDiagnostics:i,asDiagnostic:o,asRange:O,asRanges:I,asPosition:S,asDiagnosticSeverity:P,asDiagnosticTag:h,asHover:U,asTextEdit:W,asTextEdits:V,asSignatureHelp:ie,asSignatureInformations:oe,asSignatureInformation:ge,asParameterInformations:ke,asParameterInformation:Ie,asDeclarationResult:Ze,asDefinitionResult:$e,asLocation:Oe,asReferences:Mt,asDocumentHighlights:tn,asDocumentHighlight:Mn,asDocumentHighlightKind:Vn,asSymbolKind:Ni,asSymbolTag:Xs,asSymbolTags:bu,asSymbolInformations:ki,asSymbolInformation:Np,asDocumentSymbols:_y,asDocumentSymbol:eh,asCommand:th,asCommands:wy,asCodeAction:Sy,asCodeActionKind:rh,asCodeActionKinds:by,asWorkspaceEdit:Lp,asFoldingRangeKind:Hp,asFoldingRange:Up,asFoldingRanges:Cy,asColor:$p,asColorInformation:Fp,asColorInformations:Ey,asColorPresentation:Bp,asColorPresentations:xy,asSelectionRange:nh,asSelectionRanges:Ty}}a(kc,"createConverter");const Cr=(0,yn.loadMessageBundle)();var Gn;(function(t){function e(n,i){const{provider:o,repo:c}=i instanceof m.Uri?n.getVirtualUriMetadata(i):i;return n.getRemoteUri(o.id,{repo:c})}a(e,"externalUri"),t.externalUri=e;function r(n,i){const{provider:o,repo:c}=i instanceof m.Uri?n.getVirtualUriMetadata(i):i;return n.getRemoteUri(o.id,{repo:c})}a(r,"externalIndexUri"),t.externalIndexUri=r})(Gn||(Gn={}));var Vo;(function(t){function e(i){if(i.HEAD.type===Pe.Branch||i.HEAD.type===Pe.RemoteBranch)return i.HEAD.name}a(e,"getBranchName"),t.getBranchName=e;function r(i){if(i.HEAD.type!==Pe.Branch)return;if(i.pullRequest!==void 0)return i.HEAD.name;const o=i.HEAD.name;return o===void 0||o.startsWith("refs/heads/")?o:`refs/heads/${o}`}a(r,"getIndexBranchName"),t.getIndexBranchName=r;async function n(i,o,c=zr.timeout){const l=await i.getMetadata(o),d=Gn.externalIndexUri(i,l),h=t.getIndexBranchName(l);if(!(d===void 0||h===void 0))return zr.getIndexedTip(d,h,{authentication:i.getAuthentication(o)},c)}a(n,"getIndexedTip"),t.getIndexedTip=n})(Vo||(Vo={}));var Nc;(function(t){const e=new Dr(1024);function r(c,l,d){let h=e.get(d);return h!==void 0||(h=c.getCommit(l,d),e.set(d,h)),h}a(r,"get"),t.get=r;async function n(c,l,d){const h=[];for(const O of d)h.push(r(c,l,O));const S=[];for(const O of await Promise.all(h))O!==void 0&&S.push(O);return S}a(n,"all"),t.all=n;function i(c,l){const d=c.commitDate,h=l.commitDate;return d===void 0&&h===void 0?0:d===void 0?1:h===void 0?-1:d<h?1:d>h?-1:0}a(i,"sort"),t.sort=i;function o(c){const l=c.authorName!==void 0?`  \u2022  ${c.authorName}`:"",d=c.commitDate!==void 0?`  \u2022  ${lo(c.commitDate,{ago:!0})}`:"",h=c.branchName!==void 0?` - ${c.branchName}`:"",S=c.tags!==void 0?typeof c.tags=="string"?`  \u2022  ${c.tags}`:`  \u2022  ${c.tags.join(" ")}`:"";return{author:l,date:d,branch:h,tag:S}}a(o,"getCommitInfo"),t.getCommitInfo=o})(Nc||(Nc={}));var oh;(function(t){t[t.Unknown=0]="Unknown",t[t.New=1]="New",t[t.Failed=2]="Failed",t[t.Partial=3]="Partial",t[t.InProgress=4]="InProgress",t[t.Complete=5]="Complete",t[t.PartialIndex=6]="PartialIndex",t[t.CompleteIndex=7]="CompleteIndex"})(oh||(oh={}));var jl;(function(t){function e(n){return{workspaceId:n.WorkspaceId,snapshotId:n.SnapshotId,state:n.State,commitId:n.commitId.toLowerCase(),branchName:r(n.BranchName),creationDate:new Date(n._ts*1e3)}}a(e,"asWorkspaceSnapshot"),t.asWorkspaceSnapshot=e;function r(n){if(n!==null)return n.startsWith("refs/heads/")?n.substr(11):n}a(r,"getBranchName")})(jl||(jl={}));var zr;(function(t){t.timeout=5*60*1e3;const e=new Dr(32),r=new Dr(32);async function n(S,O,I,P=t.timeout){const $=await i(S,O,I,P);if(!($===void 0||$.length===0))return $[0]}a(n,"getIndexedTip"),t.getIndexedTip=n;async function i(S,O,I,P=t.timeout){const $=c(S,O);let N=e.get($);if(N===void 0||N!==void 0&&Date.now()-N.time>P){const U=ci.getAllWorkspaceSnapshots(S,I,O);N={time:Date.now(),promise:U,snapshots:void 0},e.set($,N)}if(N.snapshots!==null){if(N.snapshots===void 0){let U=await N.promise;if(U===void 0){N.snapshots=null;return}U.sort((W,V)=>V.creationDate.getTime()-W.creationDate.getTime()),U=U.filter(W=>W.state===5||W.state===3),N.snapshots=U}return N.snapshots}}a(i,"all"),t.all=i;async function o(S,O,I,P,$=t.timeout){const N=S.toString();let U=r.get(N);if(U===null)return;if(U!==void 0)return U;const W=c(S,I),V=e.get(W);if(V!==void 0&&Date.now()-V.time<=$){if(V.snapshots===null)return;const ie=V.snapshots!==void 0?V.snapshots:await i(S,I,P);if(ie!==void 0){for(const oe of ie)if(oe.commitId===O)return oe}return}if(U=await ci.getWorkspaceSnapshot(O,P),U===void 0){r.set(N,null);return}return r.set(N,U),U}a(o,"single"),t.single=o;function c(S,O){return O!==void 0?`${O}\\${S.toString()}`:S.toString()}a(c,"getAllCacheKey");async function l(S,O,I,P=t.timeout){return await o(S,O,void 0,I,P)!==void 0}a(l,"exists"),t.exists=l;async function d(S,O,I,P=t.timeout){return await i(S,O,I,P)!==void 0}a(d,"branch"),t.branch=d;async function h(S,O,I){const P=new Map(I.map(U=>[U.commitId,U])),$=await Nc.all(S,O.uri,I.map(U=>U.commitId));if($.length===0)return;const N=[];for(const U of $){const W=P.get(U.hash);W!==void 0&&N.push({...W,commit:U})}if(N.length!==0)return N}a(h,"resolve"),t.resolve=h})(zr||(zr={}));var Gi;(function(t){function e(r=!1){return{hoverProvider:r,declarationProvider:r,definitionProvider:r,typeDefinitionProvider:r,referencesProvider:r,documentSymbolProvider:r,foldingRangeProvider:r,diagnosticProvider:r}}a(e,"create"),t.create=e})(Gi||(Gi={}));var ci;(function(t){const e="v0.1",r="https://prod.richnav.vsengsaas.visualstudio.com/api";async function n(W,V,ie){var oe;const ge=await Ye(W,{method:"POST",body:JSON.stringify(V),headers:{"Content-Type":"application/json",...(await ie.authentication).getRichNavigationHeaders(),"x-correlation-id":(oe=ie.correlationId)!=null?oe:vc()}});if(!!ge.ok)return ge.json()}a(n,"postRequest");async function i(W,V,ie){const oe=await Ye(W,{method:"POST",body:V,headers:(await ie.authentication).getRichNavigationHeaders()});if(!!oe.ok)return await oe.json()}a(i,"postForm");function o(W,V){return`${r}/${e}/HttpLanguageService/${W}/${V}`}a(o,"makeRequestUrl");async function c(W,V){const ie=await Ye(`${r}/${e}/WorkspaceSnapshot?commitId=${W}`,{headers:(await V.authentication).getRichNavigationHeaders()});if(ie.ok){const oe=await ie.json();return{workspaceId:oe.workspaceId,snapshotId:oe.snapshotId,state:oe.state,commitId:W.toLowerCase(),branchName:void 0,creationDate:new Date}}}a(c,"getWorkspaceSnapshot"),t.getWorkspaceSnapshot=c;async function l(W,V,ie){const oe=new ri;oe.append("uriString",W.toString(!0)),ie!==void 0&&oe.append("branchName",ie);try{const ge=await i(`${r}/${e}/WorkspaceSnapshot/all`,oe,V);return ge===void 0?void 0:ge.map(jl.asWorkspaceSnapshot)}catch(ge){L.error(ge);return}}a(l,"getAllWorkspaceSnapshots"),t.getAllWorkspaceSnapshots=l;async function d(W,V,ie){const oe=new ri;oe.append("uriString",W.toString(!0)),ie!==void 0&&oe.append("branchName",ie);try{const ge=await i(`${r}/${e}/WorkspaceSnapshot/latest`,oe,V);return ge===void 0?void 0:jl.asWorkspaceSnapshot(ge)}catch(ge){L.error(ge);return}}a(d,"getLatestWorkspaceSnapshot"),t.getLatestWorkspaceSnapshot=d;async function h(W,V,ie){try{return n(o(W,"textDocument/capabilities"),V,ie)}catch(oe){L.error(oe);return}}a(h,"capabilities"),t.capabilities=h;async function S(W,V,ie){try{return n(o(W,"textDocument/hover"),V,ie)}catch(oe){L.error(oe);return}}a(S,"provideHover"),t.provideHover=S;async function O(W,V,ie){try{return n(o(W,"textDocument/definition"),V,ie)}catch(oe){L.error(oe);return}}a(O,"provideDefinition"),t.provideDefinition=O;async function I(W,V,ie){try{return n(o(W,"textDocument/declaration"),V,ie)}catch(oe){L.error(oe);return}}a(I,"provideDeclaration"),t.provideDeclaration=I;async function P(W,V,ie){try{return n(o(W,"textDocument/typeDefinition"),V,ie)}catch(oe){L.error(oe);return}}a(P,"provideTypeDefinition"),t.provideTypeDefinition=P;async function $(W,V,ie){try{return n(o(W,"textDocument/references"),V,ie)}catch(oe){L.error(oe);return}}a($,"provideReferences"),t.provideReferences=$;async function N(W,V,ie){try{return n(o(W,"textDocument/foldingRange"),V,ie)}catch(oe){L.error(oe);return}}a(N,"providerFoldingRanges"),t.providerFoldingRanges=N;async function U(W,V,ie){const oe=m.Uri.from({scheme:"https",authority:"prod.richnav.vsengsaas.visualstudio.com",path:`/api/${e}/Workspace/${W}/${V}/assets/designtime`,query:`id=${ie}`});try{const ge=await Ye(oe.toString().replace("?id%3D","?id="),{method:"GET",headers:{accept:"text/plain"}});return ge.ok?ge.text():void 0}catch(ge){L.error(ge);return}}a(U,"getDesignTimeFileContent"),t.getDesignTimeFileContent=U})(ci||(ci={}));class ah{constructor(e,r){this.providerService=e,this.telemetryService=r,this.metadata=new Map,this.providerService.onDidChangeRepositories(n=>{var i;for(const o of n.added){const c=o.uri,l=Y.getIndexMemento(c);if(l!==void 0){const d=Gn.externalIndexUri(this.providerService,c);d!==void 0&&(typeof((i=l.branch)==null?void 0:i.name)=="string"?zr.all(d,l.branch.name,{authentication:this.providerService.getAuthentication(c)}).catch(void 0):typeof l.ref=="string"&&Nr(l.ref)&&zr.single(d,l.ref,void 0,{authentication:this.providerService.getAuthentication(c)}).catch(void 0))}this.providerService.getMetadata(c).then(d=>{const h={},S=d.pullRequest===void 0?Vo.getIndexBranchName(d):void 0;S!==void 0?h.branch={name:S}:h.ref=d.HEAD.sha,Y.setIndexMemento(c,h).then(void 0,void 0)},void 0)}}),this.providerService.onDidChangeRepository(n=>{const i=n.repository.uri,o=te(i);this.metadata.delete(o),this.getIndexMetadata(i).catch(void 0)})}async resolveIndexRef(e,r){const n=await this.providerService.getModeRefType(e),i=Jt.decode(e);if(i!==void 0){if(i.type===er.Latest)return n===ne.Branch?this.getIndexedTip(e,r?0:zr.timeout):void 0;if(i.type===er.SHA){const c=Gn.externalIndexUri(this.providerService,e);return c===void 0?void 0:await zr.exists(c,i.sha,{authentication:this.providerService.getAuthentication(e)},r?0:zr.timeout)?i.sha:void 0}}if(this.providerService.getModeConfig(e,n).index===q.Latest)return this.getIndexedTip(e,r?0:zr.timeout)}refresh(e){for(const r of e)this.metadata.delete(r.toString())}getIndexMetadata(e){const r=this.providerService.getVirtualRootUri(e),n=te(r);let i=this.metadata.get(n);return i!==void 0||(i=this.createIndexMetadata(e),this.metadata.set(n,i)),i}async getIndexedTip(e,r=zr.timeout){const n=await Vo.getIndexedTip(this.providerService,e,r);return n!==void 0?n.commitId:void 0}async createIndexMetadata(e){const r=new ut(`RichNavIndexProvider.createIndexMetadata(${e.toString()})`);try{const n=Gn.externalIndexUri(this.providerService,e);if(n===void 0)return;r.logStep("Getting metadata");const i=this.providerService.getMetadata(e),o=this.providerService.getModeRefType(e,i),c=await i;r.logStep("Getting snapshot",{suffix:" \u2022 Getting snapshot..."});const l=this.providerService.getAuthentication(e),d=c.pullRequest===void 0?Vo.getIndexBranchName(c):void 0,h=await zr.single(n,c.HEAD.sha,d,{authentication:this.providerService.getAuthentication(e)});if(c.HEAD.type===Pe.Branch||c.HEAD.type===Pe.RemoteBranch){const P=Jt.decode(e);if(P!==void 0)return r.logStep("Handle legacy encoding",{suffix:" \u2022 Handle legacy encoding..."}),h===void 0?P.type===er.Latest?(r.logStep("Getting branch snapshot",{suffix:" \u2022 Getting branch snapshot..."}),d!==void 0&&await zr.branch(n,d,{authentication:this.providerService.getAuthentication(e)})?{type:ft.Indexed}:{type:ft.NotIndexed}):{type:ft.NotIndexed}:P.type===er.Latest||P.type===er.SHA?{type:ft.Active,sha:Promise.resolve(h.commitId),branch:{name:h.branchName}}:{type:ft.Match,sha:Promise.resolve(h.commitId),branch:{name:h.branchName}}}r.logStep("Getting mode config",{suffix:" \u2022 Getting mode config..."});const O=this.providerService.getModeConfig(e,await o),I=this.providerService.getVirtualUriMetadata(e);if((O.index===q.Latest||O.index===q.Match)&&h!==void 0)return{type:ft.Active,sha:Promise.resolve(h.commitId),branch:{name:h.branchName}};if(O.index===q.TipPlusLatest&&I.provider.id==="github"){if(h!==void 0&&h.commitId===c.HEAD.sha)return{type:ft.Active,sha:Promise.resolve(h.commitId),branch:{name:h.branchName}};if(c.HEAD.type===Pe.Branch&&d!==void 0){r.logStep("Getting closest index",{suffix:" \u2022 Getting closest index..."});const P=await zr.all(n,d,{authentication:l});if(P!==void 0&&P.length>0)return{type:ft.Active,sha:this.computeClosestIndex(e,c.HEAD.sha,P),branch:{name:d}}}}return h!==void 0?{type:ft.Indexed}:c.HEAD.type===Pe.Branch&&(r.logStep("Getting branch snapshot",{suffix:" \u2022 Getting branch snapshot..."}),d!==void 0&&await zr.branch(n,d,{authentication:l}))?{type:ft.Indexed}:{type:ft.NotIndexed}}finally{r.stop()}}async computeClosestIndex(e,r,n){if(n.length===0)throw new Error("At least on snapshot should exist");const i=new Set(n.map(S=>S.commitId)),o=await this.providerService.getCommits(e,{ref:r,limit:100});if(o===void 0)return;let c;for(const S of o.commits)if(S.hash===r){c=S;break}if(c===void 0)return;const l=new Map(o.commits.map(S=>[S.hash,S])),d=[c];let h;for(;d.length>0;){for(h=d.shift();h!==void 0&&!i.has(h.hash);)if(h.parents.length>0){for(let S=1;S<h.parents.length;S++){const O=l.get(h.parents[S]);O!==void 0&&d.push(O)}h=l.get(h.parents[0])}if(h!==void 0)break}return h!==void 0?h.hash:void 0}async getSnapshots(e,r){const n=Gn.externalIndexUri(this.providerService,e);if(n===void 0)return[];const i=await zr.all(n,void 0,{authentication:this.providerService.getAuthentication(e)});if(i===void 0)return[];const o=[];for(const c of i)c.branchName!==void 0&&o.push({workspaceId:c.workspaceId,snapshotId:c.snapshotId,hash:c.commitId,branch:{name:c.branchName}});return o}async getStatusBarContributions(e){const r=await this.providerService.getMetadata(e),[n,i]=await Promise.all([this.getIndexMetadata(e),this.providerService.getModeRefType(e,r)]),o=this.providerService.getModeConfig(e,i);if(n===void 0)return[];const{HEAD:c}=r,l=[];if(n!==void 0){let d;const h=[`${wt(c.sha)}`];if(n.type===ft.Active){const S=await n.sha;o.index===q.Latest||o.index===q.Match?(d=o.display===j.Browse?"$(layers-active)\u2009\u2009$(lock)":"$(layers-active)",h.push(Cr("statusbar.active",`The commit is indexed and rich code navigation features are enabled.
The files in the workspace are readonly.`))):o.index===q.TipPlusLatest&&(d="$(layers-dot)",S!==r.HEAD.sha?h.push(Cr("statusbar.tipPlusLatest","The commit is not indexed. Rich code navigation features are enabled using a former indexed commit which might lead to fuzzy results.")):h.push(Cr("statusbar.tipPlusLatest","The commit is indexed. Rich code navigation features are enabled. Files in the workspace can be modified which might lead to fuzzy results.")))}else n.type===ft.Match?(d="$(layers)",h.push(Cr("statusbar.match",`The commit you are on is indexed, but rich navigation is not enabled.
Click the status bar item to enable it.`))):n.type===ft.Indexed&&(d="$(layers)",h.push(Cr("statusbar.indexed",`The branch you are on is indexed, but rich navigation is not enabled.
Click the status bar item to enable it.`)));d&&l.push($r({command:"remoteHub.indexMode.select",title:d,tooltip:h.join(`
`),arguments:[{uri:e}]}))}return l}}a(ah,"RichNavIndexProvider");var Ra;(function(t){let e;function r(){return e=m.window.createStatusBarItem(m.StatusBarAlignment.Right),e.text="$(compass)",e.command="remoteHub.indexMode.select",e.hide(),[e,m.window.onDidChangeActiveTextEditor(()=>{d()}),m.commands.registerCommand("remoteHub.indexMode.select",S=>{h(S).catch(O=>L.log("Selecting index mode failed.",O))})]}a(r,"create"),t.create=r;const n=new Map;function i(S){n.set(S.key(),S)}a(i,"addService"),t.addService=i;function o(S){n.delete(S.key())}a(o,"removeService"),t.removeService=o;function c(S){return n.get(te(S))}a(c,"getService");async function l(S){for(const O of n.values())if(await O.handles(S))return O}a(l,"getServiceForDocument");async function d(){try{let S=a(function($){const N=$.lastIndexOf("/");return N<=0?$:$.substr(N+1)},"basename");const O=m.window.activeTextEditor;if(O===void 0){e.hide();return}const I=await l(O.document);if(I===void 0){e.hide();return}const P=await I.isDocumentIndexed(O.document);P===ql.Indexed?(e.text="$(compass)",e.tooltip=new m.MarkdownString(Cr("isIndexed","The source file '{0}' is indexed and provides rich code navigation features like Go to Declaration and Find all References.",S(O.document.uri.path))),e.show()):P===ql.IndexMapped?(e.text="$(compass-dot)",e.tooltip=new m.MarkdownString(Cr("isIndexed","The source file '{0}' provides rich code navigation features using an earlier indexed commit. Navigation results might be fuzzy.",S(O.document.uri.path))),e.show()):e.hide()}catch(S){e.hide()}}a(d,"updateStatusBarItem"),t.updateStatusBarItem=d;async function h(S){const O=S.uri,I=c(O);if(I===void 0)return;const[P,$,N,U]=await Promise.all([I.getBranchName(),I.getMetadata(),I.getIndexMetadata(),I.getModeRefType(O)]);if(N===void 0||!ft.hasIndex(N.type))return;let W,V=!1;const ie=Jt.decode(O);(ie==null?void 0:ie.type)===er.Latest||(ie==null?void 0:ie.type)===er.SHA?(V=!0,W={display:j.Browse,index:ie.type===er.Latest?q.Latest:q.Match}):W=I.getModeConfig(O,U);const oe=I.getUriMetadata(),ge=Cr("current item","{0} current","$(check)"),ke={kind:"disable",label:Cr("RichNavStatus.disable.label","Disable"),description:W.index===q.None?`  \u2022  ${ge}`:void 0,detail:Cr("RichNavStatus.disable.detail","Disable rich navigation. {0}",oe.provider.id==="github"?"Files will be writable.":"Files will be read-only.")};let Ie,Oe;if(U===ne.PullRequestBranch||U===ne.PullRequestRemoteBranch||U===ne.Commit||U===ne.Tag){const Ze={kind:"match",label:Cr("RichNavStatus.match.label","Current indexed commit - readonly"),description:W.index===q.Match&&W.display===j.Browse?`  \u2022  ${ge}`:void 0,detail:Cr("RichNavStatus.match.detail","Enable rich navigation only if the current commit is indexed. Files will be read-only.")},$e={kind:"match+writeable",label:Cr("RichNavStatus.matchWritable.label","Current indexed commit - writable"),description:W.index===q.Match&&W.display===j.Edit?`  \u2022  ${ge}`:void 0,detail:Cr("RichNavStatus.match.detail","Enable rich navigation only if the current commit is indexed. Files will be writable.")};let ze=oe.provider.id==="github";ze&&(ze=$.HEAD.type===Pe.RemoteBranch?$.HEAD.branch.remote.accessLevel>=Ne.Write:!0);const st=ze?[Ze,$e,ke]:[Ze,ke];Oe=await m.window.showQuickPick(st,{placeHolder:"Pick a rich navigation mode"})}else if(U===ne.Branch||U===ne.RemoteBranch){const Ze={kind:"latest",label:Cr("RichNavStatus.latestIndexed.label","Latest indexed commit"),description:W.index===q.Latest?`  \u2022  ${ge}`:void 0,detail:Cr("RichNavStatus.latestIndexed.detail","Enable rich navigation on the latest indexed commit. Files will be read-only.")},$e={kind:"tip+latest",label:Cr("RichNavStatus.matchLatestIndexed.label","Current commit & latest index"),description:W.index===q.TipPlusLatest?`  \u2022  ${ge}`:void 0,detail:Cr("RichNavStatus.matchLatestIndexed.detail","Enable rich navigation on the current commit using the latest index. Files will be writeable.")},ze=oe.provider.id==="github"?[Ze,$e,ke]:[Ze,ke];Oe=await m.window.showQuickPick(ze,{placeHolder:Cr("RichNavStatus.placeHolder","Pick a rich navigation mode for branch {0}",P)})}if(Oe!==void 0&&(Oe.kind==="disable"?Ie={display:j.Edit,index:q.None}:Oe.kind==="match"?Ie={display:j.Browse,index:q.Match}:Oe.kind==="match+writeable"?Ie={display:j.Edit,index:q.Match}:Oe.kind==="tip+latest"?Ie={display:j.Edit,index:q.TipPlusLatest}:Oe.kind==="latest"&&(Ie={display:j.Browse,index:q.Latest}),Ie!==void 0&&!se.equals(W,Ie))){if(await I.hasChanges()&&Ie.display===j.Browse){await m.window.showInformationMessage("The repository has outgoing changes. Commit them first before switching to browse mode.",{modal:!0,useCustom:!0});return}if(Ie.index===q.Latest){const Ze=await I.getIndexedTip();if(Ze===void 0)return;await I.sync(Ze.hash)}else Ie.index===q.TipPlusLatest&&await I.sync();if(await Y.setMode(O,Ie),V){const Ze=await I.getNonIndexedWorkspaceDescriptor();Ze!==void 0&&gn(Ze)}else I.refresh()}}a(h,"toggleIndexMode")})(Ra||(Ra={}));class Wu{constructor(e){this.telemetryService=e}static createStatus(){return Ra.create()}async createNavigationService(e,r,n){const i=await e.getIndexMetadata(r.uri);if(!(i===void 0||i.type===ft.NotIndexed))return()=>new Vu(e,r,n,this.telemetryService)}}a(Wu,"RichNavServiceProvider");var Mc;(function(t){const e=new RegExp("^vsck:\\/\\/([a-fA-F0-9]+)\\/(latest|[a-fA-F0-9]{15})\\/designtime\\/([a-fA-F0-9]+)(\\/?.*)$");function r(i){const o=e.exec(i);if(o===null||o.length!==5)return;const c={v:1,w:o[1],s:o[2],a:o[3]};return m.Uri.from({scheme:fo.scheme,authority:to(JSON.stringify(c)),path:o[4]})}a(r,"toVSCode"),t.toVSCode=r;function n(i){if(i.scheme!==fo.scheme)return;let o;try{return o=JSON.parse(Eo(i.authority)),o===void 0?void 0:{workspaceId:o.w,snapshotId:o.s,assetId:`${o.a}${i.path}`}}catch{return}}a(n,"toRichNavComponents"),t.toRichNavComponents=n})(Mc||(Mc={}));const Gu=a(class{constructor(){this._onDidChangeFile=new m.EventEmitter,this.cache=new Dr(64),this.textEncoder=new TextEncoder}get onDidChangeFile(){return this._onDidChangeFile.event}watch(t,e){return Gu.emptyDisposable}async stat(t){const e=await this.getFile(t);if(e===void 0)throw m.FileSystemError.FileNotFound();return{type:m.FileType.File,mtime:e.time,ctime:e.time,size:e.content.length,permissions:m.FilePermission.Readonly}}readDirectory(t){return[]}createDirectory(t){throw m.FileSystemError.NoPermissions()}async readFile(t){const e=await this.getFile(t);if(e===void 0)throw m.FileSystemError.FileNotFound();return e.content}writeFile(t,e,r){throw m.FileSystemError.NoPermissions()}delete(t,e){throw m.FileSystemError.NoPermissions()}rename(t,e,r){throw m.FileSystemError.NoPermissions()}async getFile(t){let e=this.cache.get(t.toString());if(e!==void 0)return e;if(t.scheme!==Gu.scheme)return;const r=Mc.toRichNavComponents(t);if(r===void 0)return;const n=await ci.getDesignTimeFileContent(r.workspaceId,r.snapshotId,r.assetId);if(n!==void 0)return e={content:this.textEncoder.encode(n),time:Date.now()},this.cache.set(t.toString(),e),e}},"_RichNavFileSystemProvider");let fo=Gu;fo.scheme="vsck-fs",fo.emptyDisposable={dispose:()=>{}};var ql;(function(t){t[t.NotIndexed=0]="NotIndexed",t[t.IndexMapped=1]="IndexMapped",t[t.Indexed=2]="Indexed"})(ql||(ql={}));const Vi=a(class{static registerCapability(t,e,r){var n;const i=this.disabledCapabilities.get(t);if(i==null?void 0:i[e])return!1;const o=this.localCapabilities.get(t);return(o==null?void 0:o[e])?!1:(n=r[e])!=null?n:!1}constructor(t,e,r,n){this.providerService=t,this.repository=e,this.changeStore=r,this.telemetryService=n,this.repositoryRoot=`${e.uri.toString()}/`;const i=a((c=!1)=>{const l=this.repository.uri;c||(this.metadata=this.providerService.getMetadata(l),this.indexMetadata=this.providerService.getIndexMetadata(l)),Promise.all([this.metadata,this.indexMetadata,this.providerService.getModeRefType(l,this.metadata)]).then(async d=>{var h,S;const[O,I,P]=this.currentlyResolved,[$,N,U]=d,W=this.providerService.getModeConfig(l,U);if(O!==void 0&&I!==void 0&&P!==void 0&&O.HEAD.sha===$.HEAD.sha&&N!==void 0&&I.type===N.type&&P.index===W.index&&P.display===W.display){const ie=(I==null?void 0:I.type)===ft.Active?await I.sha:void 0,oe=(N==null?void 0:N.type)===ft.Active?await N.sha:void 0;if(ie===oe)return}const V={newDisplayMode:W.display,newIndexMode:W.index,newIndexType:(N==null?void 0:N.type)===void 0?"undefined":ft[N==null?void 0:N.type],currentDisplayMode:(h=P==null?void 0:P.display)!=null?h:"undefined",currentIndexMode:(S=P==null?void 0:P.index)!=null?S:"undefined",currentIndexType:(I==null?void 0:I.type)===void 0?"undefined":ft[I==null?void 0:I.type]};this.telemetryService.publicLog2("codex.handleRepositoryChanged",V),this.currentlyResolved=[$,N,W];for(const ie of this.registeredFeatures.values())ie.dispose();if(this.registeredFeatures.clear(),this.pendingCapabilitiesRequests.clear(),this.documentListeners!==void 0&&this.documentListeners.dispose(),this.workspaceSnapshot=void 0,this.mapper=void 0,Zt.isActive(N)){const ie=Gn.externalIndexUri(this.providerService,$),oe=await N.sha;if(ie!==void 0&&oe!==void 0){const ge=await zr.single(ie,oe,Vo.getIndexBranchName($),{authentication:this.providerService.getAuthentication(l)});ge!==void 0&&(this.telemetryService.publicLog2("codex.foundSnapshot",{snapshotId:ge.snapshotId}),this.workspaceSnapshot=ge,this.documentListeners=this.installDocumentListeners(),((W==null?void 0:W.display)===j.Edit||$.HEAD.sha!==oe)&&(this.mapper=new me(this.providerService,l,oe,$.HEAD.sha)))}}await Ra.updateStatusBarItem()}).then(void 0,void 0)},"handleRepositoryChanged");this.metadata=this.providerService.getMetadata(this.repository.uri),this.indexMetadata=this.providerService.getIndexMetadata(this.repository.uri),this.currentlyResolved=[void 0,void 0,void 0],this.registeredFeatures=new Map,this.pendingCapabilitiesRequests=new Map,this.capabilitiesCache=new Dr(2048),this.knownDesignTimeFiles=new Set;const o=[];o.push(this.providerService.onDidChangeRepository(c=>{te(c.repository.uri)===te(this.repository.uri)&&i()})),o.push(this.providerService.onDidRefresh(c=>{for(const l of c)if(te(l)===te(this.repository.uri)){i();break}})),o.push(Y.onDidChange(c=>{c.affectsConfiguration("remoteHub.richNavigation.indexMode",this.repository.uri)&&this.providerService.refresh()})),this.environmentListeners=m.Disposable.from(...o),i(!0),Ra.addService(this),this.indexMetadata.then(async c=>{const l=this.repository.uri;let d=!1;const h=Jt.decode(this.repository.uri);if(h!==void 0&&c!==void 0&&(h.type===er.Latest&&c.type!==ft.Active||h.type===er.SHA&&(c.type!==ft.Active||await c.sha!==h.sha))&&(d=!0),!d){const S=this.providerService.getModeConfig(l,await this.providerService.getModeRefType(l,this.metadata),!0);S!==void 0&&S.display===j.Browse&&c!==void 0&&S.index!==q.None&&c.type!==ft.Active?d=!0:(c==null?void 0:c.type)===ft.Active&&await c.sha===void 0&&((S==null?void 0:S.display)===j.Browse,d=!0)}d&&m.window.showWarningMessage(Cr("RichNavService.latest.notIndexed","The repository got opened in rich code navigation mode but no corresponding index is available. Rich code navigation features are disabled.")).then(void 0,void 0)},void 0),Vi.fileSystemProvider===void 0&&(Vi.fileSystemProvider=new fo,m.workspace.registerFileSystemProvider(fo.scheme,Vi.fileSystemProvider))}key(){return te(this.repository.uri)}dispose(){for(const t of this.registeredFeatures.values())t.dispose();this.registeredFeatures.clear(),Ra.removeService(this),this.documentListeners!==void 0&&(this.documentListeners.dispose(),this.documentListeners=void 0),this.environmentListeners!==void 0&&(this.environmentListeners.dispose(),this.environmentListeners=void 0)}handles(t){return t.uri.scheme!==Qt.scheme?Promise.resolve(!1):Promise.resolve(t.uri.toString().startsWith(this.repositoryRoot))}async getBranchName(){return Vo.getBranchName(await this.metadata)}async getMetadata(){return this.metadata}async getIndexMetadata(){return this.indexMetadata}getUriMetadata(){return this.providerService.getVirtualUriMetadata(this.repository.uri)}getModeConfig(t,e){return this.providerService.getModeConfig(t,e)}getModeRefType(t){return this.providerService.getModeRefType(t)}refresh(){return this.providerService.refresh()}async getNonIndexedWorkspaceDescriptor(){const{name:t,repo:e}=await this.metadata,{ref:r}=this.providerService.getVirtualUriMetadata(this.repository.uri);return{name:t,uri:this.providerService.createVirtualUri(this.repository.uri,{repo:e,ref:r}),location:$t.CurrentWindow}}async isDocumentIndexed(t){await this.metadata;const e=await this.indexMetadata;if(e===void 0||e.type===ft.NotIndexed||this.workspaceSnapshot===void 0)return 0;const r=this.pendingCapabilitiesRequests.get(t.uri.toString());return r!==void 0&&await r,this.registeredFeatures.has(t.uri.toString())?this.mapper===void 0?2:await this.mapper.needsMapping(t)?1:2:0}async getIndexedTip(){const t=await this.metadata,e=Gn.externalIndexUri(this.providerService,t),r=Vo.getIndexBranchName(t);if(e===void 0||r===void 0)return;const n=await zr.getIndexedTip(e,r,{authentication:this.providerService.getAuthentication(this.repository.uri)});if(n===void 0)return;const i=await Nc.get(this.providerService,this.repository.uri,n.commitId);if(i!==void 0)return{...i,branchName:r}}hasChanges(){return this.changeStore.hasChanges(this.repository.uri)}sync(t){return this.providerService.sync(this.repository.uri,this.changeStore,{to:t,reason:"user"})}async getCommit(t){const e=await this.metadata,r=Gn.externalIndexUri(this.providerService,e);if(r===void 0)return;const[n,i]=await Promise.all([Nc.get(this.providerService,this.repository.uri,t),zr.single(r,t,void 0,{authentication:this.providerService.getAuthentication(this.repository.uri)})]);if(!(n===void 0||i===void 0))return{...n,branchName:i.branchName}}installDocumentListeners(){const t=[],e=a(async r=>{const n=r.uri.scheme;if(Qt.scheme!==n&&fo.scheme!==n)return;const i=r.uri.toString();if(n===Qt.scheme&&!i.startsWith(this.repositoryRoot)||n===fo.scheme&&!this.knownDesignTimeFiles.has(i)||this.pendingCapabilitiesRequests.has(i))return;const o=this.workspaceSnapshot!==void 0?this.workspaceSnapshot.commitId:void 0;if(o===void 0)return;let c=this.capabilitiesCache.get(i);if(c!==null){if(c===void 0){const l=this.capabilities(r.uri);this.pendingCapabilitiesRequests.set(i,l),c=await l,this.pendingCapabilitiesRequests.delete(i),this.capabilitiesCache.set(i,c===void 0?null:c)}c===void 0||!m.workspace.textDocuments.some(l=>l===r)||this.registerProviders(r,c,o)}},"openHandler");return t.push(m.workspace.onDidOpenTextDocument(e)),m.workspace.textDocuments.forEach(e),t.push(m.workspace.onDidCloseTextDocument(r=>{const n=r.uri.toString(),i=this.registeredFeatures.get(n);i!==void 0&&(this.registeredFeatures.delete(r.uri.toString()),i.dispose()),this.pendingCapabilitiesRequests.delete(n)})),m.Disposable.from(...t)}registerProviders(t,e,r){if(this.workspaceSnapshot===void 0)return;const n=this.workspaceSnapshot,i=t.languageId,c=[{scheme:this.repository.uri.scheme,pattern:t.uri.fsPath,language:t.languageId,exclusive:!0}],l=[],d=new Promise((N,U)=>{const W=`/${n.snapshotId}/source/`;this.metadata.then(V=>{N(kc(ie=>{const oe=m.Uri.parse(ie);if(V===void 0)return oe;try{if(oe.scheme==="vsck"&&oe.authority===n.workspaceId&&oe.path.startsWith(W))return this.repository.createRelativeUri(oe.path.substr(W.length));const ge=Mc.toVSCode(ie);return ge!==void 0?(this.knownDesignTimeFiles.add(ge.toString()),ge):oe}catch(ge){return oe}}))},U)}),h=new RegExp(`^vsck:\\/\\/${n.workspaceId}\\/(?:latest|[a-fA-F0-9]{15})\\/designtime\\/(?:[a-fA-F0-9]+)(\\/?.*)$`);function S(N){const U=h.exec(N);return U===null||U.length===2}a(S,"designTimeFilter");function O(N){if(N==null)return N;if(Array.isArray(N)){if(N.length===0)return[];const U=N[0];return typeof U.uri=="string"?N.filter(ie=>S(ie.uri)):typeof U.targetUri=="string"?N.filter(ie=>S(ie.targetUri)):[]}return h.exec(N.uri)===null?N:void 0}a(O,"filterDesignTimeFiles");async function I(N,U,W){var V,ie,oe;if(W==null||N===void 0)return W;const ge=new Map(m.workspace.textDocuments.map(Ie=>[Ie.uri.toString(!0),Ie]));if(Array.isArray(W)){const Ie=[],Oe=[];if(W.length===0)return[];for(const Ze of W){const $e=Ze;if($e.uri instanceof m.Uri){const ze=await N.mapRangeFromIndexToCode((V=ge.get($e.uri.toString()))!=null?V:$e.uri,$e.range);ze!==void 0&&Ie.push(new m.Location($e.uri,ze))}else{const ze=Ze,st=(ie=ge.get(ze.targetUri.toString()))!=null?ie:ze.targetUri,Mt=ze.originSelectionRange?await N.mapRangeFromIndexToCode(U,ze.originSelectionRange):void 0;if(Mt!==void 0||ze.originSelectionRange===void 0){const tn=await N.mapRangeFromIndexToCode(st,ze.targetRange);if(tn!==void 0){const Mn=ze.targetSelectionRange?await N.mapRangeFromIndexToCode(st,ze.targetSelectionRange):void 0;(Mn!==void 0||ze.targetSelectionRange===void 0)&&Oe.push({targetUri:ze.targetUri,targetRange:tn,targetSelectionRange:Mn,originSelectionRange:Mt})}}}}return Ie.length>0?Ie:Oe}const ke=await N.mapRangeFromIndexToCode((oe=ge.get(W.uri.toString()))!=null?oe:W.uri,W.range);if(ke!==void 0)return new m.Location(W.uri,ke)}a(I,"mapLocations");const P=a(N=>({authentication:this.providerService.getAuthentication(N.uri),correlationId:vc()}),"getRestApiOptions"),$=a((N,U)=>{const W={method:N,correlationId:U.correlationId};this.telemetryService.publicLog2("codex.restAPICall",W)},"sendTelemetry");Vi.registerCapability(i,"hoverProvider",e)&&l.push(m.languages.registerHoverProvider(c,{provideHover:async(N,U)=>{const W=await this.createTextDocumentPositionParams(N,U);if(W===void 0)return;const V=P(N);return $("codex.provideHover",V),(await d).asHover(await ci.provideHover(r,W,V))}})),Vi.registerCapability(i,"definitionProvider",e)&&l.push(m.languages.registerDefinitionProvider(c,{provideDefinition:async(N,U)=>{const W=await this.createTextDocumentPositionParams(N,U);if(W===void 0)return;const V=P(N);return $("codex.provideDefinition",V),I(this.mapper,N,(await d).asDefinitionResult(O(await ci.provideDefinition(r,W,V))))}})),Vi.registerCapability(i,"declarationProvider",e)&&l.push(m.languages.registerDeclarationProvider(c,{provideDeclaration:async(N,U)=>{const W=await this.createTextDocumentPositionParams(N,U);if(W===void 0)return;const V=P(N);return $("codex.provideDeclaration",V),I(this.mapper,N,(await d).asDeclarationResult(O(await ci.provideDeclaration(r,W,V))))}})),Vi.registerCapability(i,"typeDefinitionProvider",e)&&l.push(m.languages.registerTypeDefinitionProvider(c,{provideTypeDefinition:async(N,U)=>{const W=await this.createTextDocumentPositionParams(N,U);if(W===void 0)return;const V=P(N);return $("codex.provideTypeDefinition",V),I(this.mapper,N,(await d).asDefinitionResult(O(await ci.provideTypeDefinition(r,W,V))))}})),Vi.registerCapability(i,"referencesProvider",e)&&l.push(m.languages.registerReferenceProvider(c,{provideReferences:async(N,U,W)=>{const V=this.mapper!==void 0?await this.mapper.mapPositionFromCodeToIndex(N,U):U;if(V===void 0)return;const ie={position:{line:V.line,character:V.character},textDocument:{uri:this.createRichNavDocumentUri(N.uri).toString(!0)},context:{includeDeclaration:W.includeDeclaration}},oe=P(N);return $("codex.provideReferences",oe),I(this.mapper,N,(await d).asReferences(O(await ci.provideReferences(r,ie,oe))))}})),Vi.registerCapability(i,"foldingRangeProvider",e)&&l.push(m.languages.registerFoldingRangeProvider(c,{provideFoldingRanges:async N=>{if(this.mapper!==void 0&&await this.mapper.needsMapping(N))return;const U=P(N);return $("codex.provideFoldingRanges",U),(await d).asFoldingRanges(await ci.providerFoldingRanges(r,this.createTextDocumentParams(N.uri),U))}})),this.registeredFeatures.set(t.uri.toString(),m.Disposable.from(...l)),Ra.updateStatusBarItem()}async capabilities(t){var e;const r=this.workspaceSnapshot!==void 0?this.workspaceSnapshot.commitId:void 0;if(r!==void 0)return(e=await ci.capabilities(r,this.createTextDocumentParams(t),{authentication:this.providerService.getAuthentication(t)}))!=null?e:void 0}createTextDocumentParams(t){return{textDocument:{uri:this.createRichNavDocumentUri(t).toString(!0)}}}async createTextDocumentPositionParams(t,e){const r=this.mapper!==void 0?await this.mapper.mapPositionFromCodeToIndex(t,e):e;if(r!==void 0)return{position:{line:r.line,character:r.character},textDocument:{uri:this.createRichNavDocumentUri(t.uri).toString(!0)}}}createRichNavDocumentUri(t){if(t.scheme===fo.scheme){const n=Mc.toRichNavComponents(t);return n===void 0?t:m.Uri.file(n.assetId)}const e=this.repository.uri.toString(!0),r=t.toString(!0);return m.Uri.file(r.substr(e.length))}},"_RichNavService");let Vu=Vi;Vu.localCapabilities=new Map([["javascript",Object.assign(Gi.create(),{documentSymbolProvider:!0,foldingRangeProvider:!0})],["javascriptreact",Object.assign(Gi.create(),{documentSymbolProvider:!0,foldingRangeProvider:!0})],["typescript",Object.assign(Gi.create(),{documentSymbolProvider:!0,foldingRangeProvider:!0})],["typescriptreact",Object.assign(Gi.create(),{documentSymbolProvider:!0,foldingRangeProvider:!0})]]),Vu.disabledCapabilities=new Map([["javascript",Object.assign(Gi.create(),{declarationProvider:!0})],["javascriptreact",Object.assign(Gi.create(),{declarationProvider:!0})],["typescript",Object.assign(Gi.create(),{declarationProvider:!0})],["typescriptreact",Object.assign(Gi.create(),{declarationProvider:!0})]]);var sh=a((t,e,r)=>{if(!e.has(t))throw TypeError("Cannot "+r)},"__accessCheck"),Ki=a((t,e,r)=>(sh(t,e,"read from private field"),r?r.call(t):e.get(t)),"__privateGet"),ch=a((t,e,r)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,r)},"__privateAdd"),lh=a((t,e,r,n)=>(sh(t,e,"write to private field"),n?n.call(t,r):e.set(t,r),r),"__privateSet"),li,zl;class uh{constructor(e,r){ch(this,li,void 0),ch(this,zl,void 0),lh(this,li,e),lh(this,zl,r)}async loadWorkspaceContents(e){if(e.scheme!=="vscode-vfs")return!1;const r=Ki(this,li).getProviderRootUri(e);if(r.scheme!=="github")return!1;try{return await Ki(this,zl).getTar(r),!0}catch(n){return L.error(n),!1}}async getMetadata(e){const r=Ki(this,li).getVirtualUriMetadata(e);if(r===void 0)return;const{provider:n,repo:i}=r;return{provider:{id:n.id,name:n.name},repo:i,getRevision:async()=>{const{HEAD:o}=await Ki(this,li).getMetadata(e);return{type:o.type,name:o.name,revision:o.sha}}}}getProvider(e){return Ki(this,li).getRegisteredProvider(e)}getProviderUri(e){return Ki(this,li).getProviderUri(e)}getProviderRootUri(e){return Ki(this,li).getProviderRootUri(e)}isProviderUri(e,r){return e.scheme!==Qt.scheme&&Ki(this,li).hasProvider(e,r)}getVirtualUri(e){return Ki(this,li).getVirtualUri(e)}getVirtualWorkspaceUri(e){return Ki(this,li).getVirtualWorkspaceUri(e)}}a(uh,"ExtensionApi"),li=new WeakMap,zl=new WeakMap;var jp=Object.defineProperty,qp=Object.getOwnPropertyDescriptor,Ku=a((t,e,r,n)=>{for(var i=n>1?void 0:n?qp(e,r):e,o=t.length-1,c;o>=0;o--)(c=t[o])&&(i=(n?c(e,r,i):c(i))||i);return n&&i&&jp(e,r,i),i},"src_fs_decorateClass");const Xu=m.FileSystemError.FileNotFound().code;class Lc{constructor(e,r){this.providerService=e,this.changeStore=r,this._onDidChangeFile=new m.EventEmitter,this.implicitlyWatchedUris=new Map,this.watchedUris=new Map,this.disposable=m.Disposable.from(m.workspace.registerFileSystemProvider(this.scheme,this,{isCaseSensitive:!0}),m.workspace.registerFileSearchProvider(this.scheme,this),m.workspace.registerTextSearchProvider(this.scheme,this),e.onDidChangeRepository(n=>{n.reason==="HEAD"&&this.onRefreshOrRepositoryChanged([n.repository.uri])}),e.onDidRefresh(n=>this.onRefreshOrRepositoryChanged(n)),r.onDidChange(n=>{const i=n.map(o=>{switch(o.type){case Dt.Created:return{type:m.FileChangeType.Created,uri:o.uri};case Dt.Changed:return{type:m.FileChangeType.Changed,uri:o.uri};case Dt.Deleted:return{type:m.FileChangeType.Deleted,uri:o.uri}}});setTimeout(()=>this._onDidChangeFile.fire(i),0)}))}get onDidChangeFile(){return this._onDidChangeFile.event}get scheme(){return Qt.scheme}dispose(){var e;(e=this.disposable)==null||e.dispose()}onRefreshOrRepositoryChanged(e){e=e.filter(r=>r.scheme===this.scheme),e.length!==0&&(L.log(`fs.onRefreshOrRepositoryChanged(${e.map(r=>r.toString()).join(", ")})`),this.updateOpenOrWatchedUris(e))}updateOpenOrWatchedUris(e){const r=this.providerService.getOpenUris(this.scheme,e);for(const[i,o]of[...this.watchedUris,...this.implicitlyWatchedUris])e.some(c=>ve(o,c))&&(this.implicitlyWatchedUris.delete(i),r.set(i,o));L.debug(`fs.updateOpenOrWatchedUris(${e.map(i=>i.toString()).join(", ")}): uris=${r.size}`);for(const i of e)r.set(te(i),i);const n=[...r.values()].map(i=>({type:m.FileChangeType.Changed,uri:i}));setTimeout(()=>{L.debug(`fs.updateOpenOrWatchedUris: Firing events=${n.map(i=>i.uri.toString()).join(", ")}`),this._onDidChangeFile.fire(n)},0)}watch(e,r){const n=te(e);this.watchedUris.set(n,e);const i=this.providerService.watch(this.providerService.getProviderUri(e),r);return{dispose:()=>{this.watchedUris.delete(n),i.dispose()}}}async stat(e){const r=new ut(`fs.stat(${e.toString()})`);let n;try{if(this.changeStore.maybeHasChanges(this.providerService.getVirtualRootUri(e),e)!==!1){if(r.logStep("ChangeStore query"),n=await this.changeStore.stat(e),n!==void 0)return n;r.logStep("Provider query",{message:": Not found \u2022",suffix:" \u2022 Querying provider..."})}else r.logStep("Provider query"),this.implicitlyWatchedUris.set(te(e),e);return n=await this.providerService.stat(this.providerService.getProviderUri(e)),n}finally{n===void 0&&this.implicitlyWatchedUris.delete(te(e)),r.stop()}}async readDirectory(e){const r=new ut(`fs.readDirectory(${e.toString()})`);this.implicitlyWatchedUris.set(te(e),e);try{r.logStep("Provider query");let n=await this.providerService.readDirectory(this.providerService.getProviderUri(e));return this.changeStore.maybeHasChanges(this.providerService.getVirtualRootUri(e))!==!1&&(r.logStep("Applying changes",{suffix:" \u2022 Applying changes..."}),n=await this.changeStore.updateDirectoryEntries(e,n)),n}finally{r.stop()}}async createDirectory(e){const r=new ut(`fs.createDirectory(${e.toString()})`);try{await this.changeStore.createDirectory(e)}catch(n){throw L.error(n,r.context),n}finally{r.stop()}}async readFile(e){const r=new ut(`fs.readFile(${e.toString()})`),n=te(e);let i;try{if(this.changeStore.maybeHasChanges(this.providerService.getVirtualRootUri(e),e)!==!1){r.logStep("ChangeStore query");const o=await this.changeStore.readFile(e);if(o!==void 0)return o;r.logStep("Provider query",{message:": Not found \u2022",suffix:" \u2022 Querying provider..."})}else r.logStep("Provider query"),this.implicitlyWatchedUris.set(n,e);return i=await this.providerService.readFile(this.providerService.getProviderUri(e)),i}finally{i===void 0&&this.implicitlyWatchedUris.delete(n),r.stop()}}async writeFile(e,r,n){const i=new ut(`fs.writeFile(${e.toString()})`,{},r.length,n);try{let o;try{if(o=await this.stat(e),!n.overwrite)throw m.FileSystemError.FileExists()}catch(c){if(c instanceof m.FileSystemError&&c.code===Xu){if(!n.create)throw m.FileSystemError.FileNotFound(e)}else throw c}try{if(o===void 0)await this.changeStore.createFile(e,r);else{i.logStep("Provider original query");let c;try{c=await this.providerService.readFile(this.providerService.getProviderUri(e))}catch(l){if(l instanceof m.FileSystemError&&l.code===Xu)c=new Uint8Array;else throw l}i.logStep("Writing file",{suffix:" \u2022 Writing file to Change Store..."}),await this.changeStore.writeFile(e,r,c)}}catch(c){throw L.error(c,i.context),c}}finally{i.stop()}}async delete(e,r){const n=new ut(`fs.delete(${e.toString()})`,{},r);try{switch((await this.stat(e)).type){case m.FileType.File:await this.changeStore.deleteFile(e);break;case m.FileType.Directory:{await this.deleteDirectory(e,r);break}default:throw m.FileSystemError.NoPermissions()}}catch(i){throw L.error(i,n.context),i}finally{n.stop()}}async deleteDirectory(e,r){const n=new ut(`fs.deleteDirectory(${e.toString()})`,{},r);try{const i=await this.readDirectory(e);if(i.length!==0){if(!r.recursive&&i.some(([,o])=>o===m.FileType.Directory))throw m.FileSystemError.NoPermissions();for(const[o,c]of i)c===m.FileType.Directory?await this.deleteDirectory(m.Uri.joinPath(e,o),r):await this.changeStore.deleteFile(m.Uri.joinPath(e,o))}await this.changeStore.deleteDirectory(e)}catch(i){throw L.error(i,n.context),i}finally{n.stop()}}async rename(e,r,n){const i=new ut(`fs.rename(${e.toString()} -> ${r.toString()})`,{},n);try{switch((await this.stat(e)).type){case m.FileType.File:{const c=await this.readFile(e);await this.writeFile(r,c,{create:!0,overwrite:n.overwrite}),await this.delete(e,{recursive:!1});break}case m.FileType.Directory:{await this.renameDirectory(e,r,n);break}default:throw m.FileSystemError.NoPermissions()}}catch(o){throw L.error(o,i.context),o}finally{i.stop()}}async renameDirectory(e,r,n){const i=new ut(`fs.renameDirectory(${e.toString()} -> ${r.toString()})`,{},n);try{await this.copyDirectory(e,r,n),await this.delete(e,{recursive:!0})}catch(o){throw L.error(o,i.context),o}finally{i.stop()}}async copy(e,r,n){const i=new ut(`fs.copy(${e.toString()} -> ${r.toString()})`,{},n);try{switch((await this.stat(e)).type){case m.FileType.File:{const c=await this.readFile(e);await this.writeFile(r,c,{create:!0,overwrite:n.overwrite});break}case m.FileType.Directory:{await this.copyDirectory(e,r,n);break}default:throw m.FileSystemError.NoPermissions()}}catch(o){throw L.error(o,i.context),o}finally{i.stop()}}async copyDirectory(e,r,n){const i=new ut(`fs.copyDirectory(${e.toString()} -> ${r.toString()})`,{},n);try{if(await this.exists(r))throw m.FileSystemError.FileExists();try{await this.createDirectory(r);const o=await this.readDirectory(e);for(const[c,l]of o)l===m.FileType.Directory?await this.copyDirectory(m.Uri.joinPath(e,c),m.Uri.joinPath(r,c),n):await this.copy(m.Uri.joinPath(e,c),m.Uri.joinPath(r,c),n)}catch(o){throw L.error(o,i.context),o}}finally{i.stop()}}async exists(e){try{return await this.stat(e),!0}catch(r){if(r instanceof m.FileSystemError&&r.code===Xu)return!1;throw r}}async provideFileSearchResults(e,r,n){var i;const o=new ut(`fs.provideFileSearchResults(${e.pattern}, ${r.folder.toString()})`,{logLevel:qe.Debug});let c;try{return c=await this.providerService.provideFileSearchResults(e,{...r,folder:this.providerService.getProviderUri(r.folder)},n),c==null?void 0:c.map(l=>this.providerService.getVirtualUri(l))}catch(l){throw L.error(l,o.context),l}finally{o.stop({suffix:` \u2022 ${(i=c==null?void 0:c.length)!=null?i:0} results found`})}}provideTextSearchResults(e,r,n,i){return this.providerService.provideTextSearchResults(e,{...r,folder:this.providerService.getProviderUri(r.folder)},{report:o=>n.report({...o,uri:this.providerService.getVirtualUri(o.uri)})},i)}}a(Lc,"ChangeTrackingFileSystem"),Ku([Mr()],Lc.prototype,"stat",1),Ku([Mr()],Lc.prototype,"readDirectory",1),Ku([Mr()],Lc.prototype,"readFile",1);function zp(t){return t.replace(/[\\{}*+?|^$.[\]()]/g,"\\$&")}a(zp,"escapeRegExpCharacters");function Wp(t,e,r={}){if(!t)throw new Error("Cannot create regex from empty string");e||(t=zp(t)),r.wholeWord&&(/\B/.test(t.charAt(0))||(t=`\\b${t}`),/\B/.test(t.charAt(t.length-1))||(t=`${t}\\b`));let n="gmu";return r.matchCase||(n+="i"),new RegExp(t,n)}a(Wp,"createRegExp");let dh,hh,Qu;const Gp=a((t,e,r,n)=>{const i=`${e.join("--")};;;;${r.join("--")}`,o=t.map(l=>l.path).join("::");if(dh===o&&i==hh&&Qu)return Qu;const c=Pr((n?t.filter(l=>l.size<n):t).map(l=>l.path),e,r);return dh=o,hh=i,Qu=c,c},"generateIncludeSet"),Vp=a((t,e,r,n)=>{var i;const o=[];let c;if(typeof t=="string")c=t;else{const S=t;if(S[0]==255&&S[1]==254)c=new TextDecoder("utf-16le").decode(S);else if(S[0]==254&&S[1]==255)c=new TextDecoder("utf-16be").decode(S);else if(c=new TextDecoder("utf8").decode(S),c.slice(0,1e3).includes("\uFFFD")&&S.includes(0))return[]}const l=[];let d=null,h=n.remainingResultQuota;for(;(h===void 0||h>=0)&&(d=r.exec(c));)l.push({matchStartIndex:d.index,matchedText:d[0]}),h!==void 0&&h--;if(l.length){const S=new Set,O=new Set,I=[],P=a(V=>c.slice(I[V].start,I[V].end),"readLine");let $=0,N=null;const U=/\r?\n/g;for(;N=U.exec(c);)I.push({start:$,end:N.index}),$=N.index+N[0].length;$<c.length&&I.push({start:$,end:c.length});let W=0;for(const{matchStartIndex:V,matchedText:ie}of l){if(h!==void 0&&h<0)break;for(;Boolean(I[W+1])&&V>I[W].end;)W++;let oe=W;for(;Boolean(I[oe+1])&&V+ie.length>I[oe].end;)oe++;if(n.beforeContext)for(let $e=Math.max(0,W-n.beforeContext);$e<W;$e++)S.add($e);let ge="",ke=0;for(let $e=W;$e<=oe;$e++){let ze=P($e);((i=n.previewOptions)==null?void 0:i.charsPerLine)&&ze.length>n.previewOptions.charsPerLine&&(ke=Math.max(V-I[W].start-20,0),ze=ze.substr(ke,n.previewOptions.charsPerLine)),ge+=`${ze}
`,O.add($e)}const Ie=new m.Range(W,V-I[W].start,oe,V+ie.length-I[oe].start),Oe=new m.Range(0,V-I[W].start-ke,oe-W,V+ie.length-I[oe].start-(oe===W?ke:0)),Ze={uri:m.Uri.file(e),ranges:Ie,preview:{text:ge,matches:Oe}};if(o.push(Ze),n.afterContext)for(let $e=oe+1;$e<=Math.min(oe+n.afterContext,I.length-1);$e++)S.add($e)}for(const V of S)O.has(V)||o.push({uri:m.Uri.file(e),text:P(V),lineNumber:V+1})}return o},"getFileResults");var Kp=__webpack_require__(5790);/*! pako 2.0.4 https://github.com/nodeca/pako @license (MIT AND Zlib) */const Xp=4,fh=0,ph=1,Qp=2;function Ms(t){let e=t.length;for(;--e>=0;)t[e]=0}a(Ms,"zero$1");const Yp=0,gh=1,Zp=2,Jp=3,eg=258,Yu=29,$c=256,Fc=$c+1+Yu,Ls=30,Zu=19,mh=2*Fc+1,Ia=15,Ju=16,tg=7,ed=256,vh=16,yh=17,_h=18,td=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Wl=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),rg=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),wh=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ng=512,po=new Array((Fc+2)*2);Ms(po);const Bc=new Array(Ls*2);Ms(Bc);const Hc=new Array(ng);Ms(Hc);const Uc=new Array(eg-Jp+1);Ms(Uc);const rd=new Array(Yu);Ms(rd);const Gl=new Array(Ls);Ms(Gl);function nd(t,e,r,n,i){this.static_tree=t,this.extra_bits=e,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=t&&t.length}a(nd,"StaticTreeDesc");let bh,Sh,Eh;function id(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}a(id,"TreeDesc");const xh=a(t=>t<256?Hc[t]:Hc[256+(t>>>7)],"d_code"),jc=a((t,e)=>{t.pending_buf[t.pending++]=e&255,t.pending_buf[t.pending++]=e>>>8&255},"put_short"),kn=a((t,e,r)=>{t.bi_valid>Ju-r?(t.bi_buf|=e<<t.bi_valid&65535,jc(t,t.bi_buf),t.bi_buf=e>>Ju-t.bi_valid,t.bi_valid+=r-Ju):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=r)},"send_bits"),Xi=a((t,e,r)=>{kn(t,r[e*2],r[e*2+1])},"send_code"),Ch=a((t,e)=>{let r=0;do r|=t&1,t>>>=1,r<<=1;while(--e>0);return r>>>1},"bi_reverse"),ig=a(t=>{t.bi_valid===16?(jc(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=t.bi_buf&255,t.bi_buf>>=8,t.bi_valid-=8)},"bi_flush"),og=a((t,e)=>{const r=e.dyn_tree,n=e.max_code,i=e.stat_desc.static_tree,o=e.stat_desc.has_stree,c=e.stat_desc.extra_bits,l=e.stat_desc.extra_base,d=e.stat_desc.max_length;let h,S,O,I,P,$,N=0;for(I=0;I<=Ia;I++)t.bl_count[I]=0;for(r[t.heap[t.heap_max]*2+1]=0,h=t.heap_max+1;h<mh;h++)S=t.heap[h],I=r[r[S*2+1]*2+1]+1,I>d&&(I=d,N++),r[S*2+1]=I,!(S>n)&&(t.bl_count[I]++,P=0,S>=l&&(P=c[S-l]),$=r[S*2],t.opt_len+=$*(I+P),o&&(t.static_len+=$*(i[S*2+1]+P)));if(N!==0){do{for(I=d-1;t.bl_count[I]===0;)I--;t.bl_count[I]--,t.bl_count[I+1]+=2,t.bl_count[d]--,N-=2}while(N>0);for(I=d;I!==0;I--)for(S=t.bl_count[I];S!==0;)O=t.heap[--h],!(O>n)&&(r[O*2+1]!==I&&(t.opt_len+=(I-r[O*2+1])*r[O*2],r[O*2+1]=I),S--)}},"gen_bitlen"),Th=a((t,e,r)=>{const n=new Array(Ia+1);let i=0,o,c;for(o=1;o<=Ia;o++)n[o]=i=i+r[o-1]<<1;for(c=0;c<=e;c++){let l=t[c*2+1];l!==0&&(t[c*2]=Ch(n[l]++,l))}},"gen_codes"),ag=a(()=>{let t,e,r,n,i;const o=new Array(Ia+1);for(r=0,n=0;n<Yu-1;n++)for(rd[n]=r,t=0;t<1<<td[n];t++)Uc[r++]=n;for(Uc[r-1]=n,i=0,n=0;n<16;n++)for(Gl[n]=i,t=0;t<1<<Wl[n];t++)Hc[i++]=n;for(i>>=7;n<Ls;n++)for(Gl[n]=i<<7,t=0;t<1<<Wl[n]-7;t++)Hc[256+i++]=n;for(e=0;e<=Ia;e++)o[e]=0;for(t=0;t<=143;)po[t*2+1]=8,t++,o[8]++;for(;t<=255;)po[t*2+1]=9,t++,o[9]++;for(;t<=279;)po[t*2+1]=7,t++,o[7]++;for(;t<=287;)po[t*2+1]=8,t++,o[8]++;for(Th(po,Fc+1,o),t=0;t<Ls;t++)Bc[t*2+1]=5,Bc[t*2]=Ch(t,5);bh=new nd(po,td,$c+1,Fc,Ia),Sh=new nd(Bc,Wl,0,Ls,Ia),Eh=new nd(new Array(0),rg,0,Zu,tg)},"tr_static_init"),Ah=a(t=>{let e;for(e=0;e<Fc;e++)t.dyn_ltree[e*2]=0;for(e=0;e<Ls;e++)t.dyn_dtree[e*2]=0;for(e=0;e<Zu;e++)t.bl_tree[e*2]=0;t.dyn_ltree[ed*2]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0},"init_block"),Rh=a(t=>{t.bi_valid>8?jc(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},"bi_windup"),sg=a((t,e,r,n)=>{Rh(t),n&&(jc(t,r),jc(t,~r)),t.pending_buf.set(t.window.subarray(e,e+r),t.pending),t.pending+=r},"copy_block"),Ih=a((t,e,r,n)=>{const i=e*2,o=r*2;return t[i]<t[o]||t[i]===t[o]&&n[e]<=n[r]},"smaller"),od=a((t,e,r)=>{const n=t.heap[r];let i=r<<1;for(;i<=t.heap_len&&(i<t.heap_len&&Ih(e,t.heap[i+1],t.heap[i],t.depth)&&i++,!Ih(e,n,t.heap[i],t.depth));)t.heap[r]=t.heap[i],r=i,i<<=1;t.heap[r]=n},"pqdownheap"),Oh=a((t,e,r)=>{let n,i,o=0,c,l;if(t.last_lit!==0)do n=t.pending_buf[t.d_buf+o*2]<<8|t.pending_buf[t.d_buf+o*2+1],i=t.pending_buf[t.l_buf+o],o++,n===0?Xi(t,i,e):(c=Uc[i],Xi(t,c+$c+1,e),l=td[c],l!==0&&(i-=rd[c],kn(t,i,l)),n--,c=xh(n),Xi(t,c,r),l=Wl[c],l!==0&&(n-=Gl[c],kn(t,n,l)));while(o<t.last_lit);Xi(t,ed,e)},"compress_block"),ad=a((t,e)=>{const r=e.dyn_tree,n=e.stat_desc.static_tree,i=e.stat_desc.has_stree,o=e.stat_desc.elems;let c,l,d=-1,h;for(t.heap_len=0,t.heap_max=mh,c=0;c<o;c++)r[c*2]!==0?(t.heap[++t.heap_len]=d=c,t.depth[c]=0):r[c*2+1]=0;for(;t.heap_len<2;)h=t.heap[++t.heap_len]=d<2?++d:0,r[h*2]=1,t.depth[h]=0,t.opt_len--,i&&(t.static_len-=n[h*2+1]);for(e.max_code=d,c=t.heap_len>>1;c>=1;c--)od(t,r,c);h=o;do c=t.heap[1],t.heap[1]=t.heap[t.heap_len--],od(t,r,1),l=t.heap[1],t.heap[--t.heap_max]=c,t.heap[--t.heap_max]=l,r[h*2]=r[c*2]+r[l*2],t.depth[h]=(t.depth[c]>=t.depth[l]?t.depth[c]:t.depth[l])+1,r[c*2+1]=r[l*2+1]=h,t.heap[1]=h++,od(t,r,1);while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],og(t,e),Th(r,d,t.bl_count)},"build_tree"),Ph=a((t,e,r)=>{let n,i=-1,o,c=e[0*2+1],l=0,d=7,h=4;for(c===0&&(d=138,h=3),e[(r+1)*2+1]=65535,n=0;n<=r;n++)o=c,c=e[(n+1)*2+1],!(++l<d&&o===c)&&(l<h?t.bl_tree[o*2]+=l:o!==0?(o!==i&&t.bl_tree[o*2]++,t.bl_tree[vh*2]++):l<=10?t.bl_tree[yh*2]++:t.bl_tree[_h*2]++,l=0,i=o,c===0?(d=138,h=3):o===c?(d=6,h=3):(d=7,h=4))},"scan_tree"),Dh=a((t,e,r)=>{let n,i=-1,o,c=e[0*2+1],l=0,d=7,h=4;for(c===0&&(d=138,h=3),n=0;n<=r;n++)if(o=c,c=e[(n+1)*2+1],!(++l<d&&o===c)){if(l<h)do Xi(t,o,t.bl_tree);while(--l!=0);else o!==0?(o!==i&&(Xi(t,o,t.bl_tree),l--),Xi(t,vh,t.bl_tree),kn(t,l-3,2)):l<=10?(Xi(t,yh,t.bl_tree),kn(t,l-3,3)):(Xi(t,_h,t.bl_tree),kn(t,l-11,7));l=0,i=o,c===0?(d=138,h=3):o===c?(d=6,h=3):(d=7,h=4)}},"send_tree"),cg=a(t=>{let e;for(Ph(t,t.dyn_ltree,t.l_desc.max_code),Ph(t,t.dyn_dtree,t.d_desc.max_code),ad(t,t.bl_desc),e=Zu-1;e>=3&&t.bl_tree[wh[e]*2+1]===0;e--);return t.opt_len+=3*(e+1)+5+5+4,e},"build_bl_tree"),lg=a((t,e,r,n)=>{let i;for(kn(t,e-257,5),kn(t,r-1,5),kn(t,n-4,4),i=0;i<n;i++)kn(t,t.bl_tree[wh[i]*2+1],3);Dh(t,t.dyn_ltree,e-1),Dh(t,t.dyn_dtree,r-1)},"send_all_trees"),ug=a(t=>{let e=4093624447,r;for(r=0;r<=31;r++,e>>>=1)if(e&1&&t.dyn_ltree[r*2]!==0)return fh;if(t.dyn_ltree[9*2]!==0||t.dyn_ltree[10*2]!==0||t.dyn_ltree[13*2]!==0)return ph;for(r=32;r<$c;r++)if(t.dyn_ltree[r*2]!==0)return ph;return fh},"detect_data_type");let kh=!1;const dg=a(t=>{kh||(ag(),kh=!0),t.l_desc=new id(t.dyn_ltree,bh),t.d_desc=new id(t.dyn_dtree,Sh),t.bl_desc=new id(t.bl_tree,Eh),t.bi_buf=0,t.bi_valid=0,Ah(t)},"_tr_init$1"),Nh=a((t,e,r,n)=>{kn(t,(Yp<<1)+(n?1:0),3),sg(t,e,r,!0)},"_tr_stored_block$1"),hg=a(t=>{kn(t,gh<<1,3),Xi(t,ed,po),ig(t)},"_tr_align$1"),fg=a((t,e,r,n)=>{let i,o,c=0;t.level>0?(t.strm.data_type===Qp&&(t.strm.data_type=ug(t)),ad(t,t.l_desc),ad(t,t.d_desc),c=cg(t),i=t.opt_len+3+7>>>3,o=t.static_len+3+7>>>3,o<=i&&(i=o)):i=o=r+5,r+4<=i&&e!==-1?Nh(t,e,r,n):t.strategy===Xp||o===i?(kn(t,(gh<<1)+(n?1:0),3),Oh(t,po,Bc)):(kn(t,(Zp<<1)+(n?1:0),3),lg(t,t.l_desc.max_code+1,t.d_desc.max_code+1,c+1),Oh(t,t.dyn_ltree,t.dyn_dtree)),Ah(t),n&&Rh(t)},"_tr_flush_block$1"),pg=a((t,e,r)=>(t.pending_buf[t.d_buf+t.last_lit*2]=e>>>8&255,t.pending_buf[t.d_buf+t.last_lit*2+1]=e&255,t.pending_buf[t.l_buf+t.last_lit]=r&255,t.last_lit++,e===0?t.dyn_ltree[r*2]++:(t.matches++,e--,t.dyn_ltree[(Uc[r]+$c+1)*2]++,t.dyn_dtree[xh(e)*2]++),t.last_lit===t.lit_bufsize-1),"_tr_tally$1");var gg=dg,mg=Nh,vg=fg,yg=pg,_g=hg,wg={_tr_init:gg,_tr_stored_block:mg,_tr_flush_block:vg,_tr_tally:yg,_tr_align:_g},qc=a((t,e,r,n)=>{let i=t&65535|0,o=t>>>16&65535|0,c=0;for(;r!==0;){c=r>2e3?2e3:r,r-=c;do i=i+e[n++]|0,o=o+i|0;while(--c);i%=65521,o%=65521}return i|o<<16|0},"adler32");const bg=a(()=>{let t,e=[];for(var r=0;r<256;r++){t=r;for(var n=0;n<8;n++)t=t&1?3988292384^t>>>1:t>>>1;e[r]=t}return e},"makeTable"),Sg=new Uint32Array(bg());var Jr=a((t,e,r,n)=>{const i=Sg,o=n+r;t^=-1;for(let c=n;c<o;c++)t=t>>>8^i[(t^e[c])&255];return t^-1},"crc32"),Oa={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Pa={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Eg,_tr_stored_block:xg,_tr_flush_block:Cg,_tr_tally:Ko,_tr_align:Tg}=wg,{Z_NO_FLUSH:Da,Z_PARTIAL_FLUSH:Ag,Z_FULL_FLUSH:Rg,Z_FINISH:Xo,Z_BLOCK:Mh,Z_OK:Qi,Z_STREAM_END:Lh,Z_STREAM_ERROR:ui,Z_DATA_ERROR:Ig,Z_BUF_ERROR:sd,Z_DEFAULT_COMPRESSION:Og,Z_FILTERED:Pg,Z_HUFFMAN_ONLY:Vl,Z_RLE:Dg,Z_FIXED:kg,Z_DEFAULT_STRATEGY:Ng,Z_UNKNOWN:Mg,Z_DEFLATED:Kl}=Pa,Lg=9,$g=15,Fg=8,Bg=29,cd=256+1+Bg,Hg=30,Ug=19,jg=2*cd+1,qg=15,Yt=3,Qo=258,Pi=Qo+Yt+1,zg=32,Xl=42,ld=69,Ql=73,Yl=91,Zl=103,ka=113,zc=666,Wr=1,Wc=2,Na=3,$s=4,Wg=3,Yo=a((t,e)=>(t.msg=Oa[e],e),"err"),$h=a(t=>(t<<1)-(t>4?9:0),"rank"),Zo=a(t=>{let e=t.length;for(;--e>=0;)t[e]=0},"zero");let Jo=a((t,e,r)=>(e<<t.hash_shift^r)&t.hash_mask,"HASH_ZLIB");const ea=a(t=>{const e=t.state;let r=e.pending;r>t.avail_out&&(r=t.avail_out),r!==0&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+r),t.next_out),t.next_out+=r,e.pending_out+=r,t.total_out+=r,t.avail_out-=r,e.pending-=r,e.pending===0&&(e.pending_out=0))},"flush_pending"),un=a((t,e)=>{Cg(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,ea(t.strm)},"flush_block_only"),rr=a((t,e)=>{t.pending_buf[t.pending++]=e},"put_byte"),Gc=a((t,e)=>{t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=e&255},"putShortMSB"),Gg=a((t,e,r,n)=>{let i=t.avail_in;return i>n&&(i=n),i===0?0:(t.avail_in-=i,e.set(t.input.subarray(t.next_in,t.next_in+i),r),t.state.wrap===1?t.adler=qc(t.adler,e,i,r):t.state.wrap===2&&(t.adler=Jr(t.adler,e,i,r)),t.next_in+=i,t.total_in+=i,i)},"read_buf"),Fh=a((t,e)=>{let r=t.max_chain_length,n=t.strstart,i,o,c=t.prev_length,l=t.nice_match;const d=t.strstart>t.w_size-Pi?t.strstart-(t.w_size-Pi):0,h=t.window,S=t.w_mask,O=t.prev,I=t.strstart+Qo;let P=h[n+c-1],$=h[n+c];t.prev_length>=t.good_match&&(r>>=2),l>t.lookahead&&(l=t.lookahead);do if(i=e,!(h[i+c]!==$||h[i+c-1]!==P||h[i]!==h[n]||h[++i]!==h[n+1])){n+=2,i++;do;while(h[++n]===h[++i]&&h[++n]===h[++i]&&h[++n]===h[++i]&&h[++n]===h[++i]&&h[++n]===h[++i]&&h[++n]===h[++i]&&h[++n]===h[++i]&&h[++n]===h[++i]&&n<I);if(o=Qo-(I-n),n=I-Qo,o>c){if(t.match_start=e,c=o,o>=l)break;P=h[n+c-1],$=h[n+c]}}while((e=O[e&S])>d&&--r!=0);return c<=t.lookahead?c:t.lookahead},"longest_match"),Ma=a(t=>{const e=t.w_size;let r,n,i,o,c;do{if(o=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-Pi)){t.window.set(t.window.subarray(e,e+e),0),t.match_start-=e,t.strstart-=e,t.block_start-=e,n=t.hash_size,r=n;do i=t.head[--r],t.head[r]=i>=e?i-e:0;while(--n);n=e,r=n;do i=t.prev[--r],t.prev[r]=i>=e?i-e:0;while(--n);o+=e}if(t.strm.avail_in===0)break;if(n=Gg(t.strm,t.window,t.strstart+t.lookahead,o),t.lookahead+=n,t.lookahead+t.insert>=Yt)for(c=t.strstart-t.insert,t.ins_h=t.window[c],t.ins_h=Jo(t,t.ins_h,t.window[c+1]);t.insert&&(t.ins_h=Jo(t,t.ins_h,t.window[c+Yt-1]),t.prev[c&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=c,c++,t.insert--,!(t.lookahead+t.insert<Yt)););}while(t.lookahead<Pi&&t.strm.avail_in!==0)},"fill_window"),Vg=a((t,e)=>{let r=65535;for(r>t.pending_buf_size-5&&(r=t.pending_buf_size-5);;){if(t.lookahead<=1){if(Ma(t),t.lookahead===0&&e===Da)return Wr;if(t.lookahead===0)break}t.strstart+=t.lookahead,t.lookahead=0;const n=t.block_start+r;if((t.strstart===0||t.strstart>=n)&&(t.lookahead=t.strstart-n,t.strstart=n,un(t,!1),t.strm.avail_out===0)||t.strstart-t.block_start>=t.w_size-Pi&&(un(t,!1),t.strm.avail_out===0))return Wr}return t.insert=0,e===Xo?(un(t,!0),t.strm.avail_out===0?Na:$s):(t.strstart>t.block_start&&(un(t,!1),t.strm.avail_out===0),Wr)},"deflate_stored"),ud=a((t,e)=>{let r,n;for(;;){if(t.lookahead<Pi){if(Ma(t),t.lookahead<Pi&&e===Da)return Wr;if(t.lookahead===0)break}if(r=0,t.lookahead>=Yt&&(t.ins_h=Jo(t,t.ins_h,t.window[t.strstart+Yt-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),r!==0&&t.strstart-r<=t.w_size-Pi&&(t.match_length=Fh(t,r)),t.match_length>=Yt)if(n=Ko(t,t.strstart-t.match_start,t.match_length-Yt),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=Yt){t.match_length--;do t.strstart++,t.ins_h=Jo(t,t.ins_h,t.window[t.strstart+Yt-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart;while(--t.match_length!=0);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=Jo(t,t.ins_h,t.window[t.strstart+1]);else n=Ko(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(un(t,!1),t.strm.avail_out===0))return Wr}return t.insert=t.strstart<Yt-1?t.strstart:Yt-1,e===Xo?(un(t,!0),t.strm.avail_out===0?Na:$s):t.last_lit&&(un(t,!1),t.strm.avail_out===0)?Wr:Wc},"deflate_fast"),Fs=a((t,e)=>{let r,n,i;for(;;){if(t.lookahead<Pi){if(Ma(t),t.lookahead<Pi&&e===Da)return Wr;if(t.lookahead===0)break}if(r=0,t.lookahead>=Yt&&(t.ins_h=Jo(t,t.ins_h,t.window[t.strstart+Yt-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=Yt-1,r!==0&&t.prev_length<t.max_lazy_match&&t.strstart-r<=t.w_size-Pi&&(t.match_length=Fh(t,r),t.match_length<=5&&(t.strategy===Pg||t.match_length===Yt&&t.strstart-t.match_start>4096)&&(t.match_length=Yt-1)),t.prev_length>=Yt&&t.match_length<=t.prev_length){i=t.strstart+t.lookahead-Yt,n=Ko(t,t.strstart-1-t.prev_match,t.prev_length-Yt),t.lookahead-=t.prev_length-1,t.prev_length-=2;do++t.strstart<=i&&(t.ins_h=Jo(t,t.ins_h,t.window[t.strstart+Yt-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart);while(--t.prev_length!=0);if(t.match_available=0,t.match_length=Yt-1,t.strstart++,n&&(un(t,!1),t.strm.avail_out===0))return Wr}else if(t.match_available){if(n=Ko(t,0,t.window[t.strstart-1]),n&&un(t,!1),t.strstart++,t.lookahead--,t.strm.avail_out===0)return Wr}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=Ko(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<Yt-1?t.strstart:Yt-1,e===Xo?(un(t,!0),t.strm.avail_out===0?Na:$s):t.last_lit&&(un(t,!1),t.strm.avail_out===0)?Wr:Wc},"deflate_slow"),Kg=a((t,e)=>{let r,n,i,o;const c=t.window;for(;;){if(t.lookahead<=Qo){if(Ma(t),t.lookahead<=Qo&&e===Da)return Wr;if(t.lookahead===0)break}if(t.match_length=0,t.lookahead>=Yt&&t.strstart>0&&(i=t.strstart-1,n=c[i],n===c[++i]&&n===c[++i]&&n===c[++i])){o=t.strstart+Qo;do;while(n===c[++i]&&n===c[++i]&&n===c[++i]&&n===c[++i]&&n===c[++i]&&n===c[++i]&&n===c[++i]&&n===c[++i]&&i<o);t.match_length=Qo-(o-i),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=Yt?(r=Ko(t,1,t.match_length-Yt),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(r=Ko(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),r&&(un(t,!1),t.strm.avail_out===0))return Wr}return t.insert=0,e===Xo?(un(t,!0),t.strm.avail_out===0?Na:$s):t.last_lit&&(un(t,!1),t.strm.avail_out===0)?Wr:Wc},"deflate_rle"),Xg=a((t,e)=>{let r;for(;;){if(t.lookahead===0&&(Ma(t),t.lookahead===0)){if(e===Da)return Wr;break}if(t.match_length=0,r=Ko(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,r&&(un(t,!1),t.strm.avail_out===0))return Wr}return t.insert=0,e===Xo?(un(t,!0),t.strm.avail_out===0?Na:$s):t.last_lit&&(un(t,!1),t.strm.avail_out===0)?Wr:Wc},"deflate_huff");function Yi(t,e,r,n,i){this.good_length=t,this.max_lazy=e,this.nice_length=r,this.max_chain=n,this.func=i}a(Yi,"Config");const Vc=[new Yi(0,0,0,0,Vg),new Yi(4,4,8,4,ud),new Yi(4,5,16,8,ud),new Yi(4,6,32,32,ud),new Yi(4,4,16,16,Fs),new Yi(8,16,32,32,Fs),new Yi(8,16,128,128,Fs),new Yi(8,32,128,256,Fs),new Yi(32,128,258,1024,Fs),new Yi(32,258,258,4096,Fs)],Qg=a(t=>{t.window_size=2*t.w_size,Zo(t.head),t.max_lazy_match=Vc[t.level].max_lazy,t.good_match=Vc[t.level].good_length,t.nice_match=Vc[t.level].nice_length,t.max_chain_length=Vc[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=Yt-1,t.match_available=0,t.ins_h=0},"lm_init");function Yg(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Kl,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(jg*2),this.dyn_dtree=new Uint16Array((2*Hg+1)*2),this.bl_tree=new Uint16Array((2*Ug+1)*2),Zo(this.dyn_ltree),Zo(this.dyn_dtree),Zo(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(qg+1),this.heap=new Uint16Array(2*cd+1),Zo(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*cd+1),Zo(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}a(Yg,"DeflateState");const Bh=a(t=>{if(!t||!t.state)return Yo(t,ui);t.total_in=t.total_out=0,t.data_type=Mg;const e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?Xl:ka,t.adler=e.wrap===2?0:1,e.last_flush=Da,Eg(e),Qi},"deflateResetKeep"),Hh=a(t=>{const e=Bh(t);return e===Qi&&Qg(t.state),e},"deflateReset"),Zg=a((t,e)=>!t||!t.state||t.state.wrap!==2?ui:(t.state.gzhead=e,Qi),"deflateSetHeader"),Uh=a((t,e,r,n,i,o)=>{if(!t)return ui;let c=1;if(e===Og&&(e=6),n<0?(c=0,n=-n):n>15&&(c=2,n-=16),i<1||i>Lg||r!==Kl||n<8||n>15||e<0||e>9||o<0||o>kg)return Yo(t,ui);n===8&&(n=9);const l=new Yg;return t.state=l,l.strm=t,l.wrap=c,l.gzhead=null,l.w_bits=n,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=i+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+Yt-1)/Yt),l.window=new Uint8Array(l.w_size*2),l.head=new Uint16Array(l.hash_size),l.prev=new Uint16Array(l.w_size),l.lit_bufsize=1<<i+6,l.pending_buf_size=l.lit_bufsize*4,l.pending_buf=new Uint8Array(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=(1+2)*l.lit_bufsize,l.level=e,l.strategy=o,l.method=r,Hh(t)},"deflateInit2"),Jg=a((t,e)=>Uh(t,e,Kl,$g,Fg,Ng),"deflateInit"),em=a((t,e)=>{let r,n;if(!t||!t.state||e>Mh||e<0)return t?Yo(t,ui):ui;const i=t.state;if(!t.output||!t.input&&t.avail_in!==0||i.status===zc&&e!==Xo)return Yo(t,t.avail_out===0?sd:ui);i.strm=t;const o=i.last_flush;if(i.last_flush=e,i.status===Xl)if(i.wrap===2)t.adler=0,rr(i,31),rr(i,139),rr(i,8),i.gzhead?(rr(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),rr(i,i.gzhead.time&255),rr(i,i.gzhead.time>>8&255),rr(i,i.gzhead.time>>16&255),rr(i,i.gzhead.time>>24&255),rr(i,i.level===9?2:i.strategy>=Vl||i.level<2?4:0),rr(i,i.gzhead.os&255),i.gzhead.extra&&i.gzhead.extra.length&&(rr(i,i.gzhead.extra.length&255),rr(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(t.adler=Jr(t.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=ld):(rr(i,0),rr(i,0),rr(i,0),rr(i,0),rr(i,0),rr(i,i.level===9?2:i.strategy>=Vl||i.level<2?4:0),rr(i,Wg),i.status=ka);else{let c=Kl+(i.w_bits-8<<4)<<8,l=-1;i.strategy>=Vl||i.level<2?l=0:i.level<6?l=1:i.level===6?l=2:l=3,c|=l<<6,i.strstart!==0&&(c|=zg),c+=31-c%31,i.status=ka,Gc(i,c),i.strstart!==0&&(Gc(i,t.adler>>>16),Gc(i,t.adler&65535)),t.adler=1}if(i.status===ld)if(i.gzhead.extra){for(r=i.pending;i.gzindex<(i.gzhead.extra.length&65535)&&!(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(t.adler=Jr(t.adler,i.pending_buf,i.pending-r,r)),ea(t),r=i.pending,i.pending===i.pending_buf_size));)rr(i,i.gzhead.extra[i.gzindex]&255),i.gzindex++;i.gzhead.hcrc&&i.pending>r&&(t.adler=Jr(t.adler,i.pending_buf,i.pending-r,r)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=Ql)}else i.status=Ql;if(i.status===Ql)if(i.gzhead.name){r=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(t.adler=Jr(t.adler,i.pending_buf,i.pending-r,r)),ea(t),r=i.pending,i.pending===i.pending_buf_size)){n=1;break}i.gzindex<i.gzhead.name.length?n=i.gzhead.name.charCodeAt(i.gzindex++)&255:n=0,rr(i,n)}while(n!==0);i.gzhead.hcrc&&i.pending>r&&(t.adler=Jr(t.adler,i.pending_buf,i.pending-r,r)),n===0&&(i.gzindex=0,i.status=Yl)}else i.status=Yl;if(i.status===Yl)if(i.gzhead.comment){r=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(t.adler=Jr(t.adler,i.pending_buf,i.pending-r,r)),ea(t),r=i.pending,i.pending===i.pending_buf_size)){n=1;break}i.gzindex<i.gzhead.comment.length?n=i.gzhead.comment.charCodeAt(i.gzindex++)&255:n=0,rr(i,n)}while(n!==0);i.gzhead.hcrc&&i.pending>r&&(t.adler=Jr(t.adler,i.pending_buf,i.pending-r,r)),n===0&&(i.status=Zl)}else i.status=Zl;if(i.status===Zl&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&ea(t),i.pending+2<=i.pending_buf_size&&(rr(i,t.adler&255),rr(i,t.adler>>8&255),t.adler=0,i.status=ka)):i.status=ka),i.pending!==0){if(ea(t),t.avail_out===0)return i.last_flush=-1,Qi}else if(t.avail_in===0&&$h(e)<=$h(o)&&e!==Xo)return Yo(t,sd);if(i.status===zc&&t.avail_in!==0)return Yo(t,sd);if(t.avail_in!==0||i.lookahead!==0||e!==Da&&i.status!==zc){let c=i.strategy===Vl?Xg(i,e):i.strategy===Dg?Kg(i,e):Vc[i.level].func(i,e);if((c===Na||c===$s)&&(i.status=zc),c===Wr||c===Na)return t.avail_out===0&&(i.last_flush=-1),Qi;if(c===Wc&&(e===Ag?Tg(i):e!==Mh&&(xg(i,0,0,!1),e===Rg&&(Zo(i.head),i.lookahead===0&&(i.strstart=0,i.block_start=0,i.insert=0))),ea(t),t.avail_out===0))return i.last_flush=-1,Qi}return e!==Xo?Qi:i.wrap<=0?Lh:(i.wrap===2?(rr(i,t.adler&255),rr(i,t.adler>>8&255),rr(i,t.adler>>16&255),rr(i,t.adler>>24&255),rr(i,t.total_in&255),rr(i,t.total_in>>8&255),rr(i,t.total_in>>16&255),rr(i,t.total_in>>24&255)):(Gc(i,t.adler>>>16),Gc(i,t.adler&65535)),ea(t),i.wrap>0&&(i.wrap=-i.wrap),i.pending!==0?Qi:Lh)},"deflate$2"),tm=a(t=>{if(!t||!t.state)return ui;const e=t.state.status;return e!==Xl&&e!==ld&&e!==Ql&&e!==Yl&&e!==Zl&&e!==ka&&e!==zc?Yo(t,ui):(t.state=null,e===ka?Yo(t,Ig):Qi)},"deflateEnd"),rm=a((t,e)=>{let r=e.length;if(!t||!t.state)return ui;const n=t.state,i=n.wrap;if(i===2||i===1&&n.status!==Xl||n.lookahead)return ui;if(i===1&&(t.adler=qc(t.adler,e,r,0)),n.wrap=0,r>=n.w_size){i===0&&(Zo(n.head),n.strstart=0,n.block_start=0,n.insert=0);let d=new Uint8Array(n.w_size);d.set(e.subarray(r-n.w_size,r),0),e=d,r=n.w_size}const o=t.avail_in,c=t.next_in,l=t.input;for(t.avail_in=r,t.next_in=0,t.input=e,Ma(n);n.lookahead>=Yt;){let d=n.strstart,h=n.lookahead-(Yt-1);do n.ins_h=Jo(n,n.ins_h,n.window[d+Yt-1]),n.prev[d&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=d,d++;while(--h);n.strstart=d,n.lookahead=Yt-1,Ma(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=Yt-1,n.match_available=0,t.next_in=c,t.input=l,t.avail_in=o,n.wrap=i,Qi},"deflateSetDictionary");var nm=Jg,im=Uh,om=Hh,am=Bh,sm=Zg,cm=em,lm=tm,um=rm,dm="pako deflate (from Nodeca project)",Kc={deflateInit:nm,deflateInit2:im,deflateReset:om,deflateResetKeep:am,deflateSetHeader:sm,deflate:cm,deflateEnd:lm,deflateSetDictionary:um,deflateInfo:dm};const hm=a((t,e)=>Object.prototype.hasOwnProperty.call(t,e),"_has");var fm=a(function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const r=e.shift();if(!!r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)hm(r,n)&&(t[n]=r[n])}}return t},"pako_esm_assign"),pm=a(t=>{let e=0;for(let n=0,i=t.length;n<i;n++)e+=t[n].length;const r=new Uint8Array(e);for(let n=0,i=0,o=t.length;n<o;n++){let c=t[n];r.set(c,i),i+=c.length}return r},"flattenChunks"),Jl={assign:fm,flattenChunks:pm};let jh=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){jh=!1}const Xc=new Uint8Array(256);for(let t=0;t<256;t++)Xc[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;Xc[254]=Xc[254]=1;var gm=a(t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,r,n,i,o,c=t.length,l=0;for(i=0;i<c;i++)r=t.charCodeAt(i),(r&64512)==55296&&i+1<c&&(n=t.charCodeAt(i+1),(n&64512)==56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),l+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Uint8Array(l),o=0,i=0;o<l;i++)r=t.charCodeAt(i),(r&64512)==55296&&i+1<c&&(n=t.charCodeAt(i+1),(n&64512)==56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),r<128?e[o++]=r:r<2048?(e[o++]=192|r>>>6,e[o++]=128|r&63):r<65536?(e[o++]=224|r>>>12,e[o++]=128|r>>>6&63,e[o++]=128|r&63):(e[o++]=240|r>>>18,e[o++]=128|r>>>12&63,e[o++]=128|r>>>6&63,e[o++]=128|r&63);return e},"string2buf");const mm=a((t,e)=>{if(e<65534&&t.subarray&&jh)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let r="";for(let n=0;n<e;n++)r+=String.fromCharCode(t[n]);return r},"buf2binstring");var vm=a((t,e)=>{const r=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let n,i;const o=new Array(r*2);for(i=0,n=0;n<r;){let c=t[n++];if(c<128){o[i++]=c;continue}let l=Xc[c];if(l>4){o[i++]=65533,n+=l-1;continue}for(c&=l===2?31:l===3?15:7;l>1&&n<r;)c=c<<6|t[n++]&63,l--;if(l>1){o[i++]=65533;continue}c<65536?o[i++]=c:(c-=65536,o[i++]=55296|c>>10&1023,o[i++]=56320|c&1023)}return mm(o,i)},"buf2string"),ym=a((t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let r=e-1;for(;r>=0&&(t[r]&192)==128;)r--;return r<0||r===0?e:r+Xc[t[r]]>e?r:e},"utf8border"),Qc={string2buf:gm,buf2string:vm,utf8border:ym};function _m(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}a(_m,"ZStream");var qh=_m;const zh=Object.prototype.toString,{Z_NO_FLUSH:wm,Z_SYNC_FLUSH:bm,Z_FULL_FLUSH:Sm,Z_FINISH:Em,Z_OK:eu,Z_STREAM_END:xm,Z_DEFAULT_COMPRESSION:Cm,Z_DEFAULT_STRATEGY:Tm,Z_DEFLATED:Am}=Pa;function Yc(t){this.options=Jl.assign({level:Cm,method:Am,chunkSize:16384,windowBits:15,memLevel:8,strategy:Tm},t||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new qh,this.strm.avail_out=0;let r=Kc.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(r!==eu)throw new Error(Oa[r]);if(e.header&&Kc.deflateSetHeader(this.strm,e.header),e.dictionary){let n;if(typeof e.dictionary=="string"?n=Qc.string2buf(e.dictionary):zh.call(e.dictionary)==="[object ArrayBuffer]"?n=new Uint8Array(e.dictionary):n=e.dictionary,r=Kc.deflateSetDictionary(this.strm,n),r!==eu)throw new Error(Oa[r]);this._dict_set=!0}}a(Yc,"Deflate$1"),Yc.prototype.push=function(t,e){const r=this.strm,n=this.options.chunkSize;let i,o;if(this.ended)return!1;for(e===~~e?o=e:o=e===!0?Em:wm,typeof t=="string"?r.input=Qc.string2buf(t):zh.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){if(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),(o===bm||o===Sm)&&r.avail_out<=6){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(i=Kc.deflate(r,o),i===xm)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),i=Kc.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===eu;if(r.avail_out===0){this.onData(r.output);continue}if(o>0&&r.next_out>0){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(r.avail_in===0)break}return!0},Yc.prototype.onData=function(t){this.chunks.push(t)},Yc.prototype.onEnd=function(t){t===eu&&(this.result=Jl.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function dd(t,e){const r=new Yc(e);if(r.push(t,!0),r.err)throw r.msg||Oa[r.err];return r.result}a(dd,"deflate$1");function Rm(t,e){return e=e||{},e.raw=!0,dd(t,e)}a(Rm,"deflateRaw$1");function Im(t,e){return e=e||{},e.gzip=!0,dd(t,e)}a(Im,"gzip$1");var Om=Yc,Pm=dd,Dm=Rm,km=Im,Nm=Pa,Mm={Deflate:Om,deflate:Pm,deflateRaw:Dm,gzip:km,constants:Nm};const tu=30,Lm=12;var $m=a(function(e,r){let n,i,o,c,l,d,h,S,O,I,P,$,N,U,W,V,ie,oe,ge,ke,Ie,Oe,Ze,$e;const ze=e.state;n=e.next_in,Ze=e.input,i=n+(e.avail_in-5),o=e.next_out,$e=e.output,c=o-(r-e.avail_out),l=o+(e.avail_out-257),d=ze.dmax,h=ze.wsize,S=ze.whave,O=ze.wnext,I=ze.window,P=ze.hold,$=ze.bits,N=ze.lencode,U=ze.distcode,W=(1<<ze.lenbits)-1,V=(1<<ze.distbits)-1;e:do{$<15&&(P+=Ze[n++]<<$,$+=8,P+=Ze[n++]<<$,$+=8),ie=N[P&W];t:for(;;){if(oe=ie>>>24,P>>>=oe,$-=oe,oe=ie>>>16&255,oe===0)$e[o++]=ie&65535;else if(oe&16){ge=ie&65535,oe&=15,oe&&($<oe&&(P+=Ze[n++]<<$,$+=8),ge+=P&(1<<oe)-1,P>>>=oe,$-=oe),$<15&&(P+=Ze[n++]<<$,$+=8,P+=Ze[n++]<<$,$+=8),ie=U[P&V];r:for(;;){if(oe=ie>>>24,P>>>=oe,$-=oe,oe=ie>>>16&255,oe&16){if(ke=ie&65535,oe&=15,$<oe&&(P+=Ze[n++]<<$,$+=8,$<oe&&(P+=Ze[n++]<<$,$+=8)),ke+=P&(1<<oe)-1,ke>d){e.msg="invalid distance too far back",ze.mode=tu;break e}if(P>>>=oe,$-=oe,oe=o-c,ke>oe){if(oe=ke-oe,oe>S&&ze.sane){e.msg="invalid distance too far back",ze.mode=tu;break e}if(Ie=0,Oe=I,O===0){if(Ie+=h-oe,oe<ge){ge-=oe;do $e[o++]=I[Ie++];while(--oe);Ie=o-ke,Oe=$e}}else if(O<oe){if(Ie+=h+O-oe,oe-=O,oe<ge){ge-=oe;do $e[o++]=I[Ie++];while(--oe);if(Ie=0,O<ge){oe=O,ge-=oe;do $e[o++]=I[Ie++];while(--oe);Ie=o-ke,Oe=$e}}}else if(Ie+=O-oe,oe<ge){ge-=oe;do $e[o++]=I[Ie++];while(--oe);Ie=o-ke,Oe=$e}for(;ge>2;)$e[o++]=Oe[Ie++],$e[o++]=Oe[Ie++],$e[o++]=Oe[Ie++],ge-=3;ge&&($e[o++]=Oe[Ie++],ge>1&&($e[o++]=Oe[Ie++]))}else{Ie=o-ke;do $e[o++]=$e[Ie++],$e[o++]=$e[Ie++],$e[o++]=$e[Ie++],ge-=3;while(ge>2);ge&&($e[o++]=$e[Ie++],ge>1&&($e[o++]=$e[Ie++]))}}else if((oe&64)==0){ie=U[(ie&65535)+(P&(1<<oe)-1)];continue r}else{e.msg="invalid distance code",ze.mode=tu;break e}break}}else if((oe&64)==0){ie=N[(ie&65535)+(P&(1<<oe)-1)];continue t}else if(oe&32){ze.mode=Lm;break e}else{e.msg="invalid literal/length code",ze.mode=tu;break e}break}}while(n<i&&o<l);ge=$>>3,n-=ge,$-=ge<<3,P&=(1<<$)-1,e.next_in=n,e.next_out=o,e.avail_in=n<i?5+(i-n):5-(n-i),e.avail_out=o<l?257+(l-o):257-(o-l),ze.hold=P,ze.bits=$},"inflate_fast");const Bs=15,Wh=852,Gh=592,Vh=0,hd=1,Kh=2,Fm=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Bm=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Hm=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Um=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Zc=a((t,e,r,n,i,o,c,l)=>{const d=l.bits;let h=0,S=0,O=0,I=0,P=0,$=0,N=0,U=0,W=0,V=0,ie,oe,ge,ke,Ie,Oe=null,Ze=0,$e;const ze=new Uint16Array(Bs+1),st=new Uint16Array(Bs+1);let Mt=null,tn=0,Mn,Vn,ki;for(h=0;h<=Bs;h++)ze[h]=0;for(S=0;S<n;S++)ze[e[r+S]]++;for(P=d,I=Bs;I>=1&&ze[I]===0;I--);if(P>I&&(P=I),I===0)return i[o++]=1<<24|64<<16|0,i[o++]=1<<24|64<<16|0,l.bits=1,0;for(O=1;O<I&&ze[O]===0;O++);for(P<O&&(P=O),U=1,h=1;h<=Bs;h++)if(U<<=1,U-=ze[h],U<0)return-1;if(U>0&&(t===Vh||I!==1))return-1;for(st[1]=0,h=1;h<Bs;h++)st[h+1]=st[h]+ze[h];for(S=0;S<n;S++)e[r+S]!==0&&(c[st[e[r+S]]++]=S);if(t===Vh?(Oe=Mt=c,$e=19):t===hd?(Oe=Fm,Ze-=257,Mt=Bm,tn-=257,$e=256):(Oe=Hm,Mt=Um,$e=-1),V=0,S=0,h=O,Ie=o,$=P,N=0,ge=-1,W=1<<P,ke=W-1,t===hd&&W>Wh||t===Kh&&W>Gh)return 1;for(;;){Mn=h-N,c[S]<$e?(Vn=0,ki=c[S]):c[S]>$e?(Vn=Mt[tn+c[S]],ki=Oe[Ze+c[S]]):(Vn=32+64,ki=0),ie=1<<h-N,oe=1<<$,O=oe;do oe-=ie,i[Ie+(V>>N)+oe]=Mn<<24|Vn<<16|ki|0;while(oe!==0);for(ie=1<<h-1;V&ie;)ie>>=1;if(ie!==0?(V&=ie-1,V+=ie):V=0,S++,--ze[h]==0){if(h===I)break;h=e[r+c[S]]}if(h>P&&(V&ke)!==ge){for(N===0&&(N=P),Ie+=O,$=h-N,U=1<<$;$+N<I&&(U-=ze[$+N],!(U<=0));)$++,U<<=1;if(W+=1<<$,t===hd&&W>Wh||t===Kh&&W>Gh)return 1;ge=V&ke,i[ge]=P<<24|$<<16|Ie-o|0}}return V!==0&&(i[Ie+V]=h-N<<24|64<<16|0),l.bits=P,0},"inflate_table");const jm=0,Xh=1,Qh=2,{Z_FINISH:Yh,Z_BLOCK:qm,Z_TREES:ru,Z_OK:La,Z_STREAM_END:zm,Z_NEED_DICT:Wm,Z_STREAM_ERROR:di,Z_DATA_ERROR:Zh,Z_MEM_ERROR:Jh,Z_BUF_ERROR:Gm,Z_DEFLATED:ef}=Pa,tf=1,rf=2,nf=3,of=4,af=5,sf=6,cf=7,lf=8,uf=9,df=10,nu=11,go=12,fd=13,hf=14,pd=15,ff=16,pf=17,gf=18,mf=19,iu=20,ou=21,vf=22,yf=23,_f=24,wf=25,bf=26,gd=27,Sf=28,Ef=29,Tr=30,xf=31,Vm=32,Km=852,Xm=592,Qm=15,Cf=a(t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24),"zswap32");function Ym(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}a(Ym,"InflateState");const Tf=a(t=>{if(!t||!t.state)return di;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=tf,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(Km),e.distcode=e.distdyn=new Int32Array(Xm),e.sane=1,e.back=-1,La},"inflateResetKeep"),Af=a(t=>{if(!t||!t.state)return di;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,Tf(t)},"inflateReset"),Rf=a((t,e)=>{let r;if(!t||!t.state)return di;const n=t.state;return e<0?(r=0,e=-e):(r=(e>>4)+1,e<48&&(e&=15)),e&&(e<8||e>15)?di:(n.window!==null&&n.wbits!==e&&(n.window=null),n.wrap=r,n.wbits=e,Af(t))},"inflateReset2"),If=a((t,e)=>{if(!t)return di;const r=new Ym;t.state=r,r.window=null;const n=Rf(t,e);return n!==La&&(t.state=null),n},"inflateInit2"),Zm=a(t=>If(t,Qm),"inflateInit");let Of=!0,md,vd;const Jm=a(t=>{if(Of){md=new Int32Array(512),vd=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(Zc(Xh,t.lens,0,288,md,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;Zc(Qh,t.lens,0,32,vd,0,t.work,{bits:5}),Of=!1}t.lencode=md,t.lenbits=9,t.distcode=vd,t.distbits=5},"fixedtables"),Pf=a((t,e,r,n)=>{let i;const o=t.state;return o.window===null&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),n>=o.wsize?(o.window.set(e.subarray(r-o.wsize,r),0),o.wnext=0,o.whave=o.wsize):(i=o.wsize-o.wnext,i>n&&(i=n),o.window.set(e.subarray(r-n,r-n+i),o.wnext),n-=i,n?(o.window.set(e.subarray(r-n,r),0),o.wnext=n,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0},"updatewindow"),ev=a((t,e)=>{let r,n,i,o,c,l,d,h,S,O,I,P,$,N,U=0,W,V,ie,oe,ge,ke,Ie,Oe;const Ze=new Uint8Array(4);let $e,ze;const st=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!t||!t.state||!t.output||!t.input&&t.avail_in!==0)return di;r=t.state,r.mode===go&&(r.mode=fd),c=t.next_out,i=t.output,d=t.avail_out,o=t.next_in,n=t.input,l=t.avail_in,h=r.hold,S=r.bits,O=l,I=d,Oe=La;e:for(;;)switch(r.mode){case tf:if(r.wrap===0){r.mode=fd;break}for(;S<16;){if(l===0)break e;l--,h+=n[o++]<<S,S+=8}if(r.wrap&2&&h===35615){r.check=0,Ze[0]=h&255,Ze[1]=h>>>8&255,r.check=Jr(r.check,Ze,2,0),h=0,S=0,r.mode=rf;break}if(r.flags=0,r.head&&(r.head.done=!1),!(r.wrap&1)||(((h&255)<<8)+(h>>8))%31){t.msg="incorrect header check",r.mode=Tr;break}if((h&15)!==ef){t.msg="unknown compression method",r.mode=Tr;break}if(h>>>=4,S-=4,Ie=(h&15)+8,r.wbits===0)r.wbits=Ie;else if(Ie>r.wbits){t.msg="invalid window size",r.mode=Tr;break}r.dmax=1<<r.wbits,t.adler=r.check=1,r.mode=h&512?df:go,h=0,S=0;break;case rf:for(;S<16;){if(l===0)break e;l--,h+=n[o++]<<S,S+=8}if(r.flags=h,(r.flags&255)!==ef){t.msg="unknown compression method",r.mode=Tr;break}if(r.flags&57344){t.msg="unknown header flags set",r.mode=Tr;break}r.head&&(r.head.text=h>>8&1),r.flags&512&&(Ze[0]=h&255,Ze[1]=h>>>8&255,r.check=Jr(r.check,Ze,2,0)),h=0,S=0,r.mode=nf;case nf:for(;S<32;){if(l===0)break e;l--,h+=n[o++]<<S,S+=8}r.head&&(r.head.time=h),r.flags&512&&(Ze[0]=h&255,Ze[1]=h>>>8&255,Ze[2]=h>>>16&255,Ze[3]=h>>>24&255,r.check=Jr(r.check,Ze,4,0)),h=0,S=0,r.mode=of;case of:for(;S<16;){if(l===0)break e;l--,h+=n[o++]<<S,S+=8}r.head&&(r.head.xflags=h&255,r.head.os=h>>8),r.flags&512&&(Ze[0]=h&255,Ze[1]=h>>>8&255,r.check=Jr(r.check,Ze,2,0)),h=0,S=0,r.mode=af;case af:if(r.flags&1024){for(;S<16;){if(l===0)break e;l--,h+=n[o++]<<S,S+=8}r.length=h,r.head&&(r.head.extra_len=h),r.flags&512&&(Ze[0]=h&255,Ze[1]=h>>>8&255,r.check=Jr(r.check,Ze,2,0)),h=0,S=0}else r.head&&(r.head.extra=null);r.mode=sf;case sf:if(r.flags&1024&&(P=r.length,P>l&&(P=l),P&&(r.head&&(Ie=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(o,o+P),Ie)),r.flags&512&&(r.check=Jr(r.check,n,P,o)),l-=P,o+=P,r.length-=P),r.length))break e;r.length=0,r.mode=cf;case cf:if(r.flags&2048){if(l===0)break e;P=0;do Ie=n[o+P++],r.head&&Ie&&r.length<65536&&(r.head.name+=String.fromCharCode(Ie));while(Ie&&P<l);if(r.flags&512&&(r.check=Jr(r.check,n,P,o)),l-=P,o+=P,Ie)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=lf;case lf:if(r.flags&4096){if(l===0)break e;P=0;do Ie=n[o+P++],r.head&&Ie&&r.length<65536&&(r.head.comment+=String.fromCharCode(Ie));while(Ie&&P<l);if(r.flags&512&&(r.check=Jr(r.check,n,P,o)),l-=P,o+=P,Ie)break e}else r.head&&(r.head.comment=null);r.mode=uf;case uf:if(r.flags&512){for(;S<16;){if(l===0)break e;l--,h+=n[o++]<<S,S+=8}if(h!==(r.check&65535)){t.msg="header crc mismatch",r.mode=Tr;break}h=0,S=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=go;break;case df:for(;S<32;){if(l===0)break e;l--,h+=n[o++]<<S,S+=8}t.adler=r.check=Cf(h),h=0,S=0,r.mode=nu;case nu:if(r.havedict===0)return t.next_out=c,t.avail_out=d,t.next_in=o,t.avail_in=l,r.hold=h,r.bits=S,Wm;t.adler=r.check=1,r.mode=go;case go:if(e===qm||e===ru)break e;case fd:if(r.last){h>>>=S&7,S-=S&7,r.mode=gd;break}for(;S<3;){if(l===0)break e;l--,h+=n[o++]<<S,S+=8}switch(r.last=h&1,h>>>=1,S-=1,h&3){case 0:r.mode=hf;break;case 1:if(Jm(r),r.mode=iu,e===ru){h>>>=2,S-=2;break e}break;case 2:r.mode=pf;break;case 3:t.msg="invalid block type",r.mode=Tr}h>>>=2,S-=2;break;case hf:for(h>>>=S&7,S-=S&7;S<32;){if(l===0)break e;l--,h+=n[o++]<<S,S+=8}if((h&65535)!=(h>>>16^65535)){t.msg="invalid stored block lengths",r.mode=Tr;break}if(r.length=h&65535,h=0,S=0,r.mode=pd,e===ru)break e;case pd:r.mode=ff;case ff:if(P=r.length,P){if(P>l&&(P=l),P>d&&(P=d),P===0)break e;i.set(n.subarray(o,o+P),c),l-=P,o+=P,d-=P,c+=P,r.length-=P;break}r.mode=go;break;case pf:for(;S<14;){if(l===0)break e;l--,h+=n[o++]<<S,S+=8}if(r.nlen=(h&31)+257,h>>>=5,S-=5,r.ndist=(h&31)+1,h>>>=5,S-=5,r.ncode=(h&15)+4,h>>>=4,S-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=Tr;break}r.have=0,r.mode=gf;case gf:for(;r.have<r.ncode;){for(;S<3;){if(l===0)break e;l--,h+=n[o++]<<S,S+=8}r.lens[st[r.have++]]=h&7,h>>>=3,S-=3}for(;r.have<19;)r.lens[st[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,$e={bits:r.lenbits},Oe=Zc(jm,r.lens,0,19,r.lencode,0,r.work,$e),r.lenbits=$e.bits,Oe){t.msg="invalid code lengths set",r.mode=Tr;break}r.have=0,r.mode=mf;case mf:for(;r.have<r.nlen+r.ndist;){for(;U=r.lencode[h&(1<<r.lenbits)-1],W=U>>>24,V=U>>>16&255,ie=U&65535,!(W<=S);){if(l===0)break e;l--,h+=n[o++]<<S,S+=8}if(ie<16)h>>>=W,S-=W,r.lens[r.have++]=ie;else{if(ie===16){for(ze=W+2;S<ze;){if(l===0)break e;l--,h+=n[o++]<<S,S+=8}if(h>>>=W,S-=W,r.have===0){t.msg="invalid bit length repeat",r.mode=Tr;break}Ie=r.lens[r.have-1],P=3+(h&3),h>>>=2,S-=2}else if(ie===17){for(ze=W+3;S<ze;){if(l===0)break e;l--,h+=n[o++]<<S,S+=8}h>>>=W,S-=W,Ie=0,P=3+(h&7),h>>>=3,S-=3}else{for(ze=W+7;S<ze;){if(l===0)break e;l--,h+=n[o++]<<S,S+=8}h>>>=W,S-=W,Ie=0,P=11+(h&127),h>>>=7,S-=7}if(r.have+P>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=Tr;break}for(;P--;)r.lens[r.have++]=Ie}}if(r.mode===Tr)break;if(r.lens[256]===0){t.msg="invalid code -- missing end-of-block",r.mode=Tr;break}if(r.lenbits=9,$e={bits:r.lenbits},Oe=Zc(Xh,r.lens,0,r.nlen,r.lencode,0,r.work,$e),r.lenbits=$e.bits,Oe){t.msg="invalid literal/lengths set",r.mode=Tr;break}if(r.distbits=6,r.distcode=r.distdyn,$e={bits:r.distbits},Oe=Zc(Qh,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,$e),r.distbits=$e.bits,Oe){t.msg="invalid distances set",r.mode=Tr;break}if(r.mode=iu,e===ru)break e;case iu:r.mode=ou;case ou:if(l>=6&&d>=258){t.next_out=c,t.avail_out=d,t.next_in=o,t.avail_in=l,r.hold=h,r.bits=S,$m(t,I),c=t.next_out,i=t.output,d=t.avail_out,o=t.next_in,n=t.input,l=t.avail_in,h=r.hold,S=r.bits,r.mode===go&&(r.back=-1);break}for(r.back=0;U=r.lencode[h&(1<<r.lenbits)-1],W=U>>>24,V=U>>>16&255,ie=U&65535,!(W<=S);){if(l===0)break e;l--,h+=n[o++]<<S,S+=8}if(V&&(V&240)==0){for(oe=W,ge=V,ke=ie;U=r.lencode[ke+((h&(1<<oe+ge)-1)>>oe)],W=U>>>24,V=U>>>16&255,ie=U&65535,!(oe+W<=S);){if(l===0)break e;l--,h+=n[o++]<<S,S+=8}h>>>=oe,S-=oe,r.back+=oe}if(h>>>=W,S-=W,r.back+=W,r.length=ie,V===0){r.mode=bf;break}if(V&32){r.back=-1,r.mode=go;break}if(V&64){t.msg="invalid literal/length code",r.mode=Tr;break}r.extra=V&15,r.mode=vf;case vf:if(r.extra){for(ze=r.extra;S<ze;){if(l===0)break e;l--,h+=n[o++]<<S,S+=8}r.length+=h&(1<<r.extra)-1,h>>>=r.extra,S-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=yf;case yf:for(;U=r.distcode[h&(1<<r.distbits)-1],W=U>>>24,V=U>>>16&255,ie=U&65535,!(W<=S);){if(l===0)break e;l--,h+=n[o++]<<S,S+=8}if((V&240)==0){for(oe=W,ge=V,ke=ie;U=r.distcode[ke+((h&(1<<oe+ge)-1)>>oe)],W=U>>>24,V=U>>>16&255,ie=U&65535,!(oe+W<=S);){if(l===0)break e;l--,h+=n[o++]<<S,S+=8}h>>>=oe,S-=oe,r.back+=oe}if(h>>>=W,S-=W,r.back+=W,V&64){t.msg="invalid distance code",r.mode=Tr;break}r.offset=ie,r.extra=V&15,r.mode=_f;case _f:if(r.extra){for(ze=r.extra;S<ze;){if(l===0)break e;l--,h+=n[o++]<<S,S+=8}r.offset+=h&(1<<r.extra)-1,h>>>=r.extra,S-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=Tr;break}r.mode=wf;case wf:if(d===0)break e;if(P=I-d,r.offset>P){if(P=r.offset-P,P>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=Tr;break}P>r.wnext?(P-=r.wnext,$=r.wsize-P):$=r.wnext-P,P>r.length&&(P=r.length),N=r.window}else N=i,$=c-r.offset,P=r.length;P>d&&(P=d),d-=P,r.length-=P;do i[c++]=N[$++];while(--P);r.length===0&&(r.mode=ou);break;case bf:if(d===0)break e;i[c++]=r.length,d--,r.mode=ou;break;case gd:if(r.wrap){for(;S<32;){if(l===0)break e;l--,h|=n[o++]<<S,S+=8}if(I-=d,t.total_out+=I,r.total+=I,I&&(t.adler=r.check=r.flags?Jr(r.check,i,I,c-I):qc(r.check,i,I,c-I)),I=d,(r.flags?h:Cf(h))!==r.check){t.msg="incorrect data check",r.mode=Tr;break}h=0,S=0}r.mode=Sf;case Sf:if(r.wrap&&r.flags){for(;S<32;){if(l===0)break e;l--,h+=n[o++]<<S,S+=8}if(h!==(r.total&4294967295)){t.msg="incorrect length check",r.mode=Tr;break}h=0,S=0}r.mode=Ef;case Ef:Oe=zm;break e;case Tr:Oe=Zh;break e;case xf:return Jh;case Vm:default:return di}return t.next_out=c,t.avail_out=d,t.next_in=o,t.avail_in=l,r.hold=h,r.bits=S,(r.wsize||I!==t.avail_out&&r.mode<Tr&&(r.mode<gd||e!==Yh))&&Pf(t,t.output,t.next_out,I-t.avail_out),O-=t.avail_in,I-=t.avail_out,t.total_in+=O,t.total_out+=I,r.total+=I,r.wrap&&I&&(t.adler=r.check=r.flags?Jr(r.check,i,I,t.next_out-I):qc(r.check,i,I,t.next_out-I)),t.data_type=r.bits+(r.last?64:0)+(r.mode===go?128:0)+(r.mode===iu||r.mode===pd?256:0),(O===0&&I===0||e===Yh)&&Oe===La&&(Oe=Gm),Oe},"inflate$2"),tv=a(t=>{if(!t||!t.state)return di;let e=t.state;return e.window&&(e.window=null),t.state=null,La},"inflateEnd"),rv=a((t,e)=>{if(!t||!t.state)return di;const r=t.state;return(r.wrap&2)==0?di:(r.head=e,e.done=!1,La)},"inflateGetHeader"),nv=a((t,e)=>{const r=e.length;let n,i,o;return!t||!t.state||(n=t.state,n.wrap!==0&&n.mode!==nu)?di:n.mode===nu&&(i=1,i=qc(i,e,r,0),i!==n.check)?Zh:(o=Pf(t,e,r,r),o?(n.mode=xf,Jh):(n.havedict=1,La))},"inflateSetDictionary");var iv=Af,ov=Rf,av=Tf,sv=Zm,cv=If,lv=ev,uv=tv,dv=rv,hv=nv,fv="pako inflate (from Nodeca project)",mo={inflateReset:iv,inflateReset2:ov,inflateResetKeep:av,inflateInit:sv,inflateInit2:cv,inflate:lv,inflateEnd:uv,inflateGetHeader:dv,inflateSetDictionary:hv,inflateInfo:fv};function pv(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}a(pv,"GZheader");var gv=pv;const Df=Object.prototype.toString,{Z_NO_FLUSH:mv,Z_FINISH:vv,Z_OK:Jc,Z_STREAM_END:yd,Z_NEED_DICT:_d,Z_STREAM_ERROR:yv,Z_DATA_ERROR:kf,Z_MEM_ERROR:_v}=Pa;function el(t){this.options=Jl.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)==0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new qh,this.strm.avail_out=0;let r=mo.inflateInit2(this.strm,e.windowBits);if(r!==Jc)throw new Error(Oa[r]);if(this.header=new gv,mo.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=Qc.string2buf(e.dictionary):Df.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=mo.inflateSetDictionary(this.strm,e.dictionary),r!==Jc)))throw new Error(Oa[r])}a(el,"Inflate$1"),el.prototype.push=function(t,e){const r=this.strm,n=this.options.chunkSize,i=this.options.dictionary;let o,c,l;if(this.ended)return!1;for(e===~~e?c=e:c=e===!0?vv:mv,Df.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),o=mo.inflate(r,c),o===_d&&i&&(o=mo.inflateSetDictionary(r,i),o===Jc?o=mo.inflate(r,c):o===kf&&(o=_d));r.avail_in>0&&o===yd&&r.state.wrap>0&&t[r.next_in]!==0;)mo.inflateReset(r),o=mo.inflate(r,c);switch(o){case yv:case kf:case _d:case _v:return this.onEnd(o),this.ended=!0,!1}if(l=r.avail_out,r.next_out&&(r.avail_out===0||o===yd))if(this.options.to==="string"){let d=Qc.utf8border(r.output,r.next_out),h=r.next_out-d,S=Qc.buf2string(r.output,d);r.next_out=h,r.avail_out=n-h,h&&r.output.set(r.output.subarray(d,d+h),0),this.onData(S)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(o===Jc&&l===0)){if(o===yd)return o=mo.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(r.avail_in===0)break}}return!0},el.prototype.onData=function(t){this.chunks.push(t)},el.prototype.onEnd=function(t){t===Jc&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Jl.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function wd(t,e){const r=new el(e);if(r.push(t),r.err)throw r.msg||Oa[r.err];return r.result}a(wd,"inflate$1");function wv(t,e){return e=e||{},e.raw=!0,wd(t,e)}a(wv,"inflateRaw$1");var bv=el,Sv=wd,Ev=wv,xv=wd,Cv=Pa,Tv={Inflate:bv,inflate:Sv,inflateRaw:Ev,ungzip:xv,constants:Cv};const{Deflate:Av,deflate:Rv,deflateRaw:Iv,gzip:Ov}=Mm,{Inflate:Pv,inflate:Dv,inflateRaw:kv,ungzip:Nv}=Tv;var Mv=Av,Lv=Rv,$v=Iv,Fv=Ov,Bv=Pv,Hv=Dv,Uv=kv,Nf=Nv,jv=Pa,Ny={Deflate:Mv,deflate:Lv,deflateRaw:$v,gzip:Fv,Inflate:Bv,inflate:Hv,inflateRaw:Uv,ungzip:Nf,constants:jv};const $a=(0,B.loadMessageBundle)(),au=new TextDecoder,su=new TextEncoder;class Mf{constructor(e,r=0){this.retainFor=r;try{this.weakRef=new WeakRef(e)}catch{}this.retain(e)}retain(e){this.retainTimeout&&clearTimeout(this.retainTimeout),this.strongRef=e,this.retainTimeout=setTimeout(()=>{this.strongRef=void 0,this.retainTimeout=void 0},this.retainFor)}deref(){var e,r;const n=(r=this.strongRef)!=null?r:(e=this.weakRef)==null?void 0:e.deref();return n&&this.retain(n),n}}a(Mf,"TimedRetainingRef");class Lf{constructor(e,r){this.root=e,this.providerService=r,this._onDidChangeIndexingEnablement=new m.EventEmitter,this._onDidDownloadTar=new m.EventEmitter,this.ongoingRequests=new Map,this.indexingDisabled=!1,this.usageFile=m.Uri.joinPath(this.root,"usageHistory.json"),this.indexingAllowanceFile=m.Uri.joinPath(this.root,"indexAllowances.json"),this._disposable=m.Disposable.from(...this.registerCommands()),this.updateContext()}get onDidChangeIndexingEnablement(){return this._onDidChangeIndexingEnablement.event}get onDidDownloadTar(){return this._onDidDownloadTar.event}async updateContext(){await Si(Pn.HasSearchIndexes,(await this.listTars()).length>0);const e=this.providerService.repositories.map(i=>i.name),r=await this.getIndexingEnabledRepos(),n=r.has("*")||e.every(i=>r.has(i));await Si(Pn.EnabledSomeSearchIndexes,r.size>0),await Si(Pn.EnabledAllSearchIndexes,n)}dispose(){this._disposable.dispose()}registerCommands(){return[m.commands.registerCommand("remoteHub.configureIndexingAllowedRepos",async()=>{await this.configureIndexingAllowedRepos()}),m.commands.registerCommand("remoteHub.disableIndexingForSession",()=>(this.temporarilyDisableIndexing(),{triggerSearch:!0})),m.commands.registerCommand("remoteHub.enableIndexing",async()=>{const e={title:$a("search download prompt enable","Enable")},r={title:$a("search download prompt enable always","Always Enable")},n={title:$a("search download prompt configure","Configure")},i={title:$a("search download prompt cancel","Cancel"),isCloseAffordance:!0},o=await m.window.showInformationMessage($a("search download prompt",`Indexing creates a copy of this repository in your browser's storage in order to provide enhanced text searches.

Without indexing, searches will use GitHub's text search, which is imprecise.

Do you want to enable creating local indexes for this repository on this browser? You should only enable indexing on machines you trust.`),{modal:!0,useCustom:!0},e,r,n,i);if(o===n&&await m.commands.executeCommand("workbench.action.openSettings","remoteHub.search.download"),o===e)return await this.markIndexingEnabledForRepos(...this.providerService.repositories.map(c=>c.name)),{triggerSearch:!0};if(o===r)return await this.markIndexingEnabledForRepos("*"),{triggerSearch:!0}}),m.commands.registerCommand("remoteHub.deleteLocalRepositoryData",async()=>{const e=a(i=>{const o=[{power:9,name:"GB"},{power:6,name:"MB"},{power:3,name:"kB"},{power:0,name:"B"}];for(const c of o)if(i>10**c.power)return`${Math.round(i/10**c.power)} ${c.name}`;return"Unknown size"},"humanReadableSize"),r=await this.listTars();if(r.length===0){await m.window.showInformationMessage("No Search Indexes Found");return}const n=m.window.createQuickPick();n.canSelectMany=!0,n.items=r.map(({name:i,size:o,path:c})=>({label:i,path:c,description:o?e(o):void 0})),n.show(),n.onDidAccept(async()=>{n.hide();for(const{label:i,path:o}of n.selectedItems){const c=m.workspace.fs.delete(o),l=m.window.setStatusBarMessage(`$(loading) Deleting ${i}`,c);await c,l.dispose()}this.updateContext()}),n.onDidHide(()=>n.dispose())}),m.commands.registerCommand("remoteHub.deleteAllLocalRepositoryData",()=>m.window.withProgress({location:m.ProgressLocation.Notification,title:"Deleting Search Indexes..."},async()=>{this.lastReadKey=void 0,this.lastReadValue=void 0,await Promise.all([m.workspace.fs.delete(this.root,{recursive:!0})]),this.updateContext()}))]}getTarFromMemory(e){var r;if(e===this.lastReadKey){const n=(r=this.lastReadValue)==null?void 0:r.deref();if(n)return n;L.log("Weakref deallocated.")}}async getTarFromDisk(e){try{const r=await m.workspace.fs.readFile(e);return!r||!r.length?void 0:r}catch(r){if(!(r instanceof m.FileSystemError)||r.code!==m.FileSystemError.FileNotFound.name)throw r;return}}async getTarFromNetwork(e){try{if(!await this.isIndexingEnabledForRepo(e))throw Error("Unable to search without indexing allowed");const r=await this.providerService.getTarGz(e);if(r===void 0)throw Error("Unable to retrieve search index from provider");return r}finally{this.updateContext()}}async getTar(e,r){r===void 0&&({HEAD:{sha:r}}=await this.providerService.getMetadata(e)),e=this.providerService.getCanonicalUri(e);const n=this.getTarStorageUri(e,r),i=n.toString();try{let o=this.ongoingRequests.get(i);return o===void 0&&(o=this.getTarCore(e,r,n),this.ongoingRequests.set(i,o)),await o}finally{this.ongoingRequests.delete(i)}}async getCachedTar(e,r){return e=this.providerService.getCanonicalUri(e),this.getTarCore(e,r,this.getTarStorageUri(e,r),{skipDownload:!0})}async getTarCore(e,r,n,i){var o;const c=`${le(e,{excludeScheme:!0})}/${r}`,l=new ut(`TarPit.getTar(${c})`),d=n.toString(),h=Date.now();let S,O;try{if(l.logStep("Getting .tar from memory",{suffix:" \u2022 Getting .tar from memory..."}),O=this.getTarFromMemory(d),O)return S=" \u2022 Got .tar from memory",O;l.logStep("Getting .tar from disk",{message:": Not found \u2022",suffix:" \u2022 Getting .tar from disk..."});let I=!1,P=await this.getTarFromDisk(n);if(P==null?void 0:P.length)S=" \u2022 Got .tar from disk";else{if(i==null?void 0:i.skipDownload){S=" \u2022 Skipped download";return}l.logStep("Getting .tar from network",{message:": Not found \u2022",suffix:" \u2022 Getting .tar from network..."}),P=await this.getTarFromNetwork(e),I=!0,S=" \u2022 Got .tar from network",m.workspace.fs.writeFile(n,P).then(()=>L.debug(`Sucessfully wrote tarball to disk in ${Date.now()-h}ms`),U=>L.error(U,`Error writing tarball to disk in ${Date.now()-h}ms`))}if(!(P==null?void 0:P.length))throw new Error("Internal Error: Invalid search index. Try deleting repository data and running search again: `GitHub Repositories: Delete Local Repository Data...`");l.logStep("Unzipping .tar",{suffix:" \u2022 Unzipping .tar..."});const $=Nf(P);l.logStep("Parsing .tar",{suffix:" \u2022 Parsing .tar..."}),O=(0,Kp.t9)($),l.logStep("Fixing up .tar entries",{suffix:" \u2022 Fixing up .tar entries..."});const N=[];for(const U of O.entries)((o=U.header.typeFlag)==null?void 0:o.name)==="Normal"&&(U.header.fullFileName=U.header.fullFileName.replace(/^[^/]+\/?/,""),N.push(U));return O.entries=N,this.lastReadValue=new Mf(O,Date.now()-h),this.lastReadKey=d,I&&setTimeout(()=>this._onDidDownloadTar.fire({rootUri:e,sha:r}),0),O}catch(I){throw S=` \u2022 Failed; ${String(I)}`,I}finally{O&&(this.markCacheEntryUsed(`${c}`).catch(I=>L.log(`Error marking entry used: ${I}`)),this.cleanUpCache().catch(I=>L.log(`Error cleaning cache: ${I}`))),l.stop(S?{suffix:S}:void 0)}}getTarStorageUri(e,r){return m.Uri.joinPath(this.root,"tars",le(e,{excludeScheme:!0}),r)}async readDir(e){try{return(await m.workspace.fs.readDirectory(e)).map(r=>m.Uri.joinPath(e,r[0]))}catch{return[]}}temporarilyDisableIndexing(){this.indexingDisabled=!0}async isIndexingEnabledForRepo(e){if(this.indexingDisabled)return!1;const r=await this.getIndexingEnabledRepos();if(r.has("*"))return!0;const{name:n}=this.providerService.getVirtualUriMetadata(e);return n?r.has(n):!1}async configureIndexingAllowedRepos(){const e=[...(await this.getIndexingEnabledRepos()).values()],r=await m.window.showQuickPick(e.map(n=>({picked:!0,description:n==="*"?$a("all","All Repositories"):"",label:n})),{canPickMany:!0,title:$a("select repos where indexing is allowed","Select repositories that should be indexed")});r&&await this.resetIndexingAllowedRepos(r.map(n=>n.label))}async getIndexingEnabledRepos(){let e;try{e=JSON.parse(au.decode(await m.workspace.fs.readFile(this.indexingAllowanceFile)))}catch(r){r instanceof m.FileSystemError&&r.code!==m.FileSystemError.FileNotFound().code&&L.error(r,"Error reading index allowance data."),e=[]}return new Set(e)}async listTars(){const e=await this.readDir(m.Uri.joinPath(this.root,"tars")).catch(()=>[]),r=(await Promise.all(e.map(o=>this.readDir(o)))).flat(),n=(await Promise.all(r.map(o=>this.readDir(o)))).flat(),i=(await Promise.all(n.map(o=>this.readDir(o)))).flat();return Promise.all(i.map(async o=>({name:o.path.replace(/^.*\/tars\//,""),path:o,size:(await m.workspace.fs.stat(o)).size})))}async resetIndexingAllowedRepos(e){await m.workspace.fs.writeFile(this.indexingAllowanceFile,su.encode(JSON.stringify(e))),await this.updateContext(),setTimeout(()=>this._onDidChangeIndexingEnablement.fire(),0)}async markIndexingEnabledForRepos(...e){let r;try{r=JSON.parse(au.decode(await m.workspace.fs.readFile(this.indexingAllowanceFile)))}catch(n){n instanceof m.FileSystemError&&n.code!==m.FileSystemError.FileNotFound().code&&L.error(n,"Error reading index allowance data."),r=[]}for(const n of e)r.includes(n)||r.push(n);this.indexingDisabled=!1,await m.workspace.fs.writeFile(this.indexingAllowanceFile,su.encode(JSON.stringify(r))),await this.updateContext(),setTimeout(()=>this._onDidChangeIndexingEnablement.fire(),0)}async markCacheEntryUsed(e){let r;try{r=JSON.parse(au.decode(await m.workspace.fs.readFile(this.usageFile)))}catch(n){n instanceof m.FileSystemError&&n.code!==m.FileSystemError.FileNotFound().code&&L.error(n,"Error reading usage data."),r={}}r[e]=Number(Date.now()),await m.workspace.fs.writeFile(this.usageFile,su.encode(JSON.stringify(r)))}async cleanUpCache(){var e,r;L.log("Cleaning up search cache...");const n=await this.listTars();let i;try{i=JSON.parse(au.decode(await m.workspace.fs.readFile(this.usageFile)))}catch(O){O instanceof m.FileSystemError&&O.code!==m.FileSystemError.FileNotFound().code&&L.error(O,"Error reading usage data. All existing indexes will be discarded."),i={}}const o=[];n.forEach(O=>{var I;const P=/^([^/]*\/[^/]*)\//.exec(O.name);if(!P)throw Error("Unexpected repo entry");const $=P[1],N=(I=i[O.name])!=null?I:0;o.push({...O,lastUsed:N,repo:$})}),o.sort((O,I)=>I.lastUsed-O.lastUsed);let c=0;const l=[],d=new Map,h=((e=Y.get("search.download.sizeLimit"))!=null?e:100)*1024*1024,S=(r=Y.get("search.download.repoLimit"))!=null?r:4;o.forEach(O=>{var I,P;(O.lastUsed===0||c>h||((I=d.get(O.repo))!=null?I:0)>S)&&l.push(O),c+=O.size,d.set(O.repo,((P=d.get(O.repo))!=null?P:0)+1)}),await Promise.all(l.map(async O=>{try{await m.workspace.fs.delete(O.path,{recursive:!0}),delete i[O.name],L.log(`Deleted cache entry for ${O.name}`)}catch(I){L.log(`Deleting cache entry for ${O.name} failed; ${String(I)}`)}})),await m.workspace.fs.writeFile(this.usageFile,su.encode(JSON.stringify(i))),await this.updateContext()}}a(Lf,"TarPit");const qv=(0,B.loadMessageBundle)();async function zv(t,e,r,n,i,o,c){return bd("provideTextSearchResults",async()=>{const l=Wp(n.pattern,Boolean(n.isRegExp),{matchCase:n.isCaseSensitive,wholeWord:n.isWordMatch,multiline:n.isMultiline,global:!0});let d;try{d=await bd("fetch tarball",()=>r.getTar(i.folder))}catch(U){return{limitHit:!1,message:{type:m.TextSearchCompleteMessageType.Warning,trusted:!0,text:qv("indexNotAvailable","Search index not available. [Retry with indexing disabled]({0}).","command:remoteHub.disableIndexingForSession")}}}if(c.isCancellationRequested)return{limitHit:!1};const{maxResults:h,maxFileSize:S,includes:O,excludes:I}=i,P=await Wv(i.folder,t,d,e);if(c.isCancellationRequested)return{limitHit:!0};let $=h;const N=Gp(P,O,I,S);return bd("searchFiles",async()=>{var U,W;let V=0;for(const ie of P){if(!N.has(ie.path))continue;const oe=Vp(ie.contents,ie.path,l,{beforeContext:(U=i.beforeContext)!=null?U:0,afterContext:(W=i.afterContext)!=null?W:0,previewOptions:i.previewOptions,remainingResultQuota:$});for(const ge of oe)o.report({...ge,uri:m.Uri.joinPath(i.folder,ge.uri.path)});if($!==void 0&&($-=oe.length,$<=0))return{limitHit:!0};if(V++,V%1e4==0&&(await new Promise(ge=>setTimeout(ge,0)),c.isCancellationRequested))return{limitHit:!1}}return{limitHit:!1}})})}a(zv,"provideTextSearchResults");async function Wv(t,e,r,n){const i=r.entries,o=e.getVirtualRootUri(t),c=await n.getChanges(o,{predicate:O=>O.fileType===m.FileType.File});if(c.length===0)return i.map(O=>({contents:O.dataAsBytes,path:O.header.fullFileName,size:O.dataAsBytes.byteLength}));const l=await Promise.all(nn(c,O=>{if(O.type===Dt.Created)return n.getContent(O.uri).then(I=>({path:e.getRelativeFilePath(o,O.uri),size:I.length,contents:I}))})),d=await Promise.all(nn(c,O=>{if(O.type===Dt.Changed)return n.getContent(O.uri).then(I=>({path:e.getRelativeFilePath(o,O.uri),size:I.length,contents:I}))})),h=new Set(Li(eo(d,O=>O.path),nn(c,O=>{if(O.type===Dt.Deleted)return e.getRelativeFilePath(o,O.uri)})));return[...nn(i,O=>{if(!h.has(O.header.fullFileName))return{contents:O.dataAsBytes,path:O.header.fullFileName,size:O.dataAsBytes.byteLength}}),...l,...d]}a(Wv,"listAllFiles");function My(t,e){const r=Date.now(),n=e();return Logger.log(`${t} time: ${Date.now()-r}`),n}a(My,"timeSync");async function bd(t,e){const r=Date.now(),n=await e();return L.log(`${t} time: ${Date.now()-r}`),n}a(bd,"time");var Gv=Object.defineProperty,Vv=Object.getOwnPropertyDescriptor,Sd=a((t,e,r,n)=>{for(var i=n>1?void 0:n?Vv(e,r):e,o=t.length-1,c;o>=0;o--)(c=t[o])&&(i=(n?c(e,r,i):c(i))||i);return n&&i&&Gv(e,r,i),i},"github_fs_decorateClass");const Ed=(0,B.loadMessageBundle)(),Kv=m.FileSystemError.FileNotFound().code,Xv=/(\/|\\)/g,$f=".vscode/.github-pull-request.rec";class tl{constructor(e,r,n,i){this.providerService=e,this.github=r,this.changeStore=n,this.tarPit=i,this._onDidChangeFile=new m.EventEmitter,this.fileSearchCache=new Map,this.pendingUriRequests=new Map,this.pendingUriRequestsEventDelay=10,this.implicitlyWatchedUris=new Map,this.watchedUris=new Map,this.disposable=m.Disposable.from(m.workspace.registerFileSystemProvider(this.scheme,this,{isCaseSensitive:!0,isReadonly:!0}),m.workspace.registerFileSearchProvider(this.scheme,this),m.workspace.registerTextSearchProvider(this.scheme,this),e.onDidChangeRepository(o=>{o.reason==="HEAD"&&this.onRefreshOrRepositoryChanged([o.repository.uri])}),e.onDidRefresh(o=>this.onRefreshOrRepositoryChanged(o)))}get onDidChangeFile(){return this._onDidChangeFile.event}get scheme(){return this.github.scheme}dispose(){var e;(e=this.disposable)==null||e.dispose()}onRefreshOrRepositoryChanged(e){if(e=e.filter(r=>Qt.getProviderId(r)===this.scheme).map(r=>this.providerService.getProviderUri(r)),e.length!==0){L.log(`GitHubFS.onRefreshOrRepositoryChanged(${e.map(r=>r.toString()).join(", ")})`),this.fileSearchCache.clear();for(const[r,n]of[...this.pendingUriRequests])e.some(i=>ve(n.uri,i))&&(this.pendingUriRequests.delete(r),n.outdated=!0);this.updateOpenOrWatchedUris(e)}}updateOpenOrWatchedUris(e){const r=this.providerService.getOpenUris(this.scheme,e);for(const[i,o]of[...this.watchedUris,...this.implicitlyWatchedUris])e.some(c=>ve(o,c))&&(this.implicitlyWatchedUris.delete(i),r.set(i,o));L.debug(`GitHubFS.updateOpenOrWatchedUris(${e.map(i=>i.toString()).join(", ")}): uris=${r.size}`);for(const i of e)r.set(te(i),i);const n=[...r.values()].map(i=>({type:m.FileChangeType.Changed,uri:i}));setTimeout(()=>{L.debug(`GitHubFS.updateOpenOrWatchedUris: Firing events=${n.map(i=>i.uri.toString()).join(", ")}`),this._onDidChangeFile.fire(n)},0)}watch(e,r){const n=te(e);return this.watchedUris.set(n,e),{dispose:()=>{this.watchedUris.delete(n)}}}async stat(e){var r,n;const i=te(e);this.implicitlyWatchedUris.set(i,e);const o=this.providerService.getRelativeFilePath(e),c={uri:e,outdated:!1};try{this.pendingUriRequests.set(`stat:${i}`,c);const l=await this.github.getFileTree(e),d=await l.get(o);if(d==null?void 0:d.stat)return d==null?void 0:d.stat;if(this.implicitlyWatchedUris.delete(i),e.query==="~")return{type:m.FileType.File,size:0,ctime:0,mtime:(r=l.timestamp)!=null?r:Date.now(),permissions:m.FilePermission.Readonly};if(o===$f){const{ref:h}=this.providerService.getVirtualUriMetadata(e);if((h==null?void 0:h.type)===tt.PullRequest)return{type:m.FileType.File,size:0,ctime:0,mtime:(n=l.timestamp)!=null?n:Date.now(),permissions:m.FilePermission.Readonly}}throw m.FileSystemError.FileNotFound(e)}finally{this.pendingUriRequests.delete(`stat:${i}`),(c==null?void 0:c.outdated)&&setTimeout(()=>{L.log(`GitHubFS.stat(${e.toString()}): Repository changed; firing change event...`),this._onDidChangeFile.fire([{type:m.FileChangeType.Changed,uri:e}])},this.pendingUriRequestsEventDelay)}}async readDirectory(e,r){this.implicitlyWatchedUris.set(te(e),e);const n=await this.github.getFileTree(e),i=this.providerService.getRelativeFilePath(e),o=(await n.getChildren(i,r)).map(([c,{stat:{type:l}}])=>[c,l]);return i===""&&ut.stop("Time to root directory"),o}createDirectory(e){throw m.FileSystemError.NoPermissions()}async readFile(e){const r=te(e);this.implicitlyWatchedUris.set(r,e);const n={uri:e,outdated:!1};try{return this.pendingUriRequests.set(r,n),await this.github.getFileContent(e)}catch(i){if(this.implicitlyWatchedUris.delete(r),i instanceof m.FileSystemError&&i.code===Kv){if(e.query==="~")return new Uint8Array(0);if(this.providerService.getRelativeFilePath(e)===$f){const{ref:c}=this.providerService.getVirtualUriMetadata(e);if((c==null?void 0:c.type)===tt.PullRequest)return new Uint8Array(0)}}throw i}finally{this.pendingUriRequests.delete(r),(n==null?void 0:n.outdated)&&setTimeout(()=>{L.log(`GitHubFS.readFile(${e.toString()}): Repository changed; firing change event...`),this._onDidChangeFile.fire([{type:m.FileChangeType.Changed,uri:e}])},this.pendingUriRequestsEventDelay)}}writeFile(e,r,n){throw m.FileSystemError.NoPermissions()}delete(e,r){throw m.FileSystemError.NoPermissions()}rename(e,r,n){throw m.FileSystemError.NoPermissions()}copy(e,r,n){throw m.FileSystemError.NoPermissions()}async provideFileSearchResults(e,{folder:r,maxResults:n,includes:i,excludes:o},c){const l=`${te(r)}|${JSON.stringify({includes:i,excludes:o})}`;let d=this.fileSearchCache.get(l);if(d===void 0){const S=this.providerService.getRelativeFilePath(r);let O;await this.github.hasFileTree(r)&&(O=await this.github.getFileTree(r));let I;if(O===void 0||O.loading||!O.hasEntireTree?I=await this.github.getFileList(r,S):I=(await O.getChildren(S,{filter:m.FileType.File,recursive:!0})).map(([P])=>P),I.length===0||c.isCancellationRequested)return[];((i==null?void 0:i.length)||(o==null?void 0:o.length))&&(I=[...Pr(I,i,o)]),d=I.map(P=>fr.prepareSlow(P)),this.fileSearchCache.set(l,d)}let h;return e.pattern===""?h=d.map(S=>m.Uri.joinPath(r,S.target)):(h=fr.go(e.pattern.replace(Xv,"/"),d,{allowTypo:!0,limit:n}).map(S=>m.Uri.joinPath(r,S.target)),fr.cleanup()),n!==void 0&&n!==0&&n<h.length&&(h=h.slice(0,n)),h}async provideTextSearchResults(e,r,n,i){const o=[];if(await this.tarPit.isIndexingEnabledForRepo(r.folder))try{return zv(this.providerService,this.changeStore,this.tarPit,e,r,n,i)}catch{o.push({text:Ed("index error","Error searching index, falling back to GitHub search. Try [deleting this repo's data]({0}) or [deleting all local data]({1}) to rebuild the index.","command:remoteHub.deleteLocalRepositoryData","command:remoteHub.deleteAllLocalRepositoryData"),type:m.TextSearchCompleteMessageType.Warning})}e.isCaseSensitive||e.isRegExp||e.isWordMatch?o.push({text:Ed("flags not supported","Search flags are not supported by GitHub search. [Enable indexing]({0}) for full search features and exact text searches.","command:remoteHub.enableIndexing"),type:m.TextSearchCompleteMessageType.Warning,trusted:!0}):o.push({text:Ed("enable index","Currently using GitHub text search. [Enable indexing]({0}) for exact text searches.","command:remoteHub.enableIndexing"),type:m.TextSearchCompleteMessageType.Information,trusted:!0});const c=await this.github.searchCodeQuery(e.pattern,r.folder,{maxResults:r.maxResults,context:{before:r.beforeContext,after:r.afterContext}});if(c.warnings&&c.warnings.forEach(d=>{o.push({text:d,trusted:!0,type:m.TextSearchCompleteMessageType.Warning})}),c===void 0)return{limitHit:!0,message:o};let l;for(const d of c.matches)l=m.Uri.joinPath(r.folder,d.path),n.report({uri:l,ranges:d.ranges,preview:{text:d.preview,matches:d.matches}});return{limitHit:!1,message:o}}}a(tl,"GitHubFS"),Sd([Mr()],tl.prototype,"stat",1),Sd([Mr()],tl.prototype,"readDirectory",1),Sd([Mr()],tl.prototype,"readFile",1);var Qv=__webpack_require__(1017);function cu(){return typeof navigator=="object"&&"userAgent"in navigator?navigator.userAgent:typeof process=="object"&&"version"in process?`Node.js/${process.version.substr(1)} (${process.platform}; ${process.arch})`:"<environment undetectable>"}a(cu,"getUserAgent");var Yv=__webpack_require__(5186);/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */function Ff(t){return Object.prototype.toString.call(t)==="[object Object]"}a(Ff,"isObject");function Bf(t){var e,r;return Ff(t)===!1?!1:(e=t.constructor,e===void 0?!0:(r=e.prototype,!(Ff(r)===!1||r.hasOwnProperty("isPrototypeOf")===!1)))}a(Bf,"isPlainObject");function Zv(t){return t?Object.keys(t).reduce((e,r)=>(e[r.toLowerCase()]=t[r],e),{}):{}}a(Zv,"lowercaseKeys");function Hf(t,e){const r=Object.assign({},t);return Object.keys(e).forEach(n=>{Bf(e[n])?n in t?r[n]=Hf(t[n],e[n]):Object.assign(r,{[n]:e[n]}):Object.assign(r,{[n]:e[n]})}),r}a(Hf,"mergeDeep");function Uf(t){for(const e in t)t[e]===void 0&&delete t[e];return t}a(Uf,"removeUndefinedProperties");function xd(t,e,r){if(typeof e=="string"){let[i,o]=e.split(" ");r=Object.assign(o?{method:i,url:o}:{url:i},r)}else r=Object.assign({},e);r.headers=Zv(r.headers),Uf(r),Uf(r.headers);const n=Hf(t||{},r);return t&&t.mediaType.previews.length&&(n.mediaType.previews=t.mediaType.previews.filter(i=>!n.mediaType.previews.includes(i)).concat(n.mediaType.previews)),n.mediaType.previews=n.mediaType.previews.map(i=>i.replace(/-preview/,"")),n}a(xd,"dist_web_merge");function Jv(t,e){const r=/\?/.test(t)?"&":"?",n=Object.keys(e);return n.length===0?t:t+r+n.map(i=>i==="q"?"q="+e.q.split("+").map(encodeURIComponent).join("+"):`${i}=${encodeURIComponent(e[i])}`).join("&")}a(Jv,"addQueryParameters");const e0=/\{[^}]+\}/g;function t0(t){return t.replace(/^\W+|\W+$/g,"").split(/,/)}a(t0,"removeNonChars");function r0(t){const e=t.match(e0);return e?e.map(t0).reduce((r,n)=>r.concat(n),[]):[]}a(r0,"extractUrlVariableNames");function jf(t,e){return Object.keys(t).filter(r=>!e.includes(r)).reduce((r,n)=>(r[n]=t[n],r),{})}a(jf,"omit");function qf(t){return t.split(/(%[0-9A-Fa-f]{2})/g).map(function(e){return/%[0-9A-Fa-f]/.test(e)||(e=encodeURI(e).replace(/%5B/g,"[").replace(/%5D/g,"]")),e}).join("")}a(qf,"encodeReserved");function Hs(t){return encodeURIComponent(t).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}a(Hs,"encodeUnreserved");function rl(t,e,r){return e=t==="+"||t==="#"?qf(e):Hs(e),r?Hs(r)+"="+e:e}a(rl,"encodeValue");function Us(t){return t!=null}a(Us,"isDefined");function Cd(t){return t===";"||t==="&"||t==="?"}a(Cd,"isKeyOperator");function n0(t,e,r,n){var i=t[r],o=[];if(Us(i)&&i!=="")if(typeof i=="string"||typeof i=="number"||typeof i=="boolean")i=i.toString(),n&&n!=="*"&&(i=i.substring(0,parseInt(n,10))),o.push(rl(e,i,Cd(e)?r:""));else if(n==="*")Array.isArray(i)?i.filter(Us).forEach(function(c){o.push(rl(e,c,Cd(e)?r:""))}):Object.keys(i).forEach(function(c){Us(i[c])&&o.push(rl(e,i[c],c))});else{const c=[];Array.isArray(i)?i.filter(Us).forEach(function(l){c.push(rl(e,l))}):Object.keys(i).forEach(function(l){Us(i[l])&&(c.push(Hs(l)),c.push(rl(e,i[l].toString())))}),Cd(e)?o.push(Hs(r)+"="+c.join(",")):c.length!==0&&o.push(c.join(","))}else e===";"?Us(i)&&o.push(Hs(r)):i===""&&(e==="&"||e==="?")?o.push(Hs(r)+"="):i===""&&o.push("");return o}a(n0,"getValues");function i0(t){return{expand:o0.bind(null,t)}}a(i0,"parseUrl");function o0(t,e){var r=["+","#",".","/",";","?","&"];return t.replace(/\{([^\{\}]+)\}|([^\{\}]+)/g,function(n,i,o){if(i){let l="";const d=[];if(r.indexOf(i.charAt(0))!==-1&&(l=i.charAt(0),i=i.substr(1)),i.split(/,/g).forEach(function(h){var S=/([^:\*]*)(?::(\d+)|(\*))?/.exec(h);d.push(n0(e,l,S[1],S[2]||S[3]))}),l&&l!=="+"){var c=",";return l==="?"?c="&":l!=="#"&&(c=l),(d.length!==0?l:"")+d.join(c)}else return d.join(",")}else return qf(o)})}a(o0,"expand");function zf(t){let e=t.method.toUpperCase(),r=(t.url||"/").replace(/:([a-z]\w+)/g,"{$1}"),n=Object.assign({},t.headers),i,o=jf(t,["method","baseUrl","url","headers","request","mediaType"]);const c=r0(r);r=i0(r).expand(o),/^http/.test(r)||(r=t.baseUrl+r);const l=Object.keys(t).filter(S=>c.includes(S)).concat("baseUrl"),d=jf(o,l);if(!/application\/octet-stream/i.test(n.accept)&&(t.mediaType.format&&(n.accept=n.accept.split(/,/).map(S=>S.replace(/application\/vnd(\.\w+)(\.v3)?(\.\w+)?(\+json)?$/,`application/vnd$1$2.${t.mediaType.format}`)).join(",")),t.mediaType.previews.length)){const S=n.accept.match(/[\w-]+(?=-preview)/g)||[];n.accept=S.concat(t.mediaType.previews).map(O=>{const I=t.mediaType.format?`.${t.mediaType.format}`:"+json";return`application/vnd.github.${O}-preview${I}`}).join(",")}return["GET","HEAD"].includes(e)?r=Jv(r,d):"data"in d?i=d.data:Object.keys(d).length?i=d:n["content-length"]=0,!n["content-type"]&&typeof i!="undefined"&&(n["content-type"]="application/json; charset=utf-8"),["PATCH","PUT"].includes(e)&&typeof i=="undefined"&&(i=""),Object.assign({method:e,url:r,headers:n},typeof i!="undefined"?{body:i}:null,t.request?{request:t.request}:null)}a(zf,"parse");function a0(t,e,r){return zf(xd(t,e,r))}a(a0,"endpointWithDefaults");function Wf(t,e){const r=xd(t,e),n=a0.bind(null,r);return Object.assign(n,{DEFAULTS:r,defaults:Wf.bind(null,r),merge:xd.bind(null,r),parse:zf})}a(Wf,"withDefaults");const s0=`octokit-endpoint.js/6.0.12 ${cu()}`,c0=Wf(null,{method:"GET",baseUrl:"https://api.github.com",headers:{accept:"application/vnd.github.v3+json","user-agent":s0},mediaType:{format:"",previews:[]}}),l0=Sr.Readable,vo=Symbol("buffer"),Td=Symbol("type");class Fa{constructor(){this[Td]="";const e=arguments[0],r=arguments[1],n=[];let i=0;if(e){const c=e,l=Number(c.length);for(let d=0;d<l;d++){const h=c[d];let S;h instanceof Buffer?S=h:ArrayBuffer.isView(h)?S=Buffer.from(h.buffer,h.byteOffset,h.byteLength):h instanceof ArrayBuffer?S=Buffer.from(h):h instanceof Fa?S=h[vo]:S=Buffer.from(typeof h=="string"?h:String(h)),i+=S.length,n.push(S)}}this[vo]=Buffer.concat(n);let o=r&&r.type!==void 0&&String(r.type).toLowerCase();o&&!/[^\u0020-\u007E]/.test(o)&&(this[Td]=o)}get size(){return this[vo].length}get type(){return this[Td]}text(){return Promise.resolve(this[vo].toString())}arrayBuffer(){const e=this[vo],r=e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);return Promise.resolve(r)}stream(){const e=new l0;return e._read=function(){},e.push(this[vo]),e.push(null),e}toString(){return"[object Blob]"}slice(){const e=this.size,r=arguments[0],n=arguments[1];let i,o;r===void 0?i=0:r<0?i=Math.max(e+r,0):i=Math.min(r,e),n===void 0?o=e:n<0?o=Math.max(e+n,0):o=Math.min(n,e);const c=Math.max(o-i,0),d=this[vo].slice(i,i+c),h=new Fa([],{type:arguments[2]});return h[vo]=d,h}}a(Fa,"lib_Blob"),Object.defineProperties(Fa.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}}),Object.defineProperty(Fa.prototype,Symbol.toStringTag,{value:"Blob",writable:!1,enumerable:!1,configurable:!0});function Cn(t,e,r){Error.call(this,t),this.message=t,this.type=e,r&&(this.code=this.errno=r.code),Error.captureStackTrace(this,this.constructor)}a(Cn,"lib_FetchError"),Cn.prototype=Object.create(Error.prototype),Cn.prototype.constructor=Cn,Cn.prototype.name="FetchError";let Ad;try{Ad=require("encoding").convert}catch(t){}const yo=Symbol("Body internals"),Gf=Sr.PassThrough;function en(t){var e=this,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.size;let i=n===void 0?0:n;var o=r.timeout;let c=o===void 0?0:o;t==null?t=null:Vf(t)?t=Buffer.from(t.toString()):nl(t)||Buffer.isBuffer(t)||(Object.prototype.toString.call(t)==="[object ArrayBuffer]"?t=Buffer.from(t):ArrayBuffer.isView(t)?t=Buffer.from(t.buffer,t.byteOffset,t.byteLength):t instanceof Sr||(t=Buffer.from(String(t)))),this[yo]={body:t,disturbed:!1,error:null},this.size=i,this.timeout=c,t instanceof Sr&&t.on("error",function(l){const d=l.name==="AbortError"?l:new Cn(`Invalid response body while trying to fetch ${e.url}: ${l.message}`,"system",l);e[yo].error=d})}a(en,"lib_Body"),en.prototype={get body(){return this[yo].body},get bodyUsed(){return this[yo].disturbed},arrayBuffer(){return js.call(this).then(function(t){return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)})},blob(){let t=this.headers&&this.headers.get("content-type")||"";return js.call(this).then(function(e){return Object.assign(new Fa([],{type:t.toLowerCase()}),{[vo]:e})})},json(){var t=this;return js.call(this).then(function(e){try{return JSON.parse(e.toString())}catch(r){return en.Promise.reject(new Cn(`invalid json response body at ${t.url} reason: ${r.message}`,"invalid-json"))}})},text(){return js.call(this).then(function(t){return t.toString()})},buffer(){return js.call(this)},textConverted(){var t=this;return js.call(this).then(function(e){return u0(e,t.headers)})}},Object.defineProperties(en.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0}}),en.mixIn=function(t){for(const e of Object.getOwnPropertyNames(en.prototype))if(!(e in t)){const r=Object.getOwnPropertyDescriptor(en.prototype,e);Object.defineProperty(t,e,r)}};function js(){var t=this;if(this[yo].disturbed)return en.Promise.reject(new TypeError(`body used already for: ${this.url}`));if(this[yo].disturbed=!0,this[yo].error)return en.Promise.reject(this[yo].error);let e=this.body;if(e===null)return en.Promise.resolve(Buffer.alloc(0));if(nl(e)&&(e=e.stream()),Buffer.isBuffer(e))return en.Promise.resolve(e);if(!(e instanceof Sr))return en.Promise.resolve(Buffer.alloc(0));let r=[],n=0,i=!1;return new en.Promise(function(o,c){let l;t.timeout&&(l=setTimeout(function(){i=!0,c(new Cn(`Response timeout while trying to fetch ${t.url} (over ${t.timeout}ms)`,"body-timeout"))},t.timeout)),e.on("error",function(d){d.name==="AbortError"?(i=!0,c(d)):c(new Cn(`Invalid response body while trying to fetch ${t.url}: ${d.message}`,"system",d))}),e.on("data",function(d){if(!(i||d===null)){if(t.size&&n+d.length>t.size){i=!0,c(new Cn(`content size at ${t.url} over limit: ${t.size}`,"max-size"));return}n+=d.length,r.push(d)}}),e.on("end",function(){if(!i){clearTimeout(l);try{o(Buffer.concat(r,n))}catch(d){c(new Cn(`Could not create Buffer from response body for ${t.url}: ${d.message}`,"system",d))}}})})}a(js,"lib_consumeBody");function u0(t,e){if(typeof Ad!="function")throw new Error("The package `encoding` must be installed to use the textConverted() function");const r=e.get("content-type");let n="utf-8",i,o;return r&&(i=/charset=([^;]*)/i.exec(r)),o=t.slice(0,1024).toString(),!i&&o&&(i=/<meta.+?charset=(['"])(.+?)\1/i.exec(o)),!i&&o&&(i=/<meta[\s]+?http-equiv=(['"])content-type\1[\s]+?content=(['"])(.+?)\2/i.exec(o),i||(i=/<meta[\s]+?content=(['"])(.+?)\1[\s]+?http-equiv=(['"])content-type\3/i.exec(o),i&&i.pop()),i&&(i=/charset=(.*)/i.exec(i.pop()))),!i&&o&&(i=/<\?xml.+?encoding=(['"])(.+?)\1/i.exec(o)),i&&(n=i.pop(),(n==="gb2312"||n==="gbk")&&(n="gb18030")),Ad(t,"UTF-8",n).toString()}a(u0,"lib_convertBody");function Vf(t){return typeof t!="object"||typeof t.append!="function"||typeof t.delete!="function"||typeof t.get!="function"||typeof t.getAll!="function"||typeof t.has!="function"||typeof t.set!="function"?!1:t.constructor.name==="URLSearchParams"||Object.prototype.toString.call(t)==="[object URLSearchParams]"||typeof t.sort=="function"}a(Vf,"lib_isURLSearchParams");function nl(t){return typeof t=="object"&&typeof t.arrayBuffer=="function"&&typeof t.type=="string"&&typeof t.stream=="function"&&typeof t.constructor=="function"&&typeof t.constructor.name=="string"&&/^(Blob|File)$/.test(t.constructor.name)&&/^(Blob|File)$/.test(t[Symbol.toStringTag])}a(nl,"lib_isBlob");function Kf(t){let e,r,n=t.body;if(t.bodyUsed)throw new Error("cannot clone body after it is used");return n instanceof Sr&&typeof n.getBoundary!="function"&&(e=new Gf,r=new Gf,n.pipe(e),n.pipe(r),t[yo].body=e,n=r),n}a(Kf,"lib_clone");function Xf(t){return t===null?null:typeof t=="string"?"text/plain;charset=UTF-8":Vf(t)?"application/x-www-form-urlencoded;charset=UTF-8":nl(t)?t.type||null:Buffer.isBuffer(t)||Object.prototype.toString.call(t)==="[object ArrayBuffer]"||ArrayBuffer.isView(t)?null:typeof t.getBoundary=="function"?`multipart/form-data;boundary=${t.getBoundary()}`:t instanceof Sr?null:"text/plain;charset=UTF-8"}a(Xf,"lib_extractContentType");function Qf(t){const e=t.body;return e===null?0:nl(e)?e.size:Buffer.isBuffer(e)?e.length:e&&typeof e.getLengthSync=="function"&&(e._lengthRetrievers&&e._lengthRetrievers.length==0||e.hasKnownLength&&e.hasKnownLength())?e.getLengthSync():null}a(Qf,"lib_getTotalBytes");function d0(t,e){const r=e.body;r===null?t.end():nl(r)?r.stream().pipe(t):Buffer.isBuffer(r)?(t.write(r),t.end()):r.pipe(t)}a(d0,"lib_writeToStream"),en.Promise=global.Promise;const Yf=/[^\^_`a-zA-Z\-0-9!#$%&'*+.|~]/,Rd=/[^\t\x20-\x7e\x80-\xff]/;function il(t){if(t=`${t}`,Yf.test(t)||t==="")throw new TypeError(`${t} is not a legal HTTP header name`)}a(il,"lib_validateName");function Zf(t){if(t=`${t}`,Rd.test(t))throw new TypeError(`${t} is not a legal HTTP header value`)}a(Zf,"lib_validateValue");function qs(t,e){e=e.toLowerCase();for(const r in t)if(r.toLowerCase()===e)return r}a(qs,"node_fetch_lib_find");const kr=Symbol("map");class hi{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:void 0;if(this[kr]=Object.create(null),e instanceof hi){const r=e.raw(),n=Object.keys(r);for(const i of n)for(const o of r[i])this.append(i,o);return}if(e!=null)if(typeof e=="object"){const r=e[Symbol.iterator];if(r!=null){if(typeof r!="function")throw new TypeError("Header pairs must be iterable");const n=[];for(const i of e){if(typeof i!="object"||typeof i[Symbol.iterator]!="function")throw new TypeError("Each header pair must be iterable");n.push(Array.from(i))}for(const i of n){if(i.length!==2)throw new TypeError("Each header pair must be a name/value tuple");this.append(i[0],i[1])}}else for(const n of Object.keys(e)){const i=e[n];this.append(n,i)}}else throw new TypeError("Provided initializer must be an object")}get(e){e=`${e}`,il(e);const r=qs(this[kr],e);return r===void 0?null:this[kr][r].join(", ")}forEach(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,n=Id(this),i=0;for(;i<n.length;){var o=n[i];const c=o[0],l=o[1];e.call(r,l,c,this),n=Id(this),i++}}set(e,r){e=`${e}`,r=`${r}`,il(e),Zf(r);const n=qs(this[kr],e);this[kr][n!==void 0?n:e]=[r]}append(e,r){e=`${e}`,r=`${r}`,il(e),Zf(r);const n=qs(this[kr],e);n!==void 0?this[kr][n].push(r):this[kr][e]=[r]}has(e){return e=`${e}`,il(e),qs(this[kr],e)!==void 0}delete(e){e=`${e}`,il(e);const r=qs(this[kr],e);r!==void 0&&delete this[kr][r]}raw(){return this[kr]}keys(){return Pd(this,"key")}values(){return Pd(this,"value")}[Symbol.iterator](){return Pd(this,"key+value")}}a(hi,"lib_Headers"),hi.prototype.entries=hi.prototype[Symbol.iterator],Object.defineProperty(hi.prototype,Symbol.toStringTag,{value:"Headers",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(hi.prototype,{get:{enumerable:!0},forEach:{enumerable:!0},set:{enumerable:!0},append:{enumerable:!0},has:{enumerable:!0},delete:{enumerable:!0},keys:{enumerable:!0},values:{enumerable:!0},entries:{enumerable:!0}});function Id(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"key+value";return Object.keys(t[kr]).sort().map(e==="key"?function(n){return n.toLowerCase()}:e==="value"?function(n){return t[kr][n].join(", ")}:function(n){return[n.toLowerCase(),t[kr][n].join(", ")]})}a(Id,"lib_getHeaders");const Od=Symbol("internal");function Pd(t,e){const r=Object.create(Dd);return r[Od]={target:t,kind:e,index:0},r}a(Pd,"lib_createHeadersIterator");const Dd=Object.setPrototypeOf({next(){if(!this||Object.getPrototypeOf(this)!==Dd)throw new TypeError("Value of `this` is not a HeadersIterator");var t=this[Od];const e=t.target,r=t.kind,n=t.index,i=Id(e,r),o=i.length;return n>=o?{value:void 0,done:!0}:(this[Od].index=n+1,{value:i[n],done:!1})}},Object.getPrototypeOf(Object.getPrototypeOf([][Symbol.iterator]())));Object.defineProperty(Dd,Symbol.toStringTag,{value:"HeadersIterator",writable:!1,enumerable:!1,configurable:!0});function h0(t){const e=Object.assign({__proto__:null},t[kr]),r=qs(t[kr],"Host");return r!==void 0&&(e[r]=e[r][0]),e}a(h0,"lib_exportNodeCompatibleHeaders");function f0(t){const e=new hi;for(const r of Object.keys(t))if(!Yf.test(r))if(Array.isArray(t[r]))for(const n of t[r])Rd.test(n)||(e[kr][r]===void 0?e[kr][r]=[n]:e[kr][r].push(n));else Rd.test(t[r])||(e[kr][r]=[t[r]]);return e}a(f0,"lib_createHeadersLenient");const ta=Symbol("Response internals"),p0=ps.STATUS_CODES;class Di{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};en.call(this,e,r);const n=r.status||200,i=new hi(r.headers);if(e!=null&&!i.has("Content-Type")){const o=Xf(e);o&&i.append("Content-Type",o)}this[ta]={url:r.url,status:n,statusText:r.statusText||p0[n],headers:i,counter:r.counter}}get url(){return this[ta].url||""}get status(){return this[ta].status}get ok(){return this[ta].status>=200&&this[ta].status<300}get redirected(){return this[ta].counter>0}get statusText(){return this[ta].statusText}get headers(){return this[ta].headers}clone(){return new Di(Kf(this),{url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected})}}a(Di,"lib_Response"),en.mixIn(Di.prototype),Object.defineProperties(Di.prototype,{url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}}),Object.defineProperty(Di.prototype,Symbol.toStringTag,{value:"Response",writable:!1,enumerable:!1,configurable:!0});const _o=Symbol("Request internals"),kd=$o.parse,g0=$o.format,m0="destroy"in Sr.Readable.prototype;function lu(t){return typeof t=="object"&&typeof t[_o]=="object"}a(lu,"lib_isRequest");function v0(t){const e=t&&typeof t=="object"&&Object.getPrototypeOf(t);return!!(e&&e.constructor.name==="AbortSignal")}a(v0,"lib_isAbortSignal");class ra{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n;lu(e)?n=kd(e.url):(e&&e.href?n=kd(e.href):n=kd(`${e}`),e={});let i=r.method||e.method||"GET";if(i=i.toUpperCase(),(r.body!=null||lu(e)&&e.body!==null)&&(i==="GET"||i==="HEAD"))throw new TypeError("Request with GET/HEAD method cannot have body");let o=r.body!=null?r.body:lu(e)&&e.body!==null?Kf(e):null;en.call(this,o,{timeout:r.timeout||e.timeout||0,size:r.size||e.size||0});const c=new hi(r.headers||e.headers||{});if(o!=null&&!c.has("Content-Type")){const d=Xf(o);d&&c.append("Content-Type",d)}let l=lu(e)?e.signal:null;if("signal"in r&&(l=r.signal),l!=null&&!v0(l))throw new TypeError("Expected signal to be an instanceof AbortSignal");this[_o]={method:i,redirect:r.redirect||e.redirect||"follow",headers:c,parsedURL:n,signal:l},this.follow=r.follow!==void 0?r.follow:e.follow!==void 0?e.follow:20,this.compress=r.compress!==void 0?r.compress:e.compress!==void 0?e.compress:!0,this.counter=r.counter||e.counter||0,this.agent=r.agent||e.agent}get method(){return this[_o].method}get url(){return g0(this[_o].parsedURL)}get headers(){return this[_o].headers}get redirect(){return this[_o].redirect}get signal(){return this[_o].signal}clone(){return new ra(this)}}a(ra,"lib_Request"),en.mixIn(ra.prototype),Object.defineProperty(ra.prototype,Symbol.toStringTag,{value:"Request",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(ra.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0}});function y0(t){const e=t[_o].parsedURL,r=new hi(t[_o].headers);if(r.has("Accept")||r.set("Accept","*/*"),!e.protocol||!e.hostname)throw new TypeError("Only absolute URLs are supported");if(!/^https?:$/.test(e.protocol))throw new TypeError("Only HTTP(S) protocols are supported");if(t.signal&&t.body instanceof Sr.Readable&&!m0)throw new Error("Cancellation of streamed requests with AbortSignal is not supported in node < 8");let n=null;if(t.body==null&&/^(POST|PUT)$/i.test(t.method)&&(n="0"),t.body!=null){const o=Qf(t);typeof o=="number"&&(n=String(o))}n&&r.set("Content-Length",n),r.has("User-Agent")||r.set("User-Agent","node-fetch/1.0 (+https://github.com/bitinn/node-fetch)"),t.compress&&!r.has("Accept-Encoding")&&r.set("Accept-Encoding","gzip,deflate");let i=t.agent;return typeof i=="function"&&(i=i(e)),!r.has("Connection")&&!i&&r.set("Connection","close"),Object.assign({},e,{method:t.method,headers:h0(r),agent:i})}a(y0,"lib_getNodeRequestOptions");function ol(t){Error.call(this,t),this.type="aborted",this.message=t,Error.captureStackTrace(this,this.constructor)}a(ol,"lib_AbortError"),ol.prototype=Object.create(Error.prototype),ol.prototype.constructor=ol,ol.prototype.name="AbortError";const Jf=Sr.PassThrough,_0=$o.resolve;function na(t,e){if(!na.Promise)throw new Error("native promise missing, set fetch.Promise to your favorite alternative");return en.Promise=na.Promise,new na.Promise(function(r,n){const i=new ra(t,e),o=y0(i),c=(o.protocol==="https:"?Rl:ps).request,l=i.signal;let d=null;const h=a(function(){let N=new ol("The user aborted a request.");n(N),i.body&&i.body instanceof Sr.Readable&&i.body.destroy(N),!(!d||!d.body)&&d.body.emit("error",N)},"abort");if(l&&l.aborted){h();return}const S=a(function(){h(),P()},"abortAndFinalize"),O=c(o);let I;l&&l.addEventListener("abort",S);function P(){O.abort(),l&&l.removeEventListener("abort",S),clearTimeout(I)}a(P,"finalize"),i.timeout&&O.once("socket",function($){I=setTimeout(function(){n(new Cn(`network timeout at: ${i.url}`,"request-timeout")),P()},i.timeout)}),O.on("error",function($){n(new Cn(`request to ${i.url} failed, reason: ${$.message}`,"system",$)),P()}),O.on("response",function($){clearTimeout(I);const N=f0($.headers);if(na.isRedirect($.statusCode)){const oe=N.get("Location"),ge=oe===null?null:_0(i.url,oe);switch(i.redirect){case"error":n(new Cn(`uri requested responds with a redirect, redirect mode is set to error: ${i.url}`,"no-redirect")),P();return;case"manual":if(ge!==null)try{N.set("Location",ge)}catch(Ie){n(Ie)}break;case"follow":if(ge===null)break;if(i.counter>=i.follow){n(new Cn(`maximum redirect reached at: ${i.url}`,"max-redirect")),P();return}const ke={headers:new hi(i.headers),follow:i.follow,counter:i.counter+1,agent:i.agent,compress:i.compress,method:i.method,body:i.body,signal:i.signal,timeout:i.timeout,size:i.size};if($.statusCode!==303&&i.body&&Qf(i)===null){n(new Cn("Cannot follow redirect with body being a readable stream","unsupported-redirect")),P();return}($.statusCode===303||($.statusCode===301||$.statusCode===302)&&i.method==="POST")&&(ke.method="GET",ke.body=void 0,ke.headers.delete("content-length")),r(na(new ra(ge,ke))),P();return}}$.once("end",function(){l&&l.removeEventListener("abort",S)});let U=$.pipe(new Jf);const W={url:i.url,status:$.statusCode,statusText:$.statusMessage,headers:N,size:i.size,timeout:i.timeout,counter:i.counter},V=N.get("Content-Encoding");if(!i.compress||i.method==="HEAD"||V===null||$.statusCode===204||$.statusCode===304){d=new Di(U,W),r(d);return}const ie={flush:sn.Z_SYNC_FLUSH,finishFlush:sn.Z_SYNC_FLUSH};if(V=="gzip"||V=="x-gzip"){U=U.pipe(sn.createGunzip(ie)),d=new Di(U,W),r(d);return}if(V=="deflate"||V=="x-deflate"){$.pipe(new Jf).once("data",function(ge){(ge[0]&15)==8?U=U.pipe(sn.createInflate()):U=U.pipe(sn.createInflateRaw()),d=new Di(U,W),r(d)});return}if(V=="br"&&typeof sn.createBrotliDecompress=="function"){U=U.pipe(sn.createBrotliDecompress()),d=new Di(U,W),r(d);return}d=new Di(U,W),r(d)}),d0(O,i)})}a(na,"lib_fetch"),na.isRedirect=function(t){return t===301||t===302||t===303||t===307||t===308},na.Promise=global.Promise;const w0=na;class Nd extends Error{constructor(e){super(e);Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="Deprecation"}}a(Nd,"Deprecation");var b0=__webpack_require__(447),ep=__webpack_require__.n(b0);const S0=ep()(t=>console.warn(t)),E0=ep()(t=>console.warn(t));class Zi extends Error{constructor(e,r,n){super(e);Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="HttpError",this.status=r;let i;"headers"in n&&typeof n.headers!="undefined"&&(i=n.headers),"response"in n&&(this.response=n.response,i=n.response.headers);const o=Object.assign({},n.request);n.request.headers.authorization&&(o.headers=Object.assign({},n.request.headers,{authorization:n.request.headers.authorization.replace(/ .*$/," [REDACTED]")})),o.url=o.url.replace(/\bclient_secret=\w+/g,"client_secret=[REDACTED]").replace(/\baccess_token=\w+/g,"access_token=[REDACTED]"),this.request=o,Object.defineProperty(this,"code",{get(){return S0(new Nd("[@octokit/request-error] `error.code` is deprecated, use `error.status`.")),r}}),Object.defineProperty(this,"headers",{get(){return E0(new Nd("[@octokit/request-error] `error.headers` is deprecated, use `error.response.headers`.")),i||{}}})}}a(Zi,"RequestError");const x0="5.6.1";function C0(t){return t.arrayBuffer()}a(C0,"getBufferResponse");function tp(t){const e=t.request&&t.request.log?t.request.log:console;(Bf(t.body)||Array.isArray(t.body))&&(t.body=JSON.stringify(t.body));let r={},n,i;return(t.request&&t.request.fetch||w0)(t.url,Object.assign({method:t.method,body:t.body,headers:t.headers,redirect:t.redirect},t.request)).then(async c=>{i=c.url,n=c.status;for(const l of c.headers)r[l[0]]=l[1];if("deprecation"in r){const l=r.link&&r.link.match(/<([^>]+)>; rel="deprecation"/),d=l&&l.pop();e.warn(`[@octokit/request] "${t.method} ${t.url}" is deprecated. It is scheduled to be removed on ${r.sunset}${d?`. See ${d}`:""}`)}if(!(n===204||n===205)){if(t.method==="HEAD"){if(n<400)return;throw new Zi(c.statusText,n,{response:{url:i,status:n,headers:r,data:void 0},request:t})}if(n===304)throw new Zi("Not modified",n,{response:{url:i,status:n,headers:r,data:await Md(c)},request:t});if(n>=400){const l=await Md(c);throw new Zi(T0(l),n,{response:{url:i,status:n,headers:r,data:l},request:t})}return Md(c)}}).then(c=>({status:n,url:i,headers:r,data:c})).catch(c=>{throw c instanceof Zi?c:new Zi(c.message,500,{request:t})})}a(tp,"fetchWrapper");async function Md(t){const e=t.headers.get("content-type");return/application\/json/.test(e)?t.json():!e||/^text\/|charset=utf-8$/.test(e)?t.text():C0(t)}a(Md,"getResponseData");function T0(t){return typeof t=="string"?t:"message"in t?Array.isArray(t.errors)?`${t.message}: ${t.errors.map(JSON.stringify).join(", ")}`:t.message:`Unknown error: ${JSON.stringify(t)}`}a(T0,"toErrorMessage");function Ld(t,e){const r=t.defaults(e);return Object.assign(a(function(i,o){const c=r.merge(i,o);if(!c.request||!c.request.hook)return tp(r.parse(c));const l=a((d,h)=>tp(r.parse(r.merge(d,h))),"request");return Object.assign(l,{endpoint:r,defaults:Ld.bind(null,r)}),c.request.hook(l,c)},"newApi"),{endpoint:r,defaults:Ld.bind(null,r)})}a(Ld,"dist_web_withDefaults");const uu=Ld(c0,{headers:{"user-agent":`octokit-request.js/${x0} ${cu()}`}}),A0="4.8.0";function R0(t){return`Request failed due to following response errors:
`+t.errors.map(e=>` - ${e.message}`).join(`
`)}a(R0,"_buildMessageForResponseErrors");class zs extends Error{constructor(e,r,n){super(R0(n));this.request=e,this.headers=r,this.response=n,this.name="GraphqlResponseError",this.errors=n.errors,this.data=n.data,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}a(zs,"GraphqlResponseError");const I0=["method","baseUrl","url","headers","request","query","mediaType"],O0=["query","method","url"],rp=/\/api\/v3\/?$/;function P0(t,e,r){if(r){if(typeof e=="string"&&"query"in r)return Promise.reject(new Error('[@octokit/graphql] "query" cannot be used as variable name'));for(const c in r)if(!!O0.includes(c))return Promise.reject(new Error(`[@octokit/graphql] "${c}" cannot be used as variable name`))}const n=typeof e=="string"?Object.assign({query:e},r):e,i=Object.keys(n).reduce((c,l)=>I0.includes(l)?(c[l]=n[l],c):(c.variables||(c.variables={}),c.variables[l]=n[l],c),{}),o=n.baseUrl||t.endpoint.DEFAULTS.baseUrl;return rp.test(o)&&(i.url=o.replace(rp,"/api/graphql")),t(i).then(c=>{if(c.data.errors){const l={};for(const d of Object.keys(c.headers))l[d]=c.headers[d];throw new zs(i,l,c.data)}return c.data.data})}a(P0,"graphql");function $d(t,e){const r=t.defaults(e);return Object.assign(a((i,o)=>P0(r,i,o),"newApi"),{defaults:$d.bind(null,r),endpoint:uu.endpoint})}a($d,"graphql_dist_web_withDefaults");const Fy=$d(uu,{headers:{"user-agent":`octokit-graphql.js/${A0} ${cu()}`},method:"POST",url:"/graphql"});function D0(t){return $d(t,{method:"POST",url:"/graphql"})}a(D0,"withCustomRequest");const k0=/^v1\./,N0=/^ghs_/,M0=/^ghu_/;async function L0(t){const e=t.split(/\./).length===3,r=k0.test(t)||N0.test(t),n=M0.test(t);return{type:"token",token:t,tokenType:e?"app":r?"installation":n?"user-to-server":"oauth"}}a(L0,"auth");function $0(t){return t.split(/\./).length===3?`bearer ${t}`:`token ${t}`}a($0,"withAuthorizationPrefix");async function F0(t,e,r,n){const i=e.endpoint.merge(r,n);return i.headers.authorization=$0(t),e(i)}a(F0,"hook");const B0=a(function(e){if(!e)throw new Error("[@octokit/auth-token] No token passed to createTokenAuth");if(typeof e!="string")throw new Error("[@octokit/auth-token] Token passed to createTokenAuth is not a string");return e=e.replace(/^(token|bearer) +/i,""),Object.assign(L0.bind(null,e),{hook:F0.bind(null,e)})},"createTokenAuth"),np="3.5.1";class al{constructor(e={}){const r=new Yv.Collection,n={baseUrl:uu.endpoint.DEFAULTS.baseUrl,headers:{},request:Object.assign({},e.request,{hook:r.bind(null,"request")}),mediaType:{previews:[],format:""}};if(n.headers["user-agent"]=[e.userAgent,`octokit-core.js/${np} ${cu()}`].filter(Boolean).join(" "),e.baseUrl&&(n.baseUrl=e.baseUrl),e.previews&&(n.mediaType.previews=e.previews),e.timeZone&&(n.headers["time-zone"]=e.timeZone),this.request=uu.defaults(n),this.graphql=D0(this.request).defaults(n),this.log=Object.assign({debug:()=>{},info:()=>{},warn:console.warn.bind(console),error:console.error.bind(console)},e.log),this.hook=r,e.authStrategy){const{authStrategy:o,...c}=e,l=o(Object.assign({request:this.request,log:this.log,octokit:this,octokitOptions:c},e.auth));r.wrap("request",l.hook),this.auth=l}else if(!e.auth)this.auth=async()=>({type:"unauthenticated"});else{const o=B0(e.auth);r.wrap("request",o.hook),this.auth=o}this.constructor.plugins.forEach(o=>{Object.assign(this,o(this,e))})}static defaults(e){return a(class extends this{constructor(...n){const i=n[0]||{};if(typeof e=="function"){super(e(i));return}super(Object.assign({},e,i,i.userAgent&&e.userAgent?{userAgent:`${i.userAgent} ${e.userAgent}`}:null))}},"OctokitWithDefaults")}static plugin(...e){var r;const n=this.plugins;return r=a(class extends this{},"_a"),r.plugins=n.concat(e.filter(o=>!n.includes(o))),r}}a(al,"Octokit"),al.VERSION=np,al.plugins=[];function H0(t,e){return t.reduce((n,i)=>{const o=e(i),c=n.get(o);return c===void 0?n.set(o,[i]):c.push(i),n},new Map)}a(H0,"groupBy");function U0(t){let e=0;for(const r of t){if(r===0)return!0;if(e++,e>8e3)break}return!1}a(U0,"isBinary");function Fd(t,e,r=n=>n){return[...t.reduce((i,o)=>{const c=e(o),l=i.get(c);if(l===void 0)i.set(c,o);else{const d=r(l,o);d!==void 0&&i.set(c,d)}return i},new Map).values()]}a(Fd,"uniqueBy");function Bd(t){const e="$memoize$";return function(...r){return this.hasOwnProperty(e)||Object.defineProperty(this,e,{configurable:!1,enumerable:!1,writable:!1,value:t.apply(this,r)}),this[e]}}a(Bd,"memoize");class Hd{constructor(e,r){this.path=e,this.relativePath=r}}a(Hd,"TrieNode");class ip{constructor(){this.root=new Hd("","")}get(e){var r;e.startsWith("/")?e=e.slice(1,e.endsWith("/")?-1:void 0):e.endsWith("/")&&(e=e.slice(0,-1));let n=this.root;for(const i of e.split("/")){const o=(r=n.children)==null?void 0:r.get(i);if(o===void 0)return;n=o}return n.path===e?n.data:void 0}getChildren(e){var r;e.startsWith("/")?e=e.slice(1,e.endsWith("/")?-1:void 0):e.endsWith("/")&&(e=e.slice(0,-1));let n=this.root;if(e)for(const i of e.split("/")){const o=(r=n.children)==null?void 0:r.get(i);if(o===void 0)return[];n=o}return n.children===void 0?[]:[...n.children.values()].map(i=>[i.relativePath,i.data])}getDescendants(e){var r;e.startsWith("/")?e=e.slice(1,e.endsWith("/")?-1:void 0):e.endsWith("/")&&(e=e.slice(0,-1));let n=this.root;const i=[];if(e)for(const o of e.split("/")){const c=(r=n.children)==null?void 0:r.get(o);if(c===void 0)return i;n=c}if(n.children!==void 0){let o=a(function(c,l,d){for(const h of c.values()){const S=`${l?`${l}/`:""}${h.relativePath}`;h.data&&d.push([S,h.data]),h.children!==void 0&&o(h.children,S,d)}},"getDescendantsCore");o(n.children,"",i)}return i}has(e){var r;e.startsWith("/")?e=e.slice(1,e.endsWith("/")?-1:void 0):e.endsWith("/")&&(e=e.slice(0,-1));let n=this.root;for(const i of e.split("/")){const o=(r=n.children)==null?void 0:r.get(i);if(o===void 0)return!1;n=o}return n.path===e}set(e,r){var n;e.startsWith("/")?e=e.slice(1,e.endsWith("/")?-1:void 0):e.endsWith("/")&&(e=e.slice(0,-1));let i=this.root,o="";for(const c of e.split("/")){let l=(n=i.children)==null?void 0:n.get(c);o=`${o?`${o}/`:""}${c}`,l===void 0&&(i.children===void 0&&(i.children=new Map),l=new Hd(o,c),i.children.set(c,l)),i=l}i.data=r}}a(ip,"Trie");class Ud{constructor(e,r,n,i,o){if(this.rootUri=e,this.sha=r,this.timestamp=n,this.provider=i,this.trie=new ip,this._hasEntireTree=!1,this._isContentCached=!1,i===void 0)return;const c=[i];i.onDidTriggerContentCaching!==void 0&&i.tryCachingContent!==void 0&&c.push(i.onDidTriggerContentCaching(l=>{(!l||te(l.rootUri)===te(this.rootUri)&&l.sha===this.sha)&&!this.loading&&this.hasEntireTree&&!this.isContentCached&&i.tryCachingContent(this.trie.get.bind(this.trie)).then(d=>this._isContentCached=d,()=>this._isContentCached=!0)})),this._loading=this.load(o==null?void 0:o.path,o==null?void 0:o.recursive).then(l=>(this._hasEntireTree=(l==null?void 0:l.success)?l.recursive:!1,this._hasEntireTree&&setTimeout(()=>{var d;return void((d=i.tryCachingContent)==null?void 0:d.call(i,this.trie.get.bind(this.trie)).then(h=>this._isContentCached=h,()=>this._isContentCached=!0))},0),Ou("_codespaces.webeditor.connectWorkspace",{result:(l==null?void 0:l.success)?"Success":"Failure",errorMessage:this._hasEntireTree?"":"Unable to load entire tree",errorDetail:(l==null?void 0:l.success)===!1?l.error:void 0}),this._loading=void 0,this.preloading=void 0,this.treeSha=(l==null?void 0:l.success)?l.sha:void 0,this.treeSha)),(o==null?void 0:o.preload)&&(this.preloading=new Map([["",this.load("")],[".vscode",this.load(".vscode")]])),this.disposable=m.Disposable.from(...c)}get hasEntireTree(){return this._hasEntireTree}get isContentCached(){return this._isContentCached}get loading(){return this._loading!==void 0}get permissions(){var e;return(e=this.provider)==null?void 0:e.permissions}dispose(){var e;(e=this.disposable)==null||e.dispose()}async get(e){var r;if(e==="")return{mode:"040000",sha:this.treeSha,stat:{type:m.FileType.Directory,size:0,ctime:0,mtime:(r=this.timestamp)!=null?r:Date.now(),permissions:await this.permissions},getContent:void 0};let n=this.trie.get(e);return n!==void 0||(await this.ensureLoaded(e),n=this.trie.get(e)),n}async getChildren(e,r){await this.ensureLoaded(e,!0);const n=(r==null?void 0:r.recursive)?this.trie.getDescendants(e):this.trie.getChildren(e);return(r==null?void 0:r.filter)===void 0?n:n.filter(([,i])=>i.stat.type===r.filter)}async getTreeSha(){return await this.waitUntilLoaded(),this.treeSha}async waitUntilLoaded(){this._loading!==void 0&&await this._loading}async ensureLoaded(e,r=!1){if(this._loading!==void 0){let i;if(this.preloading!==void 0)if(r)i=this.preloading.get(e);else{const o=ja(this.preloading,([c])=>e.startsWith(c)&&e.lastIndexOf("/")===(c?c.length:-1));i=o==null?void 0:o[1]}await(i!=null?i:this._loading)}if(this.hasEntireTree||e==="")return;let n=this.trie.get(e);if(n)return r&&(n==null?void 0:n.loadChildren)?n.loadChildren():void 0;if(await this.ensureLoaded(e.substr(0,e.lastIndexOf("/")),!0),n=this.trie.get(e),r&&(n==null?void 0:n.loadChildren))return n.loadChildren()}async load(e,r=!1){var n;if(((n=this.provider)==null?void 0:n.getTree)===void 0)return;const i=new ut(`FileTree.load(${this.sha}:${e})`);let o;try{i.logStep("Tree query");const c=await this.provider.getTree(e,r);if(c.truncated){L.warn(`Loading file tree for path=${e} was truncated`),i.logStep("Fixing directories",{message:`: Tree=${c.sha};`,suffix:" \u2022 Fixing directories..."});for(const[d,h]of this.trie.getDescendants(""))h.stat.type===m.FileType.Directory&&(h.loadChildren=Bd(()=>this.load(d).then(()=>h.loadChildren=void 0)));return o=` \u2022 Tree=${c.sha} \u2022 Truncated`,{sha:c.sha,recursive:!1,success:!0}}let l;this.permissions!==void 0&&(i.logStep("Permissions query",{message:`: Tree=${c.sha};`,suffix:" \u2022 Waiting for permissions..."}),l=await this.permissions),i.logStep("Filling trie",{suffix:" \u2022 Filling trie..."});for(let{path:d,item:h}of c.tree)if(d!==void 0){switch(d=e?`${e}/${d}`:d,h.stat.permissions=l,h.stat.type){case m.FileType.File:h.getContent=Bd(()=>this.provider.getContent(h));break;case m.FileType.Directory:r||(h.loadChildren=Bd(()=>this.load(d).then(()=>h.loadChildren=void 0)));break}this.trie.set(d,h)}return o=` \u2022 Tree=${c.sha}`,{sha:c.sha,recursive:r,success:!0}}catch(c){return o=`\u2022 Loading for path=${e} failed; ${String(c)}`,{error:c,success:!1}}finally{i.stop(o?{suffix:o}:void 0)}}}a(Ud,"FileTree");var j0=__webpack_require__(7769);const q0="github-pr-owner-number";function z0(t){return`branch.${t}.${q0}`}a(z0,"getMetadataKeyForBranch");const W0=(0,B.loadMessageBundle)(),op=new TextDecoder;class ap{constructor(e,r,n,i,o,c){this.providerService=e,this.rootUri=r,this.sourceControl=n,this.metadata=i,this.changeStore=o,this.github=c,this._onDidChangeSelection=new m.EventEmitter,this._onDidChangeState=new m.EventEmitter,this._objects=new Map,this.disposable=m.Disposable.from(this.sourceControl.onDidChangeSelection(()=>this._onDidChangeSelection.fire()),this.providerService.onDidRefresh(h=>{const S=te(this.rootUri);!h.some(O=>te(O)===S)||this.updateState(this.metadata)}),this.providerService.onDidChangeRepository(async({repository:h})=>{te(this.rootUri)===te(h.uri)&&this.updateState(await h.getMetadata())}),this.changeStore.onDidChange(()=>this.updateState(this.metadata)),this._onDidChangeSelection,this._onDidChangeState),this._inputBox={get value(){return n.inputBox.value},set value(h){n.inputBox.value=h}},this._ui={get selected(){return n.selected},onDidChange:this._onDidChangeSelection.event};const{repo:{owner:l,name:d}}=i;this.remote={name:"origin",fetchUrl:`https://github.com/${l}/${d}.git`,isReadOnly:i.accessLevel<Ne.Write},this.remotes=[this.remote],this._state={HEAD:this.getHEADFromMetadata(i),mergeChanges:[],indexChanges:[],workingTreeChanges:[],onDidChange:this._onDidChangeState.event,rebaseCommit:void 0,refs:[],remotes:this.remotes,submodules:[]},this.updateState(i)}dispose(){this.disposable.dispose()}get inputBox(){return this._inputBox}get state(){return this._state}get ui(){return this._ui}getHEADFromMetadata(e){switch(e.HEAD.type){case Pe.Branch:return{type:Dn.Head,commit:e.HEAD.sha,name:e.HEAD.branch.name,upstream:{name:e.HEAD.branch.name,remote:this.remote.name}};case Pe.RemoteBranch:{const r=e.HEAD.branch.remote.repo.owner,n=e.HEAD.branch.remote.accessLevel<Ne.Write,i=this.remotes.findIndex(o=>o.name===r);return this.remotes.splice(i===-1?this.remotes.length:i,i===-1?0:1,{name:r,fetchUrl:`https://github.com/${e.HEAD.branch.remote.repo.owner}/${e.HEAD.branch.remote.repo.name}.git`,pushUrl:n?void 0:`https://github.com/${e.HEAD.branch.remote.repo.owner}/${e.HEAD.branch.remote.repo.name}.git`,isReadOnly:n}),{type:Dn.RemoteHead,commit:e.HEAD.sha,name:e.HEAD.branch.name,upstream:{name:e.HEAD.branch.name,remote:e.HEAD.branch.remote.repo.owner}}}case Pe.Tag:return{type:Dn.Tag,name:e.HEAD.detached.name,commit:e.HEAD.sha};case Pe.Commit:return{type:Dn.Head,commit:e.HEAD.sha}}}async updateState(e){this.metadata=e;const r=await this.changeStore.getGroupedChanges(this.rootUri,{predicate:l=>l.fileType===m.FileType.File}),n=r.conflicts.map(l=>({uri:l.uri,status:jd(l.type),originalUri:l.uri,renameUri:l.uri})),i=r.staged.map(l=>({uri:l.uri,status:jd(l.type),originalUri:l.uri,renameUri:l.uri})),o=r.working.map(l=>({uri:l.uri,status:jd(l.type),originalUri:l.uri,renameUri:l.uri})),c=Y.get("staging.enabled");this._state={...this._state,HEAD:this.getHEADFromMetadata(e),mergeChanges:n,indexChanges:c?i:[],workingTreeChanges:c?o:[...i,...o]},this._onDidChangeState.fire()}getConfigs(){return Promise.resolve([])}getConfig(e){return this.metadata.HEAD.branch&&this.metadata.pullRequest&&e===z0(this.metadata.HEAD.branch.name)?Promise.resolve(`${this.metadata.repo.owner}#${this.metadata.repo.name}#${this.metadata.pullRequest.id}`):Promise.resolve("")}setConfig(e,r){return Promise.resolve("")}getGlobalConfig(e){throw new Error("Method not implemented.")}async getObjectDetails(e,r){const n=new ut(`IGit.getObjectDetails(${e}, ${r})`);try{return await this.github.getObjectDetails(this.rootUri,e,this.pathToRelativePath(r))}finally{n.stop()}}async detectObjectType(e){var r;const n=new ut(`IGit.detectObjectType(${e})`);try{const i=await this.github.getBlobContent(this.metadata.repo,e);if(!U0(i))return{mimetype:"text/plain"};const c=await(0,j0.fromBuffer)(i);return{mimetype:(r=c==null?void 0:c.mime)!=null?r:"application/octet-stream"}}finally{n.stop()}}async buffer(e,r){const n=new ut(`IGit.buffer(${e}, ${r})`);try{return await this.github.getFileContent(this.rootUri,e,this.pathToRelativePath(r))}finally{n.stop()}}async show(e,r){const n=new ut(`IGit.show(${e}, ${r})`);try{const i=await this.github.getFileContent(this.rootUri,e,this.pathToRelativePath(r));return op.decode(i)}finally{n.stop()}}async getCommit(e){const r=new ut(`IGit.getCommit(${e})`);try{const n=await this.github.getCommit(this.rootUri,e);if(n===void 0)throw new Error(`Unable to find commit for ref "${e}"`);return n}finally{r.stop()}}clean(e){return this._objects.clear(),Promise.resolve()}async apply(e,r){const n=new ut(`IGit.apply(reverse=${r})`);try{return await this.changeStore.applyPatch(this.rootUri,e,r?{reverse:!0}:void 0)}finally{n.stop()}}async diff(e){const r=new ut(`IGit.diff(${e})`);try{return await this.changeStore.createPatch(this.rootUri,void 0,e?{staged:!0}:void 0)}finally{r.stop()}}diffWithHEAD(e){return e?this.diffBetween("","HEAD",e):this.diffBetween("","HEAD")}diffWith(e,r){return r?this.diffBetween("",e,r):this.diffBetween("",e)}diffIndexWithHEAD(e){return e?this.diffBetween("~","HEAD",e):this.diffBetween("~","HEAD")}diffIndexWith(e,r){return r?this.diffBetween("~",e,r):this.diffBetween("~",e)}async diffBetween(e,r,n){if(!n)throw new Error("Method not implemented.");const i=new ut(`IGit.diffBetween(${e}, ${r}, ${n})`);try{const[o,c]=await Promise.all([this.getContent(e,n),this.getContent(r,n)]);return Co(n,o,c)}finally{i.stop()}}async diffBlobs(e,r){const n=new ut(`IGit.diffBlobs(${e}, ${r})`);try{const i=await this.getBlobContent(e),o=await this.getBlobContent(r),c=Co("untitled",i,o);return Promise.resolve(c)}finally{n.stop()}}async getBlobContent(e){const r=new ut(`IGit.getBlobContent(${e})`);try{const n=this._objects.get(e);if(n)return this._objects.delete(e),n;const{repo:i}=this.providerService.getVirtualUriMetadata(this.rootUri),o=await this.github.getBlobContent(i,e);return op.decode(o)}finally{r.stop()}}async getContent(e,r){const n=new ut(`IGit.getContent(${e}, ${r})`);try{const i=this.pathToRelativeUri(r);if(e===""||e==="~"){const o=await this.changeStore.getChange(i);if(o!==void 0&&(e===""||o.staged))return this.changeStore.getContent(i);e="HEAD"}return await this.show(e==="HEAD"?this.metadata.HEAD.sha:e,r)}finally{n.stop()}}async hashObject(e){const r=new ut("IGit.hashObject");try{const n=to(await Yn(e));return this._objects.set(n,e),n}finally{r.stop()}}async createBranch(e,r,n){const i=new ut(`IGit.createBranch(${e}, ${r}, ${n})`);try{n||(n=this.metadata.HEAD.sha);const o=await this.github.createBranch(this.rootUri,e,n);r&&await this.checkout(o)}finally{i.stop()}}deleteBranch(e,r){throw new Error("Method not implemented.")}async getBranch(e){const r=new ut(`IGit.getBranch(${e})`);try{const{branches:n}=await this.github.getBranches(this.rootUri,{query:e,limit:1}),[i]=n;if(i===void 0)throw new Error(`Unable to find branch named "${e}"`);return{type:i.type,name:i.name,commit:i.commit,remote:this.remote.name,upstream:{name:i.name,remote:i.commitUrl}}}finally{r.stop()}}async getBranches(e){var r,n;const i=(n=(r=e.contains)!=null?r:e.pattern)!=null?n:"",o=new ut(`IGit.getBranches(${i})`);try{const{branches:c}=await this.github.getBranches(this.rootUri,{query:i,limit:e.count});if(c.length===0)throw new Error(`Unable to find branches for "${i}"`);return c.map(l=>({type:l.type,name:l.name,commit:l.commit}))}finally{o.stop()}}setBranchUpstream(e,r){throw new Error("Method not implemented.")}getMergeBase(e,r){throw new Error("Method not implemented.")}async status(){}async checkout(e){const r=new ut(`IGit.checkout(${e})`);try{if(await this.github.repositoryObjectExists(this.rootUri,e)){const i=await this.github.switchTo(this.rootUri,e,{openInNewWindow:!1});throw i!==void 0&&await gn(i),new Error("User aborted")}const n=/pr\/(?<remote>.+)\/(?<num>\d+)/.exec(e);if(n==null?void 0:n.groups){const{num:i}=n.groups,{provider:o,repo:c}=this.providerService.getVirtualUriMetadata(this.rootUri),l=this.providerService.getRemoteUri(o.id,{repo:c,pullRequest:{id:i}});if(l!==void 0){const d=await this.providerService.createWorkspaceForRemoteUrl(l.toString());d!==void 0&&await gn(d)}}throw new Error("User aborted")}finally{r.stop()}}addRemote(e,r){var n;let i;const o=this.remotes.findIndex(c=>c.name===e);return o!==-1&&([i]=this.remotes.splice(o,1)),this.remotes.push({name:e,fetchUrl:r,isReadOnly:(n=i==null?void 0:i.isReadOnly)!=null?n:!1}),Promise.resolve()}removeRemote(e){const r=this.remotes.findIndex(n=>n.name===e);return r!==-1&&this.remotes.splice(r,1),Promise.resolve()}renameRemote(e,r){const n=this.remotes.findIndex(o=>o.name===e);if(n===-1)return Promise.resolve();const[i]=this.remotes.splice(n,1);return this.remotes.push({...i,name:r}),Promise.resolve()}async fetch(e,r,n){const i=new ut("IGit.fetch");try{return this.github.fetch(this.rootUri)}finally{i.stop()}}async pull(e){const r=new ut("IGit.pull");try{return this.github.sync(this.rootUri,this.changeStore,{conflictResolution:on.Merge})}finally{r.stop()}}push(e,r,n){return Promise.resolve()}blame(e){throw new Error("Method not implemented.")}async log(e){if((e==null?void 0:e.maxEntries)!==1||(e==null?void 0:e.path)!==void 0)throw new Error("The specified log options are not yet supported.");return[await this.getCommit(this.metadata.HEAD.sha)]}async commit(e,r){const n=new ut("IGit.commit");try{if((r==null?void 0:r.amend)!==void 0||(r==null?void 0:r.empty)!==void 0||(r==null?void 0:r.signCommit)!==void 0||(r==null?void 0:r.signoff)!==void 0)throw new Error("The specified commit options are not yet supported.");const i=(await this.providerService.getCommitOperations(this.rootUri,this.changeStore,{staged:(r==null?void 0:r.all)===!1})).filter(o=>o.fileType===m.FileType.File);if(!i.length){m.window.showInformationMessage(W0("no changes to commit","There are no changes to commit."));return}if(Y.getUseNewCommitApi())await this.github.createAndPushCommit(this.rootUri,e,i,void 0);else{const o=await this.github.createCommit(this.rootUri,e,i);await this.github.pushCommit(this.rootUri,o)}}finally{n.stop()}}pathToRelativePath(e){return this.providerService.getRelativeFilePath(this.rootUri,this.pathToRelativeUri(e))}pathToRelativeUri(e){return We(this.rootUri,K0(e))}}a(ap,"GitHubRepository");const G0=/^\/?([a-zA-Z])(?::\/)(.*)$/,V0=/\\/g;function K0(t){t=m.Uri.file(t).fsPath.replace(V0,"/");const e=G0.exec(t);return e!==null&&([,,t]=e),t.startsWith("/")?t:`/${t}`}a(K0,"normalizePath");function jd(t){switch(t){case Dt.Changed:return ao.MODIFIED;case Dt.Created:return ao.INTENT_TO_ADD;case Dt.Deleted:return ao.DELETED}}a(jd,"opTypeToStatus");var X0=Object.defineProperty,Q0=Object.getOwnPropertyDescriptor,sp=a((t,e,r,n)=>{for(var i=n>1?void 0:n?Q0(e,r):e,o=t.length-1,c;o>=0;o--)(c=t[o])&&(i=(n?c(e,r,i):c(i))||i);return n&&i&&X0(e,r,i),i},"github_provider_decorateClass");const Ws=(0,B.loadMessageBundle)(),cp=/^(?:https?:\/\/)?github\.(?:com|dev)\/(?<owner>[^/]+)\/(?<repo>[^/?#]+)(?:|\.git|\/tree\/(?<tree>[^?#]+)|\/blob\/(?<blob>[^?#]+)|\/commit\/(?<commit>[0-9a-f]{40})|\/pull\/(?<pull>[0-9]+))?(?<extra>[^?#]*)(?:\?(?<query>[^#]*))?(?:#(?<fragment>.*))?$/i,lp=/(?<remoteOwner>[^/:]+)\/?(?<remoteRepo>[^/:]+)?:(?<remoteRef>.*)/,du=["repo","workflow"],hu=1,up=Object.freeze({id:"github",name:"GitHub"});function Gs(t){const{scheme:e,metadata:r}=Qt.decodeAuthority(t,c=>{if(c.v!==void 0)return c;if(typeof c.pr=="string")return{v:hu,ref:{type:tt.PullRequest,id:c.pr},idx:c.idx};if(typeof c.ref=="string")return{v:hu,ref:{type:tt.Tree,id:c.ref},idx:c.idx}}),[,n,i,...o]=t.path.split("/");return{scheme:e,provider:up,name:`${n}/${i}`,repo:{owner:n,name:i},path:o.join("/")||"",ref:r==null?void 0:r.ref,idx:r==null?void 0:r.idx}}a(Gs,"getGitHubMetadata");function Y0(t,e){const{repo:r}=e!=null?e:Gs(t);return t.with({path:`/${r.owner}/${r.name}`,query:"",fragment:""})}a(Y0,"getGitHubRootUri");function qd(t,e,r){const{repo:{owner:n,name:i}}=t instanceof m.Uri?Gs(t):t;return m.Uri.parse(`github://${Qt.encodeAuthority("github",{v:hu,ref:{type:tt.Commit,id:e}})}/${n}/${i}/${r}`)}a(qd,"getGitHubRevisionUri");class fu{constructor(e,r){this.providerService=e,this.tarPit=r,this.fileTreeCache=new Map,this.disposable=m.Disposable.from(e.onDidChangeRepository(n=>{n.reason==="HEAD"&&this.onRefreshOrRepositoryChanged([n.repository.uri])}),e.onDidRefresh(n=>this.onRefreshOrRepositoryChanged(n))),$n&&(this.tarballProxyEndpoint=m.commands.executeCommand("_workbench.getTarballProxyEndpoints").then(n=>n==null?void 0:n["github.com"]))}get isReadonly(){return!1}get scheme(){return"github"}dispose(){this.disposable.dispose()}onRefreshOrRepositoryChanged(e){e=e.filter(r=>Qt.getProviderId(r)===this.scheme),e.length!==0&&(this.fileTreeCache.forEach(r=>r.dispose()),this.fileTreeCache.clear())}async ensureAuthenticated(e=!1){const r=new ut("GitHub.ensureAuthenticated");try{if(this._session===void 0){async function n(){try{return e?await m.authentication.getSession("github",du,{forceNewSession:e}):await m.authentication.getSession("github",du,{createIfNone:!0})}catch(o){L.error(o);try{const c=await m.authentication.getSession("github",du,{createIfNone:!1});if(c!==void 0)return c}catch{}return new Promise(c=>{async function l(){const h=await m.authentication.getSession("github",du,{createIfNone:!0});h!==void 0&&c(h)}a(l,"getSession");const d=m.authentication.onDidChangeSessions(async h=>{h.provider.id==="github"&&(d.dispose(),await l())})})}}a(n,"waitUntilAuthenticated"),this._session=await n();const i=m.authentication.onDidChangeSessions(o=>{if(this._session===void 0){i.dispose();return}o.provider.id==="github"&&(this.clearAuthenticationSession(),i.dispose())})}return this._session}finally{r.stop()}}async getAuthentication(e){const r=await this.ensureAuthenticated();return{provider:up,session:r,getRichNavigationHeaders:()=>({"X-Git-GitHub":`Bearer ${r.accessToken}`})}}clearAuthenticationSession(){this._session=void 0,this._octokit=void 0,this._octokitDefaults=void 0}async reauthenticate(){this.clearAuthenticationSession(),await this.ensureAuthenticated(!0)}async octokit(e){if(this._octokitDefaults===void 0){const n=await this.ensureAuthenticated();if($n){async function i(o,c){if(c.headers!==void 0){const{"user-agent":l,...d}=c.headers;l&&(c.headers=d)}return Ye(o,c)}a(i,"fetchCore"),this._octokitDefaults=al.defaults({auth:`token ${n.accessToken}`,request:{fetch:i}})}else this._octokitDefaults=al.defaults({auth:`token ${n.accessToken}`})}const r=new this._octokitDefaults(e);return(L.logLevel===qe.Debug||L.isDebugging)&&r.hook.wrap("request",async(n,i)=>{var o;const c=new ut(`[GITHUB] ${i.method} ${i.url}`,{log:!1});try{return await n(i)}finally{let l;try{if(typeof i.query=="string"){const d=/(^[^({\n]+)/.exec(i.query);l=` ${(o=d==null?void 0:d[1].trim())!=null?o:i.query}`}}catch{}c.stop({message:l})}}),r}async graphql(e,r){this._octokit===void 0&&(this._octokit=await this.octokit());try{return await this._octokit.graphql(e,r)}catch(n){throw this.handleRequestErrors(n),n}}async request(e,r){this._octokit===void 0&&(this._octokit=await this.octokit());try{return await this._octokit.request(e,r)}catch(n){throw this.handleRequestErrors(n),n}}handleRequestErrors(e){var r,n;if(e instanceof Zi)switch(e.status){case 500:return e.response&&Xr.showGitHubStatus500Message(),!0;case 401:return Xr.showStatus401Message(()=>void this.reauthenticate()),!0;case 403:return Xr.showStatus403Message(()=>void this.reauthenticate()),!0}else if(e instanceof zs&&((n=(r=e.errors)==null?void 0:r[0])==null?void 0:n.type)==="FORBIDDEN")return Xr.showStatus403Message(()=>void this.reauthenticate()),!0;return!1}createIGitRepository(e,r,n,i){return new ap(this.providerService,e,r,n,i,this)}async createMetadata(e,r){var n,i,o,c,l,d;const h=new ut(`GitHub.createMetadata(${e.toString()}, ${r})`);let S;try{let{provider:O,name:I,repo:{owner:P,name:$},ref:N}=Gs(e);(!N||N.type===tt.Commit&&/HEAD/i.test(N.id))&&(N={type:tt.Commit,id:"HEAD"});const U=this.providerService.isInWorkspace(e);let W,V;Y.get("experimental.prefetch")&&U&&(r?W=r:(N.type===tt.Commit||N.type===tt.Tree)&&(W=N.id),W&&(h.log({suffix:` \u2022 Prefetching tree for ${W}...`}),this.getFileTree(e,void 0,{cache:!0,recursive:!0,prefetched:{metadata:new Promise(Ie=>V=Ie),repo:{owner:P,name:$},HEAD:{sha:W},timestamp:Date.now()}})));const ie=await this.getRepositoryInfo(P,$,U,N.type===tt.PullRequest?{pr:Number(N.id)}:{ref:N.id});if(ie===void 0)throw S=" \u2022 Aborted; Unable to get repository info",new Error(`Cannot get metadata for Uri(${e.toString()}); Unable to get repository info`);let oe;if(r)oe=r;else if(N.type===tt.Commit||N.type===tt.Tree&&ie.ref===void 0)oe=N.id;else if(oe=(i=(n=ie.ref)==null?void 0:n.sha)!=null?i:ie.defaultBranch.sha,oe===void 0)throw S=" \u2022 Aborted; Unable to get repository revision",new Error(`Cannot get metadata for Uri(${e.toString()}); Unable to get repository revision`);let ge;if(((o=ie.ref)==null?void 0:o.prefix)==="refs/heads/")ge={type:Pe.Branch,name:ie.ref.name,sha:oe,branch:{name:ie.ref.name,sha:ie.ref.sha}};else if(((c=ie.ref)==null?void 0:c.prefix)==="refs/remotes/"){if(!ie.ref.remote)throw S=" \u2022 Aborted; Unable to get remote info",new Error(`Cannot get metadata for Uri(${e.toString()}); Unable to get remote info`);ge={type:Pe.RemoteBranch,name:`${ie.ref.remote.repo.owner}${ie.ref.remote.repo.name!==$?`/${ie.ref.remote.repo.name}`:""}:${ie.ref.name}`,sha:oe,branch:{name:ie.ref.name,sha:ie.ref.sha,remote:ie.ref.remote}}}else((l=ie.ref)==null?void 0:l.prefix)==="refs/tags/"?ge={type:Pe.Tag,name:ie.ref.name,sha:oe,detached:{type:Pe.Tag,name:ie.ref.name}}:ge={type:Pe.Commit,name:wt(oe),sha:oe,detached:{type:Pe.Commit,name:wt(oe)}};if(W!==void 0&&W!==ge.sha){const Ie=this.asFileTreeKey(e,W),Oe=this.fileTreeCache.get(Ie);Oe&&!Nr(W)&&ge.sha===((d=ge.branch)==null?void 0:d.sha)?(h.log({suffix:` \u2022 Updating prefetched tree for ${W}, since HEAD was resolved; HEAD=${ge.sha}`}),this.fileTreeCache.set(this.asFileTreeKey(e,ge.sha),Oe),this.fileTreeCache.delete(Ie)):(h.log({suffix:` \u2022 Removing prefetched tree for ${W}, since the HEAD changed; HEAD=${ge.sha}`}),this.fileTreeCache.delete(Ie),Oe==null||Oe.dispose())}const ke={version:Ke.schemaVersion,timestamp:Date.now(),provider:O,name:I,repo:ie.repo,user:ie.user,accessLevel:ie.accessLevel,HEAD:ge,defaultBranch:ie.defaultBranch,pullRequest:ie.pullRequest};return S=` \u2022 HEAD=${ge.sha}`,V==null||V(ke),ke}finally{h.stop(S?{suffix:S}:void 0)}}getMetadata(e){return this.providerService.getMetadata(e)}getRemoteWorkspaceSourceProviders(){return[{name:"GitHub",icon:"$(github)",label:Ws("open repo from","Open Repository from {0}","GitHub"),placeholder:Ws("pick repo","Choose a repository"),provideSources:async(e,r,n,i)=>{n=n!=null?n:"";let o;const c=n==null?void 0:n.indexOf("/");return c!==-1&&(o=n.substring(0,c),n=n.substr(c+1)),(await this.searchRepositoriesQuery(n,{...i,user:o})).map(d=>({providerId:"github",name:d.repoWithOwner,icon:"$(repo)",description:`${d.fork?`$(repo-forked) ${d.fork}`:""}${d.stars>0?`${d.fork?" \u2022 ":""}$(star-full) ${d.stars}`:""}`,detail:d.description,url:d.url}))}},{name:"GitHub",icon:"$(github)",label:Ws("open pr from","Open Pull Request from {0}","GitHub"),placeholder:Ws("pick pr","Choose a pull request"),provideSources:async(e,r,n,i)=>{n=n!=null?n:"";let o;const c=n==null?void 0:n.indexOf("/");return c!==-1&&(o=n.substring(0,c),n=n.substr(c+1)),(await this.searchPullRequestsQuery(n,{user:o})).map(d=>({providerId:"azurerepos",name:d.title,icon:"$(git-pull-request)",description:d.reasons.length!==0?d.reasons.sort().join(", "):void 0,detail:`${d.repoWithOwner} #${d.number}`,url:d.url}))}}]}canOpenRemoteUrl(e){const r=cp.exec(e);if((r==null?void 0:r.groups)===void 0)return;const{blob:n,commit:i,pull:o,tree:c}=r.groups;return o?nt.PullRequest:i?nt.Commit:c?nt.Branch:n?nt.File:nt.Repository}async createWorkspaceForRemoteUrl(e,r=$t.CurrentWindow){const n=cp.exec(e);if((n==null?void 0:n.groups)===void 0)return;let{owner:i,repo:o,blob:c,commit:l,pull:d,tree:h,fragment:S}=n.groups;const O=await this.validateOwnerAndRepoAndSplitRefFromPath(i,o,h!=null?h:c);if(O===void 0)return;let I,P;if({owner:i,repo:o,ref:P,path:I}=O,h||c){if(I&&S&&c){const U=/L(?<start>\d+)(?:-L(?<end>\d+))?/.exec(S);if(U==null?void 0:U.groups){const{start:W,end:V}=U.groups;I+=`:${W}${V!==void 0?`-${V}`:""}`}}}else l?P={type:tt.Commit,id:l}:d&&(P={type:tt.PullRequest,id:d});const $=this.providerService.createVirtualUri("github",{repo:{owner:i,name:o},ref:P});return{name:(await this.getMetadata($)).name,uri:$,location:r,filesToOpen:I?[I]:void 0}}createVirtualUri(e,{repo:r,ref:n,idx:i},o){const c=n!==void 0||i!==void 0?{v:hu}:void 0;return c&&(n&&(c.ref={...n,type:n.type===tt.Branch||n.type===tt.Tag?tt.Tree:n.type}),i&&(c.idx=i)),e.with({authority:Qt.encodeAuthority("github",c),path:`/${r.owner}/${r.name}${(o==null?void 0:o.startsWith("/"))?o:o?`/${o}`:""}`})}getRemoteUri(e){const r=`https://github.com/${e.repo.owner}/${e.repo.name}`,n=e.path?"blob":"tree",i=e.path?`/${e.path}`:"";return e.clone?m.Uri.parse(`${r}.git`):e.pullRequest?m.Uri.parse(`${r}/pull/${e.pullRequest.id}`):e.branch?m.Uri.parse(`${r}/${n}/${e.branch}${i}`):e.tag?m.Uri.parse(`${r}/${n}/${e.tag}${i}`):e.sha?m.Uri.parse(`${r}/${n}/${e.sha}${i}`):m.Uri.parse(r)}getProviderRootUri(e){return Y0(e)}getRelativeFilePath(e,r){const{path:n}=Gs(e),{path:i}=Gs(We(e,r));return n.length!==0&&i!==n&&i.startsWith(n)?i.slice(n.length+1):i}getVirtualUriMetadata(e){const{provider:r,name:n,repo:i,ref:o}=Gs(e);return{provider:r,name:n,repo:i,ref:o}}async getModeRefType(e,r){const{HEAD:n,pullRequest:i}=await(r!=null?r:this.getMetadata(e));switch(n.type){case Pe.Branch:return i!==void 0?ne.PullRequestBranch:ne.Branch;case Pe.RemoteBranch:return i!==void 0?ne.PullRequestRemoteBranch:ne.RemoteBranch;case Pe.Tag:return ne.Tag;case Pe.Commit:return ne.Commit}}async createBranch(e,r,n,i){try{const{repo:{owner:o,name:c}}=i!=null?i:await this.getMetadata(e);return r.startsWith("refs/heads/")||(r=`refs/heads/${r}`),(await this.request("POST /repos/{owner}/{repo}/git/refs",{owner:o,repo:c,ref:r,sha:n})).data.ref.substr(11)}catch(o){throw o instanceof Zi&&o.status===422?o.message==="Reference already exists"?new Be(o,!0):new Be(o,!1):(L.error(o),o)}}async createAndPushCommit(e,r,n,i,o){var c;const l=new ut(`GitHub.createAndPushCommit(${e.toString()}${o?`, fork=${o.repo.owner}/${o.repo.name}`:""})`);if(n=n.filter(h=>h.fileType===m.FileType.File),n.length===0)throw l.stop({message:"Aborted; No changes to commit"}),new _t("No changes to commit");let d;try{const h=await this.getMetadata(e);let S;if(i!==void 0)S=i;else{if(h.HEAD.detached&&!h.HEAD.branch)throw new Ot("Unable to commit; no current branch");S=h.HEAD.branch.name}let O;if(o)O=`${o.repo.owner}/${o.repo.name}`;else if(h.HEAD.type===Pe.RemoteBranch&&h.HEAD.branch.remote.accessLevel>=Ne.Write){const{owner:W,name:V}=h.HEAD.branch.remote.repo;O=`${W}/${V}`}else O=`${h.repo.owner}/${h.repo.name}`;const I=[],P=[];for(const W of n)switch(W.type){case Dt.Created:case Dt.Changed:I.push({path:W.path,contents:Ci(await W.content)});break;case Dt.Deleted:P.push({path:W.path});break}const $={branch:{branchName:S,repositoryNameWithOwner:O},message:{headline:r},fileChanges:{additions:I,deletions:P},expectedHeadOid:h.HEAD.sha},N=`mutation($commitInput: CreateCommitOnBranchInput!) {
	createCommitOnBranch(input: $commitInput) {
		commit {
			oid
		}
		ref {
			name
		}
	}
}`,U=await this.graphql(N,{commitInput:$});if(d=U==null?void 0:U.createCommitOnBranch.commit.oid,!d)throw new vr;return i===void 0&&!h.HEAD.detached&&d!==void 0&&await this.fastForwardTo(e,d,h),d}catch(h){if(h instanceof zs){const S=(c=h.errors)==null?void 0:c[0];if((S==null?void 0:S.type)==="STALE_DATA"&&S.message.includes("Pull and try again"))throw new Le(h)}throw L.error(h),h}finally{l.stop(d?{message:`: Created and pushed commit ${d}`}:void 0)}}async createCommit(e,r,n,i){const o=new ut(`GitHub.createCommit(${e.toString()}${i?`, fork=${i.repo.owner}/${i.repo.name}`:""})`);if(n=n.filter(l=>l.fileType===m.FileType.File),n.length===0)throw o.stop({message:"Aborted; No changes to commit"}),new _t("No changes to commit");let c;try{const l=await this.getMetadata(e);let d,h,S;i?({repo:{owner:d,name:h}}=i,S=await this.getFileTree(this.createVirtualUri(e,i),l.HEAD.sha)):l.HEAD.type===Pe.RemoteBranch&&l.HEAD.branch.remote.accessLevel>=Ne.Write?({owner:d,name:h}=l.HEAD.branch.remote.accessLevel===Ne.WriteToPullRequest?l.repo:l.HEAD.branch.remote.repo,S=await this.getFileTree(this.createVirtualUri(e,{repo:l.HEAD.branch.remote.repo}),l.HEAD.sha)):({repo:{owner:d,name:h}}=l,S=await this.getFileTree(e,l.HEAD.sha));const O=await S.getTreeSha();if(!Nr(O))throw new Error(`Unable to create commit based on tree sha ${O}`);o.logStep("Creating Blobs",{message:`: Committing ${n.length} changes onto commit ${l.HEAD.sha} based on tree ${O}`,suffix:" \u2022 Creating blobs..."});const I=[];async function P(W){var V;try{const ie=await this.request("POST /repos/{owner}/{repo}/git/blobs",{owner:d,repo:h,encoding:"base64",content:Ci(await W.content),mediaType:{format:"raw"}});let oe;if(W.type===Dt.Changed){const ge=await S.get(W.path);oe=(V=ge==null?void 0:ge.mode)!=null?V:"100644"}else oe="100644";I.push({path:W.path,mode:oe,type:"blob",sha:ie.data.sha})}catch(ie){throw L.error(ie,`Failed to create blob for ${W.path}`),ie}}a(P,"createOrUpdateBlob");const $=[];for(const W of n)switch(W.type){case Dt.Created:case Dt.Changed:{$.push(P.call(this,W));break}case Dt.Deleted:{I.push({path:W.path,mode:"100644",type:"blob",sha:null});break}}await Promise.all($),o.logStep("Creating tree",{message:`: Created ${$.length} blobs;`,suffix:` \u2022 Creating tree based on ${O}...`});const N=await this.request("POST /repos/{owner}/{repo}/git/trees",{owner:d,repo:h,base_tree:O,tree:I});return o.logStep("Creating commit",{message:`: Created tree ${N.data.sha};`,suffix:" \u2022 Creating commit..."}),c=(await this.request("POST /repos/{owner}/{repo}/git/commits",{owner:d,repo:h,message:r,tree:N.data.sha,parents:[l.HEAD.sha]})).data.sha,c}catch(l){throw L.error(l),l}finally{o.stop(c?{message:`: Created commit ${c}`}:void 0)}}async createPullRequest(e,r,n,i,o){var c,l,d;const h=new ut(`GitHub.createPullRequest(${e.toString()}, ${r}${o?`, fork=${o.repo.owner}/${o.repo.name}`:""})`);try{const{repo:{owner:S,name:O},HEAD:{branch:I},defaultBranch:P}=await this.getMetadata(e),$=await this.request("POST /repos/{owner}/{repo}/pulls",{owner:S,repo:O,base:`refs/heads/${(c=I==null?void 0:I.name)!=null?c:P.name}`,head:o?`${o.repo.owner}:${r}`:r,title:n,draft:(l=i==null?void 0:i.draft)!=null?l:!1,maintainer_can_modify:(d=i==null?void 0:i.canMaintainerModify)!=null?d:!0});return{id:$.data.number.toString(),uri:m.Uri.parse($.data.html_url)}}catch(S){throw L.error(S),S}finally{h.stop()}}async fetch(e,r){const{fetched:n,metadata:i}=await this.fetchCore(e,!1,r);n&&await this.providerService.updateMetadata(e,i)}async fetchCore(e,r,n){var i,o,c,l,d,h,S,O,I;const{force:P,to:$}={...n,force:r||(n==null?void 0:n.force)},N=new ut(`GitHub.fetch(${e.toString()}, force=${P}, to=${$})`);let U;try{const W=await this.getMetadata(e);if(W.HEAD.detached)return U=" \u2022 Skipped; detached HEAD",{fetched:!1,metadata:W};const V=await this.getBranchTips(e);if(!V)throw U=" \u2022 Unable to fetch branch tips",new xt(r);if(!P&&!$&&((i=V.defaultBranch)==null?void 0:i.sha)!==void 0&&V.defaultBranch.sha===W.defaultBranch.sha&&((o=V.branch)==null?void 0:o.sha)!==void 0&&V.branch.sha===W.HEAD.branch.sha&&(W.HEAD.sha===W.HEAD.branch.sha||W.state!==void 0))return U=" \u2022 No changes detected",{fetched:!1,metadata:W};let ie;if(((c=V.defaultBranch)==null?void 0:c.sha)!==void 0&&V.defaultBranch.sha!==W.defaultBranch.sha&&(ie={defaultBranch:{...W.defaultBranch,sha:V.defaultBranch.sha}}),((l=V.branch)==null?void 0:l.sha)===void 0){if(U=" \u2022 Unable to find branch tip",P)throw new xt(r);return ie!==void 0?{fetched:!0,metadata:{...W,...ie}}:{fetched:!1,metadata:W}}if(V.branch.sha!==W.HEAD.branch.sha&&(ie={...ie,HEAD:{...W.HEAD,branch:{...W.HEAD.branch,sha:V.branch.sha},detached:void 0}}),V.branch.sha===((d=n==null?void 0:n.to)!=null?d:W.HEAD.sha))return U=" \u2022 Up to date",W.state!==void 0||ie!==void 0?{fetched:!0,metadata:{...W,...ie,state:void 0}}:{fetched:!1,metadata:W};N.logStep("Fetching upstream changes");try{const oe=await this.getAheadBehindState(e,W,{base:(h=n==null?void 0:n.to)!=null?h:W.HEAD.sha,head:(I=(O=(S=ie==null?void 0:ie.HEAD)==null?void 0:S.branch)==null?void 0:O.sha)!=null?I:W.HEAD.branch.sha});return U=` \u2022 Changes detected; ${oe==null?void 0:oe.behind} commits behind`,{fetched:!0,metadata:{...W,...ie,state:oe?{ahead:oe.ahead,behind:oe.behind,incomingChanges:oe.incomingChanges}:void 0}}}catch(oe){if(U=` \u2022 Failed fetching upstream changes; ${String(oe)}`,P)throw new xt(r);return ie!==void 0?{fetched:!0,metadata:{...W,...ie}}:{fetched:!1,metadata:W}}}finally{N.stop(U?{suffix:U}:void 0)}}async fork(e){try{const{repo:{owner:r,name:n}}=await this.getMetadata(e),i=await this.request("POST /repos/{owner}/{repo}/forks",{owner:r,repo:n});let o;for(;;){try{if(o=await this.getRepositoryInfo(i.data.owner.login,i.data.name,!1),o!==void 0)break}catch{}await new Promise(c=>setTimeout(c,250))}return{name:`${i.data.owner.login}/${i.data.name}`,repo:{owner:i.data.owner.login,name:i.data.name},url:i.data.url}}catch(r){throw L.error(r),r}}async getBranches(e,r){var n,i,o;try{const{repo:{owner:c,name:l}}=await this.getMetadata(e),d=`query getBranches(
	$owner: String!
	$repo: String!
	$branchQuery: String!
	$cursor: String
	$limit: Int = 100
) {
	repository(owner: $owner, name: $repo) {
		refs(query: $branchQuery, refPrefix: "refs/heads/", first: $limit, after: $cursor) {
			pageInfo {
				endCursor
				hasNextPage
			}
			nodes {
				name
				target {
					oid
				}
			}
		}
	}
}`,h=await this.graphql(d,{owner:c,repo:l,branchQuery:(n=r==null?void 0:r.query)!=null?n:"",cursor:r==null?void 0:r.cursor,limit:Math.min(100,(i=r==null?void 0:r.limit)!=null?i:100)});if(h===void 0)return{branches:[]};const S=(o=h.repository)==null?void 0:o.refs;if(S===void 0)return{branches:[]};const O=S.nodes.map(I=>({type:Dn.Head,name:I.name,commit:I.target.oid,commitUrl:I.target.commitUrl}));return{paging:{cursor:S.pageInfo.endCursor,more:S.pageInfo.hasNextPage},branches:O}}catch(c){return{branches:[]}}}async getCommit(e,r){var n;try{const{HEAD:i,repo:{owner:o,name:c}}=await this.getMetadata(e),l=`query getCommit(
	$owner: String!
	$repo: String!
	$ref: GitObjectID!
) {
	repository(name: $repo owner: $owner) {
		object(oid: $ref) {
			...on Commit {
				oid
				message
				parents(first: 100) {
					nodes {
						oid
					}
				}
				author {
					date
					email
					name
				}
				committer {
					date
				}
			}
		}
	}
}`;r.toUpperCase()==="HEAD"&&(r=i.sha);const d=await this.graphql(l,{owner:o,repo:c,ref:r});if(d===void 0)return;const h=(n=d.repository)==null?void 0:n.object;return h===void 0?void 0:{hash:h.oid,message:h.message,parents:h.parents.nodes.map(S=>S.oid),authorDate:new Date(h.author.date),authorEmail:h.author.email,authorName:h.author.name,commitDate:new Date(h.committer.date)}}catch(i){return}}async getCommits(e,r){var n,i,o;try{const{HEAD:c,repo:{owner:l,name:d}}=await this.getMetadata(e),h=`query getCommits(
	$owner: String!
	$repo: String!
	$ref: GitObjectID!
	$path: String
	$cursor: String
	$limit: Int = 100
) {
	repository(name: $repo, owner: $owner) {
		object(oid: $ref) {
			... on Commit {
				history(first: $limit, path: $path, after: $cursor) {
					pageInfo {
						endCursor
						hasNextPage
					}
					nodes {
						... on Commit {
							...commit
						}
					}
				}
			}
		}
	}
}

fragment commit on Commit {
	oid
	message
	parents(first: 100) {
		nodes {
			oid
		}
	}
	author {
		date
		email
		name
	}
	committer {
		date
	}
}
`;let S=r==null?void 0:r.ref;(S==null?void 0:S.toUpperCase())==="HEAD"&&(S=c.sha);const O=await this.graphql(h,{owner:l,repo:d,ref:S,cursor:r==null?void 0:r.cursor,path:r==null?void 0:r.path,limit:Math.min(100,(n=r==null?void 0:r.limit)!=null?n:100)});if(O===void 0)return;const I=(o=(i=O.repository)==null?void 0:i.object)==null?void 0:o.history;if(I===void 0)return;const P=I.nodes.map($=>({hash:$.oid,message:$.message,parents:$.parents.nodes.map(N=>N.oid),authorDate:new Date($.author.date),authorEmail:$.author.email,authorName:$.author.name,commitDate:new Date($.committer.date)}));return{paging:{cursor:I.pageInfo.endCursor,more:I.pageInfo.hasNextPage},commits:P}}catch(c){return}}async getBlobContent(e,r){try{const n=await this.request("GET /repos/{owner}/{repo}/git/blobs/{file_sha}",{owner:e.owner,repo:e.name,file_sha:r});return ei(n.data.content)}catch(n){throw L.logLevel===qe.Debug&&L.error(n),n}}async getFileContent(e,r,n){try{let i;if(r&&n&&!this.hasFileTree(e,r)){const o=this.providerService.getProviderRootUri(e);n.startsWith("/")&&(n=n.slice(1));let c=(0,Qv.dirname)(n);(c==="."||c==="/")&&(c=""),i=await(await this.getFileTree(o,r,{path:c,cache:!1,recursive:!1})).get(n)}else{const[o,{path:c}]=await Promise.all([this.getFileTree(e,r),n?{path:void 0}:this.providerService.getMetadata(e)]);i=await o.get(n!=null?n:c)}if((i==null?void 0:i.sha)===void 0)throw m.FileSystemError.FileNotFound(e);return await i.getContent()}catch(i){throw L.logLevel===qe.Debug&&L.error(i),i}}async getFileList(e,r,n){const i=new ut(`GitHub.getFileList(${e.toString()}${n?`, ${n}`:""})`);try{const{repo:{owner:o,name:c},HEAD:{sha:l}}=await this.getMetadata(e),d=await this.request("GET /repos/{owner}/{repo}/git/tree-file-list/{treeish}",{owner:o,repo:c,treeish:`${n!=null?n:l}${r?`:${r}`:""}`});return d.status!==200?[]:d.data}catch(o){return L.error(o),[]}finally{i.stop()}}hasFileTree(e,r){return r?this.fileTreeCache.has(this.asFileTreeKey(e,r)):this.getMetadata(e).then(n=>this.fileTreeCache.has(this.asFileTreeKey(e,n.HEAD.sha)))}async getFileTree(e,r,n){var i,o,c,l,d;const h=this.providerService.isInWorkspace(e);let S=(i=n==null?void 0:n.cache)!=null?i:h,O,I,P;if(S||!r){const W=(c=(o=n==null?void 0:n.prefetched)==null?void 0:o.metadata)!=null?c:this.getMetadata(e);O=h?this.getFileTreePermissions(e,W):void 0;let V;({repo:I,HEAD:{sha:V},timestamp:P}=(l=n==null?void 0:n.prefetched)!=null?l:await W),r&&V!==r?(S=!1,P=Date.now()):r=V}else({repo:I}=(d=n==null?void 0:n.prefetched)!=null?d:this.providerService.getVirtualUriMetadata(e)),P=Date.now();const $=this.asFileTreeKey(e,r),N=this.providerService.getProviderRootUri(e),U=new ut(`GitHub.getFileTree(${$}): ${e.toString()}`,{log:!1,logLevel:qe.Debug});try{let W=a(function(){var ie;const oe=new ut(`GitHub.createFileTree(${$})`);let ge,ke;S&&h&&(ge=new m.EventEmitter,ke=m.Disposable.from(this.tarPit.onDidChangeIndexingEnablement(()=>ge.fire()),this.tarPit.onDidDownloadTar(Oe=>ge.fire({rootUri:this.providerService.getProviderRootUri(Oe.rootUri),sha:Oe.sha}))));const Ie={dispose:()=>ke==null?void 0:ke.dispose(),permissions:O,getContent:Oe=>this.getBlobContent(I,Oe.sha),getTree:async(Oe,Ze)=>{const $e=await this.request("GET /repos/{owner}/{repo}/git/trees/{tree_sha}",{owner:I.owner,repo:I.name,recursive:Ze?"1":void 0,tree_sha:`${r}${Oe?`:${Oe}`:""}`});return $e.data.truncated?{sha:$e.data.sha,truncated:!0}:{sha:$e.data.sha,truncated:!1,tree:eo($e.data.tree,ze=>{var st;return{path:ze.path,item:{mode:ze.mode,sha:ze.sha,stat:{type:J0(ze.type),size:(st=ze.size)!=null?st:0,ctime:0,mtime:P,permissions:void 0}}}})}},onDidTriggerContentCaching:ge==null?void 0:ge.event,tryCachingContent:S&&h?async Oe=>{const Ze=Y.get("experimental.fs.useTars");if(Ze!=="always"&&Ze!=="ifAvailable")return!1;const $e=new ut(`FileTree.loadAllContent(${r})`);let ze;try{let st;if(Ze==="ifAvailable"){if($e.logStep("Tar cache query"),st=await this.tarPit.getCachedTar(N,r),st===void 0)return ze=" \u2022 No cached Tar",!1}else $e.logStep("Tar query"),st=await this.tarPit.getTar(N,r);$e.logStep("Updating content",{suffix:" \u2022 Updating content..."});for(const Mt of st.entries){const tn=Oe(Mt.header.fullFileName);if(tn===void 0)continue;const Mn=Mt.dataAsBytes;tn.getContent=()=>Mn}return!0}catch(st){return ze=` \u2022 Failed ${String(st)}`,!1}finally{$e.stop(ze?{suffix:ze}:void 0)}}:void 0};try{return new Ud(N,r,P,Ie,{path:n==null?void 0:n.path,recursive:(ie=n==null?void 0:n.recursive)!=null?ie:S,preload:S||(n==null?void 0:n.recursive)})}catch(Oe){return L.error(Oe),new Ud(N,r,P,void 0)}finally{oe.stop()}},"createFileTree"),V=this.fileTreeCache.get($);return V!==void 0||(V=W.call(this),S&&this.fileTreeCache.set($,V)),V}finally{U.stop()}}async getFileTreePermissions(e,r){if(this.providerService.getModeConfig(e,await this.getModeRefType(e,r)).display===j.Edit)return;const i=await this.providerService.getIndexMetadata(e);return Zt.isActive(i)?m.FilePermission.Readonly:void 0}async getFork(e){var r,n,i;try{const{repo:{owner:o,name:c}}=await this.getMetadata(e),l=`query getFork(
	$owner: String!
	$repo: String!
) {
	repository(owner: $owner, name: $repo) {
		forks(affiliations: OWNER, first: 1) {
			nodes {
				owner {
					login
				}
				name
				url
			}
		}
	}
}`,d=await this.graphql(l,{owner:o,repo:c});if(d===void 0)return;const[h]=(i=(n=(r=d.repository)==null?void 0:r.forks)==null?void 0:n.nodes)!=null?i:[];return h===void 0?void 0:{name:`${h.owner.login}/${h.name}`,repo:{owner:h.owner.login,name:h.name},url:h.url}}catch(o){return}}async getIncomingChanges(e){var r,n;return(n=(r=(await this.getMetadata(e)).state)==null?void 0:r.incomingChanges)!=null?n:[]}async compareCommits(e,r){const n=await this.getMetadata(e),i=await this.getAheadBehindState(e,n,{base:r.base,head:r.compare});return i==null?void 0:i.incomingChanges}async getAheadBehindState(e,r,n){var i,o,c,l,d;const{base:h,head:S}={base:r.HEAD.sha,head:(i=r.HEAD.branch)==null?void 0:i.sha,...n},O=new ut(`GitHub.getAheadBehindState(${e.toString()}, base=${h}, head=${S})`);let I,P;try{if(!S){I=` \u2022 Skipped; Unsupported HEAD type (${r.HEAD.type})`;return}const $=await this.request("GET /repos/{owner}/{repo}/compare/{base}...{head}",{owner:r.repo.owner,repo:r.repo.name,base:h,head:S}),N=[];for(const U of(o=$.data.files)!=null?o:[])switch(U.status){case"added":case"copied":N.push({uri:m.Uri.joinPath(e,U.filename),type:Dt.Created});break;case"removed":N.push({uri:m.Uri.joinPath(e,U.filename),type:Dt.Deleted});break;case"modified":N.push({uri:m.Uri.joinPath(e,U.filename),type:Dt.Changed});break;case"renamed":N.push({uri:m.Uri.joinPath(e,U.filename),type:Dt.Created}),N.push({uri:m.Uri.joinPath(e,U.previous_filename),type:Dt.Deleted});break;default:L.warn(`GitHub.getAheadBehindState(${e.toString()}, base=${h}, head=${S}): Unknown file status encountered '${U.status}'`);break}return P={ahead:(c=$.data.behind_by)!=null?c:0,behind:(l=$.data.ahead_by)!=null?l:0,incomingChanges:N},P}catch($){throw I=` \u2022 Failed; ${String($)}`,L.error($),$}finally{O.stop({suffix:I!=null?I:` \u2022 ${(d=P==null?void 0:P.behind)!=null?d:0} commits behind`})}}async getObjectDetails(e,r,n){var i;try{const o=await this.getFileTree(e,r);n?n=this.providerService.getRelativeFilePath(e,this.providerService.createRelativeUri(e,n)):{path:n}=await this.providerService.getMetadata(e);const c=await o.get(n);if((c==null?void 0:c.mode)===void 0||(c==null?void 0:c.sha)===void 0)throw new Error(`Cannot get details of ${n} in ${r}`);return{mode:c.mode,object:c.sha,size:(i=c.stat.size)!=null?i:0}}catch(o){throw L.error(o),o}}async getPullRequest(e,r){const{repo:{owner:n,name:i}}=await this.getMetadata(e);return this.getPullRequestCore(n,i,r)}async getPullRequestCore(e,r,n){var i,o,c,l,d,h,S;try{const O=`query getPullRequest(
	$owner: String!
	$repo: String!
	$pr: Int!
) {
	repository(name: $repo, owner: $owner) {
		pullRequest(number: $pr) {
			author {
				login
				avatarUrl
				url
			}
			permalink
			number
			title
			state
			updatedAt
			closedAt
			mergedAt
			repository {
				name
				owner {
					login
				}
			}
			baseRef {
				name
			}
			baseRefName
			baseRefOid
			baseRepository {
				name
				owner {
					login
				}
			}
			headRef {
				name
			}
			headRefName
			headRefOid
			headRepository {
				name
				owner {
					login
				}
			}
			headRepositoryOwner {
				login
			}
		}
	}
}`,I=await this.graphql(O,{owner:e,repo:r,number:Number(n)}),P=(i=I==null?void 0:I.repository)==null?void 0:i.pullRequest;return P?{author:{name:P.author.login,avatarUrl:P.author.avatarUrl,url:P.author.url},closedAt:P.closedAt?new Date(P.closedAt):void 0,mergedAt:P.mergedAt?new Date(P.mergedAt):void 0,id:P.number.toString(),repo:{name:P.repository.name,owner:P.repository.owner.login},state:zd(P.state),title:P.title,updatedAt:new Date(P.updatedAt),url:P.permalink,refs:{base:{owner:P.baseRepository.owner.login,repo:P.baseRepository.name,branch:P.baseRefName,sha:P.baseRefOid,exists:P.baseRef!=null},head:{owner:(d=(l=(o=P.headRepository)==null?void 0:o.owner.login)!=null?l:(c=P.headRepositoryOwner)==null?void 0:c.login)!=null?d:"<unknown>",repo:(S=(h=P.headRepository)==null?void 0:h.name)!=null?S:P.baseRepository.name,branch:P.headRefName,sha:P.headRefOid,exists:P.headRef!=null}}}:void 0}catch(O){L.error(O);return}}async getPullRequestForBranch(e,r,n){var i,o,c,l,d;try{const{repo:{owner:h,name:S}}=await this.getMetadata(e),O=`query getPullRequestForBranch(
	$owner: String!
	$repo: String!
	$branch: String!
	$maxCount: Int!
	$states: [PullRequestState!]
) {
	repository(name: $repo, owner: $owner) {
		refs(query: $branch, refPrefix: "refs/heads/", first: 1) {
			nodes {
				associatedPullRequests(first: $maxCount, orderBy: {field: UPDATED_AT, direction: DESC}, states: $states) {
					nodes {
						author {
							login
							avatarUrl
							url
						}
						permalink
						number
						title
						state
						updatedAt
						closedAt
						mergedAt
						repository {
							isFork
							name
							owner {
								login
							}
						}
					}
				}
			}
		}
	}
}`,I=await this.graphql(O,{owner:h,repo:S,branch:r,maxCount:(i=n==null?void 0:n.maxCount)!=null?i:1,states:Z0(n==null?void 0:n.include)}),P=(d=(l=(c=(o=I==null?void 0:I.repository)==null?void 0:o.refs.nodes[0])==null?void 0:c.associatedPullRequests)==null?void 0:l.nodes)==null?void 0:d.filter(N=>!N.repository.isFork||N.repository.owner.login===h);if(P==null||P.length===0)return;P.length>1&&P.sort((N,U)=>(N.repository.owner.login===h?-1:1)-(U.repository.owner.login===h?-1:1)||(N.state==="OPEN"?-1:1)-(U.state==="OPEN"?-1:1)||new Date(U.updatedAt).getTime()-new Date(N.updatedAt).getTime());const[$]=P;return{author:{name:$.author.login,avatarUrl:$.author.avatarUrl,url:$.author.url},closedAt:$.closedAt?new Date($.closedAt):void 0,mergedAt:$.mergedAt?new Date($.mergedAt):void 0,id:$.number.toString(),repo:{name:$.repository.name,owner:$.repository.owner.login},state:zd($.state),title:$.title,updatedAt:new Date($.updatedAt),url:$.permalink}}catch(h){L.error(h);return}}async getTags(e,r){var n,i,o;try{const{repo:{owner:c,name:l}}=await this.getMetadata(e),d=`query getTags(
	$owner: String!
	$repo: String!
	$tagQuery: String!
	$cursor: String
	$limit: Int = 100
) {
	repository(owner: $owner, name: $repo) {
		refs(query: $tagQuery, refPrefix: "refs/tags/", first: $limit, after: $cursor, orderBy: { field: TAG_COMMIT_DATE, direction: DESC }) {
			pageInfo {
				endCursor
				hasNextPage
			}
			nodes {
				name
				target {
					oid
				}
			}
		}
	}
}`,h=await this.graphql(d,{owner:c,repo:l,tagQuery:(n=r==null?void 0:r.query)!=null?n:"",cursor:r==null?void 0:r.cursor,limit:Math.min(100,(i=r==null?void 0:r.limit)!=null?i:100)});if(h===void 0)return{tags:[]};const S=(o=h.repository)==null?void 0:o.refs;if(S===void 0)return{tags:[]};const O=S.nodes.map(I=>({type:Dn.Tag,name:I.name,commit:I.target.oid,commitUrl:I.target.commitUrl}));return{paging:{cursor:S.pageInfo.endCursor,more:S.pageInfo.hasNextPage},tags:O}}catch(c){return{tags:[]}}}async getTarGz(e){const{repo:{owner:r,name:n},HEAD:{sha:i}}=await this.getMetadata(e),o=await this.ensureAuthenticated();return m.window.withProgress({location:m.ProgressLocation.Notification,cancellable:!0,title:Ws("fetching index","Fetching search index...")},async(c,l)=>{try{if($n){let S=`https://vscode.dev/indexes/github2/${r}/${n}/${i}`;try{const $=await this.tarballProxyEndpoint;$!==void 0&&(S=$.replace("{owner}",r).replace("{repo}",n).replace("{sha}",i))}catch{}const I=await(await mt(S,{headers:{"x-proxy-authorization":`Bearer ${o.accessToken}`},credentials:"include"},l)).text(),P=await mt(I,{},l);return new Uint8Array(await P.arrayBuffer())}const d=`https://api.github.com/repos/${r}/${n}/tarball/${i}`,h=await mt(d,{headers:{Authorization:`Bearer ${o.accessToken}`}},l);return new Uint8Array(await h.arrayBuffer())}catch(d){throw L.error(d),d}})}async pushCommit(e,r,n,i){const o=new ut(`GitHub.pushCommit(${e.toString()}, sha=${r}${n?`, ref=${n}`:""}${i?`, fork=${i.repo.owner}/${i.repo.name}`:""})`);let c;try{const l=await this.getMetadata(e);let d,h;if(i?{repo:{owner:d,name:h}}=i:l.HEAD.type===Pe.RemoteBranch&&l.HEAD.branch.remote.accessLevel>=Ne.Write?{owner:d,name:h}=l.HEAD.branch.remote.repo:{repo:{owner:d,name:h}}=l,n===void 0&&l.HEAD.detached)throw new Ot("Unable to commit; no current branch");(n==null?void 0:n.startsWith("refs/heads/"))&&(n=n.substr(11));const S=await this.request("PATCH /repos/{owner}/{repo}/git/refs/{ref}",{owner:d,repo:h,ref:`heads/${n!=null?n:l.HEAD.branch.name}`,sha:r});return n===void 0&&!l.HEAD.detached&&await this.fastForwardTo(e,r,l),c=S.data.ref,c}catch(l){throw l instanceof Zi&&l.status===422&&l.message.includes("Update is not a fast forward")?new Le(l):(L.error(l),l)}finally{o.stop(c?{message:`: Pushed commit to ${c}`}:void 0)}}async queryRepositoryObject(e,r,n,i){var o,c;try{const{repo:{owner:l,name:d},HEAD:{sha:h},path:S}=await this.providerService.getMetadata(e),O=`query ${r}(
	$owner: String!
	$repo: String!
	$expression: String
) {
	repository(owner: $owner, name: $repo) {
		object(expression: $expression) {
			${n}
		}
	}
}`,I=await this.graphql(O,{owner:l,repo:d,expression:i!=null?i:`${h}:${S}`});return(c=(o=I==null?void 0:I.repository)==null?void 0:o.object)!=null?c:void 0}catch(l){L.error(l);return}}async repositoryObjectExists(e,r){return await this.queryRepositoryObject(e,"exists","			__typename",r)!==void 0}async searchPullRequestsQuery(e,r){try{let n=a(function(l,d){return{number:l.number,title:l.title,repoWithOwner:l.repository.nameWithOwner,reasons:d?[d]:[],url:l.url}},"toResult");const i=`query searchPullRequests(
	$authored: String!
	$assigned: String!
	$reviewRequested: String!
	$mentioned: String!
) {
	viewer {
		repositories(first: 100, orderBy: { field: STARGAZERS, direction: DESC }) {
			nodes {
				pullRequests(first: 100, states: OPEN, orderBy: { field: UPDATED_AT, direction: DESC }) {
					nodes {
						number
						title
						url
						repository {
							nameWithOwner
						}
					}
				}
			}
		}
	}
	authored: search(first: 100, query: $authored, type: ISSUE) {
		nodes {
			...on PullRequest {
				number
				title
				url
				repository {
					nameWithOwner
				}
			}
		}
	}
	assigned: search(first: 100, query: $assigned, type: ISSUE) {
		nodes {
			...on PullRequest {
				number
				title
				url
				repository {
					nameWithOwner
				}
			}
		}
	}
	reviewRequested: search(first: 100, query: $reviewRequested, type: ISSUE) {
		nodes {
			...on PullRequest {
				number
				title
				url
				repository {
					nameWithOwner
				}
			}
		}
	}
	mentioned: search(first: 100, query: $mentioned, type: ISSUE) {
		nodes {
			...on PullRequest {
				number
				title
				url
				repository {
					nameWithOwner
				}
			}
		}
	}
}`;e=e.trim(),(r==null?void 0:r.user)&&(e+=` user:${r.user}`);const o=await this.graphql(i,{authored:(e?`${e} is:pr is:open archived:false author:@me`:"is:pr is:open archived:false author:@me").trim(),assigned:(e?`${e} is:pr is:open archived:false assignee:@me`:"is:pr is:open archived:false assignee:@me").trim(),reviewRequested:(e?`${e} is:pr is:open archived:false review-requested:@me`:"is:pr is:open archived:false review-requested:@me").trim(),mentioned:(e?`${e} is:pr is:open archived:false mentions:@me`:"is:pr is:open archived:false mentions:@me").trim()});return o===void 0?[]:Fd([...o.assigned.nodes.map(l=>n(l,"assigned")),...o.reviewRequested.nodes.map(l=>n(l,"review requested")),...o.mentioned.nodes.map(l=>n(l,"mentioned")),...o.authored.nodes.map(l=>n(l,"authored")),...wn(o.viewer.repositories.nodes,l=>l.pullRequests.nodes.map(d=>n(d)))],l=>l.url,(l,d)=>(d.reasons.length!==0&&l.reasons.push(...d.reasons),l))}catch(n){return[]}}async searchRepositoriesQuery(e,r){try{const n=`query searchRepositories(
	$search: String!
) {
	viewer {
		repositories(first: 100, orderBy: { field: UPDATED_AT, direction: DESC }) {
			nodes {
				nameWithOwner
				description
				url
				parent {
					nameWithOwner
				}
				stargazerCount
			}
		}
	}
	search(first: 100, query: $search, type: REPOSITORY) {
		nodes {
			...on Repository {
				nameWithOwner
				description
				url
				parent {
					nameWithOwner
				}
				stargazerCount
			}
		}
	}
}`;(r==null?void 0:r.user)&&(e+=` user:${r.user}`),(r==null?void 0:r.sort)&&(e+=` sort:${r.sort}`),e+=" fork:true";const i=await this.graphql(n,{search:e.trim()});return i===void 0?[]:Fd((r==null?void 0:r.user)?[...i.search.nodes,...i.viewer.repositories.nodes]:[...i.viewer.repositories.nodes,...i.search.nodes],c=>c.url).map(c=>{var l,d,h;return{repoWithOwner:c.nameWithOwner,description:(l=c.description)!=null?l:void 0,url:c.url,fork:(h=(d=c.parent)==null?void 0:d.nameWithOwner)!=null?h:void 0,stars:c.stargazerCount}})}catch(n){return[]}}async searchCodeQuery(e,r,n){var i,o,c;const{repo:{owner:l,name:d},HEAD:h,defaultBranch:S}=await this.getMetadata(r),O=[];((i=h.branch)==null?void 0:i.name)!==S.name&&O.push(Ws("Cant search branch","Unable to search {0} without index, falling back to {1}.",(c=(o=h.branch)==null?void 0:o.name)!=null?c:h.detached.name,S.name));try{const P=await(await this.octokit({request:{headers:{authorization:`Bearer ${(await this.ensureAuthenticated()).accessToken}`,accept:"application/vnd.github.v3.text-match+json"}}})).request("GET /search/code",{q:`${e} repo:${l}/${d}`}),$=new m.Range(0,0,0,0),N=[];let U=0,W;for(const V of P.data.items)for(const ie of V.text_matches){if(U++,n.maxResults!==void 0&&U>n.maxResults)return{matches:N,limitHit:!0};W={path:V.path,ranges:[],preview:ie.fragment,matches:[]};for(const oe of ie.matches){let ge=0,ke=0,Ie=0;for(let Oe=0;Oe<oe.indices[1];Oe++)Oe===oe.indices[0]&&(ke=Ie),ie.fragment[Oe]===`
`?(ge++,Ie=0):Ie++;W.ranges.push($),W.matches.push(new m.Range(ge,ke,ge,Ie))}N.push(W)}return{matches:N,limitHit:!1,warnings:O}}catch(I){return{matches:[],limitHit:!0}}}async switchTo(e,r,n){const{name:i,repo:o,HEAD:{branch:c}}=await this.getMetadata(e);let l;if(!(r!==void 0&&(typeof r=="string"?(r==null?void 0:r.startsWith("refs/heads/"))?(l={type:tt.Tree,id:r.substr(11)},r=r.substr(11)):(r==null?void 0:r.startsWith("refs/tags/"))?l={type:tt.Tree,id:r.substr(10)}:l={type:tt.Tree,id:r}:l={...r,type:r.type===tt.Branch||r.type===tt.Tag?tt.Tree:r.type},(c==null?void 0:c.name)===l.id)))return{name:i,uri:this.providerService.createVirtualUri(e,{repo:o,ref:l}),location:(n==null?void 0:n.openInNewWindow)?$t.NewWindow:$t.CurrentWindow}}async sync(e,r,n){var i,o,c,l,d,h;const S=new ut(`GitHub.sync(${e.toString()}, resolution=${n.conflictResolution}, to=${n.to})`);let O;try{const{metadata:I}=await this.fetchCore(e,!0,{to:n.to});if(I.HEAD.detached){O=" \u2022 Skipped; detached HEAD";return}if(((o=(i=I==null?void 0:I.state)==null?void 0:i.behind)!=null?o:0)>0&&await r.hasChanges(e)){S.logStep("Fetching upstream changes");const P=[],$=(l=(c=I.state)==null?void 0:c.incomingChanges)!=null?l:[];if($.length>0){const N=await r.getChanges(e);for(const U of N){const W=this.providerService.getRelativeFilePath(e,U.uri),V=$.find(ie=>ie.uri.path===W);if(V!==void 0){P.push({path:W,current:U,incomingType:V.type});break}}}if(P.length>0)switch(n.conflictResolution){case on.KeepCurrent:S.logStep("Syncing (keep) upstream changes",{message:`: ${P.length} conflicts; \u2022`,suffix:" \u2022 Syncing (keep) upstream changes..."});for(const N of P)await r.keep(N.current.uri,{type:N.incomingType,providerUri:qd(I,I.HEAD.branch.sha,N.path)});break;case on.DiscardCurrent:S.logStep("Syncing (discard) upstream changes",{message:`: ${P.length} conflicts; \u2022`,suffix:" \u2022 Syncing (discard) upstream changes..."});for(const N of P)await r.discard(N.current.uri);break;case on.Merge:S.logStep("Syncing (merge) upstream changes",{message:`: ${P.length} conflicts; \u2022`,suffix:" \u2022 Syncing (merge) upstream changes..."});for(const N of P)await r.merge(N.current.uri,{type:N.incomingType,providerUri:qd(I,I.HEAD.branch.sha,N.path)},{providerUri:qd(I,I.HEAD.sha,N.path)});break;case on.Abort:default:throw S.logStep("Syncing (abort) upstream changes",{message:`: ${P.length} conflicts; \u2022`,suffix:" \u2022 Syncing (abort) upstream changes..."}),await this.providerService.updateMetadata(e,I),new qt}}O=` \u2022 to=${(d=n.to)!=null?d:I.HEAD.branch.sha}`,await this.fastForwardTo(e,(h=n.to)!=null?h:I.HEAD.branch.sha,I)}finally{S.stop(O?{suffix:O}:void 0)}}async fastForwardTo(e,r,n){if(n.HEAD.detached)throw new Ot("Unable to fast-forward; no current branch");if(n.HEAD.sha===r&&n.state===void 0)return;const i=this.asFileTreeKey(e,n.HEAD.sha),o=this.fileTreeCache.get(i);this.fileTreeCache.delete(i),o==null||o.dispose(),L.log(`Fast forward to ${r}; rootUri=${e.toString()}`),await this.providerService.updateMetadata(e,{...n,HEAD:{...n.HEAD,detached:void 0,sha:r},state:r!==n.HEAD.branch.sha?n.state:void 0,timestamp:Date.now()}),r!==n.HEAD.branch.sha&&n.state===void 0&&await this.fetchCore(e,!1,{to:r})}async getBranchTips(e,r){try{const{repo:{owner:n,name:i},HEAD:o}=await this.getMetadata(e);r===void 0&&(o.type===Pe.RemoteBranch?r=`${o.branch.remote.repo.owner}/${o.branch.remote.repo.name}:refs/heads/${o.branch.name}`:r=o.branch?`refs/heads/${o.branch.name}`:"");const c=lp.exec(r);if(c==null?void 0:c.groups)return this.getRemoteBranchTips(n,i,r);const l=`query getBranchTips(
	$owner: String!
	$repo: String!
	$ref: String!
) {
	repository(owner: $owner, name: $repo) {
		defaultBranchRef {
			target {
				oid
			}
		}
		ref(qualifiedName: $ref) {
			target {
				oid
			}
		}
	}
}`,d=await this.graphql(l,{owner:n,repo:i,ref:r});if((d==null?void 0:d.repository)==null)return;const{defaultBranchRef:h,ref:S}=d.repository;return!h&&!S?void 0:{defaultBranch:h?{sha:h.target.oid}:void 0,branch:S?{sha:S.target.oid}:void 0}}catch(n){return}}async getRemoteBranchTips(e,r,n){try{const i=lp.exec(n);if((i==null?void 0:i.groups)==null)return;let{remoteOwner:o,remoteRepo:c,remoteRef:l}=i.groups;c||(c=r);const d=`query getRemoteBranchTips(
	$owner: String!
	$repo: String!
	$remoteOwner: String!
	$remoteRepo: String!
	$remoteRef: String!
) {
	repository(owner: $owner, name: $repo) {
		defaultBranchRef {
			target {
				oid
			}
		}
	}
	remote: repository(owner: $remoteOwner, name: $remoteRepo) {
		ref(qualifiedName: $remoteRef) {
			target {
				oid
			}
		}
	}
}`,h=await this.graphql(d,{owner:e,repo:r,remoteOwner:o,remoteRepo:c,remoteRef:l});if((h==null?void 0:h.repository)==null||(h==null?void 0:h.remote)==null)return;const{repository:{defaultBranchRef:S},remote:{ref:O}}=h;return!S&&!O?void 0:{defaultBranch:S?{sha:S.target.oid}:void 0,branch:O?{sha:O.target.oid}:void 0}}catch(i){return}}async getRepositoryInfo(e,r,n,i){var o,c,l,d,h,S,O,I,P,$,N,U,W,V,ie,oe;try{const ge=`number
title
state
maintainerCanModify
baseRef { name }
baseRefName
baseRefOid
baseRepository {
	name
	owner { login }
	defaultBranchRef {
		name
		target { oid }
	}
	viewerPermission
}
headRef { name }
headRefName
headRefOid
headRepository {
	name
	owner { login }
	defaultBranchRef {
		name
		target { oid }
	}
	viewerPermission
}
mergeCommit { oid }
`,ke=`query getRepository(
	$owner: String!
	$repo: String!
	$ref: String = ""
	$has_pr: Boolean!
	$pr: Int = 0
) {
	viewer { login }
	repository(owner: $owner, name: $repo) {
		name
		owner { login }
		defaultBranchRef {
			name
			target { oid }
		}
		ref(qualifiedName: $ref) {
			name
			prefix
			target { oid }
		}
		viewerPermission
		pullRequest(number: $pr) @include(if: $has_pr) {
			${ge}
		}
	}
}`;let Ie,Oe;try{const st=await this.graphql(ke,{owner:e,repo:r,ref:(i==null?void 0:i.ref)!=="HEAD"?i==null?void 0:i.ref:void 0,has_pr:Boolean(i==null?void 0:i.pr),pr:(o=i==null?void 0:i.pr)!=null?o:0});if((st==null?void 0:st.repository)==null)return;({repository:Oe,viewer:{login:Ie}}=st)}catch(st){if((i==null?void 0:i.pr)&&st instanceof zs&&((l=(c=st.errors)==null?void 0:c[0])==null?void 0:l.type)==="NOT_FOUND"&&((d=st.errors[0])==null?void 0:d.message.includes("Could not resolve to a PullRequest"))){({repository:Oe,viewer:{login:Ie}}=st.data);try{const Mt=await this.graphql(`query getPullRequestFromParentRepository(
	$owner: String!
	$repo: String!
	$pr: Int!
) {
	repository(owner: $owner, name: $repo) {
		parent {
			pullRequest(number: $pr) {
				${ge}
			}
		}
	}
}`,{owner:e,repo:r,pr:i==null?void 0:i.pr});if(((S=(h=Mt==null?void 0:Mt.repository)==null?void 0:h.parent)==null?void 0:S.pullRequest)==null)throw st;Oe.pullRequest=Mt.repository.parent.pullRequest}catch{throw st}}else throw st}const Ze=(O=Oe.defaultBranchRef)!=null?O:void 0;if((Ze==null?void 0:Ze.name)==null)return;const $e=Oe.pullRequest;let ze;if(Oe==null?void 0:Oe.ref)ze={prefix:Oe.ref.prefix,name:Oe.ref.name,sha:Oe.ref.target.oid};else if($e==null?void 0:$e.headRef){let st=Wd($e.headRepository.viewerPermission);st<Ne.Write&&$e.maintainerCanModify&&Wd(Oe.viewerPermission)>=Ne.Write&&(st=Ne.WriteToPullRequest),ze=$e.headRepository.owner.login===e?{prefix:"refs/heads/",name:$e==null?void 0:$e.headRef.name,sha:(P=(I=$e.mergeCommit)==null?void 0:I.oid)!=null?P:$e==null?void 0:$e.headRefOid}:{prefix:"refs/remotes/",name:$e==null?void 0:$e.headRef.name,sha:(N=($=$e.mergeCommit)==null?void 0:$.oid)!=null?N:$e==null?void 0:$e.headRefOid,remote:{name:`${$e.headRepository.owner.login}/${$e.headRepository.name}`,accessLevel:st,repo:{owner:$e.headRepository.owner.login,name:$e.headRepository.name}}}}else($e==null?void 0:$e.baseRef)?(ze={prefix:"refs/heads/",name:$e==null?void 0:$e.baseRef.name,sha:(W=(U=$e.mergeCommit)==null?void 0:U.oid)!=null?W:$e==null?void 0:$e.baseRefOid},n&&(L.log("Did not find a headRef for PR, falling back to baseRef",$e.baseRef),Xr.showPullRequestHeadNotFoundMessage(`${e}/${r}`,`#${i==null?void 0:i.pr}`))):(i==null?void 0:i.ref)==="HEAD"&&(ze={prefix:"refs/heads/",name:Ze.name,sha:Ze.target.oid});return{user:Ie,repo:{owner:Oe.owner.login,name:Oe.name},accessLevel:Wd(Oe.viewerPermission),ref:ze,defaultBranch:{name:Ze.name,sha:Ze.target.oid},pullRequest:$e?{id:$e.number.toString(),state:zd($e.state),title:$e.title}:void 0}}catch(ge){if(ge instanceof zs)switch((ie=(V=ge.errors)==null?void 0:V[0])==null?void 0:ie.type){case"NOT_FOUND":{if((i==null?void 0:i.pr)&&((oe=ge.errors[0])==null?void 0:oe.message.includes("Could not resolve to a PullRequest"))){const Ie=new It(ge,`${e}/${r}`,`#${i==null?void 0:i.pr}`);throw n&&Xr.showPullRequestNotFoundMessage(Ie.name,Ie.id),Ie}const ke=new Pt(ge,`${e}/${r}`);throw n&&Xr.showRepositoryNotFoundMessage(ke.name),ke}case"FORBIDDEN":{const ke=new xe(ge,`${e}/${r}`);throw n&&Xr.showRepositoryForbiddenMessage(ke.name),ke}}L.error(ge,`Failed to get repository info for '${e}/${r}'`),!this.handleRequestErrors(ge)&&n&&Xr.showUnableToOpenRepositoryMessage(ge);return}}async validateOwnerAndRepoAndSplitRefFromPath(e,r,n){try{const i=await this.request(`GET /repos/{owner}/{repo}/git/extract-ref/${n!=null?n:"HEAD"}`,{owner:e,repo:r});return[e,r]=i.data.name_with_owner.split("/"),n?{owner:e,repo:r,ref:{type:tt.Tree,id:i.data.ref},path:i.data.path}:{owner:e,repo:r}}catch(i){if(i instanceof Zi)switch(i.status){case 401:throw new pt(i,()=>void this.reauthenticate());case 403:throw new xe(i,`${e}/${r}`);case 404:throw new Pt(i,`${e}/${r}`);case 409:throw new ht(i,`${e}/${r}`)}return}}asFileTreeKey(e,r){return`${Te(this.providerService.getProviderRootUri(e))}:${r}`}}a(fu,"GitHubRepositoryProvider"),sp([tr()],fu.prototype,"ensureAuthenticated",1),sp([tr()],fu.prototype,"octokit",1);function zd(t){switch(t){case"OPEN":return it.Open;case"CLOSED":return it.Closed;case"MERGED":return it.Merged}}a(zd,"toPullRequestState");function Z0(t){if(t!==void 0)return t.map(e=>{switch(e){case it.Open:return"OPEN";case it.Closed:return"CLOSED";case it.Merged:return"MERGED"}})}a(Z0,"fromPullRequestStates");var Ba;(function(t){t.ADMIN="ADMIN",t.MAINTAIN="MAINTAIN",t.WRITE="WRITE",t.TRIAGE="TRIAGE",t.READ="READ",t.NONE="NONE"})(Ba||(Ba={}));function Wd(t){switch(t){case Ba.ADMIN:return Ne.Admin;case Ba.MAINTAIN:return Ne.Maintain;case Ba.WRITE:return Ne.Write;case Ba.TRIAGE:return Ne.Triage;case Ba.READ:return Ne.Read;default:return Ne.None}}a(Wd,"permissionToAccessLevel");function J0(t){switch(t&&(t=t.toLocaleLowerCase()),t){case"blob":return m.FileType.File;case"tree":return m.FileType.Directory;default:return m.FileType.Unknown}}a(J0,"typenameToFileType");const dp=a(class{constructor(t,e,r){this.providerService=t,this.storageService=e,this.changeStore=r,this.lock=new Sn("PendingRepositoryOpenActions"),this.disposable=m.Disposable.from(t.onDidChangeRepositories(n=>n.added.length&&this.onRepositoriesOpened(n.added)))}dispose(){this.disposable.dispose()}async onRepositoriesOpened(t){for(const e of t){const r=await this.getAndDelete(e);(r==null?void 0:r.applyChangeset)&&await this.applyPendingChangeset(e,r.applyChangeset),(r==null?void 0:r.filesToOpen)&&this.openPendingFiles(e.uri,r.filesToOpen),this.fetchOrSync(e)}}async fetchOrSync(t){await this.changeStore.hasChanges(t.uri)?await this.providerService.fetch(t.uri):await this.providerService.sync(t.uri,this.changeStore,{reason:"invoked"})}async get(t){return this.lock.synchronizeRead(()=>this.getCore(t.uri),"PendingRepositoryOpenActions.get")}async getAndDelete(t){L.debug(`RepositoryOpenActionsService.getAndDelete(${t.uri.toString()})`);try{return await this.lock.synchronizeWrite(async()=>{const r=await this.getCore(t.uri);if(r!==void 0)return await this.storeCore(t.uri,void 0),r},"PendingRepositoryOpenActions.getAndDelete")}catch(e){L.error(e,`Failed to get pending actions for ${t.uri.toString()}`);return}}async openPendingFiles(t,e){if(e.length!==0){L.log(`RepositoryOpenActionsService.openPendingFiles(${t.toString()})`,e.join(","));for(let r of e){const n=/:(?<start>\d+)(?:-(?<end>\d+))?$/.exec(r);let i,o;(n==null?void 0:n.groups)!==void 0&&(i=Number(n.groups.start),isNaN(i)&&(i=void 0),o=Number(n.groups.end),isNaN(o)&&(o=void 0),r=r.substring(0,n.index));const c=m.Uri.joinPath(t,r);let l;try{l=await m.workspace.fs.stat(c)}catch{}if((l==null?void 0:l.type)===m.FileType.Directory)m.commands.executeCommand("revealInExplorer",c);else{let d;i!==void 0&&(d={selection:new m.Range(Number(i)-1,0,o!=null?o:i,0)}),m.commands.executeCommand("vscode.open",c,d)}}}}setChangesetToApply(t,e){return L.log(`RepositoryOpenActionsService.setChangesetToApply(${t.toString()})`),this.lock.synchronizeWrite(async()=>{const r=await this.getCore(t);await this.storeCore(t,{...r,applyChangeset:e})},"PendingRepositoryOpenActions.setChangesetToApply")}setPendingFilesToOpen(t,e){return L.log(`RepositoryOpenActionsService.setPendingFilesToOpen(${t.toString()})`,e.length),this.lock.synchronizeWrite(async()=>{const r=await this.getCore(t);await this.storeCore(t,{...r,filesToOpen:e})},"PendingRepositoryOpenActions.setPendingFilesToOpen")}async applyPendingChangeset(t,e){L.log(`RepositoryOpenActionsService.applyPendingChangeset(${t.uri.toString()})`);try{await this.changeStore.applyChangeset(t.uri,e,{save:!0})}catch(r){L.error(r,`Failed to apply pending changeset for ${t.uri.toString()}`)}}async getCore(t){return this.fromStorage(await this.storageService.get(this.getStorageKey(t)))}storeCore(t,e){return e===void 0||e.applyChangeset===void 0&&(e.filesToOpen===void 0||e.filesToOpen.length===0)?this.storageService.delete(this.getStorageKey(t)):this.storageService.store(this.getStorageKey(t),this.toStorage(e))}getStorageKey(t){return`actions/${te(t)}`}fromStorage(t){if(!!t)try{const e=JSON.parse(t,(r,n)=>(r==="uri"||r.endsWith("Uri"))&&Ue(n)?m.Uri.from(n):n);return{filesToOpen:e.filesToOpen,applyChangeset:e.applyChangeset}}catch(e){return L.error(e,"Failed to deserialize pending repository actions"),{}}}toStorage(t){const e={schemaVersion:dp.storageSchemaVersion,...t};return JSON.stringify(e)}},"_RepositoryOpenActionsService");let hp=dp;hp.storageSchemaVersion=1;const fi=(0,B.loadMessageBundle)();class fp{constructor(e,r){this.providerService=e,this.changeStore=r,this._onDidChangeFileDecorations=new m.EventEmitter,this._decorations=new Map,this.disposable=m.Disposable.from(m.window.registerFileDecorationProvider(this),e.onDidChangeRepository(this.onRefresh,this),e.onDidRefresh(this.onRefresh,this),r.onDidChange(this.onUrisChanged,this))}get onDidChangeFileDecorations(){return this._onDidChangeFileDecorations.event}dispose(){this.disposable.dispose(),this._decorations.clear()}onRefresh(){this._decorations.clear(),setTimeout(()=>this._onDidChangeFileDecorations.fire(void 0),0)}onUrisChanged(e){const r=e.map(({uri:n})=>(this._decorations.delete(te(n)),n));setTimeout(()=>this._onDidChangeFileDecorations.fire(r),0)}async provideFileDecoration(e,r){if(e.scheme!==Qt.scheme)return;const n=te(e);let i=this._decorations.get(n);if(i!==void 0)return i!=null?i:void 0;const o=await this.providerService.getIncomingChanges(this.providerService.getVirtualRootUri(e));let c;o.length>0&&(c=o.find(d=>te(d.uri)===n));const l=await this.changeStore.getChange(e);if(l===void 0){if(c!==void 0)switch(c.type){case Dt.Created:i={badge:"\u2193A",color:new m.ThemeColor("remoteHub.decorations.incomingAddedForegroundColor"),tooltip:fi("decoration tooltip incoming change added","Pending Incoming Changes (Added)")};break;case Dt.Deleted:i={badge:"\u2193D",color:new m.ThemeColor("remoteHub.decorations.incomingDeletedForegroundColor"),tooltip:fi("decoration tooltip incoming change deleted","Pending Incoming Changes (Deleted)")};break;case Dt.Changed:i={badge:"\u2193M",color:new m.ThemeColor("remoteHub.decorations.incomingModifiedForegroundColor"),tooltip:fi("decoration tooltip incoming change modified","Pending Incoming Changes (Modified)")};break;default:i={badge:"\u2193~",color:new m.ThemeColor("remoteHub.decorations.incomingModifiedForegroundColor"),tooltip:fi("decoration tooltip incoming change","Pending Incoming Changes")};break}return this._decorations.set(n,i!=null?i:null),i}if(l.conflicts)i={badge:"\u26A0",color:new m.ThemeColor("remoteHub.decorations.conflictForegroundColor"),tooltip:fi("decoration tooltip conflicts","Merge Conflicts ({0})",Tu(l.conflicts.status))};else if(c!==void 0)switch(c.type){case Dt.Created:i={badge:"\u26A0",color:new m.ThemeColor("remoteHub.decorations.possibleConflictForegroundColor"),tooltip:fi("decoration tooltip possible conflict added","Possible Merge Conflicts (Added)")};break;case Dt.Deleted:i={badge:"\u26A0",color:new m.ThemeColor("remoteHub.decorations.possibleConflictForegroundColor"),tooltip:fi("decoration tooltip possible conflict deleted","Possible Merge Conflicts (Deleted)")};break;case Dt.Changed:i={badge:"\u26A0",color:new m.ThemeColor("remoteHub.decorations.possibleConflictForegroundColor"),tooltip:fi("decoration tooltip possible conflict","Possible Merge Conflicts")};break;default:i={badge:"\u26A0",color:new m.ThemeColor("remoteHub.decorations.possibleConflictForegroundColor"),tooltip:fi("decoration tooltip possible conflict","Possible Merge Conflicts")}}else switch(l.type){case Dt.Created:i={badge:"A",color:new m.ThemeColor("remoteHub.decorations.addedForegroundColor"),tooltip:fi("decoration tooltip added","Added")};break;case Dt.Changed:i={badge:"M",color:new m.ThemeColor("remoteHub.decorations.modifiedForegroundColor"),tooltip:fi("decoration tooltip modified","Modified")};break;case Dt.Deleted:i={badge:"D",color:new m.ThemeColor("remoteHub.decorations.deletedForegroundColor"),tooltip:fi("decoration tooltip deleted","Deleted")};break}return this._decorations.set(n,i!=null?i:null),i}}a(fp,"ScmDecorationProvider");const ey=(0,B.loadMessageBundle)();class wo{constructor(e){this.command=e}get label(){return this.command.title}async execute(){var e;return void await m.commands.executeCommand(this.command.command,...(e=this.command.arguments)!=null?e:[])}}a(wo,"CommandQuickPickItem");var pu;(function(t){async function e(r,n,i,o,c,l){let d;Array.isArray(c)?d=c:l===void 0&&(d=[],l=c);const h=m.window.createQuickPick(),S=new us(500),O=[S],{defaultBranch:I,HEAD:P}=await r.getMetadata(n);async function $(ie){var oe;const[ge,ke,Ie]=await Promise.all([r.getBranches(n,{query:ie,limit:100}),r.getTags(n,{query:ie,limit:100}),r.getSnapshots(n)]),Oe=new Set,Ze=new Set;for(const Mt of Ie)Oe.add(Mt.hash),Ze.add(Mt.branch.name);const $e=((l==null?void 0:l.filterBranches)?ge.branches.filter(l==null?void 0:l.filterBranches):ge.branches).filter(Mt=>Mt.name!==I.name),ze=ey("indexedCommit","Open indexed commit"),st=[{iconPath:new m.ThemeIcon("layers-active"),tooltip:ze}];return[...d,...((oe=P.branch)==null?void 0:oe.name)!==I.name?[{label:`$(git-branch) ${I.name} (default)`,description:`\u2022$(git-commit) ${wt(I.sha)}${Ze.has(I.name)||Oe.has(I.sha)?"\xA0\xA0\u2022\xA0\xA0$(layers)":""}`,alwaysShow:!0,type:tt.Branch,name:void 0,sha:I.sha,buttons:Ze.has(I.name)||Oe.has(I.sha)?st:void 0}]:[],...$e.map(Mt=>({label:`$(git-branch) ${Mt.name}`,description:`\u2022$(git-commit) ${wt(Mt.commit)}${Ze.has(Mt.name)?"\xA0\xA0\u2022\xA0\xA0$(layers)":""}`,type:tt.Branch,name:Mt.name,sha:Mt.commit,buttons:Ze.has(Mt.name)?st:void 0})),...ke.tags.map(Mt=>({label:`$(tag) ${Mt.name}`,description:`\u2022$(git-commit) ${wt(Mt.commit)}${Oe.has(Mt.commit)?"\xA0\xA0\u2022\xA0\xA0$(layers)":""}`,type:tt.Tag,name:Mt.name,sha:Mt.commit,buttons:Oe.has(Mt.commit)?st:void 0}))]}a($,"getItems");const N=$(void 0);let U,W=!1;async function V(ie){U=void 0;const oe=h.activeItems;h.items=ie!=null?ie:await N,W&&oe.length!==0&&(h.activeItems=h.items.filter(ge=>oe.some(ke=>ke.label===ge.label))),h.busy=!1}a(V,"setItems");try{return await new Promise(oe=>{var ge;O.push(h.onDidHide(()=>oe(void 0)),h.onDidChangeValue(ke=>{if(W=!1,ke=ke.trim(),(l==null?void 0:l.allowResetToSha)&&P.branch&&Nr(ke)){V([{label:`Reset $(git-branch) ${P.branch.name} to $(git-commit) ${ke}`,name:P.branch.name,sha:ke,type:tt.Branch}]);return}h.busy=!0;const Ie=S.debounce(ke?()=>$(ke):()=>N);U===void 0&&(U=Ie.then(async Oe=>V(Oe)))}),h.onDidAccept(()=>{if(h.activeItems.length!==0){const[ke]=h.activeItems;oe(ke)}}),h.onDidTriggerItemButton(ke=>{const Ie=ke.item;Ie instanceof wo||(Ie.useIndex=!0),oe(Ie)})),h.title=o,h.placeholder=i,h.matchOnDescription=!0,h.ignoreFocusOut=(ge=l==null?void 0:l.ignoreFocusOut)!=null?ge:!0,h.busy=!0,h.show(),U=S.debounce(async()=>N,0).then(ke=>V(ke))})}finally{h.dispose(),O.forEach(ie=>void ie.dispose())}}a(e,"show"),t.show=e})(pu||(pu={}));function Gd(t,e){switch(t){case Pe.Branch:case Pe.RemoteBranch:return e?"$(git-pull-request)":"$(git-branch)";case Pe.Tag:return"$(tag)";case Pe.Commit:return"$(git-commit)"}}a(Gd,"headTypeToCodicon");function ty(t){switch(t){case ft.Active:return"$(layers-active)";case ft.Match:return"$(layers-dot)";case ft.Indexed:return"$(layers)"}}a(ty,"indexTypeToCodicon");function ry(t,e){switch(t){case Pe.Branch:case Pe.RemoteBranch:return e?new m.ThemeIcon("git-pull-request"):new m.ThemeIcon("git-branch");case Pe.Tag:return new m.ThemeIcon("tag");case Pe.Commit:return new m.ThemeIcon("git-commit")}}a(ry,"headTypeToThemeIcon");const je=(0,B.loadMessageBundle)(),ny=new TextDecoder;class pp{constructor(e,r,n,i){this.providerService=e,this.changeStore=r,this.openActionsService=n,this.telemetryService=i,this._onDidCloseRepository=new m.EventEmitter,this._onDidOpenRepository=new m.EventEmitter,this._onDidChangeState=new m.EventEmitter,this._scmProviders=[],this._state="uninitialized",this.disposable=m.Disposable.from(Y.onDidChange(this.onConfigurationChanged,this),this.providerService.onDidChangeRepositories(this.onRepositoriesChanged,this),this.providerService.onDidChangeRepository(async({repository:c})=>{const l=this.getScmProvider(this.providerService.getVirtualUri(c.uri));l!==void 0&&await this.updateStatusBarCommands(l,void 0)}),this.providerService.onDidSyncRepository(async({repository:c,syncing:l})=>{const d=this.getScmProvider(this.providerService.getVirtualUri(c.uri));d!==void 0&&await this.updateStatusBarCommands(d,{syncing:l})}),this.providerService.onDidRefresh(c=>{for(const l of c)this.update(l)}),this.changeStore.onDidChange(c=>this.update(c[0].rootUri)),...this.registerCommands());const o=this.providerService.repositories;this.onRepositoriesChanged({added:o,removed:[]})}get onDidCloseRepository(){return this._onDidCloseRepository.event}get onDidOpenRepository(){return this._onDidOpenRepository.event}get onDidChangeState(){return this._onDidChangeState.event}get repositories(){return this._scmProviders.map(e=>e.repository).filter(e=>Boolean(e))}dispose(){var e;(e=this.disposable)==null||e.dispose()}get staging(){return this._staging===void 0&&(this._staging=Y.get("staging")),this._staging}get state(){return this._state}refresh(){for(const e of this._scmProviders)this.update(e.sourceControl.rootUri)}onConfigurationChanged(e){Y.changed(e,"staging")&&(this._staging=void 0,Y.changed(e,"staging.enabled")&&this.refresh()),Y.changed(e,"commitDirectlyWarning")&&this.refresh()}async onRepositoriesChanged(e){if(e.added.length)for(const r of e.added){const n=await this.update(r.uri);(n==null?void 0:n.repository)&&this._onDidOpenRepository.fire(n.repository)}if(e.removed.length)for(const r of e.removed){const n=this._scmProviders.findIndex(i=>te(i.sourceControl.rootUri)===te(r.uri));if(n!==-1){const i=this._scmProviders[n];i.repository&&this._onDidCloseRepository.fire(i.repository),i.sourceControl.dispose(),this._scmProviders.splice(n,1)}}this._state!=="initialized"&&(this._state="initialized",this._onDidChangeState.fire(this._state)),Si(Pn.HasWriteableScmProvider,this._scmProviders.some(r=>!r.isReadonly))}registerCommands(){return[m.commands.registerCommand("remoteHub.createPullRequest",e=>{if(e=this.getSourceControlFrom(e),e!==void 0)return this.telemetryService.sendEvent("command.createPullRequest"),void this.createPullRequest(e)}),m.commands.registerCommand("remoteHub.createDraftPullRequest",e=>{if(e=this.getSourceControlFrom(e),e!==void 0)return this.telemetryService.sendEvent("command.createDraftPullRequest"),void this.createPullRequest(e,{draft:!0})}),m.commands.registerCommand("remoteHub.commit",e=>{if(e=this.getSourceControlFrom(e),e!==void 0)return this.telemetryService.sendEvent("command.commit"),void this.commitChanges(e)}),m.commands.registerCommand("remoteHub.discardAllChanges",async e=>{if(gp(e)){const o=e.resourceStates.filter(sl);if(o.length!==0){if(await Kd(o))for(const c of o)await this.changeStore.discard(c.resourceUri);else this.telemetryService.sendEvent("command.discardAllChanges.abort",{reason:"aborted"});return}}const r=this.getSourceControlFrom(e);if((r==null?void 0:r.rootUri)===void 0)return;this.telemetryService.sendEvent("command.discardAllChanges");const n=await this.changeStore.getChanges(r.rootUri);await Kd(n)?await this.changeStore.discardAll(r.rootUri):this.telemetryService.sendEvent("command.discardAllChanges.abort",{reason:"aborted"})}),m.commands.registerCommand("remoteHub.discardChanges",async(...e)=>{for(const r of e)!sl(r)||(this.telemetryService.sendEvent("command.discardChanges"),await Kd([r])?await this.changeStore.discard(r.resourceUri):this.telemetryService.sendEvent("command.discardChanges.abort",{reason:"aborted"}))}),m.commands.registerCommand("remoteHub.stageAllChanges",async e=>{const r=this.getSourceControlFrom(e);(r==null?void 0:r.rootUri)!==void 0&&(this.telemetryService.sendEvent("command.stageAllChanges"),await this.changeStore.stageAll(r.rootUri))}),m.commands.registerCommand("remoteHub.stageChanges",async(...e)=>{for(const r of e)!sl(r)||(this.telemetryService.sendEvent("command.stageChanges"),await this.changeStore.stage(r.resourceUri))}),m.commands.registerCommand("remoteHub.unstageAllChanges",e=>{const r=this.getSourceControlFrom(e);if((r==null?void 0:r.rootUri)!==void 0)return this.telemetryService.sendEvent("command.unstageAllChanges"),void this.changeStore.unstageAll(r.rootUri)}),m.commands.registerCommand("remoteHub.unstageChanges",async(...e)=>{for(const r of e)!sl(r)||(this.telemetryService.sendEvent("command.unstageChanges"),await this.changeStore.unstage(r.resourceUri))}),m.commands.registerCommand("remoteHub.keepChanges",async(...e)=>{for(const r of e)!sl(r)||(this.telemetryService.sendEvent("command.keepChanges"),await this.changeStore.keep(r.resourceUri))}),m.commands.registerCommand("remoteHub.openChanges",e=>{var r;const{command:n}=e;if(!!n)return this.telemetryService.sendEvent("command.openChanges"),void m.commands.executeCommand(n.command,...(r=n.arguments)!=null?r:[])}),m.commands.registerCommand("remoteHub.openFile",async(...e)=>{var r;for(const n of e)if(Vd(n)){const i=n,o=this.changeStore.resolveOpenCommand(i.resourceUri,{preserveFocus:!1,preview:!1,viewColumn:m.ViewColumn.Active});this.telemetryService.sendEvent("command.openFile"),await m.commands.executeCommand(o.command,...(r=o.arguments)!=null?r:[])}else if(n instanceof m.Uri){this.telemetryService.sendEvent("command.openFile");const i=n;await m.window.showTextDocument(i)}}),m.commands.registerCommand("remoteHub.createBranch",async e=>{await ya("remoteHub.createBranchFrom",{...e,fromSha:"HEAD"})}),m.commands.registerCommand("remoteHub.createBranchFrom",async e=>{var r;const n=(r=e==null?void 0:e.uri)!=null?r:await cl(this._scmProviders,je("choose repo for create branch placeholder","Choose which repository to create a new branch on"),je("choose repo for create branch title","Create Branch"));if(n===void 0)return;this.telemetryService.sendEvent("command.createBranchFrom");const i=await this.providerService.getMetadata(n);if(i.accessLevel<Ne.Write){this.telemetryService.sendEvent("command.createBranchFrom.abort",{reason:"no permissions"}),m.window.showErrorMessage(je("no permissions to create branch ","You don't have access to create branches on this repository."));return}let o,c=!1;if(e==null?void 0:e.fromSha)o=e.fromSha,o==="HEAD"&&(o=i.HEAD.sha);else{const P=await pu.show(this.providerService,n,je("choose branch for create placeholder","Choose which branch to create the new branch from"),je("choose branch for create title","Create Branch \u2022 {0}",i.name));if(!P){this.telemetryService.sendEvent("command.createBranchFrom.abort",{reason:"abandoned branch picker"});return}o=P.sha,c=Boolean(P.useIndex)}let l;try{l=await m.window.withProgress({location:m.ProgressLocation.SourceControl},()=>gu(this.providerService,n,o,je("create branch","Please provide a new branch name"),je("create branch placeholder","New branch name"),je("create branch title","Create Branch \u2022 {0}",i.name)))}catch(P){L.error(P),m.window.showErrorMessage(je("unable to create branch","Unable to create the new branch."));return}if(!l){this.telemetryService.sendEvent("command.createBranchFrom.abort",{reason:"abandoned branch name prompt"});return}const d=await this.providerService.switchTo(n,{type:tt.Branch,id:l});if(!d)return;const h=await this.changeStore.createChangeset(n);h&&await this.openActionsService.setChangesetToApply(d.uri,h);const S=je("switch to branch prompt open","Switch to Branch"),O=je("switch to branch prompt open in new window","Open in New Window"),I=await m.window.showInformationMessage(je("switch to branch prompt",`Created new branch '{0}'.

Any uncommitted changes will be applied to the new branch.

Do you want to switch to the new branch?`,l),{modal:!0,useCustom:!0},S,O);!I||(d.location=I===O?$t.NewWindow:$t.CurrentWindow,c&&await Y.setMode(d.uri,ue.getIndexDefault(ne.Branch)),await gn(d,{skipChangesPrompt:!0}))}),m.commands.registerCommand("remoteHub.applyPatch",async e=>{if(e=this.getSourceControlFrom(e),(e==null?void 0:e.rootUri)===void 0)return;this.telemetryService.sendEvent("command.applyPatch");let r;const n=m.window.activeTextEditor;if((n==null?void 0:n.document.languageId)!=="diff"){const i=await m.window.showOpenDialog({openLabel:je("open patch","Open Patch"),title:je("open patch","Open Patch"),canSelectFiles:!0,canSelectFolders:!1,canSelectMany:!1,filters:{Diff:["diff"],Patch:["*","patch"]}});if(i===void 0||i.length===0)return;r=ny.decode(await m.workspace.fs.readFile(i[0]))}else r=n.document.getText();try{await this.changeStore.applyPatch(e.rootUri,r)}catch{m.window.showErrorMessage(je("invalid patch file","Invalid patch file"))}}),m.commands.registerCommand("remoteHub.exportPatch",async(...e)=>{const r=Array.isArray(e)?e:[e];for(const n of r){const i=this.getSourceControlFrom(n);if((i==null?void 0:i.rootUri)===void 0)return;let o;Vd(n)&&(o=n.resourceUri),this.telemetryService.sendEvent("command.exportPatch");const c=await this.changeStore.createPatch(i.rootUri,o),l=await m.workspace.openTextDocument({language:"diff",content:c});await m.window.showTextDocument(l)}}),m.commands.registerCommand("remoteHub.switchToBranch",async e=>{var r,n;const i=(r=e==null?void 0:e.uri)!=null?r:await cl(this._scmProviders,je("choose repo for switch branch placeholder","Choose which repository to switch branches on"),je("choose repo for switch branch title","Switch to Branch or Tag"));if(i===void 0)return;this.telemetryService.sendEvent("command.switchToBranch");const o=[],c=await this.providerService.getMetadata(i);if(e==null?void 0:e.commands)switch(c.accessLevel>=Ne.Write&&o.push(new wo($r({command:"remoteHub.createBranch",title:je("create branch command","$(add) Create New Branch..."),arguments:[{uri:i}]})),new wo($r({command:"remoteHub.createBranchFrom",title:je("create branch from command","$(add) Create New Branch from..."),arguments:[{uri:i}]}))),c.HEAD.type){case Pe.Branch:o.push(new wo($r({command:"remoteHub.openOnRemote",title:je("open branch on remote command","$(globe) Open Branch on {0}...",c.provider.name),arguments:[{provider:c.provider,repo:c.repo,branch:c.HEAD.branch.name}]})));break;case Pe.RemoteBranch:o.push(new wo($r({command:"remoteHub.openOnRemote",title:je("open remote branch on remote command","$(globe) Open Remote Branch on {0}...",c.provider.name),arguments:[{provider:c.provider,repo:c.HEAD.branch.remote.repo,branch:c.HEAD.branch.name}]})));break;case Pe.Tag:o.push(new wo($r({command:"remoteHub.openOnRemote",title:je("open tag on remote command","$(globe) Open Tag on {0}...",c.provider.name),arguments:[{provider:c.provider,repo:c.repo,tag:c.HEAD.detached.name}]})));break;case Pe.Commit:o.push(new wo($r({command:"remoteHub.openOnRemote",title:je("open commit on remote command","$(globe) Open Commit on {0}...",c.provider.name),arguments:[{provider:c.provider,repo:c.repo,sha:c.HEAD.sha}]})));break}const l=(n=c.HEAD.branch)==null?void 0:n.name,d=Boolean(l&&!await this.changeStore.hasChanges(i)),h=await pu.show(this.providerService,i,je("choose switch branch placeholder","Choose which branch to switch to"),je("choose switch branch title","Switch to Branch or Tag \u2022 {0}",c.name),o,{allowResetToSha:d,filterBranches:l?S=>S.name!==l:void 0,ignoreFocusOut:!1});if(!h){this.telemetryService.sendEvent("command.switchToBranch.abort",{reason:"abandoned branch picker"});return}return h instanceof wo?void h.execute():d&&h.type===tt.Branch&&h.name===l&&h.sha?m.window.withProgress({location:m.ProgressLocation.SourceControl},async()=>{try{await this.providerService.sync(i,this.changeStore,{to:h.sha})}catch(S){L.error(S),m.window.showErrorMessage(je("reset failed","Unable to reset the repository to commit '{0}'.",wt(h.sha)))}}):void m.window.withProgress({location:m.ProgressLocation.SourceControl},async()=>{const S=await this.providerService.switchTo(i,h.name?{type:h.type,id:h.name}:void 0);if(S!==void 0){if(h.useIndex){const O=await this.providerService.getModeRefType(S.uri);await Y.setMode(S.uri,ue.getIndexDefault(O))}return gn(S)}})}),m.commands.registerCommand("remoteHub.fetch",async e=>{var r;const n=(r=e==null?void 0:e.uri)!=null?r:await cl(this._scmProviders,je("choose repo for fetch placeholder","Choose which repository to fetch"),je("choose repo for fetch title","Fetch Repository"));if(n!==void 0){this.telemetryService.sendEvent("command.fetch");try{await m.window.withProgress({location:m.ProgressLocation.SourceControl},()=>this.providerService.fetch(n,{force:!0}))}catch(i){m.window.showErrorMessage(je("fetch failed","Unable to fetch repository"))}}}),m.commands.registerCommand("remoteHub.fetchAll",async e=>{const r=this.providerService.repositories;if(r.length===0)return;(e==null?void 0:e.automated)||this.telemetryService.sendEvent("command.fetchAll"),(await m.window.withProgress({location:m.ProgressLocation.SourceControl},async()=>{const i=[];for(const o of r)try{await this.providerService.fetch(o.uri)}catch(c){i.push(c)}return i})).length&&!(e==null?void 0:e.automated)&&m.window.showErrorMessage(r.length?je("fetch all failed","Unable to fetch repositories"):je("fetch failed","Unable to fetch repository"))}),m.commands.registerCommand("remoteHub.pull",async e=>{var r;const n=(r=e==null?void 0:e.uri)!=null?r:await cl(this._scmProviders,je("choose repo for pull placeholder","Choose which repository to pull"),je("choose repo for pull title","Pull Repository"));if(n!==void 0){this.telemetryService.sendEvent("command.pull");try{await this.sync(n,{pull:!0})}catch{}}}),m.commands.registerCommand("remoteHub.sync",async e=>{var r;const n=(r=e==null?void 0:e.uri)!=null?r:await cl(this._scmProviders,je("choose repo for sync placeholder","Choose which repository to sync"),je("choose repo for sync title","Synchronize Repository"));if(n!==void 0){this.telemetryService.sendEvent("command.sync");try{await this.sync(n)}catch{}}}),m.commands.registerCommand("remoteHub.disableCommitDirectlyWarning",()=>{this.telemetryService.sendEvent("command.disableCommitDirectlyWarning"),Y.updateEffective("commitDirectlyWarning",K.Off)})]}async sync(e,{pull:r,...n}={pull:!1}){this.telemetryService.sendEvent("sync");try{await m.window.withProgress({location:m.ProgressLocation.SourceControl},()=>this.providerService.sync(e,this.changeStore,n))}catch(i){if(i instanceof qt){const o={title:je("sync confirm","Continue")},c={title:je("sync cancel","Cancel"),isCloseAffordance:!0};await m.window.showWarningMessage(r?je("sync pull",`Pulling in changes may cause conflicts with your uncommitted changes as one of more of those files has changed since you started editing.

Do you want to continue pulling in changes.`):je("sync",`Syncing changes may cause conflicts with your uncommitted changes as one of more of those files has changed since you started editing.

Do you want to continue syncing changes?`),{modal:!0,useCustom:!0},o,c)===o?await m.window.withProgress({location:m.ProgressLocation.SourceControl},()=>this.providerService.sync(e,this.changeStore,{conflictResolution:on.Merge})):this.telemetryService.sendEvent("sync.abort",{reason:"abandoned"})}else throw L.error(i),this.telemetryService.sendException(i),m.window.showErrorMessage(je("sync failed","Unable to sync the repository.")),i}}async commitChanges(e){try{await m.window.withProgress({location:m.ProgressLocation.SourceControl},()=>this.commitChangesCore(e))}catch(r){if(r instanceof _t){m.window.showInformationMessage(je("no changes to commit","There are no changes to commit."));return}L.error(r),m.window.showErrorMessage(je("commit unable","Unable to commit.")),this.telemetryService.sendException(r)}}async commitChangesCore(e){const r=e.rootUri;this.telemetryService.sendEvent("commit",{staging:String(this.staging.enabled)});const n=new ut(`VirtualSourceControl.commitChanges(${r.toString()})`);let i;try{const o=await this.providerService.getMetadata(r);let c,l;const d=this.staging.enabled?this.staging.smart?"auto":!0:!1;for(;;){const S=e.inputBox.value;if(await this.changeStore.hasMergeConflicts(r)){e.inputBox.showValidationMessage(je("commit resolve conflicts","You must resolve any pending conflicts before committing."),m.SourceControlInputBoxValidationType.Error),this.telemetryService.sendEvent("commit.abort",{reason:"aborted conflicts"}),i=": Aborted; Unresolved conflicts";return}const O=await this.providerService.getCommitOperations(r,this.changeStore,{staged:d});if(O.length===0){e.inputBox.showValidationMessage(this.staging.enabled?je("commit no staged changes","There are no staged changes to commit."):je("commit no changes","There are no changes to commit."),m.SourceControlInputBoxValidationType.Information),this.telemetryService.sendEvent("commit.abort",{reason:this.staging.enabled?"aborted no staged changes":"aborted no changes"}),i=`: Aborted; No ${this.staging.enabled?"staged ":""}changes`;return}if(!S){e.inputBox.showValidationMessage(je("specify commit message","You must specify a commit message before committing."),m.SourceControlInputBoxValidationType.Error),this.telemetryService.sendEvent("commit.abort",{reason:"aborted no message"}),i=": Aborted; No message";return}let I,P;if(o.HEAD.type===Pe.RemoteBranch?(P=o.HEAD.branch.remote.accessLevel<Ne.Write,I=P&&o.accessLevel<Ne.Write):(I=o.accessLevel<Ne.Write,P=I),l===void 0&&I&&(l=await this.providerService.getFork(r),l===void 0)){const $={title:je("fork confirm","Fork Repository")},N={title:je("cancel","Cancel"),isCloseAffordance:!0};if(await m.window.showInformationMessage(je("fork","You\u2019re trying to make changes in a project you don\u2019t have write access to. Do you want to create a fork of this project to commit your proposed changes to?"),{modal:!0,useCustom:!0},$,N)!==$){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned fork prompt"}),i=": Aborted; Abandoned fork prompt";return}if(l=await m.window.withProgress({location:m.ProgressLocation.Notification,title:je("fork progress","Forking {0}...",o.name)},()=>this.providerService.fork(r)),l===void 0){m.window.showErrorMessage(je("unable to fork","Unable to fork repository.")),this.telemetryService.sendEvent("commit.abort",{reason:"aborted fork failed"}),i=": Aborted; Fork failed";return}}if(l||P){if(l===void 0){const N={title:je("remote branch create branch prompt confirm","Commit to New Branch")},U={title:je("cancel","Cancel"),isCloseAffordance:!0};if(await m.window.showErrorMessage(je("remote branch create branch prompt",`You\u2019re trying to make changes to a branch you don\u2019t have write access to.

Do you want to commit your changes to a new branch?`),{modal:!0,useCustom:!0},N,U)!==N){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned remote branch prompt"}),i=": Aborted; Abandoned commit to new branch prompt";return}}let $=0;try{const N=await this.providerService.getBranches(l?this.providerService.createVirtualUri(r,l):r,{query:"patch-"});for(const U of N.branches){const W=/^patch-(?<num>\d+)$/.exec(U.name);if(W==null?void 0:W.groups){const V=Number(W.groups.num);V>$&&($=V)}}}catch{}if(c=await gu(this.providerService,r,o.HEAD.sha,je("create new branch prompt","Create a new branch to commit your changes to"),je("create new branch placeholder","New branch name"),je("create new branch title","Commit \u2022 Create Branch \u2022 {0}",l?l.name:o.name),l,`patch-${$+1}`),!c){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned create branch prompt"}),i=": Aborted; Abandoned create branch prompt";return}}try{if(Y.getUseNewCommitApi())await this.providerService.createAndPushCommit(r,S,O,c,l);else{n.logStep("Creating commit");const $=await this.providerService.createCommit(r,S,O,l);n.logStep("Pushing",{message:`: Created commit ${$}`,suffix:" \u2022 Pushing..."}),await this.providerService.pushCommit(r,$,c,l)}}catch($){if($ instanceof Ot){const N={title:je("detached head prompt confirm","Commit to New Branch")},U={title:je("cancel","Cancel"),isCloseAffordance:!0};if(await m.window.showErrorMessage(je("detached head prompt",`Unable to commit your changes because you are not currently on a branch.

Do you want to commit your changes to a new branch?`),{modal:!0},N,U)!==N){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned detached head prompt"}),i=": Aborted; Abandoned commit to new branch prompt (detached head)";return}if(c=await gu(this.providerService,r,o.HEAD.sha,je("create new branch prompt","Create a new branch to commit your changes to"),je("create new branch placeholder","New branch name"),je("create new branch title","Commit \u2022 Create Branch \u2022 {0}",l?l.name:o.name),l),!c){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned detached head create branch prompt"}),i=": Aborted; Abandoned create branch prompt (detached head)";return}continue}else if($ instanceof Le){const N={title:je("push conflicts prompt pull","Pull")},U={title:je("push conflicts prompt sync","Sync (Pull & Push)")},W={title:je("cancel","Cancel"),isCloseAffordance:!0},V=await m.window.showErrorMessage(je("push conflicts prompt",`Changes have been committed since you started editing, so you must merge those changes before you can commit.

Do you want to pull or sync (pull and automatically push) your changes?`),{modal:!0},N,U,W);if(V!==N&&V!==U){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned conflicts prompt"}),i=": Aborted; Abandoned merge changes prompt";return}if(await this.sync(r,{pull:V===N,conflictResolution:on.Merge}),V===N){i=': Aborted; Chose "pull" from merge changes prompt';return}continue}else throw L.error($),i=`: Aborted; ${String($)}`,$}break}if(e.inputBox.value="",l?await this.changeStore.discardAll(r,{staged:d}):await this.changeStore.acceptAll(r,{staged:d}),Jd(Ua.HasCommitted,!0),!l&&!c)return;async function h(){if(l){const P={title:je("commit to fork confirm","Switch to Fork")},$={title:je("cancel","Cancel"),isCloseAffordance:!0},N=await m.window.showInformationMessage(je("commit to fork","Committed changes to your fork of {0}. Do you want to switch to your fork to continue making changes?",o.name),{modal:!0,useCustom:!0},P,$);if(this.telemetryService.sendEvent("commit.switchToFork",{confirm:String(N===P)}),N===P){let U;c!==void 0?U={type:tt.Branch,id:c}:o.HEAD.branch!==void 0&&(U={type:tt.Branch,id:o.HEAD.branch.name}),gn({name:l.name,uri:this.providerService.createVirtualUri(r,{repo:l.repo,ref:U}),location:$t.CurrentWindow})}return}const S={title:je("commit to new branch confirm","Switch to Branch")},O={title:je("cancel","Cancel"),isCloseAffordance:!0},I=await m.window.showInformationMessage(je("commit to new branch","Committed changes to new branch '{0}'. Do you want to switch to the new branch to continue making changes?",c),{modal:!0,useCustom:!0},S,O);this.telemetryService.sendEvent("commit.switchToBranch",{confirm:String(I===S)}),I===S&&gn({name:o.name,uri:this.providerService.createVirtualUri(r,{repo:o.repo,ref:c?{type:tt.Branch,id:c}:void 0}),location:$t.CurrentWindow})}a(h,"showSwitchToPrompt"),h.call(this)}finally{n.stop(i?{message:i}:void 0)}}async createPullRequest(e,r){try{await m.window.withProgress({location:m.ProgressLocation.SourceControl},()=>this.createPullRequestCore(e,r))}catch(n){if(n instanceof _t){m.window.showInformationMessage(je("no changes to commit","There are no changes to commit."));return}if(n instanceof vr){m.window.showErrorMessage(je("commit unable","Unable to commit."));return}L.error(n),m.window.showErrorMessage(je("unable to open pr","Unable to open a pull request.")),this.telemetryService.sendException(n)}}async createPullRequestCore(e,r){var n,i;const o=e.rootUri,c=(n=r==null?void 0:r.draft)!=null?n:!1;this.telemetryService.sendEvent("createPullRequest",{draft:String(c),staging:String(this.staging.enabled)});const l=new ut(`VirtualSourceControl.createPullRequest(${o.toString()})`);let d;try{let h=a(function(){this.telemetryService.sendEvent("createPullRequest.abort",{reason:"abandoned branch prompt"}),d=": Aborted; Abandoned commit to new branch prompt"},"handleBranchNotCreated"),S;const O=this.staging.enabled?this.staging.smart?"auto":!0:!1;if(!(r==null?void 0:r.sha)){if(await this.changeStore.hasMergeConflicts(o)){e.inputBox.showValidationMessage(je("commit resolve conflicts","You must resolve any pending conflicts before committing."),m.SourceControlInputBoxValidationType.Error),this.telemetryService.sendEvent("createPullRequest.abort",{reason:"aborted conflicts"}),d=": Aborted; Unresolved conflicts";return}if(S=await this.providerService.getCommitOperations(o,this.changeStore,{staged:this.staging.enabled?this.staging.smart?"auto":!0:!1}),S.length===0){e.inputBox.showValidationMessage(this.staging.enabled?je("commit no staged changes","There are no staged changes to commit."):je("commit no changes","There are no changes to commit."),m.SourceControlInputBoxValidationType.Information),this.telemetryService.sendEvent("createPullRequest.abort",{reason:this.staging.enabled?"aborted no staged changes":"aborted no changes"}),d=`: Aborted; No ${this.staging.enabled?"staged ":""}changes`;return}}const I=e.inputBox.value;if(!I){e.inputBox.showValidationMessage(je("specify commit message","You must specify a commit message before committing."),m.SourceControlInputBoxValidationType.Error),this.telemetryService.sendEvent("createPullRequest.abort",{reason:"aborted no message"}),d=": Aborted; No message";return}const P=await this.providerService.getMetadata(o);let $,N;P.HEAD.type===Pe.RemoteBranch?(N=P.HEAD.branch.remote.accessLevel<Ne.Write,$=N&&P.accessLevel<Ne.Write):($=P.accessLevel<Ne.Write,N=$);let U=r==null?void 0:r.fork;if(U===void 0&&$&&(U=await this.providerService.getFork(o),U===void 0)){const ke={title:je("fork confirm","Fork Repository")},Ie={title:je("cancel","Cancel"),isCloseAffordance:!0};if(await m.window.showInformationMessage(je("fork",`You\u2019re trying to make changes in a project you don\u2019t have write access to.

Do you want to create a fork of this project to commit your proposed changes to?`),{modal:!0,useCustom:!0},ke,Ie)!==ke){this.telemetryService.sendEvent("createPullRequest.abort",{reason:"abandoned fork prompt"}),d=": Aborted; Abandoned fork prompt";return}if(U=await m.window.withProgress({location:m.ProgressLocation.Notification,title:je("fork progress","Forking {0}...",P.name)},()=>this.providerService.fork(o)),U===void 0){m.window.showErrorMessage(je("unable to fork","Unable to fork repository.")),this.telemetryService.sendEvent("createPullRequest.abort",{reason:"aborted fork failed"}),d=": Aborted; Fork failed";return}}const W=await m.window.showInputBox({ignoreFocusOut:!0,placeHolder:je("create pr placeholder","Pull request title"),prompt:je("create pr prompt","Enter a title for the new pull request"),title:je("create pr title","New Pull Request"),value:I});if(!W){this.telemetryService.sendEvent("createPullRequest.abort",{reason:"abandoned title prompt"}),d=": Aborted; Abandoned title prompt";return}async function V(ke){let Ie=0;try{const Oe=await this.providerService.getBranches(U?this.providerService.createVirtualUri(o,U):o,{query:"patch-"});for(const Ze of Oe.branches){const $e=/^patch-(?<num>\d+)$/.exec(Ze.name);if($e==null?void 0:$e.groups){const ze=Number($e.groups.num);ze>Ie&&(Ie=ze)}}}catch{}return gu(this.providerService,o,ke,je("create pr branch prompt","Create a new branch for this pull request"),je("create pr branch placeholder","New branch name"),je("create pr branch title","New Pull Request \u2022 Create Branch \u2022 {0}",U?U.name:P.name),U,`patch-${Ie+1}`)}a(V,"createBranch");let ie;if(Y.getUseNewCommitApi()){if(ie=await V.call(this,P.HEAD.sha),!ie){h.call(this);return}(S==null?void 0:S.length)&&await this.providerService.createAndPushCommit(o,I,S,ie,U)}else{let ke;if((S==null?void 0:S.length)?(ke=await this.providerService.createCommit(o,I,S,U),l.log({message:`: Created commit ${ke}`})):(ke=(i=r==null?void 0:r.sha)!=null?i:P.HEAD.sha,l.log({message:`: Using commit ${ke}`})),ie=await V.call(this,ke),!ie){h.call(this);return}}const oe=await this.providerService.createPullRequest(o,ie,W,{draft:c},U);e.inputBox.value="",(S==null?void 0:S.length)&&(U?await this.changeStore.discardAll(o,{staged:O}):await this.changeStore.acceptAll(o,{staged:O}));async function ge(){const ke={title:je("created pr notification confirm","Switch to Pull Request")},Ie={title:je("cancel","Cancel"),isCloseAffordance:!0},Oe=await m.window.showInformationMessage(je("created pr notification",'Created [Pull Request #{0}]({1} "Open Pull Request #{0} on {2}") for {3}. Do you want to switch to the new pull request?',oe.id,oe.uri.toString(!0),P.provider.name,P.name),{modal:!0,useCustom:!0},ke,Ie);this.telemetryService.sendEvent("createPullRequest.switchToPullRequest",{confirm:String(Oe===ke)}),Oe===ke&&gn({name:P.name,uri:this.providerService.createVirtualUri(o,{repo:P.repo,ref:{type:tt.PullRequest,id:oe.id}}),location:$t.CurrentWindow})}a(ge,"showSwitchToPrompt"),ge.call(this)}finally{l.stop(d?{message:d}:void 0)}}async update(e){const r=m.workspace.getWorkspaceFolder(e);if(r===void 0)return;const n=await this.createOrUpdateScmProvider(e,r.name),i=await this.changeStore.getGroupedChanges(e,{predicate:d=>d.fileType===m.FileType.File}),o=await Promise.all(i.conflicts.map(async d=>({type:d.type,resourceUri:d.uri,command:await this.changeStore.resolveDiffCommand(d.uri,d.conflicts.incomingUri,je("diff title with conflicts","{0} (Incoming Changes \u2194 Current Changes)",de(d.uri)))}))),c=await Promise.all(i.staged.map(async d=>({type:d.type,resourceUri:d.uri,command:await this.changeStore.resolveDiffCommand(d.uri,this.providerService.getProviderUri(d.uri),je("diff title index","{0} (Index)",de(d.uri)))}))),l=await Promise.all(i.working.map(async d=>({type:d.type,resourceUri:d.uri,decorations:{strikeThrough:d.type===Dt.Deleted},command:await this.changeStore.resolveDiffCommand(d.uri,this.providerService.getProviderUri(d.uri),je("diff title working","{0} (Working Tree)",de(d.uri)))})));return this.ensureMergeConflictsGroup(n).resourceStates=o,this.ensureStagedChangesGroup(n).resourceStates=this.staging.enabled?c:[],this.ensureWorkingChangesGroup(n).resourceStates=this.staging.enabled?l:[...c,...l],n}async createOrUpdateScmProvider(e,r){const n=await this.providerService.getMetadata(e),i=this.providerService.isReadonly(e);let o;const c=n.HEAD.branch?n.HEAD.name:void 0;let l=this.getScmProvider(e);if(l===void 0){r=n.name,o=m.scm.createSourceControl(`remoteHub:${n.provider.id}`,r,e),o.quickDiffProvider={provideOriginalResource:h=>this.providerService.getProviderUri(h)};const d=this.providerService.createIGitRepository(e,o,n,this.changeStore);l={id:n.provider.id,name:n.provider.name,sourceControl:o,groups:[],repository:d,isReadonly:i},this.ensureMergeConflictsGroup(l),this.ensureStagedChangesGroup(l),this.ensureWorkingChangesGroup(l),this._scmProviders.push(l)}else o=l.sourceControl;return n.accessLevel>=Ne.Write?(o.acceptInputCommand={command:"remoteHub.commit",title:je("scm input accept command title commit","Commit"),arguments:[o]},c?o.inputBox.placeholder=je("scm input placeholder commit","Message (Ctrl+Enter to commit directly to '{0}' on {1})",c,n.provider.name):o.inputBox.placeholder=je("scm input placeholder commit","Message (Ctrl+Enter to commit directly to {0})",n.provider.name),Y.get("commitDirectlyWarning")===K.Off?o.inputBox.validateInput=void 0:o.inputBox.validateInput=d=>{if(Y.get("commitDirectlyWarning")===K.Auto&&Op(Ua.HasCommitted))return;const h=new m.MarkdownString(c?je("scm input validation commit branch directly","Your changes will be committed directly to the '{0}' branch on {1}.",c,n.provider.name):je("scm input validation commit directly","Your changes will be committed directly to {0}.",n.provider.name));return h.isTrusted=!0,h.appendMarkdown(`&nbsp; [${je("scm input validation action","Don't show again")}](command:remoteHub.disableCommitDirectlyWarning '${je("scm input validation action tip","Hide")}')`),{message:h,type:m.SourceControlInputBoxValidationType.Information}}):i?(o.acceptInputCommand=void 0,o.inputBox.placeholder=je("scm input readonly placeholder","Committing is not available for readonly repositories.")):(o.acceptInputCommand={command:"remoteHub.createPullRequest",title:je("scm input accept command title pr","Create a Pull Request"),arguments:[o]},o.inputBox.placeholder=je("scm input placeholder pr","Message (Ctrl+Enter to create a pull request for '{0}'",r)),await this.updateStatusBarCommands(l,{syncing:!1},n),l}async updateStatusBarCommands(e,r,n){var i,o,c;const l=e.sourceControl.rootUri;n=n!=null?n:await this.providerService.getMetadata(l);const{HEAD:d}=n,h=await this.providerService.getIndexMetadata(l),S=(h==null?void 0:h.type)===ft.Active,O=(h==null?void 0:h.type)===ft.Active,I=ft.hasIndex(h==null?void 0:h.type),P=await this.changeStore.hasChanges(l),$=Gd(d.type),N=[];if(N.push($r({command:"remoteHub.switchToBranch",title:`${$} ${d.name}${P?"*":""}`,tooltip:`${wt(d.sha)}`,arguments:[{uri:l,commands:!0}]})),d.detached||((r==null?void 0:r.syncing)?N.push($r({command:"",title:"$(sync~spin)",tooltip:je("sync command syncing","Syncing Changes..."),arguments:[]})):N.push($r({command:"remoteHub.sync",title:`$(sync)${((o=(i=n.state)==null?void 0:i.behind)!=null?o:0)>0?` ${(c=n.state)==null?void 0:c.behind}\u2193`:""}`,tooltip:S||O?je("sync index","Sync to latest indexed commit"):je("sync command","Sync (Pull & Push)"),arguments:[{uri:l}]}))),n.pullRequest&&N.push($r({command:"remoteHub.openOnRemote",title:`$(git-pull-request) ${n.pullRequest.id}`,tooltip:je("scm statusbar command open pr",`Open Pull Request #{0} on {1}

{2}`,n.pullRequest.id,n.provider.name,n.pullRequest.title),arguments:[{provider:n.provider,repo:n.repo,pullRequest:{id:n.pullRequest.id}}]})),I){const U=this.providerService.getIndexProvider(l);U&&N.push(...await U.getStatusBarContributions(l))}e.sourceControl.statusBarCommands=N}ensureMergeConflictsGroup(e){const r="conflicts";let n=e.groups.find(i=>i.id===r);return n===void 0&&(n=e.sourceControl.createResourceGroup(r,je("scm group conflicts","Merge Conflicts")),n.hideWhenEmpty=!0,e.groups.push(n)),n}ensureStagedChangesGroup(e){const r="staged";let n=e.groups.find(i=>i.id===r);return n===void 0&&(n=e.sourceControl.createResourceGroup(r,je("scm group staged","Staged Changes")),n.hideWhenEmpty=!0,e.groups.push(n)),n}ensureWorkingChangesGroup(e){const r="changes";let n=e.groups.find(i=>i.id===r);return n===void 0&&(n=e.sourceControl.createResourceGroup(r,je("scm group changes","Changes")),e.groups.push(n)),n}getScmProvider(e){const r=te(e);return this._scmProviders.find(n=>te(n.sourceControl.rootUri)===r)}getSourceControlFrom(e){if(e===void 0){if(this._scmProviders.length!==1)return;e=this._scmProviders[0].sourceControl}let r;if(iy(e))r=e;else if(gp(e)){const n=e,i=this._scmProviders.find(o=>o.groups.includes(n));r=i==null?void 0:i.sourceControl}else if(Vd(e)){const n=e,i=this._scmProviders.find(o=>o.groups.some(c=>c.resourceStates.includes(n)));r=i==null?void 0:i.sourceControl}else{if(this._scmProviders.length!==1)return;r=this._scmProviders[0].sourceControl}return r}}a(pp,"VirtualSourceControl");function iy(t){return"rootUri"in t&&"inputBox"in t}a(iy,"isSourceControl");function gp(t){return t!==void 0&&"id"in t&&"label"in t&&"resourceStates"in t&&Array.isArray(t.resourceStates)}a(gp,"isSourceControlResourceGroup");function Vd(t){return t!==void 0&&"resourceUri"in t&&t.resourceUri instanceof m.Uri}a(Vd,"isSourceControlResourceState");function sl(t){return"type"in t}a(sl,"isTrackedChange");async function Kd(t){var e,r,n;if(t.length===0)return!0;let i,o=je("discard","Discard Changes");if(t.length===1){const l=t[0];l.type===Dt.Created?(i=je("confirm delete",`Are you sure you want to DELETE {0}?
This is IRREVERSIBLE!
This file will be FOREVER LOST.`,de((e=l.resourceUri)!=null?e:l.uri)),o=je("delete file","Delete file")):l.type===Dt.Deleted?(o=je("restore file","Restore file"),i=je("confirm restore","Are you sure you want to restore {0}?",de((r=l.resourceUri)!=null?r:l.uri))):i=je("confirm discard","Are you sure you want to discard changes in {0}?",de((n=l.resourceUri)!=null?n:l.uri))}else t.every(l=>l.type===Dt.Created)?i=je("confirm delete multiple",`Are you sure you want to DELETE {0} files?
This is IRREVERSIBLE!
These files will be FOREVER LOST.`,t.length):t.every(l=>l.type===Dt.Deleted)?(o=je("restore files","Restore files"),i=je("confirm restore multiple","Are you sure you want to restore {0} files?",t.length)):i=je("confirm discard multiple","Are you sure you want to discard changes in {0} files?",t.length);return await m.window.showWarningMessage(i,{modal:!0,useCustom:!0},o)===o}a(Kd,"confirmDiscard");async function cl(t,e,r){if(t.length===0)return;if(t.length===1)return t[0].sourceControl.rootUri;const n=await m.window.showQuickPick(t.map(({sourceControl:i})=>({label:i.label,uri:i.rootUri})),{placeHolder:e,title:r});if(!!n)return n.uri}a(cl,"getOrPickRootUri");async function gu(t,e,r,n,i,o,c,l){const d=new Set;let h;const S=m.window.createInputBox();S.ignoreFocusOut=!0;try{return await new Promise((O,I)=>{h=m.Disposable.from(S.onDidHide(()=>O(void 0)),S.onDidChangeValue(P=>{if(P=P.trim(),!P){S.validationMessage=je("scm create branch prompt validation missing name","Please enter a valid branch name");return}if(d.has(P)){S.validationMessage=je("scm create branch prompt validation already exists","Branch '{0}' already exists",P);return}if(!Ir(P)){S.validationMessage=je("scm create branch prompt validation invalid name","'{0}' isn't a valid branch name",P);return}S.validationMessage=void 0}),S.onDidAccept(async()=>{const P=S.value;try{S.enabled=!1,S.busy=!0;const $=await t.createBranch(e,P,r,c);O($)}catch($){if($ instanceof Be){S.enabled=!0,S.busy=!1,S.validationMessage=$.duplicate?je("scm create branch prompt validation already exists","Branch '{0}' already exists",P):je("scm create branch prompt validation invalid","Invalid branch name '{0}'",P),d.add(P);return}I($)}})),S.prompt=n,S.placeholder=i,S.title=o,l&&(S.value=l),S.show()})}finally{S.dispose(),h==null||h.dispose()}}a(gu,"createBranchWithPrompt");class mu{constructor(e,r){this.memento=e,this.scope=r,this._onDidChange=new m.EventEmitter}get onDidChange(){return this._onDidChange.event}async get(e){const r=this.getScoped(e),n=new ut(`MementoStorage.get(${e}): scopedKey=${r}`,{logLevel:qe.Debug});try{return await Promise.resolve(this.memento.get(r))}finally{n.stop()}}async getKeys(e){const r=this.getScoped(e),n=new ut(`MementoStorage.getKeys(${e}): scopedPrefix=${r}`,{logLevel:qe.Debug});try{let i=this.getKeysCore(e);if(this.scope!==void 0){const o=this.scope.length+1;i=i.map(c=>c.substr(o))}return await Promise.resolve(i)}finally{n.stop()}}getKeysCore(e){let r=this.memento.keys();return e&&(r=r.filter(n=>n.startsWith(e))),r}async store(e,r){const n=this.getScoped(e),i=new ut(`MementoStorage.store(${e}): scopedKey=${n}`,{logLevel:qe.Debug});try{return await this.storeCore(e,n,r)}finally{i.stop()}}async storeCore(e,r,n){await this.memento.update(r,n),this._onDidChange.fire({key:e})}async delete(e){const r=this.getScoped(e),n=new ut(`MementoStorage.delete(${e}): scopedKey=${r}`,{logLevel:qe.Debug});try{return await this.storeCore(e,r,void 0)}finally{n.stop()}}async deleteKeys(e){const r=this.getScoped(e),n=new ut(`MementoStorage.deleteKeys(${e}): scopedPrefix=${r}`,{logLevel:qe.Debug});try{const i=[],o=this.scope!==void 0?this.scope.length+1:0,c=this.getKeysCore(r);for(const l of c){const d=o!==0?l.substr(o):l;L.debug(`MementoStorage.deleteKeys(${e}): Deleting key=${d}, scopedKey=${l}`);try{await this.storeCore(d,l,void 0)}catch(h){L.debug(`MementoStorage.deleteKeys(${e}): Failed to delete key=${d}, scopedKey=${l}`),i.push(d)}}if(i.length)throw new Error(`Failed to delete keys: ${i.join(", ")}`)}finally{n.stop()}}with(e){return new mu(this.memento,e)}getScoped(e){return`${this.scope!==void 0?`${this.scope}/`:""}${e!=null?e:""}`}}a(mu,"MementoStorageService");class vu{constructor(e,r){this.storageUri=e,this.scope=r,this._onDidChange=new m.EventEmitter}get onDidChange(){return this._onDidChange.event}async get(e){const r=this.getScoped(e),n=new ut(`ExtFileStorageService.get(${e}): scopedKey=${r}`,{logLevel:qe.Debug});try{return await m.workspace.fs.readFile(m.Uri.joinPath(this.storageUri,r))}catch(i){return}finally{n.stop()}}async store(e,r){const n=this.getScoped(e),i=new ut(`ExtFileStorageService.store(${e}): scopedKey=${n}`,{logLevel:qe.Debug});try{return await this.storeCore(e,n,r)}finally{i.stop()}}async storeCore(e,r,n){await m.workspace.fs.writeFile(m.Uri.joinPath(this.storageUri,r),n),this._onDidChange.fire({key:e})}async delete(e){const r=this.getScoped(e),n=new ut(`ExtFileStorageService.delete(${e}): scopedKey=${r}`,{logLevel:qe.Debug});try{return await m.workspace.fs.delete(m.Uri.joinPath(this.storageUri,r))}finally{n.stop()}}with(e){return new vu(this.storageUri,e)}getScoped(e){return`${this.scope!==void 0?`${this.scope}/`:""}${e}`}}a(vu,"ExtFileStorageService");const wr=(0,B.loadMessageBundle)();class Ji extends m.TimelineItem{static is(e){return e instanceof Ji}constructor(e,r,n,i,{dateType:o,showAuthor:c,dateFormatter:l}){var d;const h=n.message.indexOf(`
`),S=h!==-1?`${n.message.substring(0,h)} \u2026`:n.message,O=o==="authored"?n.authorDate:n.commitDate;super(S,(d=O==null?void 0:O.getTime())!=null?d:0);this.id=n.hash,this.contextValue=`vscode-vfs:${r}:file:commit`,this.command=i,c&&(this.description=n.authorName),this.detail=wr("timeline item detail",`{0} ({1}) \u2014 {2}
{3}

{4}`,n.authorName,n.authorEmail,wt(n.hash),l.format(O),n.message),this.iconPath=new m.ThemeIcon("git-commit"),this.rootUri=e,this.providerId=r,this.hash=n.hash,this.parents=n.parents,this.message=n.message}}a(Ji,"CommitTimelineItem");class Ha extends m.TimelineItem{static is(e){return e instanceof Ha}constructor(e,r,n,i,o,{dateFormatter:c,staged:l}){const d=l?wr("timeline staged changes","Staged Changes"):wr("timeline uncommitted changes","Uncommitted Changes");super(d,n.timestamp);this.id=l?"index":"working",this.contextValue=`vscode-vfs:${r}:file:${this.id}`,this.command=o,this.iconPath=new m.ThemeIcon("git-commit"),l?this.detail=wr("timeline index detail",`{0}  \u2014 {1}
{2}

{3}`,wr("timeline you","You"),wr("timeline index","Index"),c.format(new Date(n.timestamp)),wl(n.type)):this.detail=wr("timeline working detail",`{0}  \u2014 {1}
{2}

{3}`,wr("timeline you","You"),wr("timeline working","Working Tree"),c.format(new Date(n.timestamp)),wl(n.type)),this.rootUri=e,this.providerId=r,this.hash=l?"~":"",this.parents=i,this.message=d}}a(Ha,"ChangeOperationTimelineItem");class mp{constructor(e,r){this.providerService=e,this.changeStore=r,this._onDidChange=new m.EventEmitter,this.id="github-file-history",this.label=wr("timeline.source","GitHub File History"),this.debouncer=new us(500),this.disposable=m.Disposable.from(this.debouncer,e.onDidChangeProviders(this.onProvidersChanged,this),e.onDidChangeRepositories(this.onRepositoriesChanged,this),e.onDidChangeRepository(this.onRepositoryChanged,this),e.onDidRefresh(this.onRefresh,this),r.onDidChange(this.onUrisChanged,this),Y.onDidChangeAny(this.onConfigurationChanged,this),...this.registerCommands()),e.hasProviders&&this.ensureProviderRegistration()}get onDidChange(){return this._onDidChange.event}dispose(){var e;(e=this.providerDisposable)==null||e.dispose(),this.disposable.dispose()}onConfigurationChanged(e){(e.affectsConfiguration("git.timeline.date")||e.affectsConfiguration("git.timeline.showAuthor"))&&this.fireChanged()}onProvidersChanged(e){this.ensureProviderRegistration(),this.fireChanged()}onRefresh(e){if(this.rootUri===void 0)return;const r=te(this.rootUri);!e.some(n=>te(n)===r)||this.fireChanged()}onRepositoriesChanged(e){if(this.rootUri===void 0)return;const r=te(this.rootUri);(e.added.some(n=>te(n.uri)===r)||e.removed.some(n=>te(n.uri)===r))&&this.fireChanged()}onRepositoryChanged(e){this.rootUri===void 0||te(this.rootUri)!==te(e.repository.uri)||this.fireChanged()}onUrisChanged(e){if(this.rootUri===void 0)return;const r=te(this.rootUri);e.some(n=>te(n.rootUri)===r)&&this.fireChanged()}async provideTimeline(e,r,n){var i;try{this.rootUri=this.providerService.getVirtualRootUri(e);for(const $ of this.providerService.repositories)if($.uri.path===this.rootUri.path){this.rootUri=$.uri;break}const o=this.providerService.getRelativeFilePath(this.rootUri,e),c=await this.providerService.getMetadata(this.rootUri);if(!c||n.isCancellationRequested)return{items:[]};const l=await this.providerService.getCommits(this.rootUri,{ref:c.HEAD.sha,path:o||void 0,cursor:r.cursor,limit:typeof r.limit=="number"?r.limit:void 0});if(l===void 0||l.commits.length===0||n.isCancellationRequested)return{items:[]};const d=((i=l.paging)==null?void 0:i.more)?{cursor:l.paging.cursor}:void 0,h=new Intl.DateTimeFormat(m.env.language,{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"}),S=Y.getAny("git.timeline.date",void 0,"committed"),O=Y.getAny("git.timeline.showAuthor",void 0,!0),I=l.commits.map($=>new Ji(this.rootUri,c.provider.id,$,this.resolveDiffCommand($,c,e,o),{dateType:S,showAuthor:O,dateFormatter:h})),P=r.cursor===void 0?await this.changeStore.getChange(e):void 0;if(P){const $=Boolean(P.staged&&Y.get("staging.enabled")),N=new Ha(this.rootUri,c.provider.id,P,[l.commits[0].hash],await this.changeStore.resolveDiffCommand(P.uri,this.providerService.getProviderUri(P.uri),$?wr("diff title index","{0} (Index)",de(P.uri)):wr("diff title working","{0} (Working Tree)",de(P.uri))),{dateFormatter:h,staged:$});I.splice(0,0,N)}return{items:I,paging:d}}catch(o){return L.error(o),{items:[]}}}ensureProviderRegistration(){this.providerDisposable===void 0&&(this.providerDisposable=m.workspace.registerTimelineProvider([Qt.scheme,...this.providerService.registeredProviders.map(e=>e.id)],this))}fireChanged(){this.debouncer.debounce(()=>this._onDidChange.fire(void 0))}registerCommands(){let e;return[m.commands.registerCommand("remoteHub.timeline.copyCommitId",(r,n,i)=>{!Ji.is(r)||m.env.clipboard.writeText(r.hash)}),m.commands.registerCommand("remoteHub.timeline.copyCommitMessage",(r,n,i)=>{!Ji.is(r)||m.env.clipboard.writeText(r.message)}),m.commands.registerCommand("remoteHub.timeline.openDiff",async(r,n,i)=>{var o;!Ji.is(r)&&!Ha.is(r)||r.command!==void 0&&await m.commands.executeCommand(r.command.command,...(o=r.command.arguments)!=null?o:[])}),m.commands.registerCommand("remoteHub.timeline.openOnGitHub",async r=>{await this.openOnRemote(r)}),m.commands.registerCommand("remoteHub.timeline.openOnAzureRepos",async r=>{await this.openOnRemote(r)}),m.commands.registerCommand("remoteHub.timeline.selectForCompare",async(r,n,i)=>{!n||!Ji.is(r)&&!Ha.is(r)||(e={uri:n,left:r},await m.commands.executeCommand("setContext","remoteHub.timeline.selectedForCompare",!0))}),m.commands.registerCommand("remoteHub.timeline.compareWithSelected",async(r,n,i)=>{if(!n||!e||!Ji.is(r)&&!Ha.is(r)||te(n)!==te(e.uri))return;const{left:o}=e,c=this.providerService.getRelativeFilePath(r.rootUri,n),l=await this.providerService.getMetadata(r.rootUri),d=de(n),h=o.parents[0];let S;h===void 0?S=wr("timeline diff title ref","{0} ({1})",d,wt(r.hash)):o.hash===""?S=wr("timeline diff title working","{0} (Working Tree)",d):o.hash==="~"?S=wr("timeline diff title index","{0} (Index)",d):S=wr("timeline diff title ref","{0} ({1})",d,wt(o.hash));let O=o.hash===""||o.hash==="~"?n:this.providerService.createProviderUri(n,{repo:l.repo,ref:{type:tt.Commit,id:h!=null?h:"0000000000000000000000000000000000000000"}},c);h===void 0&&(O=O.with({query:"~"}));const I=r.parents[0];let P;I===void 0?P=wr("timeline diff title ref","{0} ({1})",d,wt(r.hash)):I==="~"&&r.hash===""?P=wr("timeline diff title working","{0} (Working Tree)",d):r.hash==="~"?P=wr("timeline diff title index","{0} (Index)",d):P=wr("timeline diff title ref","{0} ({1})",d,wt(r.hash));const $=wr("timeline diff title","{0} \u27F7 {1}",S,P),N=r.hash===""||r.hash==="~"?n:this.providerService.createProviderUri(n,{repo:l.repo,ref:{type:tt.Commit,id:r.hash}},c);await m.commands.executeCommand("vscode.diff",O,N,$)})]}resolveDiffCommand(e,r,n,i,o){const c=de(n),l=e.parents[0];let d;l===void 0?d=wr("timeline diff title ref","{0} ({1})",c,wt(e.hash)):e.hash===""?d=wr("timeline diff title working","{0} (Working Tree)",c):e.hash==="~"?d=wr("timeline diff title index","{0} (Index)",c):d=wr("timeline diff title refs","{0} ({1}) \u27F7  {0} ({2})",c,wt(l),wt(e.hash));let h=this.providerService.createProviderUri(n,{repo:r.repo,ref:{type:tt.Commit,id:l!=null?l:"0000000000000000000000000000000000000000"}},i);l===void 0&&(h=h.with({query:"~"}));const S=e.hash===""||e.hash==="~"?n:this.providerService.createProviderUri(n,{repo:r.repo,ref:{type:tt.Commit,id:e.hash}},i);return{command:"vscode.diff",title:"Open Comparison",arguments:[h,S,d,o]}}async openOnRemote(e){if(!Ji.is(e))return;const r=await this.providerService.getMetadata(e.rootUri);await ya("remoteHub.openOnRemote",{provider:r.provider,repo:r.repo,sha:e.hash})}}a(mp,"VirtualTimelineProvider");class vp{constructor(e,r){this.providerService=e,this.telemetryService=r,this.disposable=m.window.registerUriHandler(this)}dispose(){this.disposable.dispose()}async handleUri(e){var r;const n=new ut(`RemoteUriHandler.handleUri(${e.path}, ${e.toString()})`);try{switch(e.path){case"/open":{this.telemetryService.sendEvent("handleUri.open");let i,o;for(const l of e.query.split("&")){const[d,h]=l.split("=");switch(d){case"url":i=decodeURIComponent(h);break;case"location":o=h===$t.CurrentWindow?$t.CurrentWindow:$t.NewWindow;break}}if(!i){n.log({message:": Unable to find url parameter"}),this.telemetryService.sendEvent("handleUri.open.abort",{reason:"aborted url not found"});return}i=i.trim(),o=o!=null?o:$t.NewWindow;const c=await this.providerService.createWorkspaceForRemoteUrl(i,void 0,o);if(!c){n.log({message:`: Unable to open workspace for ${i}`}),this.telemetryService.sendEvent("handleUri.open.abort",{reason:"aborted invalid url"});return}n.log({message:`: Opening ${i} in ${o}`}),gn(c);break}case"/open-files":{let i;for(const c of e.query.split("&")){const[l,d]=c.split("=");if(l==="url"){i=decodeURIComponent(d);break}}if(!i){n.log({message:": Unable to find url parameter"});return}i=i.trim();const o=await this.providerService.createWorkspaceForRemoteUrl(i);if(!o){n.log({message:`: Unable to open files/folders for ${i}`});return}o.filesToOpen?(n.log({message:`: Opening files/folders for ${i}`}),await((r=wu())==null?void 0:r.openPendingFiles(o.uri,o.filesToOpen))):n.log({message:`: No files/folders found to open for ${i}`});break}case"/login":{dt.fire(e);break}default:{n.log({message:`: Unknown Uri ${e.toString()}`});break}}}finally{n.stop()}}}a(vp,"RemoteUriHandler");const Nn=(0,B.loadMessageBundle)(),ll=a(class{constructor(t,e,r,n){this.providerService=t,this.storageService=e,this.changeStore=r,this.workspaceId=n,this._onDidChange=new m.EventEmitter,this.cache=new Map,this.lock=new Sn("WorkspaceRepositories"),this.disposable=m.Disposable.from(this.providerService.onDidChangeRepositories(this.onRepositoriesChanged,this),this.providerService.onDidChangeRepository(this.onRepositoryChanged,this),this.changeStore.onDidChange(this.onChangeStoreChanged,this))}get onDidChange(){return this._onDidChange.event}dispose(){this.disposable.dispose()}async exportDebugInfo(){const t=await m.workspace.openTextDocument({language:"json",content:`Remote Repositories

${this.toStorage(await this.getCore())}`});return void m.window.showTextDocument(t)}onChangeStoreChanged(t){const e=Fd(t.map(r=>r.rootUri),r=>te(r)).map(r=>this.providerService.getRepository(r)).filter(r=>Boolean(r));this.addOrUpdate(e)}onRepositoriesChanged(t){this.addOrUpdate(t.added)}onRepositoryChanged(t){this.addOrUpdate([t.repository])}async get(t){let e=await this.lock.synchronizeRead(async()=>{let r=this.cache.get("workspaceRepositories");return r===void 0&&(r=[...(await this.getCore()).values()].sort((n,i)=>i.timestamp-n.timestamp),this.cache.set("workspaceRepositories",r)),r},"WorkspaceRepositories.get");if(t){const r=te(t);e=e.filter(n=>te(n.canonicalUri)===r)}return e}async getCore(){return this.fromStorage(await this.storageService.get(ll.storageKey))}async getByCanonicalUri(){let t=this.cache.get("groupedWorkspaceRepositories");return t===void 0&&(t=H0(await this.get(),e=>te(e.canonicalUri)),this.cache.set("groupedWorkspaceRepositories",t)),t}async getRecents(t=10){return(await this.get()).slice(0,t)}async getRemoteWorkspaceSourceProvider(){const t=await this.getRecents();if(t.length!==0)return{name:"Recents",label:"Open Recent Repository",icon:"$(history)",placeholder:Nn("pick","Choose a recent repository"),provideSources:function(e,r,n,i){return t.map(o=>({providerId:o.provider.id,name:o.name,icon:"$(repo)",description:lo(o.timestamp,{ago:!0}),detail:`${o.provider.name}${o.pullRequest?`\xA0\xA0\u2022\xA0\xA0$(git-pull-request) Pull Request #${o.pullRequest.id}`:""}${Qt.isCanonicalUri(o.uri)?"":`\xA0\xA0\u2022\xA0\xA0${Gd(o.ref.type)} ${o.ref.name}`}\xA0\xA0\u2022\xA0\xA0${_p(o.changes)}${o.idx?`\xA0\xA0\u2022\xA0\xA0${ty(o.idx.type)}`:""}`,workspace:{uri:o.uri,name:o.name,location:$t.CurrentWindow}}))}}}refresh(){this.cache.clear()}async remove(t){await this.lock.synchronizeWrite(async()=>{const e=await this.getCore(),r=`${t.workspaceId}/${te(t.uri)}`,n=e.get(r);if(n===void 0)return;const i=this.changeStore.getScopedChangeStore(n),o=await i.getChanges(n.uri);if(o.length!==0){const c={title:Nn("remove remote repo prompt confirm","Yes")},l={title:Nn("remove remote repo prompt cancel","No"),isCloseAffordance:!0};if(await m.window.showWarningMessage(o.length===1?Nn("remove remote repo prompt file changed",`This repository contains 1 file with uncommitted changes.

Removing it will cause those changes to be FOREVER LOST.
This is IRREVERSIBLE!

Are you sure you still want to remove it?`):Nn("remove remote repo prompt files changes",`This repository contains {0} files with uncommitted changes.

Removing it will cause those changes to be FOREVER LOST.
This is IRREVERSIBLE!

Are you sure you still want to remove it?`,o.length),{modal:!0,useCustom:!0},c,l)!==c)return;await i.discardAll(n.uri)}this.cache.clear(),e.delete(r);try{await this.storageService.store(ll.storageKey,this.toStorage(e))}catch(c){throw L.error(c,"Failed to save workspace repositories"),c}},"WorkspaceRepositories.remove"),this._onDidChange.fire()}async addOrUpdate(t){await this.lock.synchronizeWrite(async()=>{this.cache.clear();const e=await this.getCore();for(const r of t){const[{HEAD:n,pullRequest:i},o]=await Promise.all([r.getMetadata(),r.getIndexMetadata()]),c=await this.changeStore.getChanges(r.uri);e.set(`${this.workspaceId}/${te(r.uri)}`,{workspaceId:this.workspaceId,uri:r.uri,canonicalUri:r.canonicalUri,name:r.name,provider:r.provider,ref:{type:n.type,name:n.name},idx:(o==null?void 0:o.type)&&ft.hasIndex(o.type)?{type:o.type}:void 0,pullRequest:i?{id:i.id}:void 0,changes:ay(c),timestamp:Date.now()})}try{await this.storageService.store(ll.storageKey,this.toStorage(e)),Si(Pn.HasRecentRepositories,e.size>0)}catch(r){throw L.error(r,"Failed to save workspace repositories"),r}},"WorkspaceRepositories.addOrUpdate"),this._onDidChange.fire()}fromStorage(t){if(!t)return new Map;try{const e=JSON.parse(t,(r,n)=>(r==="uri"||r.endsWith("Uri"))&&Ue(n)?m.Uri.from(n):n);return new Map(e.workspaceRepositories)}catch(e){return L.error(e,"Failed to deserialize workspace repositories"),new Map}}toStorage(t){const e={schemaVersion:ll.storageSchemaVersion,workspaceRepositories:[...t]};return JSON.stringify(e)}},"_WorkspaceRepositories");let Xd=ll;Xd.storageKey="workspaceRepositories",Xd.storageSchemaVersion=1;function yp(t){return t!==void 0&&(t.added!==0||t.changed!==0||t.deleted!==0)}a(yp,"hasChanges");function oy(t){return yp(t.changes)}a(oy,"hasUncommittedChanges");function ay(t){let e=0,r=0,n=0;for(const i of t)switch(i.type){case Dt.Created:e++;break;case Dt.Changed:r++;break;case Dt.Deleted:n++;break}return e||r||n?{added:e,changed:r,deleted:n,timestamp:Date.now()}:void 0}a(ay,"toChangesSummary");function _p(t,{compact:e=!0,preamble:r,separator:n=", ",short:i=!1,single:o=!1}={}){if(!yp(t))return Nn("no changes","Everything up to date");const{added:c,changed:l,deleted:d}=t;if(o){const S=c+l+d;return S===1?Nn("summary change","{0} change",S):Nn("changes changes","{0} changes",S)}let h=`${r!=null?r:""}`;return(c||!e)&&(h+=i?`+${c}`:c===1?Nn("file added","{0} file added",c):Nn("files added","{0} files added",c),(l||d||!e)&&(h+=n)),(l||!e)&&(h+=i?`~${l}`:l===1?Nn("file changed","{0} file changed",l):Nn("files changed","{0} files changed",l),(d||!e)&&(h+=n)),(d||!e)&&(h+=i?`-${d}`:d===1?Nn("file deleted","{0} file deleted",d):Nn("files deleted","{0} files deleted",d)),h}a(_p,"formatChangesSummary");var sy=Object.defineProperty,cy=Object.getOwnPropertyDescriptor,ly=a((t,e,r,n)=>{for(var i=n>1?void 0:n?cy(e,r):e,o=t.length-1,c;o>=0;o--)(c=t[o])&&(i=(n?c(e,r,i):c(i))||i);return n&&i&&sy(e,r,i),i},"view_decorateClass"),Vs;(function(t){t.Change="remoteHub:viewItem:change",t.WorkspaceRepository="remoteHub:viewItem:workspaceRepository",t.WorkspaceRepositories="remoteHub:viewItem:workspaceRepositories",t.Message="remoteHub:viewItem:message"})(Vs||(Vs={}));const wp=a(class{constructor(t,e){this.view=t,this.parent=e,this.splatted=!1}static is(t){return t instanceof wp}get id(){}toString(){return`${L.toLoggableName(this)}${this.id!==void 0?`(${this.id})`:""}`}getParent(){var t,e;return((t=this.parent)==null?void 0:t.splatted)?(e=this.parent)==null?void 0:e.getParent():this.parent}triggerChange(t=!1,e=!1,r){return this.splatted&&this.parent!==void 0&&this.parent!==r?this.parent.triggerChange(t,e):this.view.refreshNode(this,t,e)}},"_ViewNode");let Ks=wp;ly([tr((t=!1,e=!1,r)=>JSON.stringify([t,e,r==null?void 0:r.toString()]))],Ks.prototype,"triggerChange",1);class bp{constructor(e,r,n,i){this.id=e,this.name=r,this.providerService=n,this.telemetryService=i,this._onDidChangeTreeData=new m.EventEmitter,this.disposables=[];const o=!1;if(L.isDebugging&&o){const c=this.getTreeItem;this.getTreeItem=async function(l){var d;const h=await c.apply(this,[l]),S=l.getParent();return h.tooltip===void 0&&(h.tooltip=new m.MarkdownString(h.label!==void 0&&typeof h.label!="string"?h.label.label:(d=h.label)!=null?d:"")),typeof h.tooltip=="string"?h.tooltip=`${h.tooltip}

---
context: ${h.contextValue}
node: ${l.toString()}${S!==void 0?`
parent: ${S.toString()}`:""}`:h.tooltip.appendMarkdown(`

---

context: \`${h.contextValue}\`\\
node: \`${l.toString()}\`${S!==void 0?`\\
parent: \`${S.toString()}\``:""}`),h}}this.disposables.push(...this.registerCommands()),this.initialize({showCollapseAll:this.showCollapseAll}),setTimeout(()=>this.onConfigurationChanged(),0)}get onDidChangeTreeData(){return this._onDidChangeTreeData.event}get showCollapseAll(){return!0}filterConfigurationChanged(e){return!!Y.changed(e,`views.${this.configKey}`)}dispose(){m.Disposable.from(...this.disposables).dispose()}get title(){return this._title}set title(e){this._title=e,this.tree!==void 0&&(this.tree.title=e)}get description(){return this._description}set description(e){this._description=e,this.tree!==void 0&&(this.tree.description=e)}get message(){return this._message}set message(e){this._message=e,this.tree!==void 0&&(this.tree.message=e)}getQualifiedCommand(e){return`${this.id}.${e}`}onConfigurationChanged(e){e!==void 0&&this.root!==void 0&&this.refresh(!0)}initialize(e={}){this.tree=m.window.createTreeView(this.id,{...e,treeDataProvider:this}),this.disposables.push(Y.onDidChange(r=>{!this.filterConfigurationChanged(r)||(this._config=void 0,this.onConfigurationChanged(r))},this),this.tree),this._title=this.tree.title}ensureRoot(e=!1){return(this.root===void 0||e)&&(this.telemetryService.sendEvent("view.open",{view:this.id}),this.root=this.getRoot()),this.root}getChildren(e){return e!==void 0?e.getChildren():this.ensureRoot().getChildren()}getParent(e){return e.getParent()}getTreeItem(e){return e.getTreeItem()}get selection(){return this.tree===void 0||this.root===void 0?[]:[...this.tree.selection]}get visible(){return this.tree!==void 0?this.tree.visible:!1}async refresh(e=!1){var r,n;await((n=(r=this.root)==null?void 0:r.refresh)==null?void 0:n.call(r,e)),this.triggerNodeChange()}async refreshNode(e,r=!1,n=!1){var i;const o=await((i=e.refresh)==null?void 0:i.call(e,r));!n&&o===!0||this.triggerNodeChange(e)}async reveal(e,r){if(this.tree!==void 0)try{await this.tree.reveal(e,r)}catch(n){L.error(n)}}async show(){try{await m.commands.executeCommand(`${this.id}.focus`)}catch(e){L.error(e)}}triggerNodeChange(e){this._onDidChangeTreeData.fire(e!==void 0&&e!==this.root?e:void 0)}get config(){return this._config===void 0&&(this._config=Y.get("views")[this.configKey]),this._config}}a(bp,"View");class Sp extends Ks{constructor(e,r,n,i,o,c,l){super(e,r);this._message=n,this._description=i,this._tooltip=o,this._iconPath=c,this._contextValue=l}getChildren(){return[]}getTreeItem(){var e;const r=new m.TreeItem(this._message,m.TreeItemCollapsibleState.None);return r.contextValue=(e=this._contextValue)!=null?e:Vs.Message,r.description=this._description,r.tooltip=this._tooltip,r.iconPath=this._iconPath,r}}a(Sp,"MessageNode");var uy=Object.defineProperty,dy=Object.getOwnPropertyDescriptor,Qd=a((t,e,r,n)=>{for(var i=n>1?void 0:n?dy(e,r):e,o=t.length-1,c;o>=0;o--)(c=t[o])&&(i=(n?c(e,r,i):c(i))||i);return n&&i&&uy(e,r,i),i},"workspaceRepositoriesView_decorateClass");const Gr=(0,B.loadMessageBundle)(),Ep=a(class extends Ks{constructor(t,e,r,n,i,o,c){super(t,e);this.changeStore=r,this.canonical=n,this.workspaceRepository=i,this.operation=o,this.canApplyChanges=c}static getId(t,e,r){return`${ul.getId(t,e)}:${this.key}(${r.uri.toString()})`}get id(){return Ep.getId(this.canonical.uri,this.workspaceRepository,this.operation)}getChildren(){return[]}async getTreeItem(){const t=this.view.providerService.getRelativeFilePath(this.workspaceRepository.uri,this.operation.uri),e=new m.TreeItem(t,m.TreeItemCollapsibleState.None);return e.id=this.id,e.contextValue=`${Vs.Change}${this.canApplyChanges?"+apply":""}`,e.resourceUri=this.view.changeStore.getScopedUri(this.operation.uri,this.workspaceRepository),e.command=await this.getDiffCommand(t,!0),e}async getDiffCommand(t,e=!1){if(e||this._command===void 0){const r=Boolean(this.operation.staged&&Y.get("staging.enabled"));if(this.workspaceRepository.workspaceId===this.view.workspaceId){const n=this.view.providerService.getProviderUri(this.operation.uri);this._command=await this.changeStore.resolveDiffCommand(this.operation.uri,n,r?Gr("diff title index","{0} (Index)",de(this.operation.uri),this.workspaceRepository.ref.name):Gr("diff title working","{0} (Working Tree)",de(this.operation.uri),this.workspaceRepository.ref.name))}else{const{repo:n}=this.view.providerService.getVirtualUriMetadata(this.workspaceRepository.uri),i=this.view.providerService.createProviderUri(this.operation.uri,{repo:n,ref:{type:tt.Commit,id:this.operation.revision}},t);this._command=await this.changeStore.resolveDiffCommand(this.operation.uri,i,r?Gr("diff title changeset index","{0} (Index of {1})",de(this.operation.uri),this.workspaceRepository.ref.name):Gr("diff title changeset working","{0} (Working Tree of {1})",de(this.operation.uri),this.workspaceRepository.ref.name))}}return this._command}async openChanges(){var t;const e=await this.getDiffCommand(this.view.providerService.getRelativeFilePath(this.workspaceRepository.uri,this.operation.uri));await m.commands.executeCommand(e.command,...(t=e.arguments)!=null?t:[])}async openFile(){const t=this.view.changeStore.getScopedUri(this.operation.uri,this.workspaceRepository.workspaceId);await m.window.showTextDocument(t)}async applyChanges(){const t=await this.view.getRepositoryToApplyChangesetTo(this.workspaceRepository);if(t!==void 0)try{await this.view.changeStore.applyChangeset(t.uri,this.workspaceRepository,this.operation)}catch(e){m.window.showErrorMessage(String(e))}}},"_FileChangeNode");let xp=Ep;xp.key=":changes";const Cp=a(class extends Ks{constructor(t,e,r,n,i){super(t,e);this.canonical=r,this.workspaceRepository=n,this.root=i}static getId(t,e){return`${yu.getId(t)}:${this.key}(${e.workspaceId}/${e.uri.toString()})`}get id(){return Cp.getId(this.canonical.uri,this.workspaceRepository)}get name(){return this.workspaceRepository.name}get uri(){return this.workspaceRepository.uri}canApplyChanges(){if(!this.canonical.hasActive||m.workspace.getWorkspaceFolder(this.workspaceRepository.uri)!==void 0)return!1;const{changes:e}=this.workspaceRepository;return e!==void 0&&(e.added!==0||e.changed!==0||e.deleted!==0)}async getChildren(){if(this._children===void 0){const t=this.view.changeStore.getScopedChangeStore(this.workspaceRepository),e=await t.getChanges(this.workspaceRepository.uri);this._children=e.map(r=>new xp(this.view,this,t,this.canonical,this.workspaceRepository,r,this.canApplyChanges()))}return this._children}getTreeItem(){const t=this.workspaceRepository.workspaceId===this.view.workspaceId,e=oy(this.workspaceRepository),r=Qt.isCanonicalUri(this.workspaceRepository.uri)?Gr("repositories view repository default ref","{0} (default)",this.workspaceRepository.ref.name):this.workspaceRepository.ref.name,n=new m.TreeItem(this.root?this.canonical.name:r,e?m.TreeItemCollapsibleState.Collapsed:m.TreeItemCollapsibleState.None);return n.id=this.id,n.contextValue=`${Vs.WorkspaceRepository}${t?"+active":""}${this.canApplyChanges()?"+apply":""}`,n.description=`${this.root?`${this.workspaceRepository.ref.name}\xA0\xA0\u2022\xA0\xA0`:""}${lo(this.workspaceRepository.timestamp,{ago:!0})}`,n.iconPath=t?new m.ThemeIcon("check"):this.root?Rp(this.canonical.provider.id):ry(this.workspaceRepository.ref.type,this.workspaceRepository.pullRequest),n.tooltip=new m.MarkdownString(void 0,!0).appendMarkdown(Gr("repositories view repository tooltip",`{0}{1}\\
{2} {3} {4}{5}\\
Last accessed {6}

{7}
`,this.canonical.name,this.workspaceRepository.pullRequest?Gr("pull request",`\\
Pull request {0} #{1}`,"$(git-pull-request)",this.workspaceRepository.pullRequest.id):"",hy(this.workspaceRepository.ref.type),Gd(this.workspaceRepository.ref.type),r,t?` \u2014 _${Gr("repositories view repository tooltip active","Active")}_ `:"",lo(this.workspaceRepository.timestamp,{ago:!0}),_p(this.workspaceRepository.changes,{preamble:`${Gr("repositories view has changes","Has Uncommitted Changes")}\\
`}))),e&&(n.resourceUri=m.Uri.parse("remotehub-view://wsrepo/changes")),n}refresh(t=!1){t&&(this._children=void 0)}async applyAllChanges(){const t=await this.view.getRepositoryToApplyChangesetTo(this.workspaceRepository);if(t!==void 0)try{await this.view.changeStore.applyChangeset(t.uri,this.workspaceRepository)}catch(e){m.window.showErrorMessage(String(e))}}remove(){return this.view.workspaceRepositories.remove(this.workspaceRepository)}},"_WorkspaceRepositoryNode");let ul=Cp;ul.key=":wsrepo",Qd([tr()],ul.prototype,"refresh",1);const Tp=a(class extends Ks{constructor(t,e,r,n){super(t,e);this.canonical=r,this.workspaceRepositories=n}static getId(t){return`remoteHub${this.key}(${t.toString()})`}get id(){return Tp.getId(this.canonical.uri)}get name(){return this.canonical.name}get uri(){return this.canonical.uri}getChildren(){if(this.children===void 0){const t=this.workspaceRepositories;if(t.length===0)return this.view.message=void 0,[new Sp(this.view,this,Gr("repositories view message empty","No GitHub repositories could be found."))];this.view.message=void 0,this.children=t.map(e=>new ul(this.view,this,this.canonical,e,!1))}return this.children}getTreeItem(){const t=this.workspaceRepositories.some(r=>r.workspaceId===this.view.workspaceId),e=new m.TreeItem(this.canonical.name,t?m.TreeItemCollapsibleState.Expanded:m.TreeItemCollapsibleState.Collapsed);return e.contextValue=Vs.WorkspaceRepositories,e.iconPath=Rp(this.canonical.provider.id),e}refresh(t=!1){t&&(this.children=void 0)}},"_CanonicalWorkspaceRepositoryNode");let yu=Tp;yu.key=":wsrepos",Qd([tr()],yu.prototype,"refresh",1);class Yd extends Ks{constructor(e){super(e);this.splatted=!0}async getChildren(){if(this.children===void 0){const e=await this.view.workspaceRepositories.getByCanonicalUri();if(e.size===0)return[];this.view.message=void 0;const r=[];for(const[n,i]of e){const o=m.Uri.parse(n);try{const{name:c,provider:l}=this.view.providerService.getVirtualUriMetadata(o),d={uri:o,name:c,provider:l,hasActive:i.some(h=>h.workspaceId===this.view.workspaceId)};i.length===1?r.push(new ul(this.view,this,d,i[0],!0)):r.push(new yu(this.view,this,d,i))}catch(c){if(c instanceof Gt)continue;L.error(c)}}this.children=r}return this.children}getTreeItem(){return new m.TreeItem("Repositories",m.TreeItemCollapsibleState.Expanded)}refresh(e=!1){e&&(this.children=void 0)}}a(Yd,"WorkspaceRepositoriesViewNode"),Qd([tr()],Yd.prototype,"refresh",1);class Ap extends bp{constructor(e,r,n,i,o){super("remoteHub.views.workspaceRepositories",Gr("remote view title","GitHub Repositories"),e,o);this.workspaceRepositories=r,this.changeStore=n,this.workspaceId=i,this.configKey="workspaceRepositories",this.disposables.push(this.workspaceRepositories.onDidChange(this.onRepositoriesChanged,this),m.window.registerFileDecorationProvider({provideFileDecoration:(c,l)=>{if(!(c.scheme!=="remotehub-view"||c.authority!=="wsrepo"||!c.path.includes("/changes")))return{badge:"\u25CF",color:new m.ThemeColor("remoteHub.decorations.workspaceRepositoriesView.hasUncommittedChangesForegroundColor"),tooltip:Gr("repositories view decoration has changes","Has Uncommitted Changes")}}}))}getRoot(){return new Yd(this)}onRepositoriesChanged(){this.refresh(!0)}registerCommands(){return[m.commands.registerCommand(this.getQualifiedCommand("refresh"),()=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.refresh"),this.workspaceRepositories.refresh(),void this.refresh(!0)),this),m.commands.registerCommand(this.getQualifiedCommand("open"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.open"),gn({name:e.name,uri:e.uri,location:$t.CurrentWindow})),this),m.commands.registerCommand(this.getQualifiedCommand("openInNewWindow"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.openInNewWindow"),gn({name:e.name,uri:e.uri,location:$t.NewWindow})),this),m.commands.registerCommand(this.getQualifiedCommand("applyAllChanges"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.applyAllChanges"),e.applyAllChanges()),this),m.commands.registerCommand(this.getQualifiedCommand("remove"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.remove"),e.remove()),this),m.commands.registerCommand(this.getQualifiedCommand("openChanges"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.openChanges"),e.openChanges()),this),m.commands.registerCommand(this.getQualifiedCommand("openFile"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.openFile"),e.openFile()),this),m.commands.registerCommand(this.getQualifiedCommand("applyChanges"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.applyChanges"),e.applyChanges()),this)]}async getRepositoryToApplyChangesetTo(e){const r=te(this.providerService.getVirtualCanonicalRootUri(e.uri)),n=this.providerService.repositories.filter(o=>te(o.canonicalUri)===r);return await fy(n,Gr("apply changeset pick repository placeholder","Choose a repository to apply the changeset to"))}}a(Ap,"WorkspaceRepositoriesView");function hy(t,e){switch(t){case Pe.Branch:return e?Gr("type pr branch","Pull Request #{0}",e.id):Gr("type branch","Branch");case Pe.RemoteBranch:return e?Gr("type pr remote branch","Pull Request #{0}",e.id):Gr("type remote branch","Remote Branch");case Pe.Tag:return Gr("type tag","Tag");case Pe.Commit:return Gr("type commit","Commit")}}a(hy,"headTypeToString");function Rp(t){switch(t){case"github":return new m.ThemeIcon("github");case"azurerepos":return new m.ThemeIcon("azure-devops");default:return new m.ThemeIcon("vm")}}a(Rp,"providerToIconPath");async function fy(t,e){if(t.length!==0){if(t.length>1){const r=await m.window.showQuickPick(t.map(n=>({label:n.name,description:n.provider.name,repository:n})),{placeHolder:e});return r?r.repository:void 0}return t[0]}}a(fy,"getRepository");const Ip=(0,B.loadMessageBundle)();let _u;function wu(){return _u}a(wu,"getOpenActionsService");var Ua;(function(t){t.HasCommitted="has:committed",t.Version="version"})(Ua||(Ua={}));let Zd;function Op(t){return Zd.globalState.get(t)}a(Op,"getState");async function Jd(t,e){return Zd.globalState.update(t,e)}a(Jd,"updateState");let Pp=!1;function Dp(){return Pp}a(Dp,"isInsiders");async function py(t){Zd=t,F.configure(t),L.configure(t,Y.get("logLevel")),ut.start("Time to root directory",{log:!1});const e=t.extension.packageJSON.displayName;if(t.extension.id.toLowerCase()==="github.remotehub-insiders"){Pp=!0;const o=m.extensions.getExtension("GitHub.remotehub");if(o!==void 0){const c=o.packageJSON.displayName;L.warn(`${e} was NOT activated because ${c} is also enabled`),setTimeout(()=>void m.window.showErrorMessage(Ip("more than one version enabled warning","{0} cannot be used while {1} is also enabled. Please ensure that only one version is enabled.",e,c),Ip("ok","OK")),0);return}}const r=dc.configure(t),n=new va(t),i=t.extension.packageJSON.version;await Jd(Ua.Version,i),await t.workspaceState.update(Ua.Version,i);try{const o=new mu(t.globalState),c=o.with(r),l=new vu(t.globalStorageUri,r),d=new Ke(c),h=new Qt(d,n),S=new ma(h,c,l,n,r);S.getWorkspacesWithChanges(),_u=new hp(h,o,S);const O=new pp(h,S,_u,n),I=new Lf(t.globalStorageUri,h),P=new uh(h,I),$=new Xd(h,o,S,r);return t.subscriptions.push(Y.onDidChange(N=>{!Y.changed(N,"logLevel")||(L.logLevel=Y.get("logLevel"))}),h.onDidChangeRepositories(async N=>{for(const U of N.added)try{const W=await U.getMetadata(),{HEAD:V,defaultBranch:ie,name:oe,provider:ge,pullRequest:ke}=W,Ie=V.name.replace(/\//g,"\u2009\u2215\u2009");let Oe=" ";if(ke!==void 0)Oe=` (PR ${ke.id}) `;else if(V.type===Pe.Tag)Oe=` (${Ie}) `;else if(V.type===Pe.Commit)Oe=` (${Ie}) `;else if(V.type===Pe.Branch||V.type===Pe.RemoteBranch){const $e=V.branch.name.replace(/\//g,"\u2009\u2215\u2009");V.branch.name!==ie.name&&(Oe=` (${$e})`)}const Ze={uri:U.uri,type:"folder",label:`${oe}${Oe}[${ge.name}]`};m.commands.executeCommand("_workbench.addToRecentlyOpened",Ze)}catch(W){L.error(W,"Failed to add repository to recently opened")}}),new fp(h,S),new Cl,new Lc(h,S),new vp(h,n),...Lu(h,S,$,t.extension.id,n),...yy(h,S,n),...gy(h,S,O,I,t,n),new mp(h,S),new Ap(h,$,S,r,n),I,$,O,_u,S,h,n),n.sendEvent("activate"),Promise.resolve(P)}catch(o){throw L.error(o),o}}a(py,"activate");function gy(t,e,r,n,i,o){const c=kp()?new ah(t,o):void 0;return[my(t,e,c,r,n),...Y.get("azureRepos.enabled")?[new gr(i),vy(t,e,c)]:[]]}a(gy,"registerProviders");function my(t,e,r,n,i){const o=new fu(t,i),c=new tl(t,o,e,i);async function l(){var h;try{let S=(h=m.extensions.getExtension("GitHub.vscode-pull-request-github"))!=null?h:m.extensions.getExtension("GitHub.vscode-pull-request-github-insiders");S||(L.log("[ GHPR] Not currently installed or enabled; waiting..."),await new Promise(U=>{const W=m.extensions.onDidChange(()=>{var V;S=(V=m.extensions.getExtension("GitHub.vscode-pull-request-github"))!=null?V:m.extensions.getExtension("GitHub.vscode-pull-request-github-insiders"),S&&(W.dispose(),U())})})),L.log("[ GHPR] Registering..."),Si(Pn.HasPullRequestExtension,!0);const O=await S.activate();if(!O)throw new Error("Unable to get registration api");const I=O.registerGitProvider(n),P=t.onDidChangeRepositories(U=>$(U));async function $(U){const W=U.added.filter(V=>V.provider.id==="github");if(W.length!==0){L.log("[ GHPR] Checking for opened PRs...");for(const V of W){const ie=await t.getBestRemoteUri(V.uri,Lt.PullRequest);if(!!ie){P.dispose(),L.log("[ GHPR] Opened PR found; preloading"),m.commands.executeCommand("github.api.preloadPullRequest",ie.toString());return}}L.log("[ GHPR] No opened PRs found")}}a($,"onRepositoriesChanged"),L.log("[ GHPR] Registration complete");const N=t.repositories;return N.length&&$({added:N,removed:[]}),m.Disposable.from(I,P)}catch(S){return L.error(S,"[ GHPR] Registration failed;"),{dispose:()=>{}}}}a(l,"registerWithGHPR");const d=l();return m.Disposable.from(t.register("github","GitHub",o,c,r),o,c,{dispose:async()=>{var h;return void((h=await d)==null?void 0:h.dispose())}})}a(my,"registerGitHub");function vy(t,e,r){const n=new Ho(t),i=new oo(t,n,e);return m.Disposable.from(t.register("azurerepos","Azure Repos",n,i,r),n,i)}a(vy,"registerAzDO");function yy(t,e,r){if(!kp())return[];r.publicLog2("codex.enableRichNav",{});const n=new Uo(t,e);return[n,n.register(new Wu(r)),...Wu.createStatus()]}a(yy,"registerNavigationServiceProviders");function kp(){return m.env.uiKind===m.UIKind.Desktop||Y.get("richNavigation.enabled")===!0}a(kp,"isRichNavEnabled")})(),module.exports=__webpack_exports__})();
