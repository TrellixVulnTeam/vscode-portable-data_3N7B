const a13_0x5937=["_sc","bottom","topright","_directionalMoveElements","clientHeight","enabled","_selectionService","classList","_imageService","ArrowDown","name","register","selectAll","13kivQqz","bottomright","moveSelection","createDomRenderProgram","left","ctrlKey","appendChild","228133OJmasV","display","278gbyNNP","state","move-handle","_cursorOrigin","round","fire","add","shiftKey","render","getPointerState","4647saqrPU","_isVisible","imageService","set","none","key","389197QHrmln","57kUiTOe","div","zoom","isSelectionTool","clientWidth","order","actions","offsetY","bottomleft","width","event","max","metaKey","391362rQzXBn","type","33984pPYrQU","_cropToSelectionAction","_isCursorDown","webpackChunkluna","_setVisible","move","offsetX","ArrowRight","topleft","pointerUp","top","_refreshActionEnabledState","viewportService","Crop to Selection","crop-to-selection","selectionService","_onStateChange","ArrowUp","_viewportService","style","getCoordsFromEvent","1523AjUzhO","2nTGJCx","get","_onUpdate","height","onUpdate","onStateChange","range","141988DuCDDU","removeChild","push","commit","currentLayer","min","_originalSelection","_enabled","right","_directionalMoveZones","slice","_elementContainer","_cursorCurrent","_container","keyDown","setTopLeft","ArrowLeft","_renderer","Move Selection","createElement"],a13_0x1577=function(t,e){return a13_0x5937[t-=179]},a13_0x54ccfe=a13_0x1577;(function(t,e){const s=a13_0x1577;for(;;)try{if(248748===parseInt(s(210))+parseInt(s(241))+parseInt(s(196))+-parseInt(s(197))*parseInt(s(190))+-parseInt(s(180))*parseInt(s(233))+parseInt(s(212))*-parseInt(s(274))+parseInt(s(281))*parseInt(s(234)))break;t.push(t.shift())}catch(e){t.push(t.shift())}})(a13_0x5937),(self[a13_0x54ccfe(215)]=self[a13_0x54ccfe(215)]||[])[a13_0x54ccfe(243)]([[403],{6173:(t,e,s)=>{"use strict";const i=a13_0x54ccfe;s.d(e,{f:()=>n});var o=s(1815),h=s(5120);class n extends h.JT{constructor(t,e,s){const i=a13_0x1577;super(),this[i(271)]=t,this[i(211)]=e,this._enabled=s,this[i(236)]=this.register(new o.v),this[i(238)]=this._onUpdate[i(207)]}get[i(266)](){return this[i(248)]}set[i(266)](t){const e=i;this[e(248)]!==t&&(this[e(248)]=t,this[e(236)][e(185)]())}}},403:(t,e,s)=>{"use strict";const i=a13_0x54ccfe;s.r(e),s.d(e,{default:()=>p});var o=s(1815),h=s(7896),n=s(5120),r=s(1003),c=s(6173);const a=["ArrowUp","ArrowLeft",i(270),i(219)];class l extends n.JT{constructor(t){const e=i;super(),this[e(261)]=t,this.id=e(276),this[e(200)]=!0,this[e(181)]="move",this[e(214)]=!1,this[e(213)]=new c.f(e(225),e(226),!1),this[e(203)]=[this[e(213)]],this._onStateChange=this[e(272)](new o.v),this[e(239)]=this[e(228)][e(207)],this.register(this[e(261)][e(227)].onUpdate((()=>this[e(223)]()))),this._refreshActionEnabledState()}pointerDown(t){const e=i;this[e(214)]=!0,!this[e(261)][e(227)].range&&this._sc[e(192)][e(273)](),this[e(183)]=this[e(261)][e(224)][e(232)](t),this[e(253)]=this._cursorOrigin[e(251)](),this._originalSelection=this[e(261)][e(227)][e(240)]}[i(221)](t){const e=i;this[e(214)]=!1,this[e(261)][e(227)][e(240)]&&this[e(261)][e(227)][e(244)](e(259),e(276))}pointerMove(t){const e=i;if(this[e(258)]&&!this[e(214)]){const s=this[e(258)][e(189)](t);this.state!==s&&(this[e(181)]=s,this._onStateChange[e(185)]())}}pointerDownMove(t){const e=i;if(!this._sc[e(227)][e(240)]||!this[e(183)]||!this[e(247)])return;this[e(253)]=this[e(261)][e(224)][e(232)](t);const s=this[e(253)][0]-this._cursorOrigin[0],o=this[e(253)][1]-this[e(183)][1];if(this[e(181)]===e(217))return void this[e(261)].selectionService[e(256)](this[e(247)][e(278)]+s,this[e(247)][e(222)]+o);let h;if(!t[e(187)]||this[e(181)]!==e(220)&&this[e(181)]!==e(263)&&this[e(181)]!==e(205)&&"bottomright"!==this[e(181)])switch(h=(0,r.BN)(this[e(247)]),this[e(181)]){case e(220):h[e(278)]+=s,h[e(222)]+=o;break;case e(263):h.right+=s,h.top+=o;break;case e(205):h[e(278)]+=s,h.bottom+=o;break;case e(275):h[e(249)]+=s,h[e(262)]+=o;break;case e(222):h[e(222)]+=o;break;case"bottom":h[e(262)]+=o;break;case e(278):h[e(278)]+=s;break;case e(249):h[e(249)]+=s}else{const t=(0,r.n3)(this[e(247)]);let i;switch(h=(0,r.BN)(this[e(247)]),this[e(181)]){case e(220):i=(1/t*-s-o)/2,h[e(278)]-=Math[e(184)](i*t),h.top-=Math.round(i);break;case e(263):i=(s*(1/t)-o)/2,h[e(249)]+=Math[e(184)](i*t),h.top-=Math[e(184)](i);break;case"bottomleft":i=(1/t*-s+o)/2,h.left-=Math[e(184)](i*t),h[e(262)]+=Math.round(i);break;case e(275):i=(s*(1/t)+o)/2,h[e(249)]+=Math[e(184)](i*t),h[e(262)]+=Math[e(184)](i)}}this[e(261)][e(227)][e(240)]=(0,r.FJ)(h)}[i(255)](t){const e=i;if(!this[e(261)].imageService)return;if(!a.includes(t[e(195)]))return;const s=this[e(261)][e(227)][e(240)]||this[e(261)].imageService[e(273)](),o=(h.V?t[e(209)]:t[e(279)])?10:1;switch(t[e(195)]){case e(229):this._sc[e(227)].setTopLeft(s.left,s[e(222)]-o);break;case e(270):this[e(261)][e(227)][e(256)](s[e(278)],s[e(222)]+o);break;case e(257):this[e(261)][e(227)][e(256)](s.left-o,s[e(222)]);break;case e(219):this[e(261)].selectionService[e(256)](s[e(278)]+o,s[e(222)])}}[i(223)](){const t=i,e=this._sc.selectionService[t(240)];this[t(213)][t(266)]=!(!e||0===e[t(278)]&&0===e[t(222)]&&e.right===this[t(261)].imageService[t(206)]&&e[t(262)]===this[t(261)][t(192)].height)}[i(277)](t){const e=i;return this[e(258)]=new f(t,this[e(261)][e(227)],this[e(261)].viewportService,this[e(261)][e(192)]),this[e(258)]}}const p=l;class f extends n.JT{constructor(t,e,s,o){const h=i;super(),this._container=t,this[h(267)]=e,this._viewportService=s,this[h(269)]=o,this[h(202)]=2,this[h(264)]=new Map,this[h(250)]=new Map,this[h(191)]=!0,this[h(252)]=document[h(260)](h(198));const n=[h(220),"topright","bottomleft",h(275),h(222),h(262),"left",h(249)];for(const t of n){const e=document[h(260)](h(198));e[h(268)][h(186)](h(182)),this[h(252)][h(280)](e),this[h(264)].set(t,e),this[h(250)][h(193)](t,(0,r.Pq)())}this[h(254)][h(280)](this[h(252)]),this[h(272)]({dispose:()=>{const t=h;this[t(254)][t(242)](this[t(252)])}}),this._selectionService[h(238)]((()=>this._setVisible(void 0!==this[h(267)][h(240)]))),this._setVisible(void 0!==this[h(267)].range)}[i(216)](t){const e=i;t!==this[e(191)]&&(this._elementContainer[e(231)][e(179)]=t?"":e(194),this[e(191)]=t)}[i(188)](){const t=i,e=this._selectionService[t(240)];if(!e)return;const s=this[t(269)][t(245)];if(!s)return;const o=this[t(230)],h=Math.round(this[t(254)][t(201)]/2)-s[t(206)]/2*o[t(199)],n=Math[t(184)](this[t(254)][t(265)]/2)-s[t(237)]/2*o[t(199)],r=h+(o.x+e[t(278)])*o.zoom,c=n+(o.y+e[t(222)])*o.zoom,a=h+(o.x+e[t(249)])*o.zoom,l=n+(o.y+e[t(262)])*o[t(199)],p=Math.round((r+a)/2),f=Math[t(184)]((c+l)/2),g=10*window.devicePixelRatio,_={left:Math[t(246)](r+g,Math[t(208)](r,p-g)),top:Math[t(246)](c+g,Math.max(c,f-g)),right:Math[t(208)](a-g,Math.min(a,p+g)),bottom:Math[t(208)](l-g,Math.min(l,f+g))},m={left:r-g,top:c-g,right:a+g,bottom:l+g},d=this[t(250)][t(235)]("topleft");d.left=m.left,d[t(249)]=_[t(278)],d[t(222)]=m[t(222)],d.bottom=_.top;const u=this[t(264)][t(235)]("topleft");u.style[t(278)]=r+"px",u[t(231)].top=c+"px";const v=this[t(250)].get(t(263));v[t(278)]=_[t(249)],v[t(249)]=m[t(249)],v[t(222)]=m[t(222)],v.bottom=_[t(222)];const b=this[t(264)][t(235)](t(263));b.style[t(278)]=a+"px",b[t(231)][t(222)]=c+"px";const x=this._directionalMoveZones.get(t(205));x[t(278)]=m[t(278)],x.right=_[t(278)],x.top=_[t(262)],x.bottom=m[t(262)];const S=this._directionalMoveElements.get(t(205));S[t(231)].left=r+"px",S.style[t(222)]=l+"px";const M=this[t(250)].get(t(275));M[t(278)]=_[t(249)],M.right=m.right,M[t(222)]=_[t(262)],M[t(262)]=m[t(262)];const w=this[t(264)][t(235)]("bottomright");w.style[t(278)]=a+"px",w[t(231)][t(222)]=l+"px";const k=this[t(250)].get(t(222));k.left=_[t(278)],k.right=_[t(249)],k[t(222)]=m[t(222)],k[t(262)]=_[t(222)];const y=this[t(264)].get(t(222));y[t(231)].left=p+"px",y[t(231)][t(222)]=c+"px";const C=this[t(250)][t(235)]("bottom");C.left=_[t(278)],C[t(249)]=_[t(249)],C[t(222)]=_.bottom,C.bottom=m[t(262)];const U=this[t(264)][t(235)]("bottom");U[t(231)][t(278)]=p+"px",U[t(231)][t(222)]=l+"px";const A=this[t(250)][t(235)](t(278));A[t(278)]=m.left,A[t(249)]=_[t(278)],A.top=_.top,A[t(262)]=_[t(262)];const I=this[t(264)].get(t(278));I[t(231)][t(278)]=r+"px",I[t(231)][t(222)]=f+"px";const D=this[t(250)][t(235)](t(249));D[t(278)]=_.right,D[t(249)]=m.right,D[t(222)]=_[t(222)],D[t(262)]=_[t(262)];const T=this[t(264)][t(235)](t(249));T[t(231)].left=a+"px",T[t(231)].top=f+"px"}getPointerState(t){const e=i;for(const[s,i]of this[e(250)])if(g(i,t[e(218)],t[e(204)]))return s;return e(217)}}function g(t,e,s){const o=i;return e>=t[o(278)]&&e<t[o(249)]&&s>=t[o(222)]&&s<t[o(262)]}}}]);