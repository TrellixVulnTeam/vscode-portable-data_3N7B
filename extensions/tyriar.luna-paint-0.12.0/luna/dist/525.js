const a16_0x43df=["stroke","linearDodgeAdd","_lastUpCoords","onUndo","_element","strokeWidth","none","max","event","_color","toString","pointerDownMove","screen","onHistoryUpdateValue","2731vTYwoj","setValueFromHistoryChange","darken","text","104986omRTeM","189147AZtOWS","name","exclusion","linearBurn","_blendModeOption","prepend","32ZFZQqj","_model","order","createExtendedEdit","historyService","pointerUp","cos","fill","73nvEZWa","operationName","Blend Mode","softLight","_svg","_sc","length","sqrt","_outlineModel","lighten","_ignoreSetPixel","display","Pencil","boolean","_svgPath","_updateCursorInfo","fire","clientHeight","slice","_onRequestRender","type","_isShiftDown","allowUnchecking","clientWidth","_onHistoryUpdateValue","_getEdit","svg","_container","onUpdate","isValid","imageService","difference","forceSolid","_setPixel","map","height","multiply","textContent","string-combo","_cursorCoord","pointerDown","add","join","render","1ecfFkX","left","_getAngle","http://www.w3.org/2000/svg","normal","zoom","pop","_updateOutline","pow","top","classList","_cursorInfo","value","abs","Could not create extended edit","register","195501NjcIDq","_lastDownCoord","_onUpdate","viewportService","_drawLine","_imageService","push","appendChild","getCoordsFromEvent","pencil"," 0z","setAttribute","offsetY","min","floor","replace","path","getColorFromPointerEvent","commit","append","paletteService","4948qjePTF","sin","shiftKey","keyUp","requestRender","string","hasImage","number","197714kOIeWw","transparent","_viewportService","style","createElementNS","round","53XszqvK","selectionService","containsCoord","currentLayer","atan2","options","webpackChunkluna","_hideCursorInfo","width","7279PmWSJM","activeEntry","cursor-info","isVisible","_value","var(--luna-focusColor)","_edit"],a16_0x2b0c=function(t,s){return a16_0x43df[t-=153]},a16_0x416197=a16_0x2b0c;(function(t,s){const i=a16_0x2b0c;for(;;)try{if(114462===parseInt(i(266))*-parseInt(i(177))+parseInt(i(166))*-parseInt(i(185))-parseInt(i(245))-parseInt(i(170))+parseInt(i(274))+parseInt(i(171))*parseInt(i(229))+parseInt(i(280))*parseInt(i(289)))break;t.push(t.shift())}catch(s){t.push(t.shift())}})(a16_0x43df),(self[a16_0x416197(286)]=self[a16_0x416197(286)]||[])[a16_0x416197(251)]([[525],{7571:(t,s,i)=>{"use strict";const e=a16_0x416197;i.d(s,{P:()=>o});var h=i(5120);class o extends h.JT{constructor(t,s){const i=a16_0x2b0c;super(),this[i(212)]=t,this[i(178)]=s,this.order=2,this[i(156)]=document.createElement("div"),this[i(156)][i(239)][i(226)](i(291)),this[i(212)][i(252)](this._element),this[i(244)]({dispose:()=>this[i(212)].removeChild(this[i(156)])})}[e(228)](){const t=e;this[t(156)][t(277)][t(196)]=this._model.isVisible?"block":t(158),this._element.style[t(230)]=this[t(178)].x+"px",this._element.style[t(238)]=this[t(178)].y+"px",this[t(156)][t(222)]=this[t(178)][t(169)]}}},566:(t,s,i)=>{"use strict";const e=a16_0x416197;i.d(s,{d:()=>r,I:()=>a});var h=i(1019),o=i(5120),n=i(1674);class r extends o.JT{constructor(t,s,i,e){const h=a16_0x2b0c;super(),this[h(212)]=t,this[h(250)]=s,this[h(276)]=i,this[h(178)]=e,this[h(179)]=2,this[h(189)]=document[h(278)](n.q,h(211)),this[h(199)]=document[h(278)](n.q,h(261)),this[h(199)].style[h(296)]=h(294),this[h(199)][h(277)][h(184)]=h(275),this._svgPath.style.strokeWidth="1",this[h(189)][h(264)](this._svgPath),this._container[h(176)](this._svg),this[h(244)]({dispose:()=>this._container.removeChild(this._svg)})}[e(228)](){const t=e,s=this._viewportService;if(!this._model[t(214)]||!this[t(250)][t(283)])return void(this[t(189)][t(277)][t(196)]=t(158));if(this[t(189)].style[t(196)]="block",!this[t(178)][t(217)]&&this[t(178)][t(157)]<=1&&s[t(234)]>=3){const i=[];(0,h.j)(void 0,this[t(178)].x1,this[t(178)].y1,this[t(178)].x2,this[t(178)].y2,((t,s)=>i.push([t,s])),!1,this[t(178)][t(157)]);const e=[];let o=0;for(;o<i[t(191)]-1;o++){const s=i[o];let h=o;if(s[0]===i[h+1][0]){for(;h+1<i.length&&s[0]===i[h+1][0];)h++;e[t(251)]([s[0],s[1],1,h-o+1])}else if(s[1]===i[h+1][1]){for(;h+1<i[t(191)]&&s[1]===i[h+1][1];)h++;e[t(251)]([s[0],s[1],h-o+1,1])}else e[t(251)]([s[0],s[1],1,1]);o=h}o===i.length-1&&e.push([i[o][0],i[o][1],1,1]);const n=Math[t(279)](this._container.clientWidth/2)-this[t(250)][t(288)]/2*s[t(234)]+s.x*s[t(234)],r=Math[t(279)](this[t(212)][t(202)]/2)-this._imageService[t(220)]/2*s[t(234)]+s.y*s[t(234)];let a="";for(const i of e)a+="M"+(n+i[0]*s.zoom)+" "+(r+i[1]*s[t(234)]),a+="l"+i[2]*s[t(234)]+" 0",a+="l0 "+i[3]*s[t(234)],a+="l-"+i[2]*s[t(234)]+t(255);return this._svg.setAttribute(t(288),this[t(212)][t(208)][t(162)]()),this[t(189)][t(256)](t(220),this[t(212)][t(202)][t(162)]()),void this[t(199)].setAttribute("d",a)}this[t(189)][t(277)].display="block";const i=Math[t(279)](this[t(212)][t(208)]/2)-this[t(250)][t(288)]/2*s.zoom+s.x*s[t(234)],o=Math.round(this._container[t(202)]/2)-this[t(250)][t(220)]/2*s[t(234)]+s.y*s[t(234)],n=i+(this[t(178)].x1+.5)*s[t(234)],r=o+(this._model.y1+.5)*s.zoom,a=i+(this[t(178)].x2+.5)*s[t(234)],c=o+(this[t(178)].y2+.5)*s[t(234)];if(this._svg.setAttribute(t(288),this[t(212)][t(208)].toString()),this._svg[t(256)](t(220),this._container[t(202)][t(162)]()),s[t(234)]>=3){const i=(0,h.X)(n,r,a,c,this[t(178)][t(157)],s.zoom);this[t(199)].setAttribute("d","M"+i[t(219)]((t=>t.x+","+t.y))[t(227)](" L")+"z")}else this[t(199)].setAttribute("d","M"+n+","+r+" L"+a+","+c)}}class a{constructor(){const t=e;this[t(214)]=!1,this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.strokeWidth=1,this[t(217)]=!1}}},9904:(t,s,i)=>{"use strict";const e=a16_0x416197;i.d(s,{FV:()=>r,rP:()=>a,tv:()=>c,Jp:()=>l,X5:()=>u,qv:()=>d});var h=i(1815),o=i(5120),n=i(2939);class r extends o.JT{constructor(t,s,i,e=!0){const o=a16_0x2b0c;super(),this.name=t,this[o(272)]=s,this[o(293)]=i,this[o(207)]=e,this.type=o(198),this._onHistoryUpdateValue=this.register(new h.v),this[o(165)]=this._onHistoryUpdateValue.event,this[o(247)]=this[o(244)](new h.v),this[o(213)]=this._onUpdate[o(160)]}get[e(241)](){return this[e(293)]}set value(t){const s=e;this[s(293)]=t,this._onUpdate[s(201)]()}setValueFromHistoryChange(t){const s=e;this[s(293)]=t,this._onHistoryUpdateValue[s(201)](t)}}class a extends o.JT{constructor(t,s,i){const o=e;super(),this[o(172)]=t,this[o(285)]=s,this[o(293)]=i,this[o(205)]=o(271),this[o(209)]=this.register(new h.v),this[o(165)]=this[o(209)][o(160)],this[o(247)]=this[o(244)](new h.v),this[o(213)]=this[o(247)][o(160)]}get value(){return this[e(293)]}set[e(241)](t){const s=e;this[s(293)]=t,this._onUpdate[s(201)]()}setValueFromHistoryChange(t){const s=e;this[s(293)]=t,this._onHistoryUpdateValue[s(201)](t)}}class c extends o.JT{constructor(t,s,i){const o=e;super(),this[o(172)]=t,this[o(285)]=s,this._value=i,this[o(205)]=o(223),this[o(209)]=this[o(244)](new h.v),this.onHistoryUpdateValue=this._onHistoryUpdateValue.event,this[o(247)]=this.register(new h.v),this.onUpdate=this._onUpdate[o(160)]}get[e(241)](){return this[e(293)]}set[e(241)](t){const s=e;this[s(293)]=t,this[s(247)][s(201)]()}[e(167)](t){const s=e;this[s(293)]=t,this._onHistoryUpdateValue[s(201)](t)}}class l extends a{constructor(){const t=e;super("Blend Mode",[t(233),"replace","darken",t(221),"linearBurn",t(194),t(164),"linearDodgeAdd","overlay","softLight","difference",t(173)],t(233))}}class u extends o.JT{constructor(t,s,i,o){const n=e;super(),this[n(172)]=t,this[n(293)]=s,this[n(258)]=i,this[n(159)]=o,this[n(205)]=n(273),this._onHistoryUpdateValue=this[n(244)](new h.v),this.onHistoryUpdateValue=this[n(209)][n(160)],this[n(247)]=this.register(new h.v),this.onUpdate=this[n(247)][n(160)]}get[e(241)](){const t=e;return(0,n.u)(this[t(293)],this.max,this[t(258)])}set[e(241)](t){const s=e;this._value=t,this._onUpdate[s(201)]()}[e(167)](t){this._value=t,this._onHistoryUpdateValue.fire(t)}}class d extends u{constructor(t,s,i,h){const o=e;super(t,s,i,h),this[o(205)]=o(273)}get value(){const t=e;return(0,n.u)(this._value,this.max,this[t(258)])}set[e(241)](t){const s=e;this[s(293)]=Math[s(259)](t),this[s(247)][s(201)]()}}},5525:(t,s,i)=>{"use strict";const e=a16_0x416197;i.r(s),i.d(s,{default:()=>d});var h=i(1815),o=i(5120),n=i(9455),r=i(7571),a=i(566),c=i(9904),l=i(1019);class u extends o.JT{constructor(t){const s=a16_0x2b0c;super(),this._sc=t,this.id=s(254),this[s(154)]=[],this[s(224)]=[0,0],this[s(206)]=!1,this[s(193)]=new a.I,this[s(175)]=new c.Jp,this[s(285)]=[this[s(175)]],this[s(204)]=this.register(new h.v),this.onRequestRender=this[s(204)].event,this[s(240)]={x:0,y:0,text:"",isVisible:!1},this[s(244)](this[s(190)][s(181)][s(155)]((t=>{const i=s;t[i(186)]===i(197)&&"Pencil"===this._sc[i(181)][i(290)]?.[i(186)]?this[i(154)]?.[i(235)]():this[i(154)][i(191)]=0}))),this[s(244)](this[s(190)][s(181)].onRedo((()=>this[s(154)][s(191)]=0))),this[s(190)][s(248)][s(213)]((()=>{const t=s;this[t(193)][t(214)]=!1,this[t(287)]()}))}createDomRenderProgram(t){const s=a16_0x2b0c;return[new r.P(t,this[s(240)]),new a.d(t,this._sc.imageService,this[s(190)][s(248)],this[s(193)])]}[e(225)](t){const s=e,i=this[s(190)][s(215)];if(!i[s(283)])return;if(this[s(161)]=this[s(190)][s(265)][s(262)](t),!this._color)return;const h=this[s(190)].viewportService[s(253)](t);if(h){if(t.shiftKey&&this._lastUpCoords.length>0){const t=this[s(154)][this[s(154)][s(191)]-1];this._ignoreSetPixel=t,this[s(249)](t,h,this._color),this._ignoreSetPixel=void 0}if(i[s(282)](h[0],h[1])){const t=this[s(210)]();this[s(218)](this[s(210)](),h[0],h[1],this[s(161)]),t[s(270)]()}this[s(246)]=h}}[e(163)](t){const s=e;if(!this._lastDownCoord||!this._color)return;const i=this[s(190)][s(215)];if(!i[s(283)])return;const h=this._sc[s(248)].getCoordsFromEvent(t);this[s(246)][0]===h[0]&&this[s(246)][1]===h[1]||((i[s(282)](h[0],h[1])||i[s(282)](this[s(246)][0],this[s(246)][1]))&&this[s(249)](this[s(246)],h,this[s(161)]),this._lastDownCoord=h)}async[e(182)](t){const s=e;this._sc.imageService[s(283)]&&(this[s(295)]?.[s(263)](s(197)),this[s(295)]=void 0);const i=this[s(190)][s(248)][s(253)](t);this[s(154)][s(251)](i),this[s(236)](t,!1,!0)}async pointerMove(t,s){const i=e;this[i(240)].x=t.offsetX,this[i(240)].y=t[i(257)],this[i(224)]=this[i(190)].viewportService.getCoordsFromEvent(t),this[i(236)](t,s),!s&&t[i(268)]?this[i(200)]():this._cursorInfo.isVisible&&this[i(287)]()}keyDown(t,s){const i=e;!this._isShiftDown&&t[i(268)]&&(this._isShiftDown=!0,!s&&(this._updateCursorInfo(),this._updateOutline(t,s,!0)))}[e(269)](t){const s=e;!t[s(268)]&&(this[s(193)].isValid=!1,this[s(204)][s(201)](),this[s(240)][s(292)]&&this._hideCursorInfo(),this[s(206)]=!1)}_updateOutline(t,s,i){const h=e;if(i||this[h(193)].x1!==this[h(224)][0]||this[h(193)].y1!==this[h(224)][1]){if(this._outlineModel.x1=this[h(224)][0],this[h(193)].y1=this[h(224)][1],!s&&t[h(268)]&&this[h(154)].length>0){const t=this[h(154)][this[h(154)][h(191)]-1];this[h(193)].x2=t[0],this[h(193)].y2=t[1],this._outlineModel[h(214)]=!0}else this._outlineModel.x2=this[h(224)][0],this[h(193)].y2=this._cursorCoord[1],this[h(193)][h(214)]=this[h(190)][h(215)][h(282)](this[h(193)].x1,this[h(193)].y1);this._onRequestRender.fire()}}[e(200)](){const t=e;if(0===this[t(154)][t(191)])return;if(!this[t(224)])return;const s=this[t(154)][this[t(154)][t(191)]-1];if(s[0]===this[t(224)][0]&&s[1]===this._cursorCoord[1])return;const i=this[t(231)](s,this[t(224)]);this[t(240)][t(169)]=i+"°",this[t(240)].isVisible=!0,this[t(204)].fire()}_getAngle(t,s){return Math.round(10*(0,n.AM)(t[0],t[1],s[0],s[1]))/10}[e(287)](){const t=e;this._cursorInfo.isVisible=!1,this[t(204)][t(201)]()}_drawLine(t,s,i){const h=e,o=this._getEdit();(0,l.j)(i,t[0],t[1],s[0],s[1],((t,s,i)=>this._setPixel(o,t,s,i)),!1),o[h(270)]()}[e(210)](){const t=e;if(!this._edit&&(this[t(295)]=this[t(190)].imageService[t(283)]?.[t(180)](),!this[t(295)]))throw new Error(t(243));return this._edit}[e(218)](t,s,i,h){const o=e;this[o(195)]&&this._ignoreSetPixel[0]===s&&this[o(195)][1]===i||this[o(190)][o(281)].containsCoord(s,i)&&this[o(190)][o(215)][o(282)](s,i)&&t.setPixel(s,i,h,this._blendModeOption[o(241)]===o(260)?void 0:this._blendModeOption.value)}}const d=u},1019:(t,s,i)=>{"use strict";i.d(s,{X:()=>h,j:()=>o});var e=i(9455);function h(t,s,i,h,o,n){const r=a16_0x2b0c,a=(0,e.zz)(t,s,i,h),c=.5*n*o*Math[r(267)](a),l=.5*n*o*Math[r(183)](a);return[{x:t-c,y:s-l},{x:t+c,y:s+l},{x:i+c,y:h+l},{x:i-c,y:h-l}]}function o(t,s,i,e,h,o,u,d=1){u?function(t,s,i,e,h,o,n){const r=a16_0x2b0c;n<1&&(t=l(t,n));const u=Math[r(242)](h-i)>Math.abs(e-s);let d=0;u&&(d=s,s=i,i=d,d=e,e=h,h=d),s>e&&(d=s,s=e,e=d,d=i,i=h,h=d);const _=e-s;let p=(h-i)/_;0===_&&(p=1);let f=Math[r(279)](s),v=i+p*(f-s),x=c(s+.5);const g=f,y=Math.floor(v);let m=a(v)*x;u?(o(y,g,l(t,c(v)*x)),m>0&&o(y+1,g,l(t,m))):(o(g,y,l(t,c(v)*x)),m>0&&o(g,y+1,l(t,m)));let M=v+p;f=Math[r(279)](e),v=h+p*(f-e),x=a(e+.5);const w=f,b=Math[r(259)](v);if(m=a(v)*x,u?(o(b,w,l(t,c(v)*x)),m>0&&o(b+1,w,l(t,a(v)*x))):(o(w,b,l(t,c(v)*x)),m>0&&o(w,b+1,l(t,a(v)*x))),u)for(let s=g+1;s<w;s++)o(Math[r(259)](M),s,l(t,c(M))),m=a(M),m>0&&o(Math[r(259)](M)+1,s,l(t,m)),M+=p;else for(let s=g+1;s<w;s++)o(s,Math[r(259)](M),l(t,c(M))),m=a(M),m>0&&o(s,Math[r(259)](M)+1,l(t,m)),M+=p}(t,s,i,e,h,o,d):function(t,s,i,e,h,o,a){const c=a16_0x2b0c;a<1&&(t=l(t,a)),Math.abs(h-i)<Math[c(242)](e-s)?s>e?n(t,e,h,s,i,o):n(t,s,i,e,h,o):i>h?r(t,e,h,s,i,o):r(t,s,i,e,h,o)}(t,s,i,e,h,o,d)}function n(t,s,i,e,h,o){const n=e-s;let r=h-i,a=1;r<0&&(a=-1,r=-r);let c=2*r-n,l=i;for(let i=s;i<=e;i++)o(i,l,t),c>0?(l+=a,c+=2*(r-n)):c+=2*r}function r(t,s,i,e,h,o){let n=e-s;const r=h-i;let a=1;n<0&&(a=-1,n=-n);let c=2*n-r,l=s;for(let s=i;s<=h;s++)o(l,s,t),c>0?(l+=a,c+=2*(n-r)):c+=2*n}function a(t){return t%1}function c(t){return 1-t%1}function l(t,s){if(void 0===t)return;const i=t[a16_0x2b0c(203)](0);return i[3]=Math.round(i[3]*s),i}},1674:(t,s,i)=>{"use strict";const e=a16_0x416197;i.d(s,{q:()=>h});const h=e(232)},9455:(t,s,i)=>{"use strict";function e(t,s,i,e){return 180*h(t,s,i,e)/Math.PI}function h(t,s,i,e){let h=-Math[a16_0x2b0c(284)](e-s,i-t);return-180===h&&(h=180),h}function o(t){return t*Math.PI/180}function n(t,s,i,e,h,o){const n=a16_0x2b0c,r=Math.sqrt(Math[n(237)](t-i,2)+Math[n(237)](s-e,2)),a=Math[n(192)](Math[n(237)](i-h,2)+Math[n(237)](e-o,2)),c=Math[n(192)](Math[n(237)](h-t,2)+Math[n(237)](o-s,2)),l=(r+a+c)/2;return Math[n(192)](l*(l-r)*(l-a)*(l-c))}function r(t,s,i,e,h,o,r,a){return n(t,s,i,e,h,o)+n(i,e,h,o,r,a)+n(h,o,r,a,t,s)+n(r,a,t,s,i,e)}i.d(s,{AM:()=>e,zz:()=>h,Ht:()=>o,ku:()=>n,hu:()=>r})}}]);