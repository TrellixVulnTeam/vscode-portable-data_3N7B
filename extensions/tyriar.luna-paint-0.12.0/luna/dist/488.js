const a20_0x5317=["input","normal","_getAlignmentValue","pointerDown","number","dialog-click-guard","1411aTwWxX","_isBoldOption","_centerAlignOption","_onWillDispose","Blend Mode","rgba","onBeforeRunLayerTask","deserialize","_elementContainer","prepend","Enable","push","_onStateChange","visible","devicePixelRatio","transparent","_clearLayer","register","Draw Text","_topVerticalAlignOption","_sc","_textarea","state","_bottomVerticalAlignOption","button","_updateFontFamily","center","_updateFontSize","_value","replace","offsetX","_updateIsItalic","ArrowRight","serialize","classList","metaKey","taskWorkerService","setVisible","setValueFromHistoryChange","stroke","justify","fontFamily","step","bind","Set Text Color","primaryColor","bottom","_cursorCurrent","onUpdate","imageService","pointerMove","Disable","_blendModeOption","strokeWidth","1186ReNDVf","onCommit","_cursorOrigin","path","exclusion","floor","_onUpdate","right","fantasy","bottomleft","_allowNewState","set","_rectangleOtherPoint","381949rmYqVm","get","getPointerState","fill","_svgPath","position","onRequestRender","softLight"," y=","_imageService","_range","sans-serif"," Italic","_middleVerticalAlignOption","_updateText","onHistoryUnset","10CmjwPy","Set Text Blend Mode","_pointerDownY","removeChild","boolean","text","setColors","event","_createRange","viewportService","1503695QUumpm","pointerDownMove","altKey","Bottom vertical alignment","name","version","isBold","paletteService","currentLayer","_refreshInfo","Cancel","append","style","stopImmediatePropagation","_isVisible","_updateIsBold","darken","_container","_layer","absolute","italic","middle","Italic","_justifyAlignOption","_textLayer","_moveImageRangeRenderer","_fontFamilyOption","includes","Font family","Set Text Font Family","primary","_onHistoryUpdateValue","rightTriangle","Left alignment","hasTextLayer","width","offsetY","zoom","_pointerDownX","onHistoryUpdateValue","secondaryColor","verticalAlignment","top","_viewportService","cursive","Bold","_getVerticalAlignmentValue","fire"," pixels tall","_onRequestRender","_model","dialog-content-row","textContent","bold","clientHeight","then","bottomright","fontWeight","multiply","_directionalMoveElements","max","_alignOptions","1ZGsIGx","min","_leftAlignOption","dialog-buttons-row","addEventListener","keydown","var(--luna-focusColor)","ArrowDown","Justify alignment","1948843hNOiki","Set Text Vertical Alignment","info","stopPropagation","onLayerChange","10925blKvgc","triggerRequestRender","_updateAlignment","_sizeInfo","Set Text Font Size","webpackChunkluna","_rightAlignOption","hasImage","_topLeftInfo","_outlineModel","move-handle","options","onWillDispose","linearDodgeAdd","1423163wEYELj","dialog-box","string-combo","remove","display","#middle","1479273PqXKzO","ArrowLeft","MoveImageRangeRenderer","string","abs","height","topleft","_finish","_fontSizeOption","shape","_isItalicOption","textarea","new","Update Text","getInfo","round","size","fontSize","temporaryLayer","_cursorOriginalRectangle","type","move","svg","range","text-tool-input","_updateStyles","setAttribute"," x ","click","add","_verticalAlignOptions","div","taskService","flipX","_svg","selectionService","keyDown","_onOptionsChange","commit","lighten","triangle","flipY","buttons","_updateRect","historyService","Right alignment"," Bold","_updateVerticalAlignment","_setState","_textInputDialog","ArrowUp","createElement","blendMode","getSnapSettingCoordsFromEvent","left","currentState","render","Lorem ipsum","secondary","_updateColors","dispose","_directionalMoveZones","ellipse","_updateBlendMode","monospace","_setupActiveTemporaryLayer","_getLayer","default","overlay","getDetailedInfo","sign","Move Text","1.1","getOutlineSvgPath","isItalic","key","diamond","topright","appendChild","createElementNS","unregisterTemporaryLayer","shiftKey","alignment","value","_svgPath2"," pixels wide by ","screen","onTemporaryLayerRegistered","linearBurn","setRange","_getRange"],a20_0x1f2d=function(t,s){return a20_0x5317[t-=186]},a20_0x2fcd16=a20_0x1f2d;(function(t,s){const i=a20_0x1f2d;for(;;)try{if(850645===-parseInt(i(367))*-parseInt(i(453))+parseInt(i(467))+parseInt(i(439))*-parseInt(i(351))+-parseInt(i(377))+parseInt(i(284))*parseInt(i(338))+parseInt(i(187))+-parseInt(i(448)))break;t.push(t.shift())}catch(s){t.push(t.shift())}})(a20_0x5317),(self[a20_0x2fcd16(458)]=self[a20_0x2fcd16(458)]||[])[a20_0x2fcd16(295)]([[488,504],{3315:(t,s,i)=>{"use strict";const e=a20_0x2fcd16;i.d(s,{d:()=>c});var h=i(5120),n=i(1003),r=i(1674);let o,a;class c extends h.JT{constructor(t,s,i,e){const h=a20_0x1f2d;super(),this[h(394)]=t,this[h(360)]=s,this[h(420)]=i,this._model=e,this.order=2,this[h(221)]=document.createElementNS(r.q,h(209)),this[h(221)].setAttribute(h(382),h(259)),this._svg[h(389)][h(356)]=h(396),this[h(355)]=document[h(266)](r.q,h(341)),this[h(355)].style[h(323)]=h(445),this[h(355)][h(389)][h(354)]=h(299),this[h(355)].style[h(337)]="1",this[h(271)]=document[h(266)](r.q,h(341)),this._svgPath2[h(389)][h(323)]="var(--luna-focusColor)",this[h(271)][h(389)][h(354)]=h(299),this[h(271)][h(389)][h(337)]="1",this[h(221)].append(this[h(355)],this._svgPath2),this[h(394)][h(293)](this._svg),this.register({dispose:()=>this._container[h(370)](this._svg)})}async[e(243)](){const t=e,s=this[t(427)][t(210)],h=this[t(420)];if(!s)return void(this[t(221)][t(389)].display="none");if(this._svg.style.display="block",!this[t(360)][t(385)])return;if(o!==this[t(427)][t(196)]){let s;switch(o=this[t(427)][t(196)],o){case t(263):s=i.e(727)[t(432)](i[t(327)](i,727));break;case t(249):s=i.e(459)[t(432)](i.bind(i,8459));break;case t(227):s=i.e(12)[t(432)](i[t(327)](i,4012));break;case t(409):s=i.e(243)[t(432)](i[t(327)](i,6243));break;default:s=void 0}a=s?new Promise((async i=>{const e=t;i(new((await s)[e(254)]))})):s}const r=await a,c=Math[t(202)](this[t(394)].clientWidth/2)-this[t(360)][t(412)]/2*h.zoom+h.x*h[t(414)],l=Math.round(this._container[t(431)]/2)-this[t(360)][t(192)]/2*h[t(414)]+h.y*h[t(414)],d=(0,n.Oq)(s)*h[t(414)],u=(0,n.rY)(s)*h.zoom;this._svg[t(389)][t(241)]=c+s.left*h[t(414)]-2+"px",this[t(221)][t(389)][t(419)]=l+s[t(419)]*h[t(414)]-2+"px",this[t(221)][t(213)](t(412),(d+5).toString()),this[t(221)][t(213)](t(192),(u+5).toString()),this._svgPath[t(213)]("d","M2.5 2.5 h"+d+" v"+u+" h"+-d+" v"+-u),r?.[t(260)]?(this[t(271)][t(389)].display="block",this[t(271)][t(213)]("d",r[t(260)](d,u,this[t(427)][t(220)],this[t(427)][t(228)]))):this[t(271)][t(389)][t(471)]="none"}}},9865:(t,s,i)=>{"use strict";i.d(s,{q:()=>n});var e=i(1815),h=i(5120);class n extends h.JT{constructor(){const t=a20_0x1f2d;super(...arguments),this._onUpdate=this[t(301)](new e.v),this[t(332)]=this[t(344)][t(374)]}}},9904:(t,s,i)=>{"use strict";const e=a20_0x2fcd16;i.d(s,{FV:()=>o,rP:()=>a,tv:()=>c,Jp:()=>l,X5:()=>d,qv:()=>u});var h=i(1815),n=i(5120),r=i(2939);class o extends n.JT{constructor(t,s,i,e=!0){const n=a20_0x1f2d;super(),this[n(381)]=t,this[n(460)]=s,this[n(312)]=i,this.allowUnchecking=e,this[n(207)]=n(371),this._onHistoryUpdateValue=this[n(301)](new h.v),this[n(416)]=this[n(408)][n(374)],this[n(344)]=this[n(301)](new h.v),this.onUpdate=this._onUpdate[n(374)]}get[e(270)](){return this[e(312)]}set[e(270)](t){const s=e;this[s(312)]=t,this[s(344)].fire()}[e(322)](t){this[e(312)]=t,this._onHistoryUpdateValue.fire(t)}}class a extends n.JT{constructor(t,s,i){const n=e;super(),this[n(381)]=t,this[n(464)]=s,this[n(312)]=i,this[n(207)]=n(190),this._onHistoryUpdateValue=this[n(301)](new h.v),this[n(416)]=this[n(408)][n(374)],this._onUpdate=this[n(301)](new h.v),this[n(332)]=this[n(344)][n(374)]}get[e(270)](){return this[e(312)]}set[e(270)](t){const s=e;this[s(312)]=t,this._onUpdate[s(424)]()}[e(322)](t){const s=e;this[s(312)]=t,this[s(408)][s(424)](t)}}class c extends n.JT{constructor(t,s,i){const n=e;super(),this[n(381)]=t,this[n(464)]=s,this[n(312)]=i,this[n(207)]=n(469),this[n(408)]=this.register(new h.v),this[n(416)]=this[n(408)].event,this[n(344)]=this.register(new h.v),this.onUpdate=this[n(344)].event}get value(){return this._value}set value(t){const s=e;this[s(312)]=t,this._onUpdate[s(424)]()}[e(322)](t){const s=e;this[s(312)]=t,this[s(408)][s(424)](t)}}class l extends a{constructor(){const t=e;super("Blend Mode",[t(279),t(313),t(393),t(435),"linearBurn",t(226),t(273),t(466),t(255),t(358),"difference",t(342)],"normal")}}class d extends n.JT{constructor(t,s,i,n){const r=e;super(),this[r(381)]=t,this[r(312)]=s,this[r(440)]=i,this[r(437)]=n,this[r(207)]=r(282),this._onHistoryUpdateValue=this[r(301)](new h.v),this[r(416)]=this[r(408)].event,this[r(344)]=this[r(301)](new h.v),this[r(332)]=this[r(344)][r(374)]}get[e(270)](){const t=e;return(0,r.u)(this._value,this.max,this[t(440)])}set value(t){const s=e;this._value=t,this[s(344)][s(424)]()}[e(322)](t){const s=e;this._value=t,this[s(408)][s(424)](t)}}class u extends d{constructor(t,s,i,h){const n=e;super(t,s,i,h),this.type=n(282)}get value(){const t=e;return(0,r.u)(this._value,this[t(437)],this[t(440)])}set[e(270)](t){const s=e;this[s(312)]=Math[s(343)](t),this[s(344)][s(424)]()}}},504:(t,s,i)=>{"use strict";const e=a20_0x2fcd16;i.r(s),i.d(s,{MoveImageRangeRenderer:()=>r});var h=i(5120),n=i(1003);class r extends h.JT{constructor(t,s,i,e,h){const r=a20_0x1f2d;super(),this[r(394)]=t,this[r(277)]=s,this[r(348)]=i,this[r(420)]=e,this[r(360)]=h,this.order=2,this[r(436)]=new Map,this._directionalMoveZones=new Map,this[r(391)]=!0,this[r(292)]=document[r(238)]("div");const o=["topleft",r(264),r(347),r(433),r(419),r(330),r(241),"right"];for(const t of o){const s=document[r(238)]("div");s[r(318)].add(r(463),t),this._elementContainer[r(265)](s),this._directionalMoveElements[r(349)](t,s),this[r(248)][r(349)](t,(0,n.Pq)())}this._container[r(265)](this[r(292)]),this[r(301)]({dispose:()=>{const t=r;this[t(394)][t(370)](this[t(292)])}})}setVisible(t){const s=a20_0x1f2d;t!==this._isVisible&&(this._elementContainer.style[s(471)]=t?"":"none",this[s(391)]=t)}[e(276)](t){}[e(243)](){const t=e,s=this[t(277)]();if(!s)return;const i=this[t(360)][t(385)];if(!i)return;const h=this[t(420)],n=Math[t(202)](this[t(394)].clientWidth/2)-i[t(412)]/2*h[t(414)],r=Math.round(this._container[t(431)]/2)-i[t(192)]/2*h.zoom,o=n+(h.x+s[t(241)])*h.zoom,a=r+(h.y+s.top)*h[t(414)],c=n+(h.x+s[t(345)])*h[t(414)],l=r+(h.y+s[t(330)])*h.zoom,d=Math[t(202)]((o+c)/2),u=Math[t(202)]((a+l)/2),p=10*window[t(298)],g={left:Math[t(440)](o+p,Math[t(437)](o,d-p)),top:Math.min(a+p,Math[t(437)](a,u-p)),right:Math.max(c-p,Math[t(440)](c,d+p)),bottom:Math.max(l-p,Math[t(440)](l,u+p))},_={left:o-p,top:a-p,right:c+p,bottom:l+p},f=this._directionalMoveZones[t(352)](t(193));f[t(241)]=_[t(241)],f[t(345)]=g.left,f[t(419)]=_[t(419)],f[t(330)]=g[t(419)];const m=this[t(436)][t(352)](t(193));m[t(389)][t(241)]=o+"px",m[t(389)][t(419)]=a+"px";const v=this[t(248)].get("topright");v[t(241)]=g[t(345)],v.right=_[t(345)],v[t(419)]=_.top,v[t(330)]=g[t(419)];const y=this[t(436)][t(352)]("topright");y[t(389)][t(241)]=c+"px",y.style[t(419)]=a+"px";const x=this[t(248)][t(352)](t(347));x.left=_[t(241)],x[t(345)]=g[t(241)],x.top=g.bottom,x[t(330)]=_.bottom;const w=this[t(436)][t(352)](t(347));w[t(389)][t(241)]=o+"px",w[t(389)][t(419)]=l+"px";const b=this[t(248)].get(t(433));b[t(241)]=g[t(345)],b[t(345)]=_.right,b[t(419)]=g[t(330)],b[t(330)]=_[t(330)];const M=this[t(436)][t(352)](t(433));M.style[t(241)]=c+"px",M[t(389)][t(419)]=l+"px";const O=this._directionalMoveZones.get(t(419));O.left=g[t(241)],O.right=g[t(345)],O[t(419)]=_[t(419)],O.bottom=g.top;const S=this[t(436)][t(352)](t(419));S[t(389)][t(241)]=d+"px",S[t(389)].top=a+"px";const C=this[t(248)][t(352)]("bottom");C.left=g[t(241)],C[t(345)]=g[t(345)],C[t(419)]=g[t(330)],C[t(330)]=_[t(330)];const I=this[t(436)][t(352)](t(330));I[t(389)][t(241)]=d+"px",I[t(389)][t(419)]=l+"px";const R=this[t(248)][t(352)](t(241));R[t(241)]=_[t(241)],R[t(345)]=g[t(241)],R[t(419)]=g[t(419)],R.bottom=g[t(330)];const L=this[t(436)][t(352)](t(241));L[t(389)].left=o+"px",L[t(389)][t(419)]=u+"px";const V=this[t(248)].get(t(345));V.left=g[t(345)],V[t(345)]=_[t(345)],V[t(419)]=g.top,V.bottom=g.bottom;const A=this[t(436)][t(352)](t(345));A[t(389)][t(241)]=c+"px",A[t(389)].top=u+"px"}[e(353)](t){const s=e;if(!this[s(277)]())return this[s(348)]?s(199):s(208);for(const[i,e]of this[s(248)])if((0,n.RB)(e,t.offsetX,t[s(413)]))return i;const i=this[s(248)][s(352)]("topleft"),h=this._directionalMoveZones[s(352)](s(433)),r={left:i[s(241)],top:i[s(419)],right:h[s(345)],bottom:h[s(330)]};return(0,n.RB)(r,t[s(314)],t[s(413)])?"move":this[s(348)]?s(199):"move"}}},8488:(t,s,i)=>{"use strict";const e=a20_0x2fcd16;i.r(s),i.d(s,{default:()=>_});var h=i(1815),n=i(5120),r=i(1003),o=i(3315),a=i(504),c=i(7233),l=i(9904),d=i(8752),u=i(9865),p=i(7896);class g extends n.JT{constructor(t){const s=a20_0x1f2d;super(),this[s(304)]=t,this.id="text",this[s(306)]=s(199),this._outlineModel=new f((()=>this[s(401)])),this._blendModeOption=new l.Jp,this[s(403)]=new l.tv(s(405),["serif",s(362),s(251),s(421),s(346)],s(362)),this[s(195)]=new l.qv("Font size",16,1,1e3),this._isBoldOption=new l.FV(s(422),!0,!1),this[s(197)]=new l.FV(s(399),!0,!1),this[s(441)]=new l.FV(s(410),!0,!0,!1),this[s(286)]=new l.FV("Center alignment",!0,!1,!1),this[s(459)]=new l.FV(s(232),!0,!1,!1),this._justifyAlignOption=new l.FV(s(447),!0,!1,!1),this[s(303)]=new l.FV("Top vertical alignment",!0,!0,!1),this[s(364)]=new l.FV("Middle vertical alignment",!0,!1,!1),this[s(307)]=new l.FV(s(380),!0,!1,!1),this[s(438)]=[this[s(441)],this._centerAlignOption,this[s(459)],this._justifyAlignOption],this[s(217)]=[this[s(303)],this._middleVerticalAlignOption,this[s(307)]],this[s(464)]=[this[s(336)],this._fontFamilyOption,this[s(195)],this[s(285)],this[s(197)],...this[s(438)],...this[s(217)]],this[s(456)]=new m,this[s(461)]=new v,this[s(450)]=[this[s(461)],this[s(456)]],this[s(426)]=this.register(new h.v),this[s(357)]=this[s(426)][s(374)],this[s(296)]=this[s(301)](new h.v),this.onStateChange=this[s(296)][s(374)],this[s(301)](this[s(304)].paletteService[s(332)]((()=>this[s(246)]()))),this.register(this._blendModeOption.onUpdate((()=>this[s(250)]()))),this[s(301)](this[s(403)].onUpdate((()=>this[s(309)]()))),this.register(this[s(195)].onUpdate((()=>this[s(311)]()))),this.register(this[s(285)][s(332)]((()=>this._updateIsBold()))),this[s(301)](this[s(197)].onUpdate((()=>this[s(315)]())));for(const t of this[s(438)])this[s(301)](t[s(332)]((()=>this[s(455)](t))));for(const t of this._verticalAlignOptions)this.register(t[s(332)]((()=>this._updateVerticalAlignment(t))));this[s(301)](this[s(304)][s(333)][s(452)]((()=>this[s(194)]()))),this[s(301)](this[s(304)][s(219)][s(290)]((()=>this._finish()))),this[s(301)]((0,n.OF)((()=>this[s(194)]()))),this.register((0,n.OF)((()=>this._textInputDialog?.[s(247)]()))),this[s(301)](this._sc[s(333)][s(274)]((t=>this[s(252)](t)))),this[s(304)][s(333)][s(385)]?.[s(205)]&&this._setupActiveTemporaryLayer(this[s(304)][s(333)][s(385)].temporaryLayer)}_setupActiveTemporaryLayer(t){const s=a20_0x1f2d;t.type===s(372)&&(this[s(401)]=t,this[s(301)](this[s(401)][s(339)]((()=>this[s(300)]()))),this.register(this[s(401)].onHistoryAction((()=>{this[s(224)](),this._refreshInfo()}))),this[s(301)](this[s(401)][s(366)]((()=>this[s(300)]()))),this._rectangleOtherPoint=[this[s(401)].currentState[s(210)][s(345)],this[s(401)][s(242)][s(210)][s(330)]],this._moveImageRangeRenderer?.[s(321)](!0),this._onRequestRender[s(424)]())}_refreshInfo(){const t=a20_0x1f2d,s=this[t(401)]?(0,r.FJ)(this[t(401)][t(242)].range):void 0;this[t(456)][t(210)]=s,this[t(461)][t(210)]=s}[e(223)](t,s){const i=e;if(this[i(401)]&&!s&&[i(237),i(188),i(446),i(316)][i(404)](t[i(262)])){const s=(0,r.BN)(this._textLayer[i(242)][i(210)]),e=(p.V5?t[i(319)]:t.ctrlKey)?10:1;switch(t[i(262)]){case"ArrowUp":(0,r.Hd)(s,s.left,s[i(419)]-e);break;case i(446):(0,r.Hd)(s,s[i(241)],s[i(419)]+e);break;case i(188):(0,r.Hd)(s,s.left-e,s[i(419)]);break;case i(316):(0,r.Hd)(s,s[i(241)]+e,s[i(419)])}this._textLayer[i(242)][i(210)]=s,this[i(401)][i(326)]("Shift Text")}}async[e(281)](t){const s=e,i=this[s(304)][s(333)][s(385)];if(!i)return;const h=!(1&t[s(229)]);this[s(415)]=t[s(314)],this[s(369)]=t[s(413)];const n=this[s(304)].viewportService[s(240)](t,!1);if(this[s(340)]=n,this[s(331)]=n,this[s(306)]!==s(199))return this._cursorOriginalRectangle=(0,r.BN)(this[s(401)]?.[s(242)][s(210)]),void(this[s(206)]&&((this.state===s(419)||this[s(306)]===s(193)||"topright"===this.state)&&(this[s(340)][1]=this[s(206)][s(419)]),(this[s(306)]===s(330)||this[s(306)]===s(347)||"bottomright"===this[s(306)])&&(this[s(340)][1]=this[s(206)][s(330)]-1),(this[s(306)]===s(241)||this.state===s(193)||this[s(306)]===s(347))&&(this[s(340)][0]=this[s(206)][s(241)]),("right"===this.state||"topright"===this[s(306)]||this[s(306)]===s(433))&&(this._cursorOrigin[0]=this._cursorOriginalRectangle.right-1)));await this[s(194)](),this._rectangleOtherPoint=n;const o=this[s(375)](this[s(340)],this[s(331)]);this[s(206)]=(0,r.BN)(o),this[s(401)]=new c.o(i,{invertColors:h},{primaryColor:this[s(304)][s(384)][s(407)][s(289)],secondaryColor:this[s(304)][s(384)][s(245)].rgba,blendMode:this[s(336)].value,range:o,text:s(244),isBold:this[s(285)].value,isItalic:this[s(197)][s(270)],fontSize:this[s(195)][s(270)],fontFamily:this[s(403)][s(270)],alignment:this[s(280)](),verticalAlignment:this[s(423)]()},this[s(304)][s(231)],this._sc[s(222)],this[s(304)][s(320)]),this[s(386)](),await i.registerTemporaryLayer(this[s(401)]),this[s(402)]?.[s(321)](!1),this[s(401)][s(454)]()}[e(378)](t){const s=e;if(void 0===this._pointerDownX||void 0===this[s(369)]||!this[s(340)]||!this[s(350)]||!this[s(206)])return;const i=this[s(304)][s(376)].getSnapSettingCoordsFromEvent(t,!1);if(this._cursorCurrent&&i[0]===this._cursorCurrent[0]&&i[1]===this._cursorCurrent[1])return;if(this[s(331)]=i,!this._textLayer)return;const h=this[s(331)][0]-this._cursorOrigin[0],n=this._cursorCurrent[1]-this[s(340)][1];switch(this[s(306)]){case s(199):return this[s(350)]=i,void this[s(230)](t,!0);case s(208):{const t=(0,r.BN)(this[s(206)]);t[s(241)]+=h,t[s(419)]+=n,t.right+=h,t[s(330)]+=n,(0,r.FJ)(t),this._textLayer[s(242)][s(210)]=t;break}default:{let i;if(!t[s(268)]||this.state!==s(193)&&this[s(306)]!==s(264)&&this[s(306)]!==s(347)&&this[s(306)]!==s(433))i=(0,r.BN)(this._cursorOriginalRectangle),(this[s(306)]===s(419)||this.state===s(193)||this[s(306)]===s(264))&&(i.top+=n,i[s(330)]<=i[s(419)]&&i[s(419)]++,t[s(379)]&&(i[s(330)]-=n)),(this[s(306)]===s(330)||this.state===s(347)||this[s(306)]===s(433))&&(i[s(330)]+=n,i[s(330)]<=i[s(419)]&&i[s(330)]--,t.altKey&&(i[s(419)]-=n)),("left"===this[s(306)]||"topleft"===this[s(306)]||this[s(306)]===s(347))&&(i.left+=h,i[s(345)]<=i[s(241)]&&i[s(241)]++,t.altKey&&(i.right-=h)),(this[s(306)]===s(345)||"topright"===this[s(306)]||"bottomright"===this[s(306)])&&(i[s(345)]+=h,i[s(345)]<=i[s(241)]&&i[s(345)]--,t[s(379)]&&(i[s(241)]-=h));else{const e=(0,r.n3)(this[s(206)]);let o;switch(i=(0,r.BN)(this._cursorOriginalRectangle),this.state){case s(193):o=(1/e*-h-n)/2,i[s(241)]-=Math[s(202)](o*e),i.top-=Math[s(202)](o),t[s(379)]&&(i.right+=Math.round(o*e),i[s(330)]+=Math[s(202)](o));break;case s(264):o=(h*(1/e)-n)/2,i[s(345)]+=Math.round(o*e),i[s(419)]-=Math.round(o),t.altKey&&(i[s(241)]-=Math[s(202)](o*e),i.bottom+=Math[s(202)](o));break;case"bottomleft":o=(1/e*-h+n)/2,i[s(241)]-=Math[s(202)](o*e),i[s(330)]+=Math[s(202)](o),t[s(379)]&&(i[s(345)]+=Math[s(202)](o*e),i[s(419)]-=Math[s(202)](o));break;case s(433):o=(h*(1/e)+n)/2,i[s(345)]+=Math[s(202)](o*e),i[s(330)]+=Math[s(202)](o),t[s(379)]&&(i.left-=Math[s(202)](o*e),i[s(419)]-=Math[s(202)](o))}}this[s(401)].currentState[s(210)]=(0,r.FJ)(i);break}}this._refreshInfo(),this[s(401)].triggerRequestRender()}[e(334)](t,s){const i=e;this[i(402)]&&!s&&this._setState(this[i(402)][i(353)](t))}dblClick(t){const s=e;!this[s(236)]&&this._textLayer&&this[s(306)]===s(208)&&(this._textInputDialog=new y(this[s(401)],this[s(403)],this[s(195)],this[s(285)],this[s(197)]),this._textInputDialog[s(465)]((()=>this._textInputDialog=void 0)))}async pointerUp(t,s){const i=e;if("new"===this.state&&(s||this[i(331)]?.[0]===this._cursorOrigin?.[0]&&this._cursorCurrent?.[1]===this[i(340)]?.[1]))return this[i(401)]&&this[i(304)][i(333)][i(385)]?.[i(267)](this._textLayer),this[i(401)]?.[i(247)](),void this[i(300)]();if(this[i(401)]){let t;switch(this[i(306)]){case i(199):t=i(302);break;case i(208):if(s)return;t=i(258);break;case"topleft":case i(264):case"bottomleft":case"bottomright":case i(419):case"left":case i(345):case i(330):t="Resize Text"}this[i(401)][i(326)](t)}this[i(402)]?.setVisible(!0),this[i(334)](t,!1)}[e(246)](){const t=e;if(!this[t(401)])return;const s=this[t(304)].paletteService[t(407)],i=this._sc[t(384)][t(245)];(0,d.WC)(this[t(401)].currentState.primaryColor,s[t(289)])&&(0,d.WC)(this._textLayer.currentState[t(417)],i[t(289)])||(this[t(401)][t(242)][t(329)]=s[t(289)],this[t(401)].currentState[t(417)]=i[t(289)],this[t(401)].step(t(328),!0),this[t(401)].triggerRequestRender())}[e(250)](){const t=e,s=this._blendModeOption[t(270)];this._textLayer&&this._textLayer[t(242)][t(239)]!==s&&(this[t(401)][t(242)][t(239)]=s,this[t(401)][t(326)](t(368)),this._textLayer[t(454)]())}[e(309)](){const t=e,s=this[t(403)][t(270)];this[t(401)]&&this[t(401)].currentState[t(325)]!==s&&(this[t(401)].currentState[t(325)]=s,this._textLayer.step(t(406),!0),this[t(401)][t(454)]())}[e(311)](){const t=e,s=this[t(195)][t(270)];this[t(401)]&&this[t(401)][t(242)][t(204)]!==s&&(this[t(401)][t(242)][t(204)]=s,this[t(401)][t(326)](t(457),!0),this[t(401)][t(454)]())}[e(392)](){const t=e,s=this._isBoldOption[t(270)];this._textLayer&&this[t(401)].currentState.isBold!==s&&(this._textLayer[t(242)][t(383)]=s,this[t(401)][t(326)](t(s?294:335)+t(233)),this[t(401)][t(454)]())}_updateIsItalic(){const t=e,s=this._isItalicOption[t(270)];this[t(401)]&&this[t(401)][t(242)][t(261)]!==s&&(this[t(401)][t(242)].isItalic=s,this[t(401)][t(326)](t(s?294:335)+t(363)),this[t(401)][t(454)]())}async[e(455)](t){const s=e;for(const i of this[s(438)])i!==t&&i.setValueFromHistoryChange(!1);const i=this[s(280)]();this._textLayer&&this[s(401)][s(242)][s(269)]!==i&&(this[s(401)][s(242)].alignment=i,this[s(401)][s(326)]("Set Text Alignment"),this._textLayer[s(454)]())}async[e(234)](t){const s=e;for(const s of this._verticalAlignOptions)s!==t&&s.setValueFromHistoryChange(!1);const i=this[s(423)]();this[s(401)]&&this[s(401)].currentState[s(418)]!==i&&(this[s(401)][s(242)].verticalAlignment=i,this._textLayer[s(326)](s(449)),this[s(401)].triggerRequestRender())}[e(280)](){const t=e;return this._leftAlignOption[t(270)]?t(241):this[t(286)][t(270)]?t(310):this._rightAlignOption[t(270)]?t(345):"justify"}_getVerticalAlignmentValue(){const t=e;return this._topVerticalAlignOption[t(270)]?"top":this[t(364)][t(270)]?t(398):t(330)}[e(224)](){const t=e;this[t(401)]&&(this._blendModeOption[t(322)](this[t(401)][t(242)].blendMode),this[t(403)].setValueFromHistoryChange(this[t(401)].currentState.fontFamily),this[t(195)].setValueFromHistoryChange(this[t(401)][t(242)][t(204)]),this[t(285)][t(322)](this[t(401)][t(242)][t(383)]),this[t(197)][t(322)](this[t(401)].currentState[t(261)]),this[t(441)][t(322)]("left"===this[t(401)][t(242)][t(269)]),this[t(286)][t(322)]("center"===this._textLayer[t(242)][t(269)]),this._rightAlignOption.setValueFromHistoryChange("right"===this._textLayer.currentState[t(269)]),this[t(400)][t(322)](this[t(401)].currentState[t(269)]===t(324)),this._topVerticalAlignOption[t(322)](this._textLayer.currentState[t(418)]===t(419)),this._middleVerticalAlignOption[t(322)]("middle"===this[t(401)][t(242)].verticalAlignment),this[t(307)][t(322)](this[t(401)][t(242)][t(418)]===t(330)),(!(0,d.WC)(this._sc[t(384)][t(407)][t(289)],this[t(401)][t(242)][t(329)])||!(0,d.WC)(this[t(304)][t(384)][t(245)][t(289)],this[t(401)][t(242)][t(417)]))&&this[t(304)][t(384)][t(373)](this[t(401)].currentState[t(329)],this[t(401)][t(242)][t(417)]))}[e(235)](t){const s=e;this[s(306)]!==t&&(this[s(306)]=t,this._onStateChange[s(424)]())}[e(230)](t,s){const i=e;if(!s||!this._cursorOrigin||!this[i(331)])return;let h=this._cursorOrigin[0]-this[i(331)][0],n=this[i(340)][1]-this._cursorCurrent[1];t.shiftKey&&(Math[i(191)](h)>Math[i(191)](n)?h=n*(Math.sign(h)!==Math.sign(n)?-1:1):n=h*(Math[i(257)](h)!==Math[i(257)](n)?-1:1));const r=t[i(379)]?[this[i(340)][0]+h,this[i(340)][1]+n]:this._cursorOrigin,o=this[i(375)](r,[this._cursorOrigin[0]-h,this[i(340)][1]-n]);this[i(401)]&&(this[i(401)][i(242)][i(210)]=o),this._onRequestRender[i(424)]()}[e(375)](t,s){return(0,r.tH)(t[0],t[1],s[0],s[1])}async[e(194)](){const t=e;await(this._textLayer?.[t(225)]()),this[t(300)]()}[e(300)](){const t=e;this[t(401)]=void 0,this[t(402)]?.[t(321)](!1),this[t(386)](),this[t(426)][t(424)]()}createDomRenderProgram(t){const s=e;return this._moveImageRangeRenderer=new(a[s(189)])(t,(()=>this[s(401)]?.[s(242)].range),!0,this[s(304)][s(376)],this._sc[s(333)]),this[s(402)][s(321)](this[s(306)]!==s(199)),[this[s(402)],new o.d(t,this[s(304)][s(333)],this._sc[s(376)],this[s(462)])]}[e(317)](){const t=e;return{state:this[t(306)],hasTextLayer:!!this[t(401)]}}[e(291)](t){const s=e;t[s(411)]?this[s(402)]?.[s(321)](!0):this[s(300)](),this[s(235)](t[s(306)]),this._onOptionsChange(),this._refreshInfo()}}const _=g;class f{constructor(t){this[e(253)]=t}get range(){return this[e(253)]()?.currentState.range}}class m extends u.q{constructor(){const t=e;super(...arguments),this[t(207)]=t(203)}get range(){return this[e(361)]}set[e(210)](t){const s=e;this._range=t,this._onUpdate[s(424)]()}get[e(297)](){return!!this._range}[e(201)](){const t=e;if(!this._range)return"";const s=(0,r.Oq)(this[t(361)]),i=(0,r.rY)(this._range);return s+t(214)+i}[e(256)](){const t=e;if(!this._range)return"";const s=(0,r.Oq)(this[t(361)]),i=(0,r.rY)(this[t(361)]);return"Text size is "+s+t(272)+i+t(425)}}class v extends u.q{constructor(){const t=e;super(...arguments),this[t(207)]=t(193)}get[e(210)](){return this[e(361)]}set[e(210)](t){const s=e;this[s(361)]=t,this[s(344)][s(424)]()}get[e(297)](){return!!this[e(361)]}[e(201)](){const t=e;return this._range?this[t(361)][t(241)]+", "+this[t(361)].top:""}[e(256)](){const t=e;return this[t(361)]?"Text top left position is x="+this._range[t(241)]+t(359)+this._range[t(419)]:""}}class y extends n.JT{constructor(t,s,i,r,o){const a=e;super(),this[a(395)]=t,this[a(403)]=s,this._fontSizeOption=i,this[a(285)]=r,this._isItalicOption=o,this._onWillDispose=this.register(new h.v),this[a(465)]=this[a(287)][a(374)],this.register(this[a(403)].onUpdate((()=>this._updateStyles()))),this[a(301)](this._fontSizeOption[a(332)]((()=>this[a(212)]()))),this[a(301)](this[a(285)][a(332)]((()=>this[a(212)]()))),this[a(301)](this[a(197)][a(332)]((()=>this[a(212)]())));const c=document[a(238)](a(218));c[a(318)][a(216)](a(283)),c[a(443)](a(215),(t=>t[a(451)]()));const l=document[a(238)]("div");l[a(318)][a(216)](a(428)),this[a(305)]=document.createElement(a(198));const d=this[a(395)].currentState[a(372)];this[a(305)].value=d,this[a(305)].classList[a(216)](a(211)),this[a(305)][a(443)](a(444),(t=>t[a(390)]())),this[a(305)].addEventListener(a(278),(t=>this[a(365)](this[a(305)][a(270)]))),l[a(388)](this._textarea);const u=document.createElement("div");u[a(318)][a(216)](a(442));const g=document[a(238)]("button");g[a(429)]="OK",g[a(443)]("click",(()=>this[a(247)]()));const _=document[a(238)](a(308));_[a(429)]=a(387),_[a(443)](a(215),(()=>{const t=a;this[t(365)](d),f.remove(),this[t(247)]()})),p.V5?u[a(388)](_,g):u.append(g,_);const f=document[a(238)](a(218));f[a(318)].add(a(468)),f[a(388)](l,u),document.querySelector(a(186))[a(388)](c,f),this._textarea.select(),this[a(301)]((0,n.OF)((()=>{c[a(470)](),f.remove()})))}[e(247)](){const t=e;this[t(287)][t(424)](),super.dispose()}[e(212)](){const t=e;this[t(305)][t(389)][t(325)]=this[t(403)][t(270)],this[t(305)].style[t(204)]=this[t(195)][t(270)]+"px",this[t(305)][t(389)][t(434)]=this[t(285)][t(270)]?t(430):"",this._textarea[t(389)].fontStyle=this._isItalicOption[t(270)]?t(397):""}[e(365)](t){const s=e;this[s(395)]&&this._layer.currentState[s(372)]!==t&&(this[s(395)].currentState.text=t,this[s(395)][s(326)](s(200),!0),this._layer.triggerRequestRender())}}},1674:(t,s,i)=>{"use strict";i.d(s,{q:()=>e});const e="http://www.w3.org/2000/svg"}}]);