const a27_0x2d54=["bottom","primaryColor","length","blendMode","px ","data","width","fontSize","selection","floor","fillStyle","getImageData"," x ",'Range "',"1568053TnwbVZ","112213qORqxb","middle","alignment","10mwSdcb","verticalAlignment","replace","min","center","111670OufOKp","push","height",'" and "',"textAlign","3387QEXPkP","getContext","The text can not be drawn outside of the selection and viewport","targetImage",'": ',"webpackChunkluna","112159wQMMIi","1vSXhrF","dimensions","text","3602392BeNBBU","fontFamily","isItalic","top"," italic","subarray","round","justify","551957HdHeZh"," must be contained within ","update",'" dimensions differ',"max","ceil","1YliKYW","right","split","265ggmgkT","fillText","left"],a27_0x1c86=function(t,e){return a27_0x2d54[t-=115]},a27_0x677f48=a27_0x1c86;(function(t,e){const n=a27_0x1c86;for(;;)try{if(790440===parseInt(n(123))+parseInt(n(146))+parseInt(n(152))*parseInt(n(134))+-parseInt(n(118))*parseInt(n(115))+parseInt(n(135))*-parseInt(n(172))+parseInt(n(155))*-parseInt(n(128))+parseInt(n(138)))break;t.push(t.shift())}catch(e){t.push(t.shift())}})(a27_0x2d54),(self[a27_0x677f48(133)]=self.webpackChunkluna||[])[a27_0x677f48(124)]([[919],{5919:(t,e,n)=>{"use strict";n.r(e),n.d(e,{run:()=>c});var a=n(4371),r=n(7517),o=n(2939),i=n(1003),s=n(7742);const c=async(t,e,n)=>{const c=a27_0x1c86;return(0,s.ap)(n,c(131)),function(t,e){const n=a27_0x1c86,s=e[n(131)][n(164)],c=e.targetImage.height,f={...e[n(136)]};if(f[n(157)]=Math.floor(f[n(157)]),f[n(153)]=Math[n(151)](f[n(153)]),f[n(141)]=Math.floor(f[n(141)]),f[n(158)]=Math[n(151)](f.bottom),f[n(157)]=(0,o.u)(Math[n(167)](f[n(157)]),s,0),f[n(153)]=(0,o.u)(Math[n(151)](f[n(153)]),s,0),f[n(141)]=(0,o.u)(Math[n(151)](f[n(141)]),c,0),f[n(158)]=(0,o.u)(Math[n(151)](f[n(158)]),c,0),e[n(166)]&&(e[n(166)][n(157)]>f.left&&(f.left=Math.min(e[n(166)][n(157)],f[n(153)])),e[n(166)][n(153)]<f.right&&(f[n(153)]=Math.max(e.selection.right,f[n(157)])),e.selection.top>f[n(141)]&&(f[n(141)]=Math[n(121)](e[n(166)].top,f[n(158)])),e.selection[n(158)]<f[n(158)]&&(f[n(158)]=Math[n(150)](e[n(166)][n(158)],f[n(141)]))),f[n(157)]===f.right||f[n(141)]===f[n(158)])throw new Error(n(130));const h=(0,i.Oq)(f),l=(0,i.rY)(f),d=(0,i.Oq)(e[n(136)]),u=(0,i.rY)(e.dimensions),x=new OffscreenCanvas(h,l)[n(129)]("2d");if(!x)throw new Error("Could not attain 2d context");let g="";e.isBold&&(g+=" bold"),e[n(140)]&&(g+=n(142)),g+=" "+e[n(165)]+n(162)+e[n(139)],x.font=g.trim(),x[n(127)]=n(157),x.textBaseline="top",x[n(168)]="rgba("+e[n(159)][0]+","+e[n(159)][1]+","+e[n(159)][2]+","+e[n(159)][3]/255+")";const p=function(t,e,n){const a=a27_0x1c86,r=[],o=e[a(154)]("\n");for(const e of o){const o=e.split(" ");let i=o[0];for(let e=1;e<o[a(160)];e++){const s=o[e];t.measureText(i+" "+s)[a(164)]<n?i+=" "+s:(r[a(124)]({text:i,width:t.measureText(i)[a(164)]}),i=s)}r[a(124)]({text:i,width:t.measureText(i)[a(164)]})}return r}(x,e[n(137)],d),w=e.fontSize;let m;switch(e[n(119)]){case n(141):m=0;break;case n(116):m=Math[n(144)]((u-p[n(160)]*w)/2);break;case n(158):m=u-w*p.length}if(m+=e[n(136)][n(141)]-f[n(141)],e[n(117)]===n(145))for(const t of p){const a=t.text[n(154)](" ").map((t=>{const e=n;return{text:t,width:x.measureText(t)[e(164)]}})),r=(d-a.reduce(((t,e)=>t+e.width),0))/(a[n(160)]-1);let o=e[n(136)][n(157)]-f[n(157)];for(const t of a)x[n(156)](t[n(137)],Math.round(o),m),o+=t[n(164)]+r;m+=w}else for(const t of p){let a;switch(e[n(117)]){case n(157):a=0;break;case n(122):a=d/2,x.textAlign=n(122);break;case n(153):a=d,x[n(127)]="right"}a+=e[n(136)][n(157)]-f[n(157)],x[n(156)](t[n(137)],a,m),m+=w}const b=x[n(169)](0,0,h,l),I=(0,a.X$)(s*c,s*c*4,!0),M=(0,a.X$)(s*c*2,Math[n(150)](s,c),!0);let _=0,k=0,y=0,T=0;for(y=0;y<l;y++)for(k=0;k<h;k++)T=4*(y*h+k),b.data[T+3]>0&&(M[2*_]=k,M[2*_+1]=y,I[_++]=4*((f[n(141)]+y)*s+f[n(157)]+k));const B=I[n(143)](0,_);t[n(148)](.25);const v=new Uint8Array(new SharedArrayBuffer(4*I[n(160)]));for(T=0;T<I.length;T++)(0,a.Yr)(v,4*T,e[n(131)][n(163)],I[T]);if(t[n(148)](.5),e[n(161)]===n(120))for(T=0;T<B[n(160)];T++)(0,a.Yr)(e[n(131)][n(163)],B[T],b.data,4*(M[2*T+1]*h+M[2*T]));else for(T=0;T<B[n(160)];T++)(0,r.B)(e[n(161)],e[n(131)][n(163)],B[T],b.data,4*(M[2*T+1]*h+M[2*T]));t.update(.75);const A=new Uint8Array(new SharedArrayBuffer(4*I[n(160)]));for(T=0;T<I.length;T++)(0,a.Yr)(A,4*T,e[n(131)][n(163)],I[T]);return t[n(148)](1),{undoData:{indexList:B,colorData:v},redoData:{indexList:B,colorData:A},range:f}}(e,n)}},7742:(t,e,n)=>{"use strict";n.d(e,{ap:()=>r,TO:()=>o,zg:()=>i});var a=n(1003);function r(t,e){const n=a27_0x1c86,a=t[e];if(a[n(164)]<1||a[n(125)]<1)throw new Error('Invalid dimensions for image "'+e+n(132)+a.width+n(170)+a[n(125)])}function o(t,e,n){const a=a27_0x1c86,r=t[e],o=t[n];if(r[a(164)]===o[a(164)]&&r.height===o.height)throw new Error('Images "'+e+a(126)+n+'" dimensions are equal')}function i(t,e,n){const r=a27_0x1c86,o=t[e];if(!(0,a.ur)(n,o))throw new Error(r(171)+e+'" '+(0,a.PW)(o)+r(147)+(0,a.PW)(n))}}}]);