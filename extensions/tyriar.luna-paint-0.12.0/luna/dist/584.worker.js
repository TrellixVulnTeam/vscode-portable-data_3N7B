const a7_0x2006=["pow","isInteger","105571anABEU","1rFkNRL","bottom","data",'Invalid dimensions for image "',"color","webpackChunkluna","right","abs","max","top","1UyhAwW","width","ceil",'": ',"replace","floor","35579KlQGiE","left",'" and "'," x ","9194jxfixp","1201zeMbHi","31437fdrUGw","tolerance","min",")->(",'Images "',"round",'Range "',"subarray",'" dimensions are equal',"update","106179dmeYgM","set","7kbJyey","sqrt","41SPyJRL","height","targetImage","1zYGutl","28295dgxPzL","blendMode"," must be contained within ","length"],a7_0x4f0c=function(t,n){return a7_0x2006[t-=141]},a7_0x5d18a1=a7_0x4f0c;(function(t,n){const r=a7_0x4f0c;for(;;)try{if(145428===parseInt(r(163))*parseInt(r(178))+-parseInt(r(176))*-parseInt(r(162))+-parseInt(r(181))*-parseInt(r(141))+parseInt(r(158))*parseInt(r(142))+parseInt(r(182))+-parseInt(r(174))+parseInt(r(152))*-parseInt(r(164)))break;t.push(t.shift())}catch(n){t.push(t.shift())}})(a7_0x2006),(self[a7_0x5d18a1(147)]=self.webpackChunkluna||[]).push([[584],{584:(t,n,r)=>{"use strict";r.r(n),r.d(n,{run:()=>c});var e=r(371),a=r(3),o=r(742),i=r(517);const c=async(t,n,r)=>{const c=a7_0x4f0c;(0,o.ap)(r,c(180));const u=r[c(180)][c(144)],h=r.targetImage[c(153)],l=r.targetImage.height,d=r.x,g=r.y,x=4*(g*h+d),p=u[c(171)](x,x+4),w=r[c(165)]*r.tolerance*4,y=(0,e.X$)(h*l*2,Math.max(h,l));let _=0;y[_++]=d,y[_++]=g;const A=new Uint8Array(h*l);A[g*h+d]=1;const M=(0,e.X$)(h*l,h*l*4,!0);let m=0;const I=(0,a.Re)(d,g),B=(0,a.DI)(h,l),U=r.selection||B;let b=0,R=0,v=0,k=0;for(;_>0;)R=y[--_],b=y[--_],v=R*h+b,k=4*v,E=u,z=k,D=p,((L=w)>0?(f[0]=D[0]-E[z],f[1]=D[1]-E[z+1],f[2]=D[2]-E[z+2],f[3]=D[3]-E[z+3],f[4]=(1+f[0]*f[0])*D[3]/256+(1+f[1]*f[1])*D[3]/256+(1+f[2]*f[2])*D[3]/256+f[3]*f[3],f[4]<=L):E[z]===D[0]&&E[z+1]===D[1]&&E[z+2]===D[2]&&E[z+3]===D[3])&&(M[m++]=k,(0,a.Hv)(I,b,R),(0,a.RB)(B,b+1,R)&&0===A[v+1]&&((0,a.RB)(U,b+1,R)&&(y[_++]=b+1,y[_++]=R),A[v+1]=1),(0,a.RB)(B,b-1,R)&&0===A[v-1]&&((0,a.RB)(U,b-1,R)&&(y[_++]=b-1,y[_++]=R),A[v-1]=1),(0,a.RB)(B,b,R+1)&&0===A[v+h]&&((0,a.RB)(U,b,R+1)&&(y[_++]=b,y[_++]=R+1),A[v+h]=1),(0,a.RB)(B,b,R-1)&&0===A[v-h]&&((0,a.RB)(U,b,R-1)&&(y[_++]=b,y[_++]=R-1),A[v-h]=1));var E,z,D,L;const P=M[c(171)](0,m);n[c(173)](.25);const S=s(u,P);n.update(.5),function(t,n,r,e){const a=a7_0x4f0c;let o=0;for(let c=0;c<n[a(185)];c++)o=n[c],(0,i.B)(e,t,o,r,0)}(u,P,r[c(146)],r[c(183)]),n[c(173)](.75);const Y=s(u,P);return n[c(173)](1),{indexList:P,undoColorData:S,redoColorData:Y,range:I}},f=new Int32Array(5);function s(t,n){const r=new Uint8Array(new SharedArrayBuffer(4*n[a7_0x4f0c(185)]));for(let e=0;e<n.length;e++)r[4*e]=t[n[e]],r[4*e+1]=t[n[e]+1],r[4*e+2]=t[n[e]+2],r[4*e+3]=t[n[e]+3];return r}},742:(t,n,r)=>{"use strict";r.d(n,{ap:()=>a,TO:()=>o,zg:()=>i});var e=r(3);function a(t,n){const r=a7_0x4f0c,e=t[n];if(e[r(153)]<1||e[r(179)]<1)throw new Error(r(145)+n+r(155)+e[r(153)]+r(161)+e[r(179)])}function o(t,n,r){const e=a7_0x4f0c,a=t[n],o=t[r];if(a[e(153)]===o[e(153)]&&a.height===o[e(179)])throw new Error(e(168)+n+e(160)+r+e(172))}function i(t,n,r){const a=a7_0x4f0c,o=t[n];if(!(0,e.ur)(r,o))throw new Error(a(170)+n+'" '+(0,e.PW)(o)+a(184)+(0,e.PW)(r))}},371:(t,n,r)=>{"use strict";const e=a7_0x5d18a1;function a(t,n=2*t[e(185)]){const r=e;let a;if(t instanceof Float32Array)a=new Float32Array(n);else if(t instanceof Uint8Array)a=new Uint8Array(n);else if(t instanceof Uint16Array)a=new Uint16Array(n);else{if(!(t instanceof Uint32Array))throw new Error("Unrecognized array type");a=new Uint32Array(n)}return a[r(175)](t),a}function o(t,n,r=!1){return n<Math[e(186)](2,8)?r?new Uint8Array(new SharedArrayBuffer(t)):new Uint8Array(t):n<Math.pow(2,16)?r?new Uint16Array(new SharedArrayBuffer(2*t)):new Uint16Array(t):r?new Uint32Array(new SharedArrayBuffer(4*t)):new Uint32Array(t)}function i(t,n,r,e){t[n]=r[e],t[n+1]=r[e+1],t[n+2]=r[e+2],t[n+3]=r[e+3]}r.d(n,{Rs:()=>a,X$:()=>o,Yr:()=>i})},517:(t,n,r)=>{"use strict";const e=a7_0x5d18a1;r.d(n,{B:()=>f});var a=r(371);const o=new Float32Array(6);let i;const c={normal:(t,n)=>n,darken:(t,n)=>Math[e(166)](t,n),multiply:(t,n)=>t*n,linearBurn:(t,n)=>Math[e(150)](t+n-1,0),lighten:(t,n)=>Math[e(150)](t,n),screen:(t,n)=>1-(1-t)*(1-n),linearDodgeAdd:(t,n)=>Math[e(166)](t+n,1),overlay:(t,n)=>t<.5?2*t*n:1-2*(1-t)*(1-n),softLight:(t,n)=>n<.5?2*t*n+t*t*(1-2*n):Math[e(177)](t)*(2*n-1)+2*t*(1-n),difference:(t,n)=>Math[e(149)](t-n),exclusion:(t,n)=>t+n-2*t*n};function f(t,n,r,f,u,h=n,l=r){const d=e;if(t!==d(156)){if(o[0]=f[u+3]/255,0===o[0])return n[r]=h[l],n[r+1]=h[l+1],n[r+2]=h[l+2],void(n[r+3]=h[l+3]);if(o[1]=h[l+3]/255,0===o[1])return n[r]=f[u],n[r+1]=f[u+1],n[r+2]=f[u+2],void(n[r+3]=f[u+3]);i=c[t],o[3]=i(h[l]/255,f[u]/255),o[4]=i(h[l+1]/255,f[u+1]/255),o[5]=i(h[l+2]/255,f[u+2]/255),o[2]=o[0]+o[1]*(1-o[0]),n[r]=Math[d(169)](s(h[l]/255,o[1],f[u]/255,o[0],o[3])/o[2]*255),n[r+1]=Math[d(169)](s(h[l+1]/255,o[1],f[u+1]/255,o[0],o[4])/o[2]*255),n[r+2]=Math[d(169)](s(h[l+2]/255,o[1],f[u+2]/255,o[0],o[5])/o[2]*255),n[r+3]=Math.round(255*o[2])}else(0,a.Yr)(n,r,f,u)}function s(t,n,r,e,a){return(n-n*e)*t+(e-n*e)*r+n*e*a}},3:(t,n,r)=>{"use strict";function e(t){const n=a7_0x4f0c;if(t)return{left:t[n(159)],top:t.top,right:t[n(148)],bottom:t[n(143)]}}function a(t,n){return{left:t,top:n,right:t+1,bottom:n+1}}function o(t,n){return{left:0,top:0,right:t,bottom:n}}function i(t,n,r,e){const a=a7_0x4f0c,o=function(t){const n=a7_0x4f0c;if(t[n(159)]>t[n(148)]){const r=t.right;t.right=t[n(159)],t[n(159)]=r}if(t.top>t[n(143)]){const r=t[n(143)];t[n(143)]=t[n(151)],t.top=r}if(t[n(148)]<t[n(159)]){const r=t.left;t[n(159)]=t.right,t[n(148)]=r}if(t[n(143)]<t[n(151)]){const r=t[n(151)];t[n(151)]=t[n(143)],t[n(143)]=r}return t}({left:t,top:n,right:r,bottom:e});return o[a(148)]++,o[a(143)]++,o}function c(t){const n=a7_0x4f0c;return t.left=Math.floor(t[n(159)]),t[n(148)]=Math.ceil(t.right),t[n(151)]=Math[n(157)](t[n(151)]),t[n(143)]=Math[n(154)](t[n(143)]),t}function f(t,n,r){const e=a7_0x4f0c;if(function(t){const n=a7_0x4f0c;return t[n(159)]===t.right||t[n(151)]===t[n(143)]}(t))return t[e(159)]=n,t.right=n+1,t[e(151)]=r,void(t[e(143)]=r+1);t.left=Math[e(166)](t[e(159)],n),t[e(151)]=Math[e(166)](t[e(151)],r),t[e(148)]=Math.max(t[e(148)],n+1),t[e(143)]=Math[e(150)](t[e(143)],r+1)}function s(t,n,r){const e=a7_0x4f0c;return n>=t[e(159)]&&n<t[e(148)]&&r>=t[e(151)]&&r<t[e(143)]}function u(t,n){const r=a7_0x4f0c;return n[r(159)]>=t[r(159)]&&n[r(148)]<=t.right&&n[r(151)]>=t[r(151)]&&n.bottom<=t[r(143)]}function h(t){const n=a7_0x4f0c;return"("+t[n(159)]+","+t[n(151)]+n(167)+t.right+","+t[n(143)]+")"}function l(t){const n=a7_0x4f0c;return t.right-t[n(159)]}function d(t){const n=a7_0x4f0c;return t[n(143)]-t[n(151)]}r.d(n,{BN:()=>e,Re:()=>a,DI:()=>o,tH:()=>i,kq:()=>c,Hv:()=>f,RB:()=>s,ur:()=>u,PW:()=>h,Oq:()=>l,rY:()=>d})}}]);