const a11_0x404b=["string","range","Style","staticState","_onRequestRender","Outline","_updateBlendMode","name","linearBurn","overlay","187322wWfmgy","triggerRequestRender","_blendModeOption","right","buttons","_taskWorkerService","28055qNwrJp","1xGJMIj","paletteService","multiply","pointerDown","bottom","83558fOrNPb","rectangle","primary","currentLayer","keyDown","length","_isPrimaryPointerActive","lighten","blendMode","_createRange","_getStyleValue","_onCommit","imageService","Rectangle","runTask","secondaryColor","_rectLayer","softLight","push","left","top","replace","difference","Fill","event","onRequestRender","height","269991FaEvqo","darken","primaryColor","shiftKey","style","options","_parentLayer","linearDodgeAdd","runAction","17TUhAWk","onUpdate","Blend Mode","_value","registerTemporaryLayer","exclusion","currentState","stepState","ranges","initialState","onLayerChange","_updateColors","sign","commit","viewportService","register","max","_outlineSizeOption","taskWorkerService","type","secondary","getRanges","taskService","onBeforeRunLayerTask","value","_finish","Fill and outline","_onUpdate","screen","normal","getColorSetFromPointerEvent","strokeSize","188712hbpCdA","_fillRange","_rectangleOrigin","_updateOutlineSize","webpackChunkluna","8871CNIfsm","_updateRectangle","203549qbHSLR","_rectangleOtherPoint","_styleOption","getCoordsFromEvent","color","1VIQxFJ","historyService","_sc","fire","dispose"],a11_0x460c=function(t,e){return a11_0x404b[t-=337]},a11_0x3b52ce=a11_0x460c;(function(t,e){const s=a11_0x460c;for(;;)try{if(138478===parseInt(s(351))+-parseInt(s(419))+parseInt(s(339))+-parseInt(s(424))*-parseInt(s(387))+-parseInt(s(378))+-parseInt(s(431))*-parseInt(s(426))+parseInt(s(346))*-parseInt(s(345)))break;t.push(t.shift())}catch(e){t.push(t.shift())}})(a11_0x404b),(self[a11_0x3b52ce(423)]=self.webpackChunkluna||[])[a11_0x3b52ce(369)]([[915],{9904:(t,e,s)=>{"use strict";const i=a11_0x3b52ce;s.d(e,{rP:()=>o,bG:()=>h,Jp:()=>a});var r=s(1815),n=s(5120);class o extends n.JT{constructor(t,e,s){const i=a11_0x460c;super(),this[i(443)]=t,this[i(383)]=e,this[i(390)]=s,this.type=i(436),this[i(414)]=this.register(new r.v),this[i(388)]=this[i(414)][i(375)]}get value(){return this[a11_0x460c(390)]}set[i(411)](t){const e=i;this[e(390)]=t,this[e(414)][e(434)]()}}class h extends o{constructor(){const t=i;super(t(389),[t(416),"darken",t(348),t(337),t(358),t(415),t(385),t(338),t(368),"difference",t(392)],t(416))}}class a extends o{constructor(){const t=i;super(t(389),["normal","replace",t(379),t(348),"linearBurn",t(358),t(415),"linearDodgeAdd",t(338),t(368),t(373),t(392)],t(416))}}},6915:(t,e,s)=>{"use strict";const i=a11_0x3b52ce;s.r(e),s.d(e,{default:()=>g});var r=s(1815),n=s(5120),o=s(1003),h=s(7517),a=s(6495),c=s(3491),l=s(5292);class p extends c.w{constructor(t,e,s,i,r,n,o,h,a,c,p,u){const d=a11_0x460c;super(c),this[d(384)]=t,this._historyService=h,this[d(344)]=a,this[d(406)]=d(352),this[d(396)]=p||{offsetX:o[d(370)],offsetY:o[d(371)]},this[d(394)]=u||[],this[d(393)]=(0,l.DU)(u?.length?u[u[d(356)]-1]:this[d(396)]),this[d(439)]={primaryColor:r,secondaryColor:n,range:o,strokeSize:s,style:i,blendMode:e}}async[i(400)](){const t=i,e=this[t(439)][t(359)],s=this[t(439)][t(437)];this._historyService[t(386)](new a.Z(t(364),s,this[t(384)],(async(i,r,n)=>{const o=t,h=this[o(408)]();if((s[o(350)]-s.top)*(s[o(342)]-s[o(370)])>25e4){const t=[];for(const s of h)for(const h of s[o(395)])t[o(369)](this[o(344)][o(365)]("blendColorAtRange",{targetImage:{data:i,width:r,height:n},range:h,color:new Uint8Array(s[o(430)]),blendMode:e}));await Promise.all(t)}else for(const t of h)for(const s of t[o(395)])this._fillRange(i,r,s,t[o(430)],e)}))),this[t(362)][t(434)]()}[i(420)](t,e,s,r,n){const o=i;let a=0;for(let i=s.top;i<s[o(350)];i++)for(let c=s[o(370)];c<s[o(342)];c++)a=4*(i*e+c),n===o(372)?(t[a]=r[0],t[a+1]=r[1],t[a+2]=r[2],t[a+3]=r[3]):(0,h.B)(n,t,a,r,0)}[i(408)](){const t=i,e=[],s=this.staticState[t(437)],r=this.staticState.strokeSize,n=this[t(439)].style,h=2===n?this.staticState.primaryColor:this[t(439)][t(366)],a=2===n?this[t(439)].secondaryColor:this.staticState[t(380)],c=(0,o.DI)(this[t(384)].width,this[t(384)][t(377)]),l=(0,o.l$)({left:s[t(370)],right:s.right,top:s[t(371)],bottom:Math.min(s[t(371)]+r,s.bottom)},c),p=(0,o.l$)({left:s.left,right:s.right,top:Math[t(403)](l.bottom,s[t(350)]-r),bottom:s[t(350)]},c),u=(0,o.l$)({left:s.left,right:s[t(370)]+r,top:l[t(350)],bottom:p[t(371)]},c),d=(0,o.l$)({left:Math[t(403)](u[t(342)],s[t(342)]-r),right:s[t(342)],top:l[t(350)],bottom:p[t(371)]},c);return 2!==n&&e[t(369)]({ranges:[l,p,u,d],color:a}),3===n?e.push({ranges:[{left:u[t(342)],right:d[t(370)],top:l[t(350)],bottom:p[t(371)]}],color:h}):2===n&&e.push({ranges:[{left:u[t(370)],right:d[t(342)],top:l[t(371)],bottom:p[t(350)]}],color:h}),e}serialize(){return null}}var u=s(9904);class d extends n.JT{constructor(t){const e=i;super(),this[e(433)]=t,this.id=e(352),this[e(357)]=!0,this[e(341)]=new u.bG,this[e(428)]=new u.rP(e(438),["Outline",e(374),"Fill and outline"],e(441)),this._outlineSizeOption=new u.rP("Outline Size",["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15"],"1"),this[e(383)]=[this._blendModeOption,this._styleOption,this[e(404)]],this._onRequestRender=this[e(402)](new r.v),this[e(376)]=this[e(440)][e(375)],this[e(402)](this[e(433)][e(347)][e(388)]((()=>this[e(398)]()))),this[e(402)](this._styleOption[e(388)]((()=>this._updateStyle()))),this[e(402)](this[e(404)][e(388)]((()=>this[e(422)]()))),this[e(402)](this[e(341)].onUpdate((()=>this[e(442)]()))),this[e(402)](this[e(433)].imageService[e(397)]((()=>this[e(412)]()))),this[e(402)](this[e(433)][e(409)][e(410)]((()=>this[e(412)]()))),this[e(402)]({dispose:()=>this[e(412)]()})}[i(355)](t){this._updateRectangle(t)}keyUp(t){this[i(425)](t)}async[i(349)](t){const e=i,s=this[e(433)][e(363)][e(354)];if(!s)return;this[e(357)]=!!(1&t[e(343)]);const r=this[e(433)][e(347)][e(417)](t),n=this[e(433)][e(401)][e(429)](t);if(!n)return;await this[e(412)](),this[e(421)]=n,this[e(427)]=n;const o=this._createRange(this[e(421)],this[e(427)]);this[e(367)]=new p(s,this[e(341)][e(411)],parseInt(this[e(404)][e(411)]),this._getStyleValue(),r[0],r[1],o,this[e(433)][e(432)],this[e(433)][e(405)]),await s[e(391)](this[e(367)]),this[e(367)][e(340)]()}pointerDownMove(t){const e=i;if(!this[e(421)]||!this[e(427)])return;if(!this[e(433)][e(363)][e(354)])return;const s=this._sc[e(401)][e(429)](t);s[0]===this._rectangleOtherPoint[0]&&s[1]===this[e(427)][1]||this[e(367)]&&(this[e(427)]=s,this[e(425)](t))}_updateRectangle(t){const e=i;if(!this._rectLayer||!this[e(421)]||!this[e(427)])return;let s=this[e(421)][0]-this[e(427)][0],r=this[e(421)][1]-this[e(427)][1];t[e(381)]&&(Math.abs(s)>Math.abs(r)?s=r*(Math[e(399)](s)!==Math[e(399)](r)?-1:1):r=s*(Math[e(399)](s)!==Math.sign(r)?-1:1)),this._rectLayer[e(439)][e(437)]=this[e(360)](this[e(421)],[this[e(421)][0]-s,this[e(421)][1]-r]),this[e(367)][e(340)]()}[i(398)](){const t=i;this[t(367)]&&(this[t(357)]?(this[t(367)].staticState[t(380)]=this[t(433)][t(347)][t(353)],this._rectLayer[t(439)].secondaryColor=this[t(433)][t(347)].secondary):(this[t(367)][t(439)].primaryColor=this._sc[t(347)][t(407)],this[t(367)][t(439)][t(366)]=this[t(433)][t(347)][t(353)]),this[t(367)][t(340)]())}_updateStyle(){const t=i;this[t(367)]&&(this[t(367)][t(439)][t(382)]=this._getStyleValue(),this[t(367)].triggerRequestRender())}[i(361)](){const t=i;switch(this._styleOption[t(411)]){case"Outline":return 1;case t(374):return 2;case t(413):return 3}}[i(422)](){const t=i;this[t(367)]&&(this[t(367)][t(439)][t(418)]=parseInt(this[t(404)][t(411)]),this[t(367)][t(340)]())}_updateBlendMode(){const t=i;this[t(367)]&&(this[t(367)].staticState[t(359)]=this._blendModeOption[t(411)],this[t(367)][t(340)]())}async[i(412)](){const t=i;this[t(367)]&&(await this._rectLayer[t(400)](),this[t(367)][t(435)](),this[t(367)]=void 0)}[i(360)](t,e){return(0,o.tH)(t[0],t[1],e[0],e[1])}}const g=d}}]);