const a12_0x4106=["_onUpdate","state","Fill and outline","rectangle","_topLeftInfo","metaKey","_rectLayerOwner","Set Rectangle Style","set","pointerMove","ArrowLeft","_styleOption","_onStateChange","onHistoryUpdateValue","pointerDownMove","lighten","Fill","clientHeight","Rectangle size is ","primaryColor","rectangleStep","offsetX","linearDodgeAdd","zoom","left","28363UZFmSw","pointerDown","_cursorOrigin","getPointerState"," pixels tall","round","_outlineSizeOption","max","_renderer","imageService","move-handle","Resize Rectangle","exclusion","topright","taskService","render","temporaryLayer","_onOptionsChange","Set Rectangle Color","_updateOutlineSize","_rectangleOtherPoint","options","top","linearBurn","_getStyleValue","taskWorkerService","bottom","_directionalMoveElements","_viewportService","keyDown","style","_onHistoryUpdateValue","setVisible","currentLayer","add","onUpdate","getDetailedInfo","_range","458972dXaKHS","viewportService","key","Set Rectangle Blend Mode","screen","clientWidth","primary","softLight","secondaryColor","setValueFromHistoryChange","rectLayer","registerTemporaryLayer","devicePixelRatio","getCoordsFromEvent"," y=","42316mQHlZx","min","_getStyleString","height","removeChild","push","_imageService","none","display","move","paletteService","Blend Mode","_container","Selection top left position is x=","secondary","_refreshInfo","setColors","_elementContainer","Move Rectangle","_createRange","_cursorCurrent","range","replace","name","2243GXvXNu","Outline","pointerUp","buttons","new","topleft","triggerRequestRender","div","10hmFbte","get","event","779890bbQlGQ","_rectangleOrigin","string","includes","size","createElement","abs","createDomRenderProgram","overlay","_onRequestRender","appendChild","_setupActiveTemporaryLayer","296047vFPekP","ArrowDown","116VwVzWi","keyUp","_directionalMoveZones","onCommit","1QnbXwn","_isVisible","right","_cursorOriginalRectangle","_sizeInfo","_blendModeOption","blendMode","offsetY","currentState","_updateBlendMode","_updateStyle","bottomleft","_finish","_sc","ArrowRight","ArrowUp","onBeforeRunLayerTask","bottomright","Style","multiply","selectionService","183591nAnjdy","_updateColors","number","Draw Rectangle","_value","_isCursorDown","type","outlineSize","getInfo","onHistoryAction","visible","fire","_clearRectLayer","order","_updateRectangle","value","width","Set Rectangle Outline Size","sign","darken","register","onStateChange","4dTdtdW","webpackChunkluna","normal"],a12_0x1cdb=function(t,e){return a12_0x4106[t-=293]},a12_0x2eddd5=a12_0x1cdb;(function(t,e){const s=a12_0x1cdb;for(;;)try{if(287552===-parseInt(s(465))+-parseInt(s(352))*parseInt(s(327))+-parseInt(s(303))*parseInt(s(399))+parseInt(s(427))*parseInt(s(335))-parseInt(s(377))+parseInt(s(350))*parseInt(s(356))+parseInt(s(338)))break;t.push(t.shift())}catch(e){t.push(t.shift())}})(a12_0x4106),(self[a12_0x2eddd5(400)]=self[a12_0x2eddd5(400)]||[])[a12_0x2eddd5(308)]([[891],{9904:(t,e,s)=>{"use strict";const i=a12_0x2eddd5;s.d(e,{rP:()=>h,bG:()=>o,Jp:()=>a,qv:()=>c});var r=s(1815),n=s(5120);class h extends n.JT{constructor(t,e,s){const i=a12_0x1cdb;super(),this[i(326)]=t,this[i(448)]=e,this._value=s,this[i(383)]=i(340),this._onHistoryUpdateValue=this[i(397)](new r.v),this.onHistoryUpdateValue=this[i(458)][i(337)],this[i(402)]=this[i(397)](new r.v),this[i(462)]=this[i(402)][i(337)]}get[i(392)](){return this[i(381)]}set[i(392)](t){const e=i;this[e(381)]=t,this[e(402)].fire()}[i(297)](t){const e=i;this[e(381)]=t,this._onHistoryUpdateValue[e(388)](t)}}class o extends h{constructor(){const t=i;super("Blend Mode",[t(401),t(396),"multiply",t(450),t(417),t(469),t(424),t(346),t(295),"difference",t(439)],t(401))}}class a extends h{constructor(){const t=i;super(t(314),["normal",t(325),t(396),t(375),"linearBurn",t(417),"screen","linearDodgeAdd","overlay",t(295),"difference",t(439)],t(401))}}class c extends n.JT{constructor(t,e,s,n){const h=i;super(),this[h(326)]=t,this[h(381)]=e,this[h(304)]=s,this[h(434)]=n,this.type=h(379),this[h(458)]=this[h(397)](new r.v),this[h(415)]=this[h(458)][h(337)],this[h(402)]=this[h(397)](new r.v),this[h(462)]=this[h(402)][h(337)]}get[i(392)](){return this[i(381)]}set[i(392)](t){const e=i;this[e(381)]=t,this[e(402)][e(388)]()}[i(297)](t){const e=i;this[e(381)]=t,this[e(458)][e(388)](t)}}},7891:(t,e,s)=>{"use strict";const i=a12_0x2eddd5;s.r(e),s.d(e,{default:()=>p});var r=s(6374),n=s(1815),h=s(7896),o=s(5120),a=s(1003),c=s(807);class l extends o.JT{constructor(){const t=a12_0x1cdb;super(...arguments),this._onUpdate=this[t(397)](new n.v),this[t(462)]=this[t(402)][t(337)]}}var d=s(9904);class u extends o.JT{constructor(t){const e=a12_0x1cdb;super(),this[e(369)]=t,this.id=e(405),this[e(403)]=e(331),this[e(382)]=!1,this[e(361)]=new d.bG,this[e(413)]=new d.rP(e(374),[e(328),e(418),e(404)],e(328)),this[e(433)]=new d.qv("Outline Size",1,1,1e3),this.options=[this._blendModeOption,this[e(413)],this[e(433)]],this._sizeInfo=new g,this[e(406)]=new _,this.info=[this[e(406)],this[e(360)]],this[e(347)]=this[e(397)](new n.v),this.onRequestRender=this[e(347)][e(337)],this[e(414)]=this[e(397)](new n.v),this[e(398)]=this[e(414)][e(337)],this.register(this[e(369)][e(313)].onUpdate((()=>this[e(378)]()))),this[e(397)](this[e(413)][e(462)]((()=>this[e(366)]()))),this[e(397)](this[e(433)][e(462)]((()=>this[e(446)]()))),this[e(397)](this._blendModeOption[e(462)]((()=>this[e(365)]()))),this[e(397)](this[e(369)][e(436)].onLayerChange((()=>this[e(368)]()))),this[e(397)](this._sc[e(441)][e(372)]((()=>this[e(368)]()))),this[e(397)]({dispose:()=>this[e(368)]()}),this[e(397)](this[e(369)].imageService.onTemporaryLayerRegistered((t=>this[e(349)](t)))),this[e(369)][e(436)].currentLayer?.[e(443)]&&this._setupActiveTemporaryLayer(this._sc.imageService[e(460)][e(443)])}[i(349)](t){const e=i;t[e(383)]===e(405)&&(this[e(298)]=t,this[e(397)](this[e(298)][e(355)]((()=>this[e(389)]()))),this.register(this.rectLayer[e(386)]((()=>this[e(444)]()))),this[e(397)](this[e(298)].onHistoryUnset((()=>this[e(389)]()))),this[e(339)]=[this.rectLayer.currentState[e(324)][e(426)],this[e(298)].currentState[e(324)][e(449)]],this[e(447)]=[this[e(298)][e(364)].range[e(358)],this[e(298)][e(364)][e(324)][e(453)]],this[e(435)]?.[e(459)](!0),this[e(347)][e(388)]())}[i(456)](t){const e=i;if(this[e(391)](t),this[e(298)]&&!this[e(382)]&&[e(371),"ArrowLeft",e(351),"ArrowRight"][e(341)](t.key)){const s=(0,a.BN)(this[e(298)].currentState[e(324)]),i=(h.V?t[e(407)]:t.ctrlKey)?10:1;switch(t[e(467)]){case"ArrowUp":(0,a.Hd)(s,s[e(426)],s[e(449)]-i);break;case"ArrowDown":(0,a.Hd)(s,s[e(426)],s.top+i);break;case e(412):(0,a.Hd)(s,s[e(426)]-i,s.top);break;case e(370):(0,a.Hd)(s,s[e(426)]+i,s.top)}this[e(298)][e(364)][e(324)]=s,this[e(298)][e(422)]("Shift Rectangle")}}[i(353)](t){this[i(391)](t)}async[i(428)](t){const e=i;this[e(382)]=!0;const s=this[e(369)][e(436)][e(460)];if(!s)return;const r=!(1&t[e(330)]),n=this._sc.viewportService[e(301)](t);if(this[e(429)]=n,this._cursorCurrent=n,!n)return;if(this[e(403)]!==e(331))return void(this._cursorOriginalRectangle=(0,a.BN)(this[e(298)]?.[e(364)].range));await this[e(368)](),this[e(339)]=n,this._rectangleOtherPoint=n;const h=this[e(322)](this[e(339)],this._rectangleOtherPoint);this[e(359)]=(0,a.BN)(h),this[e(298)]=new c.F(s,{invertColors:r},{primaryColor:this._sc[e(313)][e(294)],secondaryColor:this[e(369)].paletteService.secondary,blendMode:this[e(361)][e(392)],range:h,outlineSize:this._outlineSizeOption[e(392)],style:this[e(451)]()},this[e(369)].historyService,this[e(369)][e(452)]),this[e(318)](),await s[e(299)](this[e(298)]),this[e(435)]?.[e(459)](!1),this[e(298)].triggerRequestRender()}[i(329)](t){const e=i;if(this[e(298)]){let t;switch(this[e(403)]){case e(331):t=e(380);break;case e(312):t=e(321);break;case"topleft":case e(440):case e(367):case"bottomright":case e(449):case e(426):case e(358):case e(453):t=e(438)}this.rectLayer[e(422)](t)}this._isCursorDown=!1,this[e(435)]?.setVisible(!0)}[i(416)](t){const e=i;if(!(this[e(339)]&&this[e(447)]&&this[e(429)]&&this[e(359)]))return;if(!this[e(369)][e(436)][e(460)])return;const s=this[e(369)][e(466)][e(301)](t);if(this._cursorCurrent=s,s[0]===this._rectangleOtherPoint[0]&&s[1]===this[e(447)][1])return;if(!this[e(298)])return;const r=this._cursorCurrent[0]-this[e(429)][0],n=this[e(323)][1]-this[e(429)][1];switch(this[e(403)]){case e(331):return this._rectangleOtherPoint=s,void this[e(391)](t);case e(312):{const t=(0,a.BN)(this[e(359)]);t.left+=r,t.top+=n,t[e(358)]+=r,t[e(453)]+=n,(0,a.FJ)(t),this[e(298)][e(364)][e(324)]=t;break}default:{const t=(0,a.BN)(this[e(359)]);("top"===this.state||this[e(403)]===e(332)||this[e(403)]===e(440))&&(t[e(449)]+=n),(this[e(403)]===e(453)||"bottomleft"===this[e(403)]||"bottomright"===this[e(403)])&&(t.bottom+=n),(this[e(403)]===e(426)||this.state===e(332)||this[e(403)]===e(367))&&(t[e(426)]+=r),(this.state===e(358)||this[e(403)]===e(440)||this[e(403)]===e(373))&&(t[e(358)]+=r),(0,a.FJ)(t),this[e(298)][e(364)][e(324)]=t;break}}this._refreshInfo(),this[e(298)][e(333)]()}[i(411)](t){const e=i;if(this[e(435)]&&!this[e(382)]){const s=this[e(435)][e(430)](t);this[e(403)]!==s&&(this[e(403)]=s,this._onStateChange[e(388)]())}}[i(391)](t){const e=i;if(!(this.rectLayer&&this[e(339)]&&this[e(447)]&&this[e(382)]&&this[e(403)]===e(331)))return;let s=this[e(339)][0]-this[e(447)][0],r=this[e(339)][1]-this[e(447)][1];t.shiftKey&&(Math[e(344)](s)>Math[e(344)](r)?s=r*(Math[e(395)](s)!==Math[e(395)](r)?-1:1):r=s*(Math[e(395)](s)!==Math.sign(r)?-1:1)),this[e(298)][e(364)][e(324)]=this[e(322)](this[e(339)],[this._rectangleOrigin[0]-s,this._rectangleOrigin[1]-r]),this[e(318)](),this[e(298)][e(333)]()}[i(378)](){const t=i;if(!this[t(298)])return;const e=this._sc[t(313)][t(294)],s=this._sc[t(313)].secondary;(0,r.W)(this[t(298)][t(364)][t(421)],e)&&(0,r.W)(this[t(298)][t(364)][t(296)],s)||(this[t(298)][t(364)][t(421)]=e,this[t(298)].currentState[t(296)]=s,this[t(298)][t(422)](t(445),!0),this[t(298)][t(333)]())}[i(366)](){const t=i,e=this[t(451)]();this[t(298)]&&this[t(298)][t(364)].style!==e&&(this[t(298)][t(364)][t(457)]=e,this.rectLayer[t(422)](t(409)),this[t(298)][t(333)]())}[i(451)](){const t=i;switch(this[t(413)][t(392)]){case"Outline":return 1;case t(418):return 2;case t(404):return 3}}[i(305)](t){const e=i;switch(t){case 1:return e(328);case 2:return e(418);case 3:return e(404)}}[i(446)](){const t=i,e=this[t(433)][t(392)];this[t(298)]&&this[t(298)][t(364)][t(384)]!==e&&(this[t(298)][t(364)][t(384)]=e,this[t(298)][t(422)](t(394),!0),this.rectLayer.triggerRequestRender())}[i(365)](){const t=i,e=this[t(361)][t(392)];this[t(298)]&&this.rectLayer[t(364)].blendMode!==e&&(this[t(298)][t(364)][t(362)]=e,this.rectLayer.rectangleStep(t(468)),this[t(298)][t(333)]())}[i(444)](){const t=i;this.rectLayer&&(this[t(361)][t(297)](this[t(298)][t(364)].blendMode),this[t(433)][t(297)](this.rectLayer[t(364)][t(384)]),this[t(413)][t(297)](this[t(305)](this[t(298)][t(364)][t(457)])),(!(0,r.W)(this[t(369)][t(313)].primary,this[t(298)].currentState.primaryColor)||!(0,r.W)(this._sc[t(313)][t(317)],this[t(298)][t(364)][t(296)]))&&this[t(369)].paletteService[t(319)](this[t(298)].currentState.primaryColor,this[t(298)][t(364)][t(296)]))}async _finish(){const t=i;await(this[t(298)]?.commit(this[t(369)][t(376)][t(324)])),this[t(389)]()}[i(389)](){const t=i;this.rectLayer=void 0,this[t(359)]=void 0,this[t(435)]?.[t(459)](!1),this[t(347)].fire()}[i(322)](t,e){return(0,a.tH)(t[0],t[1],e[0],e[1])}[i(318)](){const t=i;this._sizeInfo[t(324)]=this[t(298)]?.[t(364)].range,this._topLeftInfo[t(324)]=this[t(298)]?.[t(364)][t(324)]}[i(345)](t){const e=i;return this[e(435)]=new f(t,this,this[e(369)][e(466)],this._sc[e(436)]),this[e(435)][e(459)](this.state!==e(331)),this[e(435)]}}const p=u;class g extends l{constructor(){const t=i;super(...arguments),this[t(383)]=t(342)}get[i(324)](){return this[i(464)]}set[i(324)](t){const e=i;this[e(464)]=t,this[e(402)][e(388)]()}get visible(){return!!this[i(464)]}[i(385)](){const t=i;return this._range?this[t(464)][t(358)]-this[t(464)][t(426)]+" x "+(this[t(464)][t(453)]-this[t(464)].top):""}[i(463)](){const t=i;if(!this[t(464)])return"";const e=this._range.right-this[t(464)][t(426)],s=this._range[t(453)]-this[t(464)][t(449)];return t(420)+e+" pixels wide by "+s+t(431)}}class _ extends l{constructor(){const t=i;super(...arguments),this[t(383)]=t(332)}get[i(324)](){return this[i(464)]}set[i(324)](t){const e=i;this[e(464)]=t,this[e(402)].fire()}get[i(387)](){return!!this[i(464)]}[i(385)](){const t=i;return this._range?this[t(464)].left+", "+this[t(464)][t(449)]:""}[i(463)](){const t=i;return this._range?t(316)+this[t(464)][t(426)]+t(302)+this[t(464)][t(449)]:""}}class f extends o.JT{constructor(t,e,s,r){const n=i;super(),this[n(315)]=t,this[n(408)]=e,this[n(455)]=s,this[n(309)]=r,this[n(390)]=2,this[n(454)]=new Map,this._directionalMoveZones=new Map,this[n(357)]=!0,this._elementContainer=document[n(343)]("div");const h=[n(332),"topright",n(367),n(373),n(449),n(453),n(426),n(358)];for(const t of h){const e=document[n(343)](n(334));e.classList[n(461)](n(437)),this[n(320)][n(348)](e),this[n(454)][n(410)](t,e),this[n(354)][n(410)](t,(0,a.Pq)())}this._container.appendChild(this._elementContainer),this[n(397)]({dispose:()=>{const t=n;this[t(315)][t(307)](this[t(320)])}})}[i(459)](t){const e=i;t!==this[e(357)]&&(this[e(320)][e(457)][e(311)]=t?"":e(310),this[e(357)]=t)}[i(442)](){const t=i;if(!this._rectLayerOwner[t(298)])return;const e=this[t(408)][t(298)][t(364)][t(324)],s=this[t(309)].currentLayer;if(!s)return;const r=this[t(455)],n=Math.round(this[t(315)][t(293)]/2)-s[t(393)]/2*r[t(425)],h=Math[t(432)](this._container[t(419)]/2)-s[t(306)]/2*r[t(425)],o=n+(r.x+e[t(426)])*r[t(425)],a=h+(r.y+e[t(449)])*r[t(425)],c=n+(r.x+e.right)*r[t(425)],l=h+(r.y+e.bottom)*r.zoom,d=Math[t(432)]((o+c)/2),u=Math[t(432)]((a+l)/2),p=10*window[t(300)],g={left:Math[t(304)](o+p,Math[t(434)](o,d-p)),top:Math[t(304)](a+p,Math[t(434)](a,u-p)),right:Math[t(434)](c-p,Math[t(304)](c,d+p)),bottom:Math[t(434)](l-p,Math[t(304)](l,u+p))},_={left:o-p,top:a-p,right:c+p,bottom:l+p},f=this[t(354)].get("topleft");f.left=_[t(426)],f[t(358)]=g[t(426)],f[t(449)]=_[t(449)],f[t(453)]=g[t(449)];const y=this._directionalMoveElements.get("topleft");y[t(457)].left=o+"px",y[t(457)][t(449)]=a+"px";const m=this[t(354)].get("topright");m[t(426)]=g[t(358)],m[t(358)]=_[t(358)],m[t(449)]=_[t(449)],m[t(453)]=g[t(449)];const v=this._directionalMoveElements[t(336)](t(440));v[t(457)].left=c+"px",v[t(457)][t(449)]=a+"px";const w=this[t(354)][t(336)](t(367));w[t(426)]=_[t(426)],w[t(358)]=g.left,w[t(449)]=g[t(453)],w.bottom=_[t(453)];const b=this._directionalMoveElements[t(336)](t(367));b.style[t(426)]=o+"px",b[t(457)].top=l+"px";const x=this[t(354)][t(336)](t(373));x.left=g[t(358)],x[t(358)]=_.right,x[t(449)]=g[t(453)],x[t(453)]=_[t(453)];const S=this[t(454)][t(336)](t(373));S[t(457)][t(426)]=c+"px",S[t(457)][t(449)]=l+"px";const M=this._directionalMoveZones.get(t(449));M.left=g[t(426)],M[t(358)]=g[t(358)],M[t(449)]=_[t(449)],M[t(453)]=g[t(449)];const C=this[t(454)][t(336)](t(449));C[t(457)][t(426)]=d+"px",C[t(457)][t(449)]=a+"px";const L=this[t(354)][t(336)]("bottom");L.left=g[t(426)],L[t(358)]=g[t(358)],L[t(449)]=g[t(453)],L.bottom=_[t(453)];const R=this._directionalMoveElements[t(336)]("bottom");R[t(457)][t(426)]=d+"px",R[t(457)][t(449)]=l+"px";const O=this._directionalMoveZones[t(336)]("left");O[t(426)]=_[t(426)],O[t(358)]=g[t(426)],O.top=g[t(449)],O[t(453)]=g[t(453)];const k=this[t(454)][t(336)]("left");k[t(457)][t(426)]=o+"px",k[t(457)][t(449)]=u+"px";const I=this[t(354)][t(336)](t(358));I[t(426)]=g.right,I[t(358)]=_.right,I[t(449)]=g[t(449)],I[t(453)]=g[t(453)];const z=this._directionalMoveElements.get(t(358));z[t(457)].left=c+"px",z[t(457)].top=u+"px"}[i(430)](t){const e=i;if(!this[e(408)][e(298)])return e(331);for(const[s,i]of this[e(354)])if(y(i,t[e(423)],t.offsetY))return s;const s=this[e(354)][e(336)](e(332)),r=this._directionalMoveZones[e(336)](e(373));return y({left:s.left,top:s[e(449)],right:r[e(358)],bottom:r[e(453)]},t[e(423)],t[e(363)])?e(312):"new"}}function y(t,e,s){const r=i;return e>=t[r(426)]&&e<t.right&&s>=t[r(449)]&&s<t[r(453)]}}}]);