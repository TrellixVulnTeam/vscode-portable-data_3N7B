const a10_0x16f8=["1249084zIUkRQ","height","metaKey","_onStateChange","_directionalMoveElements","fire","981957ipLIau","display","_isCursorDown","_viewportService","_container","1199165ndjiMI","add","_setVisible","range","min","_sc","get","offsetX","ctrlKey","max","1564678NuuHpQ","viewportService","getCoordsFromEvent","getPointerState","topright","event","currentLayer","slice","type","_selectionService","bottom","clientHeight","_refreshActionEnabledState","move-handle","appendChild","_cropToSelectionAction","register","Move Selection","bottomright","commit","offsetY","createElement","name","_directionalMoveZones","set","_enabled","enabled","zoom","_cursorOrigin","state","selectAll","none","_elementContainer","isSelectionTool","imageService","ArrowLeft","_onUpdate","1KntKSf","1SpIjHB","setTopLeft","285185ngCkhL","round","topleft","_cursorCurrent","moveSelection","div","right","_imageService","_isVisible","style","render","top","768010aKeElt","bottomleft","192553uahuIx","onUpdate","push","_renderer","move","_originalSelection","onStateChange","webpackChunkluna","keyDown","selectionService","pointerDownMove","1PLxMWy","order","Crop to Selection","clientWidth","left","pointerUp"],a10_0x34ca=function(t,e){return a10_0x16f8[t-=229]},a10_0x9ca468=a10_0x34ca;(function(t,e){const s=a10_0x34ca;for(;;)try{if(823074===-parseInt(s(237))*-parseInt(s(264))+parseInt(s(316))+parseInt(s(304))*-parseInt(s(301))+-parseInt(s(318))+parseInt(s(254))+-parseInt(s(243))+-parseInt(s(302))*parseInt(s(249)))break;t.push(t.shift())}catch(e){t.push(t.shift())}})(a10_0x16f8),(self[a10_0x9ca468(233)]=self.webpackChunkluna||[])[a10_0x9ca468(320)]([[403],{6173:(t,e,s)=>{"use strict";const i=a10_0x9ca468;s.d(e,{f:()=>h});var o=s(1815),n=s(5120);class h extends n.JT{constructor(t,e,s){const i=a10_0x34ca;super(),this[i(286)]=t,this[i(272)]=e,this[i(289)]=s,this[i(300)]=this[i(280)](new o.v),this.onUpdate=this._onUpdate[i(269)]}get enabled(){return this._enabled}set[i(290)](t){const e=i;this[e(289)]!==t&&(this[e(289)]=t,this[e(300)][e(248)]())}}},403:(t,e,s)=>{"use strict";const i=a10_0x9ca468;s.r(e),s.d(e,{default:()=>l});var o=s(1815),n=s(7896),h=s(5120),c=s(1003),r=s(6173);class a extends h.JT{constructor(t){const e=a10_0x34ca;super(),this._sc=t,this.id="moveSelection",this[e(297)]=!0,this[e(293)]=e(230),this[e(251)]=!1,this._cropToSelectionAction=new r.f(e(239),"crop-to-selection",!1),this.actions=[this._cropToSelectionAction],this._onStateChange=this[e(280)](new o.v),this[e(232)]=this[e(246)][e(269)],this[e(259)][e(235)][e(319)]((()=>this[e(276)]())),this[e(276)]()}pointerDown(t){const e=a10_0x34ca;this[e(251)]=!0,!this[e(259)].selectionService[e(257)]&&this[e(259)][e(235)][e(294)](),this[e(292)]=this[e(259)][e(265)][e(266)](t),this[e(307)]=this[e(292)][e(271)](),this[e(231)]=this[e(259)][e(235)][e(257)]}[i(242)](t){const e=i;this[e(251)]=!1,this[e(259)][e(235)][e(257)]&&this[e(259)].selectionService[e(283)](e(281),e(308))}pointerMove(t){const e=i;if(this[e(229)]&&!this[e(251)]){const s=this[e(229)][e(267)](t);this[e(293)]!==s&&(this[e(293)]=s,this._onStateChange[e(248)]())}}[i(236)](t){const e=i;if(!this._sc[e(235)][e(257)]||!this._cursorOrigin||!this[e(231)])return;this[e(307)]=this[e(259)][e(265)][e(266)](t);const s=this[e(307)][0]-this[e(292)][0],o=this[e(307)][1]-this[e(292)][1];if("move"===this[e(293)])return void this._sc[e(235)][e(303)](this[e(231)][e(241)]+s,this[e(231)].top+o);const n=(0,c.BN)(this[e(231)]);switch(this.state){case e(306):n[e(241)]+=s,n[e(315)]+=o;break;case"topright":n[e(310)]+=s,n[e(315)]+=o;break;case e(317):n[e(241)]+=s,n[e(274)]+=o;break;case"bottomright":n[e(310)]+=s,n[e(274)]+=o;break;case e(315):n[e(315)]+=o;break;case e(274):n[e(274)]+=o;break;case e(241):n.left+=s;break;case e(310):n.right+=s}this[e(259)][e(235)][e(257)]=(0,c.FJ)(n)}[i(234)](t){const e=i;if(!this[e(259)].imageService)return;let s=this[e(259)][e(235)][e(257)];!s&&(this[e(259)][e(235)].selectAll(),s=this[e(259)][e(235)][e(257)]);const o=(n.V?t[e(245)]:t[e(262)])?10:1;switch(t.key){case"ArrowUp":this._sc[e(235)][e(303)](s[e(241)],s[e(315)]-o);break;case"ArrowDown":this[e(259)][e(235)][e(303)](s[e(241)],s.top+o);break;case e(299):this[e(259)][e(235)].setTopLeft(s.left-o,s[e(315)]);break;case"ArrowRight":this._sc.selectionService[e(303)](s[e(241)]+o,s[e(315)])}}[i(276)](){const t=i,e=this[t(259)][t(235)][t(257)];this[t(279)][t(290)]=!(!e||0===e[t(241)]&&0===e[t(315)]&&e[t(310)]===this[t(259)][t(298)].width&&e[t(274)]===this[t(259)].imageService[t(244)])}createDomRenderProgram(t){const e=i;return this[e(229)]=new p(t,this._sc[e(235)],this[e(259)][e(265)],this[e(259)].imageService),this._renderer}}const l=a;class p extends h.JT{constructor(t,e,s,o){const n=i;super(),this._container=t,this[n(273)]=e,this[n(252)]=s,this[n(311)]=o,this[n(238)]=2,this[n(247)]=new Map,this[n(287)]=new Map,this[n(312)]=!0,this[n(296)]=document[n(285)]("div");const h=[n(306),n(268),n(317),"bottomright","top",n(274),"left","right"];for(const t of h){const e=document[n(285)](n(309));e.classList[n(255)](n(277)),this[n(296)][n(278)](e),this[n(247)][n(288)](t,e),this._directionalMoveZones.set(t,(0,c.Pq)())}this._container[n(278)](this[n(296)]),this[n(280)]({dispose:()=>{const t=n;this[t(253)].removeChild(this[t(296)])}}),this._selectionService[n(319)]((()=>this._setVisible(void 0!==this._selectionService[n(257)]))),this[n(256)](void 0!==this[n(273)][n(257)])}[i(256)](t){const e=i;t!==this._isVisible&&(this._elementContainer[e(313)][e(250)]=t?"":e(295),this[e(312)]=t)}[i(314)](){const t=i,e=this._selectionService[t(257)];if(!e)return;const s=this[t(311)][t(270)];if(!s)return;const o=this._viewportService,n=Math[t(305)](this[t(253)][t(240)]/2)-s.width/2*o.zoom,h=Math[t(305)](this._container[t(275)]/2)-s.height/2*o[t(291)],c=n+(o.x+e[t(241)])*o[t(291)],r=h+(o.y+e.top)*o[t(291)],a=n+(o.x+e[t(310)])*o[t(291)],l=h+(o.y+e.bottom)*o[t(291)],p=Math.round((c+a)/2),_=Math[t(305)]((r+l)/2),f=10*window.devicePixelRatio,d={left:Math[t(258)](c+f,Math[t(263)](c,p-f)),top:Math[t(258)](r+f,Math[t(263)](r,_-f)),right:Math[t(263)](a-f,Math[t(258)](a,p+f)),bottom:Math[t(263)](l-f,Math[t(258)](l,_+f))},v={left:c-f,top:r-f,right:a+f,bottom:l+f},u=this[t(287)][t(260)](t(306));u[t(241)]=v.left,u[t(310)]=d[t(241)],u[t(315)]=v[t(315)],u.bottom=d[t(315)];const g=this[t(247)][t(260)](t(306));g[t(313)].left=c+"px",g[t(313)].top=r+"px";const m=this._directionalMoveZones[t(260)](t(268));m[t(241)]=d[t(310)],m[t(310)]=v[t(310)],m.top=v.top,m[t(274)]=d.top;const x=this[t(247)][t(260)](t(268));x[t(313)][t(241)]=a+"px",x[t(313)].top=r+"px";const b=this[t(287)].get(t(317));b.left=v[t(241)],b[t(310)]=d[t(241)],b[t(315)]=d[t(274)],b.bottom=v[t(274)];const S=this[t(247)][t(260)](t(317));S.style.left=c+"px",S[t(313)][t(315)]=l+"px";const w=this[t(287)].get(t(282));w[t(241)]=d[t(310)],w[t(310)]=v.right,w[t(315)]=d[t(274)],w[t(274)]=v[t(274)];const M=this._directionalMoveElements[t(260)](t(282));M[t(313)].left=a+"px",M[t(313)][t(315)]=l+"px";const k=this._directionalMoveZones[t(260)](t(315));k[t(241)]=d[t(241)],k[t(310)]=d[t(310)],k.top=v[t(315)],k[t(274)]=d[t(315)];const y=this[t(247)][t(260)](t(315));y[t(313)][t(241)]=p+"px",y.style.top=r+"px";const C=this[t(287)].get(t(274));C[t(241)]=d[t(241)],C.right=d[t(310)],C.top=d[t(274)],C[t(274)]=v.bottom;const I=this[t(247)][t(260)](t(274));I.style[t(241)]=p+"px",I[t(313)][t(315)]=l+"px";const A=this[t(287)].get(t(241));A[t(241)]=v.left,A[t(310)]=d[t(241)],A.top=d[t(315)],A[t(274)]=d[t(274)];const T=this[t(247)][t(260)](t(241));T[t(313)][t(241)]=c+"px",T[t(313)][t(315)]=_+"px";const L=this[t(287)].get(t(310));L[t(241)]=d[t(310)],L[t(310)]=v[t(310)],L[t(315)]=d[t(315)],L[t(274)]=d.bottom;const U=this[t(247)].get(t(310));U[t(313)].left=a+"px",U[t(313)][t(315)]=_+"px"}[i(267)](t){const e=i;for(const[s,i]of this[e(287)])if(_(i,t[e(261)],t[e(284)]))return s;return e(230)}}function _(t,e,s){const o=i;return e>=t.left&&e<t[o(310)]&&s>=t.top&&s<t[o(274)]}}}]);