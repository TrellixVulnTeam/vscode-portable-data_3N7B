(()=>{var Wf={879:(s,E)=>{"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.ByteStream=void 0;class g{constructor(x){this.bytes=x,this.byteIndexCurrent=0}hasMoreBytes(){return this.byteIndexCurrent<this.bytes.length}readBytes(x){const T=this.byteIndexCurrent;return this.byteIndexCurrent+=x,this.bytes.slice(T,this.byteIndexCurrent)}readByte(){let x=this.bytes[this.byteIndexCurrent];return this.byteIndexCurrent++,x}readString(x){let T="";for(let v=0;v<x;v++){const u=this.readByte();u!=0&&(T+=String.fromCharCode(u))}return T}}E.ByteStream=g},7106:(s,E)=>{"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.ChunkSize=E.HeaderSizeInBytes=E.FileNameMaxLength=void 0,E.FileNameMaxLength=99,E.HeaderSizeInBytes=500,E.ChunkSize=512},5759:(s,E,g)=>{"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.TarFile=void 0;const C=g(879),x=g(7106),T=g(4108),v=g(3335);class u{constructor(h){this.entries=h}static fromBytes(h){const b=new C.ByteStream(h),m=[],l=x.ChunkSize;let f=0;for(;b.hasMoreBytes()==!0;){const _=b.readBytes(l);let R=!0;for(let D=0;D<_.length;D++)if(_[D]!=0){R=!1;break}if(R==!0){if(f++,f==2)break}else{f=0;const D=T.TarFileEntry.fromBytes(_,b);m.push(D)}}let y=new u(m);return y.consolidateLongPathEntries(),y}consolidateLongPathEntries(){var h;const b=v.TarFileTypeFlag.Instances().LongFilePath.name,m=this.entries;for(let l=0;l<m.length;l++){const f=m[l];if(((h=f.header.typeFlag)===null||h===void 0?void 0:h.name)==b){const y=m[l+1];y.header.fileName=f.dataAsBytes.reduce((_,R)=>_+=String.fromCharCode(R),""),y.header.fileName=y.header.fileName.replace(/\0/g,""),m.splice(l,1),l--}}}}E.TarFile=u},4108:(s,E,g)=>{"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.TarFileEntry=void 0;const C=g(7106),x=g(2895);class T{constructor(u,d){this.header=u,this.dataAsBytes=d}static fromBytes(u,d){const h=C.ChunkSize,b=x.TarFileEntryHeader.fromBytes(u),m=b.fileSizeInBytes,f=Math.ceil(m/h)*h,y=d.readBytes(f).slice(0,m);return new T(b,y)}}E.TarFileEntry=T},2895:(s,E,g)=>{"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.TarFileEntryHeader=void 0;const C=g(879),x=g(3335);class T{constructor(u,d,h,b,m,l,f,y,_,R,D,A,F,H,L,M){this.fileName=u,this.fileMode=d,this.userIDOfOwner=h,this.userIDOfGroup=b,this.fileSizeInBytes=m,this.timeModifiedInUnixFormat=l,this.checksum=f,this.typeFlag=y,this.nameOfLinkedFile=_,this.uStarIndicator=R,this.uStarVersion=D,this.userNameOfOwner=A,this.groupNameOfOwner=F,this.deviceNumberMajor=H,this.deviceNumberMinor=L,this.filenamePrefix=M,this.fullFileName=M.length?M.endsWith("/")?M+u:M+"/"+u:u}static fromBytes(u){const d=new C.ByteStream(u),h=d.readString(100).trim(),b=d.readString(8),m=d.readString(8),l=d.readString(8),f=d.readString(12),y=d.readBytes(12),_=d.readString(8),R=d.readString(1),D=d.readString(100),A=d.readString(6),F=d.readString(2),H=d.readString(32),L=d.readString(32),M=d.readString(8),O=d.readString(8),U=d.readString(155),W=d.readBytes(12),X=parseInt(f.trim(),8),N=parseInt(_,8),V=x.TarFileTypeFlag.Instances()._All,Y="_"+R,J=V[Y];return new T(h,b,m,l,X,y,N,J,D,A,F,H,L,M,O,U)}}E.TarFileEntryHeader=T},3335:(s,E)=>{"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.TarFileTypeFlag=void 0;class g{constructor(T,v){this.value=T,this.id="_"+this.value,this.name=v}static Instances(){return g._instances==null&&(g._instances=new C),g._instances}}E.TarFileTypeFlag=g;class C{constructor(){this.Normal=new g("0","Normal"),this.HardLink=new g("1","Hard Link"),this.SymbolicLink=new g("2","Symbolic Link"),this.CharacterSpecial=new g("3","Character Special"),this.BlockSpecial=new g("4","Block Special"),this.Directory=new g("5","Directory"),this.FIFO=new g("6","FIFO"),this.ContiguousFile=new g("7","Contiguous File"),this.LongFilePath=new g("L","././@LongLink"),this._All=[this.Normal,this.HardLink,this.SymbolicLink,this.CharacterSpecial,this.BlockSpecial,this.Directory,this.FIFO,this.ContiguousFile,this.LongFilePath];for(let T=0;T<this._All.length;T++){const v=this._All[T];this._All[v.id]=v}}}},5790:(s,E,g)=>{"use strict";var C;C={value:!0},E.t9=C=C=C=void 0;const x=g(5759);C={enumerable:!0,get:function(){return x.TarFile}};const T=g(4108);C={enumerable:!0,get:function(){return T.TarFileEntry}};const v=g(2895);C={enumerable:!0,get:function(){return v.TarFileEntryHeader}},E.t9=u=>x.TarFile.fromBytes(u)},6281:(s,E,g)=>{"use strict";var C=g(7396),x=function(){function T(v){if(T.INSTANCE)throw new Error("Console logging adapter tracking should be configured from the applicationInsights object");this._client=v,T.INSTANCE=this}return T.prototype.enable=function(v,u){C.IsInitialized&&(g(4309).wp(v&&u,this._client),g(5823).wp(v,this._client),g(454).wp(v,this._client))},T.prototype.isInitialized=function(){return this._isInitialized},T.prototype.dispose=function(){T.INSTANCE=null,this.enable(!1,!1)},T._methodNames=["debug","info","log","warn","error"],T}();s.exports=x},894:(s,E,g)=>{"use strict";Object.defineProperty(E,"__esModule",{value:!0});var C=g(5282),x=g(7396),T=function(){function u(){}return u.getCurrentContext=function(){if(!u.enabled)return null;var d=u.session.get(u.CONTEXT_NAME);return d===void 0?null:d},u.generateContextObject=function(d,h,b,m,l,f){return h=h||d,this.enabled?{operation:{name:b,id:d,parentId:h,traceparent:l,tracestate:f},customProperties:new v(m)}:null},u.runWithContext=function(d,h){if(u.enabled)return u.session.bind(h,(b={},b[u.CONTEXT_NAME]=d,b))();return h();var b},u.wrapEmitter=function(d){u.enabled&&u.session.bindEmitter(d)},u.wrapCallback=function(d){return u.enabled?u.session.bind(d):d},u.enable=function(d){if(!this.enabled){if(!this.isNodeVersionCompatible()){this.enabled=!1;return}u.hasEverEnabled||(this.forceClsHooked=d,this.hasEverEnabled=!0,typeof this.cls=="undefined"&&(u.forceClsHooked===!0||u.forceClsHooked===void 0&&u.shouldUseClsHooked()?this.cls=g(9562):this.cls=g(3057)),u.session=this.cls.createNamespace("AI-CLS-Session"),x.registerContextPreservation(function(h){return u.session.bind(h)})),this.enabled=!0}},u.disable=function(){this.enabled=!1},u.reset=function(){u.hasEverEnabled&&(u.session=null,u.session=this.cls.createNamespace("AI-CLS-Session"))},u.isNodeVersionCompatible=function(){var d=process.versions.node.split(".");return parseInt(d[0])>3||parseInt(d[0])>2&&parseInt(d[1])>2},u.shouldUseClsHooked=function(){var d=process.versions.node.split(".");return parseInt(d[0])>8||parseInt(d[0])>=8&&parseInt(d[1])>=2},u.canUseClsHooked=function(){var d=process.versions.node.split("."),h=parseInt(d[0])>8||parseInt(d[0])>=8&&parseInt(d[1])>=0,b=parseInt(d[0])<8||parseInt(d[0])<=8&&parseInt(d[1])<2,m=parseInt(d[0])>4||parseInt(d[0])>=4&&parseInt(d[1])>=7;return!(h&&b)&&m},u.enabled=!1,u.hasEverEnabled=!1,u.forceClsHooked=void 0,u.CONTEXT_NAME="ApplicationInsights-Context",u}();E.CorrelationContextManager=T;var v=function(){function u(d){this.props=[],this.addHeaderData(d)}return u.prototype.addHeaderData=function(d){var h=d?d.split(", "):[];this.props=h.map(function(b){var m=b.split("=");return{key:m[0],value:m[1]}}).concat(this.props)},u.prototype.serializeToHeader=function(){return this.props.map(function(d){return d.key+"="+d.value}).join(", ")},u.prototype.getProperty=function(d){for(var h=0;h<this.props.length;++h){var b=this.props[h];if(b.key===d)return b.value}},u.prototype.setProperty=function(d,h){if(u.bannedCharacters.test(d)||u.bannedCharacters.test(h)){C.warn("Correlation context property keys and values must not contain ',' or '='. setProperty was called with key: "+d+" and value: "+h);return}for(var b=0;b<this.props.length;++b){var m=this.props[b];if(m.key===d){m.value=h;return}}this.props.push({key:d,value:h})},u.bannedCharacters=/[,=]/,u}()},6639:s=>{"use strict";var E=function(){function g(C){if(g.INSTANCE)throw new Error("Exception tracking should be configured from the applicationInsights object");g.INSTANCE=this,this._client=C;var x=process.versions.node.split(".");g._canUseUncaughtExceptionMonitor=parseInt(x[0])>13||parseInt(x[0])===13&&parseInt(x[1])>=7}return g.prototype.isInitialized=function(){return this._isInitialized},g.prototype.enable=function(C){var x=this;if(C){this._isInitialized=!0;var T=this;if(!this._exceptionListenerHandle){var v=function(u,d,h){h===void 0&&(h=new Error(g._FALLBACK_ERROR_MESSAGE)),x._client.trackException({exception:h}),x._client.flush({isAppCrashing:!0}),u&&d&&process.listeners(d).length===1&&(console.error(h),process.exit(1))};g._canUseUncaughtExceptionMonitor?(this._exceptionListenerHandle=v.bind(this,!1),process.on(g.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME,this._exceptionListenerHandle)):(this._exceptionListenerHandle=v.bind(this,!0,g.UNCAUGHT_EXCEPTION_HANDLER_NAME),this._rejectionListenerHandle=v.bind(this,!1),process.on(g.UNCAUGHT_EXCEPTION_HANDLER_NAME,this._exceptionListenerHandle),process.on(g.UNHANDLED_REJECTION_HANDLER_NAME,this._rejectionListenerHandle))}}else this._exceptionListenerHandle&&(g._canUseUncaughtExceptionMonitor?process.removeListener(g.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME,this._exceptionListenerHandle):(process.removeListener(g.UNCAUGHT_EXCEPTION_HANDLER_NAME,this._exceptionListenerHandle),process.removeListener(g.UNHANDLED_REJECTION_HANDLER_NAME,this._rejectionListenerHandle)),this._exceptionListenerHandle=void 0,this._rejectionListenerHandle=void 0,delete this._exceptionListenerHandle,delete this._rejectionListenerHandle)},g.prototype.dispose=function(){g.INSTANCE=null,this.enable(!1),this._isInitialized=!1},g.INSTANCE=null,g.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME="uncaughtExceptionMonitor",g.UNCAUGHT_EXCEPTION_HANDLER_NAME="uncaughtException",g.UNHANDLED_REJECTION_HANDLER_NAME="unhandledRejection",g._RETHROW_EXIT_MESSAGE="Application Insights Rethrow Exception Handler",g._FALLBACK_ERROR_MESSAGE="A promise was rejected without providing an error. Application Insights generated this error stack for you.",g._canUseUncaughtExceptionMonitor=!1,g}();s.exports=E},8723:(s,E,g)=>{"use strict";var C=g(8605),x=g(7211),T=g(5282),v=g(5740),u=g(9036),d=g(8339),h=g(894),b=g(9962),m=g(8090),l=g(7396),f=function(){function y(_){if(y.INSTANCE)throw new Error("Client request tracking should be configured from the applicationInsights object");y.INSTANCE=this,this._client=_}return y.prototype.enable=function(_){this._isEnabled=_,this._isEnabled&&!this._isInitialized&&this._initialize(),l.IsInitialized&&(g(7886).wp(_,this._client),g(4777).wp(_,this._client),g(5071).wp(_,this._client),g(1227).wp(_,this._client))},y.prototype.isInitialized=function(){return this._isInitialized},y.prototype._initialize=function(){var _=this;this._isInitialized=!0;var R=C.get,D=C.request,A=x.request,F=function(H,L){var M=!L[y.disableCollectionRequestOption]&&!H[y.alreadyAutoCollectedFlag];H[y.alreadyAutoCollectedFlag]=!0,H&&L&&M&&(h.CorrelationContextManager.wrapEmitter(H),y.trackRequest(_._client,{options:L,request:H}))};C.request=function(H){for(var L=[],M=1;M<arguments.length;M++)L[M-1]=arguments[M];var O=D.call.apply(D,[C,H].concat(L));return F(O,H),O},x.request=function(H){for(var L=[],M=1;M<arguments.length;M++)L[M-1]=arguments[M];var O=A.call.apply(A,[x,H].concat(L));return F(O,H),O},C.get=function(H){for(var L=[],M=1;M<arguments.length;M++)L[M-1]=arguments[M];var O=(U=C.request).call.apply(U,[C,H].concat(L));return O.end(),O;var U},x.get=function(H){for(var L=[],M=1;M<arguments.length;M++)L[M-1]=arguments[M];var O=(U=x.request).call.apply(U,[x,H].concat(L));return O.end(),O;var U}},y.trackRequest=function(_,R){if(!R.options||!R.request||!_){T.info("AutoCollectHttpDependencies.trackRequest was called with invalid parameters: ",!R.options,!R.request,!_);return}var D=new d(R.options,R.request),A=h.CorrelationContextManager.getCurrentContext(),F,H;if(A&&A.operation&&A.operation.traceparent&&m.isValidTraceId(A.operation.traceparent.traceId))A.operation.traceparent.updateSpanId(),F=A.operation.traceparent.getBackCompatRequestId();else if(b.w3cEnabled){var L=new m;H=L.toString(),F=L.getBackCompatRequestId()}else F=A&&A.operation&&A.operation.parentId+y.requestNumber+++".";if(v.canIncludeCorrelationHeader(_,D.getUrl())&&R.request.getHeader&&R.request.setHeader&&_.config&&_.config.correlationId){var M=R.request.getHeader(u.requestContextHeader);try{v.safeIncludeCorrelationHeader(_,R.request,M)}catch(W){T.warn("Request-Context header could not be set. Correlation of requests may be lost",W)}if(A&&A.operation)try{if(R.request.setHeader(u.requestIdHeader,F),R.request.setHeader(u.parentIdHeader,A.operation.id),R.request.setHeader(u.rootIdHeader,F),H||A.operation.traceparent)R.request.setHeader(u.traceparentHeader,H||A.operation.traceparent.toString());else if(b.w3cEnabled){var L=new m().toString();R.request.setHeader(u.traceparentHeader,L)}if(A.operation.tracestate){var O=A.operation.tracestate.toString();O&&R.request.setHeader(u.traceStateHeader,O)}var U=A.customProperties.serializeToHeader();U&&R.request.setHeader(u.correlationContextHeader,U)}catch(W){T.warn("Correlation headers could not be set. Correlation of requests may be lost.",W)}}R.request.on&&(R.request.on("response",function(W){D.onResponse(W);var X=D.getDependencyTelemetry(R,F);X.contextObjects=X.contextObjects||{},X.contextObjects["http.RequestOptions"]=R.options,X.contextObjects["http.ClientRequest"]=R.request,X.contextObjects["http.ClientResponse"]=W,_.trackDependency(X)}),R.request.on("error",function(W){D.onError(W);var X=D.getDependencyTelemetry(R,F);X.contextObjects=X.contextObjects||{},X.contextObjects["http.RequestOptions"]=R.options,X.contextObjects["http.ClientRequest"]=R.request,X.contextObjects.Error=W,_.trackDependency(X)}))},y.prototype.dispose=function(){y.INSTANCE=null,this.enable(!1),this._isInitialized=!1},y.disableCollectionRequestOption="disableAppInsightsAutoCollection",y.requestNumber=1,y.alreadyAutoCollectedFlag="_appInsightsAutoCollected",y}();s.exports=f},8339:function(s,E,g){"use strict";var C=this&&this.__extends||function(){var m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,f){l.__proto__=f}||function(l,f){for(var y in f)f.hasOwnProperty(y)&&(l[y]=f[y])};return function(l,f){m(l,f);function y(){this.constructor=l}l.prototype=f===null?Object.create(f):(y.prototype=f.prototype,new y)}}(),x=g(8835),T=g(5290),v=g(5740),u=g(9036),d=g(3054),h=g(9962),b=function(m){C(l,m);function l(f,y){var _=m.call(this)||this;return y&&y.method&&f&&(_.method=y.method,_.url=l._getUrlFromRequestOptions(f,y),_.startTime=+new Date),_}return l.prototype.onError=function(f){this._setStatus(void 0,f)},l.prototype.onResponse=function(f){this._setStatus(f.statusCode,void 0),this.correlationId=v.getCorrelationContextTarget(f,u.requestContextTargetKey)},l.prototype.getDependencyTelemetry=function(f,y){var _=x.parse(this.url);_.search=void 0,_.hash=void 0;var R=this.method.toUpperCase()+" "+_.pathname,D=T.RemoteDependencyDataConstants.TYPE_HTTP,A=_.hostname;this.correlationId?(D=T.RemoteDependencyDataConstants.TYPE_AI,this.correlationId!==h.correlationIdPrefix&&(A=_.hostname+" | "+this.correlationId)):D=T.RemoteDependencyDataConstants.TYPE_HTTP,_.port&&(A+=":"+_.port);var F={id:y,name:R,data:this.url,duration:this.duration,success:this._isSuccess(),resultCode:this.statusCode?this.statusCode.toString():null,properties:this.properties||{},dependencyTypeName:D,target:A};if(f){for(var H in f)F[H]||(F[H]=f[H]);if(f.properties)for(var H in f.properties)F.properties[H]=f.properties[H]}return F},l._getUrlFromRequestOptions=function(f,y){if(typeof f=="string")f=x.parse(f);else{var _=f;f={},_&&Object.keys(_).forEach(function(A){f[A]=_[A]})}if(f.path){var R=x.parse(f.path);f.pathname=R.pathname,f.search=R.search}if(f.host&&f.port){var D=x.parse("http://"+f.host);!D.port&&f.port&&(f.hostname=f.host,delete f.host)}return f.protocol=f.protocol||y.agent&&y.agent.protocol||void 0,f.hostname=f.hostname||"localhost",x.format(f)},l}(d);s.exports=b},6694:function(s,E,g){"use strict";var C=this&&this.__extends||function(){var f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(y,_){y.__proto__=_}||function(y,_){for(var R in _)_.hasOwnProperty(R)&&(y[R]=_[R])};return function(y,_){f(y,_);function R(){this.constructor=y}y.prototype=_===null?Object.create(_):(R.prototype=_.prototype,new R)}}(),x=g(8835),T=g(5290),v=g(5740),u=g(9036),d=g(3054),h=g(9962),b=g(6333),m=g(8090),l=function(f){C(y,f);function y(_,R){var D=f.call(this)||this;return _&&(D.method=_.method,D.url=D._getAbsoluteUrl(_),D.startTime=+new Date,D.socketRemoteAddress=_.socket&&_.socket.remoteAddress,D.parseHeaders(_,R),_.connection&&(D.connectionRemoteAddress=_.connection.remoteAddress,D.legacySocketRemoteAddress=_.connection.socket&&_.connection.socket.remoteAddress)),D}return y.prototype.onError=function(_,R){this._setStatus(void 0,_),R&&(this.duration=R)},y.prototype.onResponse=function(_,R){this._setStatus(_.statusCode,void 0),R&&(this.duration=R)},y.prototype.getRequestTelemetry=function(_){var R={id:this.requestId,name:this.method+" "+x.parse(this.url).pathname,url:this.url,source:this.sourceCorrelationId,duration:this.duration,resultCode:this.statusCode?this.statusCode.toString():null,success:this._isSuccess(),properties:this.properties};if(_){for(var D in _)R[D]||(R[D]=_[D]);if(_.properties)for(var D in _.properties)R.properties[D]=_.properties[D]}return R},y.prototype.getRequestTags=function(_){var R={};for(var D in _)R[D]=_[D];return R[y.keys.locationIp]=_[y.keys.locationIp]||this._getIp(),R[y.keys.sessionId]=_[y.keys.sessionId]||this._getId("ai_session"),R[y.keys.userId]=_[y.keys.userId]||this._getId("ai_user"),R[y.keys.userAuthUserId]=_[y.keys.userAuthUserId]||this._getId("ai_authUser"),R[y.keys.operationName]=this.getOperationName(_),R[y.keys.operationParentId]=this.getOperationParentId(_),R[y.keys.operationId]=this.getOperationId(_),R},y.prototype.getOperationId=function(_){return _[y.keys.operationId]||this.operationId},y.prototype.getOperationParentId=function(_){return _[y.keys.operationParentId]||this.parentId||this.getOperationId(_)},y.prototype.getOperationName=function(_){return _[y.keys.operationName]||this.method+" "+x.parse(this.url).pathname},y.prototype.getRequestId=function(){return this.requestId},y.prototype.getCorrelationContextHeader=function(){return this.correlationContextHeader},y.prototype.getTraceparent=function(){return this.traceparent},y.prototype.getTracestate=function(){return this.tracestate},y.prototype.getLegacyRootId=function(){return this.legacyRootId},y.prototype._getAbsoluteUrl=function(_){if(!_.headers)return _.url;var R=_.connection?_.connection.encrypted:null,D=x.parse(_.url),A=D.pathname,F=D.search,H=x.format({protocol:R?"https":"http",host:_.headers.host,pathname:A,search:F});return H},y.prototype._getIp=function(){var _=/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/,R=function(A){var F=_.exec(A);if(F)return F[0]},D=R(this.rawHeaders["x-forwarded-for"])||R(this.rawHeaders["x-client-ip"])||R(this.rawHeaders["x-real-ip"])||R(this.connectionRemoteAddress)||R(this.socketRemoteAddress)||R(this.legacySocketRemoteAddress);return!D&&this.connectionRemoteAddress&&this.connectionRemoteAddress.substr&&this.connectionRemoteAddress.substr(0,2)==="::"&&(D="127.0.0.1"),D},y.prototype._getId=function(_){var R=this.rawHeaders&&this.rawHeaders.cookie&&typeof this.rawHeaders.cookie=="string"&&this.rawHeaders.cookie||"",D=y.parseId(v.getCookie(_,R));return D},y.prototype.setBackCompatFromThisTraceContext=function(){this.operationId=this.traceparent.traceId,this.traceparent.legacyRootId&&(this.legacyRootId=this.traceparent.legacyRootId),this.parentId=this.traceparent.parentId,this.traceparent.updateSpanId(),this.requestId=this.traceparent.getBackCompatRequestId()},y.prototype.parseHeaders=function(_,R){if(this.rawHeaders=_.headers||_.rawHeaders,this.userAgent=_.headers&&_.headers["user-agent"],this.sourceCorrelationId=v.getCorrelationContextTarget(_,u.requestContextSourceKey),_.headers){var D=_.headers[u.traceStateHeader],A=_.headers[u.traceparentHeader],F=_.headers[u.requestIdHeader],H=_.headers[u.parentIdHeader],L=_.headers[u.rootIdHeader];this.correlationContextHeader=_.headers[u.correlationContextHeader],h.w3cEnabled&&(A||D)?(this.traceparent=new m(A),this.tracestate=A&&D&&new b(D),this.setBackCompatFromThisTraceContext()):F?h.w3cEnabled?(this.traceparent=new m(null,F),this.setBackCompatFromThisTraceContext()):(this.parentId=F,this.requestId=h.generateRequestId(this.parentId),this.operationId=h.getRootId(this.requestId)):h.w3cEnabled?(this.traceparent=new m,this.traceparent.parentId=H,this.traceparent.legacyRootId=L||H,this.setBackCompatFromThisTraceContext()):(this.parentId=H,this.requestId=h.generateRequestId(L||this.parentId),this.correlationContextHeader=null,this.operationId=h.getRootId(this.requestId)),R&&(this.requestId=R,this.operationId=h.getRootId(this.requestId))}},y.parseId=function(_){var R=_.split("|");return R.length>0?R[0]:""},y.keys=new T.ContextTagKeys,y}(d);s.exports=l},731:(s,E,g)=>{"use strict";var C=g(8605),x=g(7211),T=g(5282),v=g(5740),u=g(9036),d=g(6694),h=g(894),b=g(4350),m=function(){function l(f){if(l.INSTANCE)throw new Error("Server request tracking should be configured from the applicationInsights object");l.INSTANCE=this,this._client=f}return l.prototype.enable=function(f){this._isEnabled=f,(this._isAutoCorrelating||this._isEnabled||b.isEnabled())&&!this._isInitialized&&(this.useAutoCorrelation(this._isAutoCorrelating),this._initialize())},l.prototype.useAutoCorrelation=function(f,y){f&&!this._isAutoCorrelating?h.CorrelationContextManager.enable(y):!f&&this._isAutoCorrelating&&h.CorrelationContextManager.disable(),this._isAutoCorrelating=f},l.prototype.isInitialized=function(){return this._isInitialized},l.prototype.isAutoCorrelating=function(){return this._isAutoCorrelating},l.prototype._generateCorrelationContext=function(f){if(!!this._isAutoCorrelating)return h.CorrelationContextManager.generateContextObject(f.getOperationId(this._client.context.tags),f.getRequestId(),f.getOperationName(this._client.context.tags),f.getCorrelationContextHeader(),f.getTraceparent(),f.getTracestate())},l.prototype._initialize=function(){var f=this;this._isInitialized=!0;var y=function(A){if(!!A){if(typeof A!="function")throw new Error("onRequest handler must be a function");return function(F,H){h.CorrelationContextManager.wrapEmitter(F),h.CorrelationContextManager.wrapEmitter(H);var L=F&&!F[l.alreadyAutoCollectedFlag];if(F&&L){var M=new d(F),O=f._generateCorrelationContext(M);h.CorrelationContextManager.runWithContext(O,function(){f._isEnabled&&(F[l.alreadyAutoCollectedFlag]=!0,l.trackRequest(f._client,{request:F,response:H},M)),typeof A=="function"&&A(F,H)})}else typeof A=="function"&&A(F,H)}}},_=function(A){var F=A.addListener.bind(A);A.addListener=function(H,L){switch(H){case"request":case"checkContinue":return F(H,y(L));default:return F(H,L)}},A.on=A.addListener},R=C.createServer;C.createServer=function(A){var F=R(y(A));return _(F),F};var D=x.createServer;x.createServer=function(A,F){var H=D(A,y(F));return _(H),H}},l.trackRequestSync=function(f,y){if(!y.request||!y.response||!f){T.info("AutoCollectHttpRequests.trackRequestSync was called with invalid parameters: ",!y.request,!y.response,!f);return}l.addResponseCorrelationIdHeader(f,y.response);var _=h.CorrelationContextManager.getCurrentContext(),R=new d(y.request,_&&_.operation.parentId);_&&(_.operation.id=R.getOperationId(f.context.tags)||_.operation.id,_.operation.name=R.getOperationName(f.context.tags)||_.operation.name,_.operation.parentId=R.getRequestId()||_.operation.parentId,_.customProperties.addHeaderData(R.getCorrelationContextHeader())),l.endRequest(f,R,y,y.duration,y.error)},l.trackRequest=function(f,y,_){if(!y.request||!y.response||!f){T.info("AutoCollectHttpRequests.trackRequest was called with invalid parameters: ",!y.request,!y.response,!f);return}var R=h.CorrelationContextManager.getCurrentContext(),D=_||new d(y.request,R&&R.operation.parentId);v.canIncludeCorrelationHeader(f,D.getUrl())&&l.addResponseCorrelationIdHeader(f,y.response),R&&!_&&(R.operation.id=D.getOperationId(f.context.tags)||R.operation.id,R.operation.name=D.getOperationName(f.context.tags)||R.operation.name,R.operation.parentId=D.getOperationParentId(f.context.tags)||R.operation.parentId,R.customProperties.addHeaderData(D.getCorrelationContextHeader())),y.response.once&&y.response.once("finish",function(){l.endRequest(f,D,y,null,null)}),y.request.on&&y.request.on("error",function(A){l.endRequest(f,D,y,null,A)})},l.addResponseCorrelationIdHeader=function(f,y){if(f.config&&f.config.correlationId&&y.getHeader&&y.setHeader&&!y.headersSent){var _=y.getHeader(u.requestContextHeader);v.safeIncludeCorrelationHeader(f,y,_)}},l.endRequest=function(f,y,_,R,D){D?y.onError(D,R):y.onResponse(_.response,R);var A=y.getRequestTelemetry(_);if(A.tagOverrides=y.getRequestTags(f.context.tags),_.tagOverrides)for(var F in _.tagOverrides)A.tagOverrides[F]=_.tagOverrides[F];var H=y.getLegacyRootId();H&&(A.properties.ai_legacyRootId=H),A.contextObjects=A.contextObjects||{},A.contextObjects["http.ServerRequest"]=_.request,A.contextObjects["http.ServerResponse"]=_.response,f.trackRequest(A)},l.prototype.dispose=function(){l.INSTANCE=null,this.enable(!1),this._isInitialized=!1,h.CorrelationContextManager.disable(),this._isAutoCorrelating=!1},l.alreadyAutoCollectedFlag="_appInsightsAutoCollected",l}();s.exports=m},1629:function(s,E,g){"use strict";var C=this&&this.__assign||Object.assign||function(d){for(var h,b=1,m=arguments.length;b<m;b++){h=arguments[b];for(var l in h)Object.prototype.hasOwnProperty.call(h,l)&&(d[l]=h[l])}return d};Object.defineProperty(E,"__esModule",{value:!0});var x=g(9253),T=g(4470),v=g(5282),u=function(){function d(h){this._disabledMetrics={},d.INSTANCE&&d.INSTANCE.dispose(),d.INSTANCE=this,this._client=h}return d.isNodeVersionCompatible=function(){var h=process.versions.node.split(".");return parseInt(h[0])>=6},d.prototype.enable=function(h,b,m){var l=this;if(b===void 0&&(b={}),m===void 0&&(m=6e4),!!d.isNodeVersionCompatible()){if(d._metricsAvailable==null&&h&&!this._isInitialized)try{var f=g(6591);d._emitter=new f,d._metricsAvailable=!0,v.info("Native metrics module successfully loaded!")}catch(y){d._metricsAvailable=!1;return}this._isEnabled=h,this._disabledMetrics=b,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),this._isEnabled&&d._emitter?(d._emitter.enable(!0,m),this._handle=setInterval(function(){return l._trackNativeMetrics()},m),this._handle.unref()):d._emitter&&(d._emitter.enable(!1),this._handle&&(clearInterval(this._handle),this._handle=void 0))}},d.prototype.dispose=function(){this.enable(!1)},d.parseEnabled=function(h){var b=process.env[x.ENV_nativeMetricsDisableAll],m=process.env[x.ENV_nativeMetricsDisablers];if(b)return{isEnabled:!1,disabledMetrics:{}};if(m){var l=m.split(","),f={};if(l.length>0)for(var y=0,_=l;y<_.length;y++){var R=_[y];f[R]=!0}return typeof h=="object"?{isEnabled:!0,disabledMetrics:C({},h,f)}:{isEnabled:h,disabledMetrics:f}}return typeof h=="boolean"?{isEnabled:h,disabledMetrics:{}}:{isEnabled:!0,disabledMetrics:h}},d.prototype._trackNativeMetrics=function(){var h=!0;typeof this._isEnabled!="object"&&(h=this._isEnabled),h&&(this._trackGarbageCollection(),this._trackEventLoop(),this._trackHeapUsage())},d.prototype._trackGarbageCollection=function(){if(!this._disabledMetrics.gc){var h=d._emitter.getGCData();for(var b in h){var m=h[b].metrics,l=b+" Garbage Collection Duration",f=Math.sqrt(m.sumSquares/m.count-Math.pow(m.total/m.count,2))||0;this._client.trackMetric({name:l,value:m.total,count:m.count,max:m.max,min:m.min,stdDev:f,tagOverrides:(y={},y[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+T.sdkVersion,y)})}var y}},d.prototype._trackEventLoop=function(){if(!this._disabledMetrics.loop){var h=d._emitter.getLoopData(),b=h.loopUsage;if(b.count!=0){var m="Event Loop CPU Time",l=Math.sqrt(b.sumSquares/b.count-Math.pow(b.total/b.count,2))||0;this._client.trackMetric({name:m,value:b.total,count:b.count,min:b.min,max:b.max,stdDev:l,tagOverrides:(f={},f[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+T.sdkVersion,f)});var f}}},d.prototype._trackHeapUsage=function(){if(!this._disabledMetrics.heap){var h=process.memoryUsage(),b=h.heapUsed,m=h.heapTotal,l=h.rss;this._client.trackMetric({name:"Memory Usage (Heap)",value:b,count:1,tagOverrides:(f={},f[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+T.sdkVersion,f)}),this._client.trackMetric({name:"Memory Total (Heap)",value:m,count:1,tagOverrides:(y={},y[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+T.sdkVersion,y)}),this._client.trackMetric({name:"Memory Usage (Non-Heap)",value:l-m,count:1,tagOverrides:(_={},_[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+T.sdkVersion,_)});var f,y,_}},d}();E.AutoCollectNativePerformance=u},4350:(s,E,g)=>{"use strict";var C=g(2087),x=g(3580),T=function(){function v(u,d,h){d===void 0&&(d=6e4),h===void 0&&(h=!1),this._lastIntervalRequestExecutionTime=0,this._lastIntervalDependencyExecutionTime=0,v.INSTANCE||(v.INSTANCE=this),this._isInitialized=!1,this._client=u,this._collectionInterval=d,this._enableLiveMetricsCounters=h}return v.prototype.enable=function(u,d){var h=this;this._isEnabled=u,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),u?this._handle||(this._lastCpus=C.cpus(),this._lastRequests={totalRequestCount:v._totalRequestCount,totalFailedRequestCount:v._totalFailedRequestCount,time:+new Date},this._lastDependencies={totalDependencyCount:v._totalDependencyCount,totalFailedDependencyCount:v._totalFailedDependencyCount,time:+new Date},this._lastExceptions={totalExceptionCount:v._totalExceptionCount,time:+new Date},typeof process.cpuUsage=="function"&&(this._lastAppCpuUsage=process.cpuUsage()),this._lastHrtime=process.hrtime(),this._collectionInterval=d||this._collectionInterval,this._handle=setInterval(function(){return h.trackPerformance()},this._collectionInterval),this._handle.unref()):this._handle&&(clearInterval(this._handle),this._handle=void 0)},v.countRequest=function(u,d){var h;if(!!v.isEnabled()){if(typeof u=="string")h=+new Date("1970-01-01T"+u+"Z");else if(typeof u=="number")h=u;else return;v._intervalRequestExecutionTime+=h,d===!1&&v._totalFailedRequestCount++,v._totalRequestCount++}},v.countException=function(){v._totalExceptionCount++},v.countDependency=function(u,d){var h;if(!!v.isEnabled()){if(typeof u=="string")h=+new Date("1970-01-01T"+u+"Z");else if(typeof u=="number")h=u;else return;v._intervalDependencyExecutionTime+=h,d===!1&&v._totalFailedDependencyCount++,v._totalDependencyCount++}},v.prototype.isInitialized=function(){return this._isInitialized},v.isEnabled=function(){return v.INSTANCE&&v.INSTANCE._isEnabled},v.prototype.trackPerformance=function(){this._trackCpu(),this._trackMemory(),this._trackNetwork(),this._trackDependencyRate(),this._trackExceptionRate()},v.prototype._trackCpu=function(){var u=C.cpus();if(u&&u.length&&this._lastCpus&&u.length===this._lastCpus.length){for(var d=0,h=0,b=0,m=0,l=0,f=0;!!u&&f<u.length;f++){var y=u[f],_=this._lastCpus[f],R="% cpu("+f+") ",D=y.model,A=y.speed,F=y.times,H=_.times,L=F.user-H.user||0;d+=L;var M=F.sys-H.sys||0;h+=M;var O=F.nice-H.nice||0;b+=O;var U=F.idle-H.idle||0;m+=U;var W=F.irq-H.irq||0;l+=W}var X=void 0;if(typeof process.cpuUsage=="function"){var N=process.cpuUsage(),V=process.hrtime(),Y=N.user-this._lastAppCpuUsage.user+(N.system-this._lastAppCpuUsage.system)||0;if(typeof this._lastHrtime!="undefined"&&this._lastHrtime.length===2){var J=(V[0]-this._lastHrtime[0])*1e6+(V[1]-this._lastHrtime[1])/1e3||0;X=100*Y/(J*u.length)}this._lastAppCpuUsage=N,this._lastHrtime=V}var oe=d+h+b+m+l||1;this._client.trackMetric({name:x.PerformanceCounter.PROCESSOR_TIME,value:(oe-m)/oe*100}),this._client.trackMetric({name:x.PerformanceCounter.PROCESS_TIME,value:X||d/oe*100})}this._lastCpus=u},v.prototype._trackMemory=function(){var u=C.freemem(),d=process.memoryUsage().rss,h=C.totalmem()-u;this._client.trackMetric({name:x.PerformanceCounter.PRIVATE_BYTES,value:d}),this._client.trackMetric({name:x.PerformanceCounter.AVAILABLE_BYTES,value:u}),this._enableLiveMetricsCounters&&this._client.trackMetric({name:x.QuickPulseCounter.COMMITTED_BYTES,value:h})},v.prototype._trackNetwork=function(){var u=this._lastRequests,d={totalRequestCount:v._totalRequestCount,totalFailedRequestCount:v._totalFailedRequestCount,time:+new Date},h=d.totalRequestCount-u.totalRequestCount||0,b=d.totalFailedRequestCount-u.totalFailedRequestCount||0,m=d.time-u.time,l=m/1e3,f=(v._intervalRequestExecutionTime-this._lastIntervalRequestExecutionTime)/h||0;if(this._lastIntervalRequestExecutionTime=v._intervalRequestExecutionTime,m>0){var y=h/l,_=b/l;this._client.trackMetric({name:x.PerformanceCounter.REQUEST_RATE,value:y}),(!this._enableLiveMetricsCounters||h>0)&&this._client.trackMetric({name:x.PerformanceCounter.REQUEST_DURATION,value:f}),this._enableLiveMetricsCounters&&this._client.trackMetric({name:x.QuickPulseCounter.REQUEST_FAILURE_RATE,value:_})}this._lastRequests=d},v.prototype._trackDependencyRate=function(){if(this._enableLiveMetricsCounters){var u=this._lastDependencies,d={totalDependencyCount:v._totalDependencyCount,totalFailedDependencyCount:v._totalFailedDependencyCount,time:+new Date},h=d.totalDependencyCount-u.totalDependencyCount||0,b=d.totalFailedDependencyCount-u.totalFailedDependencyCount||0,m=d.time-u.time,l=m/1e3,f=(v._intervalDependencyExecutionTime-this._lastIntervalDependencyExecutionTime)/h||0;if(this._lastIntervalDependencyExecutionTime=v._intervalDependencyExecutionTime,m>0){var y=h/l,_=b/l;this._client.trackMetric({name:x.QuickPulseCounter.DEPENDENCY_RATE,value:y}),this._client.trackMetric({name:x.QuickPulseCounter.DEPENDENCY_FAILURE_RATE,value:_}),(!this._enableLiveMetricsCounters||h>0)&&this._client.trackMetric({name:x.QuickPulseCounter.DEPENDENCY_DURATION,value:f})}this._lastDependencies=d}},v.prototype._trackExceptionRate=function(){if(this._enableLiveMetricsCounters){var u=this._lastExceptions,d={totalExceptionCount:v._totalExceptionCount,time:+new Date},h=d.totalExceptionCount-u.totalExceptionCount||0,b=d.time-u.time,m=b/1e3;if(b>0){var l=h/m;this._client.trackMetric({name:x.QuickPulseCounter.EXCEPTION_RATE,value:l})}this._lastExceptions=d}},v.prototype.dispose=function(){v.INSTANCE=null,this.enable(!1),this._isInitialized=!1},v._totalRequestCount=0,v._totalFailedRequestCount=0,v._lastRequestExecutionTime=0,v._totalDependencyCount=0,v._totalFailedDependencyCount=0,v._lastDependencyExecutionTime=0,v._totalExceptionCount=0,v._intervalDependencyExecutionTime=0,v._intervalRequestExecutionTime=0,v}();s.exports=T},3054:s=>{"use strict";var E=function(){function g(){}return g.prototype.getUrl=function(){return this.url},g.prototype.RequestParser=function(){this.startTime=+new Date},g.prototype._setStatus=function(C,x){var T=+new Date;this.duration=T-this.startTime,this.statusCode=C;var v=this.properties||{};if(x){if(typeof x=="string")v.error=x;else if(x instanceof Error)v.error=x.message;else if(typeof x=="object")for(var u in x)v[u]=x[u]&&x[u].toString&&x[u].toString()}this.properties=v},g.prototype._isSuccess=function(){return 0<this.statusCode&&this.statusCode<400},g}();s.exports=E},5823:(s,E,g)=>{"use strict";var C;C={value:!0};var x=g(5290),T=g(4953),v=[],u={10:x.SeverityLevel.Verbose,20:x.SeverityLevel.Verbose,30:x.SeverityLevel.Information,40:x.SeverityLevel.Warning,50:x.SeverityLevel.Error,60:x.SeverityLevel.Critical},d=function(m){var l=m.data.result;v.forEach(function(f){var y=u[m.data.level];l instanceof Error?f.trackException({exception:l}):f.trackTrace({message:l,severity:y})})};function h(m,l){m?(v.length===0&&T.channel.subscribe("bunyan",d),v.push(l)):(v=v.filter(function(f){return f!=l}),v.length===0&&T.channel.unsubscribe("bunyan",d))}E.wp=h;function b(){T.channel.unsubscribe("bunyan",d),v=[]}C=b},4309:(s,E,g)=>{"use strict";var C;C={value:!0};var x=g(5290),T=g(4953),v=[],u=function(b){var m=b.data.message;v.forEach(function(l){m instanceof Error?l.trackException({exception:m}):(m.lastIndexOf(`
`)==m.length-1&&(m=m.substring(0,m.length-1)),l.trackTrace({message:m,severity:b.data.stderr?x.SeverityLevel.Warning:x.SeverityLevel.Information}))})};function d(b,m){b?(v.length===0&&T.channel.subscribe("console",u),v.push(m)):(v=v.filter(function(l){return l!=m}),v.length===0&&T.channel.unsubscribe("console",u))}E.wp=d;function h(){T.channel.unsubscribe("console",u),v=[]}C=h},7396:(s,E,g)=>{"use strict";Object.defineProperty(E,"__esModule",{value:!0});var C=g(5282);E.IsInitialized=!process.env.APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL;var x="DiagnosticChannel";if(E.IsInitialized){var T=g(4106),v=process.env.APPLICATION_INSIGHTS_NO_PATCH_MODULES||"",u=v.split(","),d={bunyan:T.bunyan,console:T.console,mongodb:T.mongodb,mongodbCore:T.mongodbCore,mysql:T.mysql,redis:T.redis,pg:T.pg,pgPool:T.pgPool,winston:T.winston};for(var h in d)u.indexOf(h)===-1&&(d[h].enable(),C.info(x,"Subscribed to "+h+" events"));u.length>0&&C.info(x,"Some modules will not be patched",u)}else C.info(x,"Not subscribing to dependency autocollection because APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL was set");function b(m){!E.IsInitialized||g(4953).channel.addContextPreservation(m)}E.registerContextPreservation=b},7886:(s,E,g)=>{"use strict";var C;C={value:!0};var x=g(4953),T=[];E.qP=function(u){u.data.event.commandName==="ismaster",T.forEach(function(d){var h=u.data.startedData&&u.data.startedData.databaseName||"Unknown database";d.trackDependency({target:h,data:u.data.event.commandName,name:u.data.event.commandName,duration:u.data.event.duration,success:u.data.succeeded,resultCode:u.data.succeeded?"0":"1",dependencyTypeName:"mongodb"})})};function v(u,d){u?(T.length===0&&x.channel.subscribe("mongodb",E.qP),T.push(d)):(T=T.filter(function(h){return h!=d}),T.length===0&&x.channel.unsubscribe("mongodb",E.qP))}E.wp=v},4777:(s,E,g)=>{"use strict";var C;C={value:!0};var x=g(4953),T=[];E.qP=function(u){T.forEach(function(d){var h=u.data.query||{},b=h.sql||"Unknown query",m=!u.data.err,l=h._connection||{},f=l.config||{},y=f.socketPath?f.socketPath:(f.host||"localhost")+":"+f.port;d.trackDependency({target:y,data:b,name:b,duration:u.data.duration,success:m,resultCode:m?"0":"1",dependencyTypeName:"mysql"})})};function v(u,d){u?(T.length===0&&x.channel.subscribe("mysql",E.qP),T.push(d)):(T=T.filter(function(h){return h!=d}),T.length===0&&x.channel.unsubscribe("mysql",E.qP))}E.wp=v},1227:(s,E,g)=>{"use strict";var C;C={value:!0};var x=g(4953),T=[];E.qP=function(u){T.forEach(function(d){var h=u.data.query,b=h.preparable&&h.preparable.text||h.plan||h.text||"unknown query",m=!u.data.error,l=u.data.database.host+":"+u.data.database.port;d.trackDependency({target:l,data:b,name:b,duration:u.data.duration,success:m,resultCode:m?"0":"1",dependencyTypeName:"postgres"})})};function v(u,d){u?(T.length===0&&x.channel.subscribe("postgres",E.qP),T.push(d)):(T=T.filter(function(h){return h!=d}),T.length===0&&x.channel.unsubscribe("postgres",E.qP))}E.wp=v},5071:(s,E,g)=>{"use strict";var C;C={value:!0};var x=g(4953),T=[];E.qP=function(u){T.forEach(function(d){u.data.commandObj.command!=="info"&&d.trackDependency({target:u.data.address,name:u.data.commandObj.command,data:u.data.commandObj.command,duration:u.data.duration,success:!u.data.err,resultCode:u.data.err?"1":"0",dependencyTypeName:"redis"})})};function v(u,d){u?(T.length===0&&x.channel.subscribe("redis",E.qP),T.push(d)):(T=T.filter(function(h){return h!=d}),T.length===0&&x.channel.unsubscribe("redis",E.qP))}E.wp=v},454:(s,E,g)=>{"use strict";var C;C={value:!0};var x=g(5290),T=g(4953),v=[],u={syslog:function(m){var l={emerg:x.SeverityLevel.Critical,alert:x.SeverityLevel.Critical,crit:x.SeverityLevel.Critical,error:x.SeverityLevel.Error,warning:x.SeverityLevel.Warning,notice:x.SeverityLevel.Information,info:x.SeverityLevel.Information,debug:x.SeverityLevel.Verbose};return l[m]===void 0?x.SeverityLevel.Information:l[m]},npm:function(m){var l={error:x.SeverityLevel.Error,warn:x.SeverityLevel.Warning,info:x.SeverityLevel.Information,verbose:x.SeverityLevel.Verbose,debug:x.SeverityLevel.Verbose,silly:x.SeverityLevel.Verbose};return l[m]===void 0?x.SeverityLevel.Information:l[m]},unknown:function(m){return x.SeverityLevel.Information}},d=function(m){var l=m.data.message;v.forEach(function(f){if(l instanceof Error)f.trackException({exception:l,properties:m.data.meta});else{var y=u[m.data.levelKind](m.data.level);f.trackTrace({message:l,severity:y,properties:m.data.meta})}})};function h(m,l){m?(v.length===0&&T.channel.subscribe("winston",d),v.push(l)):(v=v.filter(function(f){return f!=l}),v.length===0&&T.channel.unsubscribe("winston",d))}E.wp=h;function b(){T.channel.unsubscribe("winston",d),v=[]}C=b},3580:(s,E)=>{"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.DEFAULT_BREEZE_ENDPOINT="https://dc.services.visualstudio.com",E.DEFAULT_LIVEMETRICS_ENDPOINT="https://rt.services.visualstudio.com",E.DEFAULT_LIVEMETRICS_HOST="rt.services.visualstudio.com";var g;(function(T){T.COMMITTED_BYTES="\\Memory\\Committed Bytes",T.PROCESSOR_TIME="\\Processor(_Total)\\% Processor Time",T.REQUEST_RATE="\\ApplicationInsights\\Requests/Sec",T.REQUEST_FAILURE_RATE="\\ApplicationInsights\\Requests Failed/Sec",T.REQUEST_DURATION="\\ApplicationInsights\\Request Duration",T.DEPENDENCY_RATE="\\ApplicationInsights\\Dependency Calls/Sec",T.DEPENDENCY_FAILURE_RATE="\\ApplicationInsights\\Dependency Calls Failed/Sec",T.DEPENDENCY_DURATION="\\ApplicationInsights\\Dependency Call Duration",T.EXCEPTION_RATE="\\ApplicationInsights\\Exceptions/Sec"})(g=E.QuickPulseCounter||(E.QuickPulseCounter={}));var C;(function(T){T.PRIVATE_BYTES="\\Process(??APP_WIN32_PROC??)\\Private Bytes",T.AVAILABLE_BYTES="\\Memory\\Available Bytes",T.PROCESSOR_TIME="\\Processor(_Total)\\% Processor Time",T.PROCESS_TIME="\\Process(??APP_WIN32_PROC??)\\% Processor Time",T.REQUEST_RATE="\\ASP.NET Applications(??APP_W3SVC_PROC??)\\Requests/Sec",T.REQUEST_DURATION="\\ASP.NET Applications(??APP_W3SVC_PROC??)\\Request Execution Time"})(C=E.PerformanceCounter||(E.PerformanceCounter={})),E.PerformanceToQuickPulseCounter=(x={},x[C.PROCESSOR_TIME]=g.PROCESSOR_TIME,x[C.REQUEST_RATE]=g.REQUEST_RATE,x[C.REQUEST_DURATION]=g.REQUEST_DURATION,x[g.COMMITTED_BYTES]=g.COMMITTED_BYTES,x[g.REQUEST_FAILURE_RATE]=g.REQUEST_FAILURE_RATE,x[g.DEPENDENCY_RATE]=g.DEPENDENCY_RATE,x[g.DEPENDENCY_FAILURE_RATE]=g.DEPENDENCY_FAILURE_RATE,x[g.DEPENDENCY_DURATION]=g.DEPENDENCY_DURATION,x[g.EXCEPTION_RATE]=g.EXCEPTION_RATE,x),E.QuickPulseDocumentType={Event:"Event",Exception:"Exception",Trace:"Trace",Metric:"Metric",Request:"Request",Dependency:"RemoteDependency",Availability:"Availability"},E.QuickPulseType={Event:"EventTelemetryDocument",Exception:"ExceptionTelemetryDocument",Trace:"TraceTelemetryDocument",Metric:"MetricTelemetryDocument",Request:"RequestTelemetryDocument",Dependency:"DependencyTelemetryDocument",Availability:"AvailabilityTelemetryDocument"},E.TelemetryTypeStringToQuickPulseType={EventData:E.QuickPulseType.Event,ExceptionData:E.QuickPulseType.Exception,MessageData:E.QuickPulseType.Trace,MetricData:E.QuickPulseType.Metric,RequestData:E.QuickPulseType.Request,RemoteDependencyData:E.QuickPulseType.Dependency,AvailabilityData:E.QuickPulseType.Availability},E.TelemetryTypeStringToQuickPulseDocumentType={EventData:E.QuickPulseDocumentType.Event,ExceptionData:E.QuickPulseDocumentType.Exception,MessageData:E.QuickPulseDocumentType.Trace,MetricData:E.QuickPulseDocumentType.Metric,RequestData:E.QuickPulseDocumentType.Request,RemoteDependencyData:E.QuickPulseDocumentType.Dependency,AvailabilityData:E.QuickPulseDocumentType.Availability};var x},9382:(s,E,g)=>{"use strict";Object.defineProperty(E,"__esModule",{value:!0});var C=g(9958),x=function(){function v(){}return v.TYPE_HTTP="Http",v.TYPE_AI="Http (tracked component)",v}();E.RemoteDependencyDataConstants=x;function T(v){return"properties"in v||v instanceof C.EventData||v instanceof C.ExceptionData||v instanceof C.MessageData||v instanceof C.MetricData||v instanceof C.PageViewData||v instanceof C.RemoteDependencyData||v instanceof C.RequestData}E.domainSupportsProperties=T},7220:function(s,E,g){"use strict";var C=this&&this.__extends||function(){var v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,d){u.__proto__=d}||function(u,d){for(var h in d)d.hasOwnProperty(h)&&(u[h]=d[h])};return function(u,d){v(u,d);function h(){this.constructor=u}u.prototype=d===null?Object.create(d):(h.prototype=d.prototype,new h)}}(),x=g(8934),T=function(v){C(u,v);function u(){var d=v.call(this)||this;return d.ver=2,d.properties={},d.measurements={},d}return u}(x);s.exports=T},4101:s=>{"use strict";var E=function(){function g(){}return g}();s.exports=E},9871:s=>{"use strict";var E=function(){function g(){this.applicationVersion="ai.application.ver",this.deviceId="ai.device.id",this.deviceLocale="ai.device.locale",this.deviceModel="ai.device.model",this.deviceOEMName="ai.device.oemName",this.deviceOSVersion="ai.device.osVersion",this.deviceType="ai.device.type",this.locationIp="ai.location.ip",this.operationId="ai.operation.id",this.operationName="ai.operation.name",this.operationParentId="ai.operation.parentId",this.operationSyntheticSource="ai.operation.syntheticSource",this.operationCorrelationVector="ai.operation.correlationVector",this.sessionId="ai.session.id",this.sessionIsFirst="ai.session.isFirst",this.userAccountId="ai.user.accountId",this.userId="ai.user.id",this.userAuthUserId="ai.user.authUserId",this.cloudRole="ai.cloud.role",this.cloudRoleInstance="ai.cloud.roleInstance",this.internalSdkVersion="ai.internal.sdkVersion",this.internalAgentVersion="ai.internal.agentVersion",this.internalNodeName="ai.internal.nodeName"}return g}();s.exports=E},320:function(s,E,g){"use strict";var C=this&&this.__extends||function(){var v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,d){u.__proto__=d}||function(u,d){for(var h in d)d.hasOwnProperty(h)&&(u[h]=d[h])};return function(u,d){v(u,d);function h(){this.constructor=u}u.prototype=d===null?Object.create(d):(h.prototype=d.prototype,new h)}}(),x=g(4101),T=function(v){C(u,v);function u(){return v.call(this)||this}return u}(x);s.exports=T},8602:(s,E,g)=>{"use strict";var C=g(495),x=function(){function T(){this.kind=C.Measurement}return T}();s.exports=x},495:s=>{"use strict";var E;(function(g){g[g.Measurement=0]="Measurement",g[g.Aggregation=1]="Aggregation"})(E||(E={})),s.exports=E},8934:s=>{"use strict";var E=function(){function g(){}return g}();s.exports=E},7300:s=>{"use strict";var E=function(){function g(){this.ver=1,this.sampleRate=100,this.tags={}}return g}();s.exports=E},4526:function(s,E,g){"use strict";var C=this&&this.__extends||function(){var v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,d){u.__proto__=d}||function(u,d){for(var h in d)d.hasOwnProperty(h)&&(u[h]=d[h])};return function(u,d){v(u,d);function h(){this.constructor=u}u.prototype=d===null?Object.create(d):(h.prototype=d.prototype,new h)}}(),x=g(8934),T=function(v){C(u,v);function u(){var d=v.call(this)||this;return d.ver=2,d.properties={},d.measurements={},d}return u}(x);s.exports=T},935:function(s,E,g){"use strict";var C=this&&this.__extends||function(){var v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,d){u.__proto__=d}||function(u,d){for(var h in d)d.hasOwnProperty(h)&&(u[h]=d[h])};return function(u,d){v(u,d);function h(){this.constructor=u}u.prototype=d===null?Object.create(d):(h.prototype=d.prototype,new h)}}(),x=g(8934),T=function(v){C(u,v);function u(){var d=v.call(this)||this;return d.ver=2,d.exceptions=[],d.properties={},d.measurements={},d}return u}(x);s.exports=T},8082:s=>{"use strict";var E=function(){function g(){this.hasFullStack=!0,this.parsedStack=[]}return g}();s.exports=E},901:function(s,E,g){"use strict";var C=this&&this.__extends||function(){var v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,d){u.__proto__=d}||function(u,d){for(var h in d)d.hasOwnProperty(h)&&(u[h]=d[h])};return function(u,d){v(u,d);function h(){this.constructor=u}u.prototype=d===null?Object.create(d):(h.prototype=d.prototype,new h)}}(),x=g(8934),T=function(v){C(u,v);function u(){var d=v.call(this)||this;return d.ver=2,d.properties={},d}return u}(x);s.exports=T},3092:function(s,E,g){"use strict";var C=this&&this.__extends||function(){var v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,d){u.__proto__=d}||function(u,d){for(var h in d)d.hasOwnProperty(h)&&(u[h]=d[h])};return function(u,d){v(u,d);function h(){this.constructor=u}u.prototype=d===null?Object.create(d):(h.prototype=d.prototype,new h)}}(),x=g(8934),T=function(v){C(u,v);function u(){var d=v.call(this)||this;return d.ver=2,d.metrics=[],d.properties={},d}return u}(x);s.exports=T},6279:function(s,E,g){"use strict";var C=this&&this.__extends||function(){var v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,d){u.__proto__=d}||function(u,d){for(var h in d)d.hasOwnProperty(h)&&(u[h]=d[h])};return function(u,d){v(u,d);function h(){this.constructor=u}u.prototype=d===null?Object.create(d):(h.prototype=d.prototype,new h)}}(),x=g(4526),T=function(v){C(u,v);function u(){var d=v.call(this)||this;return d.ver=2,d.properties={},d.measurements={},d}return u}(x);s.exports=T},6290:function(s,E,g){"use strict";var C=this&&this.__extends||function(){var v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,d){u.__proto__=d}||function(u,d){for(var h in d)d.hasOwnProperty(h)&&(u[h]=d[h])};return function(u,d){v(u,d);function h(){this.constructor=u}u.prototype=d===null?Object.create(d):(h.prototype=d.prototype,new h)}}(),x=g(8934),T=function(v){C(u,v);function u(){var d=v.call(this)||this;return d.ver=2,d.success=!0,d.properties={},d.measurements={},d}return u}(x);s.exports=T},7339:function(s,E,g){"use strict";var C=this&&this.__extends||function(){var v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,d){u.__proto__=d}||function(u,d){for(var h in d)d.hasOwnProperty(h)&&(u[h]=d[h])};return function(u,d){v(u,d);function h(){this.constructor=u}u.prototype=d===null?Object.create(d):(h.prototype=d.prototype,new h)}}(),x=g(8934),T=function(v){C(u,v);function u(){var d=v.call(this)||this;return d.ver=2,d.properties={},d.measurements={},d}return u}(x);s.exports=T},9697:s=>{"use strict";var E;(function(g){g[g.Verbose=0]="Verbose",g[g.Information=1]="Information",g[g.Warning=2]="Warning",g[g.Error=3]="Error",g[g.Critical=4]="Critical"})(E||(E={})),s.exports=E},6376:s=>{"use strict";var E=function(){function g(){}return g}();s.exports=E},9958:(s,E,g)=>{"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.AvailabilityData=g(7220),E.Base=g(4101),E.ContextTagKeys=g(9871),E.Data=g(320),E.DataPoint=g(8602),E.DataPointType=g(495),E.Domain=g(8934),E.Envelope=g(7300),E.EventData=g(4526),E.ExceptionData=g(935),E.ExceptionDetails=g(8082),E.MessageData=g(901),E.MetricData=g(3092),E.PageViewData=g(6279),E.RemoteDependencyData=g(6290),E.RequestData=g(7339),E.SeverityLevel=g(9697),E.StackFrame=g(6376)},5481:(s,E)=>{"use strict";Object.defineProperty(E,"__esModule",{value:!0});function g(T){switch(T){case x.Event:return"EventData";case x.Exception:return"ExceptionData";case x.Trace:return"MessageData";case x.Metric:return"MetricData";case x.Request:return"RequestData";case x.Dependency:return"RemoteDependencyData";case x.Availability:return"AvailabilityData"}}E.telemetryTypeToBaseType=g;function C(T){switch(T){case"EventData":return x.Event;case"ExceptionData":return x.Exception;case"MessageData":return x.Trace;case"MetricData":return x.Metric;case"RequestData":return x.Request;case"RemoteDependencyData":return x.Dependency;case"AvailabilityData":return x.Availability}}E.baseTypeToTelemetryType=C,E.TelemetryTypeString={Event:"EventData",Exception:"ExceptionData",Trace:"MessageData",Metric:"MetricData",Request:"RequestData",Dependency:"RemoteDependencyData",Availability:"AvailabilityData"};var x;(function(T){T[T.Event=0]="Event",T[T.Exception=1]="Exception",T[T.Trace=2]="Trace",T[T.Metric=3]="Metric",T[T.Request=4]="Request",T[T.Dependency=5]="Dependency",T[T.Availability=6]="Availability"})(x=E.TelemetryType||(E.TelemetryType={}))},2626:(s,E,g)=>{"use strict";function C(x){for(var T in x)E.hasOwnProperty(T)||(E[T]=x[T])}Object.defineProperty(E,"__esModule",{value:!0}),C(g(5481))},5290:(s,E,g)=>{"use strict";function C(x){for(var T in x)E.hasOwnProperty(T)||(E[T]=x[T])}Object.defineProperty(E,"__esModule",{value:!0}),C(g(9382)),C(g(9958)),C(g(2626))},3504:(s,E,g)=>{"use strict";var C=g(5282),x=function(){function T(v,u,d,h){this._buffer=[],this._lastSend=0,this._isDisabled=v,this._getBatchSize=u,this._getBatchIntervalMs=d,this._sender=h}return T.prototype.setUseDiskRetryCaching=function(v,u,d){this._sender.setDiskRetryMode(v,u,d)},T.prototype.send=function(v){var u=this;if(!this._isDisabled()){if(!v){C.warn("Cannot send null/undefined telemetry");return}var d=this._stringify(v);if(typeof d=="string"){if(this._buffer.push(d),this._buffer.length>=this._getBatchSize()){this.triggerSend(!1);return}!this._timeoutHandle&&this._buffer.length>0&&(this._timeoutHandle=setTimeout(function(){u._timeoutHandle=null,u.triggerSend(!1)},this._getBatchIntervalMs()))}}},T.prototype.triggerSend=function(v,u){var d=this._buffer.length<1;if(!d){var h=this._buffer.join(`
`);v?(this._sender.saveOnCrash(h),typeof u=="function"&&u("data saved on crash")):this._sender.send(Buffer.from?Buffer.from(h):new Buffer(h),u)}this._lastSend=+new Date,this._buffer.length=0,clearTimeout(this._timeoutHandle),this._timeoutHandle=null,d&&typeof u=="function"&&u("no data to send")},T.prototype._stringify=function(v){try{return JSON.stringify(v)}catch(u){C.warn("Failed to serialize payload",u,v)}},T}();s.exports=x},9253:(s,E,g)=>{"use strict";var C=g(9962),x=g(5158),T=g(3580),v=g(8835),u=function(){function d(h){var b=this;this.endpointBase=T.DEFAULT_BREEZE_ENDPOINT;var m=process.env[d.ENV_connectionString],l=x.parse(h),f=x.parse(m),y=!l.instrumentationkey&&Object.keys(l).length>0?null:h;this.instrumentationKey=l.instrumentationkey||y||f.instrumentationkey||d._getInstrumentationKey(),this.endpointUrl=(l.ingestionendpoint||f.ingestionendpoint||this.endpointBase)+"/v2/track",this.maxBatchSize=250,this.maxBatchIntervalMs=15e3,this.disableAppInsights=!1,this.samplingPercentage=100,this.correlationIdRetryIntervalMs=30*1e3,this.correlationHeaderExcludedDomains=["*.core.windows.net","*.core.chinacloudapi.cn","*.core.cloudapi.de","*.core.usgovcloudapi.net","*.core.microsoft.scloud","*.core.eaglex.ic.gov"],this.setCorrelationId=function(_){return b.correlationId=_},this.proxyHttpUrl=process.env[d.ENV_http_proxy]||void 0,this.proxyHttpsUrl=process.env[d.ENV_https_proxy]||void 0,this.httpAgent=void 0,this.httpsAgent=void 0,this.profileQueryEndpoint=l.ingestionendpoint||f.ingestionendpoint||process.env[d.ENV_profileQueryEndpoint]||this.endpointBase,this._quickPulseHost=l.liveendpoint||f.liveendpoint||process.env[d.ENV_quickPulseHost]||T.DEFAULT_LIVEMETRICS_HOST,this._quickPulseHost.match(/^https?:\/\//)&&(this._quickPulseHost=v.parse(this._quickPulseHost).host)}return Object.defineProperty(d.prototype,"profileQueryEndpoint",{get:function(){return this._profileQueryEndpoint},set:function(h){C.cancelCorrelationIdQuery(this,this.setCorrelationId),this._profileQueryEndpoint=h,this.correlationId=C.correlationIdPrefix,C.queryCorrelationId(this,this.setCorrelationId)},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"quickPulseHost",{get:function(){return this._quickPulseHost},set:function(h){this._quickPulseHost=h},enumerable:!0,configurable:!0}),d._getInstrumentationKey=function(){var h=process.env[d.ENV_iKey]||process.env[d.ENV_azurePrefix+d.ENV_iKey]||process.env[d.legacy_ENV_iKey]||process.env[d.ENV_azurePrefix+d.legacy_ENV_iKey];if(!h||h=="")throw new Error("Instrumentation key not found, pass the key in the config to this method or set the key in the environment variable APPINSIGHTS_INSTRUMENTATIONKEY before starting the server");return h},d.ENV_azurePrefix="APPSETTING_",d.ENV_iKey="APPINSIGHTS_INSTRUMENTATIONKEY",d.legacy_ENV_iKey="APPINSIGHTS_INSTRUMENTATION_KEY",d.ENV_profileQueryEndpoint="APPINSIGHTS_PROFILE_QUERY_ENDPOINT",d.ENV_quickPulseHost="APPINSIGHTS_QUICKPULSE_HOST",d.ENV_connectionString="APPLICATIONINSIGHTS_CONNECTION_STRING",d.ENV_nativeMetricsDisablers="APPLICATION_INSIGHTS_DISABLE_EXTENDED_METRIC",d.ENV_nativeMetricsDisableAll="APPLICATION_INSIGHTS_DISABLE_ALL_EXTENDED_METRICS",d.ENV_http_proxy="http_proxy",d.ENV_https_proxy="https_proxy",d}();s.exports=u},5158:(s,E,g)=>{"use strict";var C=g(3580),x=function(){function T(){}return T.parse=function(v){if(!v)return{};var u=v.split(T._FIELDS_SEPARATOR),d=u.reduce(function(b,m){var l=m.split(T._FIELD_KEY_VALUE_SEPARATOR);if(l.length===2){var f=l[0].toLowerCase(),y=l[1];b[f]=y}return b},{});if(Object.keys(d).length>0){if(d.endpointsuffix){var h=d.location?d.location+".":"";d.ingestionendpoint=d.ingestionendpoint||"https://"+h+"dc."+d.endpointsuffix,d.liveendpoint=d.liveendpoint||"https://"+h+"live."+d.endpointsuffix}d.ingestionendpoint=d.ingestionendpoint||C.DEFAULT_BREEZE_ENDPOINT,d.liveendpoint=d.liveendpoint||C.DEFAULT_LIVEMETRICS_ENDPOINT}return d},T._FIELDS_SEPARATOR=";",T._FIELD_KEY_VALUE_SEPARATOR="=",T}();s.exports=x},4470:(s,E,g)=>{"use strict";var C=g(2087),x=g(5747),T=g(5622),v=g(5290),u=g(5282),d=function(){function h(b){this.keys=new v.ContextTagKeys,this.tags={},this._loadApplicationContext(),this._loadDeviceContext(),this._loadInternalContext()}return h.prototype._loadApplicationContext=function(b){if(b=b||T.resolve(__dirname,"../../../../package.json"),!h.appVersion[b]){h.appVersion[b]="unknown";try{var m=JSON.parse(x.readFileSync(b,"utf8"));m&&typeof m.version=="string"&&(h.appVersion[b]=m.version)}catch(l){u.info("unable to read app version: ",l)}}this.tags[this.keys.applicationVersion]=h.appVersion[b]},h.prototype._loadDeviceContext=function(){this.tags[this.keys.deviceId]="",this.tags[this.keys.cloudRoleInstance]=C&&C.hostname(),this.tags[this.keys.deviceOSVersion]=C&&C.type()+" "+C.release(),this.tags[this.keys.cloudRole]=h.DefaultRoleName,this.tags["ai.device.osArchitecture"]=C&&C.arch(),this.tags["ai.device.osPlatform"]=C&&C.platform()},h.prototype._loadInternalContext=function(){var b=T.resolve(__dirname,"../../package.json");if(!h.sdkVersion){h.sdkVersion="unknown";try{var m=JSON.parse(x.readFileSync(b,"utf8"));m&&typeof m.version=="string"&&(h.sdkVersion=m.version)}catch(l){u.info("unable to read app version: ",l)}}this.tags[this.keys.internalSdkVersion]="node:"+h.sdkVersion},h.DefaultRoleName="Web",h.appVersion={},h.sdkVersion=null,h}();s.exports=d},9962:(s,E,g)=>{"use strict";var C=g(5740),x=g(5282),T=function(){function v(){}return v.queryCorrelationId=function(u,d){var h=u.profileQueryEndpoint+"/api/profiles/"+u.instrumentationKey+"/appId";if(v.completedLookups.hasOwnProperty(h)){d(v.completedLookups[h]);return}else if(v.pendingLookups[h]){v.pendingLookups[h].push(d);return}v.pendingLookups[h]=[d];var b=function(){if(!!v.pendingLookups[h]){var m={method:"GET",disableAppInsightsAutoCollection:!0};x.info(v.TAG,m);var l=C.makeRequest(u,h,m,function(f){if(f.statusCode===200){var y="";f.setEncoding("utf-8"),f.on("data",function(_){y+=_}),f.on("end",function(){x.info(v.TAG,y);var _=v.correlationIdPrefix+y;v.completedLookups[h]=_,v.pendingLookups[h]&&v.pendingLookups[h].forEach(function(R){return R(_)}),delete v.pendingLookups[h]})}else f.statusCode>=400&&f.statusCode<500?(v.completedLookups[h]=void 0,delete v.pendingLookups[h]):setTimeout(b,u.correlationIdRetryIntervalMs)});l&&(l.on("error",function(f){x.warn(v.TAG,f)}),l.end())}};setTimeout(b,0)},v.cancelCorrelationIdQuery=function(u,d){var h=u.profileQueryEndpoint+"/api/profiles/"+u.instrumentationKey+"/appId",b=v.pendingLookups[h];b&&(v.pendingLookups[h]=b.filter(function(m){return m!=d}),v.pendingLookups[h].length==0&&delete v.pendingLookups[h])},v.generateRequestId=function(u){if(u){u=u[0]=="|"?u:"|"+u,u[u.length-1]!=="."&&(u+=".");var d=(v.currentRootId++).toString(16);return v.appendSuffix(u,d,"_")}else return v.generateRootId()},v.getRootId=function(u){var d=u.indexOf(".");d<0&&(d=u.length);var h=u[0]==="|"?1:0;return u.substring(h,d)},v.generateRootId=function(){return"|"+C.w3cTraceId()+"."},v.appendSuffix=function(u,d,h){if(u.length+d.length<v.requestIdMaxLength)return u+d+h;var b=v.requestIdMaxLength-9;if(u.length>b)for(;b>1;--b){var m=u[b-1];if(m==="."||m==="_")break}if(b<=1)return v.generateRootId();for(d=C.randomu32().toString(16);d.length<8;)d="0"+d;return u.substring(0,b)+d+"#"},v.TAG="CorrelationIdManager",v.correlationIdPrefix="cid-v1:",v.w3cEnabled=!1,v.pendingLookups={},v.completedLookups={},v.requestIdMaxLength=1024,v.currentRootId=C.randomu32(),v}();s.exports=T},9813:(s,E,g)=>{"use strict";var C=g(5290),x=g(5740),T=g(894),v=function(){function d(){}return d.createEnvelope=function(h,b,m,l,f){var y=null;switch(b){case C.TelemetryType.Trace:y=d.createTraceData(h);break;case C.TelemetryType.Dependency:y=d.createDependencyData(h);break;case C.TelemetryType.Event:y=d.createEventData(h);break;case C.TelemetryType.Exception:y=d.createExceptionData(h);break;case C.TelemetryType.Request:y=d.createRequestData(h);break;case C.TelemetryType.Metric:y=d.createMetricData(h);break;case C.TelemetryType.Availability:y=d.createAvailabilityData(h);break}if(m&&C.domainSupportsProperties(y.baseData)){if(y&&y.baseData)if(!y.baseData.properties)y.baseData.properties=m;else for(var _ in m)y.baseData.properties[_]||(y.baseData.properties[_]=m[_]);y.baseData.properties=x.validateStringMap(y.baseData.properties)}var R=f&&f.instrumentationKey||"",D=new C.Envelope;return D.data=y,D.iKey=R,D.name="Microsoft.ApplicationInsights."+R.replace(/-/g,"")+"."+y.baseType.substr(0,y.baseType.length-4),D.tags=this.getTags(l,h.tagOverrides),D.time=new Date().toISOString(),D.ver=1,D.sampleRate=f?f.samplingPercentage:100,b===C.TelemetryType.Metric&&(D.sampleRate=100),D},d.createTraceData=function(h){var b=new C.MessageData;b.message=h.message,b.properties=h.properties,isNaN(h.severity)?b.severityLevel=C.SeverityLevel.Information:b.severityLevel=h.severity;var m=new C.Data;return m.baseType=C.telemetryTypeToBaseType(C.TelemetryType.Trace),m.baseData=b,m},d.createDependencyData=function(h){var b=new C.RemoteDependencyData;typeof h.name=="string"&&(b.name=h.name.length>1024?h.name.slice(0,1021)+"...":h.name),b.data=h.data,b.target=h.target,b.duration=x.msToTimeSpan(h.duration),b.success=h.success,b.type=h.dependencyTypeName,b.properties=h.properties,b.resultCode=h.resultCode?h.resultCode+"":"",h.id?b.id=h.id:b.id=x.w3cTraceId();var m=new C.Data;return m.baseType=C.telemetryTypeToBaseType(C.TelemetryType.Dependency),m.baseData=b,m},d.createEventData=function(h){var b=new C.EventData;b.name=h.name,b.properties=h.properties,b.measurements=h.measurements;var m=new C.Data;return m.baseType=C.telemetryTypeToBaseType(C.TelemetryType.Event),m.baseData=b,m},d.createExceptionData=function(h){var b=new C.ExceptionData;b.properties=h.properties,isNaN(h.severity)?b.severityLevel=C.SeverityLevel.Error:b.severityLevel=h.severity,b.measurements=h.measurements,b.exceptions=[];var m=h.exception.stack,l=new C.ExceptionDetails;l.message=h.exception.message,l.typeName=h.exception.name,l.parsedStack=this.parseStack(m),l.hasFullStack=x.isArray(l.parsedStack)&&l.parsedStack.length>0,b.exceptions.push(l);var f=new C.Data;return f.baseType=C.telemetryTypeToBaseType(C.TelemetryType.Exception),f.baseData=b,f},d.createRequestData=function(h){var b=new C.RequestData;h.id?b.id=h.id:b.id=x.w3cTraceId(),b.name=h.name,b.url=h.url,b.source=h.source,b.duration=x.msToTimeSpan(h.duration),b.responseCode=h.resultCode?h.resultCode+"":"",b.success=h.success,b.properties=h.properties;var m=new C.Data;return m.baseType=C.telemetryTypeToBaseType(C.TelemetryType.Request),m.baseData=b,m},d.createMetricData=function(h){var b=new C.MetricData;b.metrics=[];var m=new C.DataPoint;m.count=isNaN(h.count)?1:h.count,m.kind=C.DataPointType.Aggregation,m.max=isNaN(h.max)?h.value:h.max,m.min=isNaN(h.min)?h.value:h.min,m.name=h.name,m.stdDev=isNaN(h.stdDev)?0:h.stdDev,m.value=h.value,b.metrics.push(m),b.properties=h.properties;var l=new C.Data;return l.baseType=C.telemetryTypeToBaseType(C.TelemetryType.Metric),l.baseData=b,l},d.createAvailabilityData=function(h){var b=new C.AvailabilityData;h.id?b.id=h.id:b.id=x.w3cTraceId(),b.name=h.name,b.duration=x.msToTimeSpan(h.duration),b.success=h.success,b.runLocation=h.runLocation,b.message=h.message,b.measurements=h.measurements,b.properties=h.properties;var m=new C.Data;return m.baseType=C.telemetryTypeToBaseType(C.TelemetryType.Availability),m.baseData=b,m},d.getTags=function(h,b){var m=T.CorrelationContextManager.getCurrentContext(),l={};if(h&&h.tags)for(var f in h.tags)l[f]=h.tags[f];if(b)for(var f in b)l[f]=b[f];return m&&(l[h.keys.operationId]=l[h.keys.operationId]||m.operation.id,l[h.keys.operationName]=l[h.keys.operationName]||m.operation.name,l[h.keys.operationParentId]=l[h.keys.operationParentId]||m.operation.parentId),l},d.parseStack=function(h){var b=void 0;if(typeof h=="string"){var m=h.split(`
`);b=[];for(var l=0,f=0,y=0;y<=m.length;y++){var _=m[y];if(u.regex.test(_)){var R=new u(m[y],l++);f+=R.sizeInBytes,b.push(R)}}var D=32*1024;if(f>D)for(var A=0,F=b.length-1,H=0,L=A,M=F;A<F;){var O=b[A].sizeInBytes,U=b[F].sizeInBytes;if(H+=O+U,H>D){var W=M-L+1;b.splice(L,W);break}L=A,M=F,A++,F--}}return b},d}(),u=function(){function d(h,b){this.sizeInBytes=0,this.level=b,this.method="<no_method>",this.assembly=x.trim(h);var m=h.match(d.regex);m&&m.length>=5&&(this.method=x.trim(m[2])||this.method,this.fileName=x.trim(m[4])||"<no_filename>",this.line=parseInt(m[5])||0),this.sizeInBytes+=this.method.length,this.sizeInBytes+=this.fileName.length,this.sizeInBytes+=this.assembly.length,this.sizeInBytes+=d.baseSize,this.sizeInBytes+=this.level.toString().length,this.sizeInBytes+=this.line.toString().length}return d.regex=/^([\s]+at)?(.*?)(\@|\s\(|\s)([^\(\@\n]+):([0-9]+):([0-9]+)(\)?)$/,d.baseSize=58,d}();s.exports=v},5282:s=>{"use strict";var E=function(){function g(){}return g.info=function(C){for(var x=[],T=1;T<arguments.length;T++)x[T-1]=arguments[T];g.enableDebug&&console.info(g.TAG+C,x)},g.warn=function(C){for(var x=[],T=1;T<arguments.length;T++)x[T-1]=arguments[T];g.disableWarnings||console.warn(g.TAG+C,x)},g.enableDebug=!1,g.disableWarnings=!1,g.disableErrors=!1,g.TAG="ApplicationInsights:",g}();s.exports=E},1259:function(s,E,g){"use strict";var C=this&&this.__extends||function(){var h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,m){b.__proto__=m}||function(b,m){for(var l in m)m.hasOwnProperty(l)&&(b[l]=m[l])};return function(b,m){h(b,m);function l(){this.constructor=b}b.prototype=m===null?Object.create(m):(l.prototype=m.prototype,new l)}}(),x=g(7625),T=g(731),v=g(8723),u=g(5282),d=function(h){C(b,h);function b(){return h!==null&&h.apply(this,arguments)||this}return b.prototype.trackNodeHttpRequestSync=function(m){m&&m.request&&m.response&&m.duration?T.trackRequestSync(this,m):u.warn("trackNodeHttpRequestSync requires NodeHttpRequestTelemetry object with request, response and duration specified.")},b.prototype.trackNodeHttpRequest=function(m){(m.duration||m.error)&&u.warn("trackNodeHttpRequest will ignore supplied duration and error parameters. These values are collected from the request and response objects."),m&&m.request&&m.response?T.trackRequest(this,m):u.warn("trackNodeHttpRequest requires NodeHttpRequestTelemetry object with request and response specified.")},b.prototype.trackNodeHttpDependency=function(m){m&&m.request?v.trackRequest(this,m):u.warn("trackNodeHttpDependency requires NodeHttpDependencyTelemetry object with request specified.")},b}(x);s.exports=d},7148:function(s,E,g){"use strict";var C=this&&this.__assign||Object.assign||function(m){for(var l,f=1,y=arguments.length;f<y;f++){l=arguments[f];for(var _ in l)Object.prototype.hasOwnProperty.call(l,_)&&(m[_]=l[_])}return m},x=g(2087),T=g(5290),v=g(3580),u=g(5740),d=g(5282),h=u.w3cTraceId(),b=function(){function m(){}return m.createQuickPulseEnvelope=function(l,f,y,_){var R=x&&typeof x.hostname=="function"&&x.hostname()||"Unknown",D=_.tags&&_.keys&&_.keys.cloudRoleInstance&&_.tags[_.keys.cloudRoleInstance]||R,A={Documents:f.length>0?f:null,InstrumentationKey:y.instrumentationKey||"",Metrics:l.length>0?l:null,InvariantVersion:1,Timestamp:"/Date("+Date.now()+")/",Version:_.tags[_.keys.internalSdkVersion],StreamId:h,MachineName:R,Instance:D};return A},m.createQuickPulseMetric=function(l){var f;return f={Name:l.name,Value:l.value,Weight:l.count||1},f},m.telemetryEnvelopeToQuickPulseDocument=function(l){switch(l.data.baseType){case T.TelemetryTypeString.Event:return m.createQuickPulseEventDocument(l);case T.TelemetryTypeString.Exception:return m.createQuickPulseExceptionDocument(l);case T.TelemetryTypeString.Trace:return m.createQuickPulseTraceDocument(l);case T.TelemetryTypeString.Dependency:return m.createQuickPulseDependencyDocument(l);case T.TelemetryTypeString.Request:return m.createQuickPulseRequestDocument(l)}return null},m.createQuickPulseEventDocument=function(l){var f=m.createQuickPulseDocument(l),y=l.data.baseData.name,_=C({},f,{Name:y});return _},m.createQuickPulseTraceDocument=function(l){var f=m.createQuickPulseDocument(l),y=l.data.baseData.severityLevel||0,_=C({},f,{Message:l.data.baseData.message,SeverityLevel:T.SeverityLevel[y]});return _},m.createQuickPulseExceptionDocument=function(l){var f=m.createQuickPulseDocument(l),y=l.data.baseData.exceptions,_="",R="",D="";y&&y.length>0&&(y[0].parsedStack&&y[0].parsedStack.length>0?y[0].parsedStack.forEach(function(F){_+=F.assembly+`
`}):y[0].stack&&y[0].stack.length>0&&(_=y[0].stack),R=y[0].message,D=y[0].typeName);var A=C({},f,{Exception:_,ExceptionMessage:R,ExceptionType:D});return A},m.createQuickPulseRequestDocument=function(l){var f=m.createQuickPulseDocument(l),y=l.data.baseData,_=C({},f,{Name:y.name,Success:y.success,Duration:y.duration,ResponseCode:y.responseCode,OperationName:y.name});return _},m.createQuickPulseDependencyDocument=function(l){var f=m.createQuickPulseDocument(l),y=l.data.baseData,_=C({},f,{Name:y.name,Target:y.target,Success:y.success,Duration:y.duration,ResultCode:y.resultCode,CommandName:y.data,OperationName:f.OperationId,DependencyTypeName:y.type});return _},m.createQuickPulseDocument=function(l){var f,y,_,R;l.data.baseType?(y=v.TelemetryTypeStringToQuickPulseType[l.data.baseType],f=v.TelemetryTypeStringToQuickPulseDocumentType[l.data.baseType]):d.warn("Document type invalid; not sending live metric document",l.data.baseType),_=l.tags[m.keys.operationId],R=m.aggregateProperties(l);var D={DocumentType:f,__type:y,OperationId:_,Version:"1.0",Properties:R};return D},m.aggregateProperties=function(l){var f=[],y=l.data.baseData.measurements||{};for(var _ in y)if(y.hasOwnProperty(_)){var R=y[_],D={key:_,value:R};f.push(D)}var A=l.data.baseData.properties||{};for(var _ in A)if(A.hasOwnProperty(_)){var R=A[_],D={key:_,value:R};f.push(D)}return f},m.keys=new T.ContextTagKeys,m}();s.exports=b},9184:(s,E,g)=>{"use strict";var C=g(7211),x=g(8723),T=g(5282),v={method:"POST",time:"x-ms-qps-transmission-time",subscribed:"x-ms-qps-subscribed"},u=function(){function d(h){this._config=h,this._consecutiveErrors=0}return d.prototype.ping=function(h,b){this._submitData(h,b,"ping")},d.prototype.post=function(h,b){this._submitData([h],b,"post")},d.prototype._submitData=function(h,b,m){var l=this,f=JSON.stringify(h),y=(R={},R[x.disableCollectionRequestOption]=!0,R.host=this._config.quickPulseHost,R.method=v.method,R.path="/QuickPulseService.svc/"+m+"?ikey="+this._config.instrumentationKey,R.headers=(D={Expect:"100-continue"},D[v.time]=1e4*Date.now(),D["Content-Type"]="application/json",D["Content-Length"]=Buffer.byteLength(f),D),R),_=C.request(y,function(A){var F=A.headers[v.subscribed]==="true";l._consecutiveErrors=0,b(F,A)});_.on("error",function(A){l._consecutiveErrors++;var F="Transient error connecting to the Live Metrics endpoint. This packet will not appear in your Live Metrics Stream. Error:";l._consecutiveErrors%d.MAX_QPS_FAILURES_BEFORE_WARN==0?(F="Live Metrics endpoint could not be reached "+l._consecutiveErrors+" consecutive times. Most recent error:",T.warn(d.TAG,F,A)):T.info(d.TAG,F,A),b()}),_.write(f),_.end();var R,D},d.TAG="QuickPulseSender",d.MAX_QPS_FAILURES_BEFORE_WARN=25,d}();s.exports=u},3668:(s,E,g)=>{"use strict";var C=g(5282),x=g(9253),T=g(7148),v=g(9184),u=g(3580),d=g(4470),h=function(){function b(m,l){this._isCollectingData=!1,this._lastSuccessTime=Date.now(),this._lastSendSucceeded=!0,this._metrics={},this._documents=[],this._collectors=[],this.config=new x(m),this.context=l||new d,this._sender=new v(this.config),this._isEnabled=!1}return b.prototype.addCollector=function(m){this._collectors.push(m)},b.prototype.trackMetric=function(m){this._addMetric(m)},b.prototype.addDocument=function(m){var l=T.telemetryEnvelopeToQuickPulseDocument(m);l&&this._documents.push(l)},b.prototype.enable=function(m){m&&!this._isEnabled?(this._isEnabled=!0,this._goQuickPulse()):!m&&this._isEnabled&&(this._isEnabled=!1,clearTimeout(this._handle),this._handle=void 0)},b.prototype.enableCollectors=function(m){this._collectors.forEach(function(l){l.enable(m)})},b.prototype._addMetric=function(m){var l=m.value,f=m.count||1,y=u.PerformanceToQuickPulseCounter[m.name];y&&(this._metrics[y]?(this._metrics[y].Value=(this._metrics[y].Value*this._metrics[y].Weight+l*f)/(this._metrics[y].Weight+f),this._metrics[y].Weight+=f):(this._metrics[y]=T.createQuickPulseMetric(m),this._metrics[y].Name=y,this._metrics[y].Weight=1))},b.prototype._resetQuickPulseBuffer=function(){delete this._metrics,this._metrics={},this._documents.length=0},b.prototype._goQuickPulse=function(){var m=this,l=Object.keys(this._metrics).map(function(_){return m._metrics[_]}),f=T.createQuickPulseEnvelope(l,this._documents.slice(),this.config,this.context);this._resetQuickPulseBuffer(),this._isCollectingData?this._post(f):this._ping(f);var y=this._isCollectingData?b.POST_INTERVAL:b.PING_INTERVAL;this._isCollectingData&&Date.now()-this._lastSuccessTime>=b.MAX_POST_WAIT_TIME&&!this._lastSendSucceeded?(this._isCollectingData=!1,y=b.FALLBACK_INTERVAL):!this._isCollectingData&&Date.now()-this._lastSuccessTime>=b.MAX_PING_WAIT_TIME&&!this._lastSendSucceeded&&(y=b.FALLBACK_INTERVAL),this._lastSendSucceeded=null,this._handle=setTimeout(this._goQuickPulse.bind(this),y),this._handle.unref()},b.prototype._ping=function(m){this._sender.ping(m,this._quickPulseDone.bind(this))},b.prototype._post=function(m){this._sender.post(m,this._quickPulseDone.bind(this))},b.prototype._quickPulseDone=function(m,l){m!=null?(this._isCollectingData!==m&&(C.info("Live Metrics sending data",m),this.enableCollectors(m)),this._isCollectingData=m,l&&l.statusCode<300&&l.statusCode>=200?(this._lastSuccessTime=Date.now(),this._lastSendSucceeded=!0):this._lastSendSucceeded=!1):this._lastSendSucceeded=!1},b.MAX_POST_WAIT_TIME=2e4,b.MAX_PING_WAIT_TIME=6e4,b.FALLBACK_INTERVAL=6e4,b.PING_INTERVAL=5e3,b.POST_INTERVAL=1e3,b}();s.exports=h},9036:s=>{"use strict";s.exports={requestContextHeader:"request-context",requestContextSourceKey:"appId",requestContextTargetKey:"appId",requestIdHeader:"request-id",parentIdHeader:"x-ms-request-id",rootIdHeader:"x-ms-request-root-id",correlationContextHeader:"correlation-context",traceparentHeader:"traceparent",traceStateHeader:"tracestate"}},2588:(s,E,g)=>{"use strict";var C=g(5747),x=g(2087),T=g(5622),v=g(8761),u=g(3129),d=g(5282),h=g(8723),b=g(5740),m=function(){function l(f,y,_){if(this._config=f,this._onSuccess=y,this._onError=_,this._enableDiskRetryMode=!1,this._resendInterval=l.WAIT_BETWEEN_RESEND,this._maxBytesOnDisk=l.MAX_BYTES_ON_DISK,this._numConsecutiveFailures=0,!l.OS_PROVIDES_FILE_PROTECTION)if(l.USE_ICACLS){try{l.OS_PROVIDES_FILE_PROTECTION=C.existsSync(l.ICACLS_PATH)}catch(R){}l.OS_PROVIDES_FILE_PROTECTION||d.warn(l.TAG,"Could not find ICACLS in expected location! This is necessary to use disk retry mode on Windows.")}else l.OS_PROVIDES_FILE_PROTECTION=!0}return l.prototype.setDiskRetryMode=function(f,y,_){this._enableDiskRetryMode=l.OS_PROVIDES_FILE_PROTECTION&&f,typeof y=="number"&&y>=0&&(this._resendInterval=Math.floor(y)),typeof _=="number"&&_>=0&&(this._maxBytesOnDisk=Math.floor(_)),f&&!l.OS_PROVIDES_FILE_PROTECTION&&(this._enableDiskRetryMode=!1,d.warn(l.TAG,"Ignoring request to enable disk retry mode. Sufficient file protection capabilities were not detected."))},l.prototype.send=function(f,y){var _=this,R=this._config.endpointUrl,D={method:"POST",withCredentials:!1,headers:{"Content-Type":"application/x-json-stream"}};v.gzip(f,function(A,F){var H=F;A?(d.warn(A),H=f,D.headers["Content-Length"]=f.length.toString()):(D.headers["Content-Encoding"]="gzip",D.headers["Content-Length"]=F.length),d.info(l.TAG,D),D[h.disableCollectionRequestOption]=!0;var L=function(O){O.setEncoding("utf-8");var U="";O.on("data",function(W){U+=W}),O.on("end",function(){_._numConsecutiveFailures=0,d.info(l.TAG,U),typeof _._onSuccess=="function"&&_._onSuccess(U),typeof y=="function"&&y(U),_._enableDiskRetryMode&&(O.statusCode===200?setTimeout(function(){return _._sendFirstFileOnDisk()},_._resendInterval).unref():(O.statusCode===408||O.statusCode===429||O.statusCode===439||O.statusCode===500||O.statusCode===503)&&_._storeToDisk(f))})},M=b.makeRequest(_._config,R,D,L);M.on("error",function(O){if(_._numConsecutiveFailures++,!_._enableDiskRetryMode||_._numConsecutiveFailures>0&&_._numConsecutiveFailures%l.MAX_CONNECTION_FAILURES_BEFORE_WARN==0){var U="Ingestion endpoint could not be reached. This batch of telemetry items has been lost. Use Disk Retry Caching to enable resending of failed telemetry. Error:";_._enableDiskRetryMode&&(U="Ingestion endpoint could not be reached "+_._numConsecutiveFailures+" consecutive times. There may be resulting telemetry loss. Most recent error:"),d.warn(l.TAG,U,O)}else{var U="Transient failure to reach ingestion endpoint. This batch of telemetry items will be retried. Error:";d.info(l.TAG,U,O)}if(_._onErrorHelper(O),typeof y=="function"){var W="error sending telemetry";O&&typeof O.toString=="function"&&(W=O.toString()),y(W)}_._enableDiskRetryMode&&_._storeToDisk(f)}),M.write(H),M.end()})},l.prototype.saveOnCrash=function(f){this._enableDiskRetryMode&&this._storeToDiskSync(f)},l.prototype._runICACLS=function(f,y){var _=u.spawn(l.ICACLS_PATH,f,{windowsHide:!0});_.on("error",function(R){return y(R)}),_.on("close",function(R,D){return y(R===0?null:new Error("Setting ACL restrictions did not succeed (ICACLS returned code "+R+")"))})},l.prototype._runICACLSSync=function(f){if(u.spawnSync){var y=u.spawnSync(l.ICACLS_PATH,f,{windowsHide:!0});if(y.error)throw y.error;if(y.status!==0)throw new Error("Setting ACL restrictions did not succeed (ICACLS returned code "+y.status+")")}else throw new Error("Could not synchronously call ICACLS under current version of Node.js")},l.prototype._getACLIdentity=function(f){if(l.ACL_IDENTITY)return f(null,l.ACL_IDENTITY);var y=u.spawn(l.POWERSHELL_PATH,["-Command","[System.Security.Principal.WindowsIdentity]::GetCurrent().Name"],{windowsHide:!0,stdio:["ignore","pipe","pipe"]}),_="";y.stdout.on("data",function(R){return _+=R}),y.on("error",function(R){return f(R,null)}),y.on("close",function(R,D){return l.ACL_IDENTITY=_&&_.trim(),f(R===0?null:new Error("Getting ACL identity did not succeed (PS returned code "+R+")"),l.ACL_IDENTITY)})},l.prototype._getACLIdentitySync=function(){if(l.ACL_IDENTITY)return l.ACL_IDENTITY;if(u.spawnSync){var f=u.spawnSync(l.POWERSHELL_PATH,["-Command","[System.Security.Principal.WindowsIdentity]::GetCurrent().Name"],{windowsHide:!0,stdio:["ignore","pipe","pipe"]});if(f.error)throw f.error;if(f.status!==0)throw new Error("Getting ACL identity did not succeed (PS returned code "+f.status+")");return l.ACL_IDENTITY=f.stdout&&f.stdout.toString().trim(),l.ACL_IDENTITY}else throw new Error("Could not synchronously get ACL identity under current version of Node.js")},l.prototype._getACLArguments=function(f,y){return[f,"/grant","*S-1-5-32-544:(OI)(CI)F","/grant",y+":(OI)(CI)F","/inheritance:r"]},l.prototype._applyACLRules=function(f,y){var _=this;if(!l.USE_ICACLS)return y(null);if(l.ACLED_DIRECTORIES[f]===void 0)l.ACLED_DIRECTORIES[f]=!1,this._getACLIdentity(function(R,D){if(R)return l.ACLED_DIRECTORIES[f]=!1,y(R);_._runICACLS(_._getACLArguments(f,D),function(A){return l.ACLED_DIRECTORIES[f]=!A,y(A)})});else return y(l.ACLED_DIRECTORIES[f]?null:new Error("Setting ACL restrictions did not succeed (cached result)"))},l.prototype._applyACLRulesSync=function(f){if(l.USE_ICACLS){if(l.ACLED_DIRECTORIES[f]===void 0){this._runICACLSSync(this._getACLArguments(f,this._getACLIdentitySync())),l.ACLED_DIRECTORIES[f]=!0;return}else if(!l.ACLED_DIRECTORIES[f])throw new Error("Setting ACL restrictions did not succeed (cached result)")}},l.prototype._confirmDirExists=function(f,y){var _=this;C.lstat(f,function(R,D){R&&R.code==="ENOENT"?C.mkdir(f,function(A){A&&A.code!=="EEXIST"?y(A):_._applyACLRules(f,y)}):!R&&D.isDirectory()?_._applyACLRules(f,y):y(R||new Error("Path existed but was not a directory"))})},l.prototype._getShallowDirectorySize=function(f,y){C.readdir(f,function(_,R){if(_)return y(_,-1);var D=null,A=0,F=0;if(R.length===0){y(null,0);return}for(var H=0;H<R.length;H++)C.stat(T.join(f,R[H]),function(L,M){F++,L?D=L:M.isFile()&&(A+=M.size),F===R.length&&(D?y(D,-1):y(D,A))})})},l.prototype._getShallowDirectorySizeSync=function(f){for(var y=C.readdirSync(f),_=0,R=0;R<y.length;R++)_+=C.statSync(T.join(f,y[R])).size;return _},l.prototype._storeToDisk=function(f){var y=this,_=T.join(x.tmpdir(),l.TEMPDIR_PREFIX+this._config.instrumentationKey);d.info(l.TAG,"Checking existance of data storage directory: "+_),this._confirmDirExists(_,function(R){if(R){d.warn(l.TAG,"Error while checking/creating directory: "+(R&&R.message)),y._onErrorHelper(R);return}y._getShallowDirectorySize(_,function(D,A){if(D||A<0){d.warn(l.TAG,"Error while checking directory size: "+(D&&D.message)),y._onErrorHelper(D);return}else if(A>y._maxBytesOnDisk){d.warn(l.TAG,"Not saving data due to max size limit being met. Directory size in bytes is: "+A);return}var F=new Date().getTime()+".ai.json",H=T.join(_,F);d.info(l.TAG,"saving data to disk at: "+H),C.writeFile(H,f,{mode:384},function(L){return y._onErrorHelper(L)})})})},l.prototype._storeToDiskSync=function(f){var y=T.join(x.tmpdir(),l.TEMPDIR_PREFIX+this._config.instrumentationKey);try{d.info(l.TAG,"Checking existance of data storage directory: "+y),C.existsSync(y)||C.mkdirSync(y),this._applyACLRulesSync(y);var _=this._getShallowDirectorySizeSync(y);if(_>this._maxBytesOnDisk){d.info(l.TAG,"Not saving data due to max size limit being met. Directory size in bytes is: "+_);return}var R=new Date().getTime()+".ai.json",D=T.join(y,R);d.info(l.TAG,"saving data before crash to disk at: "+D),C.writeFileSync(D,f,{mode:384})}catch(A){d.warn(l.TAG,"Error while saving data to disk: "+(A&&A.message)),this._onErrorHelper(A)}},l.prototype._sendFirstFileOnDisk=function(){var f=this,y=T.join(x.tmpdir(),l.TEMPDIR_PREFIX+this._config.instrumentationKey);C.exists(y,function(_){_&&C.readdir(y,function(R,D){if(R)f._onErrorHelper(R);else if(D=D.filter(function(H){return T.basename(H).indexOf(".ai.json")>-1}),D.length>0){var A=D[0],F=T.join(y,A);C.readFile(F,function(H,L){H?f._onErrorHelper(H):C.unlink(F,function(M){M?f._onErrorHelper(M):f.send(L)})})}})})},l.prototype._onErrorHelper=function(f){typeof this._onError=="function"&&this._onError(f)},l.TAG="Sender",l.ICACLS_PATH=process.env.systemdrive+"/windows/system32/icacls.exe",l.POWERSHELL_PATH=process.env.systemdrive+"/windows/system32/windowspowershell/v1.0/powershell.exe",l.ACLED_DIRECTORIES={},l.ACL_IDENTITY=null,l.WAIT_BETWEEN_RESEND=60*1e3,l.MAX_BYTES_ON_DISK=50*1e3*1e3,l.MAX_CONNECTION_FAILURES_BEFORE_WARN=5,l.TEMPDIR_PREFIX="appInsights-node",l.OS_PROVIDES_FILE_PROTECTION=!1,l.USE_ICACLS=x.type()==="Windows_NT",l}();s.exports=m},7625:(s,E,g)=>{"use strict";var C=g(8835),x=g(9253),T=g(4470),v=g(5290),u=g(3504),d=g(9428),h=g(894),b=g(2588),m=g(5740),l=g(5282),f=g(9813),y=function(){function _(R){this._telemetryProcessors=[];var D=new x(R);this.config=D,this.context=new T,this.commonProperties={};var A=new b(this.config);this.channel=new u(function(){return D.disableAppInsights},function(){return D.maxBatchSize},function(){return D.maxBatchIntervalMs},A)}return _.prototype.trackAvailability=function(R){this.track(R,v.TelemetryType.Availability)},_.prototype.trackTrace=function(R){this.track(R,v.TelemetryType.Trace)},_.prototype.trackMetric=function(R){this.track(R,v.TelemetryType.Metric)},_.prototype.trackException=function(R){R&&R.exception&&!m.isError(R.exception)&&(R.exception=new Error(R.exception.toString())),this.track(R,v.TelemetryType.Exception)},_.prototype.trackEvent=function(R){this.track(R,v.TelemetryType.Event)},_.prototype.trackRequest=function(R){this.track(R,v.TelemetryType.Request)},_.prototype.trackDependency=function(R){R&&!R.target&&R.data&&(R.target=C.parse(R.data).host),this.track(R,v.TelemetryType.Dependency)},_.prototype.flush=function(R){this.channel.triggerSend(R?!!R.isAppCrashing:!1,R?R.callback:void 0)},_.prototype.track=function(R,D){if(R&&v.telemetryTypeToBaseType(D)){var A=f.createEnvelope(R,D,this.commonProperties,this.context,this.config);R.time&&(A.time=R.time.toISOString());var F=this.runTelemetryProcessors(A,R.contextObjects);F=F&&d.samplingTelemetryProcessor(A,{correlationContext:h.CorrelationContextManager.getCurrentContext()}),d.performanceMetricsTelemetryProcessor(A,this.quickPulseClient),F&&this.channel.send(A)}else l.warn("track() requires telemetry object and telemetryType to be specified.")},_.prototype.addTelemetryProcessor=function(R){this._telemetryProcessors.push(R)},_.prototype.clearTelemetryProcessors=function(){this._telemetryProcessors=[]},_.prototype.runTelemetryProcessors=function(R,D){var A=!0,F=this._telemetryProcessors.length;if(F===0)return A;D=D||{},D.correlationContext=h.CorrelationContextManager.getCurrentContext();for(var H=0;H<F;++H)try{var L=this._telemetryProcessors[H];if(L&&L.apply(null,[R,D])===!1){A=!1;break}}catch(M){A=!0,l.warn("One of telemetry processors failed, telemetry item will be sent.",M,R)}return A},_}();s.exports=y},8090:(s,E,g)=>{"use strict";var C=g(5740),x=g(9962),T=function(){function v(u,d){if(this.traceFlag=v.DEFAULT_TRACE_FLAG,this.version=v.DEFAULT_VERSION,u&&typeof u=="string")if(u.split(",").length>1)this.traceId=C.w3cTraceId(),this.spanId=C.w3cTraceId().substr(0,16);else{var h=u.trim().split("-"),b=h.length;b>=4?(this.version=h[0],this.traceId=h[1],this.spanId=h[2],this.traceFlag=h[3]):(this.traceId=C.w3cTraceId(),this.spanId=C.w3cTraceId().substr(0,16)),this.version.match(/^[0-9a-f]{2}$/g)||(this.version=v.DEFAULT_VERSION,this.traceId=C.w3cTraceId()),this.version==="00"&&b!==4&&(this.traceId=C.w3cTraceId(),this.spanId=C.w3cTraceId().substr(0,16)),this.version==="ff"&&(this.version=v.DEFAULT_VERSION,this.traceId=C.w3cTraceId(),this.spanId=C.w3cTraceId().substr(0,16)),this.version.match(/^0[0-9a-f]$/g)||(this.version=v.DEFAULT_VERSION),this.traceFlag.match(/^[0-9a-f]{2}$/g)||(this.traceFlag=v.DEFAULT_TRACE_FLAG,this.traceId=C.w3cTraceId()),v.isValidTraceId(this.traceId)||(this.traceId=C.w3cTraceId()),v.isValidSpanId(this.spanId)||(this.spanId=C.w3cTraceId().substr(0,16),this.traceId=C.w3cTraceId()),this.parentId=this.getBackCompatRequestId()}else if(d){this.parentId=d.slice();var m=x.getRootId(d);v.isValidTraceId(m)||(this.legacyRootId=m,m=C.w3cTraceId()),d.indexOf("|")!==-1&&(d=d.substring(1+d.substring(0,d.length-1).lastIndexOf("."),d.length-1)),this.traceId=m,this.spanId=d}else this.traceId=C.w3cTraceId(),this.spanId=C.w3cTraceId().substr(0,16)}return v.isValidTraceId=function(u){return u.match(/^[0-9a-f]{32}$/)&&u!=="00000000000000000000000000000000"},v.isValidSpanId=function(u){return u.match(/^[0-9a-f]{16}$/)&&u!=="0000000000000000"},v.prototype.getBackCompatRequestId=function(){return"|"+this.traceId+"."+this.spanId+"."},v.prototype.toString=function(){return this.version+"-"+this.traceId+"-"+this.spanId+"-"+this.traceFlag},v.prototype.updateSpanId=function(){this.spanId=C.w3cTraceId().substr(0,16)},v.DEFAULT_TRACE_FLAG="01",v.DEFAULT_VERSION="00",v}();s.exports=T},6333:s=>{"use strict";var E=function(){function g(C){this.fieldmap=[],!!C&&(this.fieldmap=this.parseHeader(C))}return g.prototype.toString=function(){var C=this.fieldmap;return!C||C.length==0?null:C.join(", ")},g.validateKeyChars=function(C){var x=C.split("@");if(x.length==2){var T=x[0].trim(),v=x[1].trim(),u=Boolean(T.match(/^[\ ]?[a-z0-9\*\-\_/]{1,241}$/)),d=Boolean(v.match(/^[\ ]?[a-z0-9\*\-\_/]{1,14}$/));return u&&d}else if(x.length==1)return Boolean(C.match(/^[\ ]?[a-z0-9\*\-\_/]{1,256}$/));return!1},g.prototype.parseHeader=function(C){var x=[],T={},v=C.split(",");if(v.length>32)return null;for(var u=0,d=v;u<d.length;u++){var h=d[u],b=h.trim();if(b.length!==0){var m=b.split("=");if(m.length!==2||!g.validateKeyChars(m[0])||T[m[0]])return null;T[m[0]]=!0,x.push(b)}}return x},g.strict=!0,g}();s.exports=E},5740:function(s,E,g){"use strict";var C=this&&this.__assign||Object.assign||function(m){for(var l,f=1,y=arguments.length;f<y;f++){l=arguments[f];for(var _ in l)Object.prototype.hasOwnProperty.call(l,_)&&(m[_]=l[_])}return m},x=g(8605),T=g(7211),v=g(8835),u=g(7619),d=g(5282),h=g(9036),b=function(){function m(){}return m.getCookie=function(l,f){var y="";if(l&&l.length&&typeof f=="string")for(var _=l+"=",R=f.split(";"),D=0;D<R.length;D++){var f=R[D];if(f=m.trim(f),f&&f.indexOf(_)===0){y=f.substring(_.length,R[D].length);break}}return y},m.trim=function(l){return typeof l=="string"?l.replace(/^\s+|\s+$/g,""):""},m.int32ArrayToBase64=function(l){var f=function(A,F){return String.fromCharCode(A>>F&255)},y=function(A){return f(A,24)+f(A,16)+f(A,8)+f(A,0)},_=l.map(y).join(""),R=Buffer.from?Buffer.from(_,"binary"):new Buffer(_,"binary"),D=R.toString("base64");return D.substr(0,D.indexOf("="))},m.random32=function(){return 4294967296*Math.random()|0},m.randomu32=function(){return m.random32()+2147483648},m.w3cTraceId=function(){for(var l=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],f="",y,_=0;_<4;_++)y=m.random32(),f+=l[y&15]+l[y>>4&15]+l[y>>8&15]+l[y>>12&15]+l[y>>16&15]+l[y>>20&15]+l[y>>24&15]+l[y>>28&15];var R=l[8+Math.random()*4|0];return f.substr(0,8)+f.substr(9,4)+"4"+f.substr(13,3)+R+f.substr(16,3)+f.substr(19,12)},m.isValidW3CId=function(l){return l.length===32&&l!=="00000000000000000000000000000000"},m.isArray=function(l){return Object.prototype.toString.call(l)==="[object Array]"},m.isError=function(l){return l instanceof Error},m.isPrimitive=function(l){var f=typeof l;return f==="string"||f==="number"||f==="boolean"},m.isDate=function(l){return Object.prototype.toString.call(l)==="[object Date]"},m.msToTimeSpan=function(l){(isNaN(l)||l<0)&&(l=0);var f=(l/1e3%60).toFixed(7).replace(/0{0,4}$/,""),y=""+Math.floor(l/(1e3*60))%60,_=""+Math.floor(l/(1e3*60*60))%24,R=Math.floor(l/(1e3*60*60*24));f=f.indexOf(".")<2?"0"+f:f,y=y.length<2?"0"+y:y,_=_.length<2?"0"+_:_;var D=R>0?R+".":"";return D+_+":"+y+":"+f},m.extractError=function(l){var f=l;return{message:l.message,code:f.code||f.id||""}},m.extractObject=function(l){return l instanceof Error?m.extractError(l):typeof l.toJSON=="function"?l.toJSON():l},m.validateStringMap=function(l){if(typeof l!="object"){d.info("Invalid properties dropped from payload");return}var f={};for(var y in l){var _="",R=l[y],D=typeof R;if(m.isPrimitive(R))_=R.toString();else if(R===null||D==="undefined")_="";else if(D==="function"){d.info("key: "+y+" was function; will not serialize");continue}else{var A=m.isArray(R)?R:m.extractObject(R);try{m.isPrimitive(A)?_=A:_=JSON.stringify(A)}catch(F){_=R.constructor.name.toString()+" (Error: "+F.message+")",d.info("key: "+y+", could not be serialized")}}f[y]=_.substring(0,m.MAX_PROPERTY_LENGTH)}return f},m.canIncludeCorrelationHeader=function(l,f){var y=l&&l.config&&l.config.correlationHeaderExcludedDomains;if(!y||y.length==0||!f)return!0;for(var _=0;_<y.length;_++){var R=new RegExp(y[_].replace(/\./g,".").replace(/\*/g,".*"));if(R.test(v.parse(f).hostname))return!1}return!0},m.getCorrelationContextTarget=function(l,f){var y=l.headers&&l.headers[h.requestContextHeader];if(y)for(var _=y.split(","),R=0;R<_.length;++R){var D=_[R].split("=");if(D.length==2&&D[0]==f)return D[1]}},m.makeRequest=function(l,f,y,_){f&&f.indexOf("//")===0&&(f="https:"+f);var R=v.parse(f),D=C({},y,{host:R.hostname,port:R.port,path:R.pathname}),A=void 0;if(R.protocol==="https:"&&(A=l.proxyHttpsUrl||void 0),R.protocol==="http:"&&(A=l.proxyHttpUrl||void 0),A){A.indexOf("//")===0&&(A="http:"+A);var F=v.parse(A);F.protocol==="https:"?(d.info("Proxies that use HTTPS are not supported"),A=void 0):D=C({},D,{host:F.hostname,port:F.port||"80",path:f,headers:C({},D.headers,{Host:R.hostname})})}var H=R.protocol==="https:"&&!A;return H&&l.httpsAgent!==void 0?D.agent=l.httpsAgent:!H&&l.httpAgent!==void 0?D.agent=l.httpAgent:H&&(D.agent=m.tlsRestrictedAgent),H?T.request(D,_):x.request(D,_)},m.safeIncludeCorrelationHeader=function(l,f,y){var _;if(typeof y=="string")_=y;else if(y instanceof Array)_=y.join(",");else if(y&&typeof y.toString=="function")try{_=y.toString()}catch(R){d.warn("Outgoing request-context header could not be read. Correlation of requests may be lost.",R,y)}_?m.addCorrelationIdHeaderFromString(l,f,_):f.setHeader(h.requestContextHeader,h.requestContextSourceKey+"="+l.config.correlationId)},m.addCorrelationIdHeaderFromString=function(l,f,y){var _=y.split(","),R=h.requestContextSourceKey+"=",D=_.some(function(A){return A.substring(0,R.length)===R});D||f.setHeader(h.requestContextHeader,y+","+h.requestContextSourceKey+"="+l.config.correlationId)},m.MAX_PROPERTY_LENGTH=8192,m.tlsRestrictedAgent=new T.Agent({secureOptions:u.SSL_OP_NO_SSLv2|u.SSL_OP_NO_SSLv3|u.SSL_OP_NO_TLSv1|u.SSL_OP_NO_TLSv1_1}),m}();s.exports=b},4127:(s,E,g)=>{"use strict";Object.defineProperty(E,"__esModule",{value:!0});var C=g(4350),x=g(5290);function T(v,u){switch(u&&u.addDocument(v),v.data.baseType){case x.TelemetryTypeString.Exception:C.countException();break;case x.TelemetryTypeString.Request:var d=v.data.baseData;C.countRequest(d.duration,d.success);break;case x.TelemetryTypeString.Dependency:var h=v.data.baseData;C.countDependency(h.duration,h.success);break}return!0}E.performanceMetricsTelemetryProcessor=T},2037:(s,E,g)=>{"use strict";Object.defineProperty(E,"__esModule",{value:!0});var C=g(5290);function x(v,u){var d=v.sampleRate,h=!1;return d==null||d>=100||v.data&&C.TelemetryType.Metric===C.baseTypeToTelemetryType(v.data.baseType)?!0:(u.correlationContext&&u.correlationContext.operation?h=T(u.correlationContext.operation.id)<d:h=Math.random()*100<d,h)}E.samplingTelemetryProcessor=x;function T(v){var u=-2147483648,d=2147483647,h=5381;if(!v)return 0;for(;v.length<8;)v=v+v;for(var b=0;b<v.length;b++)h=((h<<5)+h|0)+v.charCodeAt(b)|0;return h=h<=u?d:Math.abs(h),h/d*100}E.getSamplingHashCode=T},9428:(s,E,g)=>{"use strict";function C(x){for(var T in x)E.hasOwnProperty(T)||(E[T]=x[T])}Object.defineProperty(E,"__esModule",{value:!0}),C(g(2037)),C(g(4127))},9574:(s,E,g)=>{"use strict";Object.defineProperty(E,"__esModule",{value:!0});var C=g(894),x=g(6281),T=g(6639),v=g(4350),u=g(8723),d=g(731),h=g(9962),b=g(5282),m=g(3668),l=g(1629);E.TelemetryClient=g(1259),E.Contracts=g(5290);var f;(function(de){de[de.AI=0]="AI",de[de.AI_AND_W3C=1]="AI_AND_W3C"})(f=E.DistributedTracingModes||(E.DistributedTracingModes={}));var y=!0,_=!1,R=!0,D=!0,A=!0,F=!0,H=!0,L=!0,M,O=!1,U=!0,W,X=void 0,N=void 0,V,Y,J,oe,G,ie,le=!1,fe;function te(de){return E.defaultClient?b.info("The default client is already setup"):(E.defaultClient=new E.TelemetryClient(de),V=new x(E.defaultClient),Y=new T(E.defaultClient),J=new v(E.defaultClient),G=new d(E.defaultClient),ie=new u(E.defaultClient),oe||(oe=new l.AutoCollectNativePerformance(E.defaultClient))),E.defaultClient&&E.defaultClient.channel&&E.defaultClient.channel.setUseDiskRetryCaching(H,X,N),ge}E.setup=te;function ue(){return E.defaultClient?(le=!0,V.enable(y,_),Y.enable(R),J.enable(D),oe.enable(U,W),G.useAutoCorrelation(L,M),G.enable(A),ie.enable(F),E.liveMetricsClient&&O&&E.liveMetricsClient.enable(O)):b.warn("Start cannot be called before setup"),ge}E.start=ue;function ae(){return L?C.CorrelationContextManager.getCurrentContext():null}E.getCorrelationContext=ae;function ye(de){return C.CorrelationContextManager.wrapCallback(de)}E.wrapWithCorrelationContext=ye;var ge=function(){function de(){}return de.setDistributedTracingMode=function(_e){return h.w3cEnabled=_e===f.AI_AND_W3C,de},de.setAutoCollectConsole=function(_e,xe){return xe===void 0&&(xe=!1),y=_e,_=xe,le&&V.enable(_e,xe),de},de.setAutoCollectExceptions=function(_e){return R=_e,le&&Y.enable(_e),de},de.setAutoCollectPerformance=function(_e,xe){xe===void 0&&(xe=!0),D=_e;var Ae=l.AutoCollectNativePerformance.parseEnabled(xe);return U=Ae.isEnabled,W=Ae.disabledMetrics,le&&(J.enable(_e),oe.enable(Ae.isEnabled,Ae.disabledMetrics)),de},de.setAutoCollectRequests=function(_e){return A=_e,le&&G.enable(_e),de},de.setAutoCollectDependencies=function(_e){return F=_e,le&&ie.enable(_e),de},de.setAutoDependencyCorrelation=function(_e,xe){return L=_e,M=xe,le&&G.useAutoCorrelation(_e,xe),de},de.setUseDiskRetryCaching=function(_e,xe,Ae){return H=_e,X=xe,N=Ae,E.defaultClient&&E.defaultClient.channel&&E.defaultClient.channel.setUseDiskRetryCaching(_e,xe,Ae),de},de.setInternalLogging=function(_e,xe){return _e===void 0&&(_e=!1),xe===void 0&&(xe=!0),b.enableDebug=_e,b.disableWarnings=!xe,de},de.setSendLiveMetrics=function(_e){return _e===void 0&&(_e=!1),E.defaultClient?(!E.liveMetricsClient&&_e?(E.liveMetricsClient=new m(E.defaultClient.config.instrumentationKey),fe=new v(E.liveMetricsClient,1e3,!0),E.liveMetricsClient.addCollector(fe),E.defaultClient.quickPulseClient=E.liveMetricsClient):E.liveMetricsClient&&E.liveMetricsClient.enable(_e),O=_e,de):(b.warn("Live metrics client cannot be setup without the default client"),de)},de.start=ue,de}();E.Configuration=ge;function Ee(){E.defaultClient=null,le=!1,V&&V.dispose(),Y&&Y.dispose(),J&&J.dispose(),oe&&oe.dispose(),G&&G.dispose(),ie&&ie.dispose(),E.liveMetricsClient&&(E.liveMetricsClient.enable(!1),O=!1,E.liveMetricsClient=void 0)}E.dispose=Ee},9822:(s,E,g)=>{"use strict";const C=process.binding("async_wrap"),x=C.Providers.TIMERWRAP,T={nextTick:g(3269),promise:g(9565),timers:g(7190)},v=new Set;function u(){this.enabled=!1,this.counter=0}function d(){const m=this.initFns=[],l=this.preFns=[],f=this.postFns=[],y=this.destroyFns=[];this.init=function(_,R,D,A){if(R===x){v.add(_);return}for(const F of m)F(_,this,R,D,A)},this.pre=function(_){if(!v.has(_))for(const R of l)R(_,this)},this.post=function(_,R){if(!v.has(_))for(const D of f)D(_,this,R)},this.destroy=function(_){if(v.has(_)){v.delete(_);return}for(const R of y)R(_)}}d.prototype.add=function(m){m.init&&this.initFns.push(m.init),m.pre&&this.preFns.push(m.pre),m.post&&this.postFns.push(m.post),m.destroy&&this.destroyFns.push(m.destroy)};function h(m,l){const f=m.indexOf(l);f!==-1&&m.splice(f,1)}d.prototype.remove=function(m){m.init&&h(this.initFns,m.init),m.pre&&h(this.preFns,m.pre),m.post&&h(this.postFns,m.post),m.destroy&&h(this.destroyFns,m.destroy)};function b(){this._state=new u,this._hooks=new d,this.version=g(1910).i8,this.providers=C.Providers;for(const m of Object.keys(T))T[m].call(this);process.env.hasOwnProperty("NODE_ASYNC_HOOK_WARNING")&&console.warn("warning: you are using async-hook-jl which is unstable."),C.setupHooks({init:this._hooks.init,pre:this._hooks.pre,post:this._hooks.post,destroy:this._hooks.destroy})}s.exports=b,b.prototype.addHooks=function(m){this._hooks.add(m)},b.prototype.removeHooks=function(m){this._hooks.remove(m)},b.prototype.enable=function(){this._state.enabled=!0,C.enable()},b.prototype.disable=function(){this._state.enabled=!1,C.disable()}},3223:(s,E,g)=>{"use strict";const C=g(9822);if(global._asyncHook)if(global._asyncHook.version===g(1910).i8)s.exports=global._asyncHook;else throw new Error("Conflicting version of async-hook-jl found");else g(2512).filter.attach(function(T,v){return v.filter(function(u){const d=u.getFileName();return!(d&&d.slice(0,__dirname.length)===__dirname)})}),s.exports=global._asyncHook=new C},1910:s=>{"use strict";s.exports={i8:"1.7.6"}},3269:s=>{"use strict";function E(){}s.exports=function(){const C=this._hooks,x=this._state,T=process.nextTick;process.nextTick=function(){if(!x.enabled)return T.apply(process,arguments);const v=new Array(arguments.length);for(let b=0;b<arguments.length;b++)v[b]=arguments[b];const u=v[0];if(typeof u!="function")throw new TypeError("callback is not a function");const d=new E,h=--x.counter;return C.init.call(d,h,0,null,null),v[0]=function(){C.pre.call(d,h);let b=!0;try{u.apply(this,arguments),b=!1}finally{b&&process.listenerCount("uncaughtException")>0&&process.once("uncaughtException",function(){C.post.call(d,h,!0),C.destroy.call(null,h)})}C.post.call(d,h,!1),C.destroy.call(null,h)},T.apply(process,v)}}},9565:s=>{"use strict";function E(){}s.exports=function(){const C=this._hooks,x=this._state,T=global.Promise,v=T.prototype.then;T.prototype.then=b;function u(m,l,f,y){return typeof m!="function"?y?d(f):h(f):function(){C.pre.call(l,f);try{return m.apply(this,arguments)}finally{C.post.call(l,f,!1),C.destroy.call(null,f)}}}function d(m){return function(f){return C.destroy.call(null,m),f}}function h(m){return function(f){throw C.destroy.call(null,m),f}}function b(m,l){if(!x.enabled)return v.call(this,m,l);const f=new E,y=--x.counter;return C.init.call(f,y,0,null,null),v.call(this,u(m,f,y,!0),u(l,f,y,!1))}}},7190:(s,E,g)=>{"use strict";const C=g(8213);function x(){}function T(){}function v(){}const u=new Map,d=new Map,h=new Map;let b=null,m=!1;s.exports=function(){l(this._hooks,this._state,"setTimeout","clearTimeout",x,u,!0),l(this._hooks,this._state,"setInterval","clearInterval",T,d,!1),l(this._hooks,this._state,"setImmediate","clearImmediate",v,h,!0),global.setTimeout=C.setTimeout,global.setInterval=C.setInterval,global.setImmediate=C.setImmediate,global.clearTimeout=C.clearTimeout,global.clearInterval=C.clearInterval,global.clearImmediate=C.clearImmediate};function l(f,y,_,R,D,A,F){const H=C[_],L=C[R];C[_]=function(){if(!y.enabled)return H.apply(C,arguments);const M=new Array(arguments.length);for(let N=0;N<arguments.length;N++)M[N]=arguments[N];const O=M[0];if(typeof O!="function")throw new TypeError('"callback" argument must be a function');const U=new D,W=--y.counter;let X;return f.init.call(U,W,0,null,null),M[0]=function(){b=X,f.pre.call(U,W);let N=!0;try{O.apply(this,arguments),N=!1}finally{N&&process.listenerCount("uncaughtException")>0&&process.once("uncaughtException",function(){f.post.call(U,W,!0),A.delete(X),f.destroy.call(null,W)})}f.post.call(U,W,!1),b=null,(F||m)&&(m=!1,A.delete(X),f.destroy.call(null,W))},X=H.apply(C,M),A.set(X,W),X},C[R]=function(M){if(b===M&&M!==null)m=!0;else if(A.has(M)){const O=A.get(M);A.delete(M),f.destroy.call(null,O)}L.apply(C,arguments)}}},8286:s=>{"use strict";s.exports=(E,g)=>class extends E{constructor(x){var T,v;super(d);var u=this;try{x.apply(T,v)}catch(h){v[1](h)}return u;function d(h,b){T=this,v=[m,l];function m(f){return g(u,!1),h(f)}function l(f){return g(u,!1),b(f)}}}}},9090:(s,E,g)=>{var C=g(6372).wrap,x=1<<0,T=1<<1,v=1<<2,u=1<<3,d=[],h=0,b=!1,m=[],l,f;function y(U,W){var X=U.length,N=W.length,V=[];if(X===0&&N===0)return V;for(var Y=0;Y<X;Y++)V[Y]=U[Y];if(N===0)return V;for(var J=0;J<N;J++){var oe=!0;for(Y=0;Y<X;Y++)if(U[Y].uid===W[J].uid){oe=!1;break}oe&&V.push(W[J])}return V}if(process._fatalException){var _=!1,R;l=function(W){var X=d.length;if(_||X===0)return!1;var N=!1;_=!0;for(var V=0;V<X;++V){var Y=d[V];if((Y.flags&u)!=0){var J=R&&R[Y.uid];N=Y.error(J,W)||N}}return _=!1,m.length>0&&(d=m.pop()),R=void 0,N&&!b},f=function(W,X,N){var V=[];b=!0;for(var Y=0;Y<N;++Y){var J=X[Y];if(V[J.uid]=J.data,(J.flags&x)!=0){var oe=J.create(J.data);oe!==void 0&&(V[J.uid]=oe)}}return b=!1,function(){R=V,m.push(d),d=y(X,d),b=!0;for(var G=0;G<N;++G)(X[G].flags&T)>0&&X[G].before(this,V[X[G].uid]);b=!1;var ie=W.apply(this,arguments);for(b=!0,G=0;G<N;++G)(X[G].flags&v)>0&&X[G].after(this,V[X[G].uid]);return b=!1,d=m.pop(),R=void 0,ie}},C(process,"_fatalException",function(U){return function(X){return l(X)||U(X)}})}else{var D=!1;l=function(W){if(D)throw W;for(var X=!1,N=d.length,V=0;V<N;++V){var Y=d[V];(Y.flags&u)!=0&&(X=Y.error(null,W)||X)}if(!X&&b)throw W},f=function(W,X,N){var V=[];b=!0;for(var Y=0;Y<N;++Y){var J=X[Y];if(V[J.uid]=J.data,(J.flags&x)!=0){var oe=J.create(J.data);oe!==void 0&&(V[J.uid]=oe)}}return b=!1,function(){var G=!1,ie=!1;m.push(d),d=y(X,d),b=!0;for(var le=0;le<N;++le)(X[le].flags&T)>0&&X[le].before(this,V[X[le].uid]);b=!1;var fe;try{fe=W.apply(this,arguments)}catch(te){G=!0;for(var le=0;le<N;++le)if((d[le].flags&u)!=0)try{ie=d[le].error(V[X[le].uid],te)||ie}catch(ae){throw D=!0,ae}if(!ie)throw process.removeListener("uncaughtException",l),process._originalNextTick(function(){process.addListener("uncaughtException",l)}),te}finally{if(!G||ie){for(b=!0,le=0;le<N;++le)(X[le].flags&v)>0&&X[le].after(this,V[X[le].uid]);b=!1}d=m.pop()}return fe}},process.addListener("uncaughtException",l)}function A(U,W,X){b=!0;for(var N=0;N<X;++N){var V=W[N];V.create&&V.create(V.data)}return b=!1,function(){m.push(d),d=y(W,d);var Y=U.apply(this,arguments);return d=m.pop(),Y}}function F(U){var W=d.length;if(W===0)return U;for(var X=d.slice(),N=0;N<W;++N)if(X[N].flags>0)return f(U,X,W);return A(U,X,W)}function H(U,W){typeof U.create=="function"&&(this.create=U.create,this.flags|=x),typeof U.before=="function"&&(this.before=U.before,this.flags|=T),typeof U.after=="function"&&(this.after=U.after,this.flags|=v),typeof U.error=="function"&&(this.error=U.error,this.flags|=u),this.uid=++h,this.data=W===void 0?null:W}H.prototype.create=void 0,H.prototype.before=void 0,H.prototype.after=void 0,H.prototype.error=void 0,H.prototype.data=void 0,H.prototype.uid=0,H.prototype.flags=0;function L(U,W){if(typeof U!="object"||!U)throw new TypeError("callbacks argument must be an object");return U instanceof H?U:new H(U,W)}function M(U,W){var X;U instanceof H?X=U:X=L(U,W);for(var N=!1,V=0;V<d.length;V++)if(X===d[V]){N=!0;break}return N||d.push(X),X}function O(U){for(var W=0;W<d.length;W++)if(U===d[W]){d.splice(W,1);break}}process.createAsyncListener=L,process.addAsyncListener=M,process.removeAsyncListener=O,s.exports=F},7645:(s,E,g)=>{"use strict";if(process.addAsyncListener)throw new Error("Don't require polyfill unless needed");var C=g(6372),x=g(6625),T=C.wrap,v=C.massWrap,u=g(9090),d=g(1669),h=x.gte(process.version,"6.0.0"),b=x.gte(process.version,"7.0.0"),m=x.gte(process.version,"8.0.0"),l=x.gte(process.version,"11.0.0"),f=g(1631);b&&!f._normalizeArgs?f._normalizeArgs=function(te){if(te.length===0)return[{},null];var ue=te[0],ae={};typeof ue=="object"&&ue!==null?ae=ue:fe(ue)?ae.path=ue:(ae.port=ue,te.length>1&&typeof te[1]=="string"&&(ae.host=te[1]));var ye=te[te.length-1];return typeof ye!="function"?[ae,null]:[ae,ye]}:!b&&!f._normalizeConnectArgs&&(f._normalizeConnectArgs=function(te){var ue={};function ae(ge){return(ge=Number(ge))>=0?ge:!1}typeof te[0]=="object"&&te[0]!==null?ue=te[0]:typeof te[0]=="string"&&ae(te[0])===!1?ue.path=te[0]:(ue.port=te[0],typeof te[1]=="string"&&(ue.host=te[1]));var ye=te[te.length-1];return typeof ye=="function"?[ue,ye]:[ue]}),"_setUpListenHandle"in f.Server.prototype?T(f.Server.prototype,"_setUpListenHandle",y):T(f.Server.prototype,"_listen2",y);function y(te){return function(){this.on("connection",function(ue){ue._handle&&(ue._handle.onread=u(ue._handle.onread))});try{return te.apply(this,arguments)}finally{this._handle&&this._handle.onconnection&&(this._handle.onconnection=u(this._handle.onconnection))}}}function _(te){if(te&&te._handle){var ue=te._handle;ue._originalOnread||(ue._originalOnread=ue.onread),ue.onread=u(ue._originalOnread)}}T(f.Socket.prototype,"connect",function(te){return function(){var ue;m&&Array.isArray(arguments[0])&&Object.getOwnPropertySymbols(arguments[0]).length>0?ue=arguments[0]:ue=b?f._normalizeArgs(arguments):f._normalizeConnectArgs(arguments),ue[1]&&(ue[1]=u(ue[1]));var ae=te.apply(this,ue);return _(this),ae}});var R=g(8605);T(R.Agent.prototype,"addRequest",function(te){return function(ue){var ae=ue.onSocket;return ue.onSocket=u(function(ye){return _(ye),ae.apply(this,arguments)}),te.apply(this,arguments)}});var D=g(3129);function A(te){Array.isArray(te.stdio)&&te.stdio.forEach(function(ue){ue&&ue._handle&&(ue._handle.onread=u(ue._handle.onread),T(ue._handle,"close",ie))}),te._handle&&(te._handle.onexit=u(te._handle.onexit))}D.ChildProcess?T(D.ChildProcess.prototype,"spawn",function(te){return function(){var ue=te.apply(this,arguments);return A(this),ue}}):v(D,["execFile","fork","spawn"],function(te){return function(){var ue=te.apply(this,arguments);return A(ue),ue}}),process._fatalException||(process._originalNextTick=process.nextTick);var F=[];process._nextDomainTick&&F.push("_nextDomainTick"),process._tickDomainCallback&&F.push("_tickDomainCallback"),v(process,F,G),T(process,"nextTick",ie);var H=["setTimeout","setInterval"];global.setImmediate&&H.push("setImmediate");var L=g(8213),M=global.setTimeout===L.setTimeout;v(L,H,ie),M&&v(global,H,ie);var O=g(881);v(O,["lookup","resolve","resolve4","resolve6","resolveCname","resolveMx","resolveNs","resolveTxt","resolveSrv","reverse"],G),O.resolveNaptr&&T(O,"resolveNaptr",G);var U=g(5747);v(U,["watch","rename","truncate","chown","fchown","chmod","fchmod","stat","lstat","fstat","link","symlink","readlink","realpath","unlink","rmdir","mkdir","readdir","close","open","utimes","futimes","fsync","write","read","readFile","writeFile","appendFile","watchFile","unwatchFile","exists"],G),U.lchown&&T(U,"lchown",G),U.lchmod&&T(U,"lchmod",G),U.ftruncate&&T(U,"ftruncate",G);var W;try{W=g(8761)}catch(te){}if(W&&W.Deflate&&W.Deflate.prototype){var X=Object.getPrototypeOf(W.Deflate.prototype);X._transform?T(X,"_transform",G):X.write&&X.flush&&X.end&&v(X,["write","flush","end"],G)}var N;try{N=g(6417)}catch(te){}if(N){var V=["pbkdf2","randomBytes"];l||V.push("pseudoRandomBytes"),v(N,V,G)}var Y=!!global.Promise&&Promise.toString()==="function Promise() { [native code] }"&&Promise.toString.toString()==="function toString() { [native code] }";if(Y){var J=process.addAsyncListener({create:function(){Y=!1}});global.Promise.resolve(!0).then(function(){Y=!1}),process.removeAsyncListener(J)}Y&&oe();function oe(){var te=global.Promise;function ue(de){if(!(this instanceof ue))return te(de);if(typeof de!="function")return new te(de);var _e,xe,Ae=new te($e);Ae.__proto__=ue.prototype;try{de.apply(_e,xe)}catch(Ve){xe[1](Ve)}return Ae;function $e(Ve,Ue){_e=this,xe=[Le,Xe];function Le(Fe){return ye(Ae,!1),Ve(Fe)}function Xe(Fe){return ye(Ae,!1),Ue(Fe)}}}if(d.inherits(ue,te),T(te.prototype,"then",Ee),te.prototype.chain&&T(te.prototype,"chain",Ee),h)global.Promise=g(8286)(te,ye);else{var ae=["all","race","reject","resolve","accept","defer"];ae.forEach(function(de){typeof te[de]=="function"&&(ue[de]=te[de])}),global.Promise=ue}function ye(de,_e){(!de.__asl_wrapper||_e)&&(de.__asl_wrapper=u(ge))}function ge(de,_e,xe,Ae){var $e;try{return $e=_e.call(de,xe),{returnVal:$e,error:!1}}catch(Ve){return{errorVal:Ve,error:!0}}finally{$e instanceof te?Ae.__asl_wrapper=function(){var Ue=$e.__asl_wrapper||ge;return Ue.apply(this,arguments)}:ye(Ae,!0)}}function Ee(de){return function(){var xe=this,Ae=de.apply(xe,Array.prototype.map.call(arguments,$e));return Ae.__asl_wrapper=function(Ue,Le,Xe,Fe){return xe.__asl_wrapper?(xe.__asl_wrapper(Ue,function(){},null,Ae),Ae.__asl_wrapper(Ue,Le,Xe,Fe)):ge(Ue,Le,Xe,Fe)},Ae;function $e(Ve){return typeof Ve!="function"?Ve:u(function(Ue){var Le=(xe.__asl_wrapper||ge)(this,Ve,Ue,Ae);if(Le.error)throw Le.errorVal;return Le.returnVal})}}}}function G(te){var ue=function(){var ae,ye=arguments.length-1;if(typeof arguments[ye]=="function"){ae=Array(arguments.length);for(var ge=0;ge<arguments.length-1;ge++)ae[ge]=arguments[ge];ae[ye]=u(arguments[ye])}return te.apply(this,ae||arguments)};switch(te.length){case 1:return function(ae){return arguments.length!==1?ue.apply(this,arguments):(typeof ae=="function"&&(ae=u(ae)),te.call(this,ae))};case 2:return function(ae,ye){return arguments.length!==2?ue.apply(this,arguments):(typeof ye=="function"&&(ye=u(ye)),te.call(this,ae,ye))};case 3:return function(ae,ye,ge){return arguments.length!==3?ue.apply(this,arguments):(typeof ge=="function"&&(ge=u(ge)),te.call(this,ae,ye,ge))};case 4:return function(ae,ye,ge,Ee){return arguments.length!==4?ue.apply(this,arguments):(typeof Ee=="function"&&(Ee=u(Ee)),te.call(this,ae,ye,ge,Ee))};case 5:return function(ae,ye,ge,Ee,de){return arguments.length!==5?ue.apply(this,arguments):(typeof de=="function"&&(de=u(de)),te.call(this,ae,ye,ge,Ee,de))};case 6:return function(ae,ye,ge,Ee,de,_e){return arguments.length!==6?ue.apply(this,arguments):(typeof _e=="function"&&(_e=u(_e)),te.call(this,ae,ye,ge,Ee,de,_e))};default:return ue}}function ie(te){var ue=function(){var ae;if(typeof arguments[0]=="function"){ae=Array(arguments.length),ae[0]=u(arguments[0]);for(var ye=1;ye<arguments.length;ye++)ae[ye]=arguments[ye]}return te.apply(this,ae||arguments)};switch(te.length){case 1:return function(ae){return arguments.length!==1?ue.apply(this,arguments):(typeof ae=="function"&&(ae=u(ae)),te.call(this,ae))};case 2:return function(ae,ye){return arguments.length!==2?ue.apply(this,arguments):(typeof ae=="function"&&(ae=u(ae)),te.call(this,ae,ye))};case 3:return function(ae,ye,ge){return arguments.length!==3?ue.apply(this,arguments):(typeof ae=="function"&&(ae=u(ae)),te.call(this,ae,ye,ge))};case 4:return function(ae,ye,ge,Ee){return arguments.length!==4?ue.apply(this,arguments):(typeof ae=="function"&&(ae=u(ae)),te.call(this,ae,ye,ge,Ee))};case 5:return function(ae,ye,ge,Ee,de){return arguments.length!==5?ue.apply(this,arguments):(typeof ae=="function"&&(ae=u(ae)),te.call(this,ae,ye,ge,Ee,de))};case 6:return function(ae,ye,ge,Ee,de,_e){return arguments.length!==6?ue.apply(this,arguments):(typeof ae=="function"&&(ae=u(ae)),te.call(this,ae,ye,ge,Ee,de,_e))};default:return ue}}function le(te){return(te=Number(te))>=0?te:!1}function fe(te){return typeof te=="string"&&le(te)===!1}},9669:(s,E,g)=>{s.exports=g(1609)},7970:(s,E,g)=>{"use strict";var C=g(4867),x=g(6026),T=g(4097),v=g(5327),u=g(8605),d=g(7211),h=g(938).http,b=g(938).https,m=g(8835),l=g(8761),f=g(696),y=g(5061),_=g(481),R=/https:?/;function D(A,F,H){if(A.hostname=F.host,A.host=F.host,A.port=F.port,A.path=H,F.auth){var L=Buffer.from(F.auth.username+":"+F.auth.password,"utf8").toString("base64");A.headers["Proxy-Authorization"]="Basic "+L}A.beforeRedirect=function(O){O.headers.host=O.host,D(O,F,O.href)}}s.exports=function(F){return new Promise(function(L,M){var O=function(Fe){L(Fe)},U=function(Fe){M(Fe)},W=F.data,X=F.headers;if(!X["User-Agent"]&&!X["user-agent"]&&(X["User-Agent"]="axios/"+f.version),W&&!C.isStream(W)){if(!Buffer.isBuffer(W))if(C.isArrayBuffer(W))W=Buffer.from(new Uint8Array(W));else if(C.isString(W))W=Buffer.from(W,"utf-8");else return U(y("Data after transformation must be a string, an ArrayBuffer, a Buffer, or a Stream",F));X["Content-Length"]=W.length}var N=void 0;if(F.auth){var V=F.auth.username||"",Y=F.auth.password||"";N=V+":"+Y}var J=T(F.baseURL,F.url),oe=m.parse(J),G=oe.protocol||"http:";if(!N&&oe.auth){var ie=oe.auth.split(":"),le=ie[0]||"",fe=ie[1]||"";N=le+":"+fe}N&&delete X.Authorization;var te=R.test(G),ue=te?F.httpsAgent:F.httpAgent,ae={path:v(oe.path,F.params,F.paramsSerializer).replace(/^\?/,""),method:F.method.toUpperCase(),headers:X,agent:ue,agents:{http:F.httpAgent,https:F.httpsAgent},auth:N};F.socketPath?ae.socketPath=F.socketPath:(ae.hostname=oe.hostname,ae.port=oe.port);var ye=F.proxy;if(!ye&&ye!==!1){var ge=G.slice(0,-1)+"_proxy",Ee=process.env[ge]||process.env[ge.toUpperCase()];if(Ee){var de=m.parse(Ee),_e=process.env.no_proxy||process.env.NO_PROXY,xe=!0;if(_e){var Ae=_e.split(",").map(function(Fe){return Fe.trim()});xe=!Ae.some(function(Fe){return Fe?Fe==="*"||Fe[0]==="."&&oe.hostname.substr(oe.hostname.length-Fe.length)===Fe?!0:oe.hostname===Fe:!1})}if(xe&&(ye={host:de.hostname,port:de.port,protocol:de.protocol},de.auth)){var $e=de.auth.split(":");ye.auth={username:$e[0],password:$e[1]}}}}ye&&(ae.headers.host=oe.hostname+(oe.port?":"+oe.port:""),D(ae,ye,G+"//"+oe.hostname+(oe.port?":"+oe.port:"")+ae.path));var Ve,Ue=te&&(ye?R.test(ye.protocol):!0);F.transport?Ve=F.transport:F.maxRedirects===0?Ve=Ue?d:u:(F.maxRedirects&&(ae.maxRedirects=F.maxRedirects),Ve=Ue?b:h),F.maxBodyLength>-1&&(ae.maxBodyLength=F.maxBodyLength);var Le=Ve.request(ae,function(Fe){if(!Le.aborted){var ft=Fe,Ne=Fe.req||Le;if(Fe.statusCode!==204&&Ne.method!=="HEAD"&&F.decompress!==!1)switch(Fe.headers["content-encoding"]){case"gzip":case"compress":case"deflate":ft=ft.pipe(l.createUnzip()),delete Fe.headers["content-encoding"];break}var er={status:Fe.statusCode,statusText:Fe.statusMessage,headers:Fe.headers,config:F,request:Ne};if(F.responseType==="stream")er.data=ft,x(O,U,er);else{var tr=[];ft.on("data",function(ct){tr.push(ct),F.maxContentLength>-1&&Buffer.concat(tr).length>F.maxContentLength&&(ft.destroy(),U(y("maxContentLength size of "+F.maxContentLength+" exceeded",F,null,Ne)))}),ft.on("error",function(ct){Le.aborted||U(_(ct,F,null,Ne))}),ft.on("end",function(){var ct=Buffer.concat(tr);F.responseType!=="arraybuffer"&&(ct=ct.toString(F.responseEncoding),(!F.responseEncoding||F.responseEncoding==="utf8")&&(ct=C.stripBOM(ct))),er.data=ct,x(O,U,er)})}}});Le.on("error",function(Fe){Le.aborted&&Fe.code!=="ERR_FR_TOO_MANY_REDIRECTS"||U(_(Fe,F,null,Le))}),F.timeout&&Le.setTimeout(F.timeout,function(){Le.abort(),U(y("timeout of "+F.timeout+"ms exceeded",F,"ECONNABORTED",Le))}),F.cancelToken&&F.cancelToken.promise.then(function(Fe){Le.aborted||(Le.abort(),U(Fe))}),C.isStream(W)?W.on("error",function(Fe){U(_(Fe,F,null,Le))}).pipe(Le):Le.end(W)})}},5448:(s,E,g)=>{"use strict";var C=g(4867),x=g(6026),T=g(4372),v=g(5327),u=g(4097),d=g(4109),h=g(7985),b=g(5061);s.exports=function(l){return new Promise(function(y,_){var R=l.data,D=l.headers;C.isFormData(R)&&delete D["Content-Type"];var A=new XMLHttpRequest;if(l.auth){var F=l.auth.username||"",H=l.auth.password?unescape(encodeURIComponent(l.auth.password)):"";D.Authorization="Basic "+btoa(F+":"+H)}var L=u(l.baseURL,l.url);if(A.open(l.method.toUpperCase(),v(L,l.params,l.paramsSerializer),!0),A.timeout=l.timeout,A.onreadystatechange=function(){if(!(!A||A.readyState!==4)&&!(A.status===0&&!(A.responseURL&&A.responseURL.indexOf("file:")===0))){var U="getAllResponseHeaders"in A?d(A.getAllResponseHeaders()):null,W=!l.responseType||l.responseType==="text"?A.responseText:A.response,X={data:W,status:A.status,statusText:A.statusText,headers:U,config:l,request:A};x(y,_,X),A=null}},A.onabort=function(){!A||(_(b("Request aborted",l,"ECONNABORTED",A)),A=null)},A.onerror=function(){_(b("Network Error",l,null,A)),A=null},A.ontimeout=function(){var U="timeout of "+l.timeout+"ms exceeded";l.timeoutErrorMessage&&(U=l.timeoutErrorMessage),_(b(U,l,"ECONNABORTED",A)),A=null},C.isStandardBrowserEnv()){var M=(l.withCredentials||h(L))&&l.xsrfCookieName?T.read(l.xsrfCookieName):void 0;M&&(D[l.xsrfHeaderName]=M)}if("setRequestHeader"in A&&C.forEach(D,function(U,W){typeof R=="undefined"&&W.toLowerCase()==="content-type"?delete D[W]:A.setRequestHeader(W,U)}),C.isUndefined(l.withCredentials)||(A.withCredentials=!!l.withCredentials),l.responseType)try{A.responseType=l.responseType}catch(O){if(l.responseType!=="json")throw O}typeof l.onDownloadProgress=="function"&&A.addEventListener("progress",l.onDownloadProgress),typeof l.onUploadProgress=="function"&&A.upload&&A.upload.addEventListener("progress",l.onUploadProgress),l.cancelToken&&l.cancelToken.promise.then(function(U){!A||(A.abort(),_(U),A=null)}),R||(R=null),A.send(R)})}},1609:(s,E,g)=>{"use strict";var C=g(4867),x=g(1849),T=g(321),v=g(7185),u=g(5655);function d(b){var m=new T(b),l=x(T.prototype.request,m);return C.extend(l,T.prototype,m),C.extend(l,m),l}var h=d(u);h.Axios=T,h.create=function(m){return d(v(h.defaults,m))},h.Cancel=g(5263),h.CancelToken=g(4972),h.isCancel=g(6502),h.all=function(m){return Promise.all(m)},h.spread=g(8713),h.isAxiosError=g(6268),s.exports=h,s.exports.default=h},5263:s=>{"use strict";function E(g){this.message=g}E.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},E.prototype.__CANCEL__=!0,s.exports=E},4972:(s,E,g)=>{"use strict";var C=g(5263);function x(T){if(typeof T!="function")throw new TypeError("executor must be a function.");var v;this.promise=new Promise(function(h){v=h});var u=this;T(function(h){u.reason||(u.reason=new C(h),v(u.reason))})}x.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},x.source=function(){var v,u=new x(function(h){v=h});return{token:u,cancel:v}},s.exports=x},6502:s=>{"use strict";s.exports=function(g){return!!(g&&g.__CANCEL__)}},321:(s,E,g)=>{"use strict";var C=g(4867),x=g(5327),T=g(782),v=g(3572),u=g(7185);function d(h){this.defaults=h,this.interceptors={request:new T,response:new T}}d.prototype.request=function(b){typeof b=="string"?(b=arguments[1]||{},b.url=arguments[0]):b=b||{},b=u(this.defaults,b),b.method?b.method=b.method.toLowerCase():this.defaults.method?b.method=this.defaults.method.toLowerCase():b.method="get";var m=[v,void 0],l=Promise.resolve(b);for(this.interceptors.request.forEach(function(y){m.unshift(y.fulfilled,y.rejected)}),this.interceptors.response.forEach(function(y){m.push(y.fulfilled,y.rejected)});m.length;)l=l.then(m.shift(),m.shift());return l},d.prototype.getUri=function(b){return b=u(this.defaults,b),x(b.url,b.params,b.paramsSerializer).replace(/^\?/,"")},C.forEach(["delete","get","head","options"],function(b){d.prototype[b]=function(m,l){return this.request(u(l||{},{method:b,url:m,data:(l||{}).data}))}}),C.forEach(["post","put","patch"],function(b){d.prototype[b]=function(m,l,f){return this.request(u(f||{},{method:b,url:m,data:l}))}}),s.exports=d},782:(s,E,g)=>{"use strict";var C=g(4867);function x(){this.handlers=[]}x.prototype.use=function(v,u){return this.handlers.push({fulfilled:v,rejected:u}),this.handlers.length-1},x.prototype.eject=function(v){this.handlers[v]&&(this.handlers[v]=null)},x.prototype.forEach=function(v){C.forEach(this.handlers,function(d){d!==null&&v(d)})},s.exports=x},4097:(s,E,g)=>{"use strict";var C=g(1793),x=g(9002);s.exports=function(v,u){return v&&!C(u)?x(v,u):u}},5061:(s,E,g)=>{"use strict";var C=g(481);s.exports=function(T,v,u,d,h){var b=new Error(T);return C(b,v,u,d,h)}},3572:(s,E,g)=>{"use strict";var C=g(4867),x=g(8527),T=g(6502),v=g(5655);function u(d){d.cancelToken&&d.cancelToken.throwIfRequested()}s.exports=function(h){u(h),h.headers=h.headers||{},h.data=x(h.data,h.headers,h.transformRequest),h.headers=C.merge(h.headers.common||{},h.headers[h.method]||{},h.headers),C.forEach(["delete","get","head","post","put","patch","common"],function(l){delete h.headers[l]});var b=h.adapter||v.adapter;return b(h).then(function(l){return u(h),l.data=x(l.data,l.headers,h.transformResponse),l},function(l){return T(l)||(u(h),l&&l.response&&(l.response.data=x(l.response.data,l.response.headers,h.transformResponse))),Promise.reject(l)})}},481:s=>{"use strict";s.exports=function(g,C,x,T,v){return g.config=C,x&&(g.code=x),g.request=T,g.response=v,g.isAxiosError=!0,g.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},g}},7185:(s,E,g)=>{"use strict";var C=g(4867);s.exports=function(T,v){v=v||{};var u={},d=["url","method","data"],h=["headers","auth","proxy","params"],b=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],m=["validateStatus"];function l(R,D){return C.isPlainObject(R)&&C.isPlainObject(D)?C.merge(R,D):C.isPlainObject(D)?C.merge({},D):C.isArray(D)?D.slice():D}function f(R){C.isUndefined(v[R])?C.isUndefined(T[R])||(u[R]=l(void 0,T[R])):u[R]=l(T[R],v[R])}C.forEach(d,function(D){C.isUndefined(v[D])||(u[D]=l(void 0,v[D]))}),C.forEach(h,f),C.forEach(b,function(D){C.isUndefined(v[D])?C.isUndefined(T[D])||(u[D]=l(void 0,T[D])):u[D]=l(void 0,v[D])}),C.forEach(m,function(D){D in v?u[D]=l(T[D],v[D]):D in T&&(u[D]=l(void 0,T[D]))});var y=d.concat(h).concat(b).concat(m),_=Object.keys(T).concat(Object.keys(v)).filter(function(D){return y.indexOf(D)===-1});return C.forEach(_,f),u}},6026:(s,E,g)=>{"use strict";var C=g(5061);s.exports=function(T,v,u){var d=u.config.validateStatus;!u.status||!d||d(u.status)?T(u):v(C("Request failed with status code "+u.status,u.config,null,u.request,u))}},8527:(s,E,g)=>{"use strict";var C=g(4867);s.exports=function(T,v,u){return C.forEach(u,function(h){T=h(T,v)}),T}},5655:(s,E,g)=>{"use strict";var C=g(4867),x=g(6016),T={"Content-Type":"application/x-www-form-urlencoded"};function v(h,b){!C.isUndefined(h)&&C.isUndefined(h["Content-Type"])&&(h["Content-Type"]=b)}function u(){var h;return typeof XMLHttpRequest!="undefined"?h=g(5448):typeof process!="undefined"&&Object.prototype.toString.call(process)==="[object process]"&&(h=g(7970)),h}var d={adapter:u(),transformRequest:[function(b,m){return x(m,"Accept"),x(m,"Content-Type"),C.isFormData(b)||C.isArrayBuffer(b)||C.isBuffer(b)||C.isStream(b)||C.isFile(b)||C.isBlob(b)?b:C.isArrayBufferView(b)?b.buffer:C.isURLSearchParams(b)?(v(m,"application/x-www-form-urlencoded;charset=utf-8"),b.toString()):C.isObject(b)?(v(m,"application/json;charset=utf-8"),JSON.stringify(b)):b}],transformResponse:[function(b){if(typeof b=="string")try{b=JSON.parse(b)}catch(m){}return b}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(b){return b>=200&&b<300}};d.headers={common:{Accept:"application/json, text/plain, */*"}},C.forEach(["delete","get","head"],function(b){d.headers[b]={}}),C.forEach(["post","put","patch"],function(b){d.headers[b]=C.merge(T)}),s.exports=d},1849:s=>{"use strict";s.exports=function(g,C){return function(){for(var T=new Array(arguments.length),v=0;v<T.length;v++)T[v]=arguments[v];return g.apply(C,T)}}},5327:(s,E,g)=>{"use strict";var C=g(4867);function x(T){return encodeURIComponent(T).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}s.exports=function(v,u,d){if(!u)return v;var h;if(d)h=d(u);else if(C.isURLSearchParams(u))h=u.toString();else{var b=[];C.forEach(u,function(f,y){f===null||typeof f=="undefined"||(C.isArray(f)?y=y+"[]":f=[f],C.forEach(f,function(R){C.isDate(R)?R=R.toISOString():C.isObject(R)&&(R=JSON.stringify(R)),b.push(x(y)+"="+x(R))}))}),h=b.join("&")}if(h){var m=v.indexOf("#");m!==-1&&(v=v.slice(0,m)),v+=(v.indexOf("?")===-1?"?":"&")+h}return v}},9002:s=>{"use strict";s.exports=function(g,C){return C?g.replace(/\/+$/,"")+"/"+C.replace(/^\/+/,""):g}},4372:(s,E,g)=>{"use strict";var C=g(4867);s.exports=C.isStandardBrowserEnv()?function(){return{write:function(v,u,d,h,b,m){var l=[];l.push(v+"="+encodeURIComponent(u)),C.isNumber(d)&&l.push("expires="+new Date(d).toGMTString()),C.isString(h)&&l.push("path="+h),C.isString(b)&&l.push("domain="+b),m===!0&&l.push("secure"),document.cookie=l.join("; ")},read:function(v){var u=document.cookie.match(new RegExp("(^|;\\s*)("+v+")=([^;]*)"));return u?decodeURIComponent(u[3]):null},remove:function(v){this.write(v,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}()},1793:s=>{"use strict";s.exports=function(g){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(g)}},6268:s=>{"use strict";s.exports=function(g){return typeof g=="object"&&g.isAxiosError===!0}},7985:(s,E,g)=>{"use strict";var C=g(4867);s.exports=C.isStandardBrowserEnv()?function(){var T=/(msie|trident)/i.test(navigator.userAgent),v=document.createElement("a"),u;function d(h){var b=h;return T&&(v.setAttribute("href",b),b=v.href),v.setAttribute("href",b),{href:v.href,protocol:v.protocol?v.protocol.replace(/:$/,""):"",host:v.host,search:v.search?v.search.replace(/^\?/,""):"",hash:v.hash?v.hash.replace(/^#/,""):"",hostname:v.hostname,port:v.port,pathname:v.pathname.charAt(0)==="/"?v.pathname:"/"+v.pathname}}return u=d(window.location.href),function(b){var m=C.isString(b)?d(b):b;return m.protocol===u.protocol&&m.host===u.host}}():function(){return function(){return!0}}()},6016:(s,E,g)=>{"use strict";var C=g(4867);s.exports=function(T,v){C.forEach(T,function(d,h){h!==v&&h.toUpperCase()===v.toUpperCase()&&(T[v]=d,delete T[h])})}},4109:(s,E,g)=>{"use strict";var C=g(4867),x=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];s.exports=function(v){var u={},d,h,b;return v&&C.forEach(v.split(`
`),function(l){if(b=l.indexOf(":"),d=C.trim(l.substr(0,b)).toLowerCase(),h=C.trim(l.substr(b+1)),d){if(u[d]&&x.indexOf(d)>=0)return;d==="set-cookie"?u[d]=(u[d]?u[d]:[]).concat([h]):u[d]=u[d]?u[d]+", "+h:h}}),u}},8713:s=>{"use strict";s.exports=function(g){return function(x){return g.apply(null,x)}}},4867:(s,E,g)=>{"use strict";var C=g(1849),x=Object.prototype.toString;function T(N){return x.call(N)==="[object Array]"}function v(N){return typeof N=="undefined"}function u(N){return N!==null&&!v(N)&&N.constructor!==null&&!v(N.constructor)&&typeof N.constructor.isBuffer=="function"&&N.constructor.isBuffer(N)}function d(N){return x.call(N)==="[object ArrayBuffer]"}function h(N){return typeof FormData!="undefined"&&N instanceof FormData}function b(N){var V;return typeof ArrayBuffer!="undefined"&&ArrayBuffer.isView?V=ArrayBuffer.isView(N):V=N&&N.buffer&&N.buffer instanceof ArrayBuffer,V}function m(N){return typeof N=="string"}function l(N){return typeof N=="number"}function f(N){return N!==null&&typeof N=="object"}function y(N){if(x.call(N)!=="[object Object]")return!1;var V=Object.getPrototypeOf(N);return V===null||V===Object.prototype}function _(N){return x.call(N)==="[object Date]"}function R(N){return x.call(N)==="[object File]"}function D(N){return x.call(N)==="[object Blob]"}function A(N){return x.call(N)==="[object Function]"}function F(N){return f(N)&&A(N.pipe)}function H(N){return typeof URLSearchParams!="undefined"&&N instanceof URLSearchParams}function L(N){return N.replace(/^\s*/,"").replace(/\s*$/,"")}function M(){return typeof navigator!="undefined"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")?!1:typeof window!="undefined"&&typeof document!="undefined"}function O(N,V){if(!(N===null||typeof N=="undefined"))if(typeof N!="object"&&(N=[N]),T(N))for(var Y=0,J=N.length;Y<J;Y++)V.call(null,N[Y],Y,N);else for(var oe in N)Object.prototype.hasOwnProperty.call(N,oe)&&V.call(null,N[oe],oe,N)}function U(){var N={};function V(oe,G){y(N[G])&&y(oe)?N[G]=U(N[G],oe):y(oe)?N[G]=U({},oe):T(oe)?N[G]=oe.slice():N[G]=oe}for(var Y=0,J=arguments.length;Y<J;Y++)O(arguments[Y],V);return N}function W(N,V,Y){return O(V,function(oe,G){Y&&typeof oe=="function"?N[G]=C(oe,Y):N[G]=oe}),N}function X(N){return N.charCodeAt(0)===65279&&(N=N.slice(1)),N}s.exports={isArray:T,isArrayBuffer:d,isBuffer:u,isFormData:h,isArrayBufferView:b,isString:m,isNumber:l,isObject:f,isPlainObject:y,isUndefined:v,isDate:_,isFile:R,isBlob:D,isFunction:A,isStream:F,isURLSearchParams:H,isStandardBrowserEnv:M,forEach:O,merge:U,extend:W,trim:L,stripBOM:X}},696:s=>{"use strict";s.exports=JSON.parse('{"name":"axios","version":"0.21.1","description":"Promise based HTTP client for the browser and node.js","main":"index.js","scripts":{"test":"grunt test && bundlesize","start":"node ./sandbox/server.js","build":"NODE_ENV=production grunt build","preversion":"npm test","version":"npm run build && grunt version && git add -A dist && git add CHANGELOG.md bower.json package.json","postversion":"git push && git push --tags","examples":"node ./examples/server.js","coveralls":"cat coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js","fix":"eslint --fix lib/**/*.js"},"repository":{"type":"git","url":"https://github.com/axios/axios.git"},"keywords":["xhr","http","ajax","promise","node"],"author":"Matt Zabriskie","license":"MIT","bugs":{"url":"https://github.com/axios/axios/issues"},"homepage":"https://github.com/axios/axios","devDependencies":{"bundlesize":"^0.17.0","coveralls":"^3.0.0","es6-promise":"^4.2.4","grunt":"^1.0.2","grunt-banner":"^0.6.0","grunt-cli":"^1.2.0","grunt-contrib-clean":"^1.1.0","grunt-contrib-watch":"^1.0.0","grunt-eslint":"^20.1.0","grunt-karma":"^2.0.0","grunt-mocha-test":"^0.13.3","grunt-ts":"^6.0.0-beta.19","grunt-webpack":"^1.0.18","istanbul-instrumenter-loader":"^1.0.0","jasmine-core":"^2.4.1","karma":"^1.3.0","karma-chrome-launcher":"^2.2.0","karma-coverage":"^1.1.1","karma-firefox-launcher":"^1.1.0","karma-jasmine":"^1.1.1","karma-jasmine-ajax":"^0.1.13","karma-opera-launcher":"^1.0.0","karma-safari-launcher":"^1.0.0","karma-sauce-launcher":"^1.2.0","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.7","karma-webpack":"^1.7.0","load-grunt-tasks":"^3.5.2","minimist":"^1.2.0","mocha":"^5.2.0","sinon":"^4.5.0","typescript":"^2.8.1","url-search-params":"^0.10.0","webpack":"^1.13.1","webpack-dev-server":"^1.14.1"},"browser":{"./lib/adapters/http.js":"./lib/adapters/xhr.js"},"jsdelivr":"dist/axios.min.js","unpkg":"dist/axios.min.js","typings":"./index.d.ts","dependencies":{"follow-redirects":"^1.10.0"},"bundlesize":[{"path":"./dist/axios.min.js","threshold":"5kB"}]}')},5623:s=>{"use strict";s.exports=E;function E(x,T,v){x instanceof RegExp&&(x=g(x,v)),T instanceof RegExp&&(T=g(T,v));var u=C(x,T,v);return u&&{start:u[0],end:u[1],pre:v.slice(0,u[0]),body:v.slice(u[0]+x.length,u[1]),post:v.slice(u[1]+T.length)}}function g(x,T){var v=T.match(x);return v?v[0]:null}E.range=C;function C(x,T,v){var u,d,h,b,m,l=v.indexOf(x),f=v.indexOf(T,l+1),y=l;if(l>=0&&f>0){if(x===T)return[l,f];for(u=[],h=v.length;y>=0&&!m;)y==l?(u.push(y),l=v.indexOf(x,y+1)):u.length==1?m=[u.pop(),f]:(d=u.pop(),d<h&&(h=d,b=f),f=v.indexOf(T,y+1)),y=l<f&&l>=0?l:f;u.length&&(m=[h,b])}return m}},5186:(s,E,g)=>{var C=g(3698),x=g(2505),T=g(5382),v=Function.bind,u=v.bind(v);function d(f,y,_){var R=u(T,null).apply(null,_?[y,_]:[y]);f.api={remove:R},f.remove=R,["before","error","after","wrap"].forEach(function(D){var A=_?[y,D,_]:[y,D];f[D]=f.api[D]=u(x,null).apply(null,A)})}function h(){var f="h",y={registry:{}},_=C.bind(null,y,f);return d(_,y,f),_}function b(){var f={registry:{}},y=C.bind(null,f);return d(y,f),y}var m=!1;function l(){return m||(console.warn('[before-after-hook]: "Hook()" repurposing warning, use "Hook.Collection()". Read more: https://git.io/upgrade-before-after-hook-to-1.4'),m=!0),b()}l.Singular=h.bind(),l.Collection=b.bind(),s.exports=l,s.exports.Hook=l,s.exports.Singular=l.Singular,s.exports.Collection=l.Collection},2505:s=>{s.exports=E;function E(g,C,x,T){var v=T;g.registry[x]||(g.registry[x]=[]),C==="before"&&(T=function(u,d){return Promise.resolve().then(v.bind(null,d)).then(u.bind(null,d))}),C==="after"&&(T=function(u,d){var h;return Promise.resolve().then(u.bind(null,d)).then(function(b){return h=b,v(h,d)}).then(function(){return h})}),C==="error"&&(T=function(u,d){return Promise.resolve().then(u.bind(null,d)).catch(function(h){return v(h,d)})}),g.registry[x].push({hook:T,orig:v})}},3698:s=>{s.exports=E;function E(g,C,x,T){if(typeof x!="function")throw new Error("method for before hook must be a function");return T||(T={}),Array.isArray(C)?C.reverse().reduce(function(v,u){return E.bind(null,g,u,v,T)},x)():Promise.resolve().then(function(){return g.registry[C]?g.registry[C].reduce(function(v,u){return u.hook.bind(null,v,T)},x)():x(T)})}},5382:s=>{s.exports=E;function E(g,C,x){if(!!g.registry[C]){var T=g.registry[C].map(function(v){return v.orig}).indexOf(x);T!==-1&&g.registry[C].splice(T,1)}}},3644:(s,E,g)=>{var C=g(1048),x=g(5623);s.exports=y;var T="\0SLASH"+Math.random()+"\0",v="\0OPEN"+Math.random()+"\0",u="\0CLOSE"+Math.random()+"\0",d="\0COMMA"+Math.random()+"\0",h="\0PERIOD"+Math.random()+"\0";function b(L){return parseInt(L,10)==L?parseInt(L,10):L.charCodeAt(0)}function m(L){return L.split("\\\\").join(T).split("\\{").join(v).split("\\}").join(u).split("\\,").join(d).split("\\.").join(h)}function l(L){return L.split(T).join("\\").split(v).join("{").split(u).join("}").split(d).join(",").split(h).join(".")}function f(L){if(!L)return[""];var M=[],O=x("{","}",L);if(!O)return L.split(",");var U=O.pre,W=O.body,X=O.post,N=U.split(",");N[N.length-1]+="{"+W+"}";var V=f(X);return X.length&&(N[N.length-1]+=V.shift(),N.push.apply(N,V)),M.push.apply(M,N),M}function y(L){return L?(L.substr(0,2)==="{}"&&(L="\\{\\}"+L.substr(2)),H(m(L),!0).map(l)):[]}function _(L){return L}function R(L){return"{"+L+"}"}function D(L){return/^-?0\d/.test(L)}function A(L,M){return L<=M}function F(L,M){return L>=M}function H(L,M){var O=[],U=x("{","}",L);if(!U||/\$$/.test(U.pre))return[L];var W=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(U.body),X=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(U.body),N=W||X,V=U.body.indexOf(",")>=0;if(!N&&!V)return U.post.match(/,.*\}/)?(L=U.pre+"{"+U.body+u+U.post,H(L)):[L];var Y;if(N)Y=U.body.split(/\.\./);else if(Y=f(U.body),Y.length===1&&(Y=H(Y[0],!1).map(R),Y.length===1)){var oe=U.post.length?H(U.post,!1):[""];return oe.map(function(Ue){return U.pre+Y[0]+Ue})}var J=U.pre,oe=U.post.length?H(U.post,!1):[""],G;if(N){var ie=b(Y[0]),le=b(Y[1]),fe=Math.max(Y[0].length,Y[1].length),te=Y.length==3?Math.abs(b(Y[2])):1,ue=A,ae=le<ie;ae&&(te*=-1,ue=F);var ye=Y.some(D);G=[];for(var ge=ie;ue(ge,le);ge+=te){var Ee;if(X)Ee=String.fromCharCode(ge),Ee==="\\"&&(Ee="");else if(Ee=String(ge),ye){var de=fe-Ee.length;if(de>0){var _e=new Array(de+1).join("0");ge<0?Ee="-"+_e+Ee.slice(1):Ee=_e+Ee}}G.push(Ee)}}else G=C(Y,function(Ve){return H(Ve,!1)});for(var xe=0;xe<G.length;xe++)for(var Ae=0;Ae<oe.length;Ae++){var $e=J+G[xe]+oe[Ae];(!M||N||$e)&&O.push($e)}return O}},4046:(s,E,g)=>{"use strict";const C=g(1669),x=g(2357),T=g(9867),v=g(3223),u="cls@contexts",d="error@context",h=[];for(let L in v.providers)h[v.providers[L]]=L;const b=process.env.DEBUG_CLS_HOOKED;let m=-1;s.exports={getNamespace:f,createNamespace:y,destroyNamespace:_,reset:R,ERROR_SYMBOL:d};function l(L){this.name=L,this.active=null,this._set=[],this.id=null,this._contexts=new Map}l.prototype.set=function(M,O){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");return b&&D("    SETTING KEY:"+M+"="+O+" in ns:"+this.name+" uid:"+m+" active:"+C.inspect(this.active,!0)),this.active[M]=O,O},l.prototype.get=function(M){if(!this.active){b&&D("    GETTING KEY:"+M+"=undefined "+this.name+" uid:"+m+" active:"+C.inspect(this.active,!0));return}return b&&D("    GETTING KEY:"+M+"="+this.active[M]+" "+this.name+" uid:"+m+" active:"+C.inspect(this.active,!0)),this.active[M]},l.prototype.createContext=function(){b&&D("   CREATING Context: "+this.name+" uid:"+m+" len:"+this._set.length+"  active:"+C.inspect(this.active,!0,2,!0));let M=Object.create(this.active?this.active:Object.prototype);return M._ns_name=this.name,M.id=m,b&&D("   CREATED Context: "+this.name+" uid:"+m+" len:"+this._set.length+"  context:"+C.inspect(M,!0,2,!0)),M},l.prototype.run=function(M){let O=this.createContext();this.enter(O);try{return b&&D(" BEFORE RUN: "+this.name+" uid:"+m+" len:"+this._set.length+" "+C.inspect(O)),M(O),O}catch(U){throw U&&(U[d]=O),U}finally{b&&D(" AFTER RUN: "+this.name+" uid:"+m+" len:"+this._set.length+" "+C.inspect(O)),this.exit(O)}},l.prototype.runAndReturn=function(M){var O;return this.run(function(U){O=M(U)}),O},l.prototype.runPromise=function(M){let O=this.createContext();this.enter(O);let U=M(O);if(!U||!U.then||!U.catch)throw new Error("fn must return a promise.");return b&&D(" BEFORE runPromise: "+this.name+" uid:"+m+" len:"+this._set.length+" "+C.inspect(O)),U.then(W=>(b&&D(" AFTER runPromise: "+this.name+" uid:"+m+" len:"+this._set.length+" "+C.inspect(O)),this.exit(O),W)).catch(W=>{throw W[d]=O,b&&D(" AFTER runPromise: "+this.name+" uid:"+m+" len:"+this._set.length+" "+C.inspect(O)),this.exit(O),W})},l.prototype.bind=function(M,O){O||(this.active?O=this.active:O=this.createContext());let U=this;return function(){U.enter(O);try{return M.apply(this,arguments)}catch(X){throw X&&(X[d]=O),X}finally{U.exit(O)}}},l.prototype.enter=function(M){x.ok(M,"context must be provided for entering"),b&&D("  ENTER "+this.name+" uid:"+m+" len:"+this._set.length+" context: "+C.inspect(M)),this._set.push(this.active),this.active=M},l.prototype.exit=function(M){if(x.ok(M,"context must be provided for exiting"),b&&D("  EXIT "+this.name+" uid:"+m+" len:"+this._set.length+" context: "+C.inspect(M)),this.active===M){x.ok(this._set.length,"can't remove top context"),this.active=this._set.pop();return}let O=this._set.lastIndexOf(M);O<0?(b&&D("??ERROR?? context exiting but not entered - ignoring: "+C.inspect(M)),x.ok(O>=0,`context not currently entered; can't exit. 
`+C.inspect(this)+`
`+C.inspect(M))):(x.ok(O,"can't remove top context"),this._set.splice(O,1))},l.prototype.bindEmitter=function(M){x.ok(M.on&&M.addListener&&M.emit,"can only bind real EEs");let O=this,U="context@"+this.name;function W(N){!N||(N[u]||(N[u]=Object.create(null)),N[u][U]={namespace:O,context:O.active})}function X(N){if(!(N&&N[u]))return N;let V=N,Y=N[u];return Object.keys(Y).forEach(function(J){let oe=Y[J];V=oe.namespace.bind(V,oe.context)}),V}T(M,W,X)},l.prototype.fromException=function(M){return M[d]};function f(L){return process.namespaces[L]}function y(L){x.ok(L,"namespace must be given a name."),b&&D("CREATING NAMESPACE "+L);let M=new l(L);return M.id=m,v.addHooks({init(O,U,W,X,N){m=O,X?(M._contexts.set(O,M._contexts.get(X)),b&&D("PARENTID: "+L+" uid:"+O+" parent:"+X+" provider:"+W)):M._contexts.set(m,M.active),b&&D("INIT "+L+" uid:"+O+" parent:"+X+" provider:"+h[W]+" active:"+C.inspect(M.active,!0))},pre(O,U){m=O;let W=M._contexts.get(O);W?(b&&D(" PRE "+L+" uid:"+O+" handle:"+A(U)+" context:"+C.inspect(W)),M.enter(W)):b&&D(" PRE MISSING CONTEXT "+L+" uid:"+O+" handle:"+A(U))},post(O,U){m=O;let W=M._contexts.get(O);W?(b&&D(" POST "+L+" uid:"+O+" handle:"+A(U)+" context:"+C.inspect(W)),M.exit(W)):b&&D(" POST MISSING CONTEXT "+L+" uid:"+O+" handle:"+A(U))},destroy(O){m=O,b&&D("DESTROY "+L+" uid:"+O+" context:"+C.inspect(M._contexts.get(m))+" active:"+C.inspect(M.active,!0)),M._contexts.delete(O)}}),process.namespaces[L]=M,M}function _(L){let M=f(L);x.ok(M,`can't delete nonexistent namespace! "`+L+'"'),x.ok(M.id,"don't assign to process.namespaces directly! "+C.inspect(M)),process.namespaces[L]=null}function R(){process.namespaces&&Object.keys(process.namespaces).forEach(function(L){_(L)}),process.namespaces=Object.create(null)}process.namespaces={},v._state&&!v._state.enabled&&v.enable();function D(L){process.env.DEBUG&&process._rawDebug(L)}function A(L){if(!L)return L;if(typeof L=="function")return L.name?L.name:(L.toString().trim().match(/^function\s*([^\s(]+)/)||[])[1];if(L.constructor&&L.constructor.name)return L.constructor.name}if(b){var F=g(2512);for(var H in F.filter._modifiers)F.filter.deattach(H)}},3964:(s,E,g)=>{"use strict";const C=g(1669),x=g(2357),T=g(9867),v=g(7303),u="cls@contexts",d="error@context",h=process.env.DEBUG_CLS_HOOKED;let b=-1;s.exports={getNamespace:l,createNamespace:f,destroyNamespace:y,reset:_,ERROR_SYMBOL:d};function m(D){this.name=D,this.active=null,this._set=[],this.id=null,this._contexts=new Map,this._indent=0}m.prototype.set=function(A,F){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");if(this.active[A]=F,h){const H=" ".repeat(this._indent<0?0:this._indent);R(H+"CONTEXT-SET KEY:"+A+"="+F+" in ns:"+this.name+" currentUid:"+b+" active:"+C.inspect(this.active,{showHidden:!0,depth:2,colors:!0}))}return F},m.prototype.get=function(A){if(!this.active){if(h){const F=v.currentId(),H=v.triggerAsyncId(),L=" ".repeat(this._indent<0?0:this._indent);R(`${L}CONTEXT-GETTING KEY NO ACTIVE NS: (${this.name}) ${A}=undefined currentUid:${b} asyncHooksCurrentId:${F} triggerId:${H} len:${this._set.length}`)}return}if(h){const F=v.executionAsyncId(),H=v.triggerAsyncId(),L=" ".repeat(this._indent<0?0:this._indent);R(L+"CONTEXT-GETTING KEY:"+A+"="+this.active[A]+" ("+this.name+") currentUid:"+b+" active:"+C.inspect(this.active,{showHidden:!0,depth:2,colors:!0})),R(`${L}CONTEXT-GETTING KEY: (${this.name}) ${A}=${this.active[A]} currentUid:${b} asyncHooksCurrentId:${F} triggerId:${H} len:${this._set.length} active:${C.inspect(this.active)}`)}return this.active[A]},m.prototype.createContext=function(){let A=Object.create(this.active?this.active:Object.prototype);if(A._ns_name=this.name,A.id=b,h){const F=v.executionAsyncId(),H=v.triggerAsyncId(),L=" ".repeat(this._indent<0?0:this._indent);R(`${L}CONTEXT-CREATED Context: (${this.name}) currentUid:${b} asyncHooksCurrentId:${F} triggerId:${H} len:${this._set.length} context:${C.inspect(A,{showHidden:!0,depth:2,colors:!0})}`)}return A},m.prototype.run=function(A){let F=this.createContext();this.enter(F);try{if(h){const H=v.triggerAsyncId(),L=v.executionAsyncId(),M=" ".repeat(this._indent<0?0:this._indent);R(`${M}CONTEXT-RUN BEGIN: (${this.name}) currentUid:${b} triggerId:${H} asyncHooksCurrentId:${L} len:${this._set.length} context:${C.inspect(F)}`)}return A(F),F}catch(H){throw H&&(H[d]=F),H}finally{if(h){const H=v.triggerAsyncId(),L=v.executionAsyncId(),M=" ".repeat(this._indent<0?0:this._indent);R(`${M}CONTEXT-RUN END: (${this.name}) currentUid:${b} triggerId:${H} asyncHooksCurrentId:${L} len:${this._set.length} ${C.inspect(F)}`)}this.exit(F)}},m.prototype.runAndReturn=function(A){let F;return this.run(function(H){F=A(H)}),F},m.prototype.runPromise=function(A){let F=this.createContext();this.enter(F);let H=A(F);if(!H||!H.then||!H.catch)throw new Error("fn must return a promise.");return h&&R("CONTEXT-runPromise BEFORE: ("+this.name+") currentUid:"+b+" len:"+this._set.length+" "+C.inspect(F)),H.then(L=>(h&&R("CONTEXT-runPromise AFTER then: ("+this.name+") currentUid:"+b+" len:"+this._set.length+" "+C.inspect(F)),this.exit(F),L)).catch(L=>{throw L[d]=F,h&&R("CONTEXT-runPromise AFTER catch: ("+this.name+") currentUid:"+b+" len:"+this._set.length+" "+C.inspect(F)),this.exit(F),L})},m.prototype.bind=function(A,F){F||(this.active?F=this.active:F=this.createContext());let H=this;return function(){H.enter(F);try{return A.apply(this,arguments)}catch(M){throw M&&(M[d]=F),M}finally{H.exit(F)}}},m.prototype.enter=function(A){if(x.ok(A,"context must be provided for entering"),h){const F=v.executionAsyncId(),H=v.triggerAsyncId(),L=" ".repeat(this._indent<0?0:this._indent);R(`${L}CONTEXT-ENTER: (${this.name}) currentUid:${b} triggerId:${H} asyncHooksCurrentId:${F} len:${this._set.length} ${C.inspect(A)}`)}this._set.push(this.active),this.active=A},m.prototype.exit=function(A){if(x.ok(A,"context must be provided for exiting"),h){const H=v.executionAsyncId(),L=v.triggerAsyncId(),M=" ".repeat(this._indent<0?0:this._indent);R(`${M}CONTEXT-EXIT: (${this.name}) currentUid:${b} triggerId:${L} asyncHooksCurrentId:${H} len:${this._set.length} ${C.inspect(A)}`)}if(this.active===A){x.ok(this._set.length,"can't remove top context"),this.active=this._set.pop();return}let F=this._set.lastIndexOf(A);F<0?(h&&R("??ERROR?? context exiting but not entered - ignoring: "+C.inspect(A)),x.ok(F>=0,`context not currently entered; can't exit. 
`+C.inspect(this)+`
`+C.inspect(A))):(x.ok(F,"can't remove top context"),this._set.splice(F,1))},m.prototype.bindEmitter=function(A){x.ok(A.on&&A.addListener&&A.emit,"can only bind real EEs");let F=this,H="context@"+this.name;function L(O){!O||(O[u]||(O[u]=Object.create(null)),O[u][H]={namespace:F,context:F.active})}function M(O){if(!(O&&O[u]))return O;let U=O,W=O[u];return Object.keys(W).forEach(function(X){let N=W[X];U=N.namespace.bind(U,N.context)}),U}T(A,L,M)},m.prototype.fromException=function(A){return A[d]};function l(D){return process.namespaces[D]}function f(D){x.ok(D,"namespace must be given a name."),h&&R(`NS-CREATING NAMESPACE (${D})`);let A=new m(D);return A.id=b,v.createHook({init(H,L,M,O){if(b=v.executionAsyncId(),A.active){if(A._contexts.set(H,A.active),h){const U=" ".repeat(A._indent<0?0:A._indent);R(`${U}INIT [${L}] (${D}) asyncId:${H} currentUid:${b} triggerId:${M} active:${C.inspect(A.active,{showHidden:!0,depth:2,colors:!0})} resource:${O}`)}}else if(b===0){const U=v.triggerAsyncId(),W=A._contexts.get(U);if(W){if(A._contexts.set(H,W),h){const X=" ".repeat(A._indent<0?0:A._indent);R(`${X}INIT USING CONTEXT FROM TRIGGERID [${L}] (${D}) asyncId:${H} currentUid:${b} triggerId:${U} active:${C.inspect(A.active,{showHidden:!0,depth:2,colors:!0})} resource:${O}`)}}else if(h){const X=" ".repeat(A._indent<0?0:A._indent);R(`${X}INIT MISSING CONTEXT [${L}] (${D}) asyncId:${H} currentUid:${b} triggerId:${U} active:${C.inspect(A.active,{showHidden:!0,depth:2,colors:!0})} resource:${O}`)}}if(h&&L==="PROMISE"){R(C.inspect(O,{showHidden:!0}));const U=O.parentId,W=" ".repeat(A._indent<0?0:A._indent);R(`${W}INIT RESOURCE-PROMISE [${L}] (${D}) parentId:${U} asyncId:${H} currentUid:${b} triggerId:${M} active:${C.inspect(A.active,{showHidden:!0,depth:2,colors:!0})} resource:${O}`)}},before(H){b=v.executionAsyncId();let L;if(L=A._contexts.get(H)||A._contexts.get(b),L){if(h){const M=v.triggerAsyncId(),O=" ".repeat(A._indent<0?0:A._indent);R(`${O}BEFORE (${D}) asyncId:${H} currentUid:${b} triggerId:${M} active:${C.inspect(A.active,{showHidden:!0,depth:2,colors:!0})} context:${C.inspect(L)}`),A._indent+=2}A.enter(L)}else if(h){const M=v.triggerAsyncId(),O=" ".repeat(A._indent<0?0:A._indent);R(`${O}BEFORE MISSING CONTEXT (${D}) asyncId:${H} currentUid:${b} triggerId:${M} active:${C.inspect(A.active,{showHidden:!0,depth:2,colors:!0})} namespace._contexts:${C.inspect(A._contexts,{showHidden:!0,depth:2,colors:!0})}`),A._indent+=2}},after(H){b=v.executionAsyncId();let L;if(L=A._contexts.get(H)||A._contexts.get(b),L){if(h){const M=v.triggerAsyncId();A._indent-=2;const O=" ".repeat(A._indent<0?0:A._indent);R(`${O}AFTER (${D}) asyncId:${H} currentUid:${b} triggerId:${M} active:${C.inspect(A.active,{showHidden:!0,depth:2,colors:!0})} context:${C.inspect(L)}`)}A.exit(L)}else if(h){const M=v.triggerAsyncId();A._indent-=2;const O=" ".repeat(A._indent<0?0:A._indent);R(`${O}AFTER MISSING CONTEXT (${D}) asyncId:${H} currentUid:${b} triggerId:${M} active:${C.inspect(A.active,{showHidden:!0,depth:2,colors:!0})} context:${C.inspect(L)}`)}},destroy(H){if(b=v.executionAsyncId(),h){const L=v.triggerAsyncId(),M=" ".repeat(A._indent<0?0:A._indent);R(`${M}DESTROY (${D}) currentUid:${b} asyncId:${H} triggerId:${L} active:${C.inspect(A.active,{showHidden:!0,depth:2,colors:!0})} context:${C.inspect(A._contexts.get(b))}`)}A._contexts.delete(H)}}).enable(),process.namespaces[D]=A,A}function y(D){let A=l(D);x.ok(A,`can't delete nonexistent namespace! "`+D+'"'),x.ok(A.id,"don't assign to process.namespaces directly! "+C.inspect(A)),process.namespaces[D]=null}function _(){process.namespaces&&Object.keys(process.namespaces).forEach(function(D){y(D)}),process.namespaces=Object.create(null)}process.namespaces={};function R(...D){h&&process._rawDebug(`${C.format(...D)}`)}},9562:(s,E,g)=>{"use strict";const C=g(6625);process&&C.gte(process.versions.node,"8.0.0")?s.exports=g(3964):s.exports=g(4046)},1048:s=>{s.exports=function(g,C){for(var x=[],T=0;T<g.length;T++){var v=C(g[T],T);E(v)?x.push.apply(x,v):x.push(v)}return x};var E=Array.isArray||function(g){return Object.prototype.toString.call(g)==="[object Array]"}},3057:(s,E,g)=>{"use strict";var C=g(2357),x=g(9867),T="cls@contexts",v="error@context";process.addAsyncListener||g(7645);function u(l){this.name=l,this.active=null,this._set=[],this.id=null}u.prototype.set=function(l,f){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");return this.active[l]=f,f},u.prototype.get=function(l){if(!!this.active)return this.active[l]},u.prototype.createContext=function(){return Object.create(this.active)},u.prototype.run=function(l){var f=this.createContext();this.enter(f);try{return l(f),f}catch(y){throw y&&(y[v]=f),y}finally{this.exit(f)}},u.prototype.runAndReturn=function(l){var f;return this.run(function(y){f=l(y)}),f},u.prototype.bind=function(l,f){f||(this.active?f=this.active:f=this.createContext());var y=this;return function(){y.enter(f);try{return l.apply(this,arguments)}catch(_){throw _&&(_[v]=f),_}finally{y.exit(f)}}},u.prototype.enter=function(l){C.ok(l,"context must be provided for entering"),this._set.push(this.active),this.active=l},u.prototype.exit=function(l){if(C.ok(l,"context must be provided for exiting"),this.active===l){C.ok(this._set.length,"can't remove top context"),this.active=this._set.pop();return}var f=this._set.lastIndexOf(l);C.ok(f>=0,"context not currently entered; can't exit"),C.ok(f,"can't remove top context"),this._set.splice(f,1)},u.prototype.bindEmitter=function(l){C.ok(l.on&&l.addListener&&l.emit,"can only bind real EEs");var f=this,y="context@"+this.name;function _(D){!D||(D[T]||(D[T]=Object.create(null)),D[T][y]={namespace:f,context:f.active})}function R(D){if(!(D&&D[T]))return D;var A=D,F=D[T];return Object.keys(F).forEach(function(H){var L=F[H];A=L.namespace.bind(A,L.context)}),A}x(l,_,R)},u.prototype.fromException=function(l){return l[v]};function d(l){return process.namespaces[l]}function h(l){C.ok(l,"namespace must be given a name!");var f=new u(l);return f.id=process.addAsyncListener({create:function(){return f.active},before:function(y,_){_&&f.enter(_)},after:function(y,_){_&&f.exit(_)},error:function(y){y&&f.exit(y)}}),process.namespaces[l]=f,f}function b(l){var f=d(l);C.ok(f,"can't delete nonexistent namespace!"),C.ok(f.id,"don't assign to process.namespaces directly!"),process.removeAsyncListener(f.id),process.namespaces[l]=null}function m(){process.namespaces&&Object.keys(process.namespaces).forEach(function(l){b(l)}),process.namespaces=Object.create(null)}process.namespaces||m(),s.exports={getNamespace:d,createNamespace:h,destroyNamespace:b,reset:m}},5175:s=>{"use strict";function E(g){if(!/^data:/i.test(g))throw new TypeError('`uri` does not appear to be a Data URI (must begin with "data:")');g=g.replace(/\r?\n/g,"");const C=g.indexOf(",");if(C===-1||C<=4)throw new TypeError("malformed data: URI");const x=g.substring(5,C).split(";");let T="",v=!1;const u=x[0]||"text/plain";let d=u;for(let l=1;l<x.length;l++)x[l]==="base64"?v=!0:(d+=`;${x[l]}`,x[l].indexOf("charset=")===0&&(T=x[l].substring(8)));!x[0]&&!T.length&&(d+=";charset=US-ASCII",T="US-ASCII");const h=v?"base64":"ascii",b=unescape(g.substring(C+1)),m=Buffer.from(b,h);return m.type=u,m.typeFull=d,m.charset=T,m}s.exports=E},1758:(s,E,g)=>{E.formatArgs=x,E.save=T,E.load=v,E.useColors=C,E.storage=u(),E.destroy=(()=>{let h=!1;return()=>{h||(h=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),E.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function C(){return typeof window!="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function x(h){if(h[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+h[0]+(this.useColors?"%c ":" ")+"+"+s.exports.humanize(this.diff),!this.useColors)return;const b="color: "+this.color;h.splice(1,0,b,"color: inherit");let m=0,l=0;h[0].replace(/%[a-zA-Z%]/g,f=>{f!=="%%"&&(m++,f==="%c"&&(l=m))}),h.splice(l,0,b)}E.log=console.debug||console.log||(()=>{});function T(h){try{h?E.storage.setItem("debug",h):E.storage.removeItem("debug")}catch(b){}}function v(){let h;try{h=E.storage.getItem("debug")}catch(b){}return!h&&typeof process!="undefined"&&"env"in process&&(h=process.env.DEBUG),h}function u(){try{return localStorage}catch(h){}}s.exports=g(2447)(E);const{formatters:d}=s.exports;d.j=function(h){try{return JSON.stringify(h)}catch(b){return"[UnexpectedJSONParseError]: "+b.message}}},2447:(s,E,g)=>{function C(x){v.debug=v,v.default=v,v.coerce=l,v.disable=h,v.enable=d,v.enabled=b,v.humanize=g(7824),v.destroy=f,Object.keys(x).forEach(y=>{v[y]=x[y]}),v.names=[],v.skips=[],v.formatters={};function T(y){let _=0;for(let R=0;R<y.length;R++)_=(_<<5)-_+y.charCodeAt(R),_|=0;return v.colors[Math.abs(_)%v.colors.length]}v.selectColor=T;function v(y){let _,R=null;function D(...A){if(!D.enabled)return;const F=D,H=Number(new Date),L=H-(_||H);F.diff=L,F.prev=_,F.curr=H,_=H,A[0]=v.coerce(A[0]),typeof A[0]!="string"&&A.unshift("%O");let M=0;A[0]=A[0].replace(/%([a-zA-Z%])/g,(U,W)=>{if(U==="%%")return"%";M++;const X=v.formatters[W];if(typeof X=="function"){const N=A[M];U=X.call(F,N),A.splice(M,1),M--}return U}),v.formatArgs.call(F,A),(F.log||v.log).apply(F,A)}return D.namespace=y,D.useColors=v.useColors(),D.color=v.selectColor(y),D.extend=u,D.destroy=v.destroy,Object.defineProperty(D,"enabled",{enumerable:!0,configurable:!1,get:()=>R===null?v.enabled(y):R,set:A=>{R=A}}),typeof v.init=="function"&&v.init(D),D}function u(y,_){const R=v(this.namespace+(typeof _=="undefined"?":":_)+y);return R.log=this.log,R}function d(y){v.save(y),v.names=[],v.skips=[];let _;const R=(typeof y=="string"?y:"").split(/[\s,]+/),D=R.length;for(_=0;_<D;_++)!R[_]||(y=R[_].replace(/\*/g,".*?"),y[0]==="-"?v.skips.push(new RegExp("^"+y.substr(1)+"$")):v.names.push(new RegExp("^"+y+"$")))}function h(){const y=[...v.names.map(m),...v.skips.map(m).map(_=>"-"+_)].join(",");return v.enable(""),y}function b(y){if(y[y.length-1]==="*")return!0;let _,R;for(_=0,R=v.skips.length;_<R;_++)if(v.skips[_].test(y))return!1;for(_=0,R=v.names.length;_<R;_++)if(v.names[_].test(y))return!0;return!1}function m(y){return y.toString().substring(2,y.toString().length-2).replace(/\.\*\?$/,"*")}function l(y){return y instanceof Error?y.stack||y.message:y}function f(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return v.enable(v.load()),v}s.exports=C},8104:(s,E,g)=>{typeof process=="undefined"||process.type==="renderer"||process.browser===!0||process.__nwjs?s.exports=g(1758):s.exports=g(39)},39:(s,E,g)=>{const C=g(3867),x=g(1669);E.init=m,E.log=d,E.formatArgs=v,E.save=h,E.load=b,E.useColors=T,E.destroy=x.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),E.colors=[6,2,3,4,5,1];try{const f=g(2130);f&&(f.stderr||f).level>=2&&(E.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(f){}E.inspectOpts=Object.keys(process.env).filter(f=>/^debug_/i.test(f)).reduce((f,y)=>{const _=y.substring(6).toLowerCase().replace(/_([a-z])/g,(D,A)=>A.toUpperCase());let R=process.env[y];return/^(yes|on|true|enabled)$/i.test(R)?R=!0:/^(no|off|false|disabled)$/i.test(R)?R=!1:R==="null"?R=null:R=Number(R),f[_]=R,f},{});function T(){return"colors"in E.inspectOpts?Boolean(E.inspectOpts.colors):C.isatty(process.stderr.fd)}function v(f){const{namespace:y,useColors:_}=this;if(_){const R=this.color,D="[3"+(R<8?R:"8;5;"+R),A=`  ${D};1m${y} [0m`;f[0]=A+f[0].split(`
`).join(`
`+A),f.push(D+"m+"+s.exports.humanize(this.diff)+"[0m")}else f[0]=u()+y+" "+f[0]}function u(){return E.inspectOpts.hideDate?"":new Date().toISOString()+" "}function d(...f){return process.stderr.write(x.format(...f)+`
`)}function h(f){f?process.env.DEBUG=f:delete process.env.DEBUG}function b(){return process.env.DEBUG}function m(f){f.inspectOpts={};const y=Object.keys(E.inspectOpts);for(let _=0;_<y.length;_++)f.inspectOpts[y[_]]=E.inspectOpts[y[_]]}s.exports=g(2447)(E);const{formatters:l}=s.exports;l.o=function(f){return this.inspectOpts.colors=this.useColors,x.inspect(f,this.inspectOpts).split(`
`).map(y=>y.trim()).join(" ")},l.O=function(f){return this.inspectOpts.colors=this.useColors,x.inspect(f,this.inspectOpts)}},8604:function(s,E,g){"use strict";var C=this&&this.__assign||Object.assign||function(d){for(var h,b=1,m=arguments.length;b<m;b++){h=arguments[b];for(var l in h)Object.prototype.hasOwnProperty.call(h,l)&&(d[l]=h[l])}return d};Object.defineProperty(E,"__esModule",{value:!0});var x=g(4953);E.AzureMonitorSymbol="Azure_Monitor_Tracer";var T=function(d){try{var h=g(8921).BasicTracer,b=x.channel.spanContextPropagator?{scopeManager:x.channel.spanContextPropagator}:void 0,m=new h(b),l=m.startSpan;m.startSpan=function(f,y){if(!y||!y.parent){var _=m.getCurrentSpan();_&&_.operation&&_.operation.traceparent&&(y=C({},y,{parent:{traceId:_.operation.traceparent.traceId,spanId:_.operation.traceparent.spanId}}))}var R=l.call(this,f,y);return R.addEvent("Application Insights Integration enabled"),R},m.addSpanProcessor(new v),m[E.AzureMonitorSymbol]=!0,d.setTracer(m)}catch(f){}return d},v=function(){function d(){}return d.prototype.onStart=function(h){},d.prototype.onEnd=function(h){x.channel.publish("azure-coretracing",h)},d.prototype.shutdown=function(){},d}();E.azureCoreTracing={versionSpecifier:">= 1.0.0 < 2.0.0",patch:T};function u(){x.channel.registerMonkeyPatch("@azure/core-tracing",E.azureCoreTracing)}E.enable=u},8859:(s,E,g)=>{"use strict";Object.defineProperty(E,"__esModule",{value:!0});var C=g(4953),x=function(v){var u=v.prototype._emit;return v.prototype._emit=function(d,h){var b=u.apply(this,arguments);if(!h){var m=b;m||(m=u.call(this,d,!0)),C.channel.publish("bunyan",{level:d.level,result:m})}return b},v};E.bunyan={versionSpecifier:">= 1.0.0 < 2.0.0",patch:x};function T(){C.channel.registerMonkeyPatch("bunyan",E.bunyan)}E.enable=T},2495:(s,E,g)=>{"use strict";Object.defineProperty(E,"__esModule",{value:!0});var C=g(4953),x=g(2413),T=function(u){var d=new x.Writable,h=new x.Writable;d.write=function(R){if(!R)return!0;var D=R.toString();return C.channel.publish("console",{message:D}),!0},h.write=function(R){if(!R)return!0;var D=R.toString();return C.channel.publish("console",{message:D,stderr:!0}),!0};for(var b=new u.Console(d,h),m=["log","info","warn","error","dir","time","timeEnd","trace","assert"],l=function(R){var D=u[R];D&&(u[R]=function(){if(b[R])try{b[R].apply(b,arguments)}catch(A){}return D.apply(u,arguments)})},f=0,y=m;f<y.length;f++){var _=y[f];l(_)}return u};E.console={versionSpecifier:">= 4.0.0",patch:T};function v(){C.channel.registerMonkeyPatch("console",E.console),g(7082)}E.enable=v},4106:(s,E,g)=>{"use strict";Object.defineProperty(E,"__esModule",{value:!0});var C=g(8604);E.azuresdk=C;var x=g(8859);E.bunyan=x;var T=g(2495);E.console=T;var v=g(2028);E.mongodbCore=v;var u=g(8436);E.mongodb=u;var d=g(8002);E.mysql=d;var h=g(9024);E.pgPool=h;var b=g(8060);E.pg=b;var m=g(4487);E.redis=m;var l=g(6661);E.tedious=l;var f=g(4650);E.winston=f;function y(){x.enable(),T.enable(),v.enable(),u.enable(),d.enable(),b.enable(),h.enable(),m.enable(),f.enable(),C.enable(),l.enable()}E.enable=y},2028:(s,E,g)=>{"use strict";Object.defineProperty(E,"__esModule",{value:!0});var C=g(4953),x=function(v){var u=v.Server.prototype.connect;return v.Server.prototype.connect=function(){var h=u.apply(this,arguments),b=this.s.pool.write;this.s.pool.write=function(){var f=typeof arguments[1]=="function"?1:2;return typeof arguments[f]=="function"&&(arguments[f]=C.channel.bindToContext(arguments[f])),b.apply(this,arguments)};var m=this.s.pool.logout;return this.s.pool.logout=function(){return typeof arguments[1]=="function"&&(arguments[1]=C.channel.bindToContext(arguments[1])),m.apply(this,arguments)},h},v};E.mongoCore={versionSpecifier:">= 2.0.0 < 4.0.0",patch:x};function T(){C.channel.registerMonkeyPatch("mongodb-core",E.mongoCore)}E.enable=T},8436:function(s,E,g){"use strict";var C=this&&this.__assign||Object.assign||function(b){for(var m,l=1,f=arguments.length;l<f;l++){m=arguments[l];for(var y in m)Object.prototype.hasOwnProperty.call(m,y)&&(b[y]=m[y])}return b};Object.defineProperty(E,"__esModule",{value:!0});var x=g(4953),T=function(b){var m=b.instrument({operationIdGenerator:{next:function(){return x.channel.bindToContext(function(f){return f()})}}}),l={};return m.on("started",function(f){l[f.requestId]||(l[f.requestId]=C({},f,{time:new Date}))}),m.on("succeeded",function(f){var y=l[f.requestId];y&&delete l[f.requestId],typeof f.operationId=="function"?f.operationId(function(){return x.channel.publish("mongodb",{startedData:y,event:f,succeeded:!0})}):x.channel.publish("mongodb",{startedData:y,event:f,succeeded:!0})}),m.on("failed",function(f){var y=l[f.requestId];y&&delete l[f.requestId],typeof f.operationId=="function"?f.operationId(function(){return x.channel.publish("mongodb",{startedData:y,event:f,succeeded:!1})}):x.channel.publish("mongodb",{startedData:y,event:f,succeeded:!1})}),b},v=function(b){var m=b.instrument(),l={},f={};return m.on("started",function(y){l[y.requestId]||(f[y.requestId]=x.channel.bindToContext(function(_){return _()}),l[y.requestId]=C({},y,{time:new Date}))}),m.on("succeeded",function(y){var _=l[y.requestId];_&&delete l[y.requestId],typeof y=="object"&&typeof f[y.requestId]=="function"&&(f[y.requestId](function(){return x.channel.publish("mongodb",{startedData:_,event:y,succeeded:!0})}),delete f[y.requestId])}),m.on("failed",function(y){var _=l[y.requestId];_&&delete l[y.requestId],typeof y=="object"&&typeof f[y.requestId]=="function"&&(f[y.requestId](function(){return x.channel.publish("mongodb",{startedData:_,event:y,succeeded:!1})}),delete f[y.requestId])}),b},u=function(b){var m=b.Server.prototype.connect;return b.Server.prototype.connect=function(){var f=m.apply(this,arguments),y=this.s.coreTopology.s.pool.write;this.s.coreTopology.s.pool.write=function(){var D=typeof arguments[1]=="function"?1:2;return typeof arguments[D]=="function"&&(arguments[D]=x.channel.bindToContext(arguments[D])),y.apply(this,arguments)};var _=this.s.coreTopology.s.pool.logout;return this.s.coreTopology.s.pool.logout=function(){return typeof arguments[1]=="function"&&(arguments[1]=x.channel.bindToContext(arguments[1])),_.apply(this,arguments)},f},b},d=function(b){u(b);var m=b.instrument(),l={},f={};return m.on("started",function(y){l[y.requestId]||(f[y.requestId]=x.channel.bindToContext(function(_){return _()}),l[y.requestId]=y)}),m.on("succeeded",function(y){var _=l[y.requestId];_&&delete l[y.requestId],typeof y=="object"&&typeof f[y.requestId]=="function"&&(f[y.requestId](function(){return x.channel.publish("mongodb",{startedData:_,event:y,succeeded:!0})}),delete f[y.requestId])}),m.on("failed",function(y){var _=l[y.requestId];_&&delete l[y.requestId],typeof y=="object"&&typeof f[y.requestId]=="function"&&(f[y.requestId](function(){return x.channel.publish("mongodb",{startedData:_,event:y,succeeded:!1})}),delete f[y.requestId])}),b};E.mongo2={versionSpecifier:">= 2.0.0 <= 3.0.5",patch:T},E.mongo3={versionSpecifier:"> 3.0.5 < 3.3.0",patch:v},E.mongo330={versionSpecifier:">= 3.3.0 < 4.0.0",patch:d};function h(){x.channel.registerMonkeyPatch("mongodb",E.mongo2),x.channel.registerMonkeyPatch("mongodb",E.mongo3),x.channel.registerMonkeyPatch("mongodb",E.mongo330)}E.enable=h},8002:(s,E,g)=>{"use strict";Object.defineProperty(E,"__esModule",{value:!0});var C=g(4953),x=g(5622),T=function(u,d){var h=function(_,R){return function(D,A){var F=_[D];F&&(_[D]=function(){for(var L=arguments.length-1,M=arguments.length-1;M>=0;--M)if(typeof arguments[M]=="function"){L=M;break}else if(typeof arguments[M]!="undefined")break;var O=arguments[L],U={result:null,startTime:null,startDate:null};typeof O=="function"&&(A?(U.startTime=process.hrtime(),U.startDate=new Date,arguments[L]=C.channel.bindToContext(A(U,O))):arguments[L]=C.channel.bindToContext(O));var W=F.apply(this,arguments);return U.result=W,W})}},b=function(_,R){return h(_.prototype,R+".prototype")},m=["connect","changeUser","ping","statistics","end"],l=g(4694)(x.dirname(d)+"/lib/Connection");m.forEach(function(_){return b(l,"Connection")(_)}),h(l,"Connection")("createQuery",function(_,R){return function(D){var A=process.hrtime(_.startTime),F=A[0]*1e3+A[1]/1e6|0;C.channel.publish("mysql",{query:_.result,callbackArgs:arguments,err:D,duration:F,time:_.startDate}),R.apply(this,arguments)}});var f=["_enqueueCallback"],y=g(420)(x.dirname(d)+"/lib/Pool");return f.forEach(function(_){return b(y,"Pool")(_)}),u};E.mysql={versionSpecifier:">= 2.0.0 < 3.0.0",patch:T};function v(){C.channel.registerMonkeyPatch("mysql",E.mysql)}E.enable=v},9024:(s,E,g)=>{"use strict";Object.defineProperty(E,"__esModule",{value:!0});var C=g(4953);function x(v){var u=v.prototype.connect;return v.prototype.connect=function(h){return h&&(arguments[0]=C.channel.bindToContext(h)),u.apply(this,arguments)},v}E.postgresPool1={versionSpecifier:">= 1.0.0 < 3.0.0",patch:x};function T(){C.channel.registerMonkeyPatch("pg-pool",E.postgresPool1)}E.enable=T},8060:(s,E,g)=>{"use strict";Object.defineProperty(E,"__esModule",{value:!0});var C=g(4953),x=g(8614);function T(d,h){var b=d.Client.prototype.query,m="__diagnosticOriginalFunc";return d.Client.prototype.query=function(f,y,_){var R={query:{},database:{host:this.connectionParameters.host,port:this.connectionParameters.port},result:null,error:null,duration:0,time:new Date},D=process.hrtime(),A;function F(H){H&&H[m]&&(H=H[m]);var L=C.channel.bindToContext(function(M,O){var U=process.hrtime(D);if(R.result=O&&{rowCount:O.rowCount,command:O.command},R.error=M,R.duration=Math.ceil(U[0]*1e3+U[1]/1e6),C.channel.publish("postgres",R),M){if(H)return H.apply(this,arguments);A&&A instanceof x.EventEmitter&&A.emit("error",M)}else H&&H.apply(this,arguments)});try{return Object.defineProperty(L,m,{value:H}),L}catch(M){return H}}try{typeof f=="string"?y instanceof Array?(R.query.preparable={text:f,args:y},_=F(_)):(R.query.text=f,_?_=F(_):y=F(y)):(typeof f.name=="string"?R.query.plan=f.name:f.values instanceof Array?R.query.preparable={text:f.text,args:f.values}:R.query.text=f.text,_?_=F(_):y?y=F(y):f.callback=F(f.callback))}catch(H){return b.apply(this,arguments)}return arguments[0]=f,arguments[1]=y,arguments[2]=_,arguments.length=arguments.length>3?arguments.length:3,A=b.apply(this,arguments),A},d}function v(d,h){var b=d.Client.prototype.query,m="__diagnosticOriginalFunc";return d.Client.prototype.query=function(f,y,_){var R=this,D=!!_,A={query:{},database:{host:this.connectionParameters.host,port:this.connectionParameters.port},result:null,error:null,duration:0,time:new Date},F=process.hrtime(),H;function L(M){M&&M[m]&&(M=M[m]);var O=C.channel.bindToContext(function(U,W){var X=process.hrtime(F);if(A.result=W&&{rowCount:W.rowCount,command:W.command},A.error=U,A.duration=Math.ceil(X[0]*1e3+X[1]/1e6),C.channel.publish("postgres",A),U){if(M)return M.apply(this,arguments);H&&H instanceof x.EventEmitter&&H.emit("error",U)}else M&&M.apply(this,arguments)});try{return Object.defineProperty(O,m,{value:M}),O}catch(U){return M}}try{typeof f=="string"?y instanceof Array?(A.query.preparable={text:f,args:y},D=typeof _=="function",_=D?L(_):_):(A.query.text=f,_?(D=typeof _=="function",_=D?L(_):_):(D=typeof y=="function",y=D?L(y):y)):(typeof f.name=="string"?A.query.plan=f.name:f.values instanceof Array?A.query.preparable={text:f.text,args:f.values}:A.query.text=f.text,_?(D=typeof _=="function",_=L(_)):y?(D=typeof y=="function",y=D?L(y):y):(D=typeof f.callback=="function",f.callback=D?L(f.callback):f.callback))}catch(M){return b.apply(this,arguments)}return arguments[0]=f,arguments[1]=y,arguments[2]=_,arguments.length=arguments.length>3?arguments.length:3,H=b.apply(this,arguments),D?H:H.then(function(M){return L()(void 0,M),new R._Promise(function(O,U){O(M)})}).catch(function(M){return L()(M,void 0),new R._Promise(function(O,U){U(M)})})},d}E.postgres6={versionSpecifier:"6.*",patch:T},E.postgres7={versionSpecifier:">=7.* <=8.*",patch:v};function u(){C.channel.registerMonkeyPatch("pg",E.postgres6),C.channel.registerMonkeyPatch("pg",E.postgres7)}E.enable=u},4487:(s,E,g)=>{"use strict";Object.defineProperty(E,"__esModule",{value:!0});var C=g(4953),x=function(v){var u=v.RedisClient.prototype.internal_send_command;return v.RedisClient.prototype.internal_send_command=function(d){if(d){var h=d.callback;if(!h||!h.pubsubBound){var b=this.address,m=process.hrtime(),l=new Date;d.callback=C.channel.bindToContext(function(f,y){var _=process.hrtime(m),R=_[0]*1e3+_[1]/1e6|0;C.channel.publish("redis",{duration:R,address:b,commandObj:d,err:f,result:y,time:l}),typeof h=="function"&&h.apply(this,arguments)}),d.callback.pubsubBound=!0}}return u.call(this,d)},v};E.redis={versionSpecifier:">= 2.0.0 < 4.0.0",patch:x};function T(){C.channel.registerMonkeyPatch("redis",E.redis)}E.enable=T},6661:function(s,E,g){"use strict";var C=this&&this.__assign||Object.assign||function(u){for(var d,h=1,b=arguments.length;h<b;h++){d=arguments[h];for(var m in d)Object.prototype.hasOwnProperty.call(d,m)&&(u[m]=d[m])}return u};Object.defineProperty(E,"__esModule",{value:!0});var x=g(4953),T=function(u){var d=u.Connection.prototype.makeRequest;return u.Connection.prototype.makeRequest=function(){function b(l){var f=process.hrtime(),y={query:{},database:{host:null,port:null},result:null,error:null,duration:0};return x.channel.bindToContext(function(_,R,D){var A=process.hrtime(f);y=C({},y,{database:{host:this.connection.config.server,port:this.connection.config.options.port},result:!_&&{rowCount:R,rows:D},query:{text:this.parametersByName.statement.value},error:_,duration:Math.ceil(A[0]*1e3+A[1]/1e6)}),x.channel.publish("tedious",y),l.call(this,_,R,D)})}var m=arguments[0];arguments[0].callback=b(m.callback),d.apply(this,arguments)},u};E.tedious={versionSpecifier:">= 6.0.0 < 9.0.0",patch:T};function v(){x.channel.registerMonkeyPatch("tedious",E.tedious)}E.enable=v},4650:function(s,E,g){"use strict";var C=this&&this.__extends||function(){var h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,m){b.__proto__=m}||function(b,m){for(var l in m)m.hasOwnProperty(l)&&(b[l]=m[l])};return function(b,m){h(b,m);function l(){this.constructor=b}b.prototype=m===null?Object.create(m):(l.prototype=m.prototype,new l)}}(),x=this&&this.__rest||function(h,b){var m={};for(var l in h)Object.prototype.hasOwnProperty.call(h,l)&&b.indexOf(l)<0&&(m[l]=h[l]);if(h!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,l=Object.getOwnPropertySymbols(h);f<l.length;f++)b.indexOf(l[f])<0&&(m[l[f]]=h[l[f]]);return m};Object.defineProperty(E,"__esModule",{value:!0});var T=g(4953),v=function(h){var b=h.Logger.prototype.log,m,l=function(f,y,_){var R;return m===h.config.npm.levels?R="npm":m===h.config.syslog.levels?R="syslog":R="unknown",T.channel.publish("winston",{level:f,message:y,meta:_,levelKind:R}),y};return h.Logger.prototype.log=function(){return m=this.levels,!this.filters||this.filters.length===0?this.filters=[l]:this.filters[this.filters.length-1]!==l&&(this.filters=this.filters.filter(function(y){return y!==l}),this.filters.push(l)),b.apply(this,arguments)},h},u=function(h){var b=function(_,R){var D;return _.config.npm.levels[R]!=null?D="npm":_.config.syslog.levels[R]!=null?D="syslog":D="unknown",D},m=function(_){C(R,_);function R(D,A){var F=_.call(this,A)||this;return F.winston=D,F}return R.prototype.log=function(D,A){var F=D.message,H=D.level,L=D.meta,M=x(D,["message","level","meta"]);H=typeof Symbol.for=="function"?D[Symbol.for("level")]:H,F=D instanceof Error?D:F;var O=b(this.winston,H);L=L||{};for(var U in M)M.hasOwnProperty(U)&&(L[U]=M[U]);T.channel.publish("winston",{message:F,level:H,levelKind:O,meta:L}),A()},R}(h.Transport);function l(){var _=arguments[0].levels||h.config.npm.levels,R;for(var D in _)_.hasOwnProperty(D)&&(R=R===void 0||_[D]>_[R]?D:R);this.add(new m(h,{level:R}))}var f=h.createLogger;h.createLogger=function(){var R=arguments[0].levels||h.config.npm.levels,D;for(var A in R)R.hasOwnProperty(A)&&(D=D===void 0||R[A]>R[D]?A:D);var F=f.apply(this,arguments);F.add(new m(h,{level:D}));var H=F.configure;return F.configure=function(){H.apply(this,arguments),l.apply(this,arguments)},F};var y=h.createLogger;return h.configure=function(){y.apply(this,arguments),l.apply(this,arguments)},h.add(new m(h)),h};E.winston3={versionSpecifier:"3.x",patch:u},E.winston2={versionSpecifier:"2.x",patch:v};function d(){T.channel.registerMonkeyPatch("winston",E.winston2),T.channel.registerMonkeyPatch("winston",E.winston3)}E.enable=d},4694:s=>{function E(g){var C=new Error("Cannot find module '"+g+"'");throw C.code="MODULE_NOT_FOUND",C}E.keys=()=>[],E.resolve=E,E.id=4694,s.exports=E},420:s=>{function E(g){var C=new Error("Cannot find module '"+g+"'");throw C.code="MODULE_NOT_FOUND",C}E.keys=()=>[],E.resolve=E,E.id=420,s.exports=E},4953:(s,E,g)=>{"use strict";Object.defineProperty(E,"__esModule",{value:!0});var C=g(7424),x=g(7424);E.makePatchingRequire=x.makePatchingRequire;var T=function(d){return!0},v=function(){function d(){this.version=g(5236).i8,this.subscribers={},this.contextPreservationFunction=function(h){return h},this.knownPatches={},this.currentlyPublishing=!1}return d.prototype.shouldPublish=function(h){var b=this.subscribers[h];return b?b.some(function(m){var l=m.filter;return!l||l(!1)}):!1},d.prototype.publish=function(h,b){if(!this.currentlyPublishing){var m=this.subscribers[h];if(m){var l={timestamp:Date.now(),data:b};this.currentlyPublishing=!0,m.forEach(function(f){var y=f.listener,_=f.filter;try{_&&_(!0)&&y(l)}catch(R){}}),this.currentlyPublishing=!1}}},d.prototype.subscribe=function(h,b,m){m===void 0&&(m=T),this.subscribers[h]||(this.subscribers[h]=[]),this.subscribers[h].push({listener:b,filter:m})},d.prototype.unsubscribe=function(h,b,m){m===void 0&&(m=T);var l=this.subscribers[h];if(l){for(var f=0;f<l.length;++f)if(l[f].listener===b&&l[f].filter===m)return l.splice(f,1),!0}return!1},d.prototype.reset=function(){var h=this;this.subscribers={},this.contextPreservationFunction=function(b){return b},Object.getOwnPropertyNames(this.knownPatches).forEach(function(b){return delete h.knownPatches[b]})},d.prototype.bindToContext=function(h){return this.contextPreservationFunction(h)},d.prototype.addContextPreservation=function(h){var b=this.contextPreservationFunction;this.contextPreservationFunction=function(m){return h(b(m))}},d.prototype.registerMonkeyPatch=function(h,b){this.knownPatches[h]||(this.knownPatches[h]=[]),this.knownPatches[h].push(b)},d.prototype.getPatchesObject=function(){return this.knownPatches},d}();if(!global.diagnosticsSource){global.diagnosticsSource=new v;var u=g(2282);u.prototype.require=C.makePatchingRequire(global.diagnosticsSource.getPatchesObject())}E.channel=global.diagnosticsSource},7424:(s,E,g)=>{"use strict";Object.defineProperty(E,"__esModule",{value:!0});var C=g(5622),x=g(6625),T=g(2282),v=Object.keys(process.binding("natives")),u=T.prototype.require;function d(h){var b={};return function(l){var f=u.apply(this,arguments);if(h[l]){var y=T._resolveFilename(l,this);if(b.hasOwnProperty(y))return b[y];var _=void 0;if(v.indexOf(l)<0)try{_=u.call(this,C.join(l,"package.json")).version}catch(L){return f}else _=process.version.substring(1);var R=_.indexOf("-");R>=0&&(_=_.substring(0,R));for(var D=f,A=0,F=h[l];A<F.length;A++){var H=F[A];x.satisfies(_,H.versionSpecifier)&&(D=H.patch(D,y))}return b[y]=D}return f}}E.makePatchingRequire=d},5236:s=>{"use strict";s.exports={i8:"0.2.0"}},9867:(s,E,g)=>{"use strict";var C=g(6372),x=C.wrap,T=C.unwrap,v="wrap@before";function u(l,f,y){var _=!!l[f]&&l.propertyIsEnumerable(f);Object.defineProperty(l,f,{configurable:!0,enumerable:_,writable:!0,value:y})}function d(l,f){for(var y=f.length,_=0;_<y;_++){var R=f[_],D=l[v];if(typeof D=="function")D(R);else if(Array.isArray(D))for(var A=D.length,F=0;F<A;F++)D[F](R)}}function h(l,f){var y;return y=l._events&&l._events[f],Array.isArray(y)||(y?y=[y]:y=[]),y}function b(l,f,y){var _=h(l,f),R=_.filter(function(D){return y.indexOf(D)===-1});R.length>0&&d(l,R)}function m(l,f){if(!!l){var y=l;if(typeof l=="function")y=f(l);else if(Array.isArray(l)){y=[];for(var _=0;_<l.length;_++)y[_]=f(l[_])}return y}}s.exports=function(f,y,_){if(!f||!f.on||!f.addListener||!f.removeListener||!f.emit)throw new Error("can only wrap real EEs");if(!y)throw new Error("must have function to run on listener addition");if(!_)throw new Error("must have function to wrap listeners when emitting");function R(A){return function(H,L){var M=h(this,H).slice();try{var O=A.call(this,H,L);return b(this,H,M),O}finally{this.on.__wrapped||x(this,"on",R),this.addListener.__wrapped||x(this,"addListener",R)}}}function D(A){return function(H){if(!this._events||!this._events[H])return A.apply(this,arguments);var L=this._events[H];function M(O){return function(){this._events[H]=L;try{return O.apply(this,arguments)}finally{L=this._events[H],this._events[H]=m(L,_)}}}x(this,"removeListener",M);try{return this._events[H]=m(L,_),A.apply(this,arguments)}finally{T(this,"removeListener"),this._events[H]=L}}}f[v]?typeof f[v]=="function"?u(f,v,[f[v],y]):Array.isArray(f[v])&&f[v].push(y):u(f,v,y),f.__wrapped||(x(f,"addListener",R),x(f,"on",R),x(f,"emit",D),u(f,"__unwrap",function(){T(f,"addListener"),T(f,"on"),T(f,"emit"),delete f[v],delete f.__wrapped}),u(f,"__wrapped",!0))}},6724:()=>{},6030:(s,E,g)=>{const{Readable:C}=g(2413),x=new WeakMap;async function*T(u){for(const d of u)"stream"in d?yield*d.stream():yield d}class v{constructor(d=[],h={}){let b=0;const m=d.map(f=>{let y;return f instanceof Buffer?y=f:ArrayBuffer.isView(f)?y=Buffer.from(f.buffer,f.byteOffset,f.byteLength):f instanceof ArrayBuffer?y=Buffer.from(f):f instanceof v?y=f:y=Buffer.from(typeof f=="string"?f:String(f)),b+=y.length||y.size||0,y}),l=h.type===void 0?"":String(h.type).toLowerCase();x.set(this,{type:/[^\u0020-\u007E]/.test(l)?"":l,size:b,parts:m})}get size(){return x.get(this).size}get type(){return x.get(this).type}async text(){return Buffer.from(await this.arrayBuffer()).toString()}async arrayBuffer(){const d=new Uint8Array(this.size);let h=0;for await(const b of this.stream())d.set(b,h),h+=b.length;return d.buffer}stream(){return C.from(T(x.get(this).parts))}slice(d=0,h=this.size,b=""){const{size:m}=this;let l=d<0?Math.max(m+d,0):Math.min(d,m),f=h<0?Math.max(m+h,0):Math.min(h,m);const y=Math.max(f-l,0),_=x.get(this).parts.values(),R=[];let D=0;for(const F of _){const H=ArrayBuffer.isView(F)?F.byteLength:F.size;if(l&&H<=l)l-=H,f-=H;else{const L=F.slice(l,Math.min(H,f));if(R.push(L),D+=ArrayBuffer.isView(L)?L.byteLength:L.size,l=0,D>=y)break}}const A=new v([],{type:String(b).toLowerCase()});return Object.assign(x.get(A),{size:y,parts:R}),A}get[Symbol.toStringTag](){return"Blob"}static[Symbol.hasInstance](d){return d&&typeof d=="object"&&typeof d.stream=="function"&&d.stream.length===0&&typeof d.constructor=="function"&&/^(Blob|File)$/.test(d[Symbol.toStringTag])}}Object.defineProperties(v.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}}),s.exports=v},2261:(s,E,g)=>{var C;s.exports=function(){if(!C)try{C=g(8104)("follow-redirects")}catch(x){C=function(){}}C.apply(null,arguments)}},938:(s,E,g)=>{var C=g(8835),x=C.URL,T=g(8605),v=g(7211),u=g(2413).Writable,d=g(2357),h=g(2261),b=["abort","aborted","connect","error","socket","timeout"],m=Object.create(null);b.forEach(function(O){m[O]=function(U,W,X){this._redirectable.emit(O,U,W,X)}});var l=L("ERR_FR_REDIRECTION_FAILURE",""),f=L("ERR_FR_TOO_MANY_REDIRECTS","Maximum number of redirects exceeded"),y=L("ERR_FR_MAX_BODY_LENGTH_EXCEEDED","Request body larger than maxBodyLength limit"),_=L("ERR_STREAM_WRITE_AFTER_END","write after end");function R(O,U){u.call(this),this._sanitizeOptions(O),this._options=O,this._ended=!1,this._ending=!1,this._redirectCount=0,this._redirects=[],this._requestBodyLength=0,this._requestBodyBuffers=[],U&&this.on("response",U);var W=this;this._onNativeResponse=function(X){W._processResponse(X)},this._performRequest()}R.prototype=Object.create(u.prototype),R.prototype.abort=function(){M(this._currentRequest),this.emit("abort")},R.prototype.write=function(O,U,W){if(this._ending)throw new _;if(!(typeof O=="string"||typeof O=="object"&&"length"in O))throw new TypeError("data should be a string, Buffer or Uint8Array");if(typeof U=="function"&&(W=U,U=null),O.length===0){W&&W();return}this._requestBodyLength+O.length<=this._options.maxBodyLength?(this._requestBodyLength+=O.length,this._requestBodyBuffers.push({data:O,encoding:U}),this._currentRequest.write(O,U,W)):(this.emit("error",new y),this.abort())},R.prototype.end=function(O,U,W){if(typeof O=="function"?(W=O,O=U=null):typeof U=="function"&&(W=U,U=null),!O)this._ended=this._ending=!0,this._currentRequest.end(null,null,W);else{var X=this,N=this._currentRequest;this.write(O,U,function(){X._ended=!0,N.end(null,null,W)}),this._ending=!0}},R.prototype.setHeader=function(O,U){this._options.headers[O]=U,this._currentRequest.setHeader(O,U)},R.prototype.removeHeader=function(O){delete this._options.headers[O],this._currentRequest.removeHeader(O)},R.prototype.setTimeout=function(O,U){var W=this;U&&this.on("timeout",U);function X(Y){Y.setTimeout(O),Y.removeListener("timeout",Y.destroy),Y.addListener("timeout",Y.destroy)}function N(Y){W._timeout&&clearTimeout(W._timeout),W._timeout=setTimeout(function(){W.emit("timeout"),V()},O),X(Y)}function V(){clearTimeout(this._timeout),U&&W.removeListener("timeout",U),this.socket||W._currentRequest.removeListener("socket",N)}return this.socket?N(this.socket):this._currentRequest.once("socket",N),this.on("socket",X),this.once("response",V),this.once("error",V),this},["flushHeaders","getHeader","setNoDelay","setSocketKeepAlive"].forEach(function(O){R.prototype[O]=function(U,W){return this._currentRequest[O](U,W)}}),["aborted","connection","socket"].forEach(function(O){Object.defineProperty(R.prototype,O,{get:function(){return this._currentRequest[O]}})}),R.prototype._sanitizeOptions=function(O){if(O.headers||(O.headers={}),O.host&&(O.hostname||(O.hostname=O.host),delete O.host),!O.pathname&&O.path){var U=O.path.indexOf("?");U<0?O.pathname=O.path:(O.pathname=O.path.substring(0,U),O.search=O.path.substring(U))}},R.prototype._performRequest=function(){var O=this._options.protocol,U=this._options.nativeProtocols[O];if(!U){this.emit("error",new TypeError("Unsupported protocol "+O));return}if(this._options.agents){var W=O.substr(0,O.length-1);this._options.agent=this._options.agents[W]}var X=this._currentRequest=U.request(this._options,this._onNativeResponse);this._currentUrl=C.format(this._options),X._redirectable=this;for(var N=0;N<b.length;N++)X.on(b[N],m[b[N]]);if(this._isRedirect){var V=0,Y=this,J=this._requestBodyBuffers;(function oe(G){if(X===Y._currentRequest)if(G)Y.emit("error",G);else if(V<J.length){var ie=J[V++];X.finished||X.write(ie.data,ie.encoding,oe)}else Y._ended&&X.end()})()}},R.prototype._processResponse=function(O){var U=O.statusCode;this._options.trackRedirects&&this._redirects.push({url:this._currentUrl,headers:O.headers,statusCode:U});var W=O.headers.location;if(W&&this._options.followRedirects!==!1&&U>=300&&U<400){if(M(this._currentRequest),O.destroy(),++this._redirectCount>this._options.maxRedirects){this.emit("error",new f);return}((U===301||U===302)&&this._options.method==="POST"||U===303&&!/^(?:GET|HEAD)$/.test(this._options.method))&&(this._options.method="GET",this._requestBodyBuffers=[],H(/^content-/i,this._options.headers));var X=H(/^host$/i,this._options.headers)||C.parse(this._currentUrl).hostname,N=C.resolve(this._currentUrl,W);h("redirecting to",N),this._isRedirect=!0;var V=C.parse(N);if(Object.assign(this._options,V),V.hostname!==X&&H(/^authorization$/i,this._options.headers),typeof this._options.beforeRedirect=="function"){var Y={headers:O.headers};try{this._options.beforeRedirect.call(null,this._options,Y)}catch(oe){this.emit("error",oe);return}this._sanitizeOptions(this._options)}try{this._performRequest()}catch(oe){var J=new l("Redirected request failed: "+oe.message);J.cause=oe,this.emit("error",J)}}else O.responseUrl=this._currentUrl,O.redirects=this._redirects,this.emit("response",O),this._requestBodyBuffers=[]};function D(O){var U={maxRedirects:21,maxBodyLength:10*1024*1024},W={};return Object.keys(O).forEach(function(X){var N=X+":",V=W[N]=O[X],Y=U[X]=Object.create(V);function J(G,ie,le){if(typeof G=="string"){var fe=G;try{G=F(new x(fe))}catch(te){G=C.parse(fe)}}else x&&G instanceof x?G=F(G):(le=ie,ie=G,G={protocol:N});return typeof ie=="function"&&(le=ie,ie=null),ie=Object.assign({maxRedirects:U.maxRedirects,maxBodyLength:U.maxBodyLength},G,ie),ie.nativeProtocols=W,d.equal(ie.protocol,N,"protocol mismatch"),h("options",ie),new R(ie,le)}function oe(G,ie,le){var fe=Y.request(G,ie,le);return fe.end(),fe}Object.defineProperties(Y,{request:{value:J,configurable:!0,enumerable:!0,writable:!0},get:{value:oe,configurable:!0,enumerable:!0,writable:!0}})}),U}function A(){}function F(O){var U={protocol:O.protocol,hostname:O.hostname.startsWith("[")?O.hostname.slice(1,-1):O.hostname,hash:O.hash,search:O.search,pathname:O.pathname,path:O.pathname+O.search,href:O.href};return O.port!==""&&(U.port=Number(O.port)),U}function H(O,U){var W;for(var X in U)O.test(X)&&(W=U[X],delete U[X]);return W}function L(O,U){function W(X){Error.captureStackTrace(this,this.constructor),this.message=X||U}return W.prototype=new Error,W.prototype.constructor=W,W.prototype.name="Error ["+O+"]",W.prototype.code=O,W}function M(O){for(var U=0;U<b.length;U++)O.removeListener(b[U],m[b[U]]);O.on("error",A),O.abort()}s.exports=D({http:T,https:v}),s.exports.wrap=D},7360:function(s,E){var g,C,x;(function(T,v){C=[],g=v,x=typeof g=="function"?g.apply(E,C):g,x!==void 0&&(s.exports=x)})(this,function(){function v(F){var H={single:function(L,M,O){if(!L||(R(L)||(L=H.getPreparedSearch(L)),!M))return null;R(M)||(M=H.getPrepared(M));var U=O&&O.allowTypo!==void 0?O.allowTypo:F&&F.allowTypo!==void 0?F.allowTypo:!0,W=U?H.algorithm:H.algorithmNoTypo;return W(L,M,L[0])},go:function(L,M,O){if(!L)return b;L=H.prepareSearch(L);var U=L[0],W=O&&O.threshold||F&&F.threshold||-9007199254740991,X=O&&O.limit||F&&F.limit||9007199254740991,N=O&&O.allowTypo!==void 0?O.allowTypo:F&&F.allowTypo!==void 0?F.allowTypo:!0,V=N?H.algorithm:H.algorithmNoTypo,Y=0,J=0,oe=M.length;if(O&&O.keys)for(var G=O.scoreFn||y,ie=O.keys,le=ie.length,fe=oe-1;fe>=0;--fe){for(var te=M[fe],ue=new Array(le),ae=le-1;ae>=0;--ae){var ye=ie[ae],ge=_(te,ye);if(!ge){ue[ae]=null;continue}R(ge)||(ge=H.getPrepared(ge)),ue[ae]=V(L,ge,U)}ue.obj=te;var Ee=G(ue);Ee!==null&&(Ee<W||(ue.score=Ee,Y<X?(A.add(ue),++Y):(++J,Ee>A.peek().score&&A.replaceTop(ue))))}else if(O&&O.key)for(var ye=O.key,fe=oe-1;fe>=0;--fe){var te=M[fe],ge=_(te,ye);if(!!ge){R(ge)||(ge=H.getPrepared(ge));var de=V(L,ge,U);de!==null&&(de.score<W||(de={target:de.target,_targetLowerCodes:null,_nextBeginningIndexes:null,score:de.score,indexes:de.indexes,obj:te},Y<X?(A.add(de),++Y):(++J,de.score>A.peek().score&&A.replaceTop(de))))}}else for(var fe=oe-1;fe>=0;--fe){var ge=M[fe];if(!!ge){R(ge)||(ge=H.getPrepared(ge));var de=V(L,ge,U);de!==null&&(de.score<W||(Y<X?(A.add(de),++Y):(++J,de.score>A.peek().score&&A.replaceTop(de))))}}if(Y===0)return b;for(var _e=new Array(Y),fe=Y-1;fe>=0;--fe)_e[fe]=A.poll();return _e.total=Y+J,_e},goAsync:function(L,M,O){var U=!1,W=new Promise(function(X,N){if(!L)return X(b);L=H.prepareSearch(L);var V=L[0],Y=D(),J=M.length-1,oe=O&&O.threshold||F&&F.threshold||-9007199254740991,G=O&&O.limit||F&&F.limit||9007199254740991,ie=O&&O.allowTypo!==void 0?O.allowTypo:F&&F.allowTypo!==void 0?F.allowTypo:!0,le=ie?H.algorithm:H.algorithmNoTypo,fe=0,te=0;function ue(){if(U)return N("canceled");var ae=Date.now();if(O&&O.keys)for(var ye=O.scoreFn||y,ge=O.keys,Ee=ge.length;J>=0;--J){for(var de=M[J],_e=new Array(Ee),xe=Ee-1;xe>=0;--xe){var Ae=ge[xe],$e=_(de,Ae);if(!$e){_e[xe]=null;continue}R($e)||($e=H.getPrepared($e)),_e[xe]=le(L,$e,V)}_e.obj=de;var Ve=ye(_e);if(Ve!==null&&!(Ve<oe)&&(_e.score=Ve,fe<G?(Y.add(_e),++fe):(++te,Ve>Y.peek().score&&Y.replaceTop(_e)),J%1e3==0&&Date.now()-ae>=10)){u?setImmediate(ue):setTimeout(ue);return}}else if(O&&O.key)for(var Ae=O.key;J>=0;--J){var de=M[J],$e=_(de,Ae);if(!!$e){R($e)||($e=H.getPrepared($e));var Ue=le(L,$e,V);if(Ue!==null&&!(Ue.score<oe)&&(Ue={target:Ue.target,_targetLowerCodes:null,_nextBeginningIndexes:null,score:Ue.score,indexes:Ue.indexes,obj:de},fe<G?(Y.add(Ue),++fe):(++te,Ue.score>Y.peek().score&&Y.replaceTop(Ue)),J%1e3==0&&Date.now()-ae>=10)){u?setImmediate(ue):setTimeout(ue);return}}}else for(;J>=0;--J){var $e=M[J];if(!!$e){R($e)||($e=H.getPrepared($e));var Ue=le(L,$e,V);if(Ue!==null&&!(Ue.score<oe)&&(fe<G?(Y.add(Ue),++fe):(++te,Ue.score>Y.peek().score&&Y.replaceTop(Ue)),J%1e3==0&&Date.now()-ae>=10)){u?setImmediate(ue):setTimeout(ue);return}}}if(fe===0)return X(b);for(var Le=new Array(fe),Xe=fe-1;Xe>=0;--Xe)Le[Xe]=Y.poll();Le.total=fe+te,X(Le)}u?setImmediate(ue):ue()});return W.cancel=function(){U=!0},W},highlight:function(L,M,O){if(L===null)return null;M===void 0&&(M="<b>"),O===void 0&&(O="</b>");for(var U="",W=0,X=!1,N=L.target,V=N.length,Y=L.indexes,J=0;J<V;++J){var oe=N[J];if(Y[W]===J){if(++W,X||(X=!0,U+=M),W===Y.length){U+=oe+O+N.substr(J+1);break}}else X&&(X=!1,U+=O);U+=oe}return U},prepare:function(L){if(!!L)return{target:L,_targetLowerCodes:H.prepareLowerCodes(L),_nextBeginningIndexes:null,score:null,indexes:null,obj:null}},prepareSlow:function(L){if(!!L)return{target:L,_targetLowerCodes:H.prepareLowerCodes(L),_nextBeginningIndexes:H.prepareNextBeginningIndexes(L),score:null,indexes:null,obj:null}},prepareSearch:function(L){if(!!L)return H.prepareLowerCodes(L)},getPrepared:function(L){if(L.length>999)return H.prepare(L);var M=d.get(L);return M!==void 0||(M=H.prepare(L),d.set(L,M)),M},getPreparedSearch:function(L){if(L.length>999)return H.prepareSearch(L);var M=h.get(L);return M!==void 0||(M=H.prepareSearch(L),h.set(L,M)),M},algorithm:function(L,M,O){for(var U=M._targetLowerCodes,W=L.length,X=U.length,N=0,V=0,Y=0,J=0;;){var oe=O===U[V];if(oe){if(m[J++]=V,++N,N===W)break;O=L[Y===0?N:Y===N?N+1:Y===N-1?N-1:N]}if(++V,V>=X)for(;;){if(N<=1)return null;if(Y===0){--N;var G=L[N];if(O===G)continue;Y=N}else{if(Y===1)return null;--Y,N=Y,O=L[N+1];var G=L[N];if(O===G)continue}J=N,V=m[J-1]+1;break}}var N=0,ie=0,le=!1,fe=0,te=M._nextBeginningIndexes;te===null&&(te=M._nextBeginningIndexes=H.prepareNextBeginningIndexes(M.target));var ue=V=m[0]===0?0:te[m[0]-1];if(V!==X)for(;;)if(V>=X){if(N<=0){if(++ie,ie>W-2)break;if(L[ie]===L[ie+1])continue;V=ue;continue}--N;var ae=l[--fe];V=te[ae]}else{var oe=L[ie===0?N:ie===N?N+1:ie===N-1?N-1:N]===U[V];if(oe){if(l[fe++]=V,++N,N===W){le=!0;break}++V}else V=te[V]}{if(le)var ye=l,ge=fe;else var ye=m,ge=J;for(var Ee=0,de=-1,_e=0;_e<W;++_e){var V=ye[_e];de!==V-1&&(Ee-=V),de=V}le?ie!==0&&(Ee+=-20):(Ee*=1e3,Y!==0&&(Ee+=-20)),Ee-=X-W,M.score=Ee,M.indexes=new Array(ge);for(var _e=ge-1;_e>=0;--_e)M.indexes[_e]=ye[_e];return M}},algorithmNoTypo:function(L,M,O){for(var U=M._targetLowerCodes,W=L.length,X=U.length,N=0,V=0,Y=0;;){var J=O===U[V];if(J){if(m[Y++]=V,++N,N===W)break;O=L[N]}if(++V,V>=X)return null}var N=0,oe=!1,G=0,ie=M._nextBeginningIndexes;ie===null&&(ie=M._nextBeginningIndexes=H.prepareNextBeginningIndexes(M.target));var le=V=m[0]===0?0:ie[m[0]-1];if(V!==X)for(;;)if(V>=X){if(N<=0)break;--N;var fe=l[--G];V=ie[fe]}else{var J=L[N]===U[V];if(J){if(l[G++]=V,++N,N===W){oe=!0;break}++V}else V=ie[V]}{if(oe)var te=l,ue=G;else var te=m,ue=Y;for(var ae=0,ye=-1,ge=0;ge<W;++ge){var V=te[ge];ye!==V-1&&(ae-=V),ye=V}oe||(ae*=1e3),ae-=X-W,M.score=ae,M.indexes=new Array(ue);for(var ge=ue-1;ge>=0;--ge)M.indexes[ge]=te[ge];return M}},prepareLowerCodes:function(L){for(var M=L.length,O=[],U=L.toLowerCase(),W=0;W<M;++W)O[W]=U.charCodeAt(W);return O},prepareBeginningIndexes:function(L){for(var M=L.length,O=[],U=0,W=!1,X=!1,N=0;N<M;++N){var V=L.charCodeAt(N),Y=V>=65&&V<=90,J=Y||V>=97&&V<=122||V>=48&&V<=57,oe=Y&&!W||!X||!J;W=Y,X=J,oe&&(O[U++]=N)}return O},prepareNextBeginningIndexes:function(L){for(var M=L.length,O=H.prepareBeginningIndexes(L),U=[],W=O[0],X=0,N=0;N<M;++N)W>N?U[N]=W:(W=O[++X],U[N]=W===void 0?M:W);return U},cleanup:f,new:v};return H}var u=typeof window=="undefined",d=new Map,h=new Map,b=[];b.total=0;var m=[],l=[];function f(){d.clear(),h.clear(),m=[],l=[]}function y(F){for(var H=-9007199254740991,L=F.length-1;L>=0;--L){var M=F[L];if(M!==null){var O=M.score;O>H&&(H=O)}}return H===-9007199254740991?null:H}function _(F,H){var L=F[H];if(L!==void 0)return L;var M=H;Array.isArray(H)||(M=H.split("."));for(var O=M.length,U=-1;F&&++U<O;)F=F[M[U]];return F}function R(F){return typeof F=="object"}var D=function(){var F=[],H=0,L={};function M(){for(var O=0,U=F[O],W=1;W<H;){var X=W+1;O=W,X<H&&F[X].score<F[W].score&&(O=X),F[O-1>>1]=F[O],W=1+(O<<1)}for(var N=O-1>>1;O>0&&U.score<F[N].score;N=(O=N)-1>>1)F[O]=F[N];F[O]=U}return L.add=function(O){var U=H;F[H++]=O;for(var W=U-1>>1;U>0&&O.score<F[W].score;W=(U=W)-1>>1)F[U]=F[W];F[U]=O},L.poll=function(){if(H!==0){var O=F[0];return F[0]=F[--H],M(),O}},L.peek=function(O){if(H!==0)return F[0]},L.replaceTop=function(O){F[0]=O,M()},L},A=D();return v()})},6560:s=>{"use strict";s.exports=(E,g=process.argv)=>{const C=E.startsWith("-")?"":E.length===1?"-":"--",x=g.indexOf(C+E),T=g.indexOf("--");return x!==-1&&(T===-1||x<T)}},1171:(s,E,g)=>{s.exports=R,R.Minimatch=D;var C={sep:"/"};try{C=g(5622)}catch(N){}var x=R.GLOBSTAR=D.GLOBSTAR={},T=g(3644),v={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},u="[^/]",d=u+"*?",h="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",b="(?:(?!(?:\\/|^)\\.).)*?",m=l("().*{}+?[]^$\\!");function l(N){return N.split("").reduce(function(V,Y){return V[Y]=!0,V},{})}var f=/\/+/;R.filter=y;function y(N,V){return V=V||{},function(Y,J,oe){return R(Y,N,V)}}function _(N,V){N=N||{},V=V||{};var Y={};return Object.keys(V).forEach(function(J){Y[J]=V[J]}),Object.keys(N).forEach(function(J){Y[J]=N[J]}),Y}R.defaults=function(N){if(!N||!Object.keys(N).length)return R;var V=R,Y=function(oe,G,ie){return V.minimatch(oe,G,_(N,ie))};return Y.Minimatch=function(oe,G){return new V.Minimatch(oe,_(N,G))},Y},D.defaults=function(N){return!N||!Object.keys(N).length?D:R.defaults(N).Minimatch};function R(N,V,Y){if(typeof V!="string")throw new TypeError("glob pattern string required");return Y||(Y={}),!Y.nocomment&&V.charAt(0)==="#"?!1:V.trim()===""?N==="":new D(V,Y).match(N)}function D(N,V){if(!(this instanceof D))return new D(N,V);if(typeof N!="string")throw new TypeError("glob pattern string required");V||(V={}),N=N.trim(),C.sep!=="/"&&(N=N.split(C.sep).join("/")),this.options=V,this.set=[],this.pattern=N,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.make()}D.prototype.debug=function(){},D.prototype.make=A;function A(){if(!this._made){var N=this.pattern,V=this.options;if(!V.nocomment&&N.charAt(0)==="#"){this.comment=!0;return}if(!N){this.empty=!0;return}this.parseNegate();var Y=this.globSet=this.braceExpand();V.debug&&(this.debug=console.error),this.debug(this.pattern,Y),Y=this.globParts=Y.map(function(J){return J.split(f)}),this.debug(this.pattern,Y),Y=Y.map(function(J,oe,G){return J.map(this.parse,this)},this),this.debug(this.pattern,Y),Y=Y.filter(function(J){return J.indexOf(!1)===-1}),this.debug(this.pattern,Y),this.set=Y}}D.prototype.parseNegate=F;function F(){var N=this.pattern,V=!1,Y=this.options,J=0;if(!Y.nonegate){for(var oe=0,G=N.length;oe<G&&N.charAt(oe)==="!";oe++)V=!V,J++;J&&(this.pattern=N.substr(J)),this.negate=V}}R.braceExpand=function(N,V){return H(N,V)},D.prototype.braceExpand=H;function H(N,V){if(V||(this instanceof D?V=this.options:V={}),N=typeof N=="undefined"?this.pattern:N,typeof N=="undefined")throw new TypeError("undefined pattern");return V.nobrace||!N.match(/\{.*\}/)?[N]:T(N)}D.prototype.parse=M;var L={};function M(N,V){if(N.length>1024*64)throw new TypeError("pattern is too long");var Y=this.options;if(!Y.noglobstar&&N==="**")return x;if(N==="")return"";var J="",oe=!!Y.nocase,G=!1,ie=[],le=[],fe,te=!1,ue=-1,ae=-1,ye=N.charAt(0)==="."?"":Y.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",ge=this;function Ee(){if(fe){switch(fe){case"*":J+=d,oe=!0;break;case"?":J+=u,oe=!0;break;default:J+="\\"+fe;break}ge.debug("clearStateChar %j %j",fe,J),fe=!1}}for(var de=0,_e=N.length,xe;de<_e&&(xe=N.charAt(de));de++){if(this.debug("%s	%s %s %j",N,de,J,xe),G&&m[xe]){J+="\\"+xe,G=!1;continue}switch(xe){case"/":return!1;case"\\":Ee(),G=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",N,de,J,xe),te){this.debug("  in class"),xe==="!"&&de===ae+1&&(xe="^"),J+=xe;continue}ge.debug("call clearStateChar %j",fe),Ee(),fe=xe,Y.noext&&Ee();continue;case"(":if(te){J+="(";continue}if(!fe){J+="\\(";continue}ie.push({type:fe,start:de-1,reStart:J.length,open:v[fe].open,close:v[fe].close}),J+=fe==="!"?"(?:(?!(?:":"(?:",this.debug("plType %j %j",fe,J),fe=!1;continue;case")":if(te||!ie.length){J+="\\)";continue}Ee(),oe=!0;var Ae=ie.pop();J+=Ae.close,Ae.type==="!"&&le.push(Ae),Ae.reEnd=J.length;continue;case"|":if(te||!ie.length||G){J+="\\|",G=!1;continue}Ee(),J+="|";continue;case"[":if(Ee(),te){J+="\\"+xe;continue}te=!0,ae=de,ue=J.length,J+=xe;continue;case"]":if(de===ae+1||!te){J+="\\"+xe,G=!1;continue}if(te){var $e=N.substring(ae+1,de);try{RegExp("["+$e+"]")}catch(Sn){var Ve=this.parse($e,L);J=J.substr(0,ue)+"\\["+Ve[0]+"\\]",oe=oe||Ve[1],te=!1;continue}}oe=!0,te=!1,J+=xe;continue;default:Ee(),G?G=!1:m[xe]&&!(xe==="^"&&te)&&(J+="\\"),J+=xe}}for(te&&($e=N.substr(ae+1),Ve=this.parse($e,L),J=J.substr(0,ue)+"\\["+Ve[0],oe=oe||Ve[1]),Ae=ie.pop();Ae;Ae=ie.pop()){var Ue=J.slice(Ae.reStart+Ae.open.length);this.debug("setting tail",J,Ae),Ue=Ue.replace(/((?:\\{2}){0,64})(\\?)\|/g,function(Sn,En,Yr){return Yr||(Yr="\\"),En+En+Yr+"|"}),this.debug(`tail=%j
   %s`,Ue,Ue,Ae,J);var Le=Ae.type==="*"?d:Ae.type==="?"?u:"\\"+Ae.type;oe=!0,J=J.slice(0,Ae.reStart)+Le+"\\("+Ue}Ee(),G&&(J+="\\\\");var Xe=!1;switch(J.charAt(0)){case".":case"[":case"(":Xe=!0}for(var Fe=le.length-1;Fe>-1;Fe--){var ft=le[Fe],Ne=J.slice(0,ft.reStart),er=J.slice(ft.reStart,ft.reEnd-8),tr=J.slice(ft.reEnd-8,ft.reEnd),Ot=J.slice(ft.reEnd);tr+=Ot;var ct=Ne.split("(").length-1,Xr=Ot;for(de=0;de<ct;de++)Xr=Xr.replace(/\)[+*?]?/,"");Ot=Xr;var Lr="";Ot===""&&V!==L&&(Lr="$");var Cn=Ne+er+Ot+Lr+tr;J=Cn}if(J!==""&&oe&&(J="(?=.)"+J),Xe&&(J=ye+J),V===L)return[J,oe];if(!oe)return W(N);var li=Y.nocase?"i":"";try{var St=new RegExp("^"+J+"$",li)}catch(Sn){return new RegExp("$.")}return St._glob=N,St._src=J,St}R.makeRe=function(N,V){return new D(N,V||{}).makeRe()},D.prototype.makeRe=O;function O(){if(this.regexp||this.regexp===!1)return this.regexp;var N=this.set;if(!N.length)return this.regexp=!1,this.regexp;var V=this.options,Y=V.noglobstar?d:V.dot?h:b,J=V.nocase?"i":"",oe=N.map(function(G){return G.map(function(ie){return ie===x?Y:typeof ie=="string"?X(ie):ie._src}).join("\\/")}).join("|");oe="^(?:"+oe+")$",this.negate&&(oe="^(?!"+oe+").*$");try{this.regexp=new RegExp(oe,J)}catch(G){this.regexp=!1}return this.regexp}R.match=function(N,V,Y){Y=Y||{};var J=new D(V,Y);return N=N.filter(function(oe){return J.match(oe)}),J.options.nonull&&!N.length&&N.push(V),N},D.prototype.match=U;function U(N,V){if(this.debug("match",N,this.pattern),this.comment)return!1;if(this.empty)return N==="";if(N==="/"&&V)return!0;var Y=this.options;C.sep!=="/"&&(N=N.split(C.sep).join("/")),N=N.split(f),this.debug(this.pattern,"split",N);var J=this.set;this.debug(this.pattern,"set",J);var oe,G;for(G=N.length-1;G>=0&&(oe=N[G],!oe);G--);for(G=0;G<J.length;G++){var ie=J[G],le=N;Y.matchBase&&ie.length===1&&(le=[oe]);var fe=this.matchOne(le,ie,V);if(fe)return Y.flipNegate?!0:!this.negate}return Y.flipNegate?!1:this.negate}D.prototype.matchOne=function(N,V,Y){var J=this.options;this.debug("matchOne",{this:this,file:N,pattern:V}),this.debug("matchOne",N.length,V.length);for(var oe=0,G=0,ie=N.length,le=V.length;oe<ie&&G<le;oe++,G++){this.debug("matchOne loop");var fe=V[G],te=N[oe];if(this.debug(V,fe,te),fe===!1)return!1;if(fe===x){this.debug("GLOBSTAR",[V,fe,te]);var ue=oe,ae=G+1;if(ae===le){for(this.debug("** at the end");oe<ie;oe++)if(N[oe]==="."||N[oe]===".."||!J.dot&&N[oe].charAt(0)===".")return!1;return!0}for(;ue<ie;){var ye=N[ue];if(this.debug(`
globstar while`,N,ue,V,ae,ye),this.matchOne(N.slice(ue),V.slice(ae),Y))return this.debug("globstar found match!",ue,ie,ye),!0;if(ye==="."||ye===".."||!J.dot&&ye.charAt(0)==="."){this.debug("dot detected!",N,ue,V,ae);break}this.debug("globstar swallow a segment, and continue"),ue++}return!!(Y&&(this.debug(`
>>> no match, partial?`,N,ue,V,ae),ue===ie))}var ge;if(typeof fe=="string"?(J.nocase?ge=te.toLowerCase()===fe.toLowerCase():ge=te===fe,this.debug("string match",fe,te,ge)):(ge=te.match(fe),this.debug("pattern match",fe,te,ge)),!ge)return!1}if(oe===ie&&G===le)return!0;if(oe===ie)return Y;if(G===le){var Ee=oe===ie-1&&N[oe]==="";return Ee}throw new Error("wtf?")};function W(N){return N.replace(/\\(.)/g,"$1")}function X(N){return N.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}},7824:s=>{var E=1e3,g=E*60,C=g*60,x=C*24,T=x*7,v=x*365.25;s.exports=function(m,l){l=l||{};var f=typeof m;if(f==="string"&&m.length>0)return u(m);if(f==="number"&&isFinite(m))return l.long?h(m):d(m);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(m))};function u(m){if(m=String(m),!(m.length>100)){var l=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(m);if(!!l){var f=parseFloat(l[1]),y=(l[2]||"ms").toLowerCase();switch(y){case"years":case"year":case"yrs":case"yr":case"y":return f*v;case"weeks":case"week":case"w":return f*T;case"days":case"day":case"d":return f*x;case"hours":case"hour":case"hrs":case"hr":case"h":return f*C;case"minutes":case"minute":case"mins":case"min":case"m":return f*g;case"seconds":case"second":case"secs":case"sec":case"s":return f*E;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return f;default:return}}}}function d(m){var l=Math.abs(m);return l>=x?Math.round(m/x)+"d":l>=C?Math.round(m/C)+"h":l>=g?Math.round(m/g)+"m":l>=E?Math.round(m/E)+"s":m+"ms"}function h(m){var l=Math.abs(m);return l>=x?b(m,l,x,"day"):l>=C?b(m,l,C,"hour"):l>=g?b(m,l,g,"minute"):l>=E?b(m,l,E,"second"):m+" ms"}function b(m,l,f,y){var _=l>=f*1.5;return Math.round(m/f)+" "+y+(_?"s":"")}},778:(s,E,g)=>{var C=g(2479);s.exports=C(x),s.exports.strict=C(T),x.proto=x(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return x(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return T(this)},configurable:!0})});function x(v){var u=function(){return u.called?u.value:(u.called=!0,u.value=v.apply(this,arguments))};return u.called=!1,u}function T(v){var u=function(){if(u.called)throw new Error(u.onceError);return u.called=!0,u.value=v.apply(this,arguments)},d=v.name||"Function wrapped with `once`";return u.onceError=d+" shouldn't be called more than once",u.called=!1,u}},6625:(s,E)=>{E=s.exports=Ne;var g;typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?g=function(){var j=Array.prototype.slice.call(arguments,0);j.unshift("SEMVER"),console.log.apply(console,j)}:g=function(){},E.SEMVER_SPEC_VERSION="2.0.0";var C=256,x=Number.MAX_SAFE_INTEGER||9007199254740991,T=16,v=E.re=[],u=E.src=[],d=0,h=d++;u[h]="0|[1-9]\\d*";var b=d++;u[b]="[0-9]+";var m=d++;u[m]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var l=d++;u[l]="("+u[h]+")\\.("+u[h]+")\\.("+u[h]+")";var f=d++;u[f]="("+u[b]+")\\.("+u[b]+")\\.("+u[b]+")";var y=d++;u[y]="(?:"+u[h]+"|"+u[m]+")";var _=d++;u[_]="(?:"+u[b]+"|"+u[m]+")";var R=d++;u[R]="(?:-("+u[y]+"(?:\\."+u[y]+")*))";var D=d++;u[D]="(?:-?("+u[_]+"(?:\\."+u[_]+")*))";var A=d++;u[A]="[0-9A-Za-z-]+";var F=d++;u[F]="(?:\\+("+u[A]+"(?:\\."+u[A]+")*))";var H=d++,L="v?"+u[l]+u[R]+"?"+u[F]+"?";u[H]="^"+L+"$";var M="[v=\\s]*"+u[f]+u[D]+"?"+u[F]+"?",O=d++;u[O]="^"+M+"$";var U=d++;u[U]="((?:<|>)?=?)";var W=d++;u[W]=u[b]+"|x|X|\\*";var X=d++;u[X]=u[h]+"|x|X|\\*";var N=d++;u[N]="[v=\\s]*("+u[X]+")(?:\\.("+u[X]+")(?:\\.("+u[X]+")(?:"+u[R]+")?"+u[F]+"?)?)?";var V=d++;u[V]="[v=\\s]*("+u[W]+")(?:\\.("+u[W]+")(?:\\.("+u[W]+")(?:"+u[D]+")?"+u[F]+"?)?)?";var Y=d++;u[Y]="^"+u[U]+"\\s*"+u[N]+"$";var J=d++;u[J]="^"+u[U]+"\\s*"+u[V]+"$";var oe=d++;u[oe]="(?:^|[^\\d])(\\d{1,"+T+"})(?:\\.(\\d{1,"+T+"}))?(?:\\.(\\d{1,"+T+"}))?(?:$|[^\\d])";var G=d++;u[G]="(?:~>?)";var ie=d++;u[ie]="(\\s*)"+u[G]+"\\s+",v[ie]=new RegExp(u[ie],"g");var le="$1~",fe=d++;u[fe]="^"+u[G]+u[N]+"$";var te=d++;u[te]="^"+u[G]+u[V]+"$";var ue=d++;u[ue]="(?:\\^)";var ae=d++;u[ae]="(\\s*)"+u[ue]+"\\s+",v[ae]=new RegExp(u[ae],"g");var ye="$1^",ge=d++;u[ge]="^"+u[ue]+u[N]+"$";var Ee=d++;u[Ee]="^"+u[ue]+u[V]+"$";var de=d++;u[de]="^"+u[U]+"\\s*("+M+")$|^$";var _e=d++;u[_e]="^"+u[U]+"\\s*("+L+")$|^$";var xe=d++;u[xe]="(\\s*)"+u[U]+"\\s*("+M+"|"+u[N]+")",v[xe]=new RegExp(u[xe],"g");var Ae="$1$2$3",$e=d++;u[$e]="^\\s*("+u[N]+")\\s+-\\s+("+u[N]+")\\s*$";var Ve=d++;u[Ve]="^\\s*("+u[V]+")\\s+-\\s+("+u[V]+")\\s*$";var Ue=d++;u[Ue]="(<|>)?=?\\s*\\*";for(var Le=0;Le<d;Le++)g(Le,u[Le]),v[Le]||(v[Le]=new RegExp(u[Le]));E.parse=Xe;function Xe(j,Q){if((!Q||typeof Q!="object")&&(Q={loose:!!Q,includePrerelease:!1}),j instanceof Ne)return j;if(typeof j!="string"||j.length>C)return null;var ne=Q.loose?v[O]:v[H];if(!ne.test(j))return null;try{return new Ne(j,Q)}catch(we){return null}}E.valid=Fe;function Fe(j,Q){var ne=Xe(j,Q);return ne?ne.version:null}E.clean=ft;function ft(j,Q){var ne=Xe(j.trim().replace(/^[=v]+/,""),Q);return ne?ne.version:null}E.SemVer=Ne;function Ne(j,Q){if((!Q||typeof Q!="object")&&(Q={loose:!!Q,includePrerelease:!1}),j instanceof Ne){if(j.loose===Q.loose)return j;j=j.version}else if(typeof j!="string")throw new TypeError("Invalid Version: "+j);if(j.length>C)throw new TypeError("version is longer than "+C+" characters");if(!(this instanceof Ne))return new Ne(j,Q);g("SemVer",j,Q),this.options=Q,this.loose=!!Q.loose;var ne=j.trim().match(Q.loose?v[O]:v[H]);if(!ne)throw new TypeError("Invalid Version: "+j);if(this.raw=j,this.major=+ne[1],this.minor=+ne[2],this.patch=+ne[3],this.major>x||this.major<0)throw new TypeError("Invalid major version");if(this.minor>x||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>x||this.patch<0)throw new TypeError("Invalid patch version");ne[4]?this.prerelease=ne[4].split(".").map(function(we){if(/^[0-9]+$/.test(we)){var Ce=+we;if(Ce>=0&&Ce<x)return Ce}return we}):this.prerelease=[],this.build=ne[5]?ne[5].split("."):[],this.format()}Ne.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},Ne.prototype.toString=function(){return this.version},Ne.prototype.compare=function(j){return g("SemVer.compare",this.version,this.options,j),j instanceof Ne||(j=new Ne(j,this.options)),this.compareMain(j)||this.comparePre(j)},Ne.prototype.compareMain=function(j){return j instanceof Ne||(j=new Ne(j,this.options)),ct(this.major,j.major)||ct(this.minor,j.minor)||ct(this.patch,j.patch)},Ne.prototype.comparePre=function(j){if(j instanceof Ne||(j=new Ne(j,this.options)),this.prerelease.length&&!j.prerelease.length)return-1;if(!this.prerelease.length&&j.prerelease.length)return 1;if(!this.prerelease.length&&!j.prerelease.length)return 0;var Q=0;do{var ne=this.prerelease[Q],we=j.prerelease[Q];if(g("prerelease compare",Q,ne,we),ne===void 0&&we===void 0)return 0;if(we===void 0)return 1;if(ne===void 0)return-1;if(ne===we)continue;return ct(ne,we)}while(++Q)},Ne.prototype.inc=function(j,Q){switch(j){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",Q);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",Q);break;case"prepatch":this.prerelease.length=0,this.inc("patch",Q),this.inc("pre",Q);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",Q),this.inc("pre",Q);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var ne=this.prerelease.length;--ne>=0;)typeof this.prerelease[ne]=="number"&&(this.prerelease[ne]++,ne=-2);ne===-1&&this.prerelease.push(0)}Q&&(this.prerelease[0]===Q?isNaN(this.prerelease[1])&&(this.prerelease=[Q,0]):this.prerelease=[Q,0]);break;default:throw new Error("invalid increment argument: "+j)}return this.format(),this.raw=this.version,this},E.inc=er;function er(j,Q,ne,we){typeof ne=="string"&&(we=ne,ne=void 0);try{return new Ne(j,ne).inc(Q,we).version}catch(Ce){return null}}E.diff=tr;function tr(j,Q){if(di(j,Q))return null;var ne=Xe(j),we=Xe(Q),Ce="";if(ne.prerelease.length||we.prerelease.length){Ce="pre";var ke="prerelease"}for(var De in ne)if((De==="major"||De==="minor"||De==="patch")&&ne[De]!==we[De])return Ce+De;return ke}E.compareIdentifiers=ct;var Ot=/^[0-9]+$/;function ct(j,Q){var ne=Ot.test(j),we=Ot.test(Q);return ne&&we&&(j=+j,Q=+Q),j===Q?0:ne&&!we?-1:we&&!ne?1:j<Q?-1:1}E.rcompareIdentifiers=Xr;function Xr(j,Q){return ct(Q,j)}E.major=Lr;function Lr(j,Q){return new Ne(j,Q).major}E.minor=Cn;function Cn(j,Q){return new Ne(j,Q).minor}E.patch=li;function li(j,Q){return new Ne(j,Q).patch}E.compare=St;function St(j,Q,ne){return new Ne(j,ne).compare(new Ne(Q,ne))}E.compareLoose=Sn;function Sn(j,Q){return St(j,Q,!0)}E.rcompare=En;function En(j,Q,ne){return St(Q,j,ne)}E.sort=Yr;function Yr(j,Q){return j.sort(function(ne,we){return E.compare(ne,we,Q)})}E.rsort=mr;function mr(j,Q){return j.sort(function(ne,we){return E.rcompare(ne,we,Q)})}E.gt=Jr;function Jr(j,Q,ne){return St(j,Q,ne)>0}E.lt=xn;function xn(j,Q,ne){return St(j,Q,ne)<0}E.eq=di;function di(j,Q,ne){return St(j,Q,ne)===0}E.neq=ao;function ao(j,Q,ne){return St(j,Q,ne)!==0}E.gte=fi;function fi(j,Q,ne){return St(j,Q,ne)>=0}E.lte=hi;function hi(j,Q,ne){return St(j,Q,ne)<=0}E.cmp=Tn;function Tn(j,Q,ne,we){switch(Q){case"===":return typeof j=="object"&&(j=j.version),typeof ne=="object"&&(ne=ne.version),j===ne;case"!==":return typeof j=="object"&&(j=j.version),typeof ne=="object"&&(ne=ne.version),j!==ne;case"":case"=":case"==":return di(j,ne,we);case"!=":return ao(j,ne,we);case">":return Jr(j,ne,we);case">=":return fi(j,ne,we);case"<":return xn(j,ne,we);case"<=":return hi(j,ne,we);default:throw new TypeError("Invalid operator: "+Q)}}E.Comparator=Rt;function Rt(j,Q){if((!Q||typeof Q!="object")&&(Q={loose:!!Q,includePrerelease:!1}),j instanceof Rt){if(j.loose===!!Q.loose)return j;j=j.value}if(!(this instanceof Rt))return new Rt(j,Q);g("comparator",j,Q),this.options=Q,this.loose=!!Q.loose,this.parse(j),this.semver===en?this.value="":this.value=this.operator+this.semver.version,g("comp",this)}var en={};Rt.prototype.parse=function(j){var Q=this.options.loose?v[de]:v[_e],ne=j.match(Q);if(!ne)throw new TypeError("Invalid comparator: "+j);this.operator=ne[1],this.operator==="="&&(this.operator=""),ne[2]?this.semver=new Ne(ne[2],this.options.loose):this.semver=en},Rt.prototype.toString=function(){return this.value},Rt.prototype.test=function(j){return g("Comparator.test",j,this.options.loose),this.semver===en?!0:(typeof j=="string"&&(j=new Ne(j,this.options)),Tn(j,this.operator,this.semver,this.options))},Rt.prototype.intersects=function(j,Q){if(!(j instanceof Rt))throw new TypeError("a Comparator is required");(!Q||typeof Q!="object")&&(Q={loose:!!Q,includePrerelease:!1});var ne;if(this.operator==="")return ne=new et(j.value,Q),Rn(this.value,ne,Q);if(j.operator==="")return ne=new et(this.value,Q),Rn(j.semver,ne,Q);var we=(this.operator===">="||this.operator===">")&&(j.operator===">="||j.operator===">"),Ce=(this.operator==="<="||this.operator==="<")&&(j.operator==="<="||j.operator==="<"),ke=this.semver.version===j.semver.version,De=(this.operator===">="||this.operator==="<=")&&(j.operator===">="||j.operator==="<="),je=Tn(this.semver,"<",j.semver,Q)&&(this.operator===">="||this.operator===">")&&(j.operator==="<="||j.operator==="<"),qe=Tn(this.semver,">",j.semver,Q)&&(this.operator==="<="||this.operator==="<")&&(j.operator===">="||j.operator===">");return we||Ce||ke&&De||je||qe},E.Range=et;function et(j,Q){if((!Q||typeof Q!="object")&&(Q={loose:!!Q,includePrerelease:!1}),j instanceof et)return j.loose===!!Q.loose&&j.includePrerelease===!!Q.includePrerelease?j:new et(j.raw,Q);if(j instanceof Rt)return new et(j.value,Q);if(!(this instanceof et))return new et(j,Q);if(this.options=Q,this.loose=!!Q.loose,this.includePrerelease=!!Q.includePrerelease,this.raw=j,this.set=j.split(/\s*\|\|\s*/).map(function(ne){return this.parseRange(ne.trim())},this).filter(function(ne){return ne.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+j);this.format()}et.prototype.format=function(){return this.range=this.set.map(function(j){return j.join(" ").trim()}).join("||").trim(),this.range},et.prototype.toString=function(){return this.range},et.prototype.parseRange=function(j){var Q=this.options.loose;j=j.trim();var ne=Q?v[Ve]:v[$e];j=j.replace(ne,Sa),g("hyphen replace",j),j=j.replace(v[xe],Ae),g("comparator trim",j,v[xe]),j=j.replace(v[ie],le),j=j.replace(v[ae],ye),j=j.split(/\s+/).join(" ");var we=Q?v[de]:v[_e],Ce=j.split(" ").map(function(ke){return va(ke,this.options)},this).join(" ").split(/\s+/);return this.options.loose&&(Ce=Ce.filter(function(ke){return!!ke.match(we)})),Ce=Ce.map(function(ke){return new Rt(ke,this.options)},this),Ce},et.prototype.intersects=function(j,Q){if(!(j instanceof et))throw new TypeError("a Range is required");return this.set.some(function(ne){return ne.every(function(we){return j.set.some(function(Ce){return Ce.every(function(ke){return we.intersects(ke,Q)})})})})},E.toComparators=ma;function ma(j,Q){return new et(j,Q).set.map(function(ne){return ne.map(function(we){return we.value}).join(" ").trim().split(" ")})}function va(j,Q){return g("comp",j,Q),j=wa(j,Q),g("caret",j),j=ya(j,Q),g("tildes",j),j=ba(j,Q),g("xrange",j),j=Ca(j,Q),g("stars",j),j}function at(j){return!j||j.toLowerCase()==="x"||j==="*"}function ya(j,Q){return j.trim().split(/\s+/).map(function(ne){return tn(ne,Q)}).join(" ")}function tn(j,Q){var ne=Q.loose?v[te]:v[fe];return j.replace(ne,function(we,Ce,ke,De,je){g("tilde",j,we,Ce,ke,De,je);var qe;return at(Ce)?qe="":at(ke)?qe=">="+Ce+".0.0 <"+(+Ce+1)+".0.0":at(De)?qe=">="+Ce+"."+ke+".0 <"+Ce+"."+(+ke+1)+".0":je?(g("replaceTilde pr",je),qe=">="+Ce+"."+ke+"."+De+"-"+je+" <"+Ce+"."+(+ke+1)+".0"):qe=">="+Ce+"."+ke+"."+De+" <"+Ce+"."+(+ke+1)+".0",g("tilde return",qe),qe})}function wa(j,Q){return j.trim().split(/\s+/).map(function(ne){return rn(ne,Q)}).join(" ")}function rn(j,Q){g("caret",j,Q);var ne=Q.loose?v[Ee]:v[ge];return j.replace(ne,function(we,Ce,ke,De,je){g("caret",j,we,Ce,ke,De,je);var qe;return at(Ce)?qe="":at(ke)?qe=">="+Ce+".0.0 <"+(+Ce+1)+".0.0":at(De)?Ce==="0"?qe=">="+Ce+"."+ke+".0 <"+Ce+"."+(+ke+1)+".0":qe=">="+Ce+"."+ke+".0 <"+(+Ce+1)+".0.0":je?(g("replaceCaret pr",je),Ce==="0"?ke==="0"?qe=">="+Ce+"."+ke+"."+De+"-"+je+" <"+Ce+"."+ke+"."+(+De+1):qe=">="+Ce+"."+ke+"."+De+"-"+je+" <"+Ce+"."+(+ke+1)+".0":qe=">="+Ce+"."+ke+"."+De+"-"+je+" <"+(+Ce+1)+".0.0"):(g("no pr"),Ce==="0"?ke==="0"?qe=">="+Ce+"."+ke+"."+De+" <"+Ce+"."+ke+"."+(+De+1):qe=">="+Ce+"."+ke+"."+De+" <"+Ce+"."+(+ke+1)+".0":qe=">="+Ce+"."+ke+"."+De+" <"+(+Ce+1)+".0.0"),g("caret return",qe),qe})}function ba(j,Q){return g("replaceXRanges",j,Q),j.split(/\s+/).map(function(ne){return _a(ne,Q)}).join(" ")}function _a(j,Q){j=j.trim();var ne=Q.loose?v[J]:v[Y];return j.replace(ne,function(we,Ce,ke,De,je,qe){g("xRange",j,we,Ce,ke,De,je,qe);var Mt=at(ke),Ut=Mt||at(De),kt=Ut||at(je),Et=kt;return Ce==="="&&Et&&(Ce=""),Mt?Ce===">"||Ce==="<"?we="<0.0.0":we="*":Ce&&Et?(Ut&&(De=0),je=0,Ce===">"?(Ce=">=",Ut?(ke=+ke+1,De=0,je=0):(De=+De+1,je=0)):Ce==="<="&&(Ce="<",Ut?ke=+ke+1:De=+De+1),we=Ce+ke+"."+De+"."+je):Ut?we=">="+ke+".0.0 <"+(+ke+1)+".0.0":kt&&(we=">="+ke+"."+De+".0 <"+ke+"."+(+De+1)+".0"),g("xRange return",we),we})}function Ca(j,Q){return g("replaceStars",j,Q),j.trim().replace(v[Ue],"")}function Sa(j,Q,ne,we,Ce,ke,De,je,qe,Mt,Ut,kt,Et){return at(ne)?Q="":at(we)?Q=">="+ne+".0.0":at(Ce)?Q=">="+ne+"."+we+".0":Q=">="+Q,at(qe)?je="":at(Mt)?je="<"+(+qe+1)+".0.0":at(Ut)?je="<"+qe+"."+(+Mt+1)+".0":kt?je="<="+qe+"."+Mt+"."+Ut+"-"+kt:je="<="+je,(Q+" "+je).trim()}et.prototype.test=function(j){if(!j)return!1;typeof j=="string"&&(j=new Ne(j,this.options));for(var Q=0;Q<this.set.length;Q++)if(Ea(this.set[Q],j,this.options))return!0;return!1};function Ea(j,Q,ne){for(var we=0;we<j.length;we++)if(!j[we].test(Q))return!1;if(Q.prerelease.length&&!ne.includePrerelease){for(we=0;we<j.length;we++)if(g(j[we].semver),j[we].semver!==en&&j[we].semver.prerelease.length>0){var Ce=j[we].semver;if(Ce.major===Q.major&&Ce.minor===Q.minor&&Ce.patch===Q.patch)return!0}return!1}return!0}E.satisfies=Rn;function Rn(j,Q,ne){try{Q=new et(Q,ne)}catch(we){return!1}return Q.test(j)}E.maxSatisfying=xa;function xa(j,Q,ne){var we=null,Ce=null;try{var ke=new et(Q,ne)}catch(De){return null}return j.forEach(function(De){ke.test(De)&&(!we||Ce.compare(De)===-1)&&(we=De,Ce=new Ne(we,ne))}),we}E.minSatisfying=Ta;function Ta(j,Q,ne){var we=null,Ce=null;try{var ke=new et(Q,ne)}catch(De){return null}return j.forEach(function(De){ke.test(De)&&(!we||Ce.compare(De)===1)&&(we=De,Ce=new Ne(we,ne))}),we}E.minVersion=Ra;function Ra(j,Q){j=new et(j,Q);var ne=new Ne("0.0.0");if(j.test(ne)||(ne=new Ne("0.0.0-0"),j.test(ne)))return ne;ne=null;for(var we=0;we<j.set.length;++we){var Ce=j.set[we];Ce.forEach(function(ke){var De=new Ne(ke.semver.version);switch(ke.operator){case">":De.prerelease.length===0?De.patch++:De.prerelease.push(0),De.raw=De.format();case"":case">=":(!ne||Jr(ne,De))&&(ne=De);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+ke.operator)}})}return ne&&j.test(ne)?ne:null}E.validRange=ka;function ka(j,Q){try{return new et(j,Q).range||"*"}catch(ne){return null}}E.ltr=Da;function Da(j,Q,ne){return pi(j,Q,"<",ne)}E.gtr=Ia;function Ia(j,Q,ne){return pi(j,Q,">",ne)}E.outside=pi;function pi(j,Q,ne,we){j=new Ne(j,we),Q=new et(Q,we);var Ce,ke,De,je,qe;switch(ne){case">":Ce=Jr,ke=hi,De=xn,je=">",qe=">=";break;case"<":Ce=xn,ke=fi,De=Jr,je="<",qe="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(Rn(j,Q,we))return!1;for(var Mt=0;Mt<Q.set.length;++Mt){var Ut=Q.set[Mt],kt=null,Et=null;if(Ut.forEach(function(rr){rr.semver===en&&(rr=new Rt(">=0.0.0")),kt=kt||rr,Et=Et||rr,Ce(rr.semver,kt.semver,we)?kt=rr:De(rr.semver,Et.semver,we)&&(Et=rr)}),kt.operator===je||kt.operator===qe||(!Et.operator||Et.operator===je)&&ke(j,Et.semver))return!1;if(Et.operator===qe&&De(j,Et.semver))return!1}return!0}E.prerelease=Aa;function Aa(j,Q){var ne=Xe(j,Q);return ne&&ne.prerelease.length?ne.prerelease:null}E.intersects=Pa;function Pa(j,Q,ne){return j=new et(j,ne),Q=new et(Q,ne),j.intersects(Q)}E.coerce=Oa;function Oa(j){if(j instanceof Ne)return j;if(typeof j!="string")return null;var Q=j.match(v[oe]);return Q==null?null:Xe(Q[1]+"."+(Q[2]||"0")+"."+(Q[3]||"0"))}},6372:s=>{"use strict";function E(h){return typeof h=="function"}var g=console.error.bind(console);function C(h,b,m){var l=!!h[b]&&h.propertyIsEnumerable(b);Object.defineProperty(h,b,{configurable:!0,enumerable:l,writable:!0,value:m})}function x(h){h&&h.logger&&(E(h.logger)?g=h.logger:g("new logger isn't a function, not replacing"))}function T(h,b,m){if(!h||!h[b]){g("no original function "+b+" to wrap");return}if(!m){g("no wrapper function"),g(new Error().stack);return}if(!E(h[b])||!E(m)){g("original object and wrapper must be functions");return}var l=h[b],f=m(l,b);return C(f,"__original",l),C(f,"__unwrap",function(){h[b]===f&&C(h,b,l)}),C(f,"__wrapped",!0),C(h,b,f),f}function v(h,b,m){if(h)Array.isArray(h)||(h=[h]);else{g("must provide one or more modules to patch"),g(new Error().stack);return}if(!(b&&Array.isArray(b))){g("must provide one or more functions to wrap on modules");return}h.forEach(function(l){b.forEach(function(f){T(l,f,m)})})}function u(h,b){if(!h||!h[b]){g("no function to unwrap."),g(new Error().stack);return}if(!h[b].__unwrap)g("no original to unwrap to -- has "+b+" already been unwrapped?");else return h[b].__unwrap()}function d(h,b){if(h)Array.isArray(h)||(h=[h]);else{g("must provide one or more modules to patch"),g(new Error().stack);return}if(!(b&&Array.isArray(b))){g("must provide one or more functions to unwrap on modules");return}h.forEach(function(m){b.forEach(function(l){u(m,l)})})}x.wrap=T,x.massWrap=v,x.unwrap=u,x.massUnwrap=d,s.exports=x},465:s=>{function E(g){try{return Error.prototype.toString.call(g)}catch(C){try{return"<error: "+C+">"}catch(x){return"<error>"}}}s.exports=function(C,x){var T=[];T.push(E(C));for(var v=0;v<x.length;v++){var u=x[v],d;try{d=u.toString()}catch(h){try{d="<error: "+h+">"}catch(b){d="<error>"}}T.push("    at "+d)}return T.join(`
`)}},2512:(s,E,g)=>{if(global._stackChain)if(global._stackChain.version===g(9414).i8)s.exports=global._stackChain;else throw new Error("Conflicting version of stack-chain found");else s.exports=global._stackChain=g(7898)},9414:s=>{"use strict";s.exports={i8:"1.3.7"}},7898:(s,E,g)=>{var C=g(465);function x(){this.extend=new u,this.filter=new u,this.format=new d,this.version=g(9414).i8}var T=!1;x.prototype.callSite=function l(f){f||(f={}),T=!0;var y={};Error.captureStackTrace(y,l);var _=y.stack;return T=!1,_=_.slice(f.slice||0),f.extend&&(_=this.extend._modify(y,_)),f.filter&&(_=this.filter._modify(y,_)),_};var v=new x;function u(){this._modifiers=[]}u.prototype._modify=function(l,f){for(var y=0,_=this._modifiers.length;y<_;y++)f=this._modifiers[y](l,f);return f},u.prototype.attach=function(l){this._modifiers.push(l)},u.prototype.deattach=function(l){var f=this._modifiers.indexOf(l);return f===-1?!1:(this._modifiers.splice(f,1),!0)};function d(){this._formater=C,this._previous=void 0}d.prototype.replace=function(l){l?this._formater=l:this.restore()},d.prototype.restore=function(){this._formater=C,this._previous=void 0},d.prototype._backup=function(){this._previous=this._formater},d.prototype._roolback=function(){this._previous===C?this.replace(void 0):this.replace(this._previous),this._previous=void 0},Error.prepareStackTrace&&v.format.replace(Error.prepareStackTrace);var h=!1;function b(l,f){if(T)return f;if(h)return C(l,f);var y=f.concat();y=v.extend._modify(l,y),y=v.filter._modify(l,y),y=y.slice(0,Error.stackTraceLimit),Object.isExtensible(l)&&Object.getOwnPropertyDescriptor(l,"callSite")===void 0&&(l.callSite={original:f,mutated:y}),h=!0;var _=v.format._formater(l,y);return h=!1,_}Object.defineProperty(Error,"prepareStackTrace",{get:function(){return b},set:function(l){l===b?v.format._roolback():(v.format._backup(),v.format.replace(l))}});function m(){return this.stack,this.callSite}Object.defineProperty(Error.prototype,"callSite",{get:m,set:function(l){Object.defineProperty(this,"callSite",{value:l,writable:!0,configurable:!0})},configurable:!0}),s.exports=v},2130:(s,E,g)=>{"use strict";const C=g(2087),x=g(3867),T=g(6560),{env:v}=process;let u;T("no-color")||T("no-colors")||T("color=false")||T("color=never")?u=0:(T("color")||T("colors")||T("color=true")||T("color=always"))&&(u=1),"FORCE_COLOR"in v&&(v.FORCE_COLOR==="true"?u=1:v.FORCE_COLOR==="false"?u=0:u=v.FORCE_COLOR.length===0?1:Math.min(parseInt(v.FORCE_COLOR,10),3));function d(m){return m===0?!1:{level:m,hasBasic:!0,has256:m>=2,has16m:m>=3}}function h(m,l){if(u===0)return 0;if(T("color=16m")||T("color=full")||T("color=truecolor"))return 3;if(T("color=256"))return 2;if(m&&!l&&u===void 0)return 0;const f=u||0;if(v.TERM==="dumb")return f;if(process.platform==="win32"){const y=C.release().split(".");return Number(y[0])>=10&&Number(y[2])>=10586?Number(y[2])>=14931?3:2:1}if("CI"in v)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some(y=>y in v)||v.CI_NAME==="codeship"?1:f;if("TEAMCITY_VERSION"in v)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(v.TEAMCITY_VERSION)?1:0;if(v.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in v){const y=parseInt((v.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(v.TERM_PROGRAM){case"iTerm.app":return y>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(v.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(v.TERM)||"COLORTERM"in v?1:f}function b(m){const l=h(m,m&&m.isTTY);return d(l)}s.exports={supportsColor:b,stdout:d(h(!0,x.isatty(1))),stderr:d(h(!0,x.isatty(2)))}},4398:(s,E,g)=>{"use strict";var C;C={value:!0},process.env.APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL=!0;var x=g(5747),T=g(2087),v=g(5622),u=g(7549),d=g(9574),h=function(){function b(m,l,f,y){var _=this;this.extensionId=m,this.extensionVersion=l,this.firstParty=!1,this.userOptIn=!1,this.firstParty=!!y;var R=process.env.VSCODE_LOGS||"";R&&m&&process.env.VSCODE_LOG_LEVEL==="trace"&&(R=v.join(R,m+".txt"),this.logStream=x.createWriteStream(R,{flags:"a",encoding:"utf8",autoClose:!0})),this.updateUserOptIn(f),u.env.onDidChangeTelemetryEnabled!==void 0?this.optOutListener=u.env.onDidChangeTelemetryEnabled(function(){return _.updateUserOptIn(f)}):this.optOutListener=u.workspace.onDidChangeConfiguration(function(){return _.updateUserOptIn(f)})}return b.prototype.updateUserOptIn=function(m){var l=u.workspace.getConfiguration(b.TELEMETRY_CONFIG_ID),f=u.env.isTelemetryEnabled===void 0?l.get(b.TELEMETRY_CONFIG_ENABLED_ID,!0):u.env.isTelemetryEnabled;this.userOptIn!==f&&(this.userOptIn=f,this.userOptIn?this.createAppInsightsClient(m):this.dispose())},b.prototype.createAppInsightsClient=function(m){d.defaultClient?(this.appInsightsClient=new d.TelemetryClient(m),this.appInsightsClient.channel.setUseDiskRetryCaching(!0)):(d.setup(m).setAutoCollectRequests(!1).setAutoCollectPerformance(!1).setAutoCollectExceptions(!1).setAutoCollectDependencies(!1).setAutoDependencyCorrelation(!1).setAutoCollectConsole(!1).setUseDiskRetryCaching(!0).start(),this.appInsightsClient=d.defaultClient),this.appInsightsClient.commonProperties=this.getCommonProperties(),u&&u.env&&(this.appInsightsClient.context.tags[this.appInsightsClient.context.keys.userId]=u.env.machineId,this.appInsightsClient.context.tags[this.appInsightsClient.context.keys.sessionId]=u.env.sessionId),m&&m.indexOf("AIF-")===0&&(this.appInsightsClient.config.endpointUrl="https://vortex.data.microsoft.com/collect/v1",this.firstParty=!0)},b.prototype.getCommonProperties=function(){var m=Object.create(null);if(m["common.os"]=T.platform(),m["common.platformversion"]=(T.release()||"").replace(/^(\d+)(\.\d+)?(\.\d+)?(.*)/,"$1$2$3"),m["common.extname"]=this.extensionId,m["common.extversion"]=this.extensionVersion,u&&u.env){switch(m["common.vscodemachineid"]=u.env.machineId,m["common.vscodesessionid"]=u.env.sessionId,m["common.vscodeversion"]=u.version,m["common.isnewappinstall"]=u.env.isNewAppInstall,u.env.uiKind){case u.UIKind.Web:m["common.uikind"]="web";break;case u.UIKind.Desktop:m["common.uikind"]="desktop";break;default:m["common.uikind"]="unknown"}m["common.remotename"]=this.cleanRemoteName(u.env.remoteName)}return m},b.prototype.cleanRemoteName=function(m){if(!m)return"none";var l="other";return["ssh-remote","dev-container","attached-container","wsl"].forEach(function(f){m.indexOf(f+"+")===0&&(l=f)}),l},b.prototype.shouldSendErrorTelemetry=function(){return this.firstParty?this.cleanRemoteName(u.env.remoteName)!=="other"?!0:!(this.extension===void 0||this.extension.extensionKind===u.ExtensionKind.Workspace||u.env.uiKind===u.UIKind.Web):!0},Object.defineProperty(b.prototype,"extension",{get:function(){return this._extension===void 0&&(this._extension=u.extensions.getExtension(this.extensionId)),this._extension},enumerable:!1,configurable:!0}),b.prototype.cloneAndChange=function(m,l){if(m===null||typeof m!="object"||typeof l!="function")return m;var f={};for(var y in m)f[y]=l(y,m[y]);return f},b.prototype.anonymizeFilePaths=function(m,l){if(m==null)return"";var f=[new RegExp(u.env.appRoot.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi")];this.extension&&f.push(new RegExp(this.extension.extensionPath.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi"));var y=m;if(l){for(var _=[],R=0,D=f;R<D.length;R++)for(var A=D[R];;){var F=A.exec(m);if(!F)break;_.push([F.index,A.lastIndex])}var H=/^[\\\/]?(node_modules|node_modules\.asar)[\\\/]/,L=/(file:\/\/)?([a-zA-Z]:(\\\\|\\|\/)|(\\\\|\\|\/))?([\w-\._]+(\\\\|\\|\/))+[\w-\._]*/g,M=0;y="";for(var O=function(){var N=L.exec(m);if(!N)return"break";!H.test(N[0])&&_.every(function(V){var Y=V[0],J=V[1];return N.index<Y||N.index>=J})&&(y+=m.substring(M,N.index)+"<REDACTED: user-file-path>",M=L.lastIndex)};;){var U=O();if(U==="break")break}M<m.length&&(y+=m.substr(M))}for(var W=0,X=f;W<X.length;W++){var A=X[W];y=y.replace(A,"")}return y},b.prototype.sendTelemetryEvent=function(m,l,f){var y=this;if(this.userOptIn&&m&&this.appInsightsClient){var _=this.cloneAndChange(l,function(R,D){return y.anonymizeFilePaths(D,y.firstParty)});this.appInsightsClient.trackEvent({name:this.extensionId+"/"+m,properties:_,measurements:f}),this.logStream&&this.logStream.write("telemetry/"+m+" "+JSON.stringify({properties:l,measurements:f})+`
`)}},b.prototype.sendTelemetryErrorEvent=function(m,l,f,y){var _=this;if(this.userOptIn&&m&&this.appInsightsClient){var R=this.cloneAndChange(l,function(D,A){return _.shouldSendErrorTelemetry()?_.anonymizeFilePaths(A,_.firstParty):y===void 0||y.indexOf(D)!==-1?"REDACTED":_.anonymizeFilePaths(A,_.firstParty)});this.appInsightsClient.trackEvent({name:this.extensionId+"/"+m,properties:R,measurements:f}),this.logStream&&this.logStream.write("telemetry/"+m+" "+JSON.stringify({properties:l,measurements:f})+`
`)}},b.prototype.sendTelemetryException=function(m,l,f){var y=this;if(this.shouldSendErrorTelemetry()&&this.userOptIn&&m&&this.appInsightsClient){var _=this.cloneAndChange(l,function(R,D){return y.anonymizeFilePaths(D,y.firstParty)});this.appInsightsClient.trackException({exception:m,properties:_,measurements:f}),this.logStream&&this.logStream.write("telemetry/"+m.name+" "+m.message+" "+JSON.stringify({properties:l,measurements:f})+`
`)}},b.prototype.dispose=function(){var m=this;this.optOutListener.dispose();var l=new Promise(function(y){if(!m.logStream)return y(void 0);m.logStream.on("finish",y),m.logStream.end()}),f=new Promise(function(y){m.appInsightsClient?m.appInsightsClient.flush({callback:function(){m.appInsightsClient=void 0,y(void 0)}}):y(void 0)});return Promise.all([f,l])},b.TELEMETRY_CONFIG_ID="telemetry",b.TELEMETRY_CONFIG_ENABLED_ID="enableTelemetry",b}();E.Z=h},800:(s,E,g)=>{"use strict";Object.defineProperty(E,"__esModule",{value:!0}),E.config=E.loadMessageBundle=E.localize=E.format=E.setPseudo=E.isPseudo=E.isDefined=E.BundleFormat=E.MessageFormat=void 0;var C=g(1926),x;(function(f){f.file="file",f.bundle="bundle",f.both="both"})(x=E.MessageFormat||(E.MessageFormat={}));var T;(function(f){f.standalone="standalone",f.languagePack="languagePack"})(T=E.BundleFormat||(E.BundleFormat={}));var v;(function(f){function y(_){var R=_;return R&&u(R.key)&&u(R.comment)}f.is=y})(v||(v={}));function u(f){return typeof f!="undefined"}E.isDefined=u,E.isPseudo=!1;function d(f){E.isPseudo=f}E.setPseudo=d;function h(f,y){var _;return E.isPseudo&&(f="\uFF3B"+f.replace(/[aouei]/g,"$&$&")+"\uFF3D"),y.length===0?_=f:_=f.replace(/\{(\d+)\}/g,function(R,D){var A=D[0],F=y[A],H=R;return typeof F=="string"?H=F:(typeof F=="number"||typeof F=="boolean"||F===void 0||F===null)&&(H=String(F)),H}),_}E.format=h;function b(f,y){for(var _=[],R=2;R<arguments.length;R++)_[R-2]=arguments[R];return h(y,_)}E.localize=b;function m(f){return C.default().loadMessageBundle(f)}E.loadMessageBundle=m;function l(f){return C.default().config(f)}E.config=l},1926:(s,E)=>{"use strict";Object.defineProperty(E,"__esModule",{value:!0});var g;function C(){if(g===void 0)throw new Error("No runtime abstraction layer installed");return g}(function(x){function T(v){if(v===void 0)throw new Error("No runtime abstraction layer provided");g=v}x.install=T})(C||(C={})),E.default=C},8472:(s,E,g)=>{"use strict";var C;C={value:!0},C=E.LV=void 0;var x=g(5622),T=g(5747),v=g(1926),u=g(800),d=g(800);C={enumerable:!0,get:function(){return d.MessageFormat}},C={enumerable:!0,get:function(){return d.BundleFormat}};var h=Object.prototype.toString;function b(G){return h.call(G)==="[object Number]"}function m(G){return h.call(G)==="[object String]"}function l(G){return G===!0||G===!1}function f(G){return JSON.parse(T.readFileSync(G,"utf8"))}var y,_;function R(){if(_={locale:void 0,language:void 0,languagePackSupport:!1,cacheLanguageResolution:!0,messageFormat:u.MessageFormat.bundle},m(process.env.VSCODE_NLS_CONFIG))try{var G=JSON.parse(process.env.VSCODE_NLS_CONFIG),ie=void 0;if(G.availableLanguages){var le=G.availableLanguages["*"];m(le)&&(ie=le)}if(m(G.locale)&&(_.locale=G.locale.toLowerCase()),ie===void 0?_.language=_.locale:ie!=="en"&&(_.language=ie),l(G._languagePackSupport)&&(_.languagePackSupport=G._languagePackSupport),m(G._cacheRoot)&&(_.cacheRoot=G._cacheRoot),m(G._languagePackId)&&(_.languagePackId=G._languagePackId),m(G._translationsConfigFile)){_.translationsConfigFile=G._translationsConfigFile;try{_.translationsConfig=f(_.translationsConfigFile)}catch(te){if(G._corruptedFile){var fe=x.dirname(G._corruptedFile);T.exists(fe,function(ue){ue&&T.writeFile(G._corruptedFile,"corrupted","utf8",function(ae){console.error(ae)})})}}}}catch(te){}u.setPseudo(_.locale==="pseudo"),y=Object.create(null)}R();function D(){return _.languagePackSupport===!0&&_.cacheRoot!==void 0&&_.languagePackId!==void 0&&_.translationsConfigFile!==void 0&&_.translationsConfig!==void 0}function A(G){return function(ie,le){for(var fe=[],te=2;te<arguments.length;te++)fe[te-2]=arguments[te];if(b(ie)){if(ie>=G.length){console.error(`Broken localize call found. Index out of bounds. Stacktrace is
: `+new Error("").stack);return}return u.format(G[ie],fe)}else{if(m(le))return console.warn("Message "+le+" didn't get externalized correctly."),u.format(le,fe);console.error(`Broken localize call found. Stacktrace is
: `+new Error("").stack)}}}function F(G){var ie;if(_.cacheLanguageResolution&&ie)ie=ie;else{if(u.isPseudo||!_.language)ie=".nls.json";else for(var le=_.language;le;){var fe=".nls."+le+".json";if(T.existsSync(G+fe)){ie=fe;break}else{var te=le.lastIndexOf("-");te>0?le=le.substring(0,te):(ie=".nls.json",le=null)}}_.cacheLanguageResolution&&(ie=ie)}return G+ie}function H(G){for(var ie=_.language;ie;){var le=x.join(G,"nls.bundle."+ie+".json");if(T.existsSync(le))return le;var fe=ie.lastIndexOf("-");fe>0?ie=ie.substring(0,fe):ie=void 0}if(ie===void 0){var le=x.join(G,"nls.bundle.json");if(T.existsSync(le))return le}}function L(G){try{T.mkdirSync(G)}catch(le){if(le.code==="EEXIST")return;if(le.code==="ENOENT"){var ie=x.dirname(G);ie!==G&&(L(ie),T.mkdirSync(G))}else throw le}}function M(G){var ie=f(x.join(G,"nls.metadata.json")),le=Object.create(null);for(var fe in ie){var te=ie[fe];le[fe]=te.messages}return le}function O(G,ie){var le=_.translationsConfig[G.id];if(!!le){var fe=f(le).contents,te=f(x.join(ie,"nls.metadata.json")),ue=Object.create(null);for(var ae in te){var ye=te[ae],ge=fe[G.outDir+"/"+ae];if(ge){for(var Ee=[],de=0;de<ye.keys.length;de++){var _e=ye.keys[de],xe=m(_e)?_e:_e.key,Ae=ge[xe];Ae===void 0&&(Ae=ye.messages[de]),Ee.push(Ae)}ue[ae]=Ee}else ue[ae]=ye.messages}return ue}}function U(G){var ie=new Date;T.utimes(G,ie,ie,function(){})}function W(G,ie){return y[G]=ie,ie}function X(G,ie){var le,fe=x.join(_.cacheRoot,G.id+"-"+G.hash+".json"),te=!1,ue=!1;try{return le=JSON.parse(T.readFileSync(fe,{encoding:"utf8",flag:"r"})),U(fe),le}catch(ae){if(ae.code==="ENOENT")ue=!0;else if(ae instanceof SyntaxError)console.log("Syntax error parsing message bundle: "+ae.message+"."),T.unlink(fe,function(ye){ye&&console.error("Deleting corrupted bundle "+fe+" failed.")}),te=!0;else throw ae}if(le=O(G,ie),!le||te)return le;if(ue)try{T.writeFileSync(fe,JSON.stringify(le),{encoding:"utf8",flag:"wx"})}catch(ae){if(ae.code==="EEXIST")return le;throw ae}return le}function N(G){try{return M(G)}catch(ie){console.log("Generating default bundle from meta data failed.",ie);return}}function V(G,ie){var le;if(D())try{le=X(G,ie)}catch(te){console.log("Load or create bundle failed ",te)}if(!le){if(_.languagePackSupport)return N(ie);var fe=H(ie);if(fe)try{return f(fe)}catch(te){console.log("Loading in the box message bundle failed.",te)}le=N(ie)}return le}function Y(G){for(var ie,le=x.dirname(G);ie=x.join(le,"nls.metadata.header.json"),!T.existsSync(ie);){var fe=x.dirname(le);if(fe===le){ie=void 0;break}else le=fe}return ie}function J(G){if(!G)return u.localize;var ie=x.extname(G);if(ie&&(G=G.substr(0,G.length-ie.length)),_.messageFormat===u.MessageFormat.both||_.messageFormat===u.MessageFormat.bundle){var le=Y(G);if(le){var fe=x.dirname(le),te=y[fe];if(te===void 0)try{var ue=JSON.parse(T.readFileSync(le,"utf8"));try{var ae=V(ue,fe);te=W(fe,ae?{header:ue,nlsBundle:ae}:null)}catch(de){console.error("Failed to load nls bundle",de),te=W(fe,null)}}catch(de){console.error("Failed to read header file",de),te=W(fe,null)}if(te){var ye=G.substr(fe.length+1).replace(/\\/g,"/"),ge=te.nlsBundle[ye];return ge===void 0?(console.error("Messages for file "+G+" not found. See console for details."),function(){return"Messages not found."}):A(ge)}}}if(_.messageFormat===u.MessageFormat.both||_.messageFormat===u.MessageFormat.file)try{var Ee=f(F(G));return Array.isArray(Ee)?A(Ee):u.isDefined(Ee.messages)&&u.isDefined(Ee.keys)?A(Ee.messages):(console.error("String bundle '"+G+"' uses an unsupported format."),function(){return"File bundle has unsupported format. See console for details"})}catch(de){de.code!=="ENOENT"&&console.error("Failed to load single file bundle",de)}return console.error("Failed to load message bundle for file "+G),function(){return"Failed to load message bundle. See console for details."}}E.LV=J;function oe(G){return G&&(m(G.locale)&&(_.locale=G.locale.toLowerCase(),_.language=_.locale,y=Object.create(null)),G.messageFormat!==void 0&&(_.messageFormat=G.messageFormat),G.bundleFormat===u.BundleFormat.standalone&&_.languagePackSupport===!0&&(_.languagePackSupport=!1)),u.setPseudo(_.locale==="pseudo"),J}C=oe,v.default.install(Object.freeze({loadMessageBundle:J,config:oe}))},2479:s=>{s.exports=E;function E(g,C){if(g&&C)return E(g)(C);if(typeof g!="function")throw new TypeError("need wrapper function");return Object.keys(g).forEach(function(T){x[T]=g[T]}),x;function x(){for(var T=new Array(arguments.length),v=0;v<T.length;v++)T[v]=arguments[v];var u=g.apply(this,T),d=T[T.length-1];return typeof u=="function"&&u!==d&&Object.keys(d).forEach(function(h){u[h]=d[h]}),u}}},8921:s=>{"use strict";s.exports=require("@opentelemetry/tracing")},6591:s=>{"use strict";s.exports=require("applicationinsights-native-metrics")},2357:s=>{"use strict";s.exports=require("assert")},7303:s=>{"use strict";s.exports=require("async_hooks")},3129:s=>{"use strict";s.exports=require("child_process")},7082:s=>{"use strict";s.exports=require("console")},7619:s=>{"use strict";s.exports=require("constants")},6417:s=>{"use strict";s.exports=require("crypto")},881:s=>{"use strict";s.exports=require("dns")},8614:s=>{"use strict";s.exports=require("events")},5747:s=>{"use strict";s.exports=require("fs")},8605:s=>{"use strict";s.exports=require("http")},7211:s=>{"use strict";s.exports=require("https")},2282:s=>{"use strict";s.exports=require("module")},1631:s=>{"use strict";s.exports=require("net")},2087:s=>{"use strict";s.exports=require("os")},5622:s=>{"use strict";s.exports=require("path")},2413:s=>{"use strict";s.exports=require("stream")},8213:s=>{"use strict";s.exports=require("timers")},3867:s=>{"use strict";s.exports=require("tty")},8835:s=>{"use strict";s.exports=require("url")},1669:s=>{"use strict";s.exports=require("util")},7549:s=>{"use strict";s.exports=require("vscode")},8761:s=>{"use strict";s.exports=require("zlib")}},Ic={};function ze(s){var E=Ic[s];if(E!==void 0)return E.exports;var g=Ic[s]={exports:{}};return Wf[s].call(g.exports,g,g.exports,ze),g.exports}(()=>{ze.n=s=>{var E=s&&s.__esModule?()=>s.default:()=>s;return ze.d(E,{a:E}),E}})(),(()=>{var s=Object.getPrototypeOf?g=>Object.getPrototypeOf(g):g=>g.__proto__,E;ze.t=function(g,C){if(C&1&&(g=this(g)),C&8||typeof g=="object"&&g&&(C&4&&g.__esModule||C&16&&typeof g.then=="function"))return g;var x=Object.create(null);ze.r(x);var T={};E=E||[null,s({}),s([]),s(s)];for(var v=C&2&&g;typeof v=="object"&&!~E.indexOf(v);v=s(v))Object.getOwnPropertyNames(v).forEach(u=>T[u]=()=>g[u]);return T.default=()=>g,ze.d(x,T),x}})(),(()=>{ze.d=(s,E)=>{for(var g in E)ze.o(E,g)&&!ze.o(s,g)&&Object.defineProperty(s,g,{enumerable:!0,get:E[g]})}})(),(()=>{ze.o=(s,E)=>Object.prototype.hasOwnProperty.call(s,E)})(),(()=>{ze.r=s=>{typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})}})();var ga={};(()=>{"use strict";ze.r(ga),ze.d(ga,{activate:()=>zb,getOpenActionsService:()=>Lf,showRepositoryNotFoundMessage:()=>xc});var s=ze(7549),E=ze(8472);function g(){this.__data__=[],this.size=0}const C=g;function x(e,t){return e===t||e!==e&&t!==t}const T=x;function v(e,t){for(var r=e.length;r--;)if(T(e[r][0],t))return r;return-1}const u=v;var d=Array.prototype,h=d.splice;function b(e){var t=this.__data__,r=u(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():h.call(t,r,1),--this.size,!0}const m=b;function l(e){var t=this.__data__,r=u(t,e);return r<0?void 0:t[r][1]}const f=l;function y(e){return u(this.__data__,e)>-1}const _=y;function R(e,t){var r=this.__data__,n=u(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}const D=R;function A(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}A.prototype.clear=C,A.prototype.delete=m,A.prototype.get=f,A.prototype.has=_,A.prototype.set=D;const F=A;function H(){this.__data__=new F,this.size=0}const L=H;function M(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}const O=M;function U(e){return this.__data__.get(e)}const W=U;function X(e){return this.__data__.has(e)}const N=X;var V=typeof global=="object"&&global&&global.Object===Object&&global;const Y=V;var J=typeof self=="object"&&self&&self.Object===Object&&self,oe=Y||J||Function("return this")();const G=oe;var ie=G.Symbol;const le=ie;var fe=Object.prototype,te=fe.hasOwnProperty,ue=fe.toString,ae=le?le.toStringTag:void 0;function ye(e){var t=te.call(e,ae),r=e[ae];try{e[ae]=void 0;var n=!0}catch(o){}var i=ue.call(e);return n&&(t?e[ae]=r:delete e[ae]),i}const ge=ye;var Ee=Object.prototype,de=Ee.toString;function _e(e){return de.call(e)}const xe=_e;var Ae="[object Null]",$e="[object Undefined]",Ve=le?le.toStringTag:void 0;function Ue(e){return e==null?e===void 0?$e:Ae:Ve&&Ve in Object(e)?ge(e):xe(e)}const Le=Ue;function Xe(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}const Fe=Xe;var ft="[object AsyncFunction]",Ne="[object Function]",er="[object GeneratorFunction]",tr="[object Proxy]";function Ot(e){if(!Fe(e))return!1;var t=Le(e);return t==Ne||t==er||t==ft||t==tr}const ct=Ot;var Xr=G["__core-js_shared__"];const Lr=Xr;var Cn=function(){var e=/[^.]+$/.exec(Lr&&Lr.keys&&Lr.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function li(e){return!!Cn&&Cn in e}const St=li;var Sn=Function.prototype,En=Sn.toString;function Yr(e){if(e!=null){try{return En.call(e)}catch(t){}try{return e+""}catch(t){}}return""}const mr=Yr;var Jr=/[\\^$.*+?()[\]{}|]/g,xn=/^\[object .+?Constructor\]$/,di=Function.prototype,ao=Object.prototype,fi=di.toString,hi=ao.hasOwnProperty,Tn=RegExp("^"+fi.call(hi).replace(Jr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Rt(e){if(!Fe(e)||St(e))return!1;var t=ct(e)?Tn:xn;return t.test(mr(e))}const en=Rt;function et(e,t){return e==null?void 0:e[t]}const ma=et;function va(e,t){var r=ma(e,t);return en(r)?r:void 0}const at=va;var ya=at(G,"Map");const tn=ya;var wa=at(Object,"create");const rn=wa;function ba(){this.__data__=rn?rn(null):{},this.size=0}const _a=ba;function Ca(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}const Sa=Ca;var Ea="__lodash_hash_undefined__",Rn=Object.prototype,xa=Rn.hasOwnProperty;function Ta(e){var t=this.__data__;if(rn){var r=t[e];return r===Ea?void 0:r}return xa.call(t,e)?t[e]:void 0}const Ra=Ta;var ka=Object.prototype,Da=ka.hasOwnProperty;function Ia(e){var t=this.__data__;return rn?t[e]!==void 0:Da.call(t,e)}const pi=Ia;var Aa="__lodash_hash_undefined__";function Pa(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=rn&&t===void 0?Aa:t,this}const Oa=Pa;function j(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}j.prototype.clear=_a,j.prototype.delete=Sa,j.prototype.get=Ra,j.prototype.has=pi,j.prototype.set=Oa;const Q=j;function ne(){this.size=0,this.__data__={hash:new Q,map:new(tn||F),string:new Q}}const we=ne;function Ce(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}const ke=Ce;function De(e,t){var r=e.__data__;return ke(t)?r[typeof t=="string"?"string":"hash"]:r.map}const je=De;function qe(e){var t=je(this,e).delete(e);return this.size-=t?1:0,t}const Mt=qe;function Ut(e){return je(this,e).get(e)}const kt=Ut;function Et(e){return je(this,e).has(e)}const rr=Et;function Vf(e,t){var r=je(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}const Gf=Vf;function kn(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}kn.prototype.clear=we,kn.prototype.delete=Mt,kn.prototype.get=kt,kn.prototype.has=rr,kn.prototype.set=Gf;const Ac=kn;var Kf=200;function Qf(e,t){var r=this.__data__;if(r instanceof F){var n=r.__data__;if(!tn||n.length<Kf-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Ac(n)}return r.set(e,t),this.size=r.size,this}const Zf=Qf;function Dn(e){var t=this.__data__=new F(e);this.size=t.size}Dn.prototype.clear=L,Dn.prototype.delete=O,Dn.prototype.get=W,Dn.prototype.has=N,Dn.prototype.set=Zf;const Na=Dn;var Xf="__lodash_hash_undefined__";function Yf(e){return this.__data__.set(e,Xf),this}const Jf=Yf;function eh(e){return this.__data__.has(e)}const th=eh;function so(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new Ac;++t<r;)this.add(e[t])}so.prototype.add=so.prototype.push=Jf,so.prototype.has=th;const rh=so;function nh(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}const ih=nh;function oh(e,t){return e.has(t)}const ah=oh;var sh=1,ch=2;function uh(e,t,r,n,i,o){var a=r&sh,c=e.length,w=t.length;if(c!=w&&!(a&&w>c))return!1;var p=o.get(e),S=o.get(t);if(p&&S)return p==t&&S==e;var P=-1,k=!0,I=r&ch?new rh:void 0;for(o.set(e,t),o.set(t,e);++P<c;){var $=e[P],B=t[P];if(n)var q=a?n(B,$,P,t,e,o):n($,B,P,e,t,o);if(q!==void 0){if(q)continue;k=!1;break}if(I){if(!ih(t,function(Z,K){if(!ah(I,K)&&($===Z||i($,Z,r,n,o)))return I.push(K)})){k=!1;break}}else if(!($===B||i($,B,r,n,o))){k=!1;break}}return o.delete(e),o.delete(t),k}const Pc=uh;var lh=G.Uint8Array;const Oc=lh;function dh(e){var t=-1,r=Array(e.size);return e.forEach(function(n,i){r[++t]=[i,n]}),r}const fh=dh;function hh(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}const ph=hh;var gh=1,mh=2,vh="[object Boolean]",yh="[object Date]",wh="[object Error]",bh="[object Map]",_h="[object Number]",Ch="[object RegExp]",Sh="[object Set]",Eh="[object String]",xh="[object Symbol]",Th="[object ArrayBuffer]",Rh="[object DataView]",Nc=le?le.prototype:void 0,Fa=Nc?Nc.valueOf:void 0;function kh(e,t,r,n,i,o,a){switch(r){case Rh:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Th:return!(e.byteLength!=t.byteLength||!o(new Oc(e),new Oc(t)));case vh:case yh:case _h:return T(+e,+t);case wh:return e.name==t.name&&e.message==t.message;case Ch:case Eh:return e==t+"";case bh:var c=fh;case Sh:var w=n&gh;if(c||(c=ph),e.size!=t.size&&!w)return!1;var p=a.get(e);if(p)return p==t;n|=mh,a.set(e,t);var S=Pc(c(e),c(t),n,i,o,a);return a.delete(e),S;case xh:if(Fa)return Fa.call(e)==Fa.call(t)}return!1}const Dh=kh;function Ih(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}const Ah=Ih;var Ph=Array.isArray;const co=Ph;function Oh(e,t,r){var n=t(e);return co(e)?n:Ah(n,r(e))}const Nh=Oh;function Fh(e,t){for(var r=-1,n=e==null?0:e.length,i=0,o=[];++r<n;){var a=e[r];t(a,r,e)&&(o[i++]=a)}return o}const Lh=Fh;function $h(){return[]}const Mh=$h;var Uh=Object.prototype,Hh=Uh.propertyIsEnumerable,Fc=Object.getOwnPropertySymbols,Bh=Fc?function(e){return e==null?[]:(e=Object(e),Lh(Fc(e),function(t){return Hh.call(e,t)}))}:Mh;const jh=Bh;function zh(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}const qh=zh;function Wh(e){return e!=null&&typeof e=="object"}const gi=Wh;var Vh="[object Arguments]";function Gh(e){return gi(e)&&Le(e)==Vh}const Lc=Gh;var $c=Object.prototype,Kh=$c.hasOwnProperty,Qh=$c.propertyIsEnumerable,Zh=Lc(function(){return arguments}())?Lc:function(e){return gi(e)&&Kh.call(e,"callee")&&!Qh.call(e,"callee")};const Xh=Zh;function Yh(){return!1}const Jh=Yh;var Mc=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Uc=Mc&&typeof module=="object"&&module&&!module.nodeType&&module,ep=Uc&&Uc.exports===Mc,Hc=ep?G.Buffer:void 0,tp=Hc?Hc.isBuffer:void 0,rp=tp||Jh;const La=rp;var np=9007199254740991,ip=/^(?:0|[1-9]\d*)$/;function op(e,t){var r=typeof e;return t=t==null?np:t,!!t&&(r=="number"||r!="symbol"&&ip.test(e))&&e>-1&&e%1==0&&e<t}const ap=op;var sp=9007199254740991;function cp(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=sp}const Bc=cp;var up="[object Arguments]",lp="[object Array]",dp="[object Boolean]",fp="[object Date]",hp="[object Error]",pp="[object Function]",gp="[object Map]",mp="[object Number]",vp="[object Object]",yp="[object RegExp]",wp="[object Set]",bp="[object String]",_p="[object WeakMap]",Cp="[object ArrayBuffer]",Sp="[object DataView]",Ep="[object Float32Array]",xp="[object Float64Array]",Tp="[object Int8Array]",Rp="[object Int16Array]",kp="[object Int32Array]",Dp="[object Uint8Array]",Ip="[object Uint8ClampedArray]",Ap="[object Uint16Array]",Pp="[object Uint32Array]",tt={};tt[Ep]=tt[xp]=tt[Tp]=tt[Rp]=tt[kp]=tt[Dp]=tt[Ip]=tt[Ap]=tt[Pp]=!0,tt[up]=tt[lp]=tt[Cp]=tt[dp]=tt[Sp]=tt[fp]=tt[hp]=tt[pp]=tt[gp]=tt[mp]=tt[vp]=tt[yp]=tt[wp]=tt[bp]=tt[_p]=!1;function Op(e){return gi(e)&&Bc(e.length)&&!!tt[Le(e)]}const Np=Op;function Fp(e){return function(t){return e(t)}}const Lp=Fp;var jc=typeof exports=="object"&&exports&&!exports.nodeType&&exports,mi=jc&&typeof module=="object"&&module&&!module.nodeType&&module,$p=mi&&mi.exports===jc,$a=$p&&Y.process,Mp=function(){try{var e=mi&&mi.require&&mi.require("util").types;return e||$a&&$a.binding&&$a.binding("util")}catch(t){}}();const zc=Mp;var qc=zc&&zc.isTypedArray,Up=qc?Lp(qc):Np;const Wc=Up;var Hp=Object.prototype,Bp=Hp.hasOwnProperty;function jp(e,t){var r=co(e),n=!r&&Xh(e),i=!r&&!n&&La(e),o=!r&&!n&&!i&&Wc(e),a=r||n||i||o,c=a?qh(e.length,String):[],w=c.length;for(var p in e)(t||Bp.call(e,p))&&!(a&&(p=="length"||i&&(p=="offset"||p=="parent")||o&&(p=="buffer"||p=="byteLength"||p=="byteOffset")||ap(p,w)))&&c.push(p);return c}const zp=jp;var qp=Object.prototype;function Wp(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||qp;return e===r}const Vp=Wp;function Gp(e,t){return function(r){return e(t(r))}}var Kp=Gp(Object.keys,Object);const Qp=Kp;var Zp=Object.prototype,Xp=Zp.hasOwnProperty;function Yp(e){if(!Vp(e))return Qp(e);var t=[];for(var r in Object(e))Xp.call(e,r)&&r!="constructor"&&t.push(r);return t}const Jp=Yp;function eg(e){return e!=null&&Bc(e.length)&&!ct(e)}const tg=eg;function rg(e){return tg(e)?zp(e):Jp(e)}const ng=rg;function ig(e){return Nh(e,ng,jh)}const Vc=ig;var og=1,ag=Object.prototype,sg=ag.hasOwnProperty;function cg(e,t,r,n,i,o){var a=r&og,c=Vc(e),w=c.length,p=Vc(t),S=p.length;if(w!=S&&!a)return!1;for(var P=w;P--;){var k=c[P];if(!(a?k in t:sg.call(t,k)))return!1}var I=o.get(e),$=o.get(t);if(I&&$)return I==t&&$==e;var B=!0;o.set(e,t),o.set(t,e);for(var q=a;++P<w;){k=c[P];var Z=e[k],K=t[k];if(n)var re=a?n(K,Z,k,t,e,o):n(Z,K,k,e,t,o);if(!(re===void 0?Z===K||i(Z,K,r,n,o):re)){B=!1;break}q||(q=k=="constructor")}if(B&&!q){var ee=e.constructor,se=t.constructor;ee!=se&&"constructor"in e&&"constructor"in t&&!(typeof ee=="function"&&ee instanceof ee&&typeof se=="function"&&se instanceof se)&&(B=!1)}return o.delete(e),o.delete(t),B}const ug=cg;var lg=at(G,"DataView");const Ma=lg;var dg=at(G,"Promise");const Ua=dg;var fg=at(G,"Set");const Ha=fg;var hg=at(G,"WeakMap");const Ba=hg;var Gc="[object Map]",pg="[object Object]",Kc="[object Promise]",Qc="[object Set]",Zc="[object WeakMap]",Xc="[object DataView]",gg=mr(Ma),mg=mr(tn),vg=mr(Ua),yg=mr(Ha),wg=mr(Ba),nn=Le;(Ma&&nn(new Ma(new ArrayBuffer(1)))!=Xc||tn&&nn(new tn)!=Gc||Ua&&nn(Ua.resolve())!=Kc||Ha&&nn(new Ha)!=Qc||Ba&&nn(new Ba)!=Zc)&&(nn=function(e){var t=Le(e),r=t==pg?e.constructor:void 0,n=r?mr(r):"";if(n)switch(n){case gg:return Xc;case mg:return Gc;case vg:return Kc;case yg:return Qc;case wg:return Zc}return t});const Yc=nn;var bg=1,Jc="[object Arguments]",eu="[object Array]",uo="[object Object]",_g=Object.prototype,tu=_g.hasOwnProperty;function Cg(e,t,r,n,i,o){var a=co(e),c=co(t),w=a?eu:Yc(e),p=c?eu:Yc(t);w=w==Jc?uo:w,p=p==Jc?uo:p;var S=w==uo,P=p==uo,k=w==p;if(k&&La(e)){if(!La(t))return!1;a=!0,S=!1}if(k&&!S)return o||(o=new Na),a||Wc(e)?Pc(e,t,r,n,i,o):Dh(e,t,w,r,n,i,o);if(!(r&bg)){var I=S&&tu.call(e,"__wrapped__"),$=P&&tu.call(t,"__wrapped__");if(I||$){var B=I?e.value():e,q=$?t.value():t;return o||(o=new Na),i(B,q,r,n,o)}}return k?(o||(o=new Na),ug(e,t,r,n,i,o)):!1}const Sg=Cg;function ru(e,t,r,n,i){return e===t?!0:e==null||t==null||!gi(e)&&!gi(t)?e!==e&&t!==t:Sg(e,t,r,n,ru,i)}const Eg=ru;function xg(e,t){return Eg(e,t)}const Tg=xg,vr="remoteHub";class nu{constructor(){this._onDidChange=new s.EventEmitter,this._onDidChangeAny=new s.EventEmitter}static configure(t){t.subscriptions.push(s.workspace.onDidChangeConfiguration(He.onConfigurationChanged,He))}get onDidChange(){return this._onDidChange.event}get onDidChangeAny(){return this._onDidChangeAny.event}onConfigurationChanged(t){if(!t.affectsConfiguration(vr)){this._onDidChangeAny.fire(t);return}this._onDidChangeAny.fire(t),this._onDidChange.fire(t)}get(t,r,n){return n===void 0?s.workspace.getConfiguration(t===void 0?void 0:vr,r).get(t===void 0?vr:t):s.workspace.getConfiguration(t===void 0?void 0:vr,r).get(t===void 0?vr:t,n)}getAny(t,r,n){return n===void 0?s.workspace.getConfiguration(void 0,r).get(t):s.workspace.getConfiguration(void 0,r).get(t,n)}changed(t,r,n){var i;return(i=t==null?void 0:t.affectsConfiguration(`${vr}.${r}`,n))!=null?i:!0}inspect(t,r){return s.workspace.getConfiguration(t===void 0?void 0:vr,r).inspect(t===void 0?vr:t)}inspectAny(t,r){return s.workspace.getConfiguration(void 0,r).inspect(t)}async migrate(t,r,n){const i=He.inspect(t);if(i===void 0)return!1;let o=!1;return i.globalValue!==void 0&&(await this.update(r,n.migrationFn!=null?n.migrationFn(i.globalValue):i.globalValue,s.ConfigurationTarget.Global),o=!0),i.workspaceValue!==void 0&&(await this.update(r,n.migrationFn!=null?n.migrationFn(i.workspaceValue):i.workspaceValue,s.ConfigurationTarget.Workspace),o=!0),i.workspaceFolderValue!==void 0&&(await this.update(r,n.migrationFn!=null?n.migrationFn(i.workspaceFolderValue):i.workspaceFolderValue,s.ConfigurationTarget.WorkspaceFolder),o=!0),!o&&n.fallbackValue!==void 0&&(await this.update(r,n.fallbackValue,s.ConfigurationTarget.Global),o=!0),o}async migrateIfMissing(t,r,n){const i=He.inspect(t);if(i===void 0)return;const o=He.inspect(r);i.globalValue!==void 0&&(o===void 0||o.globalValue===void 0)&&await this.update(r,n.migrationFn!=null?n.migrationFn(i.globalValue):i.globalValue,s.ConfigurationTarget.Global),i.workspaceValue!==void 0&&(o===void 0||o.workspaceValue===void 0)&&await this.update(r,n.migrationFn!=null?n.migrationFn(i.workspaceValue):i.workspaceValue,s.ConfigurationTarget.Workspace),i.workspaceFolderValue!==void 0&&(o===void 0||o.workspaceFolderValue===void 0)&&await this.update(r,n.migrationFn!=null?n.migrationFn(i.workspaceFolderValue):i.workspaceFolderValue,s.ConfigurationTarget.WorkspaceFolder)}name(t){return t}update(t,r,n){return s.workspace.getConfiguration(vr).update(t,r,n)}updateAny(t,r,n,i){return s.workspace.getConfiguration(void 0,n===s.ConfigurationTarget.Global?void 0:i).update(t,r,n)}updateEffective(t,r){const n=He.inspect(t);return n.workspaceFolderValue!==void 0?r===n.workspaceFolderValue?Promise.resolve(void 0):He.update(t,r,s.ConfigurationTarget.WorkspaceFolder):n.workspaceValue!==void 0?r===n.workspaceValue?Promise.resolve(void 0):He.update(t,r,s.ConfigurationTarget.Workspace):n.globalValue===r||n.globalValue===void 0&&r===n.defaultValue?Promise.resolve(void 0):He.update(t,Tg(r,n.defaultValue)?void 0:r,s.ConfigurationTarget.Global)}}const He=new nu;class Rg{constructor(t,r,n,i,o){this.providerService=t,this.uri=r,this.id=n,this.name=i,this.provider={id:o.id,name:o.name}}get canonicalUri(){return this.providerService.getVirtualCanonicalRootUri(this.uri)}createRelativeUri(t){return this.providerService.createRelativeUri(this.uri,t)}async getMetadata(){const t=await this.providerService.getMetadata(this.uri);if(!t)throw new Error(`Unable to find metadata for ${this.uri.toString()}`);return t}}var vi;(function(e){e[e.Open=0]="Open",e[e.Closed=1]="Closed",e[e.Merged=2]="Merged"})(vi||(vi={}));var We;(function(e){e[e.Branch=0]="Branch",e[e.Tag=1]="Tag",e[e.Commit=2]="Commit",e[e.PullRequest=3]="PullRequest",e[e.Tree=4]="Tree"})(We||(We={}));var yr;(function(e){e[e.Clone=-1]="Clone",e[e.Repository=0]="Repository",e[e.PullRequest=1]="PullRequest",e[e.Branch=2]="Branch",e[e.Commit=3]="Commit"})(yr||(yr={}));var lt;(function(e){e[e.Repository=0]="Repository",e[e.PullRequest=1]="PullRequest",e[e.Branch=2]="Branch",e[e.Commit=3]="Commit",e[e.File=4]="File"})(lt||(lt={}));const kg="";function Dg(...e){if(e.length===1){const t=e[0];return t===void 0?kg:typeof t=="string"?t:typeof t=="number"||typeof t=="boolean"?String(t):JSON.stringify(t)}return JSON.stringify(e)}function Ig(e){return e!==void 0&&typeof e.then=="function"}function nr(e){return(t,r,n)=>{let i;if(typeof n.value=="function"?i=n.value:typeof n.get=="function"&&(i=n.get),i===void 0)throw new Error("Not supported");const o=`$gate$${r}`;n.value=function(...a){const c=a.length===0?o:`${o}$${(e!=null?e:Dg)(...a)}`;Object.prototype.hasOwnProperty.call(this,c)||Object.defineProperty(this,c,{configurable:!1,enumerable:!1,writable:!0,value:void 0});let w=this[c];if(w===void 0){let p;try{if(p=i.apply(this,a),p==null||!Ig(p))return p;this[c]=w=p.then(S=>(this[c]=void 0,S)).catch(S=>{throw this[c]=void 0,S})}catch(S){throw this[c]=void 0,S}}return w}}}function*iu(e,t){for(const r of e)yield*t(r)}function*Ag(e,t){for(const r of e)t(r)&&(yield r)}function*In(e,t){for(const r of e){const n=t(r);n!=null&&(yield n)}}function Pg(e,t){let r="";const n=e[Symbol.iterator]();let i=n.next();if(i.done)return r;for(;;){const o=i.value.toString();if(i=n.next(),i.done){r+=o;break}r+=o,r+=t}return r}function*An(e,t){for(const r of e)yield t(r)}function*Og(...e){for(const t of e)for(const r of t)yield r}function*Ng(e){const t=new Set;for(const r of e)t.has(r)||(t.add(r),yield r)}const Nt="";var Ke;(function(e){e.Off="off",e.Error="error",e.Warn="warn",e.Info="info",e.Debug="debug"})(Ke||(Ke={}));var ou;(function(e){e[e.Off=0]="Off",e[e.Error=1]="Error",e[e.Warn=2]="Warn",e[e.Info=3]="Info",e[e.Debug=4]="Debug"})(ou||(ou={}));const Fg="Remote Repositories",lo="[RemoteHub]",ir=class{static configure(e,t){this._isDebugging=e.extensionMode===s.ExtensionMode.Development,this.logLevel=t}static enabled(e){return this.level>=this.toOrderedLevel(e)}static get logLevel(){return this._logLevel}static set logLevel(e){var t,r;this._logLevel=e,e===Ke.Off?((t=this.output)==null||t.dispose(),this.output=void 0):this.output=(r=this.output)!=null?r:s.window.createOutputChannel(Fg)}static get level(){return this.toOrderedLevel(this.logLevel)}static toOrderedLevel(e){switch(e){case Ke.Off:return 0;case Ke.Error:return 1;case Ke.Warn:return 2;case Ke.Info:return 3;case Ke.Debug:return 4}}static get isDebugging(){return this._isDebugging}static debug(e,...t){this.logLevel<Ke.Debug&&!ir.isDebugging||(ir.isDebugging&&console.log(this.timestamp,lo,e!=null?e:Nt,...t),this.output!==void 0&&this.logLevel===Ke.Debug&&this.output.appendLine(`${this.timestamp} ${e!=null?e:Nt}${this.toLoggableParams(!0,t)}`))}static error(e,t,...r){if(!(this.level<1&&!ir.isDebugging)){if(t===void 0){const n=e.stack;if(n){const i=/.*\s*?at\s(.+?)\s/.exec(n);i!==null&&(t=i[1])}}ir.isDebugging&&console.error(this.timestamp,lo,t!=null?t:Nt,...r,e),this.output!==void 0&&this.logLevel!==Ke.Off&&this.output.appendLine(`${this.timestamp} ${t!=null?t:Nt}${this.toLoggableParams(!1,r)}
${e==null?void 0:e.toString()}`)}}static log(e,...t){this.level<3&&!ir.isDebugging||(ir.isDebugging&&console.log(this.timestamp,lo,e!=null?e:Nt,...t),this.output!==void 0&&(this.logLevel===Ke.Info||this.logLevel===Ke.Debug)&&this.output.appendLine(`${this.timestamp} ${e!=null?e:Nt}${this.toLoggableParams(!1,t)}`))}static warn(e,...t){this.logLevel<Ke.Warn&&!ir.isDebugging||(ir.isDebugging&&console.warn(this.timestamp,lo,e!=null?e:Nt,...t),this.output!==void 0&&this.logLevel!==Ke.Off&&this.output.appendLine(`${this.timestamp} ${e!=null?e:Nt}${this.toLoggableParams(!1,t)}`))}static showOutputChannel(){var e;(e=this.output)==null||e.show()}static toLoggable(e,t){if(typeof e!="object")return String(e);if(e instanceof s.Uri)return`Uri(${e.toString(!0)})`;try{return JSON.stringify(e,t)}catch{return"<error>"}}static toLoggableName(e){var t,r,n;let i;if(typeof e=="function"){if(e.prototype===void 0||e.prototype.constructor===void 0)return e.name;i=(t=e.prototype.constructor.name)!=null?t:Nt}else i=(n=(r=e.constructor)==null?void 0:r.name)!=null?n:Nt;const o=i.indexOf("_");return o===-1?i:i.substr(o+1)}static get timestamp(){const e=new Date;return`[${e.toISOString().replace(/T/," ").replace(/\..+/,Nt)}:${`00${e.getUTCMilliseconds()}`.slice(-3)}]`}static toLoggableParams(e,t){if(t.length===0||e&&this.logLevel!==Ke.Debug&&!ir.isDebugging)return Nt;const r=t.map(n=>this.toLoggable(n)).join(", ");return r.length!==0?` \u2014 ${r}`:Nt}};let he=ir;he._logLevel=Ke.Off;async function fo(e){return(await Promise.resolve().then(ze.t.bind(ze,6417,23))).createHash("sha1").update(e).digest("base64")}function Lg(e){return Buffer.from(e,"base64")}const $g=e=>e.charCodeAt(0);function n_(e){return Uint8Array.from(Buffer.from(e,"base64").toString(),$g)}const{fromCharCode:Mg}=String;function i_(e){let t="";for(let r=0,{length:n}=e;r<n;r++)t+=Mg(e[r]);return Buffer.from(t).toString("base64")}function Ug(e){return Buffer.from(e,"utf8").toString("hex")}function Hg(e){return Buffer.from(e,"hex").toString("utf8")}function Bg(e,t){if(e===t)return-1;let r=0;for(;e[r]===t[r];)r++;return r}const au=47;function be(e,t=!1){if(e===void 0)return;const r=e.path.endsWith("/");return!r&&(!e.fragment||t)?e.toString():e.with({path:r?e.path.slice(0,-1):e.path,fragment:""}).toString()}function jg(e){return`${e.scheme}-${e.authority}${e.path.endsWith("/")?e.path.slice(0,-1):e.path}`}function Dt(e){const t=e.path;let r=0,n=-1,i=!0;for(let o=t.length-1;o>=0;--o)if(t.charCodeAt(o)===au){if(!i){r=o+1;break}}else n===-1&&(i=!1,n=o+1);return n===-1?"":t.slice(r,n)}function o_(e){const t=e.path;if(t.length===1)return"/";let r,n=-1,i=!0;for(let o=t.length-1;o>=1;--o)if(r=t.charCodeAt(o),r===au){if(!i){n=o;break}}else i=!1;return n===-1?"/":t.slice(0,n)}function zg(e){const t=e.path.lastIndexOf("/");return t===-1?e.with({path:"/"}):e.with({path:e.path.substring(0,t)})}function qg(e,t){return ja(e,t).path}function ja(e,t){return t.path.startsWith(e.path)?s.Uri.joinPath(e,t.path.substr(e.path.length)):s.Uri.joinPath(e,t.path)}function ho(e,t){return typeof t=="string"?(t.startsWith("/")||(t=`/${t}`),za(e,t)&&e.path.substr(t.length+(t.endsWith("/")?0:1)).split("/").length===1):za(e,t)&&e.path.substr(t.path.length+(t.path.endsWith("/")?0:1)).split("/").length===1}function za(e,t){return typeof t=="string"?(t.startsWith("/")||(t=`/${t}`),t.length===1||e.path.startsWith(t.endsWith("/")?t:`${t}/`)):t.scheme===e.scheme&&t.authority===e.authority&&(t.path.length===1||e.path.startsWith(t.path.endsWith("/")?t.path:`${t.path}/`))}class su extends Error{constructor(t){super(t.message);this.original=t,Error.captureStackTrace(this,su)}}class Pn extends Error{constructor(t,r){super(t.message);this.original=t,this.name=r,Error.captureStackTrace(this,Pn)}}class yi extends Error{constructor(t){super(t);Error.captureStackTrace(this,yi)}}class wi extends Error{constructor(t,r){super(t.message);this.original=t,this.duplicate=r,Error.captureStackTrace(this,wi)}}class po extends Error{constructor(t){super(t.message);this.original=t,Error.captureStackTrace(this,po)}}class qa extends Error{constructor(t=!1){super(t?"Unable to synchronize the repository":"Unable to fetch the repository");Error.captureStackTrace(this,qa)}}class go extends Error{constructor(){super("Sync operation will result in conflicts");Error.captureStackTrace(this,go)}}var a_=ze(6724),Wg=Object.defineProperty,Vg=Object.getOwnPropertyDescriptor,Gg=(e,t,r,n)=>{for(var i=n>1?void 0:n?Vg(t,r):t,o=e.length-1,a;o>=0;o--)(a=e[o])&&(i=(n?a(t,r,i):a(i))||i);return n&&i&&Wg(t,r,i),i},wr;(function(e){e[e.Abort=0]="Abort",e[e.KeepCurrent=1]="KeepCurrent",e[e.DiscardCurrent=2]="DiscardCurrent",e[e.Merge=3]="Merge"})(wr||(wr={}));const st=class{constructor(e,t){this.metadataStore=e,this.telemetryService=t,this._providers=new Map,this._onDidChangeProviders=new s.EventEmitter,this._repositories=new Map,this._onDidChangeRepositories=new s.EventEmitter,this._onDidChangeRepository=new s.EventEmitter,this._onDidRefresh=new s.EventEmitter,this._onWillRefresh=new s.EventEmitter,this.pendingMetadataRequests=new Map,this.disposable=s.Disposable.from(s.workspace.onDidChangeWorkspaceFolders(this.onWorkspaceFoldersChanged,this),e.onDidChange(r=>this.onMetadataChanged(r)))}get onDidChangeProviders(){return this._onDidChangeProviders.event}get onDidChangeRepositories(){return this._onDidChangeRepositories.event}get onDidChangeRepository(){return this._onDidChangeRepository.event}get onDidRefresh(){return this._onDidRefresh.event}get onWillRefresh(){return this._onWillRefresh.event}dispose(){this.disposable.dispose(),this._providers.clear(),this._repositories.clear()}onMetadataChanged(e){const t=this._repositories.get(be(e));!t||this._onDidChangeRepository.fire({repository:t})}async onWorkspaceFoldersChanged(e){if(e.added.length)for(const t of e.added){const r=be(t.uri);if(t.uri.scheme!==st.scheme||this._repositories.has(r))continue;const n=this.getProvider(t.uri);if(!n)continue;this._repositories.set(r,null);const i=await this.getMetadata(t.uri),o=new Rg(this,t.uri,i.repo,t.name,n);this._repositories.set(r,o),this._onDidChangeRepositories.fire({added:[o],removed:[]}),this.telemetryService.sendEvent("repository.opened",{provider:n.id,repositories:this._repositories.size.toString()})}if(e.removed.length)for(const t of e.removed){const r=be(t.uri);if(t.uri.scheme!==st.scheme||!this._repositories.has(r))continue;const n=this._repositories.get(r);this._repositories.delete(r),n&&(this._onDidChangeRepositories.fire({added:[],removed:[n]}),this.telemetryService.sendEvent("repository.closed",{repositories:this._repositories.size.toString()}))}is(_i.HasVirtualFolders,this._repositories.size!==0),is(_i.VirtualFolderProviders,Pg(Ng(An(this.getRepositories(),t=>t.provider.id)),","))}get hasProviders(){return this._providers.size!==0}get registeredProviders(){return[...An(this._providers.values(),e=>({id:e.id,name:e.name}))]}get repositories(){return[...this.getRepositories()]}register(e,t,r,n,i){var o;if(this._providers.has(e))throw new Error(`Provider '${e}' has already been registered`);const a={id:e,name:t,provider:r,fs:n,index:i};return this._providers.set(e,a),this._onDidChangeProviders.fire({added:[a],removed:[]}),this.telemetryService.sendEvent("provider.registered",{provider:e}),this.onWorkspaceFoldersChanged({added:(o=s.workspace.workspaceFolders)!=null?o:[],removed:[]}),{dispose:()=>{this._providers.delete(e);const c=[];for(const[w,p]of[...this._repositories])(p==null?void 0:p.provider.id)===e&&(this._repositories.delete(w),c.push(p));this._onDidChangeRepositories.fire({added:[],removed:c}),this._onDidChangeProviders.fire({added:[],removed:[a]})}}}refresh(){if(this._providers.size===0)return;const e=[];for(const t of this._providers.values())e.push(...An(this.getRepositories(t.id),r=>r.uri));this._onWillRefresh.fire(e),this.metadataStore.refresh(),this._onDidRefresh.fire(e)}getRegisteredProvider(e){const t=this.getProvider(e);return t?{id:t.id,name:t.name}:void 0}getRepository(e,t){const r=s.workspace.getWorkspaceFolder(e);if(!r||r.uri.scheme!==st.scheme)return;const n=this._repositories.get(be(r.uri));if(!(t!==void 0&&(n==null?void 0:n.provider.id)!==t))return n!=null?n:void 0}getRepositories(e){return Ag(this._repositories.values(),t=>t!==null&&(!e||t.provider.id===e))}getOpenUris(e,t){const r=[];for(const n of t)r.push(...s.workspace.textDocuments.map(i=>i.uri.scheme===e&&za(i.uri,n)?i.uri:void 0).filter(i=>Boolean(i)));return r}hasProvider(e,t){const r=typeof e=="string"?e:st.getProviderId(e),n=this._providers.get(r);return t!==void 0&&(n==null?void 0:n.id)!==t?!1:n!==void 0}getProvider(e){const t=typeof e=="string"?e:st.getProviderId(e);return this._providers.get(t)}getRepositoryProvider(e){var t;const r=(t=this.getProvider(e))==null?void 0:t.provider;if(r)return r;throw new Error(this.createNoProviderErrorMessage(e))}createNoProviderErrorMessage(e){return`No provider registered with id '${typeof e=="string"?e:st.getProviderId(e)}'`}getFileSystemProvider(e){var t;const r=(t=this.getProvider(e))==null?void 0:t.fs;if(r)return r;throw new Error(`No provider registered with id '${st.getProviderId(e)}'`)}findRemoteUrlHandler(e,t){if(t){const r=this.getProvider(t),n=r==null?void 0:r.provider.canOpenRemoteUrl(e);return n!==void 0?{provider:r,urlType:n}:void 0}for(const r of this._providers.values()){const n=r.provider.canOpenRemoteUrl(e);if(n!==void 0)return{provider:r,urlType:n}}}getRemoteWorkspaceSourceProviders(e){var t,r,n,i;return e?(i=(n=(t=this.getProvider(e))==null?void 0:(r=t.provider).getRemoteWorkspaceSourceProviders)==null?void 0:n.call(r))!=null?i:[]:[...iu(this._providers.values(),o=>{var a,c,w;return(w=(c=(a=o.provider).getRemoteWorkspaceSourceProviders)==null?void 0:c.call(a))!=null?w:[]})]}async getBestIndexedCommit(e){var t;const r=this.getProvider(e);return(t=r==null?void 0:r.index)==null?void 0:t.getBestIndexedCommit(r.provider,e)}async createWorkspaceForRemoteUrl(e,t,r=rt.CurrentWindow){var n;const i=this.findRemoteUrlHandler(e,t);return(n=i==null?void 0:i.provider)==null?void 0:n.provider.createWorkspaceForRemoteUrl(e,r)}createProviderUri(e,t,r){return this.getProviderUri(this.getRepositoryProvider(e).createVirtualUri(st.baseVirtualWorkspaceUri,t,r))}createRelativeProviderUri(e,t){return this.getProviderUri(this.createRelativeUri(e,t))}createRelativeUri(e,t){const r=this.getProviderRootUri(e);let n=`${r.path}/`;n.endsWith("/")&&(n=n.slice(0,-1));const i=r.with({path:`${r.path}/${t.startsWith("/")?t.substr(1):t}`});return e.scheme===st.scheme?this.getVirtualUri(i):i}createRelativeVirtualUri(e,t){return this.getVirtualUri(this.createRelativeUri(e,t))}createVirtualUri(e,t,r){return this.getRepositoryProvider(e).createVirtualUri(st.baseVirtualWorkspaceUri,t,r)}async getBestExternalUri(e,t){var r,n,i,o;const{provider:a,repo:c,HEAD:w,defaultBranch:p,pullRequest:S}=await this.getMetadata(e);switch(t){case yr.Clone:return this.getExternalUri(a.id,{repo:c,clone:!0});case yr.Repository:return this.getExternalUri(a.id,{repo:c});case yr.PullRequest:return S?this.getExternalUri(a.id,{repo:c,pullRequest:S.id}):void 0;case yr.Commit:return this.getExternalUri(a.id,{repo:c,sha:w.sha});case yr.Branch:return this.getExternalUri(a.id,{repo:c,branch:(n=(r=w.branch)==null?void 0:r.name)!=null?n:p.name})}return this.getExternalUri(a.id,{repo:c,...S?{pullRequest:S.id}:w.detached?{sha:w.sha}:{branch:(o=(i=w.branch)==null?void 0:i.name)!=null?o:p.name}})}getCanonicalUri(e){let{authority:t}=e;const r=t.indexOf(st.authoritySeparator);return r!==-1&&(t=t.substr(0,r)),e.with({authority:t})}getExternalUri(e,t){var r,n;return(n=(r=this.getRepositoryProvider(e)).getExternalUri)==null?void 0:n.call(r,t)}getProviderUri(e){return e.scheme!==st.scheme?e:e.with({scheme:st.getProviderId(e)})}getProviderRootUri(e){return e=this.getProviderUri(e),this.getRepositoryProvider(e).getProviderRootUri(e)}getRelativeFilePath(e,t){return t=this.getProviderUri(t),this.getRepositoryProvider(t).getRelativeFilePath(e,t)}getVirtualUri(e){return e.scheme===st.scheme?e:e.with({scheme:st.scheme})}getVirtualCanonicalRootUri(e){const t=this.getVirtualUri(this.getProviderRootUri(e));let{authority:r}=t;const n=r.indexOf(st.authoritySeparator);return n!==-1&&(r=r.substr(0,n)),t.with({authority:r})}getVirtualRootUri(e){return this.getVirtualUri(this.getProviderRootUri(e))}getVirtualWorkspaceUri(e){var t;return(t=s.workspace.getWorkspaceFolder(this.getVirtualUri(e)))==null?void 0:t.uri}createIGitRepository(e,t,r,n){var i,o;return(o=(i=this.getRepositoryProvider(e)).createIGitRepository)==null?void 0:o.call(i,e,t,r,n)}async getCommitOperations(e,t,r){let n;return(r==null?void 0:r.staged)?(n=await t.getStagedChanges(e),n.length===0&&r.staged==="auto"&&(n=await t.getChanges(e))):n=await t.getChanges(e),n.map(o=>{const a=this.getRelativeFilePath(e,o.uri);switch(o.type){case Be.Created:return{type:o.type,path:a,fileType:o.fileType,content:t.getContent(o.uri)};case Be.Changed:return{type:o.type,path:a,fileType:o.fileType,content:t.getContent(o.uri)};case Be.Deleted:return{type:o.type,path:a,fileType:o.fileType,content:void 0}}})}async getMetadata(e){return{...await this.getMetadataCore(this.getVirtualRootUri(e)),path:this.getRelativeFilePath(e,e)}}async getMetadataCore(e){const t=be(e);let r=this.pendingMetadataRequests.get(t);if(r)return r;const{revision:n,cachedMetadata:i}=await this.metadataStore.get(e);if(i!==void 0)return i;const o=this.getProvider(e);if(!o)throw new Error(this.createNoProviderErrorMessage(e));const a=o.index?await o.index.getBestIndexedCommit(o.provider,e):void 0;r=o.provider.createMetadata(e,n!=null?n:a),this.pendingMetadataRequests.set(t,r);try{const c=await r;return a&&(c.index={sha:a}),await this.updateMetadata(e,c),c}finally{this.pendingMetadataRequests.delete(t)}}async updateMetadata(e,t){await this.metadataStore.set(this.getVirtualUri(e),t.HEAD.sha,t)}async clone(e){const t=await this.getBestExternalUri(e,yr.Clone);if(!t)throw new Error("No url found for clone");if($r)return void s.env.openExternal(s.Uri.parse(`${s.env.uriScheme}://vscode.git/clone?url=${encodeURIComponent(t.toString(!0))}`));try{const r=s.extensions.getExtension("vscode.git");if(r)await(r==null?void 0:r.activate()),await s.commands.executeCommand("git.clone",t.toString(!0));else throw new Error("Git extension not found")}catch(r){he.error(r,"Unable to clone repository")}}createBranch(e,t,r,n){return this.getRepositoryProvider(e).createBranch(e,t,r,n)}createCommit(e,t,r,n){return this.getRepositoryProvider(e).createCommit(e,t,r,n)}createPullRequest(e,t,r,n,i){return this.getRepositoryProvider(e).createPullRequest(e,t,r,n,i)}fetch(e,t){return this.getRepositoryProvider(e).fetch(e,t)}fork(e){return this.getRepositoryProvider(e).fork(e)}getBranches(e,t){return this.getRepositoryProvider(e).getBranches(e,t)}getCommit(e,t){return this.getRepositoryProvider(e).getCommit(e,t)}getCommits(e,t){var r;return(r=this.getRepositoryProvider(e))==null?void 0:r.getCommits(e,t)}getFileContent(e,t,r){return this.getRepositoryProvider(e).getFileContent(e,t,r)}getFork(e){return this.getRepositoryProvider(e).getFork(e)}async getIncomingChanges(e){var t,r,n;return(n=(r=(t=this.getRepositoryProvider(e)).getIncomingChanges)==null?void 0:r.call(t,e))!=null?n:[]}getPullRequest(e,t){return this.getRepositoryProvider(e).getPullRequest(e,t)}getTags(e,t){return this.getRepositoryProvider(e).getTags(e,t)}async getTarGz(e){var t,r;return(r=(t=this.getRepositoryProvider(e)).getTarGz)==null?void 0:r.call(t,e)}pushCommit(e,t,r,n){return this.getRepositoryProvider(e).pushCommit(e,t,r,n)}switchTo(e,t,r){return this.getRepositoryProvider(e).switchTo(e,t,r)}async sync(e,t,r){const n=this._repositories.get(be(e));n&&this._onDidChangeRepository.fire({repository:n,state:{syncing:!0}});try{return await this.getRepositoryProvider(e).sync(e,t,{conflictResolution:0,...r})}finally{n&&this._onDidChangeRepository.fire({repository:n,state:{syncing:!1}})}}stat(e){return this.getFileSystemProvider(e).stat(e)}readDirectory(e){return this.getFileSystemProvider(e).readDirectory(e)}readFile(e){return this.getFileSystemProvider(e).readFile(e)}provideFileSearchResults(e,t,r){return this.getFileSystemProvider(t.folder).provideFileSearchResults(e,t,r)}provideTextSearchResults(e,t,r,n){return this.getFileSystemProvider(t.folder).provideTextSearchResults(e,t,r,n)}static decodeAuthority(e,t){const[r,n]=e.authority.split(st.authoritySeparator);let i;if(n)try{const o=JSON.parse(Hg(n));i=t?t(o):o}catch{}return{scheme:r,metadata:i}}static encodeAuthority(e,t){const r=t?`${st.authoritySeparator}${Ug(JSON.stringify(t))}`:"";return`${e}${r}`}static getProviderId(e){const{authority:t}=e,r=t.indexOf(st.authoritySeparator);return r!==-1?t.substr(0,r):t}static isCanonicalUri(e){return e.authority.indexOf(st.authoritySeparator)===-1}};let Je=st;Je.scheme="vscode-vfs",Je.authoritySeparator="+",Je.baseVirtualWorkspaceUri=s.Uri.parse(`${st.scheme}://`),Gg([nr()],Je.prototype,"getMetadataCore",1);function br(){}br.prototype={diff:function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=n.callback;typeof n=="function"&&(i=n,n={}),this.options=n;var o=this;function a(B){return i?(setTimeout(function(){i(void 0,B)},0),!0):B}t=this.castInput(t),r=this.castInput(r),t=this.removeEmpty(this.tokenize(t)),r=this.removeEmpty(this.tokenize(r));var c=r.length,w=t.length,p=1,S=c+w,P=[{newPos:-1,components:[]}],k=this.extractCommon(P[0],r,t,0);if(P[0].newPos+1>=c&&k+1>=w)return a([{value:this.join(r),count:r.length}]);function I(){for(var B=-1*p;B<=p;B+=2){var q=void 0,Z=P[B-1],K=P[B+1],re=(K?K.newPos:0)-B;Z&&(P[B-1]=void 0);var ee=Z&&Z.newPos+1<c,se=K&&0<=re&&re<w;if(!ee&&!se){P[B]=void 0;continue}if(!ee||se&&Z.newPos<K.newPos?(q=Qg(K),o.pushComponent(q.components,void 0,!0)):(q=Z,q.newPos++,o.pushComponent(q.components,!0,void 0)),re=o.extractCommon(q,r,t,B),q.newPos+1>=c&&re+1>=w)return a(Kg(o,q.components,r,t,o.useLongestToken));P[B]=q}p++}if(i)(function B(){setTimeout(function(){if(p>S)return i();I()||B()},0)})();else for(;p<=S;){var $=I();if($)return $}},pushComponent:function(t,r,n){var i=t[t.length-1];i&&i.added===r&&i.removed===n?t[t.length-1]={count:i.count+1,added:r,removed:n}:t.push({count:1,added:r,removed:n})},extractCommon:function(t,r,n,i){for(var o=r.length,a=n.length,c=t.newPos,w=c-i,p=0;c+1<o&&w+1<a&&this.equals(r[c+1],n[w+1]);)c++,w++,p++;return p&&t.components.push({count:p}),t.newPos=c,w},equals:function(t,r){return this.options.comparator?this.options.comparator(t,r):t===r||this.options.ignoreCase&&t.toLowerCase()===r.toLowerCase()},removeEmpty:function(t){for(var r=[],n=0;n<t.length;n++)t[n]&&r.push(t[n]);return r},castInput:function(t){return t},tokenize:function(t){return t.split("")},join:function(t){return t.join("")}};function Kg(e,t,r,n,i){for(var o=0,a=t.length,c=0,w=0;o<a;o++){var p=t[o];if(p.removed){if(p.value=e.join(n.slice(w,w+p.count)),w+=p.count,o&&t[o-1].added){var P=t[o-1];t[o-1]=t[o],t[o]=P}}else{if(!p.added&&i){var S=r.slice(c,c+p.count);S=S.map(function(I,$){var B=n[w+$];return B.length>I.length?B:I}),p.value=e.join(S)}else p.value=e.join(r.slice(c,c+p.count));c+=p.count,p.added||(w+=p.count)}}var k=t[a-1];return a>1&&typeof k.value=="string"&&(k.added||k.removed)&&e.equals("",k.value)&&(t[a-2].value+=k.value,t.pop()),t}function Qg(e){return{newPos:e.newPos,components:e.components.slice(0)}}var Zg=new br;function s_(e,t,r){return Zg.diff(e,t,r)}function cu(e,t){if(typeof e=="function")t.callback=e;else if(e)for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t}var uu=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,lu=/\S/,mo=new br;mo.equals=function(e,t){return this.options.ignoreCase&&(e=e.toLowerCase(),t=t.toLowerCase()),e===t||this.options.ignoreWhitespace&&!lu.test(e)&&!lu.test(t)},mo.tokenize=function(e){for(var t=e.split(/([^\S\r\n]+|[()[\]{}'"\r\n]|\b)/),r=0;r<t.length-1;r++)!t[r+1]&&t[r+2]&&uu.test(t[r])&&uu.test(t[r+2])&&(t[r]+=t[r+2],t.splice(r+1,2),r--);return t};function c_(e,t,r){return r=cu(r,{ignoreWhitespace:!0}),mo.diff(e,t,r)}function u_(e,t,r){return mo.diff(e,t,r)}var vo=new br;vo.tokenize=function(e){var t=[],r=e.split(/(\n|\r\n)/);r[r.length-1]||r.pop();for(var n=0;n<r.length;n++){var i=r[n];n%2&&!this.options.newlineIsToken?t[t.length-1]+=i:(this.options.ignoreWhitespace&&(i=i.trim()),t.push(i))}return t};function Xg(e,t,r){return vo.diff(e,t,r)}function l_(e,t,r){var n=cu(r,{ignoreWhitespace:!0});return vo.diff(e,t,n)}var du=new br;du.tokenize=function(e){return e.split(/(\S.+?[.!?])(?=\s+|$)/)};function d_(e,t,r){return du.diff(e,t,r)}var fu=new br;fu.tokenize=function(e){return e.split(/([{}:;,]|\s+)/)};function f_(e,t,r){return fu.diff(e,t,r)}function yo(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?yo=function(t){return typeof t}:yo=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yo(e)}function _r(e){return Yg(e)||Jg(e)||em(e)||tm()}function Yg(e){if(Array.isArray(e))return Wa(e)}function Jg(e){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(e))return Array.from(e)}function em(e,t){if(!!e){if(typeof e=="string")return Wa(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Wa(e,t)}}function Wa(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function tm(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var rm=Object.prototype.toString,On=new br;On.useLongestToken=!0,On.tokenize=vo.tokenize,On.castInput=function(e){var t=this.options,r=t.undefinedReplacement,n=t.stringifyReplacer,i=n===void 0?function(o,a){return typeof a=="undefined"?r:a}:n;return typeof e=="string"?e:JSON.stringify(Va(e,null,null,i),i,"  ")},On.equals=function(e,t){return br.prototype.equals.call(On,e.replace(/,([\r\n])/g,"$1"),t.replace(/,([\r\n])/g,"$1"))};function h_(e,t,r){return On.diff(e,t,r)}function Va(e,t,r,n,i){t=t||[],r=r||[],n&&(e=n(i,e));var o;for(o=0;o<t.length;o+=1)if(t[o]===e)return r[o];var a;if(rm.call(e)==="[object Array]"){for(t.push(e),a=new Array(e.length),r.push(a),o=0;o<e.length;o+=1)a[o]=Va(e[o],t,r,n,i);return t.pop(),r.pop(),a}if(e&&e.toJSON&&(e=e.toJSON()),yo(e)==="object"&&e!==null){t.push(e),a={},r.push(a);var c=[],w;for(w in e)e.hasOwnProperty(w)&&c.push(w);for(c.sort(),o=0;o<c.length;o+=1)w=c[o],a[w]=Va(e[w],t,r,n,w);t.pop(),r.pop()}else a=e;return a}var wo=new br;wo.tokenize=function(e){return e.slice()},wo.join=wo.removeEmpty=function(e){return e};function p_(e,t,r){return wo.diff(e,t,r)}function bo(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=e.split(/\r\n|[\n\v\f\r\x85]/),n=e.match(/\r\n|[\n\v\f\r\x85]/g)||[],i=[],o=0;function a(){var p={};for(i.push(p);o<r.length;){var S=r[o];if(/^(\-\-\-|\+\+\+|@@)\s/.test(S))break;var P=/^(?:Index:|diff(?: -r \w+)+)\s+(.+?)\s*$/.exec(S);P&&(p.index=P[1]),o++}for(c(p),c(p),p.hunks=[];o<r.length;){var k=r[o];if(/^(Index:|diff|\-\-\-|\+\+\+)\s/.test(k))break;if(/^@@/.test(k))p.hunks.push(w());else{if(k&&t.strict)throw new Error("Unknown line "+(o+1)+" "+JSON.stringify(k));o++}}}function c(p){var S=/^(---|\+\+\+)\s+(.*)$/.exec(r[o]);if(S){var P=S[1]==="---"?"old":"new",k=S[2].split("	",2),I=k[0].replace(/\\\\/g,"\\");/^".*"$/.test(I)&&(I=I.substr(1,I.length-2)),p[P+"FileName"]=I,p[P+"Header"]=(k[1]||"").trim(),o++}}function w(){var p=o,S=r[o++],P=S.split(/@@ -(\d+)(?:,(\d+))? \+(\d+)(?:,(\d+))? @@/),k={oldStart:+P[1],oldLines:typeof P[2]=="undefined"?1:+P[2],newStart:+P[3],newLines:typeof P[4]=="undefined"?1:+P[4],lines:[],linedelimiters:[]};k.oldLines===0&&(k.oldStart+=1),k.newLines===0&&(k.newStart+=1);for(var I=0,$=0;o<r.length&&!(r[o].indexOf("--- ")===0&&o+2<r.length&&r[o+1].indexOf("+++ ")===0&&r[o+2].indexOf("@@")===0);o++){var B=r[o].length==0&&o!=r.length-1?" ":r[o][0];if(B==="+"||B==="-"||B===" "||B==="\\")k.lines.push(r[o]),k.linedelimiters.push(n[o]||`
`),B==="+"?I++:B==="-"?$++:B===" "&&(I++,$++);else break}if(!I&&k.newLines===1&&(k.newLines=0),!$&&k.oldLines===1&&(k.oldLines=0),t.strict){if(I!==k.newLines)throw new Error("Added line count did not match for hunk at line "+(p+1));if($!==k.oldLines)throw new Error("Removed line count did not match for hunk at line "+(p+1))}return k}for(;o<r.length;)a();return i}function nm(e,t,r){var n=!0,i=!1,o=!1,a=1;return function c(){if(n&&!o){if(i?a++:n=!1,e+a<=r)return a;o=!0}if(!i)return o||(n=!0),t<=e-a?-a++:(i=!0,c())}}function hu(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(typeof t=="string"&&(t=bo(t)),Array.isArray(t)){if(t.length>1)throw new Error("applyPatch only works with a single input.");t=t[0]}var n=e.split(/\r\n|[\n\v\f\r\x85]/),i=e.match(/\r\n|[\n\v\f\r\x85]/g)||[],o=t.hunks,a=r.compareLine||function(Nr,$t,Yt,Jt){return $t===Jt},c=0,w=r.fuzzFactor||0,p=0,S=0,P,k;function I(Nr,$t){for(var Yt=0;Yt<Nr.lines.length;Yt++){var Jt=Nr.lines[Yt],ui=Jt.length>0?Jt[0]:" ",pa=Jt.length>0?Jt.substr(1):Jt;if(ui===" "||ui==="-"){if(!a($t+1,n[$t],ui,pa)&&(c++,c>w))return!1;$t++}}return!0}for(var $=0;$<o.length;$++){for(var B=o[$],q=n.length-B.oldLines,Z=0,K=S+B.oldStart-1,re=nm(K,p,q);Z!==void 0;Z=re())if(I(B,K+Z)){B.offset=S+=Z;break}if(Z===void 0)return!1;p=B.offset+B.oldStart+B.oldLines}for(var ee=0,se=0;se<o.length;se++){var Se=o[se],me=Se.oldStart+Se.offset+ee-1;ee+=Se.newLines-Se.oldLines;for(var Te=0;Te<Se.lines.length;Te++){var Oe=Se.lines[Te],Re=Oe.length>0?Oe[0]:" ",Pe=Oe.length>0?Oe.substr(1):Oe,Pt=Se.linedelimiters[Te];if(Re===" ")me++;else if(Re==="-")n.splice(me,1),i.splice(me,1);else if(Re==="+")n.splice(me,0,Pe),i.splice(me,0,Pt),me++;else if(Re==="\\"){var qt=Se.lines[Te-1]?Se.lines[Te-1][0]:null;qt==="+"?P=!0:qt==="-"&&(k=!0)}}}if(P)for(;!n[n.length-1];)n.pop(),i.pop();else k&&(n.push(""),i.push(`
`));for(var Wt=0;Wt<n.length-1;Wt++)n[Wt]=n[Wt]+i[Wt];return n.join("")}function g_(e,t){typeof e=="string"&&(e=bo(e));var r=0;function n(){var i=e[r++];if(!i)return t.complete();t.loadFile(i,function(o,a){if(o)return t.complete(o);var c=hu(a,i,t);t.patched(i,c,function(w){if(w)return t.complete(w);n()})})}n()}function pu(e,t,r,n,i,o,a){a||(a={}),typeof a.context=="undefined"&&(a.context=4);var c=Xg(r,n,a);c.push({value:"",lines:[]});function w(Z){return Z.map(function(K){return" "+K})}for(var p=[],S=0,P=0,k=[],I=1,$=1,B=function(K){var re=c[K],ee=re.lines||re.value.replace(/\n$/,"").split(`
`);if(re.lines=ee,re.added||re.removed){var se;if(!S){var Se=c[K-1];S=I,P=$,Se&&(k=a.context>0?w(Se.lines.slice(-a.context)):[],S-=k.length,P-=k.length)}(se=k).push.apply(se,_r(ee.map(function(Wt){return(re.added?"+":"-")+Wt}))),re.added?$+=ee.length:I+=ee.length}else{if(S)if(ee.length<=a.context*2&&K<c.length-2){var me;(me=k).push.apply(me,_r(w(ee)))}else{var Te,Oe=Math.min(ee.length,a.context);(Te=k).push.apply(Te,_r(w(ee.slice(0,Oe))));var Re={oldStart:S,oldLines:I-S+Oe,newStart:P,newLines:$-P+Oe,lines:k};if(K>=c.length-2&&ee.length<=a.context){var Pe=/\n$/.test(r),Pt=/\n$/.test(n),qt=ee.length==0&&k.length>Re.oldLines;!Pe&&qt&&r.length>0&&k.splice(Re.oldLines,0,"\\ No newline at end of file"),(!Pe&&!qt||!Pt)&&k.push("\\ No newline at end of file")}p.push(Re),S=0,P=0,k=[]}I+=ee.length,$+=ee.length}},q=0;q<c.length;q++)B(q);return{oldFileName:e,newFileName:t,oldHeader:i,newHeader:o,hunks:p}}function im(e){var t=[];e.oldFileName==e.newFileName&&t.push("Index: "+e.oldFileName),t.push("==================================================================="),t.push("--- "+e.oldFileName+(typeof e.oldHeader=="undefined"?"":"	"+e.oldHeader)),t.push("+++ "+e.newFileName+(typeof e.newHeader=="undefined"?"":"	"+e.newHeader));for(var r=0;r<e.hunks.length;r++){var n=e.hunks[r];n.oldLines===0&&(n.oldStart-=1),n.newLines===0&&(n.newStart-=1),t.push("@@ -"+n.oldStart+","+n.oldLines+" +"+n.newStart+","+n.newLines+" @@"),t.push.apply(t,n.lines)}return t.join(`
`)+`
`}function om(e,t,r,n,i,o,a){return im(pu(e,t,r,n,i,o,a))}function am(e,t,r,n,i,o){return om(e,e,t,r,n,i,o)}function sm(e,t){return e.length!==t.length?!1:Ga(e,t)}function Ga(e,t){if(t.length>e.length)return!1;for(var r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function cm(e){var t=Qa(e.lines),r=t.oldLines,n=t.newLines;r!==void 0?e.oldLines=r:delete e.oldLines,n!==void 0?e.newLines=n:delete e.newLines}function m_(e,t,r){e=gu(e,r),t=gu(t,r);var n={};(e.index||t.index)&&(n.index=e.index||t.index),(e.newFileName||t.newFileName)&&(mu(e)?mu(t)?(n.oldFileName=_o(n,e.oldFileName,t.oldFileName),n.newFileName=_o(n,e.newFileName,t.newFileName),n.oldHeader=_o(n,e.oldHeader,t.oldHeader),n.newHeader=_o(n,e.newHeader,t.newHeader)):(n.oldFileName=e.oldFileName,n.newFileName=e.newFileName,n.oldHeader=e.oldHeader,n.newHeader=e.newHeader):(n.oldFileName=t.oldFileName||e.oldFileName,n.newFileName=t.newFileName||e.newFileName,n.oldHeader=t.oldHeader||e.oldHeader,n.newHeader=t.newHeader||e.newHeader)),n.hunks=[];for(var i=0,o=0,a=0,c=0;i<e.hunks.length||o<t.hunks.length;){var w=e.hunks[i]||{oldStart:Infinity},p=t.hunks[o]||{oldStart:Infinity};if(vu(w,p))n.hunks.push(yu(w,a)),i++,c+=w.newLines-w.oldLines;else if(vu(p,w))n.hunks.push(yu(p,c)),o++,a+=p.newLines-p.oldLines;else{var S={oldStart:Math.min(w.oldStart,p.oldStart),oldLines:0,newStart:Math.min(w.newStart+a,p.oldStart+c),newLines:0,lines:[]};um(S,w.oldStart,w.lines,p.oldStart,p.lines),o++,i++,n.hunks.push(S)}}return n}function gu(e,t){if(typeof e=="string"){if(/^@@/m.test(e)||/^Index:/m.test(e))return bo(e)[0];if(!t)throw new Error("Must provide a base reference or pass in a patch");return pu(void 0,void 0,t,e)}return e}function mu(e){return e.newFileName&&e.newFileName!==e.oldFileName}function _o(e,t,r){return t===r?t:(e.conflict=!0,{mine:t,theirs:r})}function vu(e,t){return e.oldStart<t.oldStart&&e.oldStart+e.oldLines<t.oldStart}function yu(e,t){return{oldStart:e.oldStart,oldLines:e.oldLines,newStart:e.newStart+t,newLines:e.newLines,lines:e.lines}}function um(e,t,r,n,i){var o={offset:t,lines:r,index:0},a={offset:n,lines:i,index:0};for(bu(e,o,a),bu(e,a,o);o.index<o.lines.length&&a.index<a.lines.length;){var c=o.lines[o.index],w=a.lines[a.index];if((c[0]==="-"||c[0]==="+")&&(w[0]==="-"||w[0]==="+"))lm(e,o,a);else if(c[0]==="+"&&w[0]===" "){var p;(p=e.lines).push.apply(p,_r(on(o)))}else if(w[0]==="+"&&c[0]===" "){var S;(S=e.lines).push.apply(S,_r(on(a)))}else c[0]==="-"&&w[0]===" "?wu(e,o,a):w[0]==="-"&&c[0]===" "?wu(e,a,o,!0):c===w?(e.lines.push(c),o.index++,a.index++):Ka(e,on(o),on(a))}_u(e,o),_u(e,a),cm(e)}function lm(e,t,r){var n=on(t),i=on(r);if(Cu(n)&&Cu(i)){if(Ga(n,i)&&Su(r,n,n.length-i.length)){var o;(o=e.lines).push.apply(o,_r(n));return}else if(Ga(i,n)&&Su(t,i,i.length-n.length)){var a;(a=e.lines).push.apply(a,_r(i));return}}else if(sm(n,i)){var c;(c=e.lines).push.apply(c,_r(n));return}Ka(e,n,i)}function wu(e,t,r,n){var i=on(t),o=dm(r,i);if(o.merged){var a;(a=e.lines).push.apply(a,_r(o.merged))}else Ka(e,n?o:i,n?i:o)}function Ka(e,t,r){e.conflict=!0,e.lines.push({conflict:!0,mine:t,theirs:r})}function bu(e,t,r){for(;t.offset<r.offset&&t.index<t.lines.length;){var n=t.lines[t.index++];e.lines.push(n),t.offset++}}function _u(e,t){for(;t.index<t.lines.length;){var r=t.lines[t.index++];e.lines.push(r)}}function on(e){for(var t=[],r=e.lines[e.index][0];e.index<e.lines.length;){var n=e.lines[e.index];if(r==="-"&&n[0]==="+"&&(r="+"),r===n[0])t.push(n),e.index++;else break}return t}function dm(e,t){for(var r=[],n=[],i=0,o=!1,a=!1;i<t.length&&e.index<e.lines.length;){var c=e.lines[e.index],w=t[i];if(w[0]==="+")break;if(o=o||c[0]!==" ",n.push(w),i++,c[0]==="+")for(a=!0;c[0]==="+";)r.push(c),c=e.lines[++e.index];w.substr(1)===c.substr(1)?(r.push(c),e.index++):a=!0}if((t[i]||"")[0]==="+"&&o&&(a=!0),a)return r;for(;i<t.length;)n.push(t[i++]);return{merged:n,changes:r}}function Cu(e){return e.reduce(function(t,r){return t&&r[0]==="-"},!0)}function Su(e,t,r){for(var n=0;n<r;n++){var i=t[t.length-r+n].substr(1);if(e.lines[e.index+n]!==" "+i)return!1}return e.index+=r,!0}function Qa(e){var t=0,r=0;return e.forEach(function(n){if(typeof n!="string"){var i=Qa(n.mine),o=Qa(n.theirs);t!==void 0&&(i.oldLines===o.oldLines?t+=i.oldLines:t=void 0),r!==void 0&&(i.newLines===o.newLines?r+=i.newLines:r=void 0)}else r!==void 0&&(n[0]==="+"||n[0]===" ")&&r++,t!==void 0&&(n[0]==="-"||n[0]===" ")&&t++}),{oldLines:t,newLines:r}}function v_(e){for(var t=[],r,n,i=0;i<e.length;i++)r=e[i],r.added?n=1:r.removed?n=-1:n=0,t.push([n,r.value]);return t}function y_(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];n.added?t.push("<ins>"):n.removed&&t.push("<del>"),t.push(fm(n.value)),n.added?t.push("</ins>"):n.removed&&t.push("</del>")}return t.join("")}function fm(e){var t=e;return t=t.replace(/&/g,"&amp;"),t=t.replace(/</g,"&lt;"),t=t.replace(/>/g,"&gt;"),t=t.replace(/"/g,"&quot;"),t}function Za(e,t){let r={};for(let o=0;o<t.length;o++){const a=t[o];r[a]?r[a].push(o):r[a]=[o]}let i=[{buffer1index:-1,buffer2index:-1,chain:null}];for(let o=0;o<e.length;o++){const a=e[o],c=r[a]||[];let w=0,p=i[0];for(let S=0;S<c.length;S++){const P=c[S];let k;for(k=w;k<i.length&&!(i[k].buffer2index<P&&(k===i.length-1||i[k+1].buffer2index>P));k++);if(k<i.length){const I={buffer1index:o,buffer2index:P,chain:i[k]};if(w===i.length?i.push(p):i[w]=p,w=k+1,p=I,w===i.length)break}}i[w]=p}return i[i.length-1]}function hm(e,t){const r=Za(e,t);let n=[],i=e.length,o=t.length,a={common:[]};function c(){a.common.length&&(a.common.reverse(),n.push(a),a={common:[]})}for(let w=r;w!==null;w=w.chain){let p={buffer1:[],buffer2:[]};for(;--i>w.buffer1index;)p.buffer1.push(e[i]);for(;--o>w.buffer2index;)p.buffer2.push(t[o]);(p.buffer1.length||p.buffer2.length)&&(c(),p.buffer1.reverse(),p.buffer2.reverse(),n.push(p)),i>=0&&a.common.push(e[i])}return c(),n.reverse(),n}function Eu(e,t){const r=Za(e,t);let n=[],i=e.length,o=t.length;for(let a=r;a!==null;a=a.chain){const c=i-a.buffer1index-1,w=o-a.buffer2index-1;i=a.buffer1index,o=a.buffer2index,(c||w)&&n.push({buffer1:[i+1,c],buffer1Content:e.slice(i+1,i+1+c),buffer2:[o+1,w],buffer2Content:t.slice(o+1,o+1+w)})}return n.reverse(),n}function w_(e,t){const r=Za(e,t);let n=[],i=e.length,o=t.length;function a(c,w,p){let S=[];for(let P=0;P<p;P++)S.push(c[w+P]);return{offset:w,length:p,chunk:S}}for(let c=r;c!==null;c=c.chain){const w=i-c.buffer1index-1,p=o-c.buffer2index-1;i=c.buffer1index,o=c.buffer2index,(w||p)&&n.push({buffer1:a(e,c.buffer1index+1,w),buffer2:a(t,c.buffer2index+1,p)})}return n.reverse(),n}function pm(e,t,r){let n=[];function i(w,p){n.push({ab:p,oStart:w.buffer1[0],oLength:w.buffer1[1],abStart:w.buffer2[0],abLength:w.buffer2[1]})}Eu(t,e).forEach(w=>i(w,"a")),Eu(t,r).forEach(w=>i(w,"b")),n.sort((w,p)=>w.oStart-p.oStart);let o=[],a=0;function c(w){w>a&&(o.push({stable:!0,buffer:"o",bufferStart:a,bufferLength:w-a,bufferContent:t.slice(a,w)}),a=w)}for(;n.length;){let w=n.shift(),p=w.oStart,S=w.oStart+w.oLength,P=[w];for(c(p);n.length;){const k=n[0],I=k.oStart;if(I>S)break;S=Math.max(S,I+k.oLength),P.push(n.shift())}if(P.length===1){if(w.abLength>0){const k=w.ab==="a"?e:r;o.push({stable:!0,buffer:w.ab,bufferStart:w.abStart,bufferLength:w.abLength,bufferContent:k.slice(w.abStart,w.abStart+w.abLength)})}}else{let k={a:[e.length,-1,t.length,-1],b:[r.length,-1,t.length,-1]};for(;P.length;){w=P.shift();const K=w.oStart,re=K+w.oLength,ee=w.abStart,se=ee+w.abLength;let Se=k[w.ab];Se[0]=Math.min(ee,Se[0]),Se[1]=Math.max(se,Se[1]),Se[2]=Math.min(K,Se[2]),Se[3]=Math.max(re,Se[3])}const I=k.a[0]+(p-k.a[2]),$=k.a[1]+(S-k.a[3]),B=k.b[0]+(p-k.b[2]),q=k.b[1]+(S-k.b[3]);let Z={stable:!1,aStart:I,aLength:$-I,aContent:e.slice(I,$),oStart:p,oLength:S-p,oContent:t.slice(p,S),bStart:B,bLength:q-B,bContent:r.slice(B,q)};o.push(Z)}a=S}return c(t.length),o}function Xa(e,t,r,n){n=Object.assign({excludeFalseConflicts:!0,stringSeparator:/\s+/},n);const o=typeof e=="string",a=typeof t=="string",c=typeof r=="string";o&&(e=e.split(n.stringSeparator)),a&&(t=t.split(n.stringSeparator)),c&&(r=r.split(n.stringSeparator));let w=[];const p=pm(e,t,r);let S=[];function P(){S.length&&w.push({ok:S}),S=[]}function k(I,$){if(I.length!==$.length)return!1;for(let B=0;B<I.length;B++)if(I[B]!==$[B])return!1;return!0}return p.forEach(I=>{I.stable?S.push(...I.bufferContent):n.excludeFalseConflicts&&k(I.aContent,I.bContent)?S.push(...I.aContent):(P(),w.push({conflict:{a:I.aContent,aIndex:I.aStart,o:I.oContent,oIndex:I.oStart,b:I.bContent,bIndex:I.bStart}}))}),P(),w}function b_(e,t,r,n){n=Object.assign({excludeFalseConflicts:!0,stringSeparator:/\s+/,label:{}},n);const o=Xa(e,t,r,n);let a=!1,c=[];return o.forEach(w=>{w.ok?c=c.concat(w.ok):w.conflict&&(a=!0,c.push(`<<<<<<<${n.label.a?` ${n.label.a}`:""}`),c=c.concat(w.conflict.a),c.push(`|||||||${n.label.o?` ${n.label.o}`:""}`),c=c.concat(w.conflict.o),c.push("======="),c=c.concat(w.conflict.b),c.push(`>>>>>>>${n.label.b?` ${n.label.b}`:""}`))}),{conflict:a,result:c}}function gm(e,t,r,n){n=Object.assign({excludeFalseConflicts:!0,stringSeparator:/\s+/},n);const o=Xa(e,t,r,n);let a=!1,c=[];for(let w=0;w<o.length;w++){const p=o[w];p.ok?c=c.concat(p.ok):(a=!0,c=c.concat([`
<<<<<<<<<
`],p.conflict.a,[`
=========
`],p.conflict.b,[`
>>>>>>>>>
`]))}return{conflict:a,result:c}}function __(e,t,r,n){n=Object.assign({excludeFalseConflicts:!1,stringSeparator:/\s+/},n);const o=Xa(e,t,r,n);let a=!1,c=[];for(let w=0;w<o.length;w++){const p=o[w];if(p.ok)c=c.concat(p.ok);else{const S=hm(p.conflict.a,p.conflict.b);for(let P=0;P<S.length;P++){let k=S[P];k.common?c=c.concat(k.common):(a=!0,c=c.concat([`
<<<<<<<<<
`],k.buffer1,[`
=========
`],k.buffer2,[`
>>>>>>>>>
`]))}}}return{conflict:a,result:c}}function C_(e,t){let r=[],n=0;function i(o){for(;n<o;)r.push(e[n]),n++}for(let o=0;o<t.length;o++){let a=t[o];i(a.buffer1.offset);for(let c=0;c<a.buffer2.chunk.length;c++)r.push(a.buffer2.chunk[c]);n+=a.buffer1.length}return i(e.length),r}function S_(e){return e.map(t=>({buffer1:{offset:t.buffer1.offset,length:t.buffer1.length},buffer2:{chunk:t.buffer2.chunk}}))}function E_(e){return e.map(t=>({buffer1:t.buffer2,buffer2:t.buffer1}))}function xu(e,t,r){return hu(e,t,r)}function Tu(e,t,r){let n=`
`;const i=e.match(/(?:\r?\n)/g);if(i!==null&&i.length!==0){const w=i.filter(p=>p===`\r
`).length;n=w>i.length-w?`\r
`:`
`}const o=gm(e,t,r,{excludeFalseConflicts:!0,stringSeparator:/\r?\n/}),a=o.result;let c=!1;if(o.conflict){let w;const p=[];let S=0;for(const I of a)I===`
<<<<<<<<<
`?w={start:S,separator:S,end:S}:I===`
=========
`?w.separator=S:I===`
>>>>>>>>>
`&&(w.end=S,p.push(w)),S++;let P=0,k=0;for(const I of p)a.splice(I.start-P,1),P++,k=I.end-I.separator+1,a.splice(I.separator-P,k),P+=k;p.length&&(c=!0)}return{conflicts:c,mergedContent:a.join(n)}}const Ya=require("process");let Ja=0;function mm(){return Ja===Number.MAX_SAFE_INTEGER&&(Ja=0),++Ja}const an=class{constructor(e,t,...r){this.context=e,this.instance=`[${mm().toString().padStart(5)}] `;var n,i,o,a,c;let w;if(typeof(t==null?void 0:t.log)=="boolean"?w={}:w=t==null?void 0:t.log,this.logLevel=(n=t==null?void 0:t.logLevel)!=null?n:Ke.Debug,this.time=(0,Ya.hrtime)(),w){if(!he.enabled(this.logLevel))return;r.length?es(this.logLevel,`${this.instance}${(i=w.prefix)!=null?i:""}${e}${(o=w.message)!=null?o:""}`,...r):es(this.logLevel,`${this.instance}${(a=w.prefix)!=null?a:""}${e}${(c=w.message)!=null?c:""}`)}}log(e){this.logCore(this.context,e)}restart(e){this.logCore(this.context,e),this.time=(0,Ya.hrtime)()}stop(e){this.restart(e)}logCore(e,t){var r,n,i,o;if(!he.enabled(this.logLevel))return;const[a,c]=(0,Ya.hrtime)(this.time),w=a*1e3+Math.floor(c/1e6);es(w>500?Ke.Warn:this.logLevel,`${this.instance}${(r=t==null?void 0:t.prefix)!=null?r:""}${e}${(n=t==null?void 0:t.message)!=null?n:""}${(i=t==null?void 0:t.took)!=null?i:" \u2022 took "}${w} ms${(o=t==null?void 0:t.suffix)!=null?o:""}`)}static start(e,t,...r){var n;(n=an.watches.get(e))==null||n.log(),an.watches.set(e,new an(e,t,...r))}static log(e,t){var r;(r=an.watches.get(e))==null||r.log(t)}static restart(e,t){const r=an.watches.get(e);if(!r)throw new Error(`Unable to restart ${e} as it has never been started`);r.restart(t)}static stop(e,t){var r;(r=an.watches.get(e))==null||r.stop(t)}};let Qe=an;Qe.watches=new Map;function es(e,t,...r){switch(e){case Ke.Warn:he.warn(t,...r);break;case Ke.Info:he.log(t,...r);break;default:he.debug(t,...r);break}}let ts=0;function vm(){return ts===Number.MAX_SAFE_INTEGER&&(ts=0),String(++ts)}class ym{constructor(){this.id=vm()}async synchronize(t){let r;const n=this.promise;this.promise=new Promise(i=>r=i),await n;try{return await t()}finally{r()}}}class Co{constructor(t){this.lock=new ym,this.readers=new Set,this.counter=0,this._id=t!=null?t:this.lock.id}get id(){return this._id}getNextCounter(){return this.counter===Number.MAX_SAFE_INTEGER&&(this.counter=0),++this.counter}async synchronizeRead(t,r){let n;const i=new Qe(`Reader(${this.getNextCounter()}|${this.id})`,{log:{prefix:"(A) ",message:r?` \u2022 ${r}`:""}});let o;await this.lock.synchronize(async()=>{this.writer&&await this.writer,o=new Promise(a=>n=a),this.readers.add(o)}),i.restart({prefix:"(L) ",suffix:r?` \u2022 ${r}`:"",took:" waited for "});try{return await t()}finally{i.stop({prefix:"(U) ",suffix:r?` \u2022 ${r}`:"",took:" locked for "}),o!==void 0&&this.readers.delete(o),n()}}async synchronizeWrite(t,r){let n;const i=new Qe(`Writer(${this.getNextCounter()}|${this.id})`,{log:{prefix:"(A) ",message:r?` \u2022 ${r}`:""}});await this.lock.synchronize(async()=>{if(this.writer&&await this.writer,this.readers.size){const o=[...this.readers];this.readers.clear(),await Promise.all(o)}this.writer=new Promise(o=>n=o)}),i.restart({prefix:"(L) ",suffix:r?` \u2022 ${r}`:"",took:" waited for "});try{return await t()}finally{i.stop({prefix:"(U) ",suffix:r?` \u2022 ${r}`:"",took:" locked for "}),n(),this.writer=void 0}}}class wm{constructor(){this.locks=new Map}async synchronizeRead(t,r,n){let i=this.locks.get(t);return i===void 0&&(i=new Co(String(t)),this.locks.set(t,i)),i.synchronizeRead(r,n)}async synchronizeWrite(t,r,n){let i=this.locks.get(t);return i===void 0&&(i=new Co(String(t)),this.locks.set(t,i)),i.synchronizeWrite(r,n)}}var bm=Object.defineProperty,_m=Object.getOwnPropertyDescriptor,Cm=(e,t,r,n)=>{for(var i=n>1?void 0:n?_m(t,r):t,o=e.length-1,a;o>=0;o--)(a=e[o])&&(i=(n?a(t,r,i):a(i))||i);return n&&i&&bm(t,r,i),i};const Ht=(0,E.LV)(),Ru=`===================================================================
`,or=new TextDecoder,Sm=new TextEncoder;var Be;(function(e){e[e.Changed=1]="Changed",e[e.Created=2]="Created",e[e.Deleted=3]="Deleted"})(Be||(Be={}));function Em(e){return e&&"type"in e&&"uri"in e&&"uri"in e&&"fileType"in e&&"revision"in e&&"timestamp"in e}function So(e,t,r){return{type:e.type,rootUri:t,uri:r!=null?r:e.uri}}const Nn=class{constructor(e,t,r,n,i){this.providerService=e,this.storageService=t,this.fileStorageService=r,this.workspaceId=n,this._onDidChange=new s.EventEmitter,this.cache=new Map,this.lock=new wm,this.scopedStores=new Map,i===void 0&&(Nn._instance=this,this.disposable=s.Disposable.from(this.providerService.onDidRefresh(()=>this.cache.clear())))}static get instance(){return this._instance}get onDidChange(){return this._onDidChange.event}dispose(){var e;(e=this.disposable)==null||e.dispose()}async getWorkspaceProvidersWithChanges(){var e,t;const r=new Map;for(const n of(e=s.workspace.workspaceFolders)!=null?e:[])if(n.uri.scheme===Je.scheme&&await this.hasChanges(n.uri)){const i=(t=this.providerService.getRepository(n.uri))==null?void 0:t.provider;if(!i)continue;r.set(i.id,i)}return[...r.values()]}async hasAnyWorkspaceChanges(){var e;const t=[];for(const r of(e=s.workspace.workspaceFolders)!=null?e:[])r.uri.scheme===Je.scheme&&await this.hasChanges(r.uri)&&t.push(r.uri);return t.length>0?t:void 0}async acceptAll(e){const t=`ChangeStore.acceptAll(${e.toString()})`;he.log(t);const r=[];await this.lock.synchronizeWrite(be(e),async()=>{const n=await this.getWorkingOperations(e);for(const i of n){i.fileType===s.FileType.File&&await this.discardWorkingContent(e,i.uri);let o;i.type===2&&i.fileType===s.FileType.Directory&&(n.some(a=>ho(a.uri,i.uri))||(o={type:3,uri:i.uri,rootUri:e})),r.push(o!=null?o:So(i,e))}await this.discardWorkingOperations(e)},t),r.length!==0&&this._onDidChange.fire(r)}async discard(e){const t=this.providerService.getVirtualWorkspaceUri(e);if(t===void 0)return;const r=`ChangeStore.discard(${e.toString()})`;he.log(r);const n=[];await this.lock.synchronizeWrite(be(t),async()=>this.discardCore(t,e,n),r),n.length!==0&&this._onDidChange.fire(n)}async discardCore(e,t,r){he.debug(`ChangeStore.discardCore(${t.toString()})`);const n=await this.getWorkingOperations(e);if(n.length===0)return;const i=be(t),o=n.findIndex(P=>be(P.uri)===i);if(o===-1)return;const[a]=n.splice(o,1);await this.saveWorkingOperations(e,n),await this.discardWorkingContent(e,t);let c;switch(a.type){case 2:c=3;break;case 3:c=2;break;default:c=a.type;break}r.push({type:c,rootUri:e,uri:t});const w=zg(t),p=be(w),S=n.find(P=>be(P.uri)===p);(S==null?void 0:S.type)===2&&(n.some(P=>ho(P.uri,w))||await this.discardCore(e,w,r))}async discardAll(e){const t=`ChangeStore.discardAll(${e.toString()})`;he.log(t);const r=[];await this.lock.synchronizeWrite(be(e),async()=>{const n=await this.getWorkingOperations(e);for(const i of n){i.fileType===s.FileType.File&&await this.discardWorkingContent(e,i.uri);let o;switch(i.type){case 2:o=3;break;case 3:o=2;break;default:o=i.type;break}r.push({type:o,rootUri:e,uri:i.uri})}await this.discardWorkingOperations(e)},t),r.length!==0&&this._onDidChange.fire(r)}async stage(e){const t=this.providerService.getVirtualWorkspaceUri(e);if(t===void 0)return;const r=`ChangeStore.stage(${e.toString()})`;he.log(r);const n=[];await this.lock.synchronizeWrite(be(t),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(e,t);i!==void 0&&await this.spliceOperation(e,o,{...i,staged:!0,timestamp:Date.now()},n)},r),n.length!==0&&this._onDidChange.fire(n)}async stageAll(e){const t=`ChangeStore.stageAll(${e.toString()})`;he.log(t);const r=[];await this.lock.synchronizeWrite(be(e),async()=>{const n=(await this.getWorkingOperations(e)).map(i=>({...i,staged:!0,timestamp:Date.now()}));n.length!==0&&(await this.saveWorkingOperations(e,n),r.push(...n.map(i=>So(i,e))))},t),r.length!==0&&this._onDidChange.fire(r)}async unstage(e){const t=this.providerService.getVirtualWorkspaceUri(e);if(t===void 0)return;const r=`ChangeStore.unstage(${e.toString()})`;he.log(r);const n=[];await this.lock.synchronizeWrite(be(t),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(e,t);i!==void 0&&await this.spliceOperation(e,o,{...i,staged:!1,timestamp:Date.now()},n)},r),n.length!==0&&this._onDidChange.fire(n)}async unstageAll(e){const t=`ChangeStore.unstageAll(${e.toString()})`;he.log(t);const r=[];await this.lock.synchronizeWrite(be(e),async()=>{const n=(await this.getWorkingOperations(e)).map(i=>({...i,staged:!1,timestamp:Date.now()}));n.length!==0&&(await this.saveWorkingOperations(e,n),r.push(...n.map(i=>So(i,e))))},t),r.length!==0&&this._onDidChange.fire(r)}async hasChanges(e){return this.lock.synchronizeRead(be(e),async()=>(await this.getWorkingOperations(e)).length!==0,`ChangeStore.hasChanges(${e.toString()})`)}async hasMergeConflicts(e){return this.lock.synchronizeRead(be(e),async()=>(await this.getWorkingOperations(e)).some(t=>t.conflicts!==void 0),`ChangeStore.hasMergeConflicts(${e.toString()})`)}async hasStagedChanges(e){return this.lock.synchronizeRead(be(e),async()=>(await this.getWorkingOperations(e)).some(t=>t.staged&&t.conflicts===void 0),`ChangeStore.hasStagedChanges(${e.toString()})`)}async hasWorkingChanges(e){return this.lock.synchronizeRead(be(e),async()=>(await this.getWorkingOperations(e)).some(t=>!t.staged&&t.conflicts===void 0),`ChangeStore.hasWorkingChanges(${e.toString()})`)}async getChange(e){const t=this.getUriScope(e);if(t)return this.getScopedChangeStore(t).getChange(e);const r=this.providerService.getVirtualRootUri(e);if(r!==void 0)return this.lock.synchronizeRead(be(r),async()=>{const{operation:n}=await this.getWorkingOperation(e,r);return n},`ChangeStore.getChange(${e.toString()})`)}async getChanges(e,t){const r=this.getUriScope(e);return r?this.getScopedChangeStore(r).getChanges(e,t):this.lock.synchronizeRead(be(e),async()=>{let n=await this.getWorkingOperations(e);if((t==null?void 0:t.excludeConflicts)||(t==null?void 0:t.predicate)){const{excludeConflicts:i,predicate:o}=t;n=n.filter(a=>{var c;return(!i||a.conflicts===void 0)&&((c=o==null?void 0:o(a))!=null?c:!0)})}return n},`ChangeStore.getChanges(${e.toString()})`)}async getGroupedChanges(e,t){const r=this.getUriScope(e);return r?this.getScopedChangeStore(r).getGroupedChanges(e,t):this.lock.synchronizeRead(be(e),async()=>{var n,i;const o=await this.getWorkingOperations(e),a={conflicts:[],staged:[],working:[]};for(const c of o)!((i=(n=t==null?void 0:t.predicate)==null?void 0:n.call(t,c))!=null?i:!0)||(c.conflicts?a.conflicts.push(c):c.staged?a.staged.push(c):a.working.push(c));return a},`ChangeStore.getChangesByType(${e.toString()})`)}async getContent(e){const t=this.providerService.getVirtualRootUri(e);if(t===void 0)throw new Error(`Unable to find content for ${e.toString()}; Repository not found`);return this.lock.synchronizeRead(be(t),async()=>{const r=or.decode(await this.getWorkingContent(t,e));if(r!==void 0)return r;throw new Error(`Unable to find content for ${e.toString()}`)},`ChangeStore.getContent(${e.toString()}}`)}async getMergeConflicts(e,t){return this.lock.synchronizeRead(be(e),async()=>(await this.getWorkingOperations(e)).filter(n=>{var i,o;return n.conflicts!==void 0&&((o=(i=t==null?void 0:t.predicate)==null?void 0:i.call(t,n))!=null?o:!0)}),`ChangeStore.getMergeConflicts(${e.toString()})`)}async getStagedChanges(e,t){return this.lock.synchronizeRead(be(e),async()=>(await this.getWorkingOperations(e)).filter(n=>{var i,o;return n.staged&&n.conflicts===void 0&&((o=(i=t==null?void 0:t.predicate)==null?void 0:i.call(t,n))!=null?o:!0)}),`ChangeStore.getStagedChanges(${e.toString()})`)}async getWorkingChanges(e,t){return this.lock.synchronizeRead(be(e),async()=>(await this.getWorkingOperations(e)).filter(n=>{var i,o;return!n.staged&&n.conflicts===void 0&&((o=(i=t==null?void 0:t.predicate)==null?void 0:i.call(t,n))!=null?o:!0)}),`ChangeStore.getWorkingChanges(${e.toString()})`)}async applyChangeset(e,t,r,n){var i;let o;Em(r)?o=r:n=n!=null?n:r,he.log(`ChangeStore.applyChangeset${e.toString()}`,t.workspaceId,t.uri,o==null?void 0:o.uri,n==null?void 0:n.save);const a=this.getScopedChangeStore(t.workspaceId),c=(i=t.patch)!=null?i:await a.createPatch(t.uri,o==null?void 0:o.uri);await this.applyPatchCore(e,c,{...n,getIncomingContent:async w=>{const p=this.getScopedUri(this.providerService.createRelativeVirtualUri(t.uri,w),t.workspaceId);return or.decode(await s.workspace.fs.readFile(p))},merge:async(w,p,S)=>{try{const P=this.providerService.getProviderUri(w),k=or.decode(await s.workspace.fs.readFile(P)),I=this.getScopedUri(this.providerService.createRelativeVirtualUri(t.uri,p),t.workspaceId),$=or.decode(await s.workspace.fs.readFile(I));return{...Tu(S,k,$),baseUri:P,incomingUri:I}}catch(P){throw new Error(`Unable to apply patch to ${p}: ${P.message}`)}}})}async applyPatch(e,t,r){return he.log(`ChangeStore.applyPatch(${e.toString()})`,r==null?void 0:r.save),this.applyPatchCore(e,t,r)}async applyPatchCore(e,t,r={}){const n=`ChangeStore.applyPatchCore(${e.toString()})`;he.debug(n,r==null?void 0:r.save);const i=new s.WorkspaceEdit,o=[],a=new Map;async function c(k){var I;const $=be(k),B=s.workspace.textDocuments.find(q=>be(q.uri)===$);return(I=B==null?void 0:B.getText())!=null?I:or.decode(await s.workspace.fs.readFile(k))}async function w(k){try{const I=await s.workspace.fs.stat(k);return Boolean(I)}catch{return!1}}async function p(k,I,$){let B=xu("",$,{fuzzFactor:0});if(B===!1){if(!r.getIncomingContent)throw new Error(`Unable to apply patch to ${I}`);B=await r.getIncomingContent(I)}i.createFile(k,{overwrite:!0}),i.replace(k,new s.Range(0,0,Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),B)}async function S(k,I,$,B){const q=await c(k);let Z=xu(q,$,{fuzzFactor:1});if(Z===!1){if(r.merge===void 0)throw new Error(`Unable to apply patch to ${I}; Resulted in conflicts`);const K={title:Ht("apply patch failed prompt confirm","Merge")},re={title:Ht("apply patch failed prompt cancel","Skip File"),isCloseAffordance:!0};if(await s.window.showWarningMessage(Ht("apply patch failed prompt",`Unable to apply changes to '{0}'.

Do you want to retry by merging the files?`,I),{modal:!0},K,re)!==K)return;const se=await r.merge(k,I,q);Z=se.mergedContent,se.conflicts&&a.set(be(k),{type:B,baseUri:se.baseUri,incomingUri:se.incomingUri})}i.replace(k,new s.Range(0,0,Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),Z)}const P=bo(t,{});for(const k of P)if(k.oldFileName==="/dev/null"){if(!k.newFileName)continue;const I=k.newFileName.startsWith("b/")?k.newFileName.substr(2):k.newFileName,$=this.providerService.createRelativeVirtualUri(e,I);o.push(be($)),!await w($)?await p($,I,k):await S($,I,k,2)}else if(k.newFileName==="/dev/null"){if(!k.oldFileName)continue;const I=k.oldFileName.startsWith("a/")?k.oldFileName.substr(2):k.oldFileName,$=this.providerService.createRelativeVirtualUri(e,I);await w($)&&i.deleteFile($)}else if(k.oldFileName===k.newFileName){if(!k.newFileName)continue;const I=this.providerService.createRelativeVirtualUri(e,k.newFileName);o.push(be(I)),!await w(I)?await p(I,k.newFileName,k):await S(I,k.newFileName,k,1)}else throw new Error(`Unable to apply patch to ${k.oldFileName}; Renames aren't currently supported`);if(await s.workspace.applyEdit(i),r.save&&o.length)for(const k of o){const I=s.workspace.textDocuments.find($=>be($.uri)===k);await(I==null?void 0:I.save())}a.size&&setTimeout(async()=>{const k=[];await this.lock.synchronizeWrite(be(e),async()=>{const I=await this.getWorkingOperations(e);if(I.length===0)return;let $=-1;for(const B of I){$++;const q=a.get(be(B.uri));q!==void 0&&await this.spliceOperation(B.uri,$,{...B,conflicts:{baseUri:q.baseUri,incomingUri:q.incomingUri,status:[B.type,q.type]},timestamp:Date.now()},k)}},n),k.length!==0&&this._onDidChange.fire(k)},0)}async createChangeset(e){he.log(`ChangeStore.createChangeset${e.toString()})`);const t=await this.createPatch(e);return t?{workspaceId:this.workspaceId,uri:e,patch:t}:void 0}async createPatch(e,t){if(he.log(`ChangeStore.createPatch${e.toString()})`,t),t===void 0){if((await this.getWorkingOperations(e)).length===0)return"";const o=[];for(const a of await this.getWorkingOperations(e)){const c=await this.createPatchCore(e,a);o.push(c)}return o.join("")}const{operation:r}=await this.getWorkingOperation(t,e);if(r===void 0)throw new Error(`Unable to create patch for ${t.toString(!0)}`);return await this.createPatchCore(e,r)}async createPatchCore(e,t){const r=this.providerService.getRelativeFilePath(e,t.uri),n=`diff --git a/${r} b/${r}`;if(t.type===2){let w=await this.getContent(t.uri),p;!w.endsWith(`
`)&&!w.endsWith(`\r
`)?p=`
\\ No newline at end of file`:p="";let S=0;return w=w.replace(/\r?\n/g,P=>(S++,`${P}+`)),`${n}
new file mode 100644
--- /dev/null
+++ b/${r}
@@ -0,0 +1,${S} @@
+${w}${p}`}if(t.type===3){let w=or.decode(await s.workspace.fs.readFile(this.providerService.getProviderUri(t.uri))),p=0;return w=w.replace(/\r?\n/g,S=>(p++,`${S}-`)),`${n}
deleted file mode 100644
--- a/${r}
+++ /dev/null
@@ -1,${p} +0,0 @@
-${w}`}const i=await this.getContent(t.uri),o=or.decode(await s.workspace.fs.readFile(this.providerService.getProviderUri(t.uri))),a=am(r,o,i),c=a.indexOf(Ru);return`${n}
${a.substr(c+Ru.length)}`}async keep(e,t){const r=this.providerService.getVirtualWorkspaceUri(e);if(r===void 0)return;const n=`ChangeStore.keep(${e.toString()})`;he.log(n,t);const i=[];await this.lock.synchronizeWrite(be(r),async()=>{const{operation:o,index:a}=await this.getWorkingOperation(e,r);if(o===void 0)return;if(t===void 0&&o.conflicts){const[,w]=o.conflicts.status;switch(w){case 1:switch(o.type){case 1:case 2:case 3:await this.spliceOperation(e,a,{...o,conflicts:void 0,timestamp:Date.now()},i);break}break;case 2:switch(o.type){case 1:case 3:await this.spliceOperation(e,a,{...o,conflicts:void 0,timestamp:Date.now()},i);break;case 2:await this.spliceOperation(e,a,{...o,type:1,size:o.size,hash:o.hash,originalHash:o.originalHash,conflicts:void 0,timestamp:Date.now()},i);break}break;case 3:switch(o.type){case 3:await this.discardCore(r,e,i);break;case 1:await this.spliceOperation(e,a,{...o,type:2,originalHash:void 0,conflicts:void 0,timestamp:Date.now()},i);break;case 2:await this.spliceOperation(e,a,{...o,conflicts:void 0,timestamp:Date.now()},i);break}break}return}if(t===void 0)return;switch(t.type){case 1:switch(o.type){case 3:await this.spliceOperation(e,a,{...o,type:3,size:void 0,hash:void 0,originalHash:void 0,conflicts:void 0,timestamp:Date.now()},i);return;case 2:break;case 1:break}break;case 2:switch(o.type){case 1:case 3:return;case 2:break}break;case 3:switch(o.type){case 3:return this.discardCore(r,e,i);case 1:await this.spliceOperation(e,a,{...o,type:2,originalHash:void 0,conflicts:void 0,timestamp:Date.now()},i);return;case 2:return}}const c=t!==void 0?await s.workspace.fs.readFile(t.providerUri):void 0;await this.spliceOperation(e,a,{...o,type:1,originalHash:c!==void 0?await fo(c):o.originalHash,conflicts:void 0,timestamp:Date.now()},i)},n),i.length!==0&&this._onDidChange.fire(i)}async merge(e,t,r){const n=this.providerService.getVirtualWorkspaceUri(e);if(n===void 0)return;const i=`ChangeStore.merge(${e.toString()})`;he.log(i,t,r);const o=[];await this.lock.synchronizeWrite(be(n),async()=>{const{operation:a,index:c}=await this.getWorkingOperation(e,n);if(a===void 0)return;switch(t.type){case 1:switch(a.type){case 3:return void this.spliceOperation(e,c,{...a,type:3,size:void 0,hash:void 0,originalHash:void 0,conflicts:{baseUri:r.providerUri,incomingUri:t.providerUri,status:[a.type,t.type]},timestamp:Date.now()},o);case 2:break;case 1:break}break;case 2:switch(a.type){case 3:case 1:return;case 2:break}break;case 3:switch(a.type){case 3:return this.discardCore(n,e,o);case 1:return void this.spliceOperation(e,c,{...a,type:2,originalHash:void 0,conflicts:{baseUri:void 0,incomingUri:t.providerUri,status:[a.type,t.type]},timestamp:Date.now()},o);case 2:return}}const w=await this.getWorkingContent(n,e),p=await s.workspace.fs.readFile(r.providerUri),S=await s.workspace.fs.readFile(t.providerUri),P=Tu(or.decode(w),or.decode(p),or.decode(S));await this.writeFileCore(n,e,o,Sm.encode(P.mergedContent),S!=null?S:new Uint8Array(0),P.conflicts?{baseUri:r.providerUri,incomingUri:t.providerUri,status:[a.type,t.type]}:void 0)},i),o.length!==0&&this._onDidChange.fire(o)}async resolveDiffCommand(e,t,r,n){let i;const o=this.providerService.getVirtualRootUri(e);return o!==void 0&&({operation:i}=await this.getWorkingOperation(e,o)),(i==null?void 0:i.type)===3?this.resolveOpenCommand(t):((i==null?void 0:i.type)===2&&(t=t.with({query:"~"})),{command:"vscode.diff",title:"Open Changes",arguments:[t,e,r,n]})}resolveOpenCommand(e,t){return{command:"vscode.open",title:"Open File",arguments:[e,t]}}getScopedUri(e,t){const r=typeof t=="string"?t:t.workspaceId;return r===this.workspaceId?e:e.with({fragment:r})}getUriScope(e){return e.fragment||void 0}getScopedChangeStore(e){const t=typeof e=="string"?e:e.workspaceId;he.log(`ChangeStore.getScopedChangeStore(${t})`);let r=this.scopedStores.get(t);return r===void 0&&(r=t===this.workspaceId?new Nn.ScopedChangeStore(this,t,this.workspaceId):new Nn.ScopedChangeStore(new Nn(this.providerService,this.storageService.with(t),this.fileStorageService.with(t),this.workspaceId,t),t,this.workspaceId),this.scopedStores.set(t,r)),r}async stat(e){const t=this.getUriScope(e);if(t)return this.getScopedChangeStore(t).stat(e);const r=this.providerService.getVirtualRootUri(e);if(r!==void 0)return this.lock.synchronizeRead(be(r),async()=>{var n;const{operation:i}=await this.getWorkingOperation(e,r);if(i!==void 0){if(i.type===3)throw s.FileSystemError.FileNotFound(`The ${i.fileType===s.FileType.Directory?"folder":"file"} has been deleted.`);return{type:i.fileType,size:(n=i.size)!=null?n:0,ctime:0,mtime:i.timestamp}}},`ChangeStore.stat(${e.toString()}`)}async readFile(e){const t=this.getUriScope(e);if(t)return this.getScopedChangeStore(t).readFile(e);const r=new Qe(`ChangeStore.readFile(${e.toString()})`,{log:!0});try{const n=this.providerService.getVirtualRootUri(e);return n===void 0?void 0:await this.lock.synchronizeRead(be(n),()=>this.getWorkingContent(n,e),r.context)}finally{r.stop()}}async createDirectory(e){const t=this.providerService.getVirtualWorkspaceUri(e);if(t===void 0)return;const r=new Qe(`ChangeStore.createDirectory(${e.toString()})`,{log:!0});try{const n=[];if(await this.lock.synchronizeWrite(be(t),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(e,t),a=await this.providerService.getMetadata(e);await this.spliceOperation(e,o,i===void 0?{type:2,uri:e,fileType:s.FileType.Directory,revision:a.HEAD.sha,timestamp:Date.now(),size:0,hash:"",originalHash:void 0}:{...i,timestamp:Date.now()},n)},r.context),n.length===0)return;this._onDidChange.fire(n)}finally{r.stop()}}async deleteDirectory(e){const t=this.providerService.getVirtualWorkspaceUri(e);if(t===void 0)return;const r=new Qe(`ChangeStore.deleteDirectory(${e.toString()})`,{log:!0});try{const n=[];if(await this.lock.synchronizeWrite(be(t),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(e,t);if((i==null?void 0:i.type)===2)return this.discardCore(t,e,n);const a=await this.providerService.getMetadata(e);await this.discardWorkingContent(t,e),await this.spliceOperation(e,o,{type:3,uri:e,fileType:s.FileType.Directory,revision:a.HEAD.sha,timestamp:Date.now(),size:void 0,hash:void 0,originalHash:void 0},n)},r.context),n.length===0)return;this._onDidChange.fire(n)}finally{r.stop()}}async updateDirectoryEntries(e,t){const r=this.providerService.getVirtualWorkspaceUri(e);if(r===void 0)return t;const n=new Qe(`ChangeStore.updateDirectoryEntries(${e.toString()})`,{log:!0},t.length);try{return await this.lock.synchronizeRead(be(r),async()=>{const i=qg(r,e),o=await this.getWorkingOperations(r);for(const a of o)switch(a.type){case 1:break;case 2:{if(ho(a.uri,i)){const c=this.providerService.getRelativeFilePath(e,a.uri);t.push([c,a.fileType])}break}case 3:{if(ho(a.uri,i)){const c=this.providerService.getRelativeFilePath(e,a.uri),w=t.findIndex(([p])=>p===c);w!==-1&&t.splice(w,1)}break}}return t},n.context)}finally{n.stop()}}async writeFile(e,t,r,n){const i=this.providerService.getVirtualWorkspaceUri(e);if(i===void 0)return;const o=new Qe(`ChangeStore.writeFile(${e.toString()})`,{log:!0},t.length,n);try{const a=[];if(await this.lock.synchronizeWrite(be(i),async()=>this.writeFileCore(i,e,a,t,r,n),o.context),a.length===0)return;this._onDidChange.fire(a)}finally{o.stop()}}async writeFileCore(e,t,r,n,i,o){const a=new Qe(`ChangeStore.writeFileCore(${t.toString()})`,{log:!0},n.length,o);try{const{operation:c,index:w}=await this.getWorkingOperation(t,e),p=await fo(n),S=await fo(i);if(Qe.log(a.context,{message:" Operations & Hashing"}),p===S&&(c==null?void 0:c.type)===1)return this.discardCore(e,t,r);if(p===(c==null?void 0:c.hash)&&S===(c==null?void 0:c.originalHash))return;const P=await this.providerService.getMetadata(t);await this.saveWorkingContent(e,t,n),await this.spliceOperation(t,w,c===void 0?{type:1,uri:t,fileType:s.FileType.File,revision:P.HEAD.sha,timestamp:Date.now(),size:n.byteLength,hash:p,originalHash:S,conflicts:o,staged:!1}:{...c,revision:P.HEAD.sha,timestamp:Date.now(),size:n.byteLength,hash:p,originalHash:S,conflicts:o,staged:!1},r)}finally{a.stop()}}async createFile(e,t){const r=this.providerService.getVirtualWorkspaceUri(e);if(r===void 0)return;const n=new Qe(`ChangeStore.createFile(${e.toString()})`,{log:!0},t.length);try{const i=[];if(await this.lock.synchronizeWrite(be(r),async()=>{const{operation:o,index:a}=await this.getWorkingOperation(e,r),c=await fo(t),w=await this.providerService.getMetadata(e);await this.saveWorkingContent(r,e,t),await this.spliceOperation(e,a,o===void 0?{type:2,uri:e,fileType:s.FileType.File,revision:w.HEAD.sha,timestamp:Date.now(),size:t.byteLength,hash:c,originalHash:c}:{...o,type:2,revision:w.HEAD.sha,timestamp:Date.now(),size:t.byteLength,hash:c},i)},n.context),i.length===0)return;this._onDidChange.fire(i)}finally{n.stop()}}async deleteFile(e){const t=this.providerService.getVirtualWorkspaceUri(e);if(t===void 0)return;const r=new Qe(`ChangeStore.deleteFile(${e.toString()})`,{log:!0});try{const n=[];if(await this.lock.synchronizeWrite(be(t),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(e,t);if((i==null?void 0:i.type)===2)return this.discardCore(t,e,n);const a=await this.providerService.getMetadata(e);await this.discardWorkingContent(t,e),await this.spliceOperation(e,o,{type:3,uri:e,fileType:s.FileType.File,revision:a.HEAD.sha,timestamp:Date.now(),size:void 0,hash:void 0,originalHash:void 0},n)},r.context),n.length===0)return;this._onDidChange.fire(n)}finally{r.stop()}}async getWorkingOperation(e,t){const r=await this.getWorkingOperations(t);if(r.length===0)return{operation:void 0,index:-1};const n=be(e);let i;const o=r.find((a,c)=>be(a.uri)!==n?!1:(i=c,!0));return o===void 0?{operation:void 0,index:-1}:{operation:o,index:i}}async getWorkingOperations(e){const t=be(e);let r=this.cache.get(t);return r===void 0&&(r=this.fromStorage(await this.storageService.get(this.getOperationsStorageKey(t))),this.cache.set(t,r)),r}async discardWorkingOperations(e){return he.debug(`ChangeStore.discardWorkingOperations(${e.toString()})`),this.saveWorkingOperations(e,[])}async saveWorkingOperations(e,t){he.debug(`ChangeStore.saveWorkingOperations(${e.toString()})`,t.length);const r=be(e);this.cache.set(r,t);try{await this.storageService.store(this.getOperationsStorageKey(r),this.toStorage(t))}catch(n){throw this.cache.delete(r),he.error(n,`Failed to save repository changes for ${r}`),n}}getOperationsStorageKey(e){return`operations/${e}`}async getWorkingContent(e,t){return this.fileStorageService.get(this.getFileStorageKey(e,t))}async discardWorkingContent(e,t){return he.debug(`ChangeStore.discardWorkingContent(${t.toString()})`),this.fileStorageService.delete(this.getFileStorageKey(e,t))}async saveWorkingContent(e,t,r){return he.debug(`ChangeStore.saveWorkingContent(${t.toString()})`,r.length),this.fileStorageService.store(this.getFileStorageKey(e,t),r)}getFileStorageKey(e,t){return`changestore/${jg(t)}`}async spliceOperation(e,t,r,n){const i=this.providerService.getVirtualWorkspaceUri(e);if(i===void 0)return;const o=await this.getWorkingOperations(i);t!==-1?o.splice(t,1,r):o.push(r),await this.saveWorkingOperations(i,o),n.push(So(r,i,e))}fromStorage(e){if(!e)return[];try{const t=JSON.parse(e,(r,n)=>(r==="uri"||r.endsWith("Uri"))&&n!==null?typeof n=="string"?s.Uri.parse(n):s.Uri.from(n):n);return Array.isArray(t)?t:t.operations}catch(t){throw he.error(t,"Failed to deserialize ChangeStore operations"),t}}toStorage(e){const t={schemaVersion:Nn.operationsStorageSchemaVersion,operations:e};return JSON.stringify(t)}};let bi=Nn;bi.operationsStorageSchemaVersion=1,bi.ScopedChangeStore=class{constructor(e,t,r){this.changeStore=e,this.scope=t,this.workspaceId=r}createPatch(e,t){return this.changeStore.createPatch(this.stripUriScope(e),this.stripUriScope(t))}getChange(e){return this.changeStore.getChange(this.stripUriScope(e))}getChanges(e,t){return this.changeStore.getChanges(this.stripUriScope(e),t)}async getGroupedChanges(e,t){return this.changeStore.getGroupedChanges(this.stripUriScope(e),t)}async stat(e){const r=this.changeStore.getUriScope(e)!==this.workspaceId,n=await this.changeStore.stat(this.stripUriScope(e));return n!==void 0&&r&&(n.permissions=s.FilePermission.Readonly),n}readFile(e){return this.changeStore.readFile(this.stripUriScope(e))}resolveDiffCommand(e,t,r,n){return this.changeStore.resolveDiffCommand(this.changeStore.getScopedUri(e,this.scope),this.changeStore.getScopedUri(t,this.scope),r,n)}stripUriScope(e){return e===void 0||!e.fragment?e:e.with({fragment:""})}},Cm([nr()],bi.prototype,"getWorkingOperations",1);function ku(e){switch(e){case 1:return Ht("change type changed","Modified");case 2:return Ht("change type created","Added");case 3:return Ht("change type deleted","Deleted")}}function xm(e){const[t,r]=e;switch(t){case 1:switch(r){case 1:case 2:return Ht("conflict status changed both","Modified by Both");case 3:return Ht("conflict status deleted them","Deleted by Incoming")}break;case 2:switch(r){case 1:case 2:return Ht("conflict status created both","Added by Both");case 3:return Ht("conflict status deleted them","Deleted by Incoming")}break;case 3:switch(r){case 1:case 2:return Ht("conflict status deleted us","Deleted by Current");case 3:return Ht("conflict status deleted both","Deleted by Both")}break}}var Tm=ze(4398);const rs=class{constructor(e){this.sharedProperties={},rs._instance=this,this.reporter=new Tm.Z(e.extension.id,e.extension.packageJSON.version,rs.aiKey,!0)}static get instance(){return this._instance}dispose(){this.reporter.dispose()}sendEvent(e,t,r){this.reporter.sendTelemetryEvent(e,{...this.sharedProperties,...t},r)}sendErrorEvent(e,t,r){this.reporter.sendTelemetryErrorEvent(e,{...this.sharedProperties,...t},r)}sendException(e,t,r){this.reporter.sendTelemetryException(e,{...this.sharedProperties,...t},r)}setSharedProperty(e,t){this.sharedProperties[e]=t}};let Fn=rs;Fn.aiKey="AIF-d9b70cd4-b9f9-4d70-929b-a071c400b217";const sn=(0,E.LV)();let $r;var ns;(function(e){function t(r){const n=Dm(r);return $r=s.env.uiKind===s.UIKind.Web,he.log(`Running on the ${$r?"web":"desktop"}${r.extensionRuntime!==s.ExtensionRuntime.Node?"in a webworker":""}; workspaceId: ${n}`),n}e.configure=t})(ns||(ns={}));function Rm(){var e,t;return(t=(e=s.workspace.workspaceFolders)==null?void 0:e.every(r=>r.uri.scheme===Je.scheme))!=null?t:!1}var rt;(function(e){e.CurrentWindow="currentWindow",e.NewWindow="newWindow",e.AddToWorkspace="addToWorkspace"})(rt||(rt={}));const km=/\/workspaceStorage\/(?<id>[^/]+)/i;function Dm(e){var t;if(e.storageUri===void 0)return"";const r=km.exec(e.storageUri.path);if((t=r==null?void 0:r.groups)==null?void 0:t.id)return r.groups.id;let n=e.storageUri.path;const i=Bg(e.globalStorageUri.path,n),o=`/${e.extension.id}`;return n.endsWith(o)?n=n.slice(i,-o.length):n=n.substr(i),n}async function Vt(e){var t,r,n;if(Fn.instance.sendEvent("openWorkspace",{location:e.location}),e.location===rt.AddToWorkspace){const o=(r=(t=s.workspace.workspaceFolders)==null?void 0:t.length)!=null?r:0;return void s.workspace.updateWorkspaceFolders(o,0,{uri:e.uri,name:e.name})}if(e.location===rt.CurrentWindow){const o=await bi.instance.getWorkspaceProvidersWithChanges();if(o.length){const a={title:sn("continue","Continue")},c={title:sn("cancel","Cancel"),isCloseAffordance:!0};if(await s.window.showWarningMessage($r?sn("open folder uncommitted changes web",`You have uncommitted changes.

If you want to see your changes on {0} or from other browsers or machines, commit them before leaving this workspace. Otherwise, you can re-open this workspace anytime and pick up right where you left off.

Do you want to continue opening a new workspace?`,o.map(p=>p.name).join(", ")):sn("open folder uncommitted changes",`You have uncommitted changes.

If you want to see your changes on {0} or from other machines, commit them before leaving this workspace. Otherwise, you can re-open this workspace anytime and pick up right where you left off.

Do you want to continue opening a new workspace?`,o.map(p=>p.name).join(", ")),{modal:!0},a,c)!==a){Fn.instance.sendEvent("openWorkspace.abort",{reason:"abandoned uncommitted changes prompt"});return}}}e.filesToOpen&&await((n=Lf())==null?void 0:n.setFilesToOpen(e.uri,e.filesToOpen));let i;if(s.env.remoteName)if(s.env.remoteName==="wsl")i=!0;else{const o=sn("open folder location local","Open from Local Machine"),a=sn("open folder location remote","Open from Remote Machine"),c=await s.window.showInformationMessage(sn("open folder location",`Do you want to open the remote repository from your local or remote machine?

Opening from the current remote connection will allow you to continue working on the remote repository from any other machine connected to this remote machine.`),{modal:!0},o,a);if(!c){Fn.instance.sendEvent("openWorkspace.abort",{reason:"abandoned local/remote prompt"});return}c===o&&(i=!0)}return Fn.instance.sendEvent("openWorkspace.success",{location:e.location,forceLocalWindow:String(i)}),void s.commands.executeCommand("vscode.openFolder",e.uri,{forceNewWindow:e.location===rt.NewWindow,forceLocalWindow:i})}var _i;(function(e){e.HasVirtualFolders="remoteHub:hasVirtualFolders",e.HasSearchIndexes="remoteHub:hasSearchIndexes",e.VirtualFolderProviders="remoteHub:virtualFolderProviders"})(_i||(_i={}));const Du=new Map;function Ln(e){return e==="isWeb"?$r:e==="remoteName"?s.env.remoteName:e==="virtualWorkspace"?Rm():e.startsWith("config.")?He.getAny(e.substr(7)):Du.get(e)}async function is(e,t){Du.set(e,t),await s.commands.executeCommand("setContext",e,t)}class Im{constructor(t){this.menuItem=t}get label(){return`${this.menuItem.icon?`${this.menuItem.icon} `:""}${this.menuItem.title}`}get detail(){return this.menuItem.extension.builtin?"Built-in":this.menuItem.extension.name||this.menuItem.extension.id}async execute(t){return void await s.commands.executeCommand(this.menuItem.command,t)}}var os;(function(e){async function t(r,n,i){const o=Am(r).map(w=>new Im(w)),a=s.window.createQuickPick(),c=[];try{return await new Promise(p=>{c.push(a.onDidHide(()=>p(void 0)),a.onDidAccept(()=>{if(a.activeItems.length!==0){const[S]=a.activeItems;p(S)}})),a.title=i,a.placeholder=n,a.items=o,a.show()})}finally{a.dispose(),c.forEach(w=>void w.dispose())}}e.show=t})(os||(os={}));function Am(e){var t,r,n,i,o;const a=new Map,[,c]=e.split(".");for(const p of s.extensions.all){const{name:S,displayName:P,contributes:k}=p.packageJSON;if(!k)continue;const I=(r=(t=k.virtualWorkspaces)==null?void 0:t.menus)==null?void 0:r.continueOn;if(I==null?void 0:I.length){const $=new Map(((n=k.commands)!=null?n:[]).map(B=>[B.command,B]));for(const B of I){if(!B.command)continue;if(a.has(B.command)){he.warn(`Duplicate 'continueOn' menu command: ${B.command}`);continue}const q=$.get(B.command);if(!q){he.warn(`Unable to find 'continueOn' menu command: ${B.command}`);continue}if(!Pm(B.when))continue;const Z=(o=(i=B.group)==null?void 0:i.lastIndexOf("@"))!=null?o:-1;a.set(B.command,{extension:{id:S,name:P,builtin:S===c},command:q.command,title:q.title,icon:typeof q.icon=="string"?q.icon:void 0,group:Z>0?B.group.substr(0,Z):B.group,order:Z>0?Number(B.group.substr(Z+1)):0,category:q.category})}}}function w(p,S){const P=p.group,k=S.group;if(P!==k){if(!P)return 1;if(!k||P==="navigation")return-1;if(k==="navigation")return 1;const I=P.localeCompare(k);if(I!==0)return I}return p.order<S.order?-1:p.order>S.order?1:p.title.localeCompare(S.title)}return[...a.values()].sort(w)}function Pm(e){if(!e)return!0;function t(r){return r==="isWeb"||r==="remoteName"||r==="virtualWorkspace"||r.startsWith("remoteHub:")||r.startsWith("config.")}return e.split("&&").every(r=>{const n=/^(?:(!)?(\S+)|(\S+)\s?(==|!=|=~)\s?(\S+))$/.exec(r.trim());if(!n)return!0;const[,i,o,a,c,w]=n;if(o){if(o==="false")return!1;if(!t(o))return!0;const p=Ln(o);return i?!p:p}if(a&&c&&w)switch(c){case"==":return!t(a)||!t(w)||Ln(a)==Ln(w);case"!=":return!t(a)||!t(w)||Ln(a)!=Ln(w);case"=~":{if(!t(a))return!0;const p=Ln(a);try{return new RegExp(w.slice(1,-1)).test(String(p!=null?p:""))}catch{return!1}}}return!0})}class as{constructor(t){this.defaultDelay=t}dispose(){this.cancelTimeout()}debounce(t,r=this.defaultDelay){return this.task=t,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((n,i)=>{this.resolver=n,this.rejecter=i}).then(()=>{if(this.completionPromise=void 0,this.resolver=void 0,this.task){const n=this.task;return this.task=void 0,n()}})),this.timeout=setTimeout(()=>{var n;this.timeout=void 0,(n=this.resolver)==null||n.call(this,void 0)},r),this.completionPromise}cancel(){var t;this.cancelTimeout(),this.completionPromise&&((t=this.rejecter)==null||t.call(this,new Error("Canceled")),this.completionPromise=void 0)}cancelTimeout(){this.timeout!==void 0&&(clearTimeout(this.timeout),this.timeout=void 0)}}const ss=Symbol("QuickPickGoBack");var cs;(function(e){async function t(r,n,i,o,a,c){const w=r.getRemoteWorkspaceSourceProviders();let p=[];w.length===0?p=[]:p=w.map(B=>new Iu(B));const S=await n.getRemoteWorkspaceSourceProvider();if(S){const B=await S.provideSources();p.push(...B.map(q=>({label:`${q.icon?`${q.icon} `:""}${q.name}`,description:q.description,detail:q.detail,url:q.url,workspace:q.url?void 0:q.workspace})))}let P=await s.env.clipboard.readText();r.findRemoteUrlHandler(P)||(P="");const k=s.window.createQuickPick(),I=[];let $=i;try{for(;;){const B=await new Promise(q=>{I.push(k.onDidHide(()=>q(void 0)),k.onDidChangeValue(Z=>{Z=Z.trim(),Z.length===0?(k.ignoreFocusOut=!1,k.items=p):(k.ignoreFocusOut=!0,k.activeItems.length===0||k.activeItems[0]instanceof Ci?k.items=[new Ci(r,Z),...p]:k.items=p)}),k.onDidAccept(()=>{if(k.activeItems.length!==0){const[Z]=k.activeItems;(!(Z instanceof Ci)||Z.validate())&&q(Z)}}),k.onDidChangeActive(()=>{if($!==void 0||!(c==null?void 0:c.allowAddToWorkspace))return;const[Z]=k.activeItems;let K=!0;if(Z===void 0?K=Boolean(k.value):K=Z instanceof Ci,K){if(k.buttons.length===1)return;k.buttons=[$n.AddToWorkspace]}else{if(k.buttons.length===0)return;k.buttons=[]}}),k.onDidTriggerButton(Z=>{if(Z===$n.AddToWorkspace){const[K]=k.activeItems;if(!(K instanceof Ci))return;K.validate()&&($=rt.AddToWorkspace,q(K))}})),k.title=a,k.placeholder=o,k.matchOnDescription=!0,k.items=p,k.sortByLabel=!1,k.value=P,k.show(),P&&k._onDidChangeValueEmitter.fire(k.value)});if(B instanceof Iu){const q=await B.show($,B.placeholder,a,c);if(q===ss)continue;return q}return[B,$]}}finally{k.dispose(),I.forEach(B=>void B.dispose())}}e.show=t})(cs||(cs={}));class Iu{constructor(t){this.provider=t}get label(){return`${this.provider.icon?`${this.provider.icon} `:""}${this.provider.label}`}get placeholder(){return this.provider.placeholder}async show(t,r,n,i){const o=s.window.createQuickPick(),a=new as(500),c=[a];async function w($,B,q){return(await $.provideSources(B,q)).map(K=>({label:`${K.icon?`${K.icon} `:""}${K.name}`,description:K.description,detail:K.detail,url:K.url,workspace:K.workspace}))}const p=w(this.provider,void 0,{sort:"updated"});let S=t,P,k=!1;async function I($){P=void 0;const B=o.activeItems;o.items=$!=null?$:await p,k&&B.length!==0&&(o.activeItems=o.items.filter(q=>B.some(Z=>Z.url===q.url))),o.busy=!1}try{const $=await new Promise(B=>{c.push(o.onDidHide(()=>B(void 0)),o.onDidChangeValue(q=>{k=!1,q=q.trim(),o.busy=!0;let Z=q,K;const re=q.indexOf("/");re!==-1&&(K=q.substring(0,re),Z=q.substr(re+1));const ee=a.debounce(q?()=>w(this.provider,Z,{user:K,sort:"stars"}):()=>p);P===void 0&&(P=ee.then(async se=>I(se)))}),o.onDidAccept(()=>{if(o.activeItems.length!==0){const[q]=o.activeItems;B(q)}}),o.onDidChangeActive(()=>{if(k=o.activeItems.length!==0,S!==void 0||!(i==null?void 0:i.allowAddToWorkspace))return;const[q]=o.activeItems;if(q===void 0){if(o.buttons.length===1)return;o.buttons=[s.QuickInputButtons.Back]}else{if(o.buttons.length===2)return;o.buttons=[s.QuickInputButtons.Back,$n.AddToWorkspace]}}),o.onDidTriggerButton(q=>{if(q===s.QuickInputButtons.Back){B(ss);return}if(q===$n.AddToWorkspace){const[Z]=o.activeItems;if(Z===void 0)return;S=rt.AddToWorkspace,B(Z)}})),o.title=n,o.placeholder=r,o.matchOnDetail=!0,o.ignoreFocusOut=!0,o.sortByLabel=!1,o.buttons=[s.QuickInputButtons.Back],o.busy=!0,o.show(),P=a.debounce(async()=>p,0).then(q=>I(q))});return $===ss?$:[$,S]}finally{o.dispose(),c.forEach($=>void $.dispose())}}}class Ci{constructor(t,r){this.url=r,this.alwaysShow=!0,this.handler=t.findRemoteUrlHandler(r)}get label(){if(this.handler)switch(this.handler.urlType){case lt.Branch:return`Open Branch from ${this.handler.provider.name} Repository`;case lt.Commit:return`Open Commit from ${this.handler.provider.name} Repository`;case lt.File:return`Open File from ${this.handler.provider.name} Repository`;case lt.PullRequest:return`Open Pull Request from ${this.handler.provider.name} Repository`;default:return`Open ${this.handler.provider.name} Repository`}return"Enter a Remote Url"}get description(){return this.url}validate(){return this.handler!==void 0}}var $n;(function(e){e.AddToWorkspace={iconPath:new s.ThemeIcon("plus"),tooltip:"Add to Workspace"}})($n||($n={}));const gt=(0,E.LV)();function Om(e,t,r,n,i){async function o(c){const[w,p]=await cs.show(e,r,c,gt("open repo placeholder","Enter a remote url, or select a remote provider"),c===rt.AddToWorkspace?gt("open repo title add to workspace","Add Remote Repository to Workspace"):gt("open repo title current window","Open Remote Repository"),{allowAddToWorkspace:!1});if(!w){i.sendEvent("openRepository.abort",{reason:"abandoned"});return}try{let S;if(w.workspace)S=w.workspace;else if(S=await e.createWorkspaceForRemoteUrl(w.url,void 0,p!=null?p:c),!S){i.sendEvent("openRepository.abort",{reason:"aborted invalid url"});return}await Vt(S)}catch(S){if(i.sendException(S),S instanceof Pn){xc(S.name);return}he.error(S)}}async function a(c,w,p){if(p==null?void 0:p.workspaceFolder){const P=e.getRepository(p.workspaceFolder,w);if(P!==void 0)return P}const S=w?e.repositories.filter(P=>P.provider.id===w):e.repositories;if(S.length!==0){if(S.length>1){const P=await s.window.showQuickPick(S.map(k=>({label:k.name,description:k.provider.name,repository:k})),{placeHolder:c});return P?P.repository:void 0}return S[0]}}return[s.commands.registerCommand("remoteHub.openRepository",()=>(i.sendEvent("command.openRepository"),o())),s.commands.registerCommand("remoteHub.continueOn.openRepository",()=>(i.sendEvent("command.continueOn.openRepository"),o())),s.commands.registerCommand("remoteHub.addRepositoryToWorkspace",()=>{i.sendEvent("command.continueOn.openRepository")}),s.commands.registerCommand("remoteHub.continueOn.addRepositoryToWorkspace",()=>{i.sendEvent("command.continueOn.openRepository")}),s.commands.registerCommand("remoteHub.continueOn",async()=>{const c=await a(gt("continue on choose repository placeholder","Choose which repository to continue working on elsewhere"));if(c===void 0)return;i.sendEvent("command.continueOn");const w=await os.show(n,gt("continue on placeholder","Choose how you would like to continue working"),gt("continue on title","Continue '{0}' on",c.name));if(!w){i.sendEvent("command.continueOn.abort",{reason:"abandoned"});return}if(await t.hasChanges(c.uri)){const P={title:gt("continue","Continue")},k={title:gt("cancel","Cancel"),isCloseAffordance:!0};if(await s.window.showWarningMessage(gt("continue on uncommitted changes",`You have uncommitted changes.

Unless you commit those changes, you won't be able see them from elsewhere.`),{modal:!0},P,k)!==P){i.sendEvent("command.continueOn.abort",{reason:"abandoned uncommitted changes prompt"});return}}const p=e.getExternalUri(c.provider.id,{repo:c.id}),{HEAD:S}=await c.getMetadata();await w.execute({provider:c.provider,workspaceFolder:c.uri,name:c.name,url:p==null?void 0:p.toString(!0),ref:S.name})}),s.commands.registerCommand("remoteHub.openOnDesktop",async c=>{if(!$r)return;const w=await a(gt("continue on desktop choose repository placeholder","Choose which repository to open on the desktop"),void 0,c);if(w===void 0)return;const p=await e.getBestExternalUri(w.uri);p!==void 0&&(i.sendEvent("command.openOnDesktop"),s.env.openExternal(s.Uri.parse(`${s.env.uriScheme}://${n}/open?url=${encodeURIComponent(p.toString(!0))}`)))}),s.commands.registerCommand("remoteHub.openOnWeb",async c=>{if($r)return;const w=await a(gt("continue on web choose repository placeholder","Choose which repository to open on the web"),void 0,c);if(w===void 0)return;const p=await e.getBestExternalUri(w.uri);p!==void 0&&(i.sendEvent("command.openOnWeb"),s.env.openExternal(p.with({authority:"vscode.dev",path:`${p.authority}${p.path}`})))}),s.commands.registerCommand("remoteHub.openOnRemote",async c=>{i.sendEvent("command.openOnRemote");const{provider:w,...p}=c,S=e.getExternalUri(w.id,p);if(S){await s.env.openExternal(S);return}s.window.showErrorMessage(gt("open on remote command provider not supported","Unable to open the resource on {0}",c.provider.name))}),s.commands.registerCommand("remoteHub.clone",async c=>{const w=await a(gt("clone placeholder","Choose which repository to clone"),void 0,c);if(w!==void 0){if(i.sendEvent("command.clone"),c===void 0&&await t.hasChanges(w.uri)){const p={title:gt("continue","Continue")},S={title:gt("cancel","Cancel"),isCloseAffordance:!0};if(await s.window.showWarningMessage(gt("clone uncommitted changes",`You have uncommitted changes.

Unless you commit those changes, you won't be able see them in your local clone.`),{modal:!0},p,S)!==p){i.sendEvent("command.clone.abort",{reason:"abandoned uncommitted changes prompt"});return}}await e.clone(w.uri)}}),s.commands.registerCommand("remoteHub.openInCodespaces",async c=>{const w=await a(gt("codespaces placeholder","Choose which repository to open on codespaces"),"github",c);if(w===void 0)return;i.sendEvent("command.openInCodespaces");const p=await w.getMetadata();s.env.openExternal(s.Uri.parse(`https://github.com/codespaces?repository=${p.repo.owner}/${p.repo.name}`))}),s.commands.registerCommand("remoteHub.refresh",()=>void e.refresh()),s.commands.registerCommand("remoteHub.enableDebugLogging",()=>He.updateEffective("logLevel",Ke.Debug)),s.commands.registerCommand("remoteHub.disableDebugLogging",()=>He.updateEffective("logLevel",Ke.Warn))]}function Cr(e){return e}async function us(e,t){return s.commands.executeCommand(e,t)}class Nm{constructor(){this._timeout=0,this._disposable=He.onDidChange(this.onConfigurationChanged,this),this.maybeQueueFetch()}dispose(){this._disposable.dispose(),this._timeout&&clearTimeout(this._timeout)}get config(){var t;if(this._config===void 0){const r=He.get("autoFetch");this._config={enabled:(t=r.enabled)!=null?t:!0,interval:r.interval*1e3}}return this._config}onConfigurationChanged(t){!He.changed(t,"autoFetch")||(this._config=void 0,this.maybeQueueFetch())}async fetchAll(){try{await us("remoteHub.fetchAll",{automated:!0})}catch(t){he.error(t,"Autofetch failed")}this.maybeQueueFetch()}maybeQueueFetch(){this._timeout&&(clearTimeout(this._timeout),this._timeout=0),!!this.config.enabled&&(this._timeout=setTimeout(()=>this.fetchAll(),this.config.interval))}}var Mn=ze(7360);function Fm(e){return e.replace(/[-\\{}*+?|^$.[\]()#]/g,"\\$&")}function Lm(e,t,r={}){if(!e)throw new Error("Cannot create regex from empty string");t||(e=Fm(e)),r.wholeWord&&(/\B/.test(e.charAt(0))||(e=`\\b${e}`),/\B/.test(e.charAt(e.length-1))||(e=`${e}\\b`));let n="";return r.global&&(n+="g"),r.matchCase||(n+="i"),r.multiline&&(n+="m"),r.unicode&&(n+="u"),new RegExp(e,n)}var Au=ze(1171);let Pu,Ou,ls;const $m=(e,t,r,n)=>{const i=`${t.join("--")};;;;${r.join("--")}`,o=e.map(w=>w.path).join("::");if(Pu===o&&i==Ou&&ls)return ls;const a=new Set,c=w=>(t.length===0||t.some(p=>Au(w,p,{dot:!0})))&&!r.some(p=>Au(w,p,{dot:!0}));for(const w of e)c(w.path)&&(!n||w.size<n)&&a.add(w.path);return Pu=o,Ou=i,ls=a,a},Mm=(e,t,r,n)=>{var i;const o=[];let a;if(typeof e=="string")a=e;else{const S=e;if(S[0]==255&&S[1]==254)a=new TextDecoder("utf-16le").decode(S);else if(S[0]==254&&S[1]==255)a=new TextDecoder("utf-16be").decode(S);else if(a=new TextDecoder("utf8").decode(S),a.slice(0,1e3).includes("\uFFFD")&&S.includes(0))return[]}const c=[];let w=null,p=n.remainingResultQuota;for(;p>=0&&(w=r.exec(a));)c.push({matchStartIndex:w.index,matchedText:w[0]}),p--;if(c.length){const S=new Set,P=new Set,k=[],I=K=>a.slice(k[K].start,k[K].end);let $=0,B=null;const q=/\r?\n/g;for(;B=q.exec(a);)k.push({start:$,end:B.index}),$=B.index+B[0].length;$<a.length&&k.push({start:$,end:a.length});let Z=0;for(const{matchStartIndex:K,matchedText:re}of c){if(p<0)break;for(;Boolean(k[Z+1])&&K>k[Z].end;)Z++;let ee=Z;for(;Boolean(k[ee+1])&&K+re.length>k[ee].end;)ee++;if(n.beforeContext)for(let Re=Math.max(0,Z-n.beforeContext);Re<Z;Re++)S.add(Re);let se="",Se=0;for(let Re=Z;Re<=ee;Re++){let Pe=I(Re);((i=n.previewOptions)==null?void 0:i.charsPerLine)&&Pe.length>n.previewOptions.charsPerLine&&(Se=Math.max(K-k[Z].start-20,0),Pe=Pe.substr(Se,n.previewOptions.charsPerLine)),se+=`${Pe}
`,P.add(Re)}const me=new s.Range(Z,K-k[Z].start,ee,K+re.length-k[ee].start),Te=new s.Range(0,K-k[Z].start-Se,ee-Z,K+re.length-k[ee].start-(ee===Z?Se:0)),Oe={uri:s.Uri.file(t),ranges:me,preview:{text:se,matches:Te}};if(o.push(Oe),n.afterContext)for(let Re=ee+1;Re<=Math.min(ee+n.afterContext,k.length-1);Re++)S.add(Re)}for(const K of S)P.has(K)||o.push({uri:s.Uri.file(t),text:I(K),lineNumber:K+1})}return o};var Um=ze(5790);/*! pako 2.0.3 https://github.com/nodeca/pako @license (MIT AND Zlib) */const Hm=4,Nu=0,Fu=1,Bm=2;function Un(e){let t=e.length;for(;--t>=0;)e[t]=0}const jm=0,Lu=1,zm=2,qm=3,Wm=258,ds=29,Si=256,Ei=Si+1+ds,Hn=30,fs=19,$u=2*Ei+1,cn=15,hs=16,Vm=7,ps=256,Mu=16,Uu=17,Hu=18,gs=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Eo=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Gm=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Bu=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Km=512,Sr=new Array((Ei+2)*2);Un(Sr);const xi=new Array(Hn*2);Un(xi);const Ti=new Array(Km);Un(Ti);const Ri=new Array(Wm-qm+1);Un(Ri);const ms=new Array(ds);Un(ms);const xo=new Array(Hn);Un(xo);function vs(e,t,r,n,i){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=e&&e.length}let ju,zu,qu;function ys(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}const Wu=e=>e<256?Ti[e]:Ti[256+(e>>>7)],ki=(e,t)=>{e.pending_buf[e.pending++]=t&255,e.pending_buf[e.pending++]=t>>>8&255},It=(e,t,r)=>{e.bi_valid>hs-r?(e.bi_buf|=t<<e.bi_valid&65535,ki(e,e.bi_buf),e.bi_buf=t>>hs-e.bi_valid,e.bi_valid+=r-hs):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)},ar=(e,t,r)=>{It(e,r[t*2],r[t*2+1])},Vu=(e,t)=>{let r=0;do r|=e&1,e>>>=1,r<<=1;while(--t>0);return r>>>1},Qm=e=>{e.bi_valid===16?(ki(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)},Zm=(e,t)=>{const r=t.dyn_tree,n=t.max_code,i=t.stat_desc.static_tree,o=t.stat_desc.has_stree,a=t.stat_desc.extra_bits,c=t.stat_desc.extra_base,w=t.stat_desc.max_length;let p,S,P,k,I,$,B=0;for(k=0;k<=cn;k++)e.bl_count[k]=0;for(r[e.heap[e.heap_max]*2+1]=0,p=e.heap_max+1;p<$u;p++)S=e.heap[p],k=r[r[S*2+1]*2+1]+1,k>w&&(k=w,B++),r[S*2+1]=k,!(S>n)&&(e.bl_count[k]++,I=0,S>=c&&(I=a[S-c]),$=r[S*2],e.opt_len+=$*(k+I),o&&(e.static_len+=$*(i[S*2+1]+I)));if(B!==0){do{for(k=w-1;e.bl_count[k]===0;)k--;e.bl_count[k]--,e.bl_count[k+1]+=2,e.bl_count[w]--,B-=2}while(B>0);for(k=w;k!==0;k--)for(S=e.bl_count[k];S!==0;)P=e.heap[--p],!(P>n)&&(r[P*2+1]!==k&&(e.opt_len+=(k-r[P*2+1])*r[P*2],r[P*2+1]=k),S--)}},Gu=(e,t,r)=>{const n=new Array(cn+1);let i=0,o,a;for(o=1;o<=cn;o++)n[o]=i=i+r[o-1]<<1;for(a=0;a<=t;a++){let c=e[a*2+1];c!==0&&(e[a*2]=Vu(n[c]++,c))}},Xm=()=>{let e,t,r,n,i;const o=new Array(cn+1);for(r=0,n=0;n<ds-1;n++)for(ms[n]=r,e=0;e<1<<gs[n];e++)Ri[r++]=n;for(Ri[r-1]=n,i=0,n=0;n<16;n++)for(xo[n]=i,e=0;e<1<<Eo[n];e++)Ti[i++]=n;for(i>>=7;n<Hn;n++)for(xo[n]=i<<7,e=0;e<1<<Eo[n]-7;e++)Ti[256+i++]=n;for(t=0;t<=cn;t++)o[t]=0;for(e=0;e<=143;)Sr[e*2+1]=8,e++,o[8]++;for(;e<=255;)Sr[e*2+1]=9,e++,o[9]++;for(;e<=279;)Sr[e*2+1]=7,e++,o[7]++;for(;e<=287;)Sr[e*2+1]=8,e++,o[8]++;for(Gu(Sr,Ei+1,o),e=0;e<Hn;e++)xi[e*2+1]=5,xi[e*2]=Vu(e,5);ju=new vs(Sr,gs,Si+1,Ei,cn),zu=new vs(xi,Eo,0,Hn,cn),qu=new vs(new Array(0),Gm,0,fs,Vm)},Ku=e=>{let t;for(t=0;t<Ei;t++)e.dyn_ltree[t*2]=0;for(t=0;t<Hn;t++)e.dyn_dtree[t*2]=0;for(t=0;t<fs;t++)e.bl_tree[t*2]=0;e.dyn_ltree[ps*2]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0},Qu=e=>{e.bi_valid>8?ki(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},Ym=(e,t,r,n)=>{Qu(e),n&&(ki(e,r),ki(e,~r)),e.pending_buf.set(e.window.subarray(t,t+r),e.pending),e.pending+=r},Zu=(e,t,r,n)=>{const i=t*2,o=r*2;return e[i]<e[o]||e[i]===e[o]&&n[t]<=n[r]},ws=(e,t,r)=>{const n=e.heap[r];let i=r<<1;for(;i<=e.heap_len&&(i<e.heap_len&&Zu(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!Zu(t,n,e.heap[i],e.depth));)e.heap[r]=e.heap[i],r=i,i<<=1;e.heap[r]=n},Xu=(e,t,r)=>{let n,i,o=0,a,c;if(e.last_lit!==0)do n=e.pending_buf[e.d_buf+o*2]<<8|e.pending_buf[e.d_buf+o*2+1],i=e.pending_buf[e.l_buf+o],o++,n===0?ar(e,i,t):(a=Ri[i],ar(e,a+Si+1,t),c=gs[a],c!==0&&(i-=ms[a],It(e,i,c)),n--,a=Wu(n),ar(e,a,r),c=Eo[a],c!==0&&(n-=xo[a],It(e,n,c)));while(o<e.last_lit);ar(e,ps,t)},bs=(e,t)=>{const r=t.dyn_tree,n=t.stat_desc.static_tree,i=t.stat_desc.has_stree,o=t.stat_desc.elems;let a,c,w=-1,p;for(e.heap_len=0,e.heap_max=$u,a=0;a<o;a++)r[a*2]!==0?(e.heap[++e.heap_len]=w=a,e.depth[a]=0):r[a*2+1]=0;for(;e.heap_len<2;)p=e.heap[++e.heap_len]=w<2?++w:0,r[p*2]=1,e.depth[p]=0,e.opt_len--,i&&(e.static_len-=n[p*2+1]);for(t.max_code=w,a=e.heap_len>>1;a>=1;a--)ws(e,r,a);p=o;do a=e.heap[1],e.heap[1]=e.heap[e.heap_len--],ws(e,r,1),c=e.heap[1],e.heap[--e.heap_max]=a,e.heap[--e.heap_max]=c,r[p*2]=r[a*2]+r[c*2],e.depth[p]=(e.depth[a]>=e.depth[c]?e.depth[a]:e.depth[c])+1,r[a*2+1]=r[c*2+1]=p,e.heap[1]=p++,ws(e,r,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],Zm(e,t),Gu(r,w,e.bl_count)},Yu=(e,t,r)=>{let n,i=-1,o,a=t[0*2+1],c=0,w=7,p=4;for(a===0&&(w=138,p=3),t[(r+1)*2+1]=65535,n=0;n<=r;n++)o=a,a=t[(n+1)*2+1],!(++c<w&&o===a)&&(c<p?e.bl_tree[o*2]+=c:o!==0?(o!==i&&e.bl_tree[o*2]++,e.bl_tree[Mu*2]++):c<=10?e.bl_tree[Uu*2]++:e.bl_tree[Hu*2]++,c=0,i=o,a===0?(w=138,p=3):o===a?(w=6,p=3):(w=7,p=4))},Ju=(e,t,r)=>{let n,i=-1,o,a=t[0*2+1],c=0,w=7,p=4;for(a===0&&(w=138,p=3),n=0;n<=r;n++)if(o=a,a=t[(n+1)*2+1],!(++c<w&&o===a)){if(c<p)do ar(e,o,e.bl_tree);while(--c!=0);else o!==0?(o!==i&&(ar(e,o,e.bl_tree),c--),ar(e,Mu,e.bl_tree),It(e,c-3,2)):c<=10?(ar(e,Uu,e.bl_tree),It(e,c-3,3)):(ar(e,Hu,e.bl_tree),It(e,c-11,7));c=0,i=o,a===0?(w=138,p=3):o===a?(w=6,p=3):(w=7,p=4)}},Jm=e=>{let t;for(Yu(e,e.dyn_ltree,e.l_desc.max_code),Yu(e,e.dyn_dtree,e.d_desc.max_code),bs(e,e.bl_desc),t=fs-1;t>=3&&e.bl_tree[Bu[t]*2+1]===0;t--);return e.opt_len+=3*(t+1)+5+5+4,t},ev=(e,t,r,n)=>{let i;for(It(e,t-257,5),It(e,r-1,5),It(e,n-4,4),i=0;i<n;i++)It(e,e.bl_tree[Bu[i]*2+1],3);Ju(e,e.dyn_ltree,t-1),Ju(e,e.dyn_dtree,r-1)},tv=e=>{let t=4093624447,r;for(r=0;r<=31;r++,t>>>=1)if(t&1&&e.dyn_ltree[r*2]!==0)return Nu;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return Fu;for(r=32;r<Si;r++)if(e.dyn_ltree[r*2]!==0)return Fu;return Nu};let el=!1;const rv=e=>{el||(Xm(),el=!0),e.l_desc=new ys(e.dyn_ltree,ju),e.d_desc=new ys(e.dyn_dtree,zu),e.bl_desc=new ys(e.bl_tree,qu),e.bi_buf=0,e.bi_valid=0,Ku(e)},tl=(e,t,r,n)=>{It(e,(jm<<1)+(n?1:0),3),Ym(e,t,r,!0)},nv=e=>{It(e,Lu<<1,3),ar(e,ps,Sr),Qm(e)},iv=(e,t,r,n)=>{let i,o,a=0;e.level>0?(e.strm.data_type===Bm&&(e.strm.data_type=tv(e)),bs(e,e.l_desc),bs(e,e.d_desc),a=Jm(e),i=e.opt_len+3+7>>>3,o=e.static_len+3+7>>>3,o<=i&&(i=o)):i=o=r+5,r+4<=i&&t!==-1?tl(e,t,r,n):e.strategy===Hm||o===i?(It(e,(Lu<<1)+(n?1:0),3),Xu(e,Sr,xi)):(It(e,(zm<<1)+(n?1:0),3),ev(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),Xu(e,e.dyn_ltree,e.dyn_dtree)),Ku(e),n&&Qu(e)},ov=(e,t,r)=>(e.pending_buf[e.d_buf+e.last_lit*2]=t>>>8&255,e.pending_buf[e.d_buf+e.last_lit*2+1]=t&255,e.pending_buf[e.l_buf+e.last_lit]=r&255,e.last_lit++,t===0?e.dyn_ltree[r*2]++:(e.matches++,t--,e.dyn_ltree[(Ri[r]+Si+1)*2]++,e.dyn_dtree[Wu(t)*2]++),e.last_lit===e.lit_bufsize-1);var av=rv,sv=tl,cv=iv,uv=ov,lv=nv,dv={_tr_init:av,_tr_stored_block:sv,_tr_flush_block:cv,_tr_tally:uv,_tr_align:lv},Di=(e,t,r,n)=>{let i=e&65535|0,o=e>>>16&65535|0,a=0;for(;r!==0;){a=r>2e3?2e3:r,r-=a;do i=i+t[n++]|0,o=o+i|0;while(--a);i%=65521,o%=65521}return i|o<<16|0};const fv=()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=e&1?3988292384^e>>>1:e>>>1;t[r]=e}return t},hv=new Uint32Array(fv());var ht=(e,t,r,n)=>{const i=hv,o=n+r;e^=-1;for(let a=n;a<o;a++)e=e>>>8^i[(e^t[a])&255];return e^-1},un={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},ln={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:pv,_tr_stored_block:gv,_tr_flush_block:mv,_tr_tally:Mr,_tr_align:vv}=dv,{Z_NO_FLUSH:dn,Z_PARTIAL_FLUSH:yv,Z_FULL_FLUSH:wv,Z_FINISH:Ur,Z_BLOCK:rl,Z_OK:sr,Z_STREAM_END:nl,Z_STREAM_ERROR:Bt,Z_DATA_ERROR:bv,Z_BUF_ERROR:_s,Z_DEFAULT_COMPRESSION:_v,Z_FILTERED:Cv,Z_HUFFMAN_ONLY:To,Z_RLE:Sv,Z_FIXED:Ev,Z_DEFAULT_STRATEGY:xv,Z_UNKNOWN:Tv,Z_DEFLATED:Ro}=ln,Rv=9,kv=15,Dv=8,Iv=29,Cs=256+1+Iv,Av=30,Pv=19,Ov=2*Cs+1,Nv=15,Ge=3,Hr=258,Gt=Hr+Ge+1,Fv=32,ko=42,Ss=69,Do=73,Io=91,Ao=103,fn=113,Ii=666,dt=1,Ai=2,hn=3,Bn=4,Lv=3,Br=(e,t)=>(e.msg=un[t],t),il=e=>(e<<1)-(e>4?9:0),jr=e=>{let t=e.length;for(;--t>=0;)e[t]=0};let zr=(e,t,r)=>(t<<e.hash_shift^r)&e.hash_mask;const qr=e=>{const t=e.state;let r=t.pending;r>e.avail_out&&(r=e.avail_out),r!==0&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+r),e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,t.pending===0&&(t.pending_out=0))},mt=(e,t)=>{mv(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,qr(e.strm)},Ze=(e,t)=>{e.pending_buf[e.pending++]=t},Pi=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=t&255},$v=(e,t,r,n)=>{let i=e.avail_in;return i>n&&(i=n),i===0?0:(e.avail_in-=i,t.set(e.input.subarray(e.next_in,e.next_in+i),r),e.state.wrap===1?e.adler=Di(e.adler,t,i,r):e.state.wrap===2&&(e.adler=ht(e.adler,t,i,r)),e.next_in+=i,e.total_in+=i,i)},ol=(e,t)=>{let r=e.max_chain_length,n=e.strstart,i,o,a=e.prev_length,c=e.nice_match;const w=e.strstart>e.w_size-Gt?e.strstart-(e.w_size-Gt):0,p=e.window,S=e.w_mask,P=e.prev,k=e.strstart+Hr;let I=p[n+a-1],$=p[n+a];e.prev_length>=e.good_match&&(r>>=2),c>e.lookahead&&(c=e.lookahead);do if(i=t,!(p[i+a]!==$||p[i+a-1]!==I||p[i]!==p[n]||p[++i]!==p[n+1])){n+=2,i++;do;while(p[++n]===p[++i]&&p[++n]===p[++i]&&p[++n]===p[++i]&&p[++n]===p[++i]&&p[++n]===p[++i]&&p[++n]===p[++i]&&p[++n]===p[++i]&&p[++n]===p[++i]&&n<k);if(o=Hr-(k-n),n=k-Hr,o>a){if(e.match_start=t,a=o,o>=c)break;I=p[n+a-1],$=p[n+a]}}while((t=P[t&S])>w&&--r!=0);return a<=e.lookahead?a:e.lookahead},pn=e=>{const t=e.w_size;let r,n,i,o,a;do{if(o=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-Gt)){e.window.set(e.window.subarray(t,t+t),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,n=e.hash_size,r=n;do i=e.head[--r],e.head[r]=i>=t?i-t:0;while(--n);n=t,r=n;do i=e.prev[--r],e.prev[r]=i>=t?i-t:0;while(--n);o+=t}if(e.strm.avail_in===0)break;if(n=$v(e.strm,e.window,e.strstart+e.lookahead,o),e.lookahead+=n,e.lookahead+e.insert>=Ge)for(a=e.strstart-e.insert,e.ins_h=e.window[a],e.ins_h=zr(e,e.ins_h,e.window[a+1]);e.insert&&(e.ins_h=zr(e,e.ins_h,e.window[a+Ge-1]),e.prev[a&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=a,a++,e.insert--,!(e.lookahead+e.insert<Ge)););}while(e.lookahead<Gt&&e.strm.avail_in!==0)},Mv=(e,t)=>{let r=65535;for(r>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if(pn(e),e.lookahead===0&&t===dn)return dt;if(e.lookahead===0)break}e.strstart+=e.lookahead,e.lookahead=0;const n=e.block_start+r;if((e.strstart===0||e.strstart>=n)&&(e.lookahead=e.strstart-n,e.strstart=n,mt(e,!1),e.strm.avail_out===0)||e.strstart-e.block_start>=e.w_size-Gt&&(mt(e,!1),e.strm.avail_out===0))return dt}return e.insert=0,t===Ur?(mt(e,!0),e.strm.avail_out===0?hn:Bn):(e.strstart>e.block_start&&(mt(e,!1),e.strm.avail_out===0),dt)},Es=(e,t)=>{let r,n;for(;;){if(e.lookahead<Gt){if(pn(e),e.lookahead<Gt&&t===dn)return dt;if(e.lookahead===0)break}if(r=0,e.lookahead>=Ge&&(e.ins_h=zr(e,e.ins_h,e.window[e.strstart+Ge-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),r!==0&&e.strstart-r<=e.w_size-Gt&&(e.match_length=ol(e,r)),e.match_length>=Ge)if(n=Mr(e,e.strstart-e.match_start,e.match_length-Ge),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=Ge){e.match_length--;do e.strstart++,e.ins_h=zr(e,e.ins_h,e.window[e.strstart+Ge-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!=0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=zr(e,e.ins_h,e.window[e.strstart+1]);else n=Mr(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(mt(e,!1),e.strm.avail_out===0))return dt}return e.insert=e.strstart<Ge-1?e.strstart:Ge-1,t===Ur?(mt(e,!0),e.strm.avail_out===0?hn:Bn):e.last_lit&&(mt(e,!1),e.strm.avail_out===0)?dt:Ai},jn=(e,t)=>{let r,n,i;for(;;){if(e.lookahead<Gt){if(pn(e),e.lookahead<Gt&&t===dn)return dt;if(e.lookahead===0)break}if(r=0,e.lookahead>=Ge&&(e.ins_h=zr(e,e.ins_h,e.window[e.strstart+Ge-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=Ge-1,r!==0&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-Gt&&(e.match_length=ol(e,r),e.match_length<=5&&(e.strategy===Cv||e.match_length===Ge&&e.strstart-e.match_start>4096)&&(e.match_length=Ge-1)),e.prev_length>=Ge&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-Ge,n=Mr(e,e.strstart-1-e.prev_match,e.prev_length-Ge),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=i&&(e.ins_h=zr(e,e.ins_h,e.window[e.strstart+Ge-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!=0);if(e.match_available=0,e.match_length=Ge-1,e.strstart++,n&&(mt(e,!1),e.strm.avail_out===0))return dt}else if(e.match_available){if(n=Mr(e,0,e.window[e.strstart-1]),n&&mt(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return dt}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=Mr(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<Ge-1?e.strstart:Ge-1,t===Ur?(mt(e,!0),e.strm.avail_out===0?hn:Bn):e.last_lit&&(mt(e,!1),e.strm.avail_out===0)?dt:Ai},Uv=(e,t)=>{let r,n,i,o;const a=e.window;for(;;){if(e.lookahead<=Hr){if(pn(e),e.lookahead<=Hr&&t===dn)return dt;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=Ge&&e.strstart>0&&(i=e.strstart-1,n=a[i],n===a[++i]&&n===a[++i]&&n===a[++i])){o=e.strstart+Hr;do;while(n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&i<o);e.match_length=Hr-(o-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=Ge?(r=Mr(e,1,e.match_length-Ge),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=Mr(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(mt(e,!1),e.strm.avail_out===0))return dt}return e.insert=0,t===Ur?(mt(e,!0),e.strm.avail_out===0?hn:Bn):e.last_lit&&(mt(e,!1),e.strm.avail_out===0)?dt:Ai},Hv=(e,t)=>{let r;for(;;){if(e.lookahead===0&&(pn(e),e.lookahead===0)){if(t===dn)return dt;break}if(e.match_length=0,r=Mr(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(mt(e,!1),e.strm.avail_out===0))return dt}return e.insert=0,t===Ur?(mt(e,!0),e.strm.avail_out===0?hn:Bn):e.last_lit&&(mt(e,!1),e.strm.avail_out===0)?dt:Ai};function cr(e,t,r,n,i){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=i}const Oi=[new cr(0,0,0,0,Mv),new cr(4,4,8,4,Es),new cr(4,5,16,8,Es),new cr(4,6,32,32,Es),new cr(4,4,16,16,jn),new cr(8,16,32,32,jn),new cr(8,16,128,128,jn),new cr(8,32,128,256,jn),new cr(32,128,258,1024,jn),new cr(32,258,258,4096,jn)],Bv=e=>{e.window_size=2*e.w_size,jr(e.head),e.max_lazy_match=Oi[e.level].max_lazy,e.good_match=Oi[e.level].good_length,e.nice_match=Oi[e.level].nice_length,e.max_chain_length=Oi[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=Ge-1,e.match_available=0,e.ins_h=0};function jv(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Ro,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(Ov*2),this.dyn_dtree=new Uint16Array((2*Av+1)*2),this.bl_tree=new Uint16Array((2*Pv+1)*2),jr(this.dyn_ltree),jr(this.dyn_dtree),jr(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(Nv+1),this.heap=new Uint16Array(2*Cs+1),jr(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*Cs+1),jr(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const al=e=>{if(!e||!e.state)return Br(e,Bt);e.total_in=e.total_out=0,e.data_type=Tv;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?ko:fn,e.adler=t.wrap===2?0:1,t.last_flush=dn,pv(t),sr},sl=e=>{const t=al(e);return t===sr&&Bv(e.state),t},zv=(e,t)=>!e||!e.state||e.state.wrap!==2?Bt:(e.state.gzhead=t,sr),cl=(e,t,r,n,i,o)=>{if(!e)return Bt;let a=1;if(t===_v&&(t=6),n<0?(a=0,n=-n):n>15&&(a=2,n-=16),i<1||i>Rv||r!==Ro||n<8||n>15||t<0||t>9||o<0||o>Ev)return Br(e,Bt);n===8&&(n=9);const c=new jv;return e.state=c,c.strm=e,c.wrap=a,c.gzhead=null,c.w_bits=n,c.w_size=1<<c.w_bits,c.w_mask=c.w_size-1,c.hash_bits=i+7,c.hash_size=1<<c.hash_bits,c.hash_mask=c.hash_size-1,c.hash_shift=~~((c.hash_bits+Ge-1)/Ge),c.window=new Uint8Array(c.w_size*2),c.head=new Uint16Array(c.hash_size),c.prev=new Uint16Array(c.w_size),c.lit_bufsize=1<<i+6,c.pending_buf_size=c.lit_bufsize*4,c.pending_buf=new Uint8Array(c.pending_buf_size),c.d_buf=1*c.lit_bufsize,c.l_buf=(1+2)*c.lit_bufsize,c.level=t,c.strategy=o,c.method=r,sl(e)},qv=(e,t)=>cl(e,t,Ro,kv,Dv,xv),Wv=(e,t)=>{let r,n;if(!e||!e.state||t>rl||t<0)return e?Br(e,Bt):Bt;const i=e.state;if(!e.output||!e.input&&e.avail_in!==0||i.status===Ii&&t!==Ur)return Br(e,e.avail_out===0?_s:Bt);i.strm=e;const o=i.last_flush;if(i.last_flush=t,i.status===ko)if(i.wrap===2)e.adler=0,Ze(i,31),Ze(i,139),Ze(i,8),i.gzhead?(Ze(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),Ze(i,i.gzhead.time&255),Ze(i,i.gzhead.time>>8&255),Ze(i,i.gzhead.time>>16&255),Ze(i,i.gzhead.time>>24&255),Ze(i,i.level===9?2:i.strategy>=To||i.level<2?4:0),Ze(i,i.gzhead.os&255),i.gzhead.extra&&i.gzhead.extra.length&&(Ze(i,i.gzhead.extra.length&255),Ze(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=ht(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=Ss):(Ze(i,0),Ze(i,0),Ze(i,0),Ze(i,0),Ze(i,0),Ze(i,i.level===9?2:i.strategy>=To||i.level<2?4:0),Ze(i,Lv),i.status=fn);else{let a=Ro+(i.w_bits-8<<4)<<8,c=-1;i.strategy>=To||i.level<2?c=0:i.level<6?c=1:i.level===6?c=2:c=3,a|=c<<6,i.strstart!==0&&(a|=Fv),a+=31-a%31,i.status=fn,Pi(i,a),i.strstart!==0&&(Pi(i,e.adler>>>16),Pi(i,e.adler&65535)),e.adler=1}if(i.status===Ss)if(i.gzhead.extra){for(r=i.pending;i.gzindex<(i.gzhead.extra.length&65535)&&!(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(e.adler=ht(e.adler,i.pending_buf,i.pending-r,r)),qr(e),r=i.pending,i.pending===i.pending_buf_size));)Ze(i,i.gzhead.extra[i.gzindex]&255),i.gzindex++;i.gzhead.hcrc&&i.pending>r&&(e.adler=ht(e.adler,i.pending_buf,i.pending-r,r)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=Do)}else i.status=Do;if(i.status===Do)if(i.gzhead.name){r=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(e.adler=ht(e.adler,i.pending_buf,i.pending-r,r)),qr(e),r=i.pending,i.pending===i.pending_buf_size)){n=1;break}i.gzindex<i.gzhead.name.length?n=i.gzhead.name.charCodeAt(i.gzindex++)&255:n=0,Ze(i,n)}while(n!==0);i.gzhead.hcrc&&i.pending>r&&(e.adler=ht(e.adler,i.pending_buf,i.pending-r,r)),n===0&&(i.gzindex=0,i.status=Io)}else i.status=Io;if(i.status===Io)if(i.gzhead.comment){r=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(e.adler=ht(e.adler,i.pending_buf,i.pending-r,r)),qr(e),r=i.pending,i.pending===i.pending_buf_size)){n=1;break}i.gzindex<i.gzhead.comment.length?n=i.gzhead.comment.charCodeAt(i.gzindex++)&255:n=0,Ze(i,n)}while(n!==0);i.gzhead.hcrc&&i.pending>r&&(e.adler=ht(e.adler,i.pending_buf,i.pending-r,r)),n===0&&(i.status=Ao)}else i.status=Ao;if(i.status===Ao&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&qr(e),i.pending+2<=i.pending_buf_size&&(Ze(i,e.adler&255),Ze(i,e.adler>>8&255),e.adler=0,i.status=fn)):i.status=fn),i.pending!==0){if(qr(e),e.avail_out===0)return i.last_flush=-1,sr}else if(e.avail_in===0&&il(t)<=il(o)&&t!==Ur)return Br(e,_s);if(i.status===Ii&&e.avail_in!==0)return Br(e,_s);if(e.avail_in!==0||i.lookahead!==0||t!==dn&&i.status!==Ii){let a=i.strategy===To?Hv(i,t):i.strategy===Sv?Uv(i,t):Oi[i.level].func(i,t);if((a===hn||a===Bn)&&(i.status=Ii),a===dt||a===hn)return e.avail_out===0&&(i.last_flush=-1),sr;if(a===Ai&&(t===yv?vv(i):t!==rl&&(gv(i,0,0,!1),t===wv&&(jr(i.head),i.lookahead===0&&(i.strstart=0,i.block_start=0,i.insert=0))),qr(e),e.avail_out===0))return i.last_flush=-1,sr}return t!==Ur?sr:i.wrap<=0?nl:(i.wrap===2?(Ze(i,e.adler&255),Ze(i,e.adler>>8&255),Ze(i,e.adler>>16&255),Ze(i,e.adler>>24&255),Ze(i,e.total_in&255),Ze(i,e.total_in>>8&255),Ze(i,e.total_in>>16&255),Ze(i,e.total_in>>24&255)):(Pi(i,e.adler>>>16),Pi(i,e.adler&65535)),qr(e),i.wrap>0&&(i.wrap=-i.wrap),i.pending!==0?sr:nl)},Vv=e=>{if(!e||!e.state)return Bt;const t=e.state.status;return t!==ko&&t!==Ss&&t!==Do&&t!==Io&&t!==Ao&&t!==fn&&t!==Ii?Br(e,Bt):(e.state=null,t===fn?Br(e,bv):sr)},Gv=(e,t)=>{let r=t.length;if(!e||!e.state)return Bt;const n=e.state,i=n.wrap;if(i===2||i===1&&n.status!==ko||n.lookahead)return Bt;if(i===1&&(e.adler=Di(e.adler,t,r,0)),n.wrap=0,r>=n.w_size){i===0&&(jr(n.head),n.strstart=0,n.block_start=0,n.insert=0);let w=new Uint8Array(n.w_size);w.set(t.subarray(r-n.w_size,r),0),t=w,r=n.w_size}const o=e.avail_in,a=e.next_in,c=e.input;for(e.avail_in=r,e.next_in=0,e.input=t,pn(n);n.lookahead>=Ge;){let w=n.strstart,p=n.lookahead-(Ge-1);do n.ins_h=zr(n,n.ins_h,n.window[w+Ge-1]),n.prev[w&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=w,w++;while(--p);n.strstart=w,n.lookahead=Ge-1,pn(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=Ge-1,n.match_available=0,e.next_in=a,e.input=c,e.avail_in=o,n.wrap=i,sr};var Kv=qv,Qv=cl,Zv=sl,Xv=al,Yv=zv,Jv=Wv,ey=Vv,ty=Gv,ry="pako deflate (from Nodeca project)",Ni={deflateInit:Kv,deflateInit2:Qv,deflateReset:Zv,deflateResetKeep:Xv,deflateSetHeader:Yv,deflate:Jv,deflateEnd:ey,deflateSetDictionary:ty,deflateInfo:ry};const ny=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var iy=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(!!r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)ny(r,n)&&(e[n]=r[n])}}return e},oy=e=>{let t=0;for(let n=0,i=e.length;n<i;n++)t+=e[n].length;const r=new Uint8Array(t);for(let n=0,i=0,o=e.length;n<o;n++){let a=e[n];r.set(a,i),i+=a.length}return r},Po={assign:iy,flattenChunks:oy};let ul=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){ul=!1}const Fi=new Uint8Array(256);for(let e=0;e<256;e++)Fi[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;Fi[254]=Fi[254]=1;var ay=e=>{let t,r,n,i,o,a=e.length,c=0;for(i=0;i<a;i++)r=e.charCodeAt(i),(r&64512)==55296&&i+1<a&&(n=e.charCodeAt(i+1),(n&64512)==56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),c+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(c),o=0,i=0;o<c;i++)r=e.charCodeAt(i),(r&64512)==55296&&i+1<a&&(n=e.charCodeAt(i+1),(n&64512)==56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),r<128?t[o++]=r:r<2048?(t[o++]=192|r>>>6,t[o++]=128|r&63):r<65536?(t[o++]=224|r>>>12,t[o++]=128|r>>>6&63,t[o++]=128|r&63):(t[o++]=240|r>>>18,t[o++]=128|r>>>12&63,t[o++]=128|r>>>6&63,t[o++]=128|r&63);return t};const sy=(e,t)=>{if(t<65534&&e.subarray&&ul)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r};var cy=(e,t)=>{let r,n;const i=t||e.length,o=new Array(i*2);for(n=0,r=0;r<i;){let a=e[r++];if(a<128){o[n++]=a;continue}let c=Fi[a];if(c>4){o[n++]=65533,r+=c-1;continue}for(a&=c===2?31:c===3?15:7;c>1&&r<i;)a=a<<6|e[r++]&63,c--;if(c>1){o[n++]=65533;continue}a<65536?o[n++]=a:(a-=65536,o[n++]=55296|a>>10&1023,o[n++]=56320|a&1023)}return sy(o,n)},uy=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(e[r]&192)==128;)r--;return r<0||r===0?t:r+Fi[e[r]]>t?r:t},Li={string2buf:ay,buf2string:cy,utf8border:uy};function ly(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var ll=ly;const dl=Object.prototype.toString,{Z_NO_FLUSH:dy,Z_SYNC_FLUSH:fy,Z_FULL_FLUSH:hy,Z_FINISH:py,Z_OK:Oo,Z_STREAM_END:gy,Z_DEFAULT_COMPRESSION:my,Z_DEFAULT_STRATEGY:vy,Z_DEFLATED:yy}=ln;function $i(e){this.options=Po.assign({level:my,method:yy,chunkSize:16384,windowBits:15,memLevel:8,strategy:vy},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ll,this.strm.avail_out=0;let r=Ni.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==Oo)throw new Error(un[r]);if(t.header&&Ni.deflateSetHeader(this.strm,t.header),t.dictionary){let n;if(typeof t.dictionary=="string"?n=Li.string2buf(t.dictionary):dl.call(t.dictionary)==="[object ArrayBuffer]"?n=new Uint8Array(t.dictionary):n=t.dictionary,r=Ni.deflateSetDictionary(this.strm,n),r!==Oo)throw new Error(un[r]);this._dict_set=!0}}$i.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize;let i,o;if(this.ended)return!1;for(t===~~t?o=t:o=t===!0?py:dy,typeof e=="string"?r.input=Li.string2buf(e):dl.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){if(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),(o===fy||o===hy)&&r.avail_out<=6){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(i=Ni.deflate(r,o),i===gy)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),i=Ni.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===Oo;if(r.avail_out===0){this.onData(r.output);continue}if(o>0&&r.next_out>0){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(r.avail_in===0)break}return!0},$i.prototype.onData=function(e){this.chunks.push(e)},$i.prototype.onEnd=function(e){e===Oo&&(this.result=Po.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function xs(e,t){const r=new $i(t);if(r.push(e,!0),r.err)throw r.msg||un[r.err];return r.result}function wy(e,t){return t=t||{},t.raw=!0,xs(e,t)}function by(e,t){return t=t||{},t.gzip=!0,xs(e,t)}var _y=$i,Cy=xs,Sy=wy,Ey=by,xy=ln,Ty={Deflate:_y,deflate:Cy,deflateRaw:Sy,gzip:Ey,constants:xy};const No=30,Ry=12;var ky=function(t,r){let n,i,o,a,c,w,p,S,P,k,I,$,B,q,Z,K,re,ee,se,Se,me,Te,Oe,Re;const Pe=t.state;n=t.next_in,Oe=t.input,i=n+(t.avail_in-5),o=t.next_out,Re=t.output,a=o-(r-t.avail_out),c=o+(t.avail_out-257),w=Pe.dmax,p=Pe.wsize,S=Pe.whave,P=Pe.wnext,k=Pe.window,I=Pe.hold,$=Pe.bits,B=Pe.lencode,q=Pe.distcode,Z=(1<<Pe.lenbits)-1,K=(1<<Pe.distbits)-1;e:do{$<15&&(I+=Oe[n++]<<$,$+=8,I+=Oe[n++]<<$,$+=8),re=B[I&Z];t:for(;;){if(ee=re>>>24,I>>>=ee,$-=ee,ee=re>>>16&255,ee===0)Re[o++]=re&65535;else if(ee&16){se=re&65535,ee&=15,ee&&($<ee&&(I+=Oe[n++]<<$,$+=8),se+=I&(1<<ee)-1,I>>>=ee,$-=ee),$<15&&(I+=Oe[n++]<<$,$+=8,I+=Oe[n++]<<$,$+=8),re=q[I&K];r:for(;;){if(ee=re>>>24,I>>>=ee,$-=ee,ee=re>>>16&255,ee&16){if(Se=re&65535,ee&=15,$<ee&&(I+=Oe[n++]<<$,$+=8,$<ee&&(I+=Oe[n++]<<$,$+=8)),Se+=I&(1<<ee)-1,Se>w){t.msg="invalid distance too far back",Pe.mode=No;break e}if(I>>>=ee,$-=ee,ee=o-a,Se>ee){if(ee=Se-ee,ee>S&&Pe.sane){t.msg="invalid distance too far back",Pe.mode=No;break e}if(me=0,Te=k,P===0){if(me+=p-ee,ee<se){se-=ee;do Re[o++]=k[me++];while(--ee);me=o-Se,Te=Re}}else if(P<ee){if(me+=p+P-ee,ee-=P,ee<se){se-=ee;do Re[o++]=k[me++];while(--ee);if(me=0,P<se){ee=P,se-=ee;do Re[o++]=k[me++];while(--ee);me=o-Se,Te=Re}}}else if(me+=P-ee,ee<se){se-=ee;do Re[o++]=k[me++];while(--ee);me=o-Se,Te=Re}for(;se>2;)Re[o++]=Te[me++],Re[o++]=Te[me++],Re[o++]=Te[me++],se-=3;se&&(Re[o++]=Te[me++],se>1&&(Re[o++]=Te[me++]))}else{me=o-Se;do Re[o++]=Re[me++],Re[o++]=Re[me++],Re[o++]=Re[me++],se-=3;while(se>2);se&&(Re[o++]=Re[me++],se>1&&(Re[o++]=Re[me++]))}}else if((ee&64)==0){re=q[(re&65535)+(I&(1<<ee)-1)];continue r}else{t.msg="invalid distance code",Pe.mode=No;break e}break}}else if((ee&64)==0){re=B[(re&65535)+(I&(1<<ee)-1)];continue t}else if(ee&32){Pe.mode=Ry;break e}else{t.msg="invalid literal/length code",Pe.mode=No;break e}break}}while(n<i&&o<c);se=$>>3,n-=se,$-=se<<3,I&=(1<<$)-1,t.next_in=n,t.next_out=o,t.avail_in=n<i?5+(i-n):5-(n-i),t.avail_out=o<c?257+(c-o):257-(o-c),Pe.hold=I,Pe.bits=$};const zn=15,fl=852,hl=592,pl=0,Ts=1,gl=2,Dy=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Iy=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Ay=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Py=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Mi=(e,t,r,n,i,o,a,c)=>{const w=c.bits;let p=0,S=0,P=0,k=0,I=0,$=0,B=0,q=0,Z=0,K=0,re,ee,se,Se,me,Te=null,Oe=0,Re;const Pe=new Uint16Array(zn+1),Pt=new Uint16Array(zn+1);let qt=null,Wt=0,Nr,$t,Yt;for(p=0;p<=zn;p++)Pe[p]=0;for(S=0;S<n;S++)Pe[t[r+S]]++;for(I=w,k=zn;k>=1&&Pe[k]===0;k--);if(I>k&&(I=k),k===0)return i[o++]=1<<24|64<<16|0,i[o++]=1<<24|64<<16|0,c.bits=1,0;for(P=1;P<k&&Pe[P]===0;P++);for(I<P&&(I=P),q=1,p=1;p<=zn;p++)if(q<<=1,q-=Pe[p],q<0)return-1;if(q>0&&(e===pl||k!==1))return-1;for(Pt[1]=0,p=1;p<zn;p++)Pt[p+1]=Pt[p]+Pe[p];for(S=0;S<n;S++)t[r+S]!==0&&(a[Pt[t[r+S]]++]=S);if(e===pl?(Te=qt=a,Re=19):e===Ts?(Te=Dy,Oe-=257,qt=Iy,Wt-=257,Re=256):(Te=Ay,qt=Py,Re=-1),K=0,S=0,p=P,me=o,$=I,B=0,se=-1,Z=1<<I,Se=Z-1,e===Ts&&Z>fl||e===gl&&Z>hl)return 1;for(;;){Nr=p-B,a[S]<Re?($t=0,Yt=a[S]):a[S]>Re?($t=qt[Wt+a[S]],Yt=Te[Oe+a[S]]):($t=32+64,Yt=0),re=1<<p-B,ee=1<<$,P=ee;do ee-=re,i[me+(K>>B)+ee]=Nr<<24|$t<<16|Yt|0;while(ee!==0);for(re=1<<p-1;K&re;)re>>=1;if(re!==0?(K&=re-1,K+=re):K=0,S++,--Pe[p]==0){if(p===k)break;p=t[r+a[S]]}if(p>I&&(K&Se)!==se){for(B===0&&(B=I),me+=P,$=p-B,q=1<<$;$+B<k&&(q-=Pe[$+B],!(q<=0));)$++,q<<=1;if(Z+=1<<$,e===Ts&&Z>fl||e===gl&&Z>hl)return 1;se=K&Se,i[se]=I<<24|$<<16|me-o|0}}return K!==0&&(i[me+K]=p-B<<24|64<<16|0),c.bits=I,0};const Oy=0,ml=1,vl=2,{Z_FINISH:yl,Z_BLOCK:Ny,Z_TREES:Fo,Z_OK:gn,Z_STREAM_END:Fy,Z_NEED_DICT:Ly,Z_STREAM_ERROR:jt,Z_DATA_ERROR:wl,Z_MEM_ERROR:bl,Z_BUF_ERROR:$y,Z_DEFLATED:_l}=ln,Cl=1,Sl=2,El=3,xl=4,Tl=5,Rl=6,kl=7,Dl=8,Il=9,Al=10,Lo=11,Er=12,Rs=13,Pl=14,ks=15,Ol=16,Nl=17,Fl=18,Ll=19,$o=20,Mo=21,$l=22,Ml=23,Ul=24,Hl=25,Bl=26,Ds=27,jl=28,zl=29,ot=30,ql=31,My=32,Uy=852,Hy=592,By=15,Wl=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function jy(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Vl=e=>{if(!e||!e.state)return jt;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=Cl,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(Uy),t.distcode=t.distdyn=new Int32Array(Hy),t.sane=1,t.back=-1,gn},Gl=e=>{if(!e||!e.state)return jt;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,Vl(e)},Kl=(e,t)=>{let r;if(!e||!e.state)return jt;const n=e.state;return t<0?(r=0,t=-t):(r=(t>>4)+1,t<48&&(t&=15)),t&&(t<8||t>15)?jt:(n.window!==null&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,Gl(e))},Ql=(e,t)=>{if(!e)return jt;const r=new jy;e.state=r,r.window=null;const n=Kl(e,t);return n!==gn&&(e.state=null),n},zy=e=>Ql(e,By);let Zl=!0,Is,As;const qy=e=>{if(Zl){Is=new Int32Array(512),As=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Mi(ml,e.lens,0,288,Is,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Mi(vl,e.lens,0,32,As,0,e.work,{bits:5}),Zl=!1}e.lencode=Is,e.lenbits=9,e.distcode=As,e.distbits=5},Xl=(e,t,r,n)=>{let i;const o=e.state;return o.window===null&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),n>=o.wsize?(o.window.set(t.subarray(r-o.wsize,r),0),o.wnext=0,o.whave=o.wsize):(i=o.wsize-o.wnext,i>n&&(i=n),o.window.set(t.subarray(r-n,r-n+i),o.wnext),n-=i,n?(o.window.set(t.subarray(r-n,r),0),o.wnext=n,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0},Wy=(e,t)=>{let r,n,i,o,a,c,w,p,S,P,k,I,$,B,q=0,Z,K,re,ee,se,Se,me,Te;const Oe=new Uint8Array(4);let Re,Pe;const Pt=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!e||!e.state||!e.output||!e.input&&e.avail_in!==0)return jt;r=e.state,r.mode===Er&&(r.mode=Rs),a=e.next_out,i=e.output,w=e.avail_out,o=e.next_in,n=e.input,c=e.avail_in,p=r.hold,S=r.bits,P=c,k=w,Te=gn;e:for(;;)switch(r.mode){case Cl:if(r.wrap===0){r.mode=Rs;break}for(;S<16;){if(c===0)break e;c--,p+=n[o++]<<S,S+=8}if(r.wrap&2&&p===35615){r.check=0,Oe[0]=p&255,Oe[1]=p>>>8&255,r.check=ht(r.check,Oe,2,0),p=0,S=0,r.mode=Sl;break}if(r.flags=0,r.head&&(r.head.done=!1),!(r.wrap&1)||(((p&255)<<8)+(p>>8))%31){e.msg="incorrect header check",r.mode=ot;break}if((p&15)!==_l){e.msg="unknown compression method",r.mode=ot;break}if(p>>>=4,S-=4,me=(p&15)+8,r.wbits===0)r.wbits=me;else if(me>r.wbits){e.msg="invalid window size",r.mode=ot;break}r.dmax=1<<r.wbits,e.adler=r.check=1,r.mode=p&512?Al:Er,p=0,S=0;break;case Sl:for(;S<16;){if(c===0)break e;c--,p+=n[o++]<<S,S+=8}if(r.flags=p,(r.flags&255)!==_l){e.msg="unknown compression method",r.mode=ot;break}if(r.flags&57344){e.msg="unknown header flags set",r.mode=ot;break}r.head&&(r.head.text=p>>8&1),r.flags&512&&(Oe[0]=p&255,Oe[1]=p>>>8&255,r.check=ht(r.check,Oe,2,0)),p=0,S=0,r.mode=El;case El:for(;S<32;){if(c===0)break e;c--,p+=n[o++]<<S,S+=8}r.head&&(r.head.time=p),r.flags&512&&(Oe[0]=p&255,Oe[1]=p>>>8&255,Oe[2]=p>>>16&255,Oe[3]=p>>>24&255,r.check=ht(r.check,Oe,4,0)),p=0,S=0,r.mode=xl;case xl:for(;S<16;){if(c===0)break e;c--,p+=n[o++]<<S,S+=8}r.head&&(r.head.xflags=p&255,r.head.os=p>>8),r.flags&512&&(Oe[0]=p&255,Oe[1]=p>>>8&255,r.check=ht(r.check,Oe,2,0)),p=0,S=0,r.mode=Tl;case Tl:if(r.flags&1024){for(;S<16;){if(c===0)break e;c--,p+=n[o++]<<S,S+=8}r.length=p,r.head&&(r.head.extra_len=p),r.flags&512&&(Oe[0]=p&255,Oe[1]=p>>>8&255,r.check=ht(r.check,Oe,2,0)),p=0,S=0}else r.head&&(r.head.extra=null);r.mode=Rl;case Rl:if(r.flags&1024&&(I=r.length,I>c&&(I=c),I&&(r.head&&(me=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(o,o+I),me)),r.flags&512&&(r.check=ht(r.check,n,I,o)),c-=I,o+=I,r.length-=I),r.length))break e;r.length=0,r.mode=kl;case kl:if(r.flags&2048){if(c===0)break e;I=0;do me=n[o+I++],r.head&&me&&r.length<65536&&(r.head.name+=String.fromCharCode(me));while(me&&I<c);if(r.flags&512&&(r.check=ht(r.check,n,I,o)),c-=I,o+=I,me)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=Dl;case Dl:if(r.flags&4096){if(c===0)break e;I=0;do me=n[o+I++],r.head&&me&&r.length<65536&&(r.head.comment+=String.fromCharCode(me));while(me&&I<c);if(r.flags&512&&(r.check=ht(r.check,n,I,o)),c-=I,o+=I,me)break e}else r.head&&(r.head.comment=null);r.mode=Il;case Il:if(r.flags&512){for(;S<16;){if(c===0)break e;c--,p+=n[o++]<<S,S+=8}if(p!==(r.check&65535)){e.msg="header crc mismatch",r.mode=ot;break}p=0,S=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=Er;break;case Al:for(;S<32;){if(c===0)break e;c--,p+=n[o++]<<S,S+=8}e.adler=r.check=Wl(p),p=0,S=0,r.mode=Lo;case Lo:if(r.havedict===0)return e.next_out=a,e.avail_out=w,e.next_in=o,e.avail_in=c,r.hold=p,r.bits=S,Ly;e.adler=r.check=1,r.mode=Er;case Er:if(t===Ny||t===Fo)break e;case Rs:if(r.last){p>>>=S&7,S-=S&7,r.mode=Ds;break}for(;S<3;){if(c===0)break e;c--,p+=n[o++]<<S,S+=8}switch(r.last=p&1,p>>>=1,S-=1,p&3){case 0:r.mode=Pl;break;case 1:if(qy(r),r.mode=$o,t===Fo){p>>>=2,S-=2;break e}break;case 2:r.mode=Nl;break;case 3:e.msg="invalid block type",r.mode=ot}p>>>=2,S-=2;break;case Pl:for(p>>>=S&7,S-=S&7;S<32;){if(c===0)break e;c--,p+=n[o++]<<S,S+=8}if((p&65535)!=(p>>>16^65535)){e.msg="invalid stored block lengths",r.mode=ot;break}if(r.length=p&65535,p=0,S=0,r.mode=ks,t===Fo)break e;case ks:r.mode=Ol;case Ol:if(I=r.length,I){if(I>c&&(I=c),I>w&&(I=w),I===0)break e;i.set(n.subarray(o,o+I),a),c-=I,o+=I,w-=I,a+=I,r.length-=I;break}r.mode=Er;break;case Nl:for(;S<14;){if(c===0)break e;c--,p+=n[o++]<<S,S+=8}if(r.nlen=(p&31)+257,p>>>=5,S-=5,r.ndist=(p&31)+1,p>>>=5,S-=5,r.ncode=(p&15)+4,p>>>=4,S-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=ot;break}r.have=0,r.mode=Fl;case Fl:for(;r.have<r.ncode;){for(;S<3;){if(c===0)break e;c--,p+=n[o++]<<S,S+=8}r.lens[Pt[r.have++]]=p&7,p>>>=3,S-=3}for(;r.have<19;)r.lens[Pt[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,Re={bits:r.lenbits},Te=Mi(Oy,r.lens,0,19,r.lencode,0,r.work,Re),r.lenbits=Re.bits,Te){e.msg="invalid code lengths set",r.mode=ot;break}r.have=0,r.mode=Ll;case Ll:for(;r.have<r.nlen+r.ndist;){for(;q=r.lencode[p&(1<<r.lenbits)-1],Z=q>>>24,K=q>>>16&255,re=q&65535,!(Z<=S);){if(c===0)break e;c--,p+=n[o++]<<S,S+=8}if(re<16)p>>>=Z,S-=Z,r.lens[r.have++]=re;else{if(re===16){for(Pe=Z+2;S<Pe;){if(c===0)break e;c--,p+=n[o++]<<S,S+=8}if(p>>>=Z,S-=Z,r.have===0){e.msg="invalid bit length repeat",r.mode=ot;break}me=r.lens[r.have-1],I=3+(p&3),p>>>=2,S-=2}else if(re===17){for(Pe=Z+3;S<Pe;){if(c===0)break e;c--,p+=n[o++]<<S,S+=8}p>>>=Z,S-=Z,me=0,I=3+(p&7),p>>>=3,S-=3}else{for(Pe=Z+7;S<Pe;){if(c===0)break e;c--,p+=n[o++]<<S,S+=8}p>>>=Z,S-=Z,me=0,I=11+(p&127),p>>>=7,S-=7}if(r.have+I>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=ot;break}for(;I--;)r.lens[r.have++]=me}}if(r.mode===ot)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=ot;break}if(r.lenbits=9,Re={bits:r.lenbits},Te=Mi(ml,r.lens,0,r.nlen,r.lencode,0,r.work,Re),r.lenbits=Re.bits,Te){e.msg="invalid literal/lengths set",r.mode=ot;break}if(r.distbits=6,r.distcode=r.distdyn,Re={bits:r.distbits},Te=Mi(vl,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,Re),r.distbits=Re.bits,Te){e.msg="invalid distances set",r.mode=ot;break}if(r.mode=$o,t===Fo)break e;case $o:r.mode=Mo;case Mo:if(c>=6&&w>=258){e.next_out=a,e.avail_out=w,e.next_in=o,e.avail_in=c,r.hold=p,r.bits=S,ky(e,k),a=e.next_out,i=e.output,w=e.avail_out,o=e.next_in,n=e.input,c=e.avail_in,p=r.hold,S=r.bits,r.mode===Er&&(r.back=-1);break}for(r.back=0;q=r.lencode[p&(1<<r.lenbits)-1],Z=q>>>24,K=q>>>16&255,re=q&65535,!(Z<=S);){if(c===0)break e;c--,p+=n[o++]<<S,S+=8}if(K&&(K&240)==0){for(ee=Z,se=K,Se=re;q=r.lencode[Se+((p&(1<<ee+se)-1)>>ee)],Z=q>>>24,K=q>>>16&255,re=q&65535,!(ee+Z<=S);){if(c===0)break e;c--,p+=n[o++]<<S,S+=8}p>>>=ee,S-=ee,r.back+=ee}if(p>>>=Z,S-=Z,r.back+=Z,r.length=re,K===0){r.mode=Bl;break}if(K&32){r.back=-1,r.mode=Er;break}if(K&64){e.msg="invalid literal/length code",r.mode=ot;break}r.extra=K&15,r.mode=$l;case $l:if(r.extra){for(Pe=r.extra;S<Pe;){if(c===0)break e;c--,p+=n[o++]<<S,S+=8}r.length+=p&(1<<r.extra)-1,p>>>=r.extra,S-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=Ml;case Ml:for(;q=r.distcode[p&(1<<r.distbits)-1],Z=q>>>24,K=q>>>16&255,re=q&65535,!(Z<=S);){if(c===0)break e;c--,p+=n[o++]<<S,S+=8}if((K&240)==0){for(ee=Z,se=K,Se=re;q=r.distcode[Se+((p&(1<<ee+se)-1)>>ee)],Z=q>>>24,K=q>>>16&255,re=q&65535,!(ee+Z<=S);){if(c===0)break e;c--,p+=n[o++]<<S,S+=8}p>>>=ee,S-=ee,r.back+=ee}if(p>>>=Z,S-=Z,r.back+=Z,K&64){e.msg="invalid distance code",r.mode=ot;break}r.offset=re,r.extra=K&15,r.mode=Ul;case Ul:if(r.extra){for(Pe=r.extra;S<Pe;){if(c===0)break e;c--,p+=n[o++]<<S,S+=8}r.offset+=p&(1<<r.extra)-1,p>>>=r.extra,S-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=ot;break}r.mode=Hl;case Hl:if(w===0)break e;if(I=k-w,r.offset>I){if(I=r.offset-I,I>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=ot;break}I>r.wnext?(I-=r.wnext,$=r.wsize-I):$=r.wnext-I,I>r.length&&(I=r.length),B=r.window}else B=i,$=a-r.offset,I=r.length;I>w&&(I=w),w-=I,r.length-=I;do i[a++]=B[$++];while(--I);r.length===0&&(r.mode=Mo);break;case Bl:if(w===0)break e;i[a++]=r.length,w--,r.mode=Mo;break;case Ds:if(r.wrap){for(;S<32;){if(c===0)break e;c--,p|=n[o++]<<S,S+=8}if(k-=w,e.total_out+=k,r.total+=k,k&&(e.adler=r.check=r.flags?ht(r.check,i,k,a-k):Di(r.check,i,k,a-k)),k=w,(r.flags?p:Wl(p))!==r.check){e.msg="incorrect data check",r.mode=ot;break}p=0,S=0}r.mode=jl;case jl:if(r.wrap&&r.flags){for(;S<32;){if(c===0)break e;c--,p+=n[o++]<<S,S+=8}if(p!==(r.total&4294967295)){e.msg="incorrect length check",r.mode=ot;break}p=0,S=0}r.mode=zl;case zl:Te=Fy;break e;case ot:Te=wl;break e;case ql:return bl;case My:default:return jt}return e.next_out=a,e.avail_out=w,e.next_in=o,e.avail_in=c,r.hold=p,r.bits=S,(r.wsize||k!==e.avail_out&&r.mode<ot&&(r.mode<Ds||t!==yl))&&Xl(e,e.output,e.next_out,k-e.avail_out),P-=e.avail_in,k-=e.avail_out,e.total_in+=P,e.total_out+=k,r.total+=k,r.wrap&&k&&(e.adler=r.check=r.flags?ht(r.check,i,k,e.next_out-k):Di(r.check,i,k,e.next_out-k)),e.data_type=r.bits+(r.last?64:0)+(r.mode===Er?128:0)+(r.mode===$o||r.mode===ks?256:0),(P===0&&k===0||t===yl)&&Te===gn&&(Te=$y),Te},Vy=e=>{if(!e||!e.state)return jt;let t=e.state;return t.window&&(t.window=null),e.state=null,gn},Gy=(e,t)=>{if(!e||!e.state)return jt;const r=e.state;return(r.wrap&2)==0?jt:(r.head=t,t.done=!1,gn)},Ky=(e,t)=>{const r=t.length;let n,i,o;return!e||!e.state||(n=e.state,n.wrap!==0&&n.mode!==Lo)?jt:n.mode===Lo&&(i=1,i=Di(i,t,r,0),i!==n.check)?wl:(o=Xl(e,t,r,r),o?(n.mode=ql,bl):(n.havedict=1,gn))};var Qy=Gl,Zy=Kl,Xy=Vl,Yy=zy,Jy=Ql,e0=Wy,t0=Vy,r0=Gy,n0=Ky,i0="pako inflate (from Nodeca project)",xr={inflateReset:Qy,inflateReset2:Zy,inflateResetKeep:Xy,inflateInit:Yy,inflateInit2:Jy,inflate:e0,inflateEnd:t0,inflateGetHeader:r0,inflateSetDictionary:n0,inflateInfo:i0};function o0(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var a0=o0;const Yl=Object.prototype.toString,{Z_NO_FLUSH:s0,Z_FINISH:c0,Z_OK:Ui,Z_STREAM_END:Ps,Z_NEED_DICT:Os,Z_STREAM_ERROR:u0,Z_DATA_ERROR:Jl,Z_MEM_ERROR:l0}=ln;function Hi(e){this.options=Po.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15)==0&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ll,this.strm.avail_out=0;let r=xr.inflateInit2(this.strm,t.windowBits);if(r!==Ui)throw new Error(un[r]);if(this.header=new a0,xr.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=Li.string2buf(t.dictionary):Yl.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=xr.inflateSetDictionary(this.strm,t.dictionary),r!==Ui)))throw new Error(un[r])}Hi.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize,i=this.options.dictionary;let o,a,c;if(this.ended)return!1;for(t===~~t?a=t:a=t===!0?c0:s0,Yl.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),o=xr.inflate(r,a),o===Os&&i&&(o=xr.inflateSetDictionary(r,i),o===Ui?o=xr.inflate(r,a):o===Jl&&(o=Os));r.avail_in>0&&o===Ps&&r.state.wrap>0&&e[r.next_in]!==0;)xr.inflateReset(r),o=xr.inflate(r,a);switch(o){case u0:case Jl:case Os:case l0:return this.onEnd(o),this.ended=!0,!1}if(c=r.avail_out,r.next_out&&(r.avail_out===0||o===Ps))if(this.options.to==="string"){let w=Li.utf8border(r.output,r.next_out),p=r.next_out-w,S=Li.buf2string(r.output,w);r.next_out=p,r.avail_out=n-p,p&&r.output.set(r.output.subarray(w,w+p),0),this.onData(S)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(o===Ui&&c===0)){if(o===Ps)return o=xr.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(r.avail_in===0)break}}return!0},Hi.prototype.onData=function(e){this.chunks.push(e)},Hi.prototype.onEnd=function(e){e===Ui&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Po.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function Ns(e,t){const r=new Hi(t);if(r.push(e),r.err)throw r.msg||un[r.err];return r.result}function d0(e,t){return t=t||{},t.raw=!0,Ns(e,t)}var f0=Hi,h0=Ns,p0=d0,g0=Ns,m0=ln,v0={Inflate:f0,inflate:h0,inflateRaw:p0,ungzip:g0,constants:m0};const{Deflate:y0,deflate:w0,deflateRaw:b0,gzip:_0}=Ty,{Inflate:C0,inflate:S0,inflateRaw:E0,ungzip:x0}=v0;var T0=y0,R0=w0,k0=b0,D0=_0,I0=C0,A0=S0,P0=E0,ed=x0,O0=ln,A_={Deflate:T0,deflate:R0,deflateRaw:k0,gzip:D0,Inflate:I0,inflate:A0,inflateRaw:P0,ungzip:ed,constants:O0};const P_=null,Fs=(0,E.LV)(),td=new TextDecoder,rd=new TextEncoder;class N0{constructor(t,r=0){this.retainFor=r;try{this.weakRef=new WeakRef(t)}catch{}this.retain(t)}retain(t){this.retainTimeout&&clearTimeout(this.retainTimeout),this.strongRef=t,this.retainTimeout=setTimeout(()=>{this.strongRef=void 0,this.retainTimeout=void 0},this.retainFor)}deref(){var t,r;const n=(r=this.strongRef)!=null?r:(t=this.weakRef)==null?void 0:t.deref();return n&&this.retain(n),n}}class F0{constructor(t){this.root=t,this.ongoingReqests=new Map,this.usageFile=s.Uri.joinPath(this.root,"usageHistory.json"),this._disposable=s.Disposable.from(...this.registerCommands()),this.updateHasIndexesContext()}async updateHasIndexesContext(){return is(_i.HasSearchIndexes,(await this.listTars()).length>0)}dispose(){this._disposable.dispose()}registerCommands(){return[s.commands.registerCommand("remoteHub.enableIndexing",async()=>{const t={title:Fs("search download prompt allow","Allow")},r={title:Fs("search download prompt cancel","Cancel"),isCloseAffordance:!0};if(await s.window.showInformationMessage(Fs("search download prompt",`In order to provide full-text search capabilities, a local index of the repository must be created.

Do you want to allow a local index to be created? This can be configured with the "Repo Limit" and "Size Limit" settings of Remote Repositories`),{modal:!0},t,r)===t)return await He.update("search.download.enabled",!0,s.ConfigurationTarget.Global),{triggerSearch:!0}}),s.commands.registerCommand("remoteHub.deleteLocalRepositoryData",async()=>{const t=i=>{const o=[{power:9,name:"GB"},{power:6,name:"MB"},{power:3,name:"kB"},{power:0,name:"B"}];for(const a of o)if(i>10**a.power)return`${Math.round(i/10**a.power)} ${a.name}`;return"Unknown size"},r=await this.listTars();if(r.length===0){await s.window.showInformationMessage("No Search Indexes Found");return}const n=s.window.createQuickPick();n.canSelectMany=!0,n.items=r.map(({name:i,size:o,path:a})=>({label:i,path:a,description:o?t(o):void 0})),n.show(),n.onDidAccept(async()=>{n.hide();for(const{label:i,path:o}of n.selectedItems){const a=s.workspace.fs.delete(o),c=s.window.setStatusBarMessage(`$(loading) Deleting ${i}`,a);await a,c.dispose()}this.updateHasIndexesContext()}),n.onDidHide(()=>n.dispose())}),s.commands.registerCommand("remoteHub.deleteAllLocalRepositoryData",()=>s.window.withProgress({location:s.ProgressLocation.Notification,title:"Deleting Search Indexes..."},async()=>{await Promise.all([s.workspace.fs.delete(this.root,{recursive:!0})]),this.updateHasIndexesContext()}))]}getTarFromMemory(t){var r;if(t===this.lastReadKey){const n=(r=this.lastReadValue)==null?void 0:r.deref();if(n)return n;he.log("Weakref deallocated.")}}async getTarFromDisk(t){try{const r=await s.workspace.fs.readFile(t);return!r||!r.length?void 0:r}catch(r){if(r.code!=="FileNotFound")throw r;return}}async getTarFromNetwork(t,r){if(He.get("search.download.enabled")!==!0)throw Error("Unable to search without an index");const n=await t.getTarGz(r);if(n===void 0)throw Error("Unable to search without an index");return this.updateHasIndexesContext(),n}async getTar(t,r){const{repo:n,HEAD:{sha:i}}=await t.getMetadata(r),o=Object.values(n),a=`${o.join("/")}/${i}`,c=Date.now(),w=()=>`${Date.now()-c}ms`,p=s.Uri.joinPath(this.root,"tars",...o,i),S=p.toString(),P=this.ongoingReqests.get(S);if(he.log(`Geting .tar for ${a}`),P)return P;const k=(async()=>{const I=this.getTarFromMemory(S);if(I)return he.log(`Got .tar from memory in ${w()}`),I;let $=await this.getTarFromDisk(p);if(($==null?void 0:$.length)?he.log(`Got .tar.gz from disk in ${w()}`):($=await this.getTarFromNetwork(t,r),he.log(`Got .tar.gz from network in ${w()}`),s.workspace.fs.writeFile(p,$).then(()=>he.debug(`Sucessfully wrote tarball to disk in ${w()}`),Z=>he.error(Z,`Error writing tarball to disk in ${w()}`))),!$||!$.length)throw Error("Internal Error: Invalid search index. Try deleting repository data and running search again: `RemoteHub: Delete Local Repository Data...`");const B=id("unzip",()=>ed($)),q=id("readTar",()=>(0,Um.t9)(B));return q.entries=q.entries.filter(Z=>{var K;return((K=Z.header.typeFlag)==null?void 0:K.name)==="Normal"}),q.entries.forEach(Z=>{Z.header.fullFileName=Z.header.fullFileName.replace(/^[^/]+/,"")}),this.lastReadValue=new N0(q,Number(Date.now())-c),this.lastReadKey=S,q})();return k.finally(()=>(this.ongoingReqests.delete(S),this.markCacheEntryUsed(`${a}`).catch(I=>he.log(`Error marking entry used: ${I}`)))).finally(()=>this.cleanUpCache().catch(I=>he.log(`Error cleaning cache: ${I}`))),this.ongoingReqests.set(S,k),k}async readDir(t){try{return(await s.workspace.fs.readDirectory(t)).map(r=>s.Uri.joinPath(t,r[0]))}catch{return[]}}async listTars(){const t=await this.readDir(s.Uri.joinPath(this.root,"tars")).catch(()=>[]),r=(await Promise.all(t.map(i=>this.readDir(i)))).flat(),n=(await Promise.all(r.map(i=>this.readDir(i)))).flat();return Promise.all(n.map(async i=>({name:i.path.replace(/^.*\/tars\//,""),path:i,size:(await s.workspace.fs.stat(i)).size})))}async markCacheEntryUsed(t){let r;try{r=JSON.parse(td.decode(await s.workspace.fs.readFile(this.usageFile)))}catch(n){he.log("Error reading usage data.",n),r={}}r[t]=Number(Date.now()),await s.workspace.fs.writeFile(this.usageFile,rd.encode(JSON.stringify(r)))}async cleanUpCache(){var t,r;he.log("Cleaning up search cache...");const n=await this.listTars();let i;try{i=JSON.parse(td.decode(await s.workspace.fs.readFile(this.usageFile)))}catch(P){he.log("Error reading usage data. All existing indexes will be discarded.",P),i={}}const o=[];n.forEach(P=>{var k;const I=/^([^/]*\/[^/]*)\//.exec(P.name);if(!I)throw Error("Unexpected repo entry");const $=I[1],B=(k=i[P.name])!=null?k:0;o.push({...P,lastUsed:B,repo:$})}),o.sort((P,k)=>k.lastUsed-P.lastUsed);let a=0;const c=[],w=new Map,p=(t=He.get("search.download.sizeLimit"))!=null?t:100,S=(r=He.get("search.download.repoLimit"))!=null?r:4;o.forEach(P=>{var k,I;(P.lastUsed===0||a>p||((k=w.get(P.repo))!=null?k:0)>S)&&c.push(P),a+=P.size,w.set(P.repo,((I=w.get(P.repo))!=null?I:0)+1)}),await Promise.all(c.map(async P=>{await s.workspace.fs.delete(P.path),delete i[P.name],he.log(`Deleted cache entry for ${P.name}`)})),await s.workspace.fs.writeFile(this.usageFile,rd.encode(JSON.stringify(i))),await this.updateHasIndexesContext()}}async function nd(e,t,r,n,i,o,a){return Ls("provideTextSearchResults",async()=>{const c=Lm(n.pattern,Boolean(n.isRegExp),{matchCase:n.isCaseSensitive,wholeWord:n.isWordMatch,multiline:n.isMultiline,global:!0}),w=await Ls("fetch tarball",async()=>s.window.withProgress({location:s.ProgressLocation.Window},q=>(q.report({message:"Fetching index..."}),r.getTar(e,i.folder))));if(a.isCancellationRequested)return{limitHit:!1};const{maxResults:p,maxFileSize:S,includes:P,excludes:k}=i,I=await L0(e.getVirtualUri(i.folder),w,t);if(a.isCancellationRequested)return{limitHit:!0};let $=p;const B=$m(I,P,k,S);return Ls("searchFiles",async()=>{var q,Z;let K=0;for(const re of I){if(!B.has(re.path))continue;const ee=Mm(re.contents,re.path,c,{beforeContext:(q=i.beforeContext)!=null?q:0,afterContext:(Z=i.afterContext)!=null?Z:0,previewOptions:i.previewOptions,remainingResultQuota:$});for(const se of ee)o.report({...se,uri:s.Uri.joinPath(i.folder,se.uri.path)});if($-=ee.length,$<=0)return{limitHit:!0};if(K++,K%1e4==0&&(await new Promise(se=>setTimeout(se,0)),a.isCancellationRequested))return{limitHit:!1}}return{limitHit:!1}})})}async function L0(e,t,r){const n=t.entries,i=await r.getChanges(e,{predicate:p=>p.fileType===s.FileType.File});if(i.length===0)return n.map(p=>({contents:p.dataAsBytes,path:p.header.fullFileName,size:p.dataAsBytes.byteLength}));const o=await Promise.all(In(i,p=>{if(p.type===Be.Created)return r.getContent(p.uri).then(S=>({path:p.uri.path,size:S.length,contents:S}))})),a=await Promise.all(In(i,p=>{if(p.type===Be.Changed)return r.getContent(p.uri).then(S=>({path:p.uri.path,size:S.length,contents:S}))})),c=new Set(Og(An(a,p=>p.path),In(i,p=>{if(p.type===Be.Deleted)return p.uri.path})));return[...In(n,p=>{if(!c.has(p.header.fullFileName))return{contents:p.dataAsBytes,path:p.header.fullFileName,size:p.dataAsBytes.byteLength}}),...o,...a]}function id(e,t){const r=Date.now(),n=t();return he.log(`${e} time: ${Date.now()-r}`),n}async function Ls(e,t){const r=Date.now(),n=await t();return he.log(`${e} time: ${Date.now()-r}`),n}const $s=(0,E.LV)(),$0={dispose:()=>{}},M0=/(\/|\\)/g,Bi=class{constructor(e,t,r,n){this.providerService=e,this.azdo=t,this.changeStore=r,this.tarPit=n,this._onDidChangeFile=new s.EventEmitter,this.fsCache=new Map,this.fileSearchCache=new Map,this.pathTypeMap={},this.disposable=s.Disposable.from(s.workspace.registerFileSystemProvider(Bi.scheme,this,{isCaseSensitive:!0,isReadonly:!0}),s.workspace.registerFileSearchProvider(Bi.scheme,this),s.workspace.registerTextSearchProvider(Bi.scheme,this),e.onDidChangeRepository(({repository:i})=>{this.fsCache.clear(),this.updateOpenDocuments([e.getProviderUri(i.uri)])}),e.onDidRefresh(i=>this.updateOpenDocuments(i)))}get onDidChangeFile(){return this._onDidChangeFile.event}dispose(){var e;(e=this.disposable)==null||e.dispose()}getCache(e){return this.fsCache}updateOpenDocuments(e){const t=this.providerService.getOpenUris(Bi.scheme,e);if(t.length===0)return;const r=t.map(n=>({type:s.FileChangeType.Changed,uri:n}));this._onDidChangeFile.fire(r)}watch(){return $0}async stat(e){const t=await this.providerService.getMetadata(e);if(!t.path)return{type:s.FileType.Directory,mtime:0,ctime:0,size:0};if(t.path in this.pathTypeMap||await this.updateWorkspaceItemMap(t,!0),t.path in this.pathTypeMap)return this.pathTypeMap[t.path]===s.FileType.Directory?{type:s.FileType.Directory,mtime:0,ctime:0,size:0}:{type:s.FileType.File,mtime:0,ctime:0,size:0};throw s.FileSystemError.FileNotFound()}async updateWorkspaceItemMap(e,t){const r=new Array,n=await this.azdo.getRepoItems(e);for(const i of n){const o=i.path.substring(1);if(o!==e.path||t){const a=i.isFolder===!0?s.FileType.Directory:s.FileType.File;this.pathTypeMap[o]=a,r.push([o,a])}}return r}async readDirectory(e){const t=await this.providerService.getMetadata(e);return this.updateWorkspaceItemMap(t,!1)}createDirectory(e){throw s.FileSystemError.NoPermissions()}async readFile(e){return await this.azdo.getFileContent(e)}writeFile(e,t,r){throw s.FileSystemError.NoPermissions()}delete(e,t){throw s.FileSystemError.NoPermissions()}rename(e,t,r){throw s.FileSystemError.NoPermissions()}copy(e,t,r){throw s.FileSystemError.NoPermissions()}async provideFileSearchResults(e,t,r){let n=this.fileSearchCache.get(t.folder.toString(!0));if(n===void 0){const o=await this.azdo.getRepoFileNames(t.folder);if(o===void 0||r.isCancellationRequested)return[];n=[...An(o,a=>Mn.prepareSlow(a))],this.fileSearchCache.set(t.folder.toString(!0),n)}if(t.maxResults===void 0||t.maxResults===0||t.maxResults>=n.length)return n.map(a=>s.Uri.joinPath(t.folder,a.target));const i=Mn.go(e.pattern.replace(M0,"/"),n,{allowTypo:!0,limit:t.maxResults}).map(o=>s.Uri.joinPath(t.folder,o.target));return Mn.cleanup(),i}async provideTextSearchResults(e,t,r,n){const i=[];if(He.get("search.download.enabled"))try{return nd(this.providerService,this.changeStore,this.tarPit,e,t,r,n)}catch{i.push({text:$s("index error","Error searching with index, falling back to standard search"),type:s.TextSearchCompleteMessageType.Warning})}i.push({text:$s("enable index","To improve search accuracy, [enable indexing](command:remoteHub.enableIndexing)"),type:s.TextSearchCompleteMessageType.Information,trusted:!0}),(e.isCaseSensitive||e.isRegExp||e.isWordMatch)&&i.push({text:$s("flags not supported","Search flags are not supported by GitHub search. Enable indexing for full search features."),type:s.TextSearchCompleteMessageType.Warning});const o=await this.azdo.searchCodeQuery(e.pattern,t.folder,{maxResults:t.maxResults,context:{before:t.beforeContext,after:t.afterContext}});if(o.warnings&&o.warnings.forEach(c=>{i.push({text:c,type:s.TextSearchCompleteMessageType.Warning})}),o===void 0)return{limitHit:!0,message:i};let a;for(const c of o.matches)a=s.Uri.joinPath(t.folder,c.path),r.report({uri:a,ranges:c.ranges,preview:{text:c.preview,matches:c.matches}});return{limitHit:!1,message:i}}async fsQuery(e,t,r){const n=`${be(e)}:${U0(t)}`;let i=r==null?void 0:r.get(n);return i!==void 0||(i=await this.azdo.queryRepositoryObject(e,t),i===void 0?r==null||r.delete(n):r==null||r.set(n,i)),i}};let od=Bi;od.scheme="azdo";function U0(e){let t=0;if(e.length===0)return t;let r;const n=e.length;for(let i=0;i<n;i++)r=e.charCodeAt(i),t=(t<<5)-t+r,t|=0;return t}var H0=ze(9669),B0=ze.n(H0);const Ms=class{constructor(e){this.storageService=e,this._onDidChange=new s.EventEmitter,this.cache=new Map}get onDidChange(){return this._onDidChange.event}async delete(e){const t=be(e),r=this.cache.has(t);this.cache.delete(t);try{await this.storageService.delete(this.getStorageKey(t))}catch(n){throw he.error(n,`Failed to delete repository metadata for ${t}`),n}!r||this._onDidChange.fire(e)}async get(e){this.assertMatchingScheme(e);const t=be(e),r=this.cache.get(t);if(r!==void 0)return r;let n;try{n=this.fromStorage(await this.storageService.get(this.getStorageKey(t)))}catch(i){throw he.error(i,`Failed to get repository metadata for ${t}`),i}return n?this.cache.set(t,{revision:n}):this.cache.delete(t),{revision:n}}async set(e,t,r){this.assertMatchingScheme(e);const n=be(e);if(r!==void 0&&!this.validate(r))throw new Error(`Metadata validation failed for ${e.toString()}`);const i={revision:t,cachedMetadata:r};this.cache.set(n,i);try{await this.storageService.store(this.getStorageKey(n),this.toStorage(t))}catch(o){throw this.cache.delete(n),he.error(o,`Failed to save repository metadata for ${n}`),o}this._onDidChange.fire(e)}refresh(){this.cache.clear()}validate(e){var t,r,n,i,o,a,c,w;return typeof e.version=="number"&&e.version>=Ms.schemaVersion&&typeof e.timestamp=="number"&&typeof((t=e.provider)==null?void 0:t.id)=="string"&&typeof e.provider.name=="string"&&typeof e.name=="string"&&e.repo&&typeof e.user=="string"&&typeof e.accessLevel=="number"&&typeof((r=e.HEAD)==null?void 0:r.type)=="number"&&typeof((n=e.HEAD)==null?void 0:n.name)=="string"&&typeof((i=e.HEAD)==null?void 0:i.sha)=="string"&&(typeof((o=e.HEAD.detached)==null?void 0:o.name)=="string"&&typeof((a=e.HEAD.detached)==null?void 0:a.type)=="number"||typeof((c=e.HEAD.branch)==null?void 0:c.name)=="string")&&typeof((w=e.defaultBranch)==null?void 0:w.name)=="string"&&typeof e.defaultBranch.sha=="string"}assertMatchingScheme(e){if(e.scheme!==Je.scheme)throw new Error(`Uri scheme '${e.scheme}' must match configured scheme '${Je.scheme}'; uri=${e.toString()}`)}getStorageKey(e){return`metadata/${e}`}fromStorage(e){if(!e)return;const t=JSON.parse(e,(r,n)=>(r==="uri"||r.endsWith("Uri"))&&n!==null?s.Uri.from(n):n);return t==null?void 0:t.revision}toStorage(e){const t={schemaVersion:Ms.storageSchemaVersion,revision:e};return JSON.stringify(t)}};let ji=Ms;ji.schemaVersion=6,ji.storageSchemaVersion=1;var xt;(function(e){e[e.Admin=100]="Admin",e[e.Maintain=40]="Maintain",e[e.Write=30]="Write",e[e.Triage=20]="Triage",e[e.Read=10]="Read",e[e.None=0]="None"})(xt||(xt={}));var nt;(function(e){e[e.Branch=0]="Branch",e[e.Tag=1]="Tag",e[e.Commit=2]="Commit"})(nt||(nt={}));const j0=/^[0-9a-f]{40}$/i;function ad(e){return e!==void 0&&j0.test(e)}const z0=/^[^/](?!.*\/\.)(?!.*\.\.)(?!.*\/\/)(?!.*@\{)[^\000-\037\177 ~^:?*[\\]+[^./]$/;function q0(e){return z0.test(e)}function wt(e){return e===""||e==="~"||e==="HEAD"?e:e.endsWith("^")?`${e.substr(0,7)}^`:e.substr(0,7)}const Kt=(0,E.LV)(),W0=/^https:\/\/([^.]+)\.visualstudio\.com(?:\/defaultcollection)?\/([^/]+)?\/?(?:[^/]+)?\/?(?:\/pullrequest\/(?:\d+))?(?:\/commit\/?([^/^?]+))?\/?/i,sd=/^https:\/\/dev\.azure\.com(?:\/defaultcollection)?\/([^/]+)?\/?([^/]+)?\/?(?:_git)?\/?([^/]+)?\/?(?:\/pullrequest\/(?:\d+))?(?:\/commit\/?([^/^?]+))?\/?/i,cd=1;function qn(e){const{scheme:t,metadata:r}=Je.decodeAuthority(e),[,n,i,o,...a]=e.path.split("/");return{scheme:t,repo:{owner:n,project:i,name:o},path:a.join("/")||"",ref:r==null?void 0:r.ref,idx:r==null?void 0:r.idx}}function V0(e,t){const{repo:r}=t!=null?t:qn(e);return e.with({path:`/${r.owner}/${r.project}/${r.name}`})}function O_(e,t,r){const{repo:{owner:n,name:i}}=e instanceof Uri?qn(e):e;return Uri.parse(`azdo://${VirtualProviderService.encodeAuthority("azdo",{v:cd,ref:{type:RepositoryRefType.Commit,id:t}})}/${n}/${i}/${r}`)}class G0{constructor(t){this.providerService=t}dispose(){}canOpenRemoteUrl(t){const r=W0.exec(t),n=sd.exec(t);if(r){const[,,,i,,o,,a,,c]=r;switch(i||o||a||c){case"pull":break;case"blob":return lt.File;case"tree":return lt.Branch;case"commit":return lt.Commit;default:return lt.Repository}}else if(n){const[,,,i,,o,,a,,c]=n;switch(i||o||a||c){case"pull":break;case"blob":return lt.File;case"tree":return lt.Branch;case"commit":return lt.Commit;default:return lt.Repository}}}async createWorkspaceForRemoteUrl(t,r=rt.CurrentWindow){const n=sd.exec(t);if(!n)return;const[,i,o,a,c,w,p,S,P,k,I,$]=n,B=c||p||P||I;let q=w||S||k||$||void 0;if(B==="pull")return this.createWorkspaceForPullRequest(r,i,o,a,q);let Z;if(B==="blob"){const ee=this.createVirtualUri(Je.baseVirtualWorkspaceUri,{repo:{owner:i,project:o,name:a}});if(Z=q,q=void 0,Z){const Se=(await this.providerService.getBranches(ee,{query:Z.split("/")[0]})).branches.map(me=>`${me.name}/`).sort((me,Te)=>Te.length-me.length);for(const me of Se)if(Z.startsWith(me)){q=me.slice(0,-1),Z=Z.substr(q.length);break}}}const K=this.providerService.createVirtualUri("azdo",{repo:{owner:i,project:o,name:a}});return{name:(await this.providerService.getMetadata(K)).name,uri:K,location:r,filesToOpen:Z?[Z]:void 0}}async createWorkspaceForPullRequest(t,r,n,i,o){var a,c,w,p;const S=await this.providerService.getPullRequest(this.providerService.createVirtualUri("azdo",{repo:{owner:r,project:n,name:i}}),o);let P;if(S)if((c=(a=S.refs)==null?void 0:a.head)==null?void 0:c.exists)P=this.providerService.createVirtualUri("azdo",{repo:{owner:S.refs.head.owner,project:S.refs.head.repo,name:S.refs.head.repo},ref:{type:We.PullRequest,id:S.id}});else if((p=(w=S.refs)==null?void 0:w.base)==null?void 0:p.exists){const k=Kt("pr source branch missing prompt confirm","Open Respository"),I=Kt("pr source branch missing prompt cancel","Cancel");if(await s.window.showInformationMessage(Kt("pr source branch missing prompt",`Unable to find the source branch for pull request #{0}.

Do you want to open the repository on the target branch instead?`,S.id),k,I)!==k)return;P=this.providerService.createVirtualUri("azdo",{repo:{owner:S.refs.base.owner,project:S.refs.base.owner,name:S.refs.base.repo},ref:{type:We.PullRequest,id:S.id}})}else{const k=Kt("pr branches missing prompt confirm","Open Respository"),I=Kt("pr branches missing prompt cancel","Cancel");if(await s.window.showInformationMessage(Kt("pr branches missing prompt",`Unable to find either the source or target branch for pull request #{0}.

Do you want to open the repository on the default branch instead?`,S.id),k,I)!==k)return;P=this.providerService.createVirtualUri("azdo",{repo:{owner:r,project:n,name:i}})}else{const k=Kt("pr missing prompt confirm","Open Respository"),I=Kt("pr missing prompt cancel","Cancel");if(await s.window.showInformationMessage(Kt("pr missing prompt",`Unable to find pull request.

Do you want to open the repository on the default branch instead?`),k,I)!==k)return;P=this.providerService.createVirtualUri("azdo",{repo:{owner:r,project:n,name:i}})}return{name:`${r}/${i}`,uri:P,location:t}}createVirtualUri(t,{repo:r,ref:n},i){if((n==null?void 0:n.type)===We.Tree)throw new Error(`Invalid ref type '${n.type}'`);const o=n?{v:cd,ref:{type:n.type,id:n.id}}:void 0;return t.with({authority:Je.encodeAuthority("azdo",o),path:`/${r.owner}/${r.project}/${r.name}${(i==null?void 0:i.startsWith("/"))?i:i?`/${i}`:""}`})}getRepositoryDescriptor(t){return qn(t).repo}getExternalUri(t){const r=`https://dev.azure.com/${t.repo.owner}/${t.repo.project}/_git/${t.repo.name}`;return s.Uri.parse(r)}getProviderRootUri(t){return V0(t)}getRelativeFilePath(t,r){const{path:n}=qn(ja(t,r));return n}async createMetadata(t,r){var n,i,o,a;let{repo:{owner:c,project:w,name:p},ref:S}=qn(t);(!S||S.type===We.Commit&&/HEAD/i.test(S.id))&&(S={type:We.Commit,id:"HEAD"});const P=await this.getRepositoryInfo(c,w,p,S.type===We.PullRequest?{ref:"HEAD",pr:Number(S.id)}:{ref:S.id});if(P===void 0)throw new Error(`Cannot get metadata for Uri(${t.toString(!0)}); Unable to get repository info`);let k;if(r)k=r;else if(S.type===We.Commit)k=S.id;else if(k=(i=(n=P.ref)==null?void 0:n.sha)!=null?i:P.defaultBranch.sha,k===void 0)throw new Error(`Cannot get metadata for Uri(${t.toString(!0)}); Unable to get repository info`);let I;return((o=P.ref)==null?void 0:o.prefix)==="refs/heads/"?I={type:nt.Branch,name:P.ref.name,sha:k,branch:{name:P.ref.name,sha:P.ref.sha}}:((a=P.ref)==null?void 0:a.prefix)==="refs/tags/"?I={type:nt.Tag,name:P.ref.name,sha:k,detached:{type:nt.Tag,name:P.ref.name}}:I={type:nt.Commit,name:wt(k),sha:k,detached:{type:nt.Commit,name:wt(k)}},{version:ji.schemaVersion,timestamp:Date.now(),provider:{id:"azdo",name:"Azure Repos"},name:`${P.repo.owner}/${P.repo.name}`,repo:P.repo,user:P.user,accessLevel:P.accessLevel,HEAD:I,defaultBranch:P.defaultBranch,pullRequest:P.pullRequest}}getMetadata(t){return this.providerService.getMetadata(t)}getRemoteWorkspaceSourceProviders(){return[{name:"Azure Repos",icon:"$(rocket)",label:Kt("open repo from","Open Repository from {0}","Azure Repos"),placeholder:Kt("pick repo","Choose a repository"),provideSources:async(t,r)=>(await this.searchRepositoriesQuery(t!=null?t:"",r)).map(i=>({name:i.repoWithOwner,icon:"$(repo)",description:`${i.fork?i.fork:""}${i.stars>0?`${i.fork?" \u2022 ":""}$(star-full) ${i.stars}`:""}`,detail:i.description,url:i.url}))}]}async createBranch(t,r,n,i){return"TestBranch"}async createCommit(t,r,n,i){throw new Error}async createPullRequest(t,r,n,i,o){throw new Error}async fetch(t,r){const[n,i]=await this.fetchCore(t,{...r,sync:!1});n&&await this.providerService.updateMetadata(t,i)}async fetchCore(t,r){const n=await this.getMetadata(t);return[!1,n]}async fork(t){throw new Error}async getBranches(t,r){return{branches:[]}}async getCommit(t,r){const n={oid:"123",message:"Hey there!",parents:{nodes:[{oid:"231"}]},author:{name:"you",date:"today",email:""},committer:{name:"you",date:"today"}};return{hash:n.oid,message:n.message,parents:n.parents.nodes.map(i=>i.oid),authorDate:new Date(n.author.date),authorEmail:n.author.email,authorName:n.author.name,commitDate:new Date(n.committer.date)}}async getCommits(t,r){try{throw new Error}catch(n){return}}async getFileContent(t,r,n){try{const i=await this.providerService.getMetadata(t),o=i.repo;let a=`https://dev.azure.com/${o.owner}/${o.project}/_apis/git/repositories/${o.name}/items?api-version=6.0`;i.path&&(a=`${a}&path=${i.path}&includeContent=true`);const c=await Wn(a);return(c==null?void 0:c.content)?new TextEncoder().encode(c.content):new TextEncoder().encode("404: Unable to retrieve content")}catch(i){throw he.error(i),i}}async getFork(t){throw new Error}async getIncomingChanges(t){return this.getIncomingChangesCore(t,await this.getMetadata(t))}getIncomingChangesCore(t,r){var n,i,o;return((o=(i=(n=r.state)==null?void 0:n.incomingChanges)==null?void 0:i.length)!=null?o:0)===0?[]:r.state.incomingChanges.map(a=>({uri:s.Uri.joinPath(t,a.path),type:a.type}))}async getObjectDetails(t,r,n){throw new Error}async getPullRequest(t,r){throw new Error}async getPullRequestForBranch(t,r,n){throw new Error}async getRepoItems(t){const r=await Wn(`https://dev.azure.com/${t.repo.owner}/${t.repo.project}/_apis/git/repositories/${t.repo.name}/items?api-version=6.0&scopePath=${t.path}&recursionLevel=1&includeContentMetadata=true&$format=json`);return r==null?void 0:r.value}async getRepoFileNames(t){try{const r=await this.providerService.getMetadata(t),n=await this.getRepoItems(r);return In(n,i=>i.isFolder?void 0:i.path.substr(1))}catch(r){return[]}}async getTags(t,r){return{tags:[]}}async getTarGz(t){throw new Error}async pushCommit(t,r,n,i){throw new Error}async queryRepositoryObject(t,r){}async searchPullRequestsQuery(t){return[]}async searchRepositoriesQuery(t,r){try{const n=await Wn("https://dev.azure.com/homitc/AzDODemo/_apis/git/repositories?api-version=6.0");return n==null?void 0:n.value.map(i=>({repoWithOwner:i.name,description:void 0,url:i.webUrl,fork:void 0,stars:0}))}catch(n){return[]}}async searchCodeQuery(t,r,n){return{matches:[],limitHit:!0}}async switchTo(t,r,n){const{name:i,repo:o,HEAD:{branch:a}}=await this.getMetadata(t);if(!(r!==void 0&&(r.startsWith("refs/heads/")?r=r.substr(11):r.startsWith("refs/tags/")&&(r=r.substr(10)),(a==null?void 0:a.name)===r)))return{name:i,uri:void 0,location:(n==null?void 0:n.openInNewWindow)?rt.NewWindow:rt.CurrentWindow}}async sync(t,r,n){}async getRepositoryInfo(t,r,n,i){const o=`https://dev.azure.com/${t}/${r}/_apis/git/repositories/${n}?api-version=6.0`,a=await Wn(o);if(!a)return;if(i={ref:a.defaultBranch.split("/").pop()},i.ref){if(ad(i.ref))throw new Error("Not supported yet :(");{const w=`https://dev.azure.com/${t}/${r}/_apis/git/repositories/${n}/stats/branches?name=${i.ref}&api-version=6.0`,p=await Wn(w);let S;if(i.ref===a.defaultBranch)S=p;else{const P=`https://dev.azure.com/${t}/${r}/_apis/git/repositories/${n}/stats/branches?name=${i.ref}&api-version=6.0`;S=await Wn(P)}if(S){const P={user:"jepetty",repo:{owner:t,project:r,name:n},repoId:a.id,accessLevel:xt.Admin,defaultBranch:{name:i.ref,sha:S==null?void 0:S.commit.commitId}};return p&&(P.ref={name:p.name,sha:p.commit.commitId,prefix:"refs/heads/"}),P}}}else throw new Error("Not supported yet :(")}}var mn;(function(e){e.ADMIN="ADMIN",e.MAINTAIN="MAINTAIN",e.WRITE="WRITE",e.TRIAGE="TRIAGE",e.READ="READ",e.NONE="NONE"})(mn||(mn={}));function N_(e){switch(e){case mn.ADMIN:return AccessLevel.Admin;case mn.MAINTAIN:return AccessLevel.Maintain;case mn.WRITE:return AccessLevel.Write;case mn.TRIAGE:return AccessLevel.Triage;case mn.READ:return AccessLevel.Read;default:return AccessLevel.None}}async function F_(e,t,r){const{repo:n}=r!=null?r:qn(t);return t.with({path:`/${n.organization}/${n.project}/_git/${n.name}`})}async function Wn(e,t){const r=s.Uri.parse(e);return K0(e)}async function L_(e,t){let r=Uri.parse(e);const n=new URLSearchParams(r.query);return n.set("api-version","5.1"),r=r.with({query:n.toString()}),Q0(r.toString(),t)}async function K0(e,t){const r=await B0().get(e,t);if(r.status!==404)return r.data}async function Q0(e,t,r){return(await axios.post(e,r,t)).data}class $_{dispose(){}}class Z0{constructor(t){this.providerService=t,this.providers=[],this.handledRepositories=new Set,this.services=new Map,this.disposable=s.Disposable.from(t.onDidChangeRepositories(r=>{for(const n of r.added)this.repositoryOpened(n);for(const n of r.removed)this.repositoryClosed(n)}));for(const r of this.providerService.repositories)this.repositoryOpened(r)}dispose(){this.disposable.dispose()}register(t){const r=this.providers.length;return this.providers.push(t),{dispose:()=>this.providers.splice(r,1)}}async repositoryOpened(t){const r=be(t.uri);if(!this.handledRepositories.has(r)){this.handledRepositories.add(r);for(const n of this.providers){const i=await n.createNavigationService(this.providerService,t);if(i!==void 0){const o=i();this.services.set(r,{service:o});break}}}}repositoryClosed(t){const r=be(t.uri);this.handledRepositories.delete(r);const n=this.services.get(r);n!==void 0&&(n.service.dispose(),this.services.delete(be(t.uri)))}}/*! (c) Andrea Giammarchi - ISC */var Uo={};try{(function(e,t){if(new e("q=%2B").get("q")!==t||new e({q:t}).get("q")!==t||new e([["q",t]]).get("q")!==t||new e(`q=
`).toString()!=="q=%0A"||new e({q:" &"}).toString()!=="q=+%26"||new e({q:"%zx"}).toString()!=="q=%25zx")throw e;Uo.URLSearchParams=e})(URLSearchParams,"+")}catch(e){(function(t,r,n){"use strict";var i=t.create,o=t.defineProperty,a=/[!'\(\)~]|%20|%00/g,c=/%(?![0-9a-fA-F]{2})/g,w=/\+/g,p={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"},S={append:function(K,re){$(this._ungap,K,re)},delete:function(K){delete this._ungap[K]},get:function(K){return this.has(K)?this._ungap[K][0]:null},getAll:function(K){return this.has(K)?this._ungap[K].slice(0):[]},has:function(K){return K in this._ungap},set:function(K,re){this._ungap[K]=[r(re)]},forEach:function(K,re){var ee=this;for(var se in ee._ungap)ee._ungap[se].forEach(Se,se);function Se(me){K.call(re,me,r(se),ee)}},toJSON:function(){return{}},toString:function(){var K=[];for(var re in this._ungap)for(var ee=q(re),se=0,Se=this._ungap[re];se<Se.length;se++)K.push(ee+"="+q(Se[se]));return K.join("&")}};for(var P in S)o(k.prototype,P,{configurable:!0,writable:!0,value:S[P]});Uo.URLSearchParams=k;function k(K){var re=i(null);switch(o(this,"_ungap",{value:re}),!0){case!K:break;case typeof K=="string":K.charAt(0)==="?"&&(K=K.slice(1));for(var ee=K.split("&"),se=0,Se=ee.length;se<Se;se++){var me=ee[se],Te=me.indexOf("=");-1<Te?$(re,B(me.slice(0,Te)),B(me.slice(Te+1))):me.length&&$(re,B(me),"")}break;case n(K):for(var se=0,Se=K.length;se<Se;se++){var me=K[se];$(re,me[0],me[1])}break;case"forEach"in K:K.forEach(I,re);break;default:for(var Oe in K)$(re,Oe,K[Oe])}}function I(K,re){$(this,re,K)}function $(K,re,ee){var se=n(ee)?ee.join(","):ee;re in K?K[re].push(se):K[re]=[se]}function B(K){return decodeURIComponent(K.replace(c,"%25").replace(w," "))}function q(K){return encodeURIComponent(K).replace(a,Z)}function Z(K){return p[K]}})(Object,String,Array.isArray)}(function(e){var t=!1;try{t=!!Symbol.iterator}catch(n){}"forEach"in e||(e.forEach=function(i,o){var a=this,c=Object.create(null);this.toString().replace(/=[\s\S]*?(?:&|$)/g,"=").split("=").forEach(function(w){!w.length||w in c||(c[w]=a.getAll(w)).forEach(function(p){i.call(o,p,w,a)})})}),"keys"in e||(e.keys=function(){return r(this,function(i,o){this.push(o)})}),"values"in e||(e.values=function(){return r(this,function(i,o){this.push(i)})}),"entries"in e||(e.entries=function(){return r(this,function(i,o){this.push([o,i])})}),t&&!(Symbol.iterator in e)&&(e[Symbol.iterator]=e.entries),"sort"in e||(e.sort=function(){for(var i=this.entries(),o=i.next(),a=o.done,c=[],w=Object.create(null),p,S,P;!a;)P=o.value,S=P[0],c.push(S),S in w||(w[S]=[]),w[S].push(P[1]),o=i.next(),a=o.done;for(c.sort(),p=0;p<c.length;p++)this.delete(c[p]);for(p=0;p<c.length;p++)S=c[p],this.append(S,w[S].shift())});function r(n,i){var o=[];return n.forEach(i,o),t?o[Symbol.iterator]():{next:function(){var a=o.shift();return{done:a===void 0,value:a}}}}(function(n){var i=n.defineProperty,o=n.getOwnPropertyDescriptor,a=function(P){function k(B,q){e.append.call(this,B,q),B=this.toString(),P.set.call(this._usp,B?"?"+B:"")}function I(B){e.delete.call(this,B),B=this.toString(),P.set.call(this._usp,B?"?"+B:"")}function $(B,q){e.set.call(this,B,q),B=this.toString(),P.set.call(this._usp,B?"?"+B:"")}return function(B,q){return B.append=k,B.delete=I,B.set=$,i(B,"_usp",{configurable:!0,writable:!0,value:q})}},c=function(P){return function(k,I){return i(k,"_searchParams",{configurable:!0,writable:!0,value:P(I,k)}),I}},w=function(P){var k=P.append;P.append=e.append,URLSearchParams.call(P,P._usp.search.slice(1)),P.append=k},p=function(P,k){if(!(P instanceof k))throw new TypeError("'searchParams' accessed on an object that does not implement interface "+k.name)},S=function(P){var k=P.prototype,I=o(k,"searchParams"),$=o(k,"href"),B=o(k,"search"),q;!I&&B&&B.set&&(q=c(a(B)),n.defineProperties(k,{href:{get:function(){return $.get.call(this)},set:function(Z){var K=this._searchParams;$.set.call(this,Z),K&&w(K)}},search:{get:function(){return B.get.call(this)},set:function(Z){var K=this._searchParams;B.set.call(this,Z),K&&w(K)}},searchParams:{get:function(){return p(this,P),this._searchParams||q(this,new URLSearchParams(this.search.slice(1)))},set:function(Z){p(this,P),q(this,Z)}}}))};try{S(HTMLAnchorElement),/^function|object$/.test(typeof URL)&&URL.prototype&&S(URL)}catch(P){}})(Object)})(Uo.URLSearchParams.prototype,Object);const X0=Uo.URLSearchParams;var vn=ze(8605),ud=ze(7211),Ft=ze(8761),Ye=ze(2413),Y0=ze(5175),Ho=ze(1669),J0=ze(6030);class Bo extends Error{constructor(t,r){super(t);Error.captureStackTrace(this,this.constructor),this.type=r}get name(){return this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}}class Tr extends Bo{constructor(t,r,n){super(t,r);n&&(this.code=this.errno=n.code,this.erroredSysCall=n.syscall)}}var ew=ze(6417);const jo=Symbol.toStringTag,ld=e=>typeof e=="object"&&typeof e.append=="function"&&typeof e.delete=="function"&&typeof e.get=="function"&&typeof e.getAll=="function"&&typeof e.has=="function"&&typeof e.set=="function"&&typeof e.sort=="function"&&e[jo]==="URLSearchParams",Wr=e=>typeof e=="object"&&typeof e.arrayBuffer=="function"&&typeof e.type=="string"&&typeof e.stream=="function"&&typeof e.constructor=="function"&&/^(Blob|File)$/.test(e[jo]);function Us(e){return typeof e=="object"&&typeof e.append=="function"&&typeof e.set=="function"&&typeof e.get=="function"&&typeof e.getAll=="function"&&typeof e.delete=="function"&&typeof e.keys=="function"&&typeof e.values=="function"&&typeof e.entries=="function"&&typeof e.constructor=="function"&&e[jo]==="FormData"}const tw=e=>typeof e=="object"&&e[jo]==="AbortSignal",Vn=`\r
`,Hs="-".repeat(2),rw=Buffer.byteLength(Vn),dd=e=>`${Hs}${e}${Hs}${Vn.repeat(2)}`;function fd(e,t,r){let n="";return n+=`${Hs}${e}${Vn}`,n+=`Content-Disposition: form-data; name="${t}"`,Wr(r)&&(n+=`; filename="${r.name}"${Vn}`,n+=`Content-Type: ${r.type||"application/octet-stream"}`),`${n}${Vn.repeat(2)}`}const nw=()=>(0,ew.randomBytes)(8).toString("hex");async function*iw(e,t){for(const[r,n]of e)yield fd(t,r,n),Wr(n)?yield*n.stream():yield n,yield Vn;yield dd(t)}function ow(e,t){let r=0;for(const[n,i]of e)r+=Buffer.byteLength(fd(t,n,i)),Wr(i)?r+=i.size:r+=Buffer.byteLength(String(i)),r+=rw;return r+=Buffer.byteLength(dd(t)),r}const Lt=Symbol("Body internals");class Bs{constructor(t,{size:r=0}={}){let n=null;t===null?t=null:ld(t)?t=Buffer.from(t.toString()):Wr(t)||Buffer.isBuffer(t)||(Ho.types.isAnyArrayBuffer(t)?t=Buffer.from(t):ArrayBuffer.isView(t)?t=Buffer.from(t.buffer,t.byteOffset,t.byteLength):t instanceof Ye||(Us(t)?(n=`NodeFetchFormDataBoundary${nw()}`,t=Ye.Readable.from(iw(t,n))):t=Buffer.from(String(t)))),this[Lt]={body:t,boundary:n,disturbed:!1,error:null},this.size=r,t instanceof Ye&&t.on("error",i=>{const o=i instanceof Bo?i:new Tr(`Invalid response body while trying to fetch ${this.url}: ${i.message}`,"system",i);this[Lt].error=o})}get body(){return this[Lt].body}get bodyUsed(){return this[Lt].disturbed}async arrayBuffer(){const{buffer:t,byteOffset:r,byteLength:n}=await zo(this);return t.slice(r,r+n)}async blob(){const t=this.headers&&this.headers.get("content-type")||this[Lt].body&&this[Lt].body.type||"",r=await this.buffer();return new J0([r],{type:t})}async json(){const t=await zo(this);return JSON.parse(t.toString())}async text(){return(await zo(this)).toString()}buffer(){return zo(this)}}Object.defineProperties(Bs.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0}});async function zo(e){if(e[Lt].disturbed)throw new TypeError(`body used already for: ${e.url}`);if(e[Lt].disturbed=!0,e[Lt].error)throw e[Lt].error;let{body:t}=e;if(t===null)return Buffer.alloc(0);if(Wr(t)&&(t=t.stream()),Buffer.isBuffer(t))return t;if(!(t instanceof Ye))return Buffer.alloc(0);const r=[];let n=0;try{for await(const i of t){if(e.size>0&&n+i.length>e.size){const o=new Tr(`content size at ${e.url} over limit: ${e.size}`,"max-size");throw t.destroy(o),o}n+=i.length,r.push(i)}}catch(i){throw i instanceof Bo?i:new Tr(`Invalid response body while trying to fetch ${e.url}: ${i.message}`,"system",i)}if(t.readableEnded===!0||t._readableState.ended===!0)try{return r.every(i=>typeof i=="string")?Buffer.from(r.join("")):Buffer.concat(r,n)}catch(i){throw new Tr(`Could not create Buffer from response body for ${e.url}: ${i.message}`,"system",i)}else throw new Tr(`Premature close of server response while trying to fetch ${e.url}`)}const hd=(e,t)=>{let r,n,{body:i}=e;if(e.bodyUsed)throw new Error("cannot clone body after it is used");return i instanceof Ye&&typeof i.getBoundary!="function"&&(r=new Ye.PassThrough({highWaterMark:t}),n=new Ye.PassThrough({highWaterMark:t}),i.pipe(r),i.pipe(n),e[Lt].body=r,i=n),i},pd=(e,t)=>e===null?null:typeof e=="string"?"text/plain;charset=UTF-8":ld(e)?"application/x-www-form-urlencoded;charset=UTF-8":Wr(e)?e.type||null:Buffer.isBuffer(e)||Ho.types.isAnyArrayBuffer(e)||ArrayBuffer.isView(e)?null:e&&typeof e.getBoundary=="function"?`multipart/form-data;boundary=${e.getBoundary()}`:Us(e)?`multipart/form-data; boundary=${t[Lt].boundary}`:e instanceof Ye?null:"text/plain;charset=UTF-8",aw=e=>{const{body:t}=e;return t===null?0:Wr(t)?t.size:Buffer.isBuffer(t)?t.length:t&&typeof t.getLengthSync=="function"?t.hasKnownLength&&t.hasKnownLength()?t.getLengthSync():null:Us(t)?ow(e[Lt].boundary):null},sw=(e,{body:t})=>{t===null?e.end():Wr(t)?t.stream().pipe(e):Buffer.isBuffer(t)?(e.write(t),e.end()):t.pipe(e)},qo=typeof vn.validateHeaderName=="function"?vn.validateHeaderName:e=>{if(!/^[\^`\-\w!#$%&'*+.|~]+$/.test(e)){const t=new TypeError(`Header name must be a valid HTTP token [${e}]`);throw Object.defineProperty(t,"code",{value:"ERR_INVALID_HTTP_TOKEN"}),t}},js=typeof vn.validateHeaderValue=="function"?vn.validateHeaderValue:(e,t)=>{if(/[^\t\u0020-\u007E\u0080-\u00FF]/.test(t)){const r=new TypeError(`Invalid character in header content ["${e}"]`);throw Object.defineProperty(r,"code",{value:"ERR_INVALID_CHAR"}),r}};class Vr extends URLSearchParams{constructor(t){let r=[];if(t instanceof Vr){const n=t.raw();for(const[i,o]of Object.entries(n))r.push(...o.map(a=>[i,a]))}else if(t!=null)if(typeof t=="object"&&!Ho.types.isBoxedPrimitive(t)){const n=t[Symbol.iterator];if(n==null)r.push(...Object.entries(t));else{if(typeof n!="function")throw new TypeError("Header pairs must be iterable");r=[...t].map(i=>{if(typeof i!="object"||Ho.types.isBoxedPrimitive(i))throw new TypeError("Each header pair must be an iterable object");return[...i]}).map(i=>{if(i.length!==2)throw new TypeError("Each header pair must be a name/value tuple");return[...i]})}}else throw new TypeError("Failed to construct 'Headers': The provided value is not of type '(sequence<sequence<ByteString>> or record<ByteString, ByteString>)");return r=r.length>0?r.map(([n,i])=>(qo(n),js(n,String(i)),[String(n).toLowerCase(),String(i)])):void 0,super(r),new Proxy(this,{get(n,i,o){switch(i){case"append":case"set":return(a,c)=>(qo(a),js(a,String(c)),URLSearchParams.prototype[i].call(o,String(a).toLowerCase(),String(c)));case"delete":case"has":case"getAll":return a=>(qo(a),URLSearchParams.prototype[i].call(o,String(a).toLowerCase()));case"keys":return()=>(n.sort(),new Set(URLSearchParams.prototype.keys.call(n)).keys());default:return Reflect.get(n,i,o)}}})}get[Symbol.toStringTag](){return this.constructor.name}toString(){return Object.prototype.toString.call(this)}get(t){const r=this.getAll(t);if(r.length===0)return null;let n=r.join(", ");return/^content-encoding$/i.test(t)&&(n=n.toLowerCase()),n}forEach(t){for(const r of this.keys())t(this.get(r),r)}*values(){for(const t of this.keys())yield this.get(t)}*entries(){for(const t of this.keys())yield[t,this.get(t)]}[Symbol.iterator](){return this.entries()}raw(){return[...this.keys()].reduce((t,r)=>(t[r]=this.getAll(r),t),{})}[Symbol.for("nodejs.util.inspect.custom")](){return[...this.keys()].reduce((t,r)=>{const n=this.getAll(r);return r==="host"?t[r]=n[0]:t[r]=n.length>1?n:n[0],t},{})}}Object.defineProperties(Vr.prototype,["get","entries","forEach","values"].reduce((e,t)=>(e[t]={enumerable:!0},e),{}));function cw(e=[]){return new Vr(e.reduce((t,r,n,i)=>(n%2==0&&t.push(i.slice(n,n+2)),t),[]).filter(([t,r])=>{try{return qo(t),js(t,String(r)),!0}catch{return!1}}))}const uw=new Set([301,302,303,307,308]),gd=e=>uw.has(e),Rr=Symbol("Response internals");class ur extends Bs{constructor(t=null,r={}){super(t,r);const n=r.status||200,i=new Vr(r.headers);if(t!==null&&!i.has("Content-Type")){const o=pd(t);o&&i.append("Content-Type",o)}this[Rr]={url:r.url,status:n,statusText:r.statusText||"",headers:i,counter:r.counter,highWaterMark:r.highWaterMark}}get url(){return this[Rr].url||""}get status(){return this[Rr].status}get ok(){return this[Rr].status>=200&&this[Rr].status<300}get redirected(){return this[Rr].counter>0}get statusText(){return this[Rr].statusText}get headers(){return this[Rr].headers}get highWaterMark(){return this[Rr].highWaterMark}clone(){return new ur(hd(this,this.highWaterMark),{url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected,size:this.size})}static redirect(t,r=302){if(!gd(r))throw new RangeError('Failed to execute "redirect" on "response": Invalid status code');return new ur(null,{headers:{location:new URL(t).toString()},status:r})}get[Symbol.toStringTag](){return"Response"}}Object.defineProperties(ur.prototype,{url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}});var Wo=ze(8835);const lw=e=>{if(e.search)return e.search;const t=e.href.length-1,r=e.hash||(e.href[t]==="#"?"#":"");return e.href[t-r.length]==="?"?"?":""},kr=Symbol("Request internals"),Vo=e=>typeof e=="object"&&typeof e[kr]=="object";class zi extends Bs{constructor(t,r={}){let n;Vo(t)?n=new URL(t.url):(n=new URL(t),t={});let i=r.method||t.method||"GET";if(i=i.toUpperCase(),(r.body!=null||Vo(t))&&t.body!==null&&(i==="GET"||i==="HEAD"))throw new TypeError("Request with GET/HEAD method cannot have body");const o=r.body?r.body:Vo(t)&&t.body!==null?hd(t):null;super(o,{size:r.size||t.size||0});const a=new Vr(r.headers||t.headers||{});if(o!==null&&!a.has("Content-Type")){const w=pd(o,this);w&&a.append("Content-Type",w)}let c=Vo(t)?t.signal:null;if("signal"in r&&(c=r.signal),c!==null&&!tw(c))throw new TypeError("Expected signal to be an instanceof AbortSignal");this[kr]={method:i,redirect:r.redirect||t.redirect||"follow",headers:a,parsedURL:n,signal:c},this.follow=r.follow===void 0?t.follow===void 0?20:t.follow:r.follow,this.compress=r.compress===void 0?t.compress===void 0?!0:t.compress:r.compress,this.counter=r.counter||t.counter||0,this.agent=r.agent||t.agent,this.highWaterMark=r.highWaterMark||t.highWaterMark||16384,this.insecureHTTPParser=r.insecureHTTPParser||t.insecureHTTPParser||!1}get method(){return this[kr].method}get url(){return(0,Wo.format)(this[kr].parsedURL)}get headers(){return this[kr].headers}get redirect(){return this[kr].redirect}get signal(){return this[kr].signal}clone(){return new zi(this)}get[Symbol.toStringTag](){return"Request"}}Object.defineProperties(zi.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0}});const dw=e=>{const{parsedURL:t}=e[kr],r=new Vr(e[kr].headers);r.has("Accept")||r.set("Accept","*/*");let n=null;if(e.body===null&&/^(post|put)$/i.test(e.method)&&(n="0"),e.body!==null){const c=aw(e);typeof c=="number"&&!Number.isNaN(c)&&(n=String(c))}n&&r.set("Content-Length",n),r.has("User-Agent")||r.set("User-Agent","node-fetch"),e.compress&&!r.has("Accept-Encoding")&&r.set("Accept-Encoding","gzip,deflate,br");let{agent:i}=e;typeof i=="function"&&(i=i(t)),!r.has("Connection")&&!i&&r.set("Connection","close");const o=lw(t);return{path:t.pathname+o,pathname:t.pathname,hostname:t.hostname,protocol:t.protocol,port:t.port,hash:t.hash,search:t.search,query:t.query,href:t.href,method:e.method,headers:r[Symbol.for("nodejs.util.inspect.custom")](),insecureHTTPParser:e.insecureHTTPParser,agent:i}};class fw extends Bo{constructor(t,r="aborted"){super(t,r)}}const hw=new Set(["data:","http:","https:"]);async function yn(e,t){return new Promise((r,n)=>{const i=new zi(e,t),o=dw(i);if(!hw.has(o.protocol))throw new TypeError(`node-fetch cannot load ${e}. URL scheme "${o.protocol.replace(/:$/,"")}" is not supported.`);if(o.protocol==="data:"){const I=Y0(i.url),$=new ur(I,{headers:{"Content-Type":I.typeFull}});r($);return}const a=(o.protocol==="https:"?ud:vn).request,{signal:c}=i;let w=null;const p=()=>{const I=new fw("The operation was aborted.");n(I),i.body&&i.body instanceof Ye.Readable&&i.body.destroy(I),!(!w||!w.body)&&w.body.emit("error",I)};if(c&&c.aborted){p();return}const S=()=>{p(),k()},P=a(o);c&&c.addEventListener("abort",S);const k=()=>{P.abort(),c&&c.removeEventListener("abort",S)};P.on("error",I=>{n(new Tr(`request to ${i.url} failed, reason: ${I.message}`,"system",I)),k()}),P.on("response",I=>{P.setTimeout(0);const $=cw(I.rawHeaders);if(gd(I.statusCode)){const re=$.get("Location"),ee=re===null?null:new URL(re,i.url);switch(i.redirect){case"error":n(new Tr(`uri requested responds with a redirect, redirect mode is set to error: ${i.url}`,"no-redirect")),k();return;case"manual":if(ee!==null)try{$.set("Location",ee)}catch(se){n(se)}break;case"follow":{if(ee===null)break;if(i.counter>=i.follow){n(new Tr(`maximum redirect reached at: ${i.url}`,"max-redirect")),k();return}const se={headers:new Vr(i.headers),follow:i.follow,counter:i.counter+1,agent:i.agent,compress:i.compress,method:i.method,body:i.body,signal:i.signal,size:i.size};if(I.statusCode!==303&&i.body&&t.body instanceof Ye.Readable){n(new Tr("Cannot follow redirect with body being a readable stream","unsupported-redirect")),k();return}(I.statusCode===303||(I.statusCode===301||I.statusCode===302)&&i.method==="POST")&&(se.method="GET",se.body=void 0,se.headers.delete("content-length")),r(yn(new zi(ee,se))),k();return}default:}}I.once("end",()=>{c&&c.removeEventListener("abort",S)});let B=(0,Ye.pipeline)(I,new Ye.PassThrough,re=>{n(re)});process.version<"v12.10"&&I.on("aborted",S);const q={url:i.url,status:I.statusCode,statusText:I.statusMessage,headers:$,size:i.size,counter:i.counter,highWaterMark:i.highWaterMark},Z=$.get("Content-Encoding");if(!i.compress||i.method==="HEAD"||Z===null||I.statusCode===204||I.statusCode===304){w=new ur(B,q),r(w);return}const K={flush:Ft.Z_SYNC_FLUSH,finishFlush:Ft.Z_SYNC_FLUSH};if(Z==="gzip"||Z==="x-gzip"){B=(0,Ye.pipeline)(B,Ft.createGunzip(K),re=>{n(re)}),w=new ur(B,q),r(w);return}if(Z==="deflate"||Z==="x-deflate"){(0,Ye.pipeline)(I,new Ye.PassThrough,ee=>{n(ee)}).once("data",ee=>{(ee[0]&15)==8?B=(0,Ye.pipeline)(B,Ft.createInflate(),se=>{n(se)}):B=(0,Ye.pipeline)(B,Ft.createInflateRaw(),se=>{n(se)}),w=new ur(B,q),r(w)});return}if(Z==="br"){B=(0,Ye.pipeline)(B,Ft.createBrotliDecompress(),re=>{n(re)}),w=new ur(B,q),r(w);return}w=new ur(B,q),r(w)}),sw(P,i)})}var md,bt;(function(e){e.None=0,e.First=1,e.AsOld=e.First,e.Last=2,e.AsNew=e.Last})(bt||(bt={}));class pw{constructor(){this[md]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var t;return(t=this._head)==null?void 0:t.value}get last(){var t;return(t=this._tail)==null?void 0:t.value}has(t){return this._map.has(t)}get(t,r=bt.None){const n=this._map.get(t);if(!!n)return r!==bt.None&&this.touch(n,r),n.value}set(t,r,n=bt.None){let i=this._map.get(t);if(i)i.value=r,n!==bt.None&&this.touch(i,n);else{switch(i={key:t,value:r,next:void 0,previous:void 0},n){case bt.None:this.addItemLast(i);break;case bt.First:this.addItemFirst(i);break;case bt.Last:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(t,i),this._size++}return this}delete(t){return Boolean(this.remove(t))}remove(t){const r=this._map.get(t);if(!!r)return this._map.delete(t),this.removeItem(r),this._size--,r.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const t=this._head;return this._map.delete(t.key),this.removeItem(t),this._size--,t.value}forEach(t,r){const n=this._state;let i=this._head;for(;i;){if(r?t.bind(r)(i.value,i.key,this):t(i.value,i.key,this),this._state!==n)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){const t=this._state;let r=this._head;const n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==t)throw new Error("LinkedMap got modified during iteration.");if(r){const i={value:r.key,done:!1};return r=r.next,i}return{value:void 0,done:!0}}};return n}values(){const t=this._state;let r=this._head;const n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==t)throw new Error("LinkedMap got modified during iteration.");if(r){const i={value:r.value,done:!1};return r=r.next,i}return{value:void 0,done:!0}}};return n}entries(){const t=this._state;let r=this._head;const n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==t)throw new Error("LinkedMap got modified during iteration.");if(r){const i={value:[r.key,r.value],done:!1};return r=r.next,i}return{value:void 0,done:!0}}};return n}[(md=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(t){if(t>=this.size)return;if(t===0){this.clear();return}let r=this._head,n=this.size;for(;r&&n>t;)this._map.delete(r.key),r=r.next,n--;this._head=r,this._size=n,r&&(r.previous=void 0),this._state++}addItemFirst(t){if(!this._head&&!this._tail)this._tail=t;else if(this._head)t.next=this._head,this._head.previous=t;else throw new Error("Invalid list");this._head=t,this._state++}addItemLast(t){if(!this._head&&!this._tail)this._head=t;else if(this._tail)t.previous=this._tail,this._tail.next=t;else throw new Error("Invalid list");this._tail=t,this._state++}removeItem(t){if(t===this._head&&t===this._tail)this._head=void 0,this._tail=void 0;else if(t===this._head){if(!t.next)throw new Error("Invalid list");t.next.previous=void 0,this._head=t.next}else if(t===this._tail){if(!t.previous)throw new Error("Invalid list");t.previous.next=void 0,this._tail=t.previous}else{const r=t.next,n=t.previous;if(!r||!n)throw new Error("Invalid list");r.previous=n,n.next=r}t.next=void 0,t.previous=void 0,this._state++}touch(t,r){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(r!==bt.First&&r!==bt.Last)){if(r===bt.First){if(t===this._head)return;const n=t.next,i=t.previous;t===this._tail?(i.next=void 0,this._tail=i):(n.previous=i,i.next=n),t.previous=void 0,t.next=this._head,this._head.previous=t,this._head=t,this._state++}else if(r===bt.Last){if(t===this._tail)return;const n=t.next,i=t.previous;t===this._head?(n.previous=void 0,this._head=n):(n.previous=i,i.next=n),t.next=void 0,t.previous=this._tail,this._tail.next=t,this._tail=t,this._state++}}}toJSON(){const t=[];return this.forEach((r,n)=>{t.push([n,r])}),t}fromJSON(t){this.clear();for(const[r,n]of t)this.set(r,n)}}class gw extends pw{constructor(t,r=1){super();this._limit=t,this._ratio=Math.min(Math.max(0,r),1)}get limit(){return this._limit}set limit(t){this._limit=t,this.checkTrim()}get ratio(){return this._ratio}set ratio(t){this._ratio=Math.min(Math.max(0,t),1),this.checkTrim()}get(t,r=bt.AsNew){return super.get(t,r)}peek(t){return super.get(t,bt.None)}set(t,r){return super.set(t,r,bt.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}var vd;(function(e){e.MIN_VALUE=-2147483648,e.MAX_VALUE=2147483647})(vd||(vd={}));var Go;(function(e){e.MIN_VALUE=0,e.MAX_VALUE=2147483647})(Go||(Go={}));var lr;(function(e){function t(n,i){return n===Number.MAX_VALUE&&(n=Go.MAX_VALUE),i===Number.MAX_VALUE&&(i=Go.MAX_VALUE),{line:n,character:i}}e.create=t;function r(n){var i=n;return ce.objectLiteral(i)&&ce.uinteger(i.line)&&ce.uinteger(i.character)}e.is=r})(lr||(lr={}));var vt;(function(e){function t(n,i,o,a){if(ce.uinteger(n)&&ce.uinteger(i)&&ce.uinteger(o)&&ce.uinteger(a))return{start:lr.create(n,i),end:lr.create(o,a)};if(lr.is(n)&&lr.is(i))return{start:n,end:i};throw new Error("Range#create called with invalid arguments["+n+", "+i+", "+o+", "+a+"]")}e.create=t;function r(n){var i=n;return ce.objectLiteral(i)&&lr.is(i.start)&&lr.is(i.end)}e.is=r})(vt||(vt={}));var zs;(function(e){function t(n,i){return{uri:n,range:i}}e.create=t;function r(n){var i=n;return ce.defined(i)&&vt.is(i.range)&&(ce.string(i.uri)||ce.undefined(i.uri))}e.is=r})(zs||(zs={}));var Ko;(function(e){function t(n,i,o,a){return{targetUri:n,targetRange:i,targetSelectionRange:o,originSelectionRange:a}}e.create=t;function r(n){var i=n;return ce.defined(i)&&vt.is(i.targetRange)&&ce.string(i.targetUri)&&(vt.is(i.targetSelectionRange)||ce.undefined(i.targetSelectionRange))&&(vt.is(i.originSelectionRange)||ce.undefined(i.originSelectionRange))}e.is=r})(Ko||(Ko={}));var qs;(function(e){function t(n,i,o,a){return{red:n,green:i,blue:o,alpha:a}}e.create=t;function r(n){var i=n;return ce.numberRange(i.red,0,1)&&ce.numberRange(i.green,0,1)&&ce.numberRange(i.blue,0,1)&&ce.numberRange(i.alpha,0,1)}e.is=r})(qs||(qs={}));var yd;(function(e){function t(n,i){return{range:n,color:i}}e.create=t;function r(n){var i=n;return vt.is(i.range)&&qs.is(i.color)}e.is=r})(yd||(yd={}));var wd;(function(e){function t(n,i,o){return{label:n,textEdit:i,additionalTextEdits:o}}e.create=t;function r(n){var i=n;return ce.string(i.label)&&(ce.undefined(i.textEdit)||Gr.is(i))&&(ce.undefined(i.additionalTextEdits)||ce.typedArray(i.additionalTextEdits,Gr.is))}e.is=r})(wd||(wd={}));var qi;(function(e){e.Comment="comment",e.Imports="imports",e.Region="region"})(qi||(qi={}));var bd;(function(e){function t(n,i,o,a,c){var w={startLine:n,endLine:i};return ce.defined(o)&&(w.startCharacter=o),ce.defined(a)&&(w.endCharacter=a),ce.defined(c)&&(w.kind=c),w}e.create=t;function r(n){var i=n;return ce.uinteger(i.startLine)&&ce.uinteger(i.startLine)&&(ce.undefined(i.startCharacter)||ce.uinteger(i.startCharacter))&&(ce.undefined(i.endCharacter)||ce.uinteger(i.endCharacter))&&(ce.undefined(i.kind)||ce.string(i.kind))}e.is=r})(bd||(bd={}));var Ws;(function(e){function t(n,i){return{location:n,message:i}}e.create=t;function r(n){var i=n;return ce.defined(i)&&zs.is(i.location)&&ce.string(i.message)}e.is=r})(Ws||(Ws={}));var Gn;(function(e){e.Error=1,e.Warning=2,e.Information=3,e.Hint=4})(Gn||(Gn={}));var Qo;(function(e){e.Unnecessary=1,e.Deprecated=2})(Qo||(Qo={}));var Vs;(function(e){function t(r){var n=r;return n!=null&&ce.string(n.href)}e.is=t})(Vs||(Vs={}));var Zo;(function(e){function t(n,i,o,a,c,w){var p={range:n,message:i};return ce.defined(o)&&(p.severity=o),ce.defined(a)&&(p.code=a),ce.defined(c)&&(p.source=c),ce.defined(w)&&(p.relatedInformation=w),p}e.create=t;function r(n){var i,o=n;return ce.defined(o)&&vt.is(o.range)&&ce.string(o.message)&&(ce.number(o.severity)||ce.undefined(o.severity))&&(ce.integer(o.code)||ce.string(o.code)||ce.undefined(o.code))&&(ce.undefined(o.codeDescription)||ce.string((i=o.codeDescription)===null||i===void 0?void 0:i.href))&&(ce.string(o.source)||ce.undefined(o.source))&&(ce.undefined(o.relatedInformation)||ce.typedArray(o.relatedInformation,Ws.is))}e.is=r})(Zo||(Zo={}));var Wi;(function(e){function t(n,i){for(var o=[],a=2;a<arguments.length;a++)o[a-2]=arguments[a];var c={title:n,command:i};return ce.defined(o)&&o.length>0&&(c.arguments=o),c}e.create=t;function r(n){var i=n;return ce.defined(i)&&ce.string(i.title)&&ce.string(i.command)}e.is=r})(Wi||(Wi={}));var Gr;(function(e){function t(o,a){return{range:o,newText:a}}e.replace=t;function r(o,a){return{range:{start:o,end:o},newText:a}}e.insert=r;function n(o){return{range:o,newText:""}}e.del=n;function i(o){var a=o;return ce.objectLiteral(a)&&ce.string(a.newText)&&vt.is(a.range)}e.is=i})(Gr||(Gr={}));var Kn;(function(e){function t(n,i,o){var a={label:n};return i!==void 0&&(a.needsConfirmation=i),o!==void 0&&(a.description=o),a}e.create=t;function r(n){var i=n;return i!==void 0&&ce.objectLiteral(i)&&ce.string(i.label)&&(ce.boolean(i.needsConfirmation)||i.needsConfirmation===void 0)&&(ce.string(i.description)||i.description===void 0)}e.is=r})(Kn||(Kn={}));var _t;(function(e){function t(r){var n=r;return typeof n=="string"}e.is=t})(_t||(_t={}));var Kr;(function(e){function t(o,a,c){return{range:o,newText:a,annotationId:c}}e.replace=t;function r(o,a,c){return{range:{start:o,end:o},newText:a,annotationId:c}}e.insert=r;function n(o,a){return{range:o,newText:"",annotationId:a}}e.del=n;function i(o){var a=o;return Gr.is(a)&&(Kn.is(a.annotationId)||_t.is(a.annotationId))}e.is=i})(Kr||(Kr={}));var Vi;(function(e){function t(n,i){return{textDocument:n,edits:i}}e.create=t;function r(n){var i=n;return ce.defined(i)&&Yo.is(i.textDocument)&&Array.isArray(i.edits)}e.is=r})(Vi||(Vi={}));var Qn;(function(e){function t(n,i,o){var a={kind:"create",uri:n};return i!==void 0&&(i.overwrite!==void 0||i.ignoreIfExists!==void 0)&&(a.options=i),o!==void 0&&(a.annotationId=o),a}e.create=t;function r(n){var i=n;return i&&i.kind==="create"&&ce.string(i.uri)&&(i.options===void 0||(i.options.overwrite===void 0||ce.boolean(i.options.overwrite))&&(i.options.ignoreIfExists===void 0||ce.boolean(i.options.ignoreIfExists)))&&(i.annotationId===void 0||_t.is(i.annotationId))}e.is=r})(Qn||(Qn={}));var Zn;(function(e){function t(n,i,o,a){var c={kind:"rename",oldUri:n,newUri:i};return o!==void 0&&(o.overwrite!==void 0||o.ignoreIfExists!==void 0)&&(c.options=o),a!==void 0&&(c.annotationId=a),c}e.create=t;function r(n){var i=n;return i&&i.kind==="rename"&&ce.string(i.oldUri)&&ce.string(i.newUri)&&(i.options===void 0||(i.options.overwrite===void 0||ce.boolean(i.options.overwrite))&&(i.options.ignoreIfExists===void 0||ce.boolean(i.options.ignoreIfExists)))&&(i.annotationId===void 0||_t.is(i.annotationId))}e.is=r})(Zn||(Zn={}));var Xn;(function(e){function t(n,i,o){var a={kind:"delete",uri:n};return i!==void 0&&(i.recursive!==void 0||i.ignoreIfNotExists!==void 0)&&(a.options=i),o!==void 0&&(a.annotationId=o),a}e.create=t;function r(n){var i=n;return i&&i.kind==="delete"&&ce.string(i.uri)&&(i.options===void 0||(i.options.recursive===void 0||ce.boolean(i.options.recursive))&&(i.options.ignoreIfNotExists===void 0||ce.boolean(i.options.ignoreIfNotExists)))&&(i.annotationId===void 0||_t.is(i.annotationId))}e.is=r})(Xn||(Xn={}));var Gs;(function(e){function t(r){var n=r;return n&&(n.changes!==void 0||n.documentChanges!==void 0)&&(n.documentChanges===void 0||n.documentChanges.every(function(i){return ce.string(i.kind)?Qn.is(i)||Zn.is(i)||Xn.is(i):Vi.is(i)}))}e.is=t})(Gs||(Gs={}));var Xo=function(){function e(t,r){this.edits=t,this.changeAnnotations=r}return e.prototype.insert=function(t,r,n){var i,o;if(n===void 0?i=Gr.insert(t,r):_t.is(n)?(o=n,i=Kr.insert(t,r,n)):(this.assertChangeAnnotations(this.changeAnnotations),o=this.changeAnnotations.manage(n),i=Kr.insert(t,r,o)),this.edits.push(i),o!==void 0)return o},e.prototype.replace=function(t,r,n){var i,o;if(n===void 0?i=Gr.replace(t,r):_t.is(n)?(o=n,i=Kr.replace(t,r,n)):(this.assertChangeAnnotations(this.changeAnnotations),o=this.changeAnnotations.manage(n),i=Kr.replace(t,r,o)),this.edits.push(i),o!==void 0)return o},e.prototype.delete=function(t,r){var n,i;if(r===void 0?n=Gr.del(t):_t.is(r)?(i=r,n=Kr.del(t,r)):(this.assertChangeAnnotations(this.changeAnnotations),i=this.changeAnnotations.manage(r),n=Kr.del(t,i)),this.edits.push(n),i!==void 0)return i},e.prototype.add=function(t){this.edits.push(t)},e.prototype.all=function(){return this.edits},e.prototype.clear=function(){this.edits.splice(0,this.edits.length)},e.prototype.assertChangeAnnotations=function(t){if(t===void 0)throw new Error("Text edit change is not configured to manage change annotations.")},e}(),_d=function(){function e(t){this._annotations=t===void 0?Object.create(null):t,this._counter=0,this._size=0}return e.prototype.all=function(){return this._annotations},Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),e.prototype.manage=function(t,r){var n;if(_t.is(t)?n=t:(n=this.nextId(),r=t),this._annotations[n]!==void 0)throw new Error("Id "+n+" is already in use.");if(r===void 0)throw new Error("No annotation provided for id "+n);return this._annotations[n]=r,this._size++,n},e.prototype.nextId=function(){return this._counter++,this._counter.toString()},e}(),M_=function(){function e(t){var r=this;this._textEditChanges=Object.create(null),t!==void 0?(this._workspaceEdit=t,t.documentChanges?(this._changeAnnotations=new _d(t.changeAnnotations),t.changeAnnotations=this._changeAnnotations.all(),t.documentChanges.forEach(function(n){if(Vi.is(n)){var i=new Xo(n.edits,r._changeAnnotations);r._textEditChanges[n.textDocument.uri]=i}})):t.changes&&Object.keys(t.changes).forEach(function(n){var i=new Xo(t.changes[n]);r._textEditChanges[n]=i})):this._workspaceEdit={}}return Object.defineProperty(e.prototype,"edit",{get:function(){return this.initDocumentChanges(),this._changeAnnotations!==void 0&&(this._changeAnnotations.size===0?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),e.prototype.getTextEditChange=function(t){if(Yo.is(t)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var r={uri:t.uri,version:t.version},n=this._textEditChanges[r.uri];if(!n){var i=[],o={textDocument:r,edits:i};this._workspaceEdit.documentChanges.push(o),n=new Xo(i,this._changeAnnotations),this._textEditChanges[r.uri]=n}return n}else{if(this.initChanges(),this._workspaceEdit.changes===void 0)throw new Error("Workspace edit is not configured for normal text edit changes.");var n=this._textEditChanges[t];if(!n){var i=[];this._workspaceEdit.changes[t]=i,n=new Xo(i),this._textEditChanges[t]=n}return n}},e.prototype.initDocumentChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._changeAnnotations=new _d,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},e.prototype.initChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._workspaceEdit.changes=Object.create(null))},e.prototype.createFile=function(t,r,n){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var i;Kn.is(r)||_t.is(r)?i=r:n=r;var o,a;if(i===void 0?o=Qn.create(t,n):(a=_t.is(i)?i:this._changeAnnotations.manage(i),o=Qn.create(t,n,a)),this._workspaceEdit.documentChanges.push(o),a!==void 0)return a},e.prototype.renameFile=function(t,r,n,i){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var o;Kn.is(n)||_t.is(n)?o=n:i=n;var a,c;if(o===void 0?a=Zn.create(t,r,i):(c=_t.is(o)?o:this._changeAnnotations.manage(o),a=Zn.create(t,r,i,c)),this._workspaceEdit.documentChanges.push(a),c!==void 0)return c},e.prototype.deleteFile=function(t,r,n){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var i;Kn.is(r)||_t.is(r)?i=r:n=r;var o,a;if(i===void 0?o=Xn.create(t,n):(a=_t.is(i)?i:this._changeAnnotations.manage(i),o=Xn.create(t,n,a)),this._workspaceEdit.documentChanges.push(o),a!==void 0)return a},e}(),Cd;(function(e){function t(n){return{uri:n}}e.create=t;function r(n){var i=n;return ce.defined(i)&&ce.string(i.uri)}e.is=r})(Cd||(Cd={}));var Sd;(function(e){function t(n,i){return{uri:n,version:i}}e.create=t;function r(n){var i=n;return ce.defined(i)&&ce.string(i.uri)&&ce.integer(i.version)}e.is=r})(Sd||(Sd={}));var Yo;(function(e){function t(n,i){return{uri:n,version:i}}e.create=t;function r(n){var i=n;return ce.defined(i)&&ce.string(i.uri)&&(i.version===null||ce.integer(i.version))}e.is=r})(Yo||(Yo={}));var Ed;(function(e){function t(n,i,o,a){return{uri:n,languageId:i,version:o,text:a}}e.create=t;function r(n){var i=n;return ce.defined(i)&&ce.string(i.uri)&&ce.string(i.languageId)&&ce.integer(i.version)&&ce.string(i.text)}e.is=r})(Ed||(Ed={}));var Dr;(function(e){e.PlainText="plaintext",e.Markdown="markdown"})(Dr||(Dr={})),function(e){function t(r){var n=r;return n===e.PlainText||n===e.Markdown}e.is=t}(Dr||(Dr={}));var Ks;(function(e){function t(r){var n=r;return ce.objectLiteral(r)&&Dr.is(n.kind)&&ce.string(n.value)}e.is=t})(Ks||(Ks={}));var xd;(function(e){e.Text=1,e.Method=2,e.Function=3,e.Constructor=4,e.Field=5,e.Variable=6,e.Class=7,e.Interface=8,e.Module=9,e.Property=10,e.Unit=11,e.Value=12,e.Enum=13,e.Keyword=14,e.Snippet=15,e.Color=16,e.File=17,e.Reference=18,e.Folder=19,e.EnumMember=20,e.Constant=21,e.Struct=22,e.Event=23,e.Operator=24,e.TypeParameter=25})(xd||(xd={}));var Td;(function(e){e.PlainText=1,e.Snippet=2})(Td||(Td={}));var Rd;(function(e){e.Deprecated=1})(Rd||(Rd={}));var kd;(function(e){function t(n,i,o){return{newText:n,insert:i,replace:o}}e.create=t;function r(n){var i=n;return i&&ce.string(i.newText)&&vt.is(i.insert)&&vt.is(i.replace)}e.is=r})(kd||(kd={}));var Dd;(function(e){e.asIs=1,e.adjustIndentation=2})(Dd||(Dd={}));var Id;(function(e){function t(r){return{label:r}}e.create=t})(Id||(Id={}));var Ad;(function(e){function t(r,n){return{items:r||[],isIncomplete:!!n}}e.create=t})(Ad||(Ad={}));var Jo;(function(e){function t(n){return n.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}e.fromPlainText=t;function r(n){var i=n;return ce.string(i)||ce.objectLiteral(i)&&ce.string(i.language)&&ce.string(i.value)}e.is=r})(Jo||(Jo={}));var Pd;(function(e){function t(r){var n=r;return!!n&&ce.objectLiteral(n)&&(Ks.is(n.contents)||Jo.is(n.contents)||ce.typedArray(n.contents,Jo.is))&&(r.range===void 0||vt.is(r.range))}e.is=t})(Pd||(Pd={}));var Od;(function(e){function t(r,n){return n?{label:r,documentation:n}:{label:r}}e.create=t})(Od||(Od={}));var Nd;(function(e){function t(r,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var a={label:r};return ce.defined(n)&&(a.documentation=n),ce.defined(i)?a.parameters=i:a.parameters=[],a}e.create=t})(Nd||(Nd={}));var Gi;(function(e){e.Text=1,e.Read=2,e.Write=3})(Gi||(Gi={}));var Fd;(function(e){function t(r,n){var i={range:r};return ce.number(n)&&(i.kind=n),i}e.create=t})(Fd||(Fd={}));var Qs;(function(e){e.File=1,e.Module=2,e.Namespace=3,e.Package=4,e.Class=5,e.Method=6,e.Property=7,e.Field=8,e.Constructor=9,e.Enum=10,e.Interface=11,e.Function=12,e.Variable=13,e.Constant=14,e.String=15,e.Number=16,e.Boolean=17,e.Array=18,e.Object=19,e.Key=20,e.Null=21,e.EnumMember=22,e.Struct=23,e.Event=24,e.Operator=25,e.TypeParameter=26})(Qs||(Qs={}));var Zs;(function(e){e.Deprecated=1})(Zs||(Zs={}));var Ld;(function(e){function t(r,n,i,o,a){var c={name:r,kind:n,location:{uri:o,range:i}};return a&&(c.containerName=a),c}e.create=t})(Ld||(Ld={}));var $d;(function(e){function t(n,i,o,a,c,w){var p={name:n,detail:i,kind:o,range:a,selectionRange:c};return w!==void 0&&(p.children=w),p}e.create=t;function r(n){var i=n;return i&&ce.string(i.name)&&ce.number(i.kind)&&vt.is(i.range)&&vt.is(i.selectionRange)&&(i.detail===void 0||ce.string(i.detail))&&(i.deprecated===void 0||ce.boolean(i.deprecated))&&(i.children===void 0||Array.isArray(i.children))&&(i.tags===void 0||Array.isArray(i.tags))}e.is=r})($d||($d={}));var dr;(function(e){e.Empty="",e.QuickFix="quickfix",e.Refactor="refactor",e.RefactorExtract="refactor.extract",e.RefactorInline="refactor.inline",e.RefactorRewrite="refactor.rewrite",e.Source="source",e.SourceOrganizeImports="source.organizeImports",e.SourceFixAll="source.fixAll"})(dr||(dr={}));var Md;(function(e){function t(n,i){var o={diagnostics:n};return i!=null&&(o.only=i),o}e.create=t;function r(n){var i=n;return ce.defined(i)&&ce.typedArray(i.diagnostics,Zo.is)&&(i.only===void 0||ce.typedArray(i.only,ce.string))}e.is=r})(Md||(Md={}));var Ud;(function(e){function t(n,i,o){var a={title:n},c=!0;return typeof i=="string"?(c=!1,a.kind=i):Wi.is(i)?a.command=i:a.edit=i,c&&o!==void 0&&(a.kind=o),a}e.create=t;function r(n){var i=n;return i&&ce.string(i.title)&&(i.diagnostics===void 0||ce.typedArray(i.diagnostics,Zo.is))&&(i.kind===void 0||ce.string(i.kind))&&(i.edit!==void 0||i.command!==void 0)&&(i.command===void 0||Wi.is(i.command))&&(i.isPreferred===void 0||ce.boolean(i.isPreferred))&&(i.edit===void 0||Gs.is(i.edit))}e.is=r})(Ud||(Ud={}));var Hd;(function(e){function t(n,i){var o={range:n};return ce.defined(i)&&(o.data=i),o}e.create=t;function r(n){var i=n;return ce.defined(i)&&vt.is(i.range)&&(ce.undefined(i.command)||Wi.is(i.command))}e.is=r})(Hd||(Hd={}));var Bd;(function(e){function t(n,i){return{tabSize:n,insertSpaces:i}}e.create=t;function r(n){var i=n;return ce.defined(i)&&ce.uinteger(i.tabSize)&&ce.boolean(i.insertSpaces)}e.is=r})(Bd||(Bd={}));var jd;(function(e){function t(n,i,o){return{range:n,target:i,data:o}}e.create=t;function r(n){var i=n;return ce.defined(i)&&vt.is(i.range)&&(ce.undefined(i.target)||ce.string(i.target))}e.is=r})(jd||(jd={}));var zd;(function(e){function t(n,i){return{range:n,parent:i}}e.create=t;function r(n){var i=n;return i!==void 0&&vt.is(i.range)&&(i.parent===void 0||e.is(i.parent))}e.is=r})(zd||(zd={}));var U_=null,qd;(function(e){function t(o,a,c,w){return new mw(o,a,c,w)}e.create=t;function r(o){var a=o;return!!(ce.defined(a)&&ce.string(a.uri)&&(ce.undefined(a.languageId)||ce.string(a.languageId))&&ce.uinteger(a.lineCount)&&ce.func(a.getText)&&ce.func(a.positionAt)&&ce.func(a.offsetAt))}e.is=r;function n(o,a){for(var c=o.getText(),w=i(a,function($,B){var q=$.range.start.line-B.range.start.line;return q===0?$.range.start.character-B.range.start.character:q}),p=c.length,S=w.length-1;S>=0;S--){var P=w[S],k=o.offsetAt(P.range.start),I=o.offsetAt(P.range.end);if(I<=p)c=c.substring(0,k)+P.newText+c.substring(I,c.length);else throw new Error("Overlapping edit");p=k}return c}e.applyEdits=n;function i(o,a){if(o.length<=1)return o;var c=o.length/2|0,w=o.slice(0,c),p=o.slice(c);i(w,a),i(p,a);for(var S=0,P=0,k=0;S<w.length&&P<p.length;){var I=a(w[S],p[P]);I<=0?o[k++]=w[S++]:o[k++]=p[P++]}for(;S<w.length;)o[k++]=w[S++];for(;P<p.length;)o[k++]=p[P++];return o}})(qd||(qd={}));var mw=function(){function e(t,r,n,i){this._uri=t,this._languageId=r,this._version=n,this._content=i,this._lineOffsets=void 0}return Object.defineProperty(e.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),e.prototype.getText=function(t){if(t){var r=this.offsetAt(t.start),n=this.offsetAt(t.end);return this._content.substring(r,n)}return this._content},e.prototype.update=function(t,r){this._content=t.text,this._version=r,this._lineOffsets=void 0},e.prototype.getLineOffsets=function(){if(this._lineOffsets===void 0){for(var t=[],r=this._content,n=!0,i=0;i<r.length;i++){n&&(t.push(i),n=!1);var o=r.charAt(i);n=o==="\r"||o===`
`,o==="\r"&&i+1<r.length&&r.charAt(i+1)===`
`&&i++}n&&r.length>0&&t.push(r.length),this._lineOffsets=t}return this._lineOffsets},e.prototype.positionAt=function(t){t=Math.max(Math.min(t,this._content.length),0);var r=this.getLineOffsets(),n=0,i=r.length;if(i===0)return lr.create(0,t);for(;n<i;){var o=Math.floor((n+i)/2);r[o]>t?i=o:n=o+1}var a=n-1;return lr.create(a,t-r[a])},e.prototype.offsetAt=function(t){var r=this.getLineOffsets();if(t.line>=r.length)return this._content.length;if(t.line<0)return 0;var n=r[t.line],i=t.line+1<r.length?r[t.line+1]:this._content.length;return Math.max(Math.min(n+t.character,i),n)},Object.defineProperty(e.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),e}(),ce;(function(e){var t=Object.prototype.toString;function r(I){return typeof I!="undefined"}e.defined=r;function n(I){return typeof I=="undefined"}e.undefined=n;function i(I){return I===!0||I===!1}e.boolean=i;function o(I){return t.call(I)==="[object String]"}e.string=o;function a(I){return t.call(I)==="[object Number]"}e.number=a;function c(I,$,B){return t.call(I)==="[object Number]"&&$<=I&&I<=B}e.numberRange=c;function w(I){return t.call(I)==="[object Number]"&&-2147483648<=I&&I<=2147483647}e.integer=w;function p(I){return t.call(I)==="[object Number]"&&0<=I&&I<=2147483647}e.uinteger=p;function S(I){return t.call(I)==="[object Function]"}e.func=S;function P(I){return I!==null&&typeof I=="object"}e.objectLiteral=P;function k(I,$){return Array.isArray(I)&&I.every($)}e.typedArray=k})(ce||(ce={}));var Ki;(function(e){function t(n){return typeof n=="string"||n instanceof String}e.string=t;function r(n){return typeof n=="number"||n instanceof Number}e.number=r})(Ki||(Ki={}));var Xs;(function(e){function t(r){const n=r;return n!=null&&(Ki.number(n.value)||Ki.string(n.value))&&Ki.string(n.target)}e.is=t})(Xs||(Xs={}));class vw extends s.Diagnostic{constructor(t,r,n,i){super(t,r,n);this.data=i,this.hasDiagnosticCode=!1}}var fr;(function(e){const t=Object.prototype.toString;function r(S){return typeof S!="undefined"}e.defined=r;function n(S){return S===!0||S===!1}e.boolean=n;function i(S){return t.call(S)==="[object String]"}e.string=i;function o(S){return t.call(S)==="[object Number]"}e.number=o;function a(S){return S!==null&&typeof S=="object"}e.objectLiteral=a;function c(S){return Array.isArray(S)}e.array=c;function w(S){return c(S)&&S.every(P=>i(P))}e.stringArray=w;function p(S,P){return Array.isArray(S)&&S.every(P)}e.typedArray=p})(fr||(fr={}));var ea;(function(e){function t(r){const n=r;return n&&fr.string(n.language)&&fr.string(n.value)}e.is=t})(ea||(ea={}));function yw(e){const t=z=>s.Uri.parse(z),r=e!=null?e:t;function n(z){return r(z)}function i(z){return z.map(o)}function o(z){const ve=new vw(P(z.range),z.message,I(z.severity),z.data);return z.code!==void 0&&(Vs.is(z.codeDescription)?ve.code={value:z.code,target:n(z.codeDescription.href)}:Xs.is(z.code)?(ve.hasDiagnosticCode=!0,ve.code={value:z.code.value,target:n(z.code.target)}):ve.code=z.code),z.source&&(ve.source=z.source),z.relatedInformation&&(ve.relatedInformation=a(z.relatedInformation)),Array.isArray(z.tags)&&(ve.tags=w(z.tags)),ve}function a(z){return z.map(c)}function c(z){return new s.DiagnosticRelatedInformation(Te(z.location),z.message)}function w(z){if(!z)return;const ve=[];for(const Me of z){const yt=p(Me);yt!==void 0&&ve.push(yt)}return ve.length>0?ve:void 0}function p(z){switch(z){case Qo.Unnecessary:return s.DiagnosticTag.Unnecessary;case Qo.Deprecated:return s.DiagnosticTag.Deprecated;default:return}}function S(z){if(!!z)return new s.Position(z.line,z.character)}function P(z){if(!!z)return new s.Range(S(z.start),S(z.end))}function k(z){return z.map(ve=>P(ve))}function I(z){if(z==null)return s.DiagnosticSeverity.Error;switch(z){case Gn.Error:return s.DiagnosticSeverity.Error;case Gn.Warning:return s.DiagnosticSeverity.Warning;case Gn.Information:return s.DiagnosticSeverity.Information;case Gn.Hint:return s.DiagnosticSeverity.Hint}return s.DiagnosticSeverity.Error}function $(z){if(fr.string(z))return new s.MarkdownString(z);if(ea.is(z))return new s.MarkdownString().appendCodeblock(z.value,z.language);if(Array.isArray(z)){const Me=[];for(const yt of z){const oo=new s.MarkdownString;ea.is(yt)?oo.appendCodeblock(yt.value,yt.language):oo.appendMarkdown(yt),Me.push(oo)}return Me}let ve;switch(z.kind){case Dr.Markdown:return new s.MarkdownString(z.value);case Dr.PlainText:return ve=new s.MarkdownString,ve.appendText(z.value),ve;default:return ve=new s.MarkdownString,ve.appendText(`Unsupported Markup content received. Kind is: ${z.kind}`),ve}}function B(z){if(fr.string(z))return z;switch(z.kind){case Dr.Markdown:return new s.MarkdownString(z.value);case Dr.PlainText:return z.value;default:return`Unsupported Markup content received. Kind is: ${z.kind}`}}function q(z){if(!!z)return new s.Hover($(z.contents),P(z.range))}function Z(z){if(!!z)return new s.TextEdit(P(z.range),z.newText)}function K(z){if(!!z)return z.map(Z)}function re(z){if(!z)return;const ve=new s.SignatureHelp;return fr.number(z.activeSignature)?ve.activeSignature=z.activeSignature:ve.activeSignature=0,fr.number(z.activeParameter)?ve.activeParameter=z.activeParameter:ve.activeParameter=0,z.signatures&&(ve.signatures=ee(z.signatures)),ve}function ee(z){return z.map(se)}function se(z){const ve=new s.SignatureInformation(z.label);return z.documentation!==void 0&&(ve.documentation=B(z.documentation)),z.parameters!==void 0&&(ve.parameters=Se(z.parameters)),z.activeParameter!==void 0&&(ve.activeParameter=z.activeParameter),ve}function Se(z){return z.map(me)}function me(z){const ve=new s.ParameterInformation(z.label);return z.documentation&&(ve.documentation=B(z.documentation)),ve}function Te(z){if(!!z)return new s.Location(r(z.uri),P(z.range))}function Oe(z){if(!!z)return Pt(z)}function Re(z){if(!!z)return Pt(z)}function Pe(z){if(!z)return;const ve={targetUri:r(z.targetUri),targetRange:P(z.targetSelectionRange),originSelectionRange:P(z.originSelectionRange),targetSelectionRange:P(z.targetSelectionRange)};if(!ve.targetSelectionRange)throw new Error("targetSelectionRange must not be undefined or null");return ve}function Pt(z){if(!!z)return fr.array(z)?z.length===0?[]:Ko.is(z[0])?z.map(yt=>Pe(yt)):z.map(Me=>Te(Me)):Ko.is(z)?[Pe(z)]:Te(z)}function qt(z){if(!!z)return z.map(ve=>Te(ve))}function Wt(z){if(!!z)return z.map(Nr)}function Nr(z){const ve=new s.DocumentHighlight(P(z.range));return fr.number(z.kind)&&(ve.kind=$t(z.kind)),ve}function $t(z){switch(z){case Gi.Text:return s.DocumentHighlightKind.Text;case Gi.Read:return s.DocumentHighlightKind.Read;case Gi.Write:return s.DocumentHighlightKind.Write}return s.DocumentHighlightKind.Text}function Yt(z,ve){if(!!z)return z.map(Me=>$f(Me,ve))}function Jt(z){return z<=Qs.TypeParameter?z-1:s.SymbolKind.Property}function ui(z){switch(z){case Zs.Deprecated:return s.SymbolTag.Deprecated;default:return}}function pa(z){if(z==null)return;const ve=[];for(const Me of z){const yt=ui(Me);yt!==void 0&&ve.push(yt)}return ve.length===0?void 0:ve}function $f(z,ve){const Me=new s.SymbolInformation(z.name,Jt(z.kind),P(z.location.range),z.location.uri?r(z.location.uri):ve);return Mf(Me,z),z.containerName&&(Me.containerName=z.containerName),Me}function Kb(z){if(z!=null)return z.map(Tc)}function Tc(z){var ve;const Me=new s.DocumentSymbol(z.name,(ve=z.detail)!=null?ve:"",Jt(z.kind),P(z.range),P(z.selectionRange));if(Mf(Me,z),z.children!==void 0&&z.children.length>0){const yt=[];for(const oo of z.children)yt.push(Tc(oo));Me.children=yt}return Me}function Mf(z,ve){z.tags=pa(ve.tags),ve.deprecated&&(z.tags?z.tags.includes(s.SymbolTag.Deprecated)||(z.tags=z.tags.concat(s.SymbolTag.Deprecated)):z.tags=[s.SymbolTag.Deprecated])}function Rc(z){const ve={title:z.title,command:z.command};return z.arguments&&(ve.arguments=z.arguments),ve}function Qb(z){if(!!z)return z.map(Rc)}const Fr=new Map;Fr.set(dr.Empty,s.CodeActionKind.Empty),Fr.set(dr.QuickFix,s.CodeActionKind.QuickFix),Fr.set(dr.Refactor,s.CodeActionKind.Refactor),Fr.set(dr.RefactorExtract,s.CodeActionKind.RefactorExtract),Fr.set(dr.RefactorInline,s.CodeActionKind.RefactorInline),Fr.set(dr.RefactorRewrite,s.CodeActionKind.RefactorRewrite),Fr.set(dr.Source,s.CodeActionKind.Source),Fr.set(dr.SourceOrganizeImports,s.CodeActionKind.SourceOrganizeImports);function kc(z){if(z==null)return;let ve=Fr.get(z);if(ve)return ve;const Me=z.split(".");ve=s.CodeActionKind.Empty;for(const yt of Me)ve=ve.append(yt);return ve}function Zb(z){if(z!=null)return z.map(ve=>kc(ve))}function Xb(z){if(z==null)return;const ve=new s.CodeAction(z.title);return z.kind!==void 0&&(ve.kind=kc(z.kind)),z.diagnostics&&(ve.diagnostics=i(z.diagnostics)),z.edit&&(ve.edit=Uf(z.edit)),z.command&&(ve.command=Rc(z.command)),z.isPreferred!==void 0&&(ve.isPreferred=z.isPreferred),ve}function Uf(z){if(!z)return;const ve=new s.WorkspaceEdit;return z.documentChanges?z.documentChanges.forEach(Me=>{if(Qn.is(Me))ve.createFile(r(Me.uri),Me.options);else if(Zn.is(Me))ve.renameFile(r(Me.oldUri),r(Me.newUri),Me.options);else if(Xn.is(Me))ve.deleteFile(r(Me.uri),Me.options);else if(Vi.is(Me))ve.set(r(Me.textDocument.uri),K(Me.edits));else throw new Error(`Unknown workspace edit change received:
${JSON.stringify(Me,void 0,4)}`)}):z.changes&&Object.keys(z.changes).forEach(Me=>{ve.set(r(Me),K(z.changes[Me]))}),ve}function Hf(z){return new s.Color(z.red,z.green,z.blue,z.alpha)}function Bf(z){return new s.ColorInformation(P(z.range),Hf(z.color))}function Yb(z){if(Array.isArray(z))return z.map(Bf)}function jf(z){const ve=new s.ColorPresentation(z.label);return ve.additionalTextEdits=K(z.additionalTextEdits),z.textEdit&&(ve.textEdit=Z(z.textEdit)),ve}function Jb(z){if(Array.isArray(z))return z.map(jf)}function zf(z){if(z)switch(z){case qi.Comment:return s.FoldingRangeKind.Comment;case qi.Imports:return s.FoldingRangeKind.Imports;case qi.Region:return s.FoldingRangeKind.Region}}function qf(z){return new s.FoldingRange(z.startLine,z.endLine,zf(z.kind))}function e_(z){if(Array.isArray(z))return z.map(qf)}function Dc(z){return new s.SelectionRange(P(z.range),z.parent?Dc(z.parent):void 0)}function t_(z){if(!Array.isArray(z))return[];const ve=[];for(const Me of z)ve.push(Dc(Me));return ve}return{asUri:n,asDiagnostics:i,asDiagnostic:o,asRange:P,asRanges:k,asPosition:S,asDiagnosticSeverity:I,asDiagnosticTag:p,asHover:q,asTextEdit:Z,asTextEdits:K,asSignatureHelp:re,asSignatureInformations:ee,asSignatureInformation:se,asParameterInformations:Se,asParameterInformation:me,asDeclarationResult:Oe,asDefinitionResult:Re,asLocation:Te,asReferences:qt,asDocumentHighlights:Wt,asDocumentHighlight:Nr,asDocumentHighlightKind:$t,asSymbolKind:Jt,asSymbolTag:ui,asSymbolTags:pa,asSymbolInformations:Yt,asSymbolInformation:$f,asDocumentSymbols:Kb,asDocumentSymbol:Tc,asCommand:Rc,asCommands:Qb,asCodeAction:Xb,asCodeActionKind:kc,asCodeActionKinds:Zb,asWorkspaceEdit:Uf,asFoldingRangeKind:zf,asFoldingRange:qf,asFoldingRanges:e_,asColor:Hf,asColorInformation:Bf,asColorInformations:Yb,asColorPresentation:jf,asColorPresentations:Jb,asSelectionRange:Dc,asSelectionRanges:t_}}var hr;(function(e){function t(r=!1){return{hoverProvider:r,declarationProvider:r,definitionProvider:r,typeDefinitionProvider:r,referencesProvider:r,documentSymbolProvider:r,foldingRangeProvider:r,diagnosticProvider:r}}e.create=t})(hr||(hr={}));var Qt;(function(e){const t="v0.1",r="https://prod.richnav.vsengsaas.visualstudio.com/api";async function n(B,q){const Z=await yn(B,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(q)});if(Z.status===200)return Z.json()}async function i(B,q){return(await yn(B,{method:"Post",body:q})).json()}function o(B,q){return`${r}/${t}/HttpLanguageService/${B}/${q}`}async function a(B){const q=await yn(`${r}/${t}/WorkspaceSnapshot?commitId=${B}`);if(q.ok)return q.json()}e.getWorkspaceSnapshot=a;async function c(B){const q=new X0;q.append("uriString",B.toString(!0));const Z=await i(`${r}/${t}/WorkspaceSnapshot/latest`,q);if(Z!==void 0)return{workspaceId:Z.WorkspaceId,snapshotId:Z.SnapshotId,commitId:Z.commitId}}e.getLatestWorkspaceSnapshot=c;async function w(B,q){return n(o(B,"textDocument/capabilities"),q)}e.capabilities=w;async function p(B,q){return n(o(B,"textDocument/hover"),q)}e.provideHover=p;async function S(B,q){return n(o(B,"textDocument/definition"),q)}e.provideDefinition=S;async function P(B,q){return n(o(B,"textDocument/declaration"),q)}e.provideDeclaration=P;async function k(B,q){return n(o(B,"textDocument/typeDefinition"),q)}e.provideTypeDefinition=k;async function I(B,q){return n(o(B,"textDocument/references"),q)}e.provideReferences=I;async function $(B,q){return n(o(B,"textDocument/foldingRange"),q)}e.providerFoldingRanges=$})(Qt||(Qt={}));class Wd{constructor(){}async getBestIndexedCommit(t,r){var n;const i=Je.decodeAuthority(r).metadata;if(i===void 0||i.idx!=="latest")return;const o=(n=t.getExternalUri)==null?void 0:n.call(t,{repo:t.getRepositoryDescriptor(r)});if(o===void 0)return;const a=await Qt.getLatestWorkspaceSnapshot(o);if(a!==void 0)return a.commitId}}class ww{async createNavigationService(t,r){const n=await t.getMetadata(r.uri),i=await Qt.getWorkspaceSnapshot(n.HEAD.sha);if(i!==void 0)return()=>new ta(t,r,i)}}const pr=class{constructor(e,t,r){this.providerService=e,this.repository=t,this.workspaceSnapshot=r,this.metadata=this.providerService.getMetadata(this.repository.uri),this.converter=new Promise((i,o)=>{const a=`vsck://${r.workspaceId}/${this.workspaceSnapshot.snapshotId}/source/`;this.metadata.then(c=>{i(yw(w=>{const p=s.Uri.parse(w);if(c===void 0)return p;let S=p.path;p.toString(!0).startsWith(a)&&(S=p.toString(!0).substr(a.length));try{return this.repository.createRelativeUri(S)}catch(P){return p}}))},o)}),this.registeredFeatures=new Map,this.pendingCapabilitiesRequests=new Map,this.capabilitiesCache=new gw(2048);const n=async i=>{if(Je.scheme!==i.uri.scheme)return;const o=t.uri,a=i.uri.toString(),c=be(o);if(!a.startsWith(c)||this.pendingCapabilitiesRequests.has(a))return;const w=await this.getSha();let p=this.capabilitiesCache.get(a);if(p===null)return;if(p===void 0){const $=this.capabilities(i.uri);this.pendingCapabilitiesRequests.set(a,$),p=await $,this.pendingCapabilitiesRequests.delete(a),this.capabilitiesCache.set(a,p===void 0?null:p)}if(p===void 0||!s.workspace.textDocuments.some($=>$===i))return;const S=i.languageId,k=[{scheme:this.repository.uri.scheme,pattern:i.uri.fsPath,language:i.languageId,exclusive:!0}],I=[];pr.registerCapability(S,"hoverProvider",p)&&I.push(s.languages.registerHoverProvider(k,{provideHover:async($,B)=>(await this.converter).asHover(await Qt.provideHover(w,this.createTextDocumentPositionParams($.uri,B)))})),pr.registerCapability(S,"definitionProvider",p)&&I.push(s.languages.registerDefinitionProvider(k,{provideDefinition:async($,B)=>(await this.converter).asDefinitionResult(await Qt.provideDefinition(w,this.createTextDocumentPositionParams($.uri,B)))})),pr.registerCapability(S,"declarationProvider",p)&&I.push(s.languages.registerDeclarationProvider(k,{provideDeclaration:async($,B)=>(await this.converter).asDeclarationResult(await Qt.provideDeclaration(w,this.createTextDocumentPositionParams($.uri,B)))})),pr.registerCapability(S,"typeDefinitionProvider",p)&&I.push(s.languages.registerTypeDefinitionProvider(k,{provideTypeDefinition:async($,B)=>(await this.converter).asDefinitionResult(await Qt.provideDeclaration(w,this.createTextDocumentPositionParams($.uri,B)))})),pr.registerCapability(S,"referencesProvider",p)&&I.push(s.languages.registerReferenceProvider(k,{provideReferences:async($,B,q)=>{const Z={position:{line:B.line,character:B.character},textDocument:{uri:this.createDocumentUri($.uri).toString(!0)},context:{includeDeclaration:q.includeDeclaration}};return(await this.converter).asReferences(await Qt.provideReferences(w,Z))}})),pr.registerCapability(S,"foldingRangeProvider",p)&&I.push(s.languages.registerFoldingRangeProvider(k,{provideFoldingRanges:async $=>(await this.converter).asFoldingRanges(await Qt.providerFoldingRanges(w,this.createTextDocumentParams($.uri)))})),this.registeredFeatures.set(a,s.Disposable.from(...I)),this.updateStatusBarItem()};s.workspace.onDidOpenTextDocument(n),s.workspace.textDocuments.forEach(n),s.workspace.onDidCloseTextDocument(i=>{const o=i.uri.toString(),a=this.registeredFeatures.get(o);a!==void 0&&(this.registeredFeatures.delete(i.uri.toString()),a.dispose()),this.pendingCapabilitiesRequests.delete(o)}),s.window.onDidChangeActiveTextEditor(()=>{this.updateStatusBarItem()})}static registerCapability(e,t,r){var n;const i=this.disabledCapabilities.get(e);if(i==null?void 0:i[t])return!1;const o=this.localCapabilities.get(e);return(o==null?void 0:o[t])?!1:(n=r[t])!=null?n:!1}dispose(){for(const e of this.registeredFeatures.values())e.dispose();this.registeredFeatures.clear()}async updateStatusBarItem(){const e=s.window.activeTextEditor;if(e===void 0){pr.statusBarItem.hide();return}const t=this.providerService.getVirtualUri(e.document.uri).toString(),r=this.pendingCapabilitiesRequests.get(t);r!==void 0&&(await r,e!==s.window.activeTextEditor)||(this.registeredFeatures.has(t)?pr.statusBarItem.show():pr.statusBarItem.hide())}async capabilities(e){var t;const r=await this.getSha();return(t=await Qt.capabilities(r,this.createTextDocumentParams(e)))!=null?t:void 0}provideDocumentSymbols(){return Promise.resolve([])}createTextDocumentParams(e){return{textDocument:{uri:this.createDocumentUri(e).toString(!0)}}}createTextDocumentPositionParams(e,t){return{position:{line:t.line,character:t.character},textDocument:{uri:this.createDocumentUri(e).toString(!0)}}}createDocumentUri(e){const t=this.repository.uri.toString(!0),r=e.toString(!0);return s.Uri.file(r.substr(t.length))}async getSha(){return(await this.metadata).HEAD.sha}};let ta=pr;ta.localCapabilities=new Map([["javascript",Object.assign(hr.create(),{documentSymbolProvider:!0,foldingRangeProvider:!0})],["javascriptreact",Object.assign(hr.create(),{documentSymbolProvider:!0,foldingRangeProvider:!0})],["typescript",Object.assign(hr.create(),{documentSymbolProvider:!0,foldingRangeProvider:!0})],["typescriptreact",Object.assign(hr.create(),{documentSymbolProvider:!0,foldingRangeProvider:!0})]]),ta.disabledCapabilities=new Map([["javascript",Object.assign(hr.create(),{declarationProvider:!0})],["javascriptreact",Object.assign(hr.create(),{declarationProvider:!0})],["typescript",Object.assign(hr.create(),{declarationProvider:!0})],["typescriptreact",Object.assign(hr.create(),{declarationProvider:!0})]]),ta.statusBarItem=function(){const e=s.window.createStatusBarItem(s.StatusBarAlignment.Right);return e.text="Indexed",e.tooltip=["The source file is indexed and provides","enhanced code comprehension features","like Go to Declaration and Find all","references."].join(`
`),e.hide(),e}();class bw{constructor(t){this.providerService=t}getProvider(t){return this.providerService.getRegisteredProvider(t)}getProviderUri(t){return this.providerService.getProviderUri(t)}getProviderRootUri(t){return this.providerService.getProviderRootUri(t)}isProviderUri(t,r){return t.scheme!==Je.scheme&&this.providerService.hasProvider(t,r)}getVirtualUri(t){return this.providerService.getVirtualUri(t)}getVirtualWorkspaceUri(t){return this.providerService.getVirtualWorkspaceUri(t)}}var _w=Object.defineProperty,Cw=Object.getOwnPropertyDescriptor,Ys=(e,t,r,n)=>{for(var i=n>1?void 0:n?Cw(t,r):t,o=e.length-1,a;o>=0;o--)(a=e[o])&&(i=(n?a(t,r,i):a(i))||i);return n&&i&&_w(t,r,i),i};const Sw={dispose:()=>{}};class ra{constructor(t,r){this.providerService=t,this.changeStore=r,this._onDidChangeFile=new s.EventEmitter,this.disposable=s.Disposable.from(s.workspace.registerFileSystemProvider(Je.scheme,this,{isCaseSensitive:!0}),s.workspace.registerFileSearchProvider(Je.scheme,this),s.workspace.registerTextSearchProvider(Je.scheme,this),t.onDidChangeRepository(({repository:n})=>this.updateOpenDocuments([n.uri])),t.onDidRefresh(n=>this.updateOpenDocuments(n)),r.onDidChange(n=>{this._onDidChangeFile.fire(n.map(i=>{switch(i.type){case Be.Created:return{type:s.FileChangeType.Created,uri:i.uri};case Be.Changed:return{type:s.FileChangeType.Changed,uri:i.uri};case Be.Deleted:return{type:s.FileChangeType.Deleted,uri:i.uri}}}))}))}get onDidChangeFile(){return this._onDidChangeFile.event}dispose(){var t;(t=this.disposable)==null||t.dispose()}updateOpenDocuments(t){const r=this.providerService.getOpenUris(Je.scheme,t);if(r.length===0)return;const n=[...r.map(i=>({type:s.FileChangeType.Changed,uri:i})),...t.map(i=>({type:s.FileChangeType.Changed,uri:i}))];this._onDidChangeFile.fire(n)}watch(t,r){return Sw}async stat(t){const r=new Qe(`fs.stat(${t.toString()})`,{log:!0});try{let n=await this.changeStore.stat(t);return n!==void 0||(r.log({message:": Provider query"}),n=await this.providerService.stat(this.providerService.getProviderUri(t))),n}finally{r.stop()}}async readDirectory(t){const r=new Qe(`fs.readDirectory(${t.toString()})`,{log:!0});try{let n=await this.providerService.readDirectory(this.providerService.getProviderUri(t));return r.log({message:": Provider query"}),n=await this.changeStore.updateDirectoryEntries(t,n),n}finally{r.stop()}}async createDirectory(t){const r=new Qe(`fs.createDirectory(${t.toString()})`,{log:!0,logLevel:Ke.Info});try{await this.changeStore.createDirectory(t)}catch(n){throw he.error(n,r.context),n}finally{r.stop()}}async readFile(t){const r=new Qe(`fs.readFile(${t.toString()})`,{log:!0});try{const n=await this.changeStore.readFile(t);return n!==void 0?n:(r.log({message:": ChangeStore query",suffix:" \u2022 Not found; querying provider..."}),await this.providerService.readFile(this.providerService.getProviderUri(t)))}finally{r.stop()}}async writeFile(t,r,n){const i=new Qe(`fs.writeFile(${t.toString()})`,{log:!0,logLevel:Ke.Info},r.length,n);try{let o;try{if(o=await this.stat(t),!n.overwrite)throw s.FileSystemError.FileExists()}catch(a){if(a instanceof s.FileSystemError&&a.code==="FileNotFound"){if(!n.create)throw s.FileSystemError.FileNotFound()}else throw a}try{if(o===void 0)await this.changeStore.createFile(t,r);else{const a=await this.providerService.readFile(this.providerService.getProviderUri(t));i.log({message:": Provider original query"}),await this.changeStore.writeFile(t,r,a)}}catch(a){throw he.error(a,i.context),a}}finally{i.stop()}}async delete(t,r){const n=new Qe(`fs.delete(${t.toString()})`,{log:!0,logLevel:Ke.Info},r);try{switch((await this.stat(t)).type){case s.FileType.File:await this.changeStore.deleteFile(t);break;case s.FileType.Directory:{await this.deleteDirectory(t,r);break}default:throw s.FileSystemError.NoPermissions()}}catch(i){throw he.error(i,n.context),i}finally{n.stop()}}async deleteDirectory(t,r){const n=new Qe(`fs.deleteDirectory(${t.toString()})`,{log:!0,logLevel:Ke.Info},r);try{const i=await this.readDirectory(t);if(i.length!==0){if(!r.recursive&&i.some(([,o])=>o===s.FileType.Directory))throw s.FileSystemError.NoPermissions();for(const[o,a]of i)a===s.FileType.Directory?await this.deleteDirectory(s.Uri.joinPath(t,o),r):await this.changeStore.deleteFile(s.Uri.joinPath(t,o))}await this.changeStore.deleteDirectory(t)}catch(i){throw he.error(i,n.context),i}finally{n.stop()}}async rename(t,r,n){const i=new Qe(`fs.rename(${t.toString()} -> ${r.toString()})`,{log:!0,logLevel:Ke.Info},n);try{switch((await this.stat(t)).type){case s.FileType.File:{const a=await this.readFile(t);await this.writeFile(r,a,{create:!0,overwrite:n.overwrite}),await this.delete(t,{recursive:!1});break}case s.FileType.Directory:{await this.renameDirectory(t,r,n);break}default:throw s.FileSystemError.NoPermissions()}}catch(o){throw he.error(o,i.context),o}finally{i.stop()}}async renameDirectory(t,r,n){const i=new Qe(`fs.renameDirectory(${t.toString()} -> ${r.toString()})`,{log:!0,logLevel:Ke.Info},n);try{await this.copyDirectory(t,r,n),await this.delete(t,{recursive:!0})}catch(o){throw he.error(o,i.context),o}finally{i.stop()}}async copy(t,r,n){const i=new Qe(`fs.copy(${t.toString()} -> ${r.toString()})`,{log:!0,logLevel:Ke.Info},n);try{switch((await this.stat(t)).type){case s.FileType.File:{const a=await this.readFile(t);await this.writeFile(r,a,{create:!0,overwrite:n.overwrite});break}case s.FileType.Directory:{await this.copyDirectory(t,r,n);break}default:throw s.FileSystemError.NoPermissions()}}catch(o){throw he.error(o,i.context),o}finally{i.stop()}}async copyDirectory(t,r,n){const i=new Qe(`fs.copyDirectory(${t.toString()} -> ${r.toString()})`,{log:!0,logLevel:Ke.Info},n);try{if(await this.exists(r))throw s.FileSystemError.FileExists();try{await this.createDirectory(r);const o=await this.readDirectory(t);for(const[a,c]of o)c===s.FileType.Directory?await this.copyDirectory(s.Uri.joinPath(t,a),s.Uri.joinPath(r,a),n):await this.copy(s.Uri.joinPath(t,a),s.Uri.joinPath(r,a),n)}catch(o){throw he.error(o,i.context),o}}finally{i.stop()}}async exists(t){try{return await this.stat(t),!0}catch(r){if(r instanceof s.FileSystemError&&r.code==="FileNotFound")return!1;throw r}}provideFileSearchResults(t,r,n){return this.providerService.provideFileSearchResults(t,{...r,folder:this.providerService.getProviderUri(r.folder)},n)}provideTextSearchResults(t,r,n,i){return this.providerService.provideTextSearchResults(t,{...r,folder:this.providerService.getProviderUri(r.folder)},{report:o=>n.report({...o,uri:this.providerService.getVirtualUri(o.uri)})},i)}}Ys([nr()],ra.prototype,"stat",1),Ys([nr()],ra.prototype,"readDirectory",1),Ys([nr()],ra.prototype,"readFile",1);const Js=(0,E.LV)(),Ew={dispose:()=>{}},xw=/(\/|\\)/g,Tw=new TextEncoder,Yn=class{constructor(e,t,r,n){this.providerService=e,this.github=t,this.changeStore=r,this.tarPit=n,this._onDidChangeFile=new s.EventEmitter,this.fsCache=new Map,this.contentCache=new Map,this.fileSearchCache=new Map,this.disposable=s.Disposable.from(s.workspace.registerFileSystemProvider(Yn.scheme,this,{isCaseSensitive:!0,isReadonly:!0}),s.workspace.registerFileSearchProvider(Yn.scheme,this),s.workspace.registerTextSearchProvider(Yn.scheme,this),s.workspace.onDidCloseTextDocument(i=>this.onTextDocumentClosed(i.uri)),e.onDidChangeRepository(({repository:i})=>{this.clearCaches(),this.updateOpenDocuments([e.getProviderUri(i.uri)])}),e.onDidRefresh(i=>{this.clearCaches(),this.updateOpenDocuments(i)}))}get onDidChangeFile(){return this._onDidChangeFile.event}dispose(){var e;(e=this.disposable)==null||e.dispose()}clearCaches(){this.fsCache.clear(),this.contentCache.clear()}onTextDocumentClosed(e){e.scheme===Yn.scheme&&this.contentCache.delete(be(e))}updateOpenDocuments(e){const t=this.providerService.getOpenUris(Yn.scheme,e);if(t.length===0)return;const r=t.map(n=>({type:s.FileChangeType.Changed,uri:n}));this._onDidChangeFile.fire(r)}watch(){return Ew}async stat(e){var t,r,n;const i=await this.fsQuery(e,"stat",`__typename
				...on Blob {
					byteSize
				}`,this.fsCache);if(i===void 0&&e.query!=="~")throw s.FileSystemError.FileNotFound();const o=await this.providerService.getMetadata(e);return{type:Gd((t=i==null?void 0:i.__typename)!=null?t:"blob"),size:(r=i==null?void 0:i.byteSize)!=null?r:0,ctime:0,mtime:(n=o==null?void 0:o.timestamp)!=null?n:Date.now()}}async readDirectory(e){var t;const r=await this.fsQuery(e,"readDirectory",`... on Tree {
					entries {
						name
						type
					}
				}`,this.fsCache);return((t=r==null?void 0:r.entries)!=null?t:[]).map(n=>[n.name,Gd(n.type)])}createDirectory(e){throw s.FileSystemError.NoPermissions()}async readFile(e){var t,r;const n=be(e);let i=(t=this.contentCache.get(n))==null?void 0:t.content;if(i!==void 0)return i;const o=await this.fsQuery(e,"readFile",`... on Blob {
			oid
			isBinary
			isTruncated
			text
		}`);return(o==null?void 0:o.isBinary)||(o==null?void 0:o.isTruncated)?i=await this.github.getFileContent(e):i=Tw.encode((r=o==null?void 0:o.text)!=null?r:""),this.contentCache.set(n,{content:i,timestamp:Date.now()}),i}writeFile(e,t,r){throw s.FileSystemError.NoPermissions()}delete(e,t){throw s.FileSystemError.NoPermissions()}rename(e,t,r){throw s.FileSystemError.NoPermissions()}copy(e,t,r){throw s.FileSystemError.NoPermissions()}async provideFileSearchResults(e,t,r){let n=this.fileSearchCache.get(t.folder.toString(!0));if(n===void 0){const o=await this.github.getRepoFileNames(t.folder);if(o===void 0||r.isCancellationRequested)return[];n=[...An(o,a=>Mn.prepareSlow(a))],this.fileSearchCache.set(t.folder.toString(!0),n)}if(t.maxResults===void 0||t.maxResults===0||t.maxResults>=n.length)return n.map(a=>s.Uri.joinPath(t.folder,a.target));const i=Mn.go(e.pattern.replace(xw,"/"),n,{allowTypo:!0,limit:t.maxResults}).map(o=>s.Uri.joinPath(t.folder,o.target));return Mn.cleanup(),i}async provideTextSearchResults(e,t,r,n){const i=[];if(He.get("search.download.enabled"))try{return nd(this.providerService,this.changeStore,this.tarPit,e,t,r,n)}catch{i.push({text:Js("index error","Error searching with index, falling back to standard search"),type:s.TextSearchCompleteMessageType.Warning})}i.push({text:Js("enable index","To improve search accuracy, [enable indexing](command:remoteHub.enableIndexing)"),type:s.TextSearchCompleteMessageType.Information,trusted:!0}),(e.isCaseSensitive||e.isRegExp||e.isWordMatch)&&i.push({text:Js("flags not supported","Search flags are not supported by GitHub search. Enable indexing for full search features."),type:s.TextSearchCompleteMessageType.Warning});const o=await this.github.searchCodeQuery(e.pattern,t.folder,{maxResults:t.maxResults,context:{before:t.beforeContext,after:t.afterContext}});if(o.warnings&&o.warnings.forEach(c=>{i.push({text:c,type:s.TextSearchCompleteMessageType.Warning})}),o===void 0)return{limitHit:!0,message:i};let a;for(const c of o.matches)a=s.Uri.joinPath(t.folder,c.path),r.report({uri:a,ranges:c.ranges,preview:{text:c.preview,matches:c.matches}});return{limitHit:!1,message:i}}async fsQuery(e,t,r,n){if(n===void 0)return this.github.queryRepositoryObject(e,t,r);const i=`${t}:${be(this.providerService.getCanonicalUri(e))}`;let o=n==null?void 0:n.get(i);return o!==void 0||(o=await this.github.queryRepositoryObject(e,t,r),n==null||n.set(i,o===void 0?null:o)),o!=null?o:void 0}};let Vd=Yn;Vd.scheme="github";function Gd(e){switch(e&&(e=e.toLocaleLowerCase()),e){case"blob":return s.FileType.File;case"tree":return s.FileType.Directory;default:return s.FileType.Unknown}}function na(){return typeof navigator=="object"&&"userAgent"in navigator?navigator.userAgent:typeof process=="object"&&"version"in process?`Node.js/${process.version.substr(1)} (${process.platform}; ${process.arch})`:"<environment undetectable>"}var Rw=ze(5186);/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */function Kd(e){return Object.prototype.toString.call(e)==="[object Object]"}function Qd(e){var t,r;return Kd(e)===!1?!1:(t=e.constructor,t===void 0?!0:(r=t.prototype,!(Kd(r)===!1||r.hasOwnProperty("isPrototypeOf")===!1)))}function kw(e){return e?Object.keys(e).reduce((t,r)=>(t[r.toLowerCase()]=e[r],t),{}):{}}function Zd(e,t){const r=Object.assign({},e);return Object.keys(t).forEach(n=>{Qd(t[n])?n in e?r[n]=Zd(e[n],t[n]):Object.assign(r,{[n]:t[n]}):Object.assign(r,{[n]:t[n]})}),r}function Xd(e){for(const t in e)e[t]===void 0&&delete e[t];return e}function ec(e,t,r){if(typeof t=="string"){let[i,o]=t.split(" ");r=Object.assign(o?{method:i,url:o}:{url:i},r)}else r=Object.assign({},t);r.headers=kw(r.headers),Xd(r),Xd(r.headers);const n=Zd(e||{},r);return e&&e.mediaType.previews.length&&(n.mediaType.previews=e.mediaType.previews.filter(i=>!n.mediaType.previews.includes(i)).concat(n.mediaType.previews)),n.mediaType.previews=n.mediaType.previews.map(i=>i.replace(/-preview/,"")),n}function Dw(e,t){const r=/\?/.test(e)?"&":"?",n=Object.keys(t);return n.length===0?e:e+r+n.map(i=>i==="q"?"q="+t.q.split("+").map(encodeURIComponent).join("+"):`${i}=${encodeURIComponent(t[i])}`).join("&")}const Iw=/\{[^}]+\}/g;function Aw(e){return e.replace(/^\W+|\W+$/g,"").split(/,/)}function Pw(e){const t=e.match(Iw);return t?t.map(Aw).reduce((r,n)=>r.concat(n),[]):[]}function Yd(e,t){return Object.keys(e).filter(r=>!t.includes(r)).reduce((r,n)=>(r[n]=e[n],r),{})}function Jd(e){return e.split(/(%[0-9A-Fa-f]{2})/g).map(function(t){return/%[0-9A-Fa-f]/.test(t)||(t=encodeURI(t).replace(/%5B/g,"[").replace(/%5D/g,"]")),t}).join("")}function Jn(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()})}function Qi(e,t,r){return t=e==="+"||e==="#"?Jd(t):Jn(t),r?Jn(r)+"="+t:t}function ei(e){return e!=null}function tc(e){return e===";"||e==="&"||e==="?"}function Ow(e,t,r,n){var i=e[r],o=[];if(ei(i)&&i!=="")if(typeof i=="string"||typeof i=="number"||typeof i=="boolean")i=i.toString(),n&&n!=="*"&&(i=i.substring(0,parseInt(n,10))),o.push(Qi(t,i,tc(t)?r:""));else if(n==="*")Array.isArray(i)?i.filter(ei).forEach(function(a){o.push(Qi(t,a,tc(t)?r:""))}):Object.keys(i).forEach(function(a){ei(i[a])&&o.push(Qi(t,i[a],a))});else{const a=[];Array.isArray(i)?i.filter(ei).forEach(function(c){a.push(Qi(t,c))}):Object.keys(i).forEach(function(c){ei(i[c])&&(a.push(Jn(c)),a.push(Qi(t,i[c].toString())))}),tc(t)?o.push(Jn(r)+"="+a.join(",")):a.length!==0&&o.push(a.join(","))}else t===";"?ei(i)&&o.push(Jn(r)):i===""&&(t==="&"||t==="?")?o.push(Jn(r)+"="):i===""&&o.push("");return o}function Nw(e){return{expand:Fw.bind(null,e)}}function Fw(e,t){var r=["+","#",".","/",";","?","&"];return e.replace(/\{([^\{\}]+)\}|([^\{\}]+)/g,function(n,i,o){if(i){let c="";const w=[];if(r.indexOf(i.charAt(0))!==-1&&(c=i.charAt(0),i=i.substr(1)),i.split(/,/g).forEach(function(p){var S=/([^:\*]*)(?::(\d+)|(\*))?/.exec(p);w.push(Ow(t,c,S[1],S[2]||S[3]))}),c&&c!=="+"){var a=",";return c==="?"?a="&":c!=="#"&&(a=c),(w.length!==0?c:"")+w.join(a)}else return w.join(",")}else return Jd(o)})}function ef(e){let t=e.method.toUpperCase(),r=(e.url||"/").replace(/:([a-z]\w+)/g,"{$1}"),n=Object.assign({},e.headers),i,o=Yd(e,["method","baseUrl","url","headers","request","mediaType"]);const a=Pw(r);r=Nw(r).expand(o),/^http/.test(r)||(r=e.baseUrl+r);const c=Object.keys(e).filter(S=>a.includes(S)).concat("baseUrl"),w=Yd(o,c);if(!/application\/octet-stream/i.test(n.accept)&&(e.mediaType.format&&(n.accept=n.accept.split(/,/).map(S=>S.replace(/application\/vnd(\.\w+)(\.v3)?(\.\w+)?(\+json)?$/,`application/vnd$1$2.${e.mediaType.format}`)).join(",")),e.mediaType.previews.length)){const S=n.accept.match(/[\w-]+(?=-preview)/g)||[];n.accept=S.concat(e.mediaType.previews).map(P=>{const k=e.mediaType.format?`.${e.mediaType.format}`:"+json";return`application/vnd.github.${P}-preview${k}`}).join(",")}return["GET","HEAD"].includes(t)?r=Dw(r,w):"data"in w?i=w.data:Object.keys(w).length?i=w:n["content-length"]=0,!n["content-type"]&&typeof i!="undefined"&&(n["content-type"]="application/json; charset=utf-8"),["PATCH","PUT"].includes(t)&&typeof i=="undefined"&&(i=""),Object.assign({method:t,url:r,headers:n},typeof i!="undefined"?{body:i}:null,e.request?{request:e.request}:null)}function Lw(e,t,r){return ef(ec(e,t,r))}function tf(e,t){const r=ec(e,t),n=Lw.bind(null,r);return Object.assign(n,{DEFAULTS:r,defaults:tf.bind(null,r),merge:ec.bind(null,r),parse:ef})}const $w=`octokit-endpoint.js/6.0.11 ${na()}`,Mw=tf(null,{method:"GET",baseUrl:"https://api.github.com",headers:{accept:"application/vnd.github.v3+json","user-agent":$w},mediaType:{format:"",previews:[]}}),Uw=Ye.Readable,Ir=Symbol("buffer"),rc=Symbol("type");class ti{constructor(){this[rc]="";const t=arguments[0],r=arguments[1],n=[];let i=0;if(t){const a=t,c=Number(a.length);for(let w=0;w<c;w++){const p=a[w];let S;p instanceof Buffer?S=p:ArrayBuffer.isView(p)?S=Buffer.from(p.buffer,p.byteOffset,p.byteLength):p instanceof ArrayBuffer?S=Buffer.from(p):p instanceof ti?S=p[Ir]:S=Buffer.from(typeof p=="string"?p:String(p)),i+=S.length,n.push(S)}}this[Ir]=Buffer.concat(n);let o=r&&r.type!==void 0&&String(r.type).toLowerCase();o&&!/[^\u0020-\u007E]/.test(o)&&(this[rc]=o)}get size(){return this[Ir].length}get type(){return this[rc]}text(){return Promise.resolve(this[Ir].toString())}arrayBuffer(){const t=this[Ir],r=t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);return Promise.resolve(r)}stream(){const t=new Uw;return t._read=function(){},t.push(this[Ir]),t.push(null),t}toString(){return"[object Blob]"}slice(){const t=this.size,r=arguments[0],n=arguments[1];let i,o;r===void 0?i=0:r<0?i=Math.max(t+r,0):i=Math.min(r,t),n===void 0?o=t:n<0?o=Math.max(t+n,0):o=Math.min(n,t);const a=Math.max(o-i,0),w=this[Ir].slice(i,i+a),p=new ti([],{type:arguments[2]});return p[Ir]=w,p}}Object.defineProperties(ti.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}}),Object.defineProperty(ti.prototype,Symbol.toStringTag,{value:"Blob",writable:!1,enumerable:!1,configurable:!0});function Tt(e,t,r){Error.call(this,e),this.message=e,this.type=t,r&&(this.code=this.errno=r.code),Error.captureStackTrace(this,this.constructor)}Tt.prototype=Object.create(Error.prototype),Tt.prototype.constructor=Tt,Tt.prototype.name="FetchError";let nc;try{nc=require("encoding").convert}catch(e){}const Ar=Symbol("Body internals"),rf=Ye.PassThrough;function pt(e){var t=this,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.size;let i=n===void 0?0:n;var o=r.timeout;let a=o===void 0?0:o;e==null?e=null:nf(e)?e=Buffer.from(e.toString()):Zi(e)||Buffer.isBuffer(e)||(Object.prototype.toString.call(e)==="[object ArrayBuffer]"?e=Buffer.from(e):ArrayBuffer.isView(e)?e=Buffer.from(e.buffer,e.byteOffset,e.byteLength):e instanceof Ye||(e=Buffer.from(String(e)))),this[Ar]={body:e,disturbed:!1,error:null},this.size=i,this.timeout=a,e instanceof Ye&&e.on("error",function(c){const w=c.name==="AbortError"?c:new Tt(`Invalid response body while trying to fetch ${t.url}: ${c.message}`,"system",c);t[Ar].error=w})}pt.prototype={get body(){return this[Ar].body},get bodyUsed(){return this[Ar].disturbed},arrayBuffer(){return ri.call(this).then(function(e){return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)})},blob(){let e=this.headers&&this.headers.get("content-type")||"";return ri.call(this).then(function(t){return Object.assign(new ti([],{type:e.toLowerCase()}),{[Ir]:t})})},json(){var e=this;return ri.call(this).then(function(t){try{return JSON.parse(t.toString())}catch(r){return pt.Promise.reject(new Tt(`invalid json response body at ${e.url} reason: ${r.message}`,"invalid-json"))}})},text(){return ri.call(this).then(function(e){return e.toString()})},buffer(){return ri.call(this)},textConverted(){var e=this;return ri.call(this).then(function(t){return Hw(t,e.headers)})}},Object.defineProperties(pt.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0}}),pt.mixIn=function(e){for(const t of Object.getOwnPropertyNames(pt.prototype))if(!(t in e)){const r=Object.getOwnPropertyDescriptor(pt.prototype,t);Object.defineProperty(e,t,r)}};function ri(){var e=this;if(this[Ar].disturbed)return pt.Promise.reject(new TypeError(`body used already for: ${this.url}`));if(this[Ar].disturbed=!0,this[Ar].error)return pt.Promise.reject(this[Ar].error);let t=this.body;if(t===null)return pt.Promise.resolve(Buffer.alloc(0));if(Zi(t)&&(t=t.stream()),Buffer.isBuffer(t))return pt.Promise.resolve(t);if(!(t instanceof Ye))return pt.Promise.resolve(Buffer.alloc(0));let r=[],n=0,i=!1;return new pt.Promise(function(o,a){let c;e.timeout&&(c=setTimeout(function(){i=!0,a(new Tt(`Response timeout while trying to fetch ${e.url} (over ${e.timeout}ms)`,"body-timeout"))},e.timeout)),t.on("error",function(w){w.name==="AbortError"?(i=!0,a(w)):a(new Tt(`Invalid response body while trying to fetch ${e.url}: ${w.message}`,"system",w))}),t.on("data",function(w){if(!(i||w===null)){if(e.size&&n+w.length>e.size){i=!0,a(new Tt(`content size at ${e.url} over limit: ${e.size}`,"max-size"));return}n+=w.length,r.push(w)}}),t.on("end",function(){if(!i){clearTimeout(c);try{o(Buffer.concat(r,n))}catch(w){a(new Tt(`Could not create Buffer from response body for ${e.url}: ${w.message}`,"system",w))}}})})}function Hw(e,t){if(typeof nc!="function")throw new Error("The package `encoding` must be installed to use the textConverted() function");const r=t.get("content-type");let n="utf-8",i,o;return r&&(i=/charset=([^;]*)/i.exec(r)),o=e.slice(0,1024).toString(),!i&&o&&(i=/<meta.+?charset=(['"])(.+?)\1/i.exec(o)),!i&&o&&(i=/<meta[\s]+?http-equiv=(['"])content-type\1[\s]+?content=(['"])(.+?)\2/i.exec(o),i||(i=/<meta[\s]+?content=(['"])(.+?)\1[\s]+?http-equiv=(['"])content-type\3/i.exec(o),i&&i.pop()),i&&(i=/charset=(.*)/i.exec(i.pop()))),!i&&o&&(i=/<\?xml.+?encoding=(['"])(.+?)\1/i.exec(o)),i&&(n=i.pop(),(n==="gb2312"||n==="gbk")&&(n="gb18030")),nc(e,"UTF-8",n).toString()}function nf(e){return typeof e!="object"||typeof e.append!="function"||typeof e.delete!="function"||typeof e.get!="function"||typeof e.getAll!="function"||typeof e.has!="function"||typeof e.set!="function"?!1:e.constructor.name==="URLSearchParams"||Object.prototype.toString.call(e)==="[object URLSearchParams]"||typeof e.sort=="function"}function Zi(e){return typeof e=="object"&&typeof e.arrayBuffer=="function"&&typeof e.type=="string"&&typeof e.stream=="function"&&typeof e.constructor=="function"&&typeof e.constructor.name=="string"&&/^(Blob|File)$/.test(e.constructor.name)&&/^(Blob|File)$/.test(e[Symbol.toStringTag])}function of(e){let t,r,n=e.body;if(e.bodyUsed)throw new Error("cannot clone body after it is used");return n instanceof Ye&&typeof n.getBoundary!="function"&&(t=new rf,r=new rf,n.pipe(t),n.pipe(r),e[Ar].body=t,n=r),n}function af(e){return e===null?null:typeof e=="string"?"text/plain;charset=UTF-8":nf(e)?"application/x-www-form-urlencoded;charset=UTF-8":Zi(e)?e.type||null:Buffer.isBuffer(e)||Object.prototype.toString.call(e)==="[object ArrayBuffer]"||ArrayBuffer.isView(e)?null:typeof e.getBoundary=="function"?`multipart/form-data;boundary=${e.getBoundary()}`:e instanceof Ye?null:"text/plain;charset=UTF-8"}function sf(e){const t=e.body;return t===null?0:Zi(t)?t.size:Buffer.isBuffer(t)?t.length:t&&typeof t.getLengthSync=="function"&&(t._lengthRetrievers&&t._lengthRetrievers.length==0||t.hasKnownLength&&t.hasKnownLength())?t.getLengthSync():null}function Bw(e,t){const r=t.body;r===null?e.end():Zi(r)?r.stream().pipe(e):Buffer.isBuffer(r)?(e.write(r),e.end()):r.pipe(e)}pt.Promise=global.Promise;const cf=/[^\^_`a-zA-Z\-0-9!#$%&'*+.|~]/,ic=/[^\t\x20-\x7e\x80-\xff]/;function Xi(e){if(e=`${e}`,cf.test(e)||e==="")throw new TypeError(`${e} is not a legal HTTP header name`)}function uf(e){if(e=`${e}`,ic.test(e))throw new TypeError(`${e} is not a legal HTTP header value`)}function ni(e,t){t=t.toLowerCase();for(const r in e)if(r.toLowerCase()===t)return r}const ut=Symbol("map");class Zt{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:void 0;if(this[ut]=Object.create(null),t instanceof Zt){const r=t.raw(),n=Object.keys(r);for(const i of n)for(const o of r[i])this.append(i,o);return}if(t!=null)if(typeof t=="object"){const r=t[Symbol.iterator];if(r!=null){if(typeof r!="function")throw new TypeError("Header pairs must be iterable");const n=[];for(const i of t){if(typeof i!="object"||typeof i[Symbol.iterator]!="function")throw new TypeError("Each header pair must be iterable");n.push(Array.from(i))}for(const i of n){if(i.length!==2)throw new TypeError("Each header pair must be a name/value tuple");this.append(i[0],i[1])}}else for(const n of Object.keys(t)){const i=t[n];this.append(n,i)}}else throw new TypeError("Provided initializer must be an object")}get(t){t=`${t}`,Xi(t);const r=ni(this[ut],t);return r===void 0?null:this[ut][r].join(", ")}forEach(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,n=oc(this),i=0;for(;i<n.length;){var o=n[i];const a=o[0],c=o[1];t.call(r,c,a,this),n=oc(this),i++}}set(t,r){t=`${t}`,r=`${r}`,Xi(t),uf(r);const n=ni(this[ut],t);this[ut][n!==void 0?n:t]=[r]}append(t,r){t=`${t}`,r=`${r}`,Xi(t),uf(r);const n=ni(this[ut],t);n!==void 0?this[ut][n].push(r):this[ut][t]=[r]}has(t){return t=`${t}`,Xi(t),ni(this[ut],t)!==void 0}delete(t){t=`${t}`,Xi(t);const r=ni(this[ut],t);r!==void 0&&delete this[ut][r]}raw(){return this[ut]}keys(){return sc(this,"key")}values(){return sc(this,"value")}[Symbol.iterator](){return sc(this,"key+value")}}Zt.prototype.entries=Zt.prototype[Symbol.iterator],Object.defineProperty(Zt.prototype,Symbol.toStringTag,{value:"Headers",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(Zt.prototype,{get:{enumerable:!0},forEach:{enumerable:!0},set:{enumerable:!0},append:{enumerable:!0},has:{enumerable:!0},delete:{enumerable:!0},keys:{enumerable:!0},values:{enumerable:!0},entries:{enumerable:!0}});function oc(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"key+value";return Object.keys(e[ut]).sort().map(t==="key"?function(n){return n.toLowerCase()}:t==="value"?function(n){return e[ut][n].join(", ")}:function(n){return[n.toLowerCase(),e[ut][n].join(", ")]})}const ac=Symbol("internal");function sc(e,t){const r=Object.create(cc);return r[ac]={target:e,kind:t,index:0},r}const cc=Object.setPrototypeOf({next(){if(!this||Object.getPrototypeOf(this)!==cc)throw new TypeError("Value of `this` is not a HeadersIterator");var e=this[ac];const t=e.target,r=e.kind,n=e.index,i=oc(t,r),o=i.length;return n>=o?{value:void 0,done:!0}:(this[ac].index=n+1,{value:i[n],done:!1})}},Object.getPrototypeOf(Object.getPrototypeOf([][Symbol.iterator]())));Object.defineProperty(cc,Symbol.toStringTag,{value:"HeadersIterator",writable:!1,enumerable:!1,configurable:!0});function jw(e){const t=Object.assign({__proto__:null},e[ut]),r=ni(e[ut],"Host");return r!==void 0&&(t[r]=t[r][0]),t}function zw(e){const t=new Zt;for(const r of Object.keys(e))if(!cf.test(r))if(Array.isArray(e[r]))for(const n of e[r])ic.test(n)||(t[ut][r]===void 0?t[ut][r]=[n]:t[ut][r].push(n));else ic.test(e[r])||(t[ut][r]=[e[r]]);return t}const Qr=Symbol("Response internals"),qw=vn.STATUS_CODES;class gr{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};pt.call(this,t,r);const n=r.status||200,i=new Zt(r.headers);if(t!=null&&!i.has("Content-Type")){const o=af(t);o&&i.append("Content-Type",o)}this[Qr]={url:r.url,status:n,statusText:r.statusText||qw[n],headers:i,counter:r.counter}}get url(){return this[Qr].url||""}get status(){return this[Qr].status}get ok(){return this[Qr].status>=200&&this[Qr].status<300}get redirected(){return this[Qr].counter>0}get statusText(){return this[Qr].statusText}get headers(){return this[Qr].headers}clone(){return new gr(of(this),{url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected})}}pt.mixIn(gr.prototype),Object.defineProperties(gr.prototype,{url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}}),Object.defineProperty(gr.prototype,Symbol.toStringTag,{value:"Response",writable:!1,enumerable:!1,configurable:!0});const Pr=Symbol("Request internals"),uc=Wo.parse,Ww=Wo.format,Vw="destroy"in Ye.Readable.prototype;function ia(e){return typeof e=="object"&&typeof e[Pr]=="object"}function Gw(e){const t=e&&typeof e=="object"&&Object.getPrototypeOf(e);return!!(t&&t.constructor.name==="AbortSignal")}class wn{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n;ia(t)?n=uc(t.url):(t&&t.href?n=uc(t.href):n=uc(`${t}`),t={});let i=r.method||t.method||"GET";if(i=i.toUpperCase(),(r.body!=null||ia(t)&&t.body!==null)&&(i==="GET"||i==="HEAD"))throw new TypeError("Request with GET/HEAD method cannot have body");let o=r.body!=null?r.body:ia(t)&&t.body!==null?of(t):null;pt.call(this,o,{timeout:r.timeout||t.timeout||0,size:r.size||t.size||0});const a=new Zt(r.headers||t.headers||{});if(o!=null&&!a.has("Content-Type")){const w=af(o);w&&a.append("Content-Type",w)}let c=ia(t)?t.signal:null;if("signal"in r&&(c=r.signal),c!=null&&!Gw(c))throw new TypeError("Expected signal to be an instanceof AbortSignal");this[Pr]={method:i,redirect:r.redirect||t.redirect||"follow",headers:a,parsedURL:n,signal:c},this.follow=r.follow!==void 0?r.follow:t.follow!==void 0?t.follow:20,this.compress=r.compress!==void 0?r.compress:t.compress!==void 0?t.compress:!0,this.counter=r.counter||t.counter||0,this.agent=r.agent||t.agent}get method(){return this[Pr].method}get url(){return Ww(this[Pr].parsedURL)}get headers(){return this[Pr].headers}get redirect(){return this[Pr].redirect}get signal(){return this[Pr].signal}clone(){return new wn(this)}}pt.mixIn(wn.prototype),Object.defineProperty(wn.prototype,Symbol.toStringTag,{value:"Request",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(wn.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0}});function Kw(e){const t=e[Pr].parsedURL,r=new Zt(e[Pr].headers);if(r.has("Accept")||r.set("Accept","*/*"),!t.protocol||!t.hostname)throw new TypeError("Only absolute URLs are supported");if(!/^https?:$/.test(t.protocol))throw new TypeError("Only HTTP(S) protocols are supported");if(e.signal&&e.body instanceof Ye.Readable&&!Vw)throw new Error("Cancellation of streamed requests with AbortSignal is not supported in node < 8");let n=null;if(e.body==null&&/^(POST|PUT)$/i.test(e.method)&&(n="0"),e.body!=null){const o=sf(e);typeof o=="number"&&(n=String(o))}n&&r.set("Content-Length",n),r.has("User-Agent")||r.set("User-Agent","node-fetch/1.0 (+https://github.com/bitinn/node-fetch)"),e.compress&&!r.has("Accept-Encoding")&&r.set("Accept-Encoding","gzip,deflate");let i=e.agent;return typeof i=="function"&&(i=i(t)),!r.has("Connection")&&!i&&r.set("Connection","close"),Object.assign({},t,{method:e.method,headers:jw(r),agent:i})}function Yi(e){Error.call(this,e),this.type="aborted",this.message=e,Error.captureStackTrace(this,this.constructor)}Yi.prototype=Object.create(Error.prototype),Yi.prototype.constructor=Yi,Yi.prototype.name="AbortError";const lf=Ye.PassThrough,Qw=Wo.resolve;function Zr(e,t){if(!Zr.Promise)throw new Error("native promise missing, set fetch.Promise to your favorite alternative");return pt.Promise=Zr.Promise,new Zr.Promise(function(r,n){const i=new wn(e,t),o=Kw(i),a=(o.protocol==="https:"?ud:vn).request,c=i.signal;let w=null;const p=function(){let B=new Yi("The user aborted a request.");n(B),i.body&&i.body instanceof Ye.Readable&&i.body.destroy(B),!(!w||!w.body)&&w.body.emit("error",B)};if(c&&c.aborted){p();return}const S=function(){p(),I()},P=a(o);let k;c&&c.addEventListener("abort",S);function I(){P.abort(),c&&c.removeEventListener("abort",S),clearTimeout(k)}i.timeout&&P.once("socket",function($){k=setTimeout(function(){n(new Tt(`network timeout at: ${i.url}`,"request-timeout")),I()},i.timeout)}),P.on("error",function($){n(new Tt(`request to ${i.url} failed, reason: ${$.message}`,"system",$)),I()}),P.on("response",function($){clearTimeout(k);const B=zw($.headers);if(Zr.isRedirect($.statusCode)){const ee=B.get("Location"),se=ee===null?null:Qw(i.url,ee);switch(i.redirect){case"error":n(new Tt(`uri requested responds with a redirect, redirect mode is set to error: ${i.url}`,"no-redirect")),I();return;case"manual":if(se!==null)try{B.set("Location",se)}catch(me){n(me)}break;case"follow":if(se===null)break;if(i.counter>=i.follow){n(new Tt(`maximum redirect reached at: ${i.url}`,"max-redirect")),I();return}const Se={headers:new Zt(i.headers),follow:i.follow,counter:i.counter+1,agent:i.agent,compress:i.compress,method:i.method,body:i.body,signal:i.signal,timeout:i.timeout,size:i.size};if($.statusCode!==303&&i.body&&sf(i)===null){n(new Tt("Cannot follow redirect with body being a readable stream","unsupported-redirect")),I();return}($.statusCode===303||($.statusCode===301||$.statusCode===302)&&i.method==="POST")&&(Se.method="GET",Se.body=void 0,Se.headers.delete("content-length")),r(Zr(new wn(se,Se))),I();return}}$.once("end",function(){c&&c.removeEventListener("abort",S)});let q=$.pipe(new lf);const Z={url:i.url,status:$.statusCode,statusText:$.statusMessage,headers:B,size:i.size,timeout:i.timeout,counter:i.counter},K=B.get("Content-Encoding");if(!i.compress||i.method==="HEAD"||K===null||$.statusCode===204||$.statusCode===304){w=new gr(q,Z),r(w);return}const re={flush:Ft.Z_SYNC_FLUSH,finishFlush:Ft.Z_SYNC_FLUSH};if(K=="gzip"||K=="x-gzip"){q=q.pipe(Ft.createGunzip(re)),w=new gr(q,Z),r(w);return}if(K=="deflate"||K=="x-deflate"){$.pipe(new lf).once("data",function(se){(se[0]&15)==8?q=q.pipe(Ft.createInflate()):q=q.pipe(Ft.createInflateRaw()),w=new gr(q,Z),r(w)});return}if(K=="br"&&typeof Ft.createBrotliDecompress=="function"){q=q.pipe(Ft.createBrotliDecompress()),w=new gr(q,Z),r(w);return}w=new gr(q,Z),r(w)}),Bw(P,i)})}Zr.isRedirect=function(e){return e===301||e===302||e===303||e===307||e===308},Zr.Promise=global.Promise;const Zw=Zr;class Xw extends Error{constructor(t){super(t);Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="Deprecation"}}var Yw=ze(778),Jw=ze.n(Yw);const eb=Jw()(e=>console.warn(e));class bn extends Error{constructor(t,r,n){super(t);Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="HttpError",this.status=r,Object.defineProperty(this,"code",{get(){return eb(new Xw("[@octokit/request-error] `error.code` is deprecated, use `error.status`.")),r}}),this.headers=n.headers||{};const i=Object.assign({},n.request);n.request.headers.authorization&&(i.headers=Object.assign({},n.request.headers,{authorization:n.request.headers.authorization.replace(/ .*$/," [REDACTED]")})),i.url=i.url.replace(/\bclient_secret=\w+/g,"client_secret=[REDACTED]").replace(/\baccess_token=\w+/g,"access_token=[REDACTED]"),this.request=i}}const tb="5.4.15";function rb(e){return e.arrayBuffer()}function df(e){(Qd(e.body)||Array.isArray(e.body))&&(e.body=JSON.stringify(e.body));let t={},r,n;return(e.request&&e.request.fetch||Zw)(e.url,Object.assign({method:e.method,body:e.body,headers:e.headers,redirect:e.redirect},e.request)).then(o=>{n=o.url,r=o.status;for(const c of o.headers)t[c[0]]=c[1];if(r===204||r===205)return;if(e.method==="HEAD"){if(r<400)return;throw new bn(o.statusText,r,{headers:t,request:e})}if(r===304)throw new bn("Not modified",r,{headers:t,request:e});if(r>=400)return o.text().then(c=>{const w=new bn(c,r,{headers:t,request:e});try{let p=JSON.parse(w.message);Object.assign(w,p);let S=p.errors;w.message=w.message+": "+S.map(JSON.stringify).join(", ")}catch(p){}throw w});const a=o.headers.get("content-type");return/application\/json/.test(a)?o.json():!a||/^text\/|charset=utf-8$/.test(a)?o.text():rb(o)}).then(o=>({status:r,url:n,headers:t,data:o})).catch(o=>{throw o instanceof bn?o:new bn(o.message,500,{headers:t,request:e})})}function lc(e,t){const r=e.defaults(t);return Object.assign(function(i,o){const a=r.merge(i,o);if(!a.request||!a.request.hook)return df(r.parse(a));const c=(w,p)=>df(r.parse(r.merge(w,p)));return Object.assign(c,{endpoint:r,defaults:lc.bind(null,r)}),a.request.hook(c,a)},{endpoint:r,defaults:lc.bind(null,r)})}const oa=lc(Mw,{headers:{"user-agent":`octokit-request.js/${tb} ${na()}`}}),nb="4.6.2";class ib extends Error{constructor(t,r){const n=r.data.errors[0].message;super(n);Object.assign(this,r.data),Object.assign(this,{headers:r.headers}),this.name="GraphqlError",this.request=t,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}const ob=["method","baseUrl","url","headers","request","query","mediaType"],ab=["query","method","url"],ff=/\/api\/v3\/?$/;function sb(e,t,r){if(r){if(typeof t=="string"&&"query"in r)return Promise.reject(new Error('[@octokit/graphql] "query" cannot be used as variable name'));for(const a in r)if(!!ab.includes(a))return Promise.reject(new Error(`[@octokit/graphql] "${a}" cannot be used as variable name`))}const n=typeof t=="string"?Object.assign({query:t},r):t,i=Object.keys(n).reduce((a,c)=>ob.includes(c)?(a[c]=n[c],a):(a.variables||(a.variables={}),a.variables[c]=n[c],a),{}),o=n.baseUrl||e.endpoint.DEFAULTS.baseUrl;return ff.test(o)&&(i.url=o.replace(ff,"/api/graphql")),e(i).then(a=>{if(a.data.errors){const c={};for(const w of Object.keys(a.headers))c[w]=a.headers[w];throw new ib(i,{headers:c,data:a.data})}return a.data.data})}function dc(e,t){const r=e.defaults(t);return Object.assign((i,o)=>sb(r,i,o),{defaults:dc.bind(null,r),endpoint:oa.endpoint})}const j_=dc(oa,{headers:{"user-agent":`octokit-graphql.js/${nb} ${na()}`},method:"POST",url:"/graphql"});function cb(e){return dc(e,{method:"POST",url:"/graphql"})}async function ub(e){const t=e.split(/\./).length===3?"app":/^v\d+\./.test(e)?"installation":"oauth";return{type:"token",token:e,tokenType:t}}function lb(e){return e.split(/\./).length===3?`bearer ${e}`:`token ${e}`}async function db(e,t,r,n){const i=t.endpoint.merge(r,n);return i.headers.authorization=lb(e),t(i)}const fb=function(t){if(!t)throw new Error("[@octokit/auth-token] No token passed to createTokenAuth");if(typeof t!="string")throw new Error("[@octokit/auth-token] Token passed to createTokenAuth is not a string");return t=t.replace(/^(token|bearer) +/i,""),Object.assign(ub.bind(null,t),{hook:db.bind(null,t)})},hf="3.4.0";class fc{constructor(t={}){const r=new Rw.Collection,n={baseUrl:oa.endpoint.DEFAULTS.baseUrl,headers:{},request:Object.assign({},t.request,{hook:r.bind(null,"request")}),mediaType:{previews:[],format:""}};if(n.headers["user-agent"]=[t.userAgent,`octokit-core.js/${hf} ${na()}`].filter(Boolean).join(" "),t.baseUrl&&(n.baseUrl=t.baseUrl),t.previews&&(n.mediaType.previews=t.previews),t.timeZone&&(n.headers["time-zone"]=t.timeZone),this.request=oa.defaults(n),this.graphql=cb(this.request).defaults(n),this.log=Object.assign({debug:()=>{},info:()=>{},warn:console.warn.bind(console),error:console.error.bind(console)},t.log),this.hook=r,t.authStrategy){const{authStrategy:o,...a}=t,c=o(Object.assign({request:this.request,log:this.log,octokit:this,octokitOptions:a},t.auth));r.wrap("request",c.hook),this.auth=c}else if(!t.auth)this.auth=async()=>({type:"unauthenticated"});else{const o=fb(t.auth);r.wrap("request",o.hook),this.auth=o}this.constructor.plugins.forEach(o=>{Object.assign(this,o(this,t))})}static defaults(t){return class extends this{constructor(...n){const i=n[0]||{};if(typeof t=="function"){super(t(i));return}super(Object.assign({},t,i,i.userAgent&&t.userAgent?{userAgent:`${i.userAgent} ${t.userAgent}`}:null))}}}static plugin(...t){var r;const n=this.plugins;return r=class extends this{},r.plugins=n.concat(t.filter(o=>!n.includes(o))),r}}fc.VERSION=hf,fc.plugins=[];var pf;(function(e){e[e.Force=0]="Force",e[e.ForceWithLease=1]="ForceWithLease"})(pf||(pf={}));var ii;(function(e){e[e.Head=0]="Head",e[e.RemoteHead=1]="RemoteHead",e[e.Tag=2]="Tag"})(ii||(ii={}));var Ji;(function(e){e[e.INDEX_MODIFIED=0]="INDEX_MODIFIED",e[e.INDEX_ADDED=1]="INDEX_ADDED",e[e.INDEX_DELETED=2]="INDEX_DELETED",e[e.INDEX_RENAMED=3]="INDEX_RENAMED",e[e.INDEX_COPIED=4]="INDEX_COPIED",e[e.MODIFIED=5]="MODIFIED",e[e.DELETED=6]="DELETED",e[e.UNTRACKED=7]="UNTRACKED",e[e.IGNORED=8]="IGNORED",e[e.INTENT_TO_ADD=9]="INTENT_TO_ADD",e[e.ADDED_BY_US=10]="ADDED_BY_US",e[e.ADDED_BY_THEM=11]="ADDED_BY_THEM",e[e.DELETED_BY_US=12]="DELETED_BY_US",e[e.DELETED_BY_THEM=13]="DELETED_BY_THEM",e[e.BOTH_ADDED=14]="BOTH_ADDED",e[e.BOTH_DELETED=15]="BOTH_DELETED",e[e.BOTH_MODIFIED=16]="BOTH_MODIFIED"})(Ji||(Ji={}));var gf;(function(e){e.BadConfigFile="BadConfigFile",e.AuthenticationFailed="AuthenticationFailed",e.NoUserNameConfigured="NoUserNameConfigured",e.NoUserEmailConfigured="NoUserEmailConfigured",e.NoRemoteRepositorySpecified="NoRemoteRepositorySpecified",e.NotAGitRepository="NotAGitRepository",e.NotAtRepositoryRoot="NotAtRepositoryRoot",e.Conflict="Conflict",e.StashConflict="StashConflict",e.UnmergedChanges="UnmergedChanges",e.PushRejected="PushRejected",e.RemoteConnectionError="RemoteConnectionError",e.DirtyWorkTree="DirtyWorkTree",e.CantOpenResource="CantOpenResource",e.GitNotFound="GitNotFound",e.CantCreatePipe="CantCreatePipe",e.PermissionDenied="PermissionDenied",e.CantAccessRemote="CantAccessRemote",e.RepositoryNotFound="RepositoryNotFound",e.RepositoryIsLocked="RepositoryIsLocked",e.BranchNotFullyMerged="BranchNotFullyMerged",e.NoRemoteReference="NoRemoteReference",e.InvalidBranchName="InvalidBranchName",e.BranchAlreadyExists="BranchAlreadyExists",e.NoLocalChanges="NoLocalChanges",e.NoStashFound="NoStashFound",e.LocalChangesOverwritten="LocalChangesOverwritten",e.NoUpstreamBranch="NoUpstreamBranch",e.IsInSubmodule="IsInSubmodule",e.WrongCase="WrongCase",e.CantLockRef="CantLockRef",e.CantRebaseMultipleBranches="CantRebaseMultipleBranches",e.PatchDoesNotApply="PatchDoesNotApply",e.NoPathFound="NoPathFound",e.UnknownPath="UnknownPath"})(gf||(gf={}));function hb(e,t){return e.reduce((n,i)=>{const o=t(i),a=n.get(o);return a===void 0?n.set(o,[i]):a.push(i),n},new Map)}function hc(e,t,r=n=>n){return[...e.reduce((i,o)=>{const a=t(o),c=i.get(a);if(c===void 0)i.set(a,o);else{const w=r(c,o);w!==void 0&&i.set(a,w)}return i},new Map).values()]}const pb="github-pr-owner-number";function gb(e){return`branch.${e}.${pb}`}const mb=(0,E.LV)(),vb=new TextDecoder;class yb{constructor(t,r,n,i,o,a){this.providerService=t,this.rootUri=r,this.sourceControl=n,this.metadata=i,this.changeStore=o,this.github=a,this._onDidChangeSelection=new s.EventEmitter,this._onDidChangeState=new s.EventEmitter;var c;this.disposable=s.Disposable.from(this.sourceControl.onDidChangeSelection(()=>this._onDidChangeSelection.fire()),this.providerService.onDidRefresh(S=>{const P=be(this.rootUri);!S.some(k=>be(k)===P)||this.updateState()}),this.changeStore.onDidChange(()=>this.updateState()),this._onDidChangeSelection,this._onDidChangeState),this._inputBox={get value(){return n.inputBox.value}},this._ui={get selected(){return n.selected},onDidChange:this._onDidChangeSelection.event};const{repo:{owner:w,name:p}}=i;this.remote={name:"origin",fetchUrl:`https://github.com/${w}/${p}.git`,isReadOnly:i.accessLevel>=xt.Write},this.remotes=[this.remote],i.pullRequest&&(i.pullRequest.repo.owner!==w||i.pullRequest.repo.name!==p)&&this.remotes.push({name:"upstream",fetchUrl:`https://github.com/${i.pullRequest.repo.owner}/${i.pullRequest.repo.name}.git`,isReadOnly:!0}),this._state={HEAD:((c=i.HEAD.detached)==null?void 0:c.type)===nt.Tag?{type:ii.Tag,name:i.HEAD.detached.name,commit:i.HEAD.sha}:i.HEAD.branch?{type:ii.Head,commit:i.HEAD.sha,name:i.HEAD.branch.name,upstream:{name:i.HEAD.branch.name,remote:this.remote.name}}:void 0,mergeChanges:[],indexChanges:[],workingTreeChanges:[],onDidChange:this._onDidChangeState.event,rebaseCommit:void 0,refs:[],remotes:this.remotes,submodules:[]},this.updateState()}dispose(){this.disposable.dispose()}get inputBox(){return this._inputBox}get state(){return this._state}get ui(){return this._ui}async updateState(){const t=await this.changeStore.getGroupedChanges(this.rootUri,{predicate:a=>a.fileType===s.FileType.File}),r=t.conflicts.map(a=>({uri:a.uri,status:pc(a.type),originalUri:a.uri,renameUri:a.uri})),n=t.staged.map(a=>({uri:a.uri,status:pc(a.type),originalUri:a.uri,renameUri:a.uri})),i=t.working.map(a=>({uri:a.uri,status:pc(a.type),originalUri:a.uri,renameUri:a.uri})),o=He.get("staging.enabled");this._state={...this._state,mergeChanges:r,indexChanges:o?n:[],workingTreeChanges:o?i:[...n,...i]},this._onDidChangeState.fire()}getConfigs(){return Promise.resolve([])}async getConfig(t){if(!this.metadata.HEAD.branch)return"";if(t===gb(this.metadata.HEAD.branch.name)){const r=await this.github.getPullRequestForBranch(this.rootUri,this.metadata.HEAD.branch.name);if(r!==void 0)return`${r.repo.owner}#${r.repo.name}#${r.id}`}return""}setConfig(t,r){return Promise.resolve("")}getGlobalConfig(t){throw new Error("Method not implemented.")}async getObjectDetails(t,r){return this.github.getObjectDetails(this.rootUri,t,mf(r))}detectObjectType(t){return Promise.resolve({mimetype:"text/plain"})}buffer(t,r){throw new Error("Method not implemented.")}async show(t,r){const n=await this.github.getFileContent(this.rootUri,t,mf(r));return vb.decode(n)}async getCommit(t){const r=await this.github.getCommit(this.rootUri,t);if(r===void 0)throw new Error(`Unable to find commit for ref "${t}"`);return r}clean(t){throw new Error("Method not implemented.")}apply(t,r){throw new Error("Method not implemented.")}diff(t){throw new Error("Method not implemented.")}diffWithHEAD(t){if(t)return"";throw new Error("Method not implemented.")}diffWith(t,r){throw new Error("Method not implemented.")}diffIndexWithHEAD(t){throw new Error("Method not implemented.")}diffIndexWith(t,r){throw new Error("Method not implemented.")}diffBlobs(t,r){throw new Error("Method not implemented.")}diffBetween(t,r,n){throw new Error("Method not implemented.")}hashObject(t){throw new Error("Method not implemented.")}async createBranch(t,r,n){n||(n=this.metadata.HEAD.sha);const i=await this.github.createBranch(this.rootUri,t,n);r&&await this.checkout(i)}deleteBranch(t,r){throw new Error("Method not implemented.")}async getBranch(t){const{branches:r}=await this.github.getBranches(this.rootUri,{query:t,limit:1}),[n]=r;if(n===void 0)throw new Error(`Unable to find branch named "${t}"`);return{type:n.type,name:n.name,commit:n.commit,remote:this.remote.name,upstream:{name:n.name,remote:n.commitUrl}}}async getBranches(t){var r,n;const{branches:i}=await this.github.getBranches(this.rootUri,{query:(n=(r=t.contains)!=null?r:t.pattern)!=null?n:"",limit:t.count});if(i.length===0)throw new Error(`Unable to find branches for "${t.contains}"`);return i.map(o=>({type:o.type,name:o.name,commit:o.commit}))}setBranchUpstream(t,r){throw new Error("Method not implemented.")}getMergeBase(t,r){throw new Error("Method not implemented.")}async status(){}async checkout(t){const r=await this.github.switchTo(this.rootUri,t,{openInNewWindow:!1});throw r!==void 0&&await Vt(r),new Error("User aborted")}addRemote(t,r){var n;let i;const o=this.remotes.findIndex(a=>a.name===t);return o!==-1&&([i]=this.remotes.splice(o,1)),this.remotes.push({name:t,fetchUrl:r,isReadOnly:(n=i==null?void 0:i.isReadOnly)!=null?n:!1}),Promise.resolve()}removeRemote(t){const r=this.remotes.findIndex(n=>n.name===t);return r!==-1&&this.remotes.splice(r,1),Promise.resolve()}renameRemote(t,r){const n=this.remotes.findIndex(o=>o.name===t);if(n===-1)return Promise.resolve();const[i]=this.remotes.splice(n,1);return this.remotes.push({...i,name:r}),Promise.resolve()}async fetch(t,r,n){return this.github.fetch(this.rootUri)}async pull(t){return this.github.sync(this.rootUri,this.changeStore,{conflictResolution:wr.Merge})}push(t,r,n){throw new Error("Method not implemented.")}blame(t){throw new Error("Method not implemented.")}async log(t){if((t==null?void 0:t.maxEntries)!==1||(t==null?void 0:t.path)!==void 0)throw new Error("The specified log options are not yet supported.");return[await this.getCommit(this.metadata.HEAD.sha)]}async commit(t,r){if((r==null?void 0:r.amend)!==void 0||(r==null?void 0:r.empty)!==void 0||(r==null?void 0:r.signCommit)!==void 0||(r==null?void 0:r.signoff)!==void 0)throw new Error("The specified commit options are not yet supported.");const n=await this.providerService.getCommitOperations(this.rootUri,this.changeStore,{staged:(r==null?void 0:r.all)===!1});if(!n.length){s.window.showInformationMessage(mb("no changes to commit","There are no changes to commit."));return}await this.github.createCommit(this.rootUri,t,n)}}const wb=/^\/?([a-zA-Z])(?::\/)(.*)$/,bb=/\\/g;function mf(e){e=s.Uri.file(e).fsPath.replace(bb,"/");const t=wb.exec(e);return t!==null&&([,,e]=t),e.startsWith("/")?e.substr(1):e}function pc(e){switch(e){case Be.Changed:return Ji.MODIFIED;case Be.Created:return Ji.INTENT_TO_ADD;case Be.Deleted:return Ji.DELETED}}var _b=Object.defineProperty,Cb=Object.getOwnPropertyDescriptor,Sb=(e,t,r,n)=>{for(var i=n>1?void 0:n?Cb(t,r):t,o=e.length-1,a;o>=0;o--)(a=e[o])&&(i=(n?a(t,r,i):a(i))||i);return n&&i&&_b(t,r,i),i};const At=(0,E.LV)(),vf=/^https:\/\/github\.com\/(?<owner>[^/]+)\/(?<repo>[^/]+?)(?:\/(?:tree\/(?<tree>.+)|blob\/(?<blob>.+)|commit\/(?<commit>[0-9a-f]{40})|pull\/(?<pull>[0-9]+)))?(?:\/|\.git$|(?:#(?<hash>.*))?$)/i,aa=1;function eo(e){const{scheme:t,metadata:r}=Je.decodeAuthority(e,a=>{if(a.v!==void 0)return a;if(typeof a.pr=="string")return{v:aa,ref:{type:We.PullRequest,id:a.pr},idx:a.idx};if(typeof a.ref=="string")return{v:aa,ref:{type:We.Tree,id:a.ref},idx:a.idx}}),[,n,i,...o]=e.path.split("/");return{scheme:t,repo:{owner:n,name:i},path:o.join("/")||"",ref:r==null?void 0:r.ref,idx:r==null?void 0:r.idx}}function Eb(e,t){const{repo:r}=t!=null?t:eo(e);return e.with({path:`/${r.owner}/${r.name}`})}function gc(e,t,r){const{repo:{owner:n,name:i}}=e instanceof s.Uri?eo(e):e;return s.Uri.parse(`github://${Je.encodeAuthority("github",{v:aa,ref:{type:We.Commit,id:t}})}/${n}/${i}/${r}`)}class yf{constructor(t){this.providerService=t}dispose(){}async ensureAuthenticated(){if(this._session===void 0){async function t(){try{return await s.authentication.getSession("github",["repo"],{createIfNone:!0})}catch{try{const n=await s.authentication.getSession("github",["repo"],{createIfNone:!1});if(n!==void 0)return n}catch{}return new Promise(async n=>{async function i(){const a=await s.authentication.getSession("github",["repo"],{createIfNone:!0});a!==void 0&&n(a)}if(s.authentication.providers.some(a=>a.id==="github")){await i();return}const o=s.authentication.onDidChangeSessions(async a=>{a.provider.id==="github"&&(o.dispose(),await i())})})}}this._session=await t();const r=s.authentication.onDidChangeSessions(n=>{if(this._session===void 0){r.dispose();return}n.provider.id==="github"&&(this._session=void 0,this._octokit=void 0,this._octokitDefaults=void 0,r.dispose())})}return this._session}async octokit(t){if(this._octokitDefaults===void 0){const n=await this.ensureAuthenticated();this._octokitDefaults=fc.defaults({auth:`token ${n.accessToken}`})}const r=new this._octokitDefaults(t);return(he.logLevel===Ke.Debug||he.isDebugging)&&r.hook.wrap("request",async(n,i)=>{var o;const a=new Qe(`[GITHUB] ${i.method} ${i.url}`);try{return await n(i)}finally{let c;try{if(typeof i.query=="string"){const w=/(^[^({\n]+)/.exec(i.query);c=` ${(o=w==null?void 0:w[1].trim())!=null?o:i.query}`}}catch{}a.stop({message:c})}}),r}async graphql(t,r){return this._octokit===void 0&&(this._octokit=await this.octokit()),this._octokit.graphql(t,r)}async request(t,r){return this._octokit===void 0&&(this._octokit=await this.octokit()),this._octokit.request(t,r)}createIGitRepository(t,r,n,i){return new yb(this.providerService,t,r,n,i,this)}async createMetadata(t,r){var n,i,o,a;let{repo:{owner:c,name:w},ref:p}=eo(t);(!p||p.type===We.Commit&&/HEAD/i.test(p.id))&&(p={type:We.Commit,id:"HEAD"});const S=await this.getRepositoryInfo(c,w,p.type===We.PullRequest?{ref:"HEAD",pr:Number(p.id)}:{ref:p.id});if(S===void 0)throw new Error(`Cannot get metadata for Uri(${t.toString(!0)}); Unable to get repository info`);let P;if(r)P=r;else if(p.type===We.Commit||p.type===We.Tree&&S.ref===void 0)P=p.id;else if(P=(i=(n=S.ref)==null?void 0:n.sha)!=null?i:S.defaultBranch.sha,P===void 0)throw new Error(`Cannot get metadata for Uri(${t.toString(!0)}); Unable to get repository info`);let k;return((o=S.ref)==null?void 0:o.prefix)==="refs/heads/"?k={type:nt.Branch,name:S.ref.name,sha:P,branch:{name:S.ref.name,sha:S.ref.sha}}:((a=S.ref)==null?void 0:a.prefix)==="refs/tags/"?k={type:nt.Tag,name:S.ref.name,sha:P,detached:{type:nt.Tag,name:S.ref.name}}:k={type:nt.Commit,name:wt(P),sha:P,detached:{type:nt.Commit,name:wt(P)}},{version:ji.schemaVersion,timestamp:Date.now(),provider:{id:"github",name:"GitHub"},name:`${S.repo.owner}/${S.repo.name}`,repo:S.repo,user:S.user,accessLevel:S.accessLevel,HEAD:k,defaultBranch:S.defaultBranch,pullRequest:S.pullRequest}}getMetadata(t){return this.providerService.getMetadata(t)}getRemoteWorkspaceSourceProviders(){return[{name:"GitHub",icon:"$(github)",label:At("open repo from","Open Repository from {0}","GitHub"),placeholder:At("pick repo","Choose a repository"),provideSources:async(t,r)=>(await this.searchRepositoriesQuery(t!=null?t:"",r)).map(i=>({name:i.repoWithOwner,icon:"$(repo)",description:`${i.fork?`$(repo-forked) ${i.fork}`:""}${i.stars>0?`${i.fork?" \u2022 ":""}$(star-full) ${i.stars}`:""}`,detail:i.description,url:i.url}))},{name:"GitHub",icon:"$(github)",label:At("open pr from","Open Pull Request from {0}","GitHub"),placeholder:At("pick pr","Choose a pull request"),provideSources:async(t,r)=>(await this.searchPullRequestsQuery(t!=null?t:"")).map(i=>({name:i.title,icon:"$(git-pull-request)",description:i.reasons.length!==0?i.reasons.sort().join(", "):void 0,detail:`${i.repoWithOwner} #${i.number}`,url:i.url}))}]}canOpenRemoteUrl(t){const r=vf.exec(t);if((r==null?void 0:r.groups)===void 0)return;const{blob:n,commit:i,pull:o,tree:a}=r.groups;return o?lt.PullRequest:i?lt.Commit:a?lt.Branch:n?lt.File:lt.Repository}async createWorkspaceForRemoteUrl(t,r=rt.CurrentWindow){const n=vf.exec(t);if((n==null?void 0:n.groups)===void 0)return;let{owner:i,repo:o,blob:a,commit:c,pull:w,tree:p}=n.groups;const S=await this.validateNameAndOwner(i,o);if(S===void 0)return;if({owner:i,name:o}=S,w)return this.createWorkspaceForPullRequest(r,i,o,w);let P,k;if(a){const B=this.createVirtualUri(Je.baseVirtualWorkspaceUri,{repo:{owner:i,name:o}});if(P=a,P){const q=P.split("/")[0],[Z,K]=await Promise.all([this.getBranches(B,{query:q}),this.getTags(B,{query:q})]),re=[...Z.branches,...K.tags].map(ee=>`${ee.name}/`).sort((ee,se)=>se.length-ee.length);for(const ee of re)if(P.startsWith(ee)){k={type:We.Tree,id:ee.slice(0,-1)},P=P.substr(k.id.length);break}k===void 0&&ad(q)&&(k={type:We.Tree,id:q},P=P.substr(k.id.length))}}else c?k={type:We.Commit,id:c}:p&&(k={type:We.Tree,id:p});const I=this.providerService.createVirtualUri("github",{repo:{owner:i,name:o},ref:k});return{name:(await this.getMetadata(I)).name,uri:I,location:r,filesToOpen:P?[P]:void 0}}async createWorkspaceForPullRequest(t,r,n,i){var o,a,c,w;const p=await this.getPullRequestCore(r,n,i);let S;if(p)if((a=(o=p.refs)==null?void 0:o.head)==null?void 0:a.exists)S=this.providerService.createVirtualUri("github",{repo:{owner:p.refs.head.owner,name:p.refs.head.repo},ref:{type:We.PullRequest,id:p.id}});else if((w=(c=p.refs)==null?void 0:c.base)==null?void 0:w.exists){const P=At("pr source branch missing prompt confirm","Open Respository"),k=At("pr source branch missing prompt cancel","Cancel");if(await s.window.showInformationMessage(At("pr source branch missing prompt",`Unable to find the source branch for pull request #{0}.

Do you want to open the repository on the target branch instead?`,p.id),P,k)!==P)return;S=this.providerService.createVirtualUri("github",{repo:{owner:p.refs.base.owner,name:p.refs.base.repo},ref:{type:We.PullRequest,id:p.id}})}else{const P=At("pr branches missing prompt confirm","Open Respository"),k=At("pr branches missing prompt cancel","Cancel");if(await s.window.showInformationMessage(At("pr branches missing prompt",`Unable to find either the source or target branch for pull request #{0}.

Do you want to open the repository on the default branch instead?`,p.id),P,k)!==P)return;S=this.providerService.createVirtualUri("github",{repo:{owner:r,name:n}})}else{const P=At("pr missing prompt confirm","Open Respository"),k=At("pr missing prompt cancel","Cancel");if(await s.window.showInformationMessage(At("pr missing prompt",`Unable to find pull request.

Do you want to open the repository on the default branch instead?`),P,k)!==P)return;S=this.providerService.createVirtualUri("github",{repo:{owner:r,name:n}})}return{name:`${r}/${n}`,uri:S,location:t}}createVirtualUri(t,{repo:r,ref:n},i){const o=n?{v:aa,ref:{type:n.type===We.Branch||n.type===We.Tag?We.Tree:n.type,id:n.id}}:void 0;return t.with({authority:Je.encodeAuthority("github",o),path:`/${r.owner}/${r.name}${(i==null?void 0:i.startsWith("/"))?i:i?`/${i}`:""}`})}getRepositoryDescriptor(t){return eo(t).repo}getExternalUri(t){const r=`https://github.com/${t.repo.owner}/${t.repo.name}`;return t.pullRequest?s.Uri.parse(`${r}/pull/${t.pullRequest}`):t.sha?s.Uri.parse(`${r}/commit/${t.sha}`):t.branch?s.Uri.parse(`${r}/tree/${t.branch}`):t.clone?s.Uri.parse(`${r}.git`):s.Uri.parse(r)}getProviderRootUri(t){return Eb(t)}getRelativeFilePath(t,r){const{path:n}=eo(ja(t,r));return n}async createBranch(t,r,n,i){try{const{repo:{owner:o,name:a}}=i!=null?i:await this.getMetadata(t);return r.startsWith("refs/heads/")||(r=`refs/heads/${r}`),(await this.request("POST /repos/{owner}/{repo}/git/refs",{owner:o,repo:a,ref:r,sha:n})).data.ref.substr(11)}catch(o){throw o instanceof bn&&o.status===422?o.message==="Reference already exists"?new wi(o,!0):new wi(o,!1):(he.error(o),o)}}async createCommit(t,r,n,i){try{const o=await this.getMetadata(t),{repo:{owner:a,name:c}}=i!=null?i:o,w=await this.request("GET /repos/{owner}/{repo}/git/trees/{tree_sha}",{owner:a,repo:c,tree_sha:o.HEAD.sha,recursive:"true"}),p=[];for(const k of n)if(k.fileType===s.FileType.File)switch(k.type){case Be.Created:{p.push({path:k.path,mode:"100644",type:"blob",content:await k.content});break}case Be.Changed:{const I=w.data.tree.find($=>$.path===k.path);if(I!==void 0){const{path:$,mode:B,type:q}=I;p.push({path:$,mode:B,type:q,content:await k.content})}else p.push({path:k.path,mode:"100644",type:"blob",content:await k.content});break}case Be.Deleted:{p.push({path:k.path,mode:"100644",type:"blob",sha:null});break}}const S=await this.request("POST /repos/{owner}/{repo}/git/trees",{owner:a,repo:c,base_tree:w.data.sha,tree:p});return(await this.request("POST /repos/{owner}/{repo}/git/commits",{owner:a,repo:c,message:r,tree:S.data.sha,parents:[o.HEAD.sha]})).data.sha}catch(o){throw he.error(o),o}}async createPullRequest(t,r,n,i,o){var a,c,w;try{const{repo:{owner:p,name:S},HEAD:{branch:P},defaultBranch:k}=await this.getMetadata(t),I=await this.request("POST /repos/{owner}/{repo}/pulls",{owner:p,repo:S,base:`refs/heads/${(a=P==null?void 0:P.name)!=null?a:k.name}`,head:o?`${o.repo.owner}:${r}`:r,title:n,draft:(c=i==null?void 0:i.draft)!=null?c:!1,maintainer_can_modify:(w=i==null?void 0:i.canMaintainerModify)!=null?w:!0});return{id:I.data.number.toString(),uri:s.Uri.parse(I.data.html_url)}}catch(p){throw he.error(p),p}}async fetch(t,r){const[n,i]=await this.fetchCore(t,{...r,sync:!1});n&&await this.providerService.updateMetadata(t,i)}async fetchCore(t,r){var n,i,o,a,c,w,p,S,P,k,I;const $=await this.getMetadata(t);if($.HEAD.detached)return he.log(`Fetching upstream: Skipped detached HEAD; rootUri=${t.toString(!0)}`),[!1,$];const B=await this.getBranchTips(t);if(!B)throw he.warn(`Fetching upstream: Unable to fetch branch tips; rootUri=${t.toString(!0)}`),new qa(r.sync);if(!r.force&&((n=B.defaultBranch)==null?void 0:n.sha)!==void 0&&B.defaultBranch.sha===$.defaultBranch.sha&&((i=B.branch)==null?void 0:i.sha)!==void 0&&B.branch.sha===$.HEAD.branch.sha)return he.log(`Fetching upstream: No changes detected; rootUri=${t.toString(!0)}`),[!1,$];let q;if(((o=B.defaultBranch)==null?void 0:o.sha)!==void 0&&B.defaultBranch.sha!==$.defaultBranch.sha&&(q={defaultBranch:{...$.defaultBranch,sha:B.defaultBranch.sha}}),((a=B.branch)==null?void 0:a.sha)===void 0)return he.log(`Fetching upstream: Unable to find branch tip; rootUri=${t.toString(!0)}`),q!==void 0?[!0,{...$,...q}]:[!1,$];if(B.branch.sha!==$.HEAD.branch.sha&&(q={...q,HEAD:{...$.HEAD,branch:{...$.HEAD.branch,sha:B.branch.sha},detached:void 0}}),B.branch.sha===$.HEAD.sha)return he.log(`Fetching upstream: Up to date; rootUri=${t.toString(!0)}`),$.state!==void 0||q!==void 0?[!0,{...$,...q,state:void 0}]:[!1,$];try{const Z=await this.request("GET /repos/{owner}/{repo}/compare/{base}...{head}",{owner:$.repo.owner,repo:$.repo.name,base:(c=r==null?void 0:r.to)!=null?c:$.HEAD.sha,head:(S=(p=(w=q==null?void 0:q.HEAD)==null?void 0:w.branch)==null?void 0:p.sha)!=null?S:$.HEAD.branch.sha}),K=[];for(const re of(P=Z.data.files)!=null?P:[])switch(re.status){case"added":case"copied":K.push({path:re.filename,type:Be.Created});break;case"removed":K.push({path:re.filename,type:Be.Deleted});break;case"modified":K.push({path:re.filename,type:Be.Changed});break;case"renamed":K.push({path:re.filename,type:Be.Created}),K.push({path:re.previous_filename,type:Be.Deleted});break;default:he.warn(`Fetching upstream: Unknown file status encountered '${re.status}'; rootUri=${t.toString(!0)}`);break}return he.log(`Fetching upstream: Changes detected; rootUri=${t.toString(!0)}`),[!0,{...$,...q,state:{ahead:(k=Z.data.behind_by)!=null?k:0,behind:(I=Z.data.ahead_by)!=null?I:0,incomingChanges:K}}]}catch(Z){return he.error(Z,`Fetching upstream failed; rootUri=${t.toString(!0)}`),q!==void 0?[!0,{...$,...q}]:[!1,$]}}async fork(t){try{const{repo:{owner:r,name:n}}=await this.getMetadata(t),i=await this.request("POST /repos/{owner}/{repo}/forks",{owner:r,repo:n});let o;for(;;){try{if(o=await this.getRepositoryInfo(i.data.owner.login,i.data.name),o!==void 0)break}catch{}await new Promise(a=>setTimeout(a,250))}return{name:`${i.data.owner.login}/${i.data.name}`,repo:{owner:i.data.owner.login,name:i.data.name},url:i.data.url}}catch(r){throw he.error(r),r}}async getBranches(t,r){var n,i,o;try{const{repo:{owner:a,name:c}}=await this.getMetadata(t),w=`query getBranches(
	$owner: String!
	$repo: String!
	$branchQuery: String!
	$cursor: String
	$limit: Int = 100
) {
	repository(owner: $owner, name: $repo) {
		refs(query: $branchQuery, refPrefix: "refs/heads/", first: $limit, after: $cursor) {
			pageInfo {
				endCursor
				hasNextPage
			}
			nodes {
				name
				target {
					oid
				}
			}
		}
	}
}`,p=await this.graphql(w,{owner:a,repo:c,branchQuery:(n=r==null?void 0:r.query)!=null?n:"",cursor:r==null?void 0:r.cursor,limit:Math.min(100,(i=r==null?void 0:r.limit)!=null?i:100)});if(p===void 0)return{branches:[]};const S=(o=p.repository)==null?void 0:o.refs;if(S===void 0)return{branches:[]};const P=S.nodes.map(k=>({type:ii.Head,name:k.name,commit:k.target.oid,commitUrl:k.target.commitUrl}));return{paging:{cursor:S.pageInfo.endCursor,more:S.pageInfo.hasNextPage},branches:P}}catch(a){return{branches:[]}}}async getCommit(t,r){var n;try{const{HEAD:i,repo:{owner:o,name:a}}=await this.getMetadata(t),c=`query getCommit(
	$owner: String!
	$repo: String!
	$ref: GitObjectID!
) {
	repository(name: $repo owner: $owner) {
		object(oid: $ref) {
			...on Commit {
				oid
				message
				parents(first: 100) {
					nodes {
						oid
					}
				}
				author {
					date
					email
					name
				}
				committer {
					date
				}
			}
		}
	}
}`;r.toUpperCase()==="HEAD"&&(r=i.sha);const w=await this.graphql(c,{owner:o,repo:a,ref:r});if(w===void 0)return;const p=(n=w.repository)==null?void 0:n.object;return p===void 0?void 0:{hash:p.oid,message:p.message,parents:p.parents.nodes.map(S=>S.oid),authorDate:new Date(p.author.date),authorEmail:p.author.email,authorName:p.author.name,commitDate:new Date(p.committer.date)}}catch(i){return}}async getCommits(t,r){var n,i,o;try{const{HEAD:a,repo:{owner:c,name:w}}=await this.getMetadata(t),p=`query getCommits(
	$owner: String!
	$repo: String!
	$ref: GitObjectID!
	$path: String
	$cursor: String
	$limit: Int = 100
) {
	repository(name: $repo, owner: $owner) {
		object(oid: $ref) {
			... on Commit {
				history(first: $limit, path: $path, after: $cursor) {
					pageInfo {
						endCursor
						hasNextPage
					}
					nodes {
						... on Commit {
							...commit
						}
					}
				}
			}
		}
	}
}

fragment commit on Commit {
	oid
	message
	parents(first: 100) {
		nodes {
			oid
		}
	}
	author {
		date
		email
		name
	}
	committer {
		date
	}
}
`;let S=r==null?void 0:r.ref;(S==null?void 0:S.toUpperCase())==="HEAD"&&(S=a.sha);const P=await this.graphql(p,{owner:c,repo:w,ref:S,cursor:r==null?void 0:r.cursor,path:r==null?void 0:r.path,limit:Math.min(100,(n=r==null?void 0:r.limit)!=null?n:100)});if(P===void 0)return;const k=(o=(i=P.repository)==null?void 0:i.object)==null?void 0:o.history;if(k===void 0)return;const I=k.nodes.map($=>({hash:$.oid,message:$.message,parents:$.parents.nodes.map(B=>B.oid),authorDate:new Date($.author.date),authorEmail:$.author.email,authorName:$.author.name,commitDate:new Date($.committer.date)}));return{paging:{cursor:k.pageInfo.endCursor,more:k.pageInfo.hasNextPage},commits:I}}catch(a){return}}async getFileContent(t,r,n){try{const{repo:{owner:i,name:o}}=await this.getMetadata(t),a=await this.getObjectDetails(t,r,n);if(a===void 0)throw new Error(`Cannot read contents of Uri(${t.toString(!0)})`);const c=await this.request("GET /repos/{owner}/{repo}/git/blobs/{file_sha}",{owner:i,repo:o,file_sha:a.object});return Lg(c.data.content)}catch(i){throw he.error(i),i}}async getFork(t){var r,n,i;try{const{repo:{owner:o,name:a}}=await this.getMetadata(t),c=`query getFork(
	$owner: String!
	$repo: String!
) {
	repository(owner: $owner, name: $repo) {
		forks(affiliations: OWNER, first: 1) {
			nodes {
				owner {
					login
				}
				name
				url
			}
		}
	}
}`,w=await this.graphql(c,{owner:o,repo:a});if(w===void 0)return;const[p]=(i=(n=(r=w.repository)==null?void 0:r.forks)==null?void 0:n.nodes)!=null?i:[];return p===void 0?void 0:{name:`${p.owner.login}/${p.name}`,repo:{owner:p.owner.login,name:p.name},url:p.url}}catch(o){return}}async getIncomingChanges(t){return this.getIncomingChangesCore(t,await this.getMetadata(t))}getIncomingChangesCore(t,r){var n,i,o;return((o=(i=(n=r.state)==null?void 0:n.incomingChanges)==null?void 0:i.length)!=null?o:0)===0?[]:r.state.incomingChanges.map(a=>({uri:s.Uri.joinPath(t,a.path),type:a.type}))}async getObjectDetails(t,r,n){var i;try{const{repo:{owner:o,name:a},path:c,HEAD:{sha:w}}=await this.providerService.getMetadata(t);n=n?this.providerService.getRelativeFilePath(t,this.providerService.createRelativeUri(t,n)):c,r===void 0&&(r=w);const S=(await this.request("GET /repos/{owner}/{repo}/git/trees/{tree_sha}",{owner:o,repo:a,tree_sha:r,recursive:"true"})).data.tree.find(P=>P.path===n);if(S===void 0||S.mode===void 0||S.sha===void 0)throw new Error(`Cannot get details of ${n} in ${r}`);return{mode:S.mode,object:S.sha,size:(i=S.size)!=null?i:0}}catch(o){throw he.error(o),o}}async getPullRequest(t,r){const{repo:{owner:n,name:i}}=await this.getMetadata(t);return this.getPullRequestCore(n,i,r)}async getPullRequestCore(t,r,n){var i,o,a,c,w,p,S;try{const P=`query getPullRequest(
	$owner: String!
	$repo: String!
	$number: Int!
) {
	repository(name: $repo, owner: $owner) {
		pullRequest(number: $number) {
			author {
				login
				avatarUrl
				url
			}
			permalink
			number
			title
			state
			updatedAt
			closedAt
			mergedAt
			repository {
				name
				owner {
					login
				}
			}
			baseRef {
				name
			}
			baseRefName
			baseRefOid
			baseRepository {
				name
				owner {
					login
				}
			}
			headRef {
				name
			}
			headRefName
			headRefOid
			headRepository {
				name
				owner {
					login
				}
			}
			headRepositoryOwner {
				login
			}
		}
	}
}`,k=await this.graphql(P,{owner:t,repo:r,number:Number(n)}),I=(i=k==null?void 0:k.repository)==null?void 0:i.pullRequest;return I?{author:{name:I.author.login,avatarUrl:I.author.avatarUrl,url:I.author.url},closedAt:I.closedAt?new Date(I.closedAt):void 0,mergedAt:I.mergedAt?new Date(I.mergedAt):void 0,id:I.number.toString(),repo:{name:I.repository.name,owner:I.repository.owner.login},state:sa(I.state),title:I.title,updatedAt:new Date(I.updatedAt),url:I.permalink,refs:{base:{owner:I.baseRepository.owner.login,repo:I.baseRepository.name,branch:I.baseRefName,sha:I.baseRefOid,exists:I.baseRef!=null},head:{owner:(w=(c=(o=I.headRepository)==null?void 0:o.owner.login)!=null?c:(a=I.headRepositoryOwner)==null?void 0:a.login)!=null?w:"<unknown>",repo:(S=(p=I.headRepository)==null?void 0:p.name)!=null?S:I.baseRepository.name,branch:I.headRefName,sha:I.headRefOid,exists:I.headRef!=null}}}:void 0}catch(P){he.error(P);return}}async getPullRequestForBranch(t,r,n){var i,o,a,c,w;try{const{repo:{owner:p,name:S}}=await this.getMetadata(t),P=`query getPullRequestForBranch(
	$owner: String!
	$repo: String!
	$branch: String!
	$maxCount: Int!
	$states: [PullRequestState!]
) {
	repository(name: $repo, owner: $owner) {
		refs(query: $branch, refPrefix: "refs/heads/", first: 1) {
			nodes {
				associatedPullRequests(first: $maxCount, orderBy: {field: UPDATED_AT, direction: DESC}, states: $states) {
					nodes {
						author {
							login
							avatarUrl
							url
						}
						permalink
						number
						title
						state
						updatedAt
						closedAt
						mergedAt
						repository {
							isFork
							name
							owner {
								login
							}
						}
					}
				}
			}
		}
	}
}`,k=await this.graphql(P,{owner:p,repo:S,branch:r,maxCount:(i=n==null?void 0:n.maxCount)!=null?i:1,states:n==null?void 0:n.include}),I=(w=(c=(a=(o=k==null?void 0:k.repository)==null?void 0:o.refs.nodes[0])==null?void 0:a.associatedPullRequests)==null?void 0:c.nodes)==null?void 0:w.filter(B=>!B.repository.isFork||B.repository.owner.login===p);if(I==null||I.length===0)return;I.length>1&&I.sort((B,q)=>(B.repository.owner.login===p?-1:1)-(q.repository.owner.login===p?-1:1)||(B.state==="OPEN"?-1:1)-(q.state==="OPEN"?-1:1)||new Date(q.updatedAt).getTime()-new Date(B.updatedAt).getTime());const[$]=I;return{author:{name:$.author.login,avatarUrl:$.author.avatarUrl,url:$.author.url},closedAt:$.closedAt?new Date($.closedAt):void 0,mergedAt:$.mergedAt?new Date($.mergedAt):void 0,id:$.number.toString(),repo:{name:$.repository.name,owner:$.repository.owner.login},state:sa($.state),title:$.title,updatedAt:new Date($.updatedAt),url:$.permalink}}catch(p){he.error(p);return}}async getRepoFileNames(t){try{const{repo:{owner:r,name:n},HEAD:{sha:i}}=await this.getMetadata(t),o=await this.request("GET /repos/{owner}/{repo}/git/trees/{tree_sha}",{owner:r,repo:n,recursive:"1",tree_sha:i});return In(o.data.tree,a=>a.type==="blob"?a.path:void 0)}catch(r){return[]}}async getTags(t,r){var n,i,o;try{const{repo:{owner:a,name:c}}=await this.getMetadata(t),w=`query getTags(
	$owner: String!
	$repo: String!
	$tagQuery: String!
	$cursor: String
	$limit: Int = 100
) {
	repository(owner: $owner, name: $repo) {
		refs(query: $tagQuery, refPrefix: "refs/tags/", first: $limit, after: $cursor, orderBy: { field: TAG_COMMIT_DATE, direction: DESC }) {
			pageInfo {
				endCursor
				hasNextPage
			}
			nodes {
				name
				target {
					oid
				}
			}
		}
	}
}`,p=await this.graphql(w,{owner:a,repo:c,tagQuery:(n=r==null?void 0:r.query)!=null?n:"",cursor:r==null?void 0:r.cursor,limit:Math.min(100,(i=r==null?void 0:r.limit)!=null?i:100)});if(p===void 0)return{tags:[]};const S=(o=p.repository)==null?void 0:o.refs;if(S===void 0)return{tags:[]};const P=S.nodes.map(k=>({type:ii.Tag,name:k.name,commit:k.target.oid,commitUrl:k.target.commitUrl}));return{paging:{cursor:S.pageInfo.endCursor,more:S.pageInfo.hasNextPage},tags:P}}catch(a){return{tags:[]}}}async getTarGz(t){const{repo:{owner:r,name:n},HEAD:{sha:i}}=await this.getMetadata(t),o=await this.ensureAuthenticated();if($r){const w=He.get("search.download.corsProxy")||void 0;if(typeof w=="string"){let k=w;k.startsWith("https://")||(k=`https://${k}`),k.endsWith("/")||(k=`${k}/`);const I=`${k}api.github.com/repos/${r}/${n}/tarball/${i}`,$=await yn(I,{headers:{Authorization:`Bearer ${o.accessToken}`}});return new Uint8Array(await $.arrayBuffer())}const p=w==null?void 0:w["github.com"],S=`https://${p!=null?p:"vscode.dev"}/indexes/github/${r}/${n}/${i}`,P=await yn(S,{headers:{"x-proxy-authorization":`Bearer ${o.accessToken}`},credentials:"include"});return new Uint8Array(await P.arrayBuffer())}const a=`https://api.github.com/repos/${r}/${n}/tarball/${i}`,c=await yn(a,{headers:{Authorization:`Bearer ${o.accessToken}`}});return new Uint8Array(await c.arrayBuffer())}async pushCommit(t,r,n,i){he.log(`Pushing commit ${r} to upstream; rootUri=${t.toString(!0)}`);try{const o=await this.getMetadata(t),{repo:{owner:a,name:c}}=i!=null?i:o;if(n===void 0&&o.HEAD.detached)throw new yi("Unable to commit; no current branch");(n==null?void 0:n.startsWith("refs/heads/"))&&(n=n.substr(11));const w=await this.request("PATCH /repos/{owner}/{repo}/git/refs/{ref}",{owner:a,repo:c,ref:`heads/${n!=null?n:o.HEAD.branch.name}`,sha:r});return n===void 0&&!o.HEAD.detached&&await this.fastForwardTo(t,r,o),w.data.ref}catch(o){throw o instanceof bn&&o.status===422&&o.message.includes("Update is not a fast forward")?new po(o):(he.error(o),o)}}async queryRepositoryObject(t,r,n){var i,o;try{const{repo:{owner:a,name:c},HEAD:{sha:w},path:p}=await this.providerService.getMetadata(t),S=`query ${r}(
	$owner: String!
	$repo: String!
	$path: String
) {
	repository(owner: $owner, name: $repo) {
		object(expression: $path) {
			${n}
		}
	}
}`,P=await this.graphql(S,{owner:a,repo:c,path:`${w}:${p}`});return(o=(i=P==null?void 0:P.repository)==null?void 0:i.object)!=null?o:void 0}catch(a){return}}async searchPullRequestsQuery(t){try{let r=function(a,c){return{number:a.number,title:a.title,repoWithOwner:a.repository.nameWithOwner,reasons:c?[c]:[],url:a.url}};const n=`query searchPullRequests(
	$authored: String!
	$assigned: String!
	$reviewRequested: String!
	$mentioned: String!
) {
	viewer {
		repositories(first: 100, orderBy: { field: STARGAZERS, direction: DESC }) {
			nodes {
				pullRequests(first: 100, states: OPEN, orderBy: { field: UPDATED_AT, direction: DESC }) {
					nodes {
						number
						title
						url
						repository {
							nameWithOwner
						}
					}
				}
			}
		}
	}
	authored: search(first: 100, query: $authored, type: ISSUE) {
		nodes {
			...on PullRequest {
				number
				title
				url
				repository {
					nameWithOwner
				}
			}
		}
	}
	assigned: search(first: 100, query: $assigned, type: ISSUE) {
		nodes {
			...on PullRequest {
				number
				title
				url
				repository {
					nameWithOwner
				}
			}
		}
	}
	reviewRequested: search(first: 100, query: $reviewRequested, type: ISSUE) {
		nodes {
			...on PullRequest {
				number
				title
				url
				repository {
					nameWithOwner
				}
			}
		}
	}
	mentioned: search(first: 100, query: $mentioned, type: ISSUE) {
		nodes {
			...on PullRequest {
				number
				title
				url
				repository {
					nameWithOwner
				}
			}
		}
	}
}`;t=t.trim();const i=await this.graphql(n,{authored:(t?`${t} is:pr is:open archived:false author:@me`:"is:pr is:open archived:false author:@me").trim(),assigned:(t?`${t} is:pr is:open archived:false assignee:@me`:"is:pr is:open archived:false assignee:@me").trim(),reviewRequested:(t?`${t} is:pr is:open archived:false review-requested:@me`:"is:pr is:open archived:false review-requested:@me").trim(),mentioned:(t?`${t} is:pr is:open archived:false mentions:@me`:"is:pr is:open archived:false mentions:@me").trim()});return i===void 0?[]:hc([...i.assigned.nodes.map(a=>r(a,"assigned")),...i.reviewRequested.nodes.map(a=>r(a,"review requested")),...i.mentioned.nodes.map(a=>r(a,"mentioned")),...i.authored.nodes.map(a=>r(a,"authored")),...iu(i.viewer.repositories.nodes,a=>a.pullRequests.nodes.map(c=>r(c)))],a=>a.url,(a,c)=>(c.reasons.length!==0&&a.reasons.push(...c.reasons),a))}catch(r){return[]}}async searchRepositoriesQuery(t,r){try{const n=`query searchRepositories(
	$search: String!
) {
	viewer {
		repositories(first: 100, orderBy: { field: UPDATED_AT, direction: DESC }) {
			nodes {
				nameWithOwner
				description
				url
				parent {
					nameWithOwner
				}
				stargazerCount
			}
		}
	}
	search(first: 100, query: $search, type: REPOSITORY) {
		nodes {
			...on Repository {
				nameWithOwner
				description
				url
				parent {
					nameWithOwner
				}
				stargazerCount
			}
		}
	}
}`;(r==null?void 0:r.user)&&(t+=` user:${r.user}`),(r==null?void 0:r.sort)&&(t+=` sort:${r.sort}`);const i=await this.graphql(n,{search:t.trim()});return i===void 0?[]:hc((r==null?void 0:r.user)?[...i.search.nodes,...i.viewer.repositories.nodes]:[...i.viewer.repositories.nodes,...i.search.nodes],a=>a.url).map(a=>{var c,w,p;return{repoWithOwner:a.nameWithOwner,description:(c=a.description)!=null?c:void 0,url:a.url,fork:(p=(w=a.parent)==null?void 0:w.nameWithOwner)!=null?p:void 0,stars:a.stargazerCount}})}catch(n){return[]}}async searchCodeQuery(t,r,n){var i,o,a;const{repo:{owner:c,name:w},HEAD:p,defaultBranch:S}=await this.getMetadata(r),P=[];((i=p.branch)==null?void 0:i.name)!==S.name&&P.push(At("cant search branch","Unable to search {0}, falling back to {1}. Enable indexing for results specific to {0}.",(a=(o=p.branch)==null?void 0:o.name)!=null?a:p.detached.name,S.name));try{const I=await(await this.octokit({request:{headers:{accept:"application/vnd.github.v3.text-match+json"}}})).request("GET /search/code",{q:`${t} repo:${c}/${w}`}),$=new s.Range(0,0,0,0),B=[];let q=0,Z;for(const K of I.data.items)for(const re of K.text_matches){if(q++,n.maxResults!==void 0&&q>n.maxResults)return{matches:B,limitHit:!0};Z={path:K.path,ranges:[],preview:re.fragment,matches:[]};for(const ee of re.matches){let se=0,Se=0,me=0;for(let Te=0;Te<ee.indices[1];Te++)Te===ee.indices[0]&&(Se=me),re.fragment[Te]===`
`?(se++,me=0):me++;Z.ranges.push($),Z.matches.push(new s.Range(se,Se,se,me))}B.push(Z)}return{matches:B,limitHit:!1,warnings:P}}catch(k){return{matches:[],limitHit:!0}}}async switchTo(t,r,n){const{name:i,repo:o,HEAD:{branch:a}}=await this.getMetadata(t);if(!(r!==void 0&&((r==null?void 0:r.startsWith("refs/heads/"))?r=r.substr(11):(r==null?void 0:r.startsWith("refs/tags/"))&&(r=r.substr(10)),(a==null?void 0:a.name)===r)))return{name:i,uri:this.providerService.createVirtualUri(t,{repo:o,ref:r?{type:We.Tree,id:r}:void 0}),location:(n==null?void 0:n.openInNewWindow)?rt.NewWindow:rt.CurrentWindow}}async sync(t,r,n){var i,o,a;const[,c]=await this.fetchCore(t,{sync:!0,to:n.to});if(!c.HEAD.detached){if(((o=(i=c==null?void 0:c.state)==null?void 0:i.behind)!=null?o:0)>0&&await r.hasChanges(t)){he.log(`Syncing upstream changes; rootUri=${t.toString(!0)}`);const w=this.getIncomingChangesCore(t,c),p=[];let S;if(w.length>0){S=await r.getChanges(t);for(const P of S){const k=this.providerService.getRelativeFilePath(t,P.uri),I=w.find($=>$.uri.path===P.uri.path);if(I!==void 0){p.push({path:k,current:P,incoming:I});break}}}if(p.length>0)switch(n.conflictResolution){case wr.KeepCurrent:he.log(`Syncing upstream changes(keep): ${p.length} conflicts; rootUri=${t.toString(!0)}`);for(const P of p)await r.keep(P.current.uri,{type:P.incoming.type,providerUri:gc(c,c.HEAD.branch.sha,P.path)});break;case wr.DiscardCurrent:he.log(`Syncing upstream changes(discard): ${p.length} conflicts; rootUri=${t.toString(!0)}`);for(const P of p)await r.discard(P.current.uri);break;case wr.Merge:he.log(`Syncing upstream changes(merge): ${p.length} conflicts; rootUri=${t.toString(!0)}`);for(const P of p)await r.merge(P.current.uri,{type:P.incoming.type,providerUri:gc(c,c.HEAD.branch.sha,P.path)},{providerUri:gc(c,c.HEAD.sha,P.path)});break;case wr.Abort:default:throw he.log(`Syncing upstream changes(abort): ${p.length} conflicts; rootUri=${t.toString(!0)}`),await this.providerService.updateMetadata(t,c),new go}}await this.fastForwardTo(t,(a=n.to)!=null?a:c.HEAD.branch.sha,c)}}async fastForwardTo(t,r,n){if(n.HEAD.detached)throw new yi("Unable to fast-forward; no current branch");n.HEAD.sha===r&&n.state===void 0||(he.log(`Fast forward to ${r}; rootUri=${t.toString(!0)}`),await this.providerService.updateMetadata(t,{...n,HEAD:{...n.HEAD,detached:void 0,sha:r},state:void 0,timestamp:Date.now()}),r!==n.HEAD.branch.sha&&await this.fetchCore(t,{sync:!1,to:r}))}async getBranchTips(t,r){try{const{repo:{owner:n,name:i},HEAD:{branch:o}}=await this.getMetadata(t);r===void 0&&(r=o?`refs/heads/${o.name}`:"");const a=`query getBranchTips(
	$owner: String!
	$repo: String!
	$ref: String!
) {
	repository(owner: $owner, name: $repo) {
		defaultBranchRef {
			target {
				oid
			}
		}
		ref(qualifiedName: $ref) {
			target {
				oid
			}
		}
	}
}`,c=await this.graphql(a,{owner:n,repo:i,ref:r});if(!(c==null?void 0:c.repository))return;const{defaultBranchRef:w,ref:p}=c.repository;return!w&&!p?void 0:{defaultBranch:w?{sha:w.target.oid}:void 0,branch:p?{sha:p.target.oid}:void 0}}catch(n){return}}async getRepositoryInfo(t,r,n){var i,o,a,c,w,p,S,P,k,I,$,B,q;try{const Z=`query getRepository(
	$owner: String!
	$repo: String!
	$ref: String = ""
	$pr: Boolean!
	$number: Int = 0
) {
	viewer {
		login
	}
	repository(owner: $owner, name: $repo) {
		name
		owner {
			login
		}
		defaultBranchRef {
			name
			target {
				oid
			}
		}
		ref(qualifiedName: $ref) {
			name
			prefix
			target {
				oid
			}
		}
		viewerPermission
		parent {
			name
			owner {
				login
			}
			defaultBranchRef {
				name
				target {
					oid
				}
			}
			viewerPermission
			pullRequest(number: $number) @include(if: $pr) {
				number
				title
				state
				maintainerCanModify
				baseRef {
					name
				}
				baseRefName
				baseRefOid
				baseRepository {
					name
					owner {
						login
					}
					defaultBranchRef {
						name
						target {
							oid
						}
					}
					viewerPermission
				}
				headRef {
					name
				}
				headRefName
				headRefOid
				headRepository {
					name
					owner {
						login
					}
					defaultBranchRef {
						name
						target {
							oid
						}
					}
					viewerPermission
				}
				mergeCommit {
					oid
				}
			}
		}
		pullRequest(number: $number) @include(if: $pr) {
			number
			title
			state
			maintainerCanModify
			baseRef {
				name
			}
			baseRefName
			baseRefOid
			baseRepository {
				name
				owner {
					login
				}
				defaultBranchRef {
					name
					target {
						oid
					}
				}
				viewerPermission
			}
			headRef {
				name
			}
			headRefName
			headRefOid
			headRepository {
				name
				owner {
					login
				}
				defaultBranchRef {
					name
					target {
						oid
					}
				}
				viewerPermission
			}
			mergeCommit {
				oid
			}
		}
	}
}`;let K;try{K=await this.graphql(Z,{owner:t,repo:r,ref:(n==null?void 0:n.ref)!=="HEAD"?n==null?void 0:n.ref:void 0,pr:Boolean(n==null?void 0:n.pr),number:(i=n==null?void 0:n.pr)!=null?i:0})}catch(se){if(!(se instanceof Error)||!se.message.startsWith("Could not resolve to a PullRequest with the number"))throw se;K=se.data}if(K===void 0)return;const re=(w=(o=K.repository)==null?void 0:o.pullRequest)!=null?w:(c=(a=K.repository)==null?void 0:a.parent)==null?void 0:c.pullRequest;if(re==null?void 0:re.headRef){const se=(S=(p=re.headRepository)==null?void 0:p.defaultBranchRef)!=null?S:void 0;return(se==null?void 0:se.name)===void 0?void 0:{user:K.viewer.login,repo:{owner:re.headRepository.owner.login,name:re.headRepository.name},accessLevel:bf(re.headRepository.viewerPermission),ref:re.headRef?{prefix:"refs/heads/",name:re.headRef.name,sha:re.headRefOid}:(n==null?void 0:n.ref)==="HEAD"?{prefix:"refs/heads/",name:se.name,sha:se.target.oid}:void 0,defaultBranch:{name:se.name,sha:se.target.oid},pullRequest:re?{id:re.number.toString(),repo:{owner:re.baseRepository.owner.login,name:re.baseRepository.name},state:sa(re.state),title:re.title}:void 0}}const ee=(k=(P=K.repository)==null?void 0:P.defaultBranchRef)!=null?k:void 0;return(ee==null?void 0:ee.name)===void 0?void 0:{user:K.viewer.login,repo:{owner:K.repository.owner.login,name:K.repository.name},accessLevel:bf((I=K==null?void 0:K.repository)==null?void 0:I.viewerPermission),ref:(($=K.repository)==null?void 0:$.ref)?{prefix:K.repository.ref.prefix,name:K.repository.ref.name,sha:K.repository.ref.target.oid}:(re==null?void 0:re.baseRef)?{prefix:"refs/heads/",name:re==null?void 0:re.baseRef.name,sha:(q=(B=re.mergeCommit)==null?void 0:B.oid)!=null?q:re==null?void 0:re.baseRefOid}:(n==null?void 0:n.ref)==="HEAD"?{prefix:"refs/heads/",name:ee.name,sha:ee.target.oid}:void 0,defaultBranch:{name:ee.name,sha:ee.target.oid},pullRequest:re?{id:re.number.toString(),repo:{owner:K.repository.owner.login,name:K.repository.name},state:sa(re.state),title:re.title}:void 0}}catch(Z){if(wf(Z)&&Z.errors[0].type==="NOT_FOUND")throw new Pn(Z,`${t}/${r}`);return}}async validateNameAndOwner(t,r){try{const n=`query validateNameAndOwner(
	$owner: String!
	$repo: String!
) {
	repository(owner: $owner, name: $repo) {
		name
		owner {
			login
		}
	}
}`,i=await this.graphql(n,{owner:t,repo:r});return(i==null?void 0:i.repository)===void 0?void 0:{owner:i.repository.owner.login,name:i.repository.name}}catch(n){if(wf(n)&&n.errors[0].type==="NOT_FOUND")throw new Pn(n,`${t}/${r}`);return}}}Sb([nr()],yf.prototype,"ensureAuthenticated",1);function wf(e){return e instanceof Error&&"name"in e&&e.name==="GraphqlError"}function sa(e){switch(e){case"OPEN":return vi.Open;case"CLOSED":return vi.Closed;case"MERGED":return vi.Merged}}var _n;(function(e){e.ADMIN="ADMIN",e.MAINTAIN="MAINTAIN",e.WRITE="WRITE",e.TRIAGE="TRIAGE",e.READ="READ",e.NONE="NONE"})(_n||(_n={}));function bf(e){switch(e){case _n.ADMIN:return xt.Admin;case _n.MAINTAIN:return xt.Maintain;case _n.WRITE:return xt.Write;case _n.TRIAGE:return xt.Triage;case _n.READ:return xt.Read;default:return xt.None}}const _f=class{constructor(e,t,r){this.providerService=e,this.storageService=t,this.changeStore=r,this.lock=new Co("PendingRepositoryOpenActions"),this.disposable=s.Disposable.from(e.onDidChangeRepositories(n=>n.added.length&&this.onRepositoriesOpened(n.added)))}dispose(){this.disposable.dispose()}async onRepositoriesOpened(e){for(const t of e){const r=await this.getAndDelete(t);(r==null?void 0:r.applyChangeset)&&await this.applyPendingChangeset(t,r.applyChangeset),(r==null?void 0:r.filesToOpen)&&this.openPendingFiles(t,r.filesToOpen),this.fetchOrSync(t)}}async fetchOrSync(e){if(await this.changeStore.hasChanges(e.uri))await this.providerService.fetch(e.uri,{force:!0});else{const{index:t}=await e.getMetadata();await this.providerService.sync(e.uri,this.changeStore,{to:t==null?void 0:t.sha})}}async get(e){return this.lock.synchronizeRead(()=>this.getCore(e.uri),"PendingRepositoryOpenActions.get")}async getAndDelete(e){he.debug(`RepositoryOpenActionsService.getAndDelete(${e.uri.toString()})`);try{return await this.lock.synchronizeWrite(async()=>{const r=await this.getCore(e.uri);if(r!==void 0)return await this.storeCore(e.uri,void 0),r},"PendingRepositoryOpenActions.getAndDelete")}catch(t){he.error(t,`Failed to get pending actions for ${e.uri.toString()}`);return}}setChangesetToApply(e,t){return he.log(`RepositoryOpenActionsService.setChangesetToApply(${e.toString()})`),this.lock.synchronizeWrite(async()=>{const r=await this.getCore(e);await this.storeCore(e,{...r,applyChangeset:t})},"PendingRepositoryOpenActions.setChangesetToApply")}setFilesToOpen(e,t){return he.log(`RepositoryOpenActionsService.setFilesToOpen(${e.toString()})`,t.length),this.lock.synchronizeWrite(async()=>{const r=await this.getCore(e);await this.storeCore(e,{...r,filesToOpen:t})},"PendingRepositoryOpenActions.setFilesToOpen")}async applyPendingChangeset(e,t){he.log(`RepositoryOpenActionsService.applyPendingChangeset(${e.uri.toString()})`);try{await this.changeStore.applyChangeset(e.uri,t,{save:!0})}catch(r){he.error(r,`Failed to apply pending changeset for ${e.uri.toString()}`)}}openPendingFiles(e,t){if(t.length!==0){he.log(`RepositoryOpenActionsService.openPendingFiles(${e.uri.toString()})`,t.length);for(const r of t)s.commands.executeCommand("vscode.open",s.Uri.joinPath(e.uri,r))}}async getCore(e){return this.fromStorage(await this.storageService.get(this.getStorageKey(e)))}storeCore(e,t){return t===void 0||t.applyChangeset===void 0&&(t.filesToOpen===void 0||t.filesToOpen.length===0)?this.storageService.delete(this.getStorageKey(e)):this.storageService.store(this.getStorageKey(e),this.toStorage(t))}getStorageKey(e){return`actions/${be(e)}`}fromStorage(e){if(!!e)try{const t=JSON.parse(e,(r,n)=>(r==="uri"||r.endsWith("Uri"))&&n!==null?s.Uri.from(n):n);return{filesToOpen:t.filesToOpen,applyChangeset:t.applyChangeset}}catch(t){return he.error(t,"Failed to deserialize pending repository actions"),{}}}toStorage(e){const t={schemaVersion:_f.storageSchemaVersion,...e};return JSON.stringify(t)}};let Cf=_f;Cf.storageSchemaVersion=1;const zt=(0,E.LV)();class xb{constructor(t,r){this.providerService=t,this.changeStore=r,this._onDidChangeFileDecorations=new s.EventEmitter,this._decorations=new Map,this.disposable=s.Disposable.from(s.window.registerFileDecorationProvider(this),t.onDidChangeRepository(this.onRefresh,this),t.onDidRefresh(this.onRefresh,this),r.onDidChange(this.onUrisChanged,this))}get onDidChangeFileDecorations(){return this._onDidChangeFileDecorations.event}dispose(){this.disposable.dispose(),this._decorations.clear()}onRefresh(){this._decorations.clear(),this._onDidChangeFileDecorations.fire(void 0)}onUrisChanged(t){this._onDidChangeFileDecorations.fire(t.map(r=>(this._decorations.delete(be(r.uri)),r.uri)))}async provideFileDecoration(t,r){if(t.scheme!==Je.scheme)return;const n=be(t);let i=this._decorations.get(n);if(i!==void 0)return i!=null?i:void 0;const o=await this.providerService.getIncomingChanges(this.providerService.getVirtualRootUri(t));let a;o.length>0&&(a=o.find(w=>be(w.uri)===n));const c=await this.changeStore.getChange(t);if(c===void 0){if(a!==void 0)switch(a.type){case Be.Created:i={badge:"\u2193A",color:new s.ThemeColor("remoteHub.decorations.incomingAddedForegroundColor"),tooltip:zt("decoration tooltip incoming change added","Pending Incoming Changes (Added)")};break;case Be.Deleted:i={badge:"\u2193D",color:new s.ThemeColor("remoteHub.decorations.incomingDeletedForegroundColor"),tooltip:zt("decoration tooltip incoming change deleted","Pending Incoming Changes (Deleted)")};break;case Be.Changed:i={badge:"\u2193M",color:new s.ThemeColor("remoteHub.decorations.incomingModifiedForegroundColor"),tooltip:zt("decoration tooltip incoming change modified","Pending Incoming Changes (Modified)")};break;default:i={badge:"\u2193~",color:new s.ThemeColor("remoteHub.decorations.incomingModifiedForegroundColor"),tooltip:zt("decoration tooltip incoming change","Pending Incoming Changes")};break}return this._decorations.set(n,i!=null?i:null),i}if(c.conflicts)i={badge:"\u26A0",color:new s.ThemeColor("remoteHub.decorations.conflictForegroundColor"),tooltip:zt("decoration tooltip conflicts","Merge Conflicts ({0})",xm(c.conflicts.status))};else if(a!==void 0)switch(a.type){case Be.Created:i={badge:"\u26A0",color:new s.ThemeColor("remoteHub.decorations.possibleConflictForegroundColor"),tooltip:zt("decoration tooltip possible conflict added","Possible Merge Conflicts (Added)")};break;case Be.Deleted:i={badge:"\u26A0",color:new s.ThemeColor("remoteHub.decorations.possibleConflictForegroundColor"),tooltip:zt("decoration tooltip possible conflict deleted","Possible Merge Conflicts (Deleted)")};break;case Be.Changed:i={badge:"\u26A0",color:new s.ThemeColor("remoteHub.decorations.possibleConflictForegroundColor"),tooltip:zt("decoration tooltip possible conflict","Possible Merge Conflicts")};break;default:i={badge:"\u26A0",color:new s.ThemeColor("remoteHub.decorations.possibleConflictForegroundColor"),tooltip:zt("decoration tooltip possible conflict","Possible Merge Conflicts")}}else switch(c.type){case Be.Created:i={badge:"A",color:new s.ThemeColor("remoteHub.decorations.addedForegroundColor"),tooltip:zt("decoration tooltip added","Added")};break;case Be.Changed:i={badge:"M",color:new s.ThemeColor("remoteHub.decorations.modifiedForegroundColor"),tooltip:zt("decoration tooltip modified","Modified")};break;case Be.Deleted:i={badge:"D",color:new s.ThemeColor("remoteHub.decorations.deletedForegroundColor"),tooltip:zt("decoration tooltip deleted","Deleted")};break}return this._decorations.set(n,i!=null?i:null),i}}class oi{constructor(t){this.command=t}get label(){return this.command.title}async execute(){var t;return void await s.commands.executeCommand(this.command.command,...(t=this.command.arguments)!=null?t:[])}}var ca;(function(e){async function t(r,n,i,o,a,c){let w;Array.isArray(a)?w=a:c===void 0&&(w=[],c=a);const p=s.window.createQuickPick(),S=new as(500),P=[S],{defaultBranch:k,HEAD:I}=await r.getMetadata(n);async function $(re){var ee;const[se,Se]=await Promise.all([r.getBranches(n,{query:re,limit:100}),r.getTags(n,{query:re,limit:100})]),me=((c==null?void 0:c.filterBranches)?se.branches.filter(c==null?void 0:c.filterBranches):se.branches).filter(Te=>Te.name!==k.name);return[...w,...((ee=I.branch)==null?void 0:ee.name)!==k.name?[{label:`$(git-branch) ${k.name} (default)`,description:`$(git-commit) ${wt(k.sha)}`,alwaysShow:!0,name:void 0,sha:k.sha}]:[],...me.map(Te=>({label:`$(git-branch) ${Te.name}`,description:`$(git-commit) ${wt(Te.commit)}`,name:Te.name,sha:Te.commit})),...Se.tags.map(Te=>({label:`$(tag) ${Te.name}`,description:`$(git-commit) ${wt(Te.commit)}`,name:Te.name,sha:Te.commit}))]}const B=$(void 0);let q,Z=!1;async function K(re){q=void 0;const ee=p.activeItems;p.items=re!=null?re:await B,Z&&ee.length!==0&&(p.activeItems=p.items.filter(se=>ee.some(Se=>Se.label===se.label))),p.busy=!1}try{return await new Promise(ee=>{P.push(p.onDidHide(()=>ee(void 0)),p.onDidChangeValue(se=>{Z=!1,se=se.trim(),p.busy=!0;const Se=S.debounce(se?()=>$(se):()=>B);q===void 0&&(q=Se.then(async me=>K(me)))}),p.onDidAccept(()=>{if(p.activeItems.length!==0){const[se]=p.activeItems;ee(se)}})),p.title=o,p.placeholder=i,p.matchOnDescription=!0,p.ignoreFocusOut=!0,p.busy=!0,p.show(),q=S.debounce(async()=>B,0).then(se=>K(se))})}finally{p.dispose(),P.forEach(re=>void re.dispose())}}e.show=t})(ca||(ca={}));function mc(e){switch(e){case nt.Branch:return"$(git-branch)";case nt.Tag:return"$(tag)";case nt.Commit:return"$(git-commit)"}}function Tb(e){switch(e){case nt.Branch:return new s.ThemeIcon("git-branch");case nt.Tag:return new s.ThemeIcon("tag");case nt.Commit:return new s.ThemeIcon("git-commit")}}const pe=(0,E.LV)(),Rb=new TextDecoder;class kb{constructor(t,r,n,i){this.providerService=t,this.changeStore=r,this.openActionsService=n,this.telemetryService=i,this._onDidCloseRepository=new s.EventEmitter,this._onDidOpenRepository=new s.EventEmitter,this._onDidChangeState=new s.EventEmitter,this._scmProviders=[],this._state="uninitialized",this.disposable=s.Disposable.from(He.onDidChange(this.onConfigurationChanged,this),this.providerService.onDidChangeRepositories(this.onRepositoriesChanged,this),this.providerService.onDidChangeRepository(async({repository:a,state:c})=>{const w=this.getScmProvider(this.providerService.getVirtualUri(a.uri));w!==void 0&&await this.updateStatusBarCommands(w,c)}),this.providerService.onDidRefresh(a=>{for(const c of a)this.update(c)}),this.changeStore.onDidChange(a=>this.update(a[0].rootUri)),...this.registerCommands());const o=this.providerService.repositories;o.length&&this.onRepositoriesChanged({added:o,removed:[]})}get onDidCloseRepository(){return this._onDidCloseRepository.event}get onDidOpenRepository(){return this._onDidOpenRepository.event}get onDidChangeState(){return this._onDidChangeState.event}get repositories(){return this._scmProviders.map(t=>t.repository).filter(t=>Boolean(t))}dispose(){var t;(t=this.disposable)==null||t.dispose()}get staging(){return this._staging===void 0&&(this._staging=He.get("staging")),this._staging}get state(){return this._state}refresh(){for(const t of this._scmProviders)this.update(t.sourceControl.rootUri)}onConfigurationChanged(t){He.changed(t,"staging")&&(this._staging=void 0,He.changed(t,"staging.enabled")&&this.refresh())}async onRepositoriesChanged(t){if(t.added.length)for(const r of t.added){const n=await this.update(r.uri);(n==null?void 0:n.repository)&&this._onDidOpenRepository.fire(n.repository)}if(t.removed.length)for(const r of t.removed){const n=this._scmProviders.findIndex(i=>be(i.sourceControl.rootUri)===be(r.uri));if(n!==-1){const i=this._scmProviders[n];i.repository&&this._onDidCloseRepository.fire(i.repository),i.sourceControl.dispose(),this._scmProviders.splice(n,1)}}this._scmProviders.length!==0&&(this._state="initialized",this._onDidChangeState.fire(this._state))}registerCommands(){return[s.commands.registerCommand("remoteHub.createPullRequest",t=>{if(t=this.getSourceControlFrom(t),t!==void 0)return this.telemetryService.sendEvent("command.createPullRequest"),void this.createPullRequest(t)}),s.commands.registerCommand("remoteHub.createDraftPullRequest",t=>{if(t=this.getSourceControlFrom(t),t!==void 0)return this.telemetryService.sendEvent("command.createDraftPullRequest"),void this.createPullRequest(t,{draft:!0})}),s.commands.registerCommand("remoteHub.commit",t=>{if(t=this.getSourceControlFrom(t),t!==void 0)return this.telemetryService.sendEvent("command.commit"),void this.commitChanges(t)}),s.commands.registerCommand("remoteHub.discardAllChanges",async t=>{if(Sf(t)){const o=t.resourceStates.filter(to);if(o.length!==0){if(await vc(o))for(const a of o)await this.changeStore.discard(a.resourceUri);else this.telemetryService.sendEvent("command.discardAllChanges.abort",{reason:"aborted"});return}}const r=this.getSourceControlFrom(t);if((r==null?void 0:r.rootUri)===void 0)return;this.telemetryService.sendEvent("command.discardAllChanges");const n=await this.changeStore.getChanges(r.rootUri);await vc(n)?await this.changeStore.discardAll(r.rootUri):this.telemetryService.sendEvent("command.discardAllChanges.abort",{reason:"aborted"})}),s.commands.registerCommand("remoteHub.discardChanges",async t=>{!to(t)||(this.telemetryService.sendEvent("command.discardChanges"),await vc([t])?await this.changeStore.discard(t.resourceUri):this.telemetryService.sendEvent("command.discardChanges.abort",{reason:"aborted"}))}),s.commands.registerCommand("remoteHub.stageAllChanges",async t=>{const r=this.getSourceControlFrom(t);(r==null?void 0:r.rootUri)!==void 0&&(this.telemetryService.sendEvent("command.stageAllChanges"),await this.changeStore.stageAll(r.rootUri))}),s.commands.registerCommand("remoteHub.stageChanges",t=>{if(!!to(t))return this.telemetryService.sendEvent("command.stageChanges"),void this.changeStore.stage(t.resourceUri)}),s.commands.registerCommand("remoteHub.unstageAllChanges",t=>{const r=this.getSourceControlFrom(t);if((r==null?void 0:r.rootUri)!==void 0)return this.telemetryService.sendEvent("command.unstageAllChanges"),void this.changeStore.unstageAll(r.rootUri)}),s.commands.registerCommand("remoteHub.unstageChanges",t=>{if(!!to(t))return this.telemetryService.sendEvent("command.unstageChanges"),void this.changeStore.unstage(t.resourceUri)}),s.commands.registerCommand("remoteHub.keepChanges",t=>{if(!!to(t))return this.telemetryService.sendEvent("command.keepChanges"),void this.changeStore.keep(t.resourceUri)}),s.commands.registerCommand("remoteHub.openChanges",t=>{var r;const{command:n}=t;if(!!n)return this.telemetryService.sendEvent("command.openChanges"),void s.commands.executeCommand(n.command,...(r=n.arguments)!=null?r:[])}),s.commands.registerCommand("remoteHub.openFile",t=>{var r;if(Ef(t)){const i=this.changeStore.resolveOpenCommand(t.resourceUri,{preserveFocus:!1,preview:!1,viewColumn:s.ViewColumn.Active});return this.telemetryService.sendEvent("command.openFile"),void s.commands.executeCommand(i.command,...(r=i.arguments)!=null?r:[])}const n=s.window.activeTextEditor;if(!!n)return this.telemetryService.sendEvent("command.openFile"),void s.window.showTextDocument(n.document)}),s.commands.registerCommand("remoteHub.createBranch",async t=>{await us("remoteHub.createBranchFrom",{...t,fromSha:"HEAD"})}),s.commands.registerCommand("remoteHub.createBranchFrom",async t=>{var r;const n=(r=t==null?void 0:t.uri)!=null?r:await ro(this._scmProviders,pe("choose repo for create branch placeholder","Choose which repository to create a new branch on"),pe("choose repo for create branch title","Create Branch"));if(n===void 0)return;this.telemetryService.sendEvent("command.createBranchFrom");const i=await this.providerService.getMetadata(n);if(i.accessLevel<xt.Write){this.telemetryService.sendEvent("command.createBranchFrom.abort",{reason:"no permissions"}),s.window.showErrorMessage(pe("no permissions to create branch ","You don't have access to create branches on this repository."));return}let o;if(t==null?void 0:t.fromSha)o=t.fromSha,o==="HEAD"&&(o=i.HEAD.sha);else{const k=await ca.show(this.providerService,n,pe("choose branch for create placeholder","Choose which branch to create the new branch from"),pe("choose branch for create title","Create Branch \u2022 {0}",i.name));if(!k){this.telemetryService.sendEvent("command.createBranchFrom.abort",{reason:"abandoned branch picker"});return}o=k.sha}let a;try{a=await s.window.withProgress({location:s.ProgressLocation.SourceControl},()=>yc(this.providerService,n,o,pe("create branch","Please provide a new branch name"),pe("create branch placeholder","New branch name"),pe("create branch title","Create Branch \u2022 {0}",i.name)))}catch(k){he.error(k),s.window.showErrorMessage(pe("unable to create branch","Unable to create the new branch."));return}if(!a){this.telemetryService.sendEvent("command.createBranchFrom.abort",{reason:"abandoned branch name prompt"});return}const c=await this.providerService.switchTo(n,a);if(!c)return;const w=await this.changeStore.createChangeset(n);w&&await this.openActionsService.setChangesetToApply(c.uri,w);const p="Switch",S="Open in New Window",P=await s.window.showInformationMessage("Would you like to switch to the new branch?",p,S);!P||(c.location=P===S?rt.NewWindow:rt.CurrentWindow,await Vt(c))}),s.commands.registerCommand("remoteHub.applyPatch",async t=>{if(t=this.getSourceControlFrom(t),(t==null?void 0:t.rootUri)===void 0)return;this.telemetryService.sendEvent("command.applyPatch");let r;const n=s.window.activeTextEditor;if((n==null?void 0:n.document.languageId)!=="diff"){const i=await s.window.showOpenDialog({openLabel:pe("open patch","Open Patch"),title:pe("open patch","Open Patch"),canSelectFiles:!0,canSelectFolders:!1,canSelectMany:!1,filters:{Diff:["diff"],Patch:["patch"]}});if(i===void 0||i.length===0)return;r=Rb.decode(await s.workspace.fs.readFile(i[0]))}else r=n.document.getText();try{await this.changeStore.applyPatch(t.rootUri,r)}catch(i){s.window.showErrorMessage(i.toString())}}),s.commands.registerCommand("remoteHub.exportPatch",async t=>{const r=this.getSourceControlFrom(t);if((r==null?void 0:r.rootUri)===void 0)return;let n;Ef(t)&&(n=t.resourceUri),this.telemetryService.sendEvent("command.exportPatch");const i=await this.changeStore.createPatch(r.rootUri,n),o=await s.workspace.openTextDocument({language:"diff",content:i});await s.window.showTextDocument(o)}),s.commands.registerCommand("remoteHub.switchToBranch",async t=>{var r,n;const i=(r=t==null?void 0:t.uri)!=null?r:await ro(this._scmProviders,pe("choose repo for switch branch placeholder","Choose which repository to switch branches on"),pe("choose repo for switch branch title","Switch to Branch Or Tag"));if(i===void 0)return;this.telemetryService.sendEvent("command.switchToBranch");const o=[],a=await this.providerService.getMetadata(i);if(t==null?void 0:t.commands)switch(a.accessLevel>=xt.Write&&o.push(new oi(Cr({command:"remoteHub.createBranch",title:pe("create branch command","$(add) Create New Branch..."),arguments:[{uri:i}]})),new oi(Cr({command:"remoteHub.createBranchFrom",title:pe("create branch from command","$(add) Create New Branch from..."),arguments:[{uri:i}]}))),a.HEAD.type){case nt.Branch:o.push(new oi(Cr({command:"remoteHub.openOnRemote",title:pe("open branch on remote command","$(globe) Open Branch on {0}...",a.provider.name),arguments:[{provider:a.provider,repo:a.repo,branch:a.HEAD.branch.name}]})));break;case nt.Tag:o.push(new oi(Cr({command:"remoteHub.openOnRemote",title:pe("open tag on remote command","$(globe) Open Tag on {0}...",a.provider.name),arguments:[{provider:a.provider,repo:a.repo,branch:a.HEAD.detached.name}]})));break;case nt.Commit:o.push(new oi(Cr({command:"remoteHub.openOnRemote",title:pe("open commit on remote command","$(globe) Open Commit on {0}...",a.provider.name),arguments:[{provider:a.provider,repo:a.repo,sha:a.HEAD.sha}]})));break}const c=(n=a.HEAD.branch)==null?void 0:n.name,w=await ca.show(this.providerService,i,pe("choose switch branch placeholder","Choose which branch to switch to"),pe("choose switch branch title","Switch to Branch Or Tag \u2022 {0}",a.name),o,{filterBranches:c?p=>p.name!==c:void 0});if(!w){this.telemetryService.sendEvent("command.switchToBranch.abort",{reason:"abandoned branch picker"});return}return w instanceof oi?void w.execute():void s.window.withProgress({location:s.ProgressLocation.SourceControl},async()=>{const p=await this.providerService.switchTo(i,w.name);if(p!==void 0)return Vt(p)})}),s.commands.registerCommand("remoteHub.fetch",async t=>{var r;const n=(r=t==null?void 0:t.uri)!=null?r:await ro(this._scmProviders,pe("choose repo for fetch placeholder","Choose which repository to fetch"),pe("choose repo for fetch title","Fetch Repository"));if(n!==void 0){this.telemetryService.sendEvent("command.fetch");try{await s.window.withProgress({location:s.ProgressLocation.SourceControl},()=>this.providerService.fetch(n,{force:!0}))}catch(i){s.window.showErrorMessage(pe("fetch failed","Unable to fetch repository"))}}}),s.commands.registerCommand("remoteHub.fetchAll",async t=>{const r=this.providerService.repositories;if(r.length===0)return;(t==null?void 0:t.automated)||this.telemetryService.sendEvent("command.fetchAll"),(await s.window.withProgress({location:s.ProgressLocation.SourceControl},async()=>{const i=[];for(const o of r)try{await this.providerService.fetch(o.uri)}catch(a){i.push(a)}return i})).length&&!(t==null?void 0:t.automated)&&s.window.showErrorMessage(r.length?pe("fetch all failed","Unable to fetch repositories"):pe("fetch failed","Unable to fetch repository"))}),s.commands.registerCommand("remoteHub.pull",async t=>{var r;const n=(r=t==null?void 0:t.uri)!=null?r:await ro(this._scmProviders,pe("choose repo for pull placeholder","Choose which repository to pull"),pe("choose repo for pull title","Pull Repository"));n!==void 0&&(this.telemetryService.sendEvent("command.pull"),await this.sync(n,{pull:!0}))}),s.commands.registerCommand("remoteHub.sync",async t=>{var r;const n=(r=t==null?void 0:t.uri)!=null?r:await ro(this._scmProviders,pe("choose repo for sync placeholder","Choose which repository to sync"),pe("choose repo for sync title","Synchronize Repository"));n!==void 0&&(this.telemetryService.sendEvent("command.sync"),await this.sync(n))})]}async sync(t,{pull:r,...n}={pull:!1}){this.telemetryService.sendEvent("sync");try{await s.window.withProgress({location:s.ProgressLocation.SourceControl},()=>this.providerService.sync(t,this.changeStore,n))}catch(i){if(i instanceof go){const o={title:pe("sync confirm","Continue")},a={title:pe("sync cancel","Cancel"),isCloseAffordance:!0};await s.window.showWarningMessage(r?pe("sync pull",`Pulling in changes may cause conflicts with your uncommitted changes as one of more of those files has changed since you started editing.

Do you want to continue pulling in changes.`):pe("sync",`Syncing changes may cause conflicts with your uncommitted changes as one of more of those files has changed since you started editing.

Do you want to continue syncing changes?`),{modal:!0},o,a)===o?await s.window.withProgress({location:s.ProgressLocation.SourceControl},()=>this.providerService.sync(t,this.changeStore,{conflictResolution:wr.Merge})):this.telemetryService.sendEvent("sync.abort",{reason:"abandoned"})}else throw he.error(i),this.telemetryService.sendException(i),s.window.showErrorMessage(pe("sync failed","Unable to synchronize repository")),i}}async commitChanges(t){try{await s.window.withProgress({location:s.ProgressLocation.SourceControl},()=>this.commitChangesCore(t))}catch(r){he.error(r),this.telemetryService.sendException(r),s.window.showErrorMessage(pe("commit unable","Unable to commit."))}}async commitChangesCore(t){const r=t.rootUri;this.telemetryService.sendEvent("commit",{staging:String(this.staging.enabled)});const n=await this.providerService.getMetadata(r);let i,o;for(;;){const c=t.inputBox.value;if(await this.changeStore.hasMergeConflicts(r)){t.inputBox.showValidationMessage(pe("commit resolve conflicts","You must resolve any pending conflicts before committing."),s.SourceControlInputBoxValidationType.Error),this.telemetryService.sendEvent("commit.abort",{reason:"aborted conflicts"});return}const w=await this.providerService.getCommitOperations(r,this.changeStore,{staged:this.staging.enabled?this.staging.smart?"auto":!0:!1});if(w.length===0){t.inputBox.showValidationMessage(this.staging.enabled?pe("commit no staged changes","There are no staged changes to commit."):pe("commit no changes","There are no changes to commit."),s.SourceControlInputBoxValidationType.Information),this.telemetryService.sendEvent("commit.abort",{reason:this.staging.enabled?"aborted no staged changes":"aborted no changes"});return}if(!c){t.inputBox.showValidationMessage(pe("specify commit message","You must specify a commit message before committing."),s.SourceControlInputBoxValidationType.Error),this.telemetryService.sendEvent("commit.abort",{reason:"aborted no message"});return}if(o===void 0&&n.accessLevel<xt.Write&&(o=await this.providerService.getFork(r),o===void 0)){const S=pe("fork confirm","Fork Repository");if(await s.window.showInformationMessage(pe("fork","You\u2019re trying to make changes in a project you don\u2019t have write access to. Would you like to create a fork of this project to commit your proposed changes to?"),S)!==S){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned fork prompt"});return}if(o=await s.window.withProgress({location:s.ProgressLocation.Notification,title:pe("fork progress","Forking {0}...",n.name)},()=>this.providerService.fork(r)),o===void 0){s.window.showErrorMessage(pe("unable to fork","Unable to fork repository.")),this.telemetryService.sendEvent("commit.abort",{reason:"aborted fork failed"});return}}const p=await this.providerService.createCommit(r,c,w,o);try{await this.providerService.pushCommit(r,p,i,o)}catch(S){if(S instanceof yi){const P={title:pe("push detached head prompt","Commit to New Branch")},k={title:pe("cancel","Cancel"),isCloseAffordance:!0};if(await s.window.showErrorMessage(pe("push detached head prompt",`Unable to commit your changes because you are not currently on a branch.

Do you want to commit your changes to a new branch?`),{modal:!0},P,k)!==P){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned detached head prompt"});return}if(i=await yc(this.providerService,r,n.HEAD.sha,pe("push to new branch prompt","Create a new branch to commit your changes to"),pe("push to new branch placeholder","New branch name"),pe("push to new branch title","Commit \u2022 Create Branch \u2022 {0}",n.name),o),i)continue}else if(S instanceof po){const P={title:pe("push conflicts prompt pull","Pull")},k={title:pe("push conflicts prompt sync","Sync (Pull & Push)")},I={title:pe("cancel","Cancel"),isCloseAffordance:!0},$=await s.window.showErrorMessage(pe("push conflicts prompt",`Changes have been committed since you started editing, so you must merge those changes before you can commit.

Do you want to pull or sync (pull and automatically push again) your changes?`),{modal:!0},P,k,I);if($!==P&&$!==k){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned conflicts prompt"});return}if(await this.sync(r,{pull:$===P,conflictResolution:wr.Merge}),$===P)return;continue}}break}if(t.inputBox.value="",o?await this.changeStore.discardAll(r):await this.changeStore.acceptAll(r),!o&&!i)return;async function a(){if(o){const p=pe("commit to fork confirm","Switch to Fork"),S=await s.window.showInformationMessage(pe("commit to fork","Committed changes to your fork of {0}. Would you like to switch to your fork to continue making changes?",n.name),p);this.telemetryService.sendEvent("commit.switchToFork",{confirm:String(S===p)}),S===p&&Vt({name:o.name,uri:this.providerService.createVirtualUri(r,{repo:o.repo,ref:n.HEAD.branch?{type:We.Branch,id:n.HEAD.branch.name}:void 0}),location:rt.CurrentWindow});return}const c=pe("commit to new branch confirm","Switch to Branch"),w=await s.window.showInformationMessage(pe("commit to new branch","Committed changes to new branch '{0}'. Would you like to switch to your new branch to continue making changes?",i),c);this.telemetryService.sendEvent("commit.switchToBranch",{confirm:String(w===c)}),w===c&&Vt({name:n.name,uri:this.providerService.createVirtualUri(r,{repo:n.repo,ref:i?{type:We.Branch,id:i}:void 0}),location:rt.CurrentWindow})}a.call(this)}async createPullRequest(t,r){try{await s.window.withProgress({location:s.ProgressLocation.SourceControl},()=>this.createPullRequestCore(t,r))}catch(n){he.error(n),s.window.showErrorMessage(pe("unable to open pr","Unable to open a pull request."))}}async createPullRequestCore(t,r){var n,i;const o=t.rootUri,a=(n=r==null?void 0:r.draft)!=null?n:!1;this.telemetryService.sendEvent("createPullRequest",{draft:String(a)});let c;if(!(r==null?void 0:r.sha)&&(c=await this.providerService.getCommitOperations(o,this.changeStore),!c.length)){s.window.showInformationMessage(pe("no changes","There are no changes.")),this.telemetryService.sendEvent("createPullRequest.abort",{reason:"aborted no changes"});return}const w=t.inputBox.value;if(!w){t.inputBox.showValidationMessage(pe("specify commit message","Please specify a commit message"),s.SourceControlInputBoxValidationType.Error),this.telemetryService.sendEvent("createPullRequest.abort",{reason:"aborted no message"});return}const p=await this.providerService.getMetadata(o);let S=r==null?void 0:r.fork;if(!S&&p.accessLevel<xt.Write&&(S=await this.providerService.getFork(o),S===void 0)){const q={title:pe("fork confirm","Fork Repository")},Z={title:pe("cancel","Cancel"),isCloseAffordance:!0};if(await s.window.showInformationMessage(pe("fork",`You\u2019re trying to make changes in a project you don\u2019t have write access to.

Would you like to create a fork of this project to commit your proposed changes to?`),{modal:!0},q,Z)!==q){this.telemetryService.sendEvent("createPullRequest.abort",{reason:"abandoned fork prompt"});return}if(S=await s.window.withProgress({location:s.ProgressLocation.Notification,title:pe("fork progress","Forking {0}...",p.name)},()=>this.providerService.fork(o)),S===void 0){s.window.showErrorMessage(pe("unable to fork","Unable to fork repository.")),this.telemetryService.sendEvent("createPullRequest.abort",{reason:"aborted fork failed"});return}}const P=await s.window.showInputBox({ignoreFocusOut:!0,placeHolder:pe("create pr placeholder","Pull request title"),prompt:pe("create pr prompt","Enter a title for the new pull request"),title:pe("create pr title","New Pull Request"),value:w});if(!P){this.telemetryService.sendEvent("createPullRequest.abort",{reason:"abandoned title prompt"});return}let k;(c==null?void 0:c.length)?k=await this.providerService.createCommit(o,w,c,S):k=(i=r==null?void 0:r.sha)!=null?i:p.HEAD.sha;const I=await yc(this.providerService,o,k,pe("create pr branch prompt","Create a new branch for this pull request"),pe("create pr branch placeholder","New branch name"),pe("create pr branch title","New Pull Request \u2022 Create Branch \u2022 {0}",p.name),S);if(!I){this.telemetryService.sendEvent("createPullRequest.abort",{reason:"abandoned branch prompt"});return}const $=await this.providerService.createPullRequest(o,I,P,{draft:a},S);t.inputBox.value="",S?await this.changeStore.discardAll(o):await this.changeStore.acceptAll(o);async function B(){if(S){const K=pe("created pr from fork confirm","Switch to Fork"),re=await s.window.showInformationMessage(pe("created pr from fork",'Created [Pull Request #{0}]({1} "Open Pull Request #{0} on {2}") for {3}. Would you like to switch to your fork to continue making changes?',$.id,$.uri.toString(!0),p.provider.name,p.name),K);this.telemetryService.sendEvent("createPullRequest.switchToFork",{confirm:String(re===K)}),re===K&&Vt({name:S.name,uri:this.providerService.createVirtualUri(o,{repo:S.repo,ref:{type:We.PullRequest,id:$.id}}),location:rt.CurrentWindow});return}const q=pe("created pr from branch confirm","Switch to Branch"),Z=await s.window.showInformationMessage(pe("created pr from branch",'Created [Pull Request #{0}]({1} "Open Pull Request #{0} on {2}") for {3}. Would you like to switch to your new branch to continue making changes?',$.id,$.uri.toString(!0),p.provider.name,p.name),q);this.telemetryService.sendEvent("createPullRequest.switchToBranch",{confirm:String(Z===q)}),Z===q&&Vt({name:p.name,uri:this.providerService.createVirtualUri(o,{repo:p.repo,ref:{type:We.PullRequest,id:$.id}}),location:rt.CurrentWindow})}B.call(this)}async update(t){const r=s.workspace.getWorkspaceFolder(t);if(r===void 0)return;const n=await this.createOrUpdateScmProvider(t,r.name),i=await this.changeStore.getGroupedChanges(t,{predicate:w=>w.fileType===s.FileType.File}),o=await Promise.all(i.conflicts.map(async w=>({type:w.type,resourceUri:w.uri,command:await this.changeStore.resolveDiffCommand(w.uri,w.conflicts.incomingUri,pe("diff title with conflicts","{0} (Incoming Changes \u2194 Current Changes)",Dt(w.uri)))}))),a=await Promise.all(i.staged.map(async w=>({type:w.type,resourceUri:w.uri,command:await this.changeStore.resolveDiffCommand(w.uri,this.providerService.getProviderUri(w.uri),pe("diff title index","{0} (Index)",Dt(w.uri)))}))),c=await Promise.all(i.working.map(async w=>({type:w.type,resourceUri:w.uri,decorations:{strikeThrough:w.type===Be.Deleted},command:await this.changeStore.resolveDiffCommand(w.uri,this.providerService.getProviderUri(w.uri),pe("diff title working","{0} (Working Tree)",Dt(w.uri)))})));return this.ensureMergeConflictsGroup(n).resourceStates=o,this.ensureStagedChangesGroup(n).resourceStates=this.staging.enabled?a:[],this.ensureWorkingChangesGroup(n).resourceStates=this.staging.enabled?c:[...a,...c],n}async createOrUpdateScmProvider(t,r){const n=await this.providerService.getMetadata(t);let i=this.getScmProvider(t);if(i===void 0){r=n.name;const o=s.scm.createSourceControl(`remoteHub:${n.provider.id}`,r,t);o.quickDiffProvider={provideOriginalResource:c=>this.providerService.getProviderUri(c)},n.accessLevel>=xt.Write?(o.acceptInputCommand={command:"remoteHub.commit",title:pe("scm input accept command title commit","Commit"),arguments:[o]},o.inputBox.placeholder=pe("scm input placeholder commit","Message (Ctrl+Enter to commit to '{0}'",r)):(o.acceptInputCommand={command:"remoteHub.createPullRequest",title:pe("scm input accept command title pr","Create a Pull Request"),arguments:[o]},o.inputBox.placeholder=pe("scm input placeholder pr","Message (Ctrl+Enter to create a pull request for '{0}'",r));const a=this.providerService.createIGitRepository(t,o,n,this.changeStore);i={id:n.provider.id,name:n.provider.name,sourceControl:o,groups:[],repository:a},this.ensureMergeConflictsGroup(i),this.ensureStagedChangesGroup(i),this.ensureWorkingChangesGroup(i),this._scmProviders.push(i)}return await this.updateStatusBarCommands(i,{syncing:!1},n),i}async updateStatusBarCommands(t,r,n){var i,o,a;const c=t.sourceControl.rootUri;n=n!=null?n:await this.providerService.getMetadata(c);const{HEAD:w}=n,p=await this.changeStore.hasChanges(c),S=[Cr({command:"remoteHub.switchToBranch",title:`${mc(w.type)} ${w.name}${p?"*":""}`,tooltip:wt(w.sha),arguments:[{uri:c,commands:!0}]})];w.detached||((r==null?void 0:r.syncing)?S.push(Cr({command:"",title:"$(sync~spin)",tooltip:pe("sync command syncing","Syncing Changes..."),arguments:[]})):S.push(Cr({command:"remoteHub.sync",title:`$(sync)${((o=(i=n.state)==null?void 0:i.behind)!=null?o:0)>0?` ${(a=n.state)==null?void 0:a.behind}\u2193`:""}`,tooltip:pe("sync command","Sync (Pull & Push)"),arguments:[{uri:c}]}))),n.pullRequest&&S.push(Cr({command:"remoteHub.openOnRemote",title:`$(git-pull-request) ${n.pullRequest.id}`,tooltip:pe("scm statusbar command open pr",`Open Pull Request #{0} on {1}

{2}`,n.pullRequest.id,n.provider.name,n.pullRequest.title),arguments:[{provider:n.provider,repo:n.pullRequest.repo,pullRequest:n.pullRequest.id}]})),t.sourceControl.statusBarCommands=S}ensureMergeConflictsGroup(t){const r="conflicts";let n=t.groups.find(i=>i.id===r);return n===void 0&&(n=t.sourceControl.createResourceGroup(r,pe("scm group conflicts","Merge Conflicts")),n.hideWhenEmpty=!0,t.groups.push(n)),n}ensureStagedChangesGroup(t){const r="staged";let n=t.groups.find(i=>i.id===r);return n===void 0&&(n=t.sourceControl.createResourceGroup(r,pe("scm group staged","Staged Changes")),n.hideWhenEmpty=!0,t.groups.push(n)),n}ensureWorkingChangesGroup(t){const r="changes";let n=t.groups.find(i=>i.id===r);return n===void 0&&(n=t.sourceControl.createResourceGroup(r,pe("scm group changes","Changes")),t.groups.push(n)),n}getScmProvider(t){const r=be(t);return this._scmProviders.find(n=>be(n.sourceControl.rootUri)===r)}getSourceControlFrom(t){if(t===void 0){if(this._scmProviders.length!==1)return;t=this._scmProviders[0].sourceControl}let r;if(Db(t))r=t;else if(Sf(t)){const n=t,i=this._scmProviders.find(o=>o.groups.includes(n));r=i==null?void 0:i.sourceControl}else{const n=t,i=this._scmProviders.find(o=>o.groups.some(a=>a.resourceStates.includes(n)));r=i==null?void 0:i.sourceControl}return r}}function Db(e){return"rootUri"in e&&"inputBox"in e}function Sf(e){return e!==void 0&&"id"in e&&"label"in e&&"resourceStates"in e&&Array.isArray(e.resourceStates)}function Ef(e){return e!==void 0&&"resourceUri"in e&&e.resourceUri instanceof s.Uri}function to(e){return"type"in e}async function vc(e){var t,r,n;if(e.length===0)return!0;let i,o=pe("discard","Discard Changes");if(e.length===1){const c=e[0];c.type===Be.Created?(i=pe("confirm delete",`Are you sure you want to DELETE {0}?
This is IRREVERSIBLE!
This file will be FOREVER LOST.`,Dt((t=c.resourceUri)!=null?t:c.uri)),o=pe("delete file","Delete file")):c.type===Be.Deleted?(o=pe("restore file","Restore file"),i=pe("confirm restore","Are you sure you want to restore {0}?",Dt((r=c.resourceUri)!=null?r:c.uri))):i=pe("confirm discard","Are you sure you want to discard changes in {0}?",Dt((n=c.resourceUri)!=null?n:c.uri))}else e.every(c=>c.type===Be.Created)?i=pe("confirm delete multiple",`Are you sure you want to DELETE {0} files?
This is IRREVERSIBLE!
These files will be FOREVER LOST.`,e.length):e.every(c=>c.type===Be.Deleted)?(o=pe("restore files","Restore files"),i=pe("confirm restore multiple","Are you sure you want to restore {0} files?",e.length)):i=pe("confirm discard multiple","Are you sure you want to discard changes in {0} files?",e.length);return await s.window.showWarningMessage(i,{modal:!0},o)===o}async function ro(e,t,r){if(e.length===0)return;if(e.length===1)return e[0].sourceControl.rootUri;const n=await s.window.showQuickPick(e.map(({sourceControl:i})=>({label:i.label,uri:i.rootUri})),{placeHolder:t,title:r});if(!!n)return n.uri}async function yc(e,t,r,n,i,o,a){const c=new Set;let w;const p=s.window.createInputBox();p.ignoreFocusOut=!0;try{return await new Promise((S,P)=>{w=s.Disposable.from(p.onDidHide(()=>S(void 0)),p.onDidChangeValue(k=>{if(k=k.trim(),!k){p.validationMessage=pe("scm create branch prompt validation missing name","Please enter a valid branch name");return}if(c.has(k)){p.validationMessage=pe("scm create branch prompt validation already exists","Branch '{0}' already exists",k);return}if(!q0(k)){p.validationMessage=pe("scm create branch prompt validation invalid name","'{0}' isn't a valid branch name",k);return}p.validationMessage=void 0}),p.onDidAccept(async()=>{const k=p.value;try{p.enabled=!1,p.busy=!0;const I=await e.createBranch(t,k,r,a);S(I)}catch(I){if(I instanceof wi){p.enabled=!0,p.busy=!1,p.validationMessage=I.duplicate?pe("scm create branch prompt validation already exists","Branch '{0}' already exists",k):pe("scm create branch prompt validation invalid","Invalid branch name '{0}'",k),c.add(k);return}P(I)}})),p.prompt=n,p.placeholder=i,p.title=o,p.show()})}finally{p.dispose(),w==null||w.dispose()}}class wc{constructor(t,r){this.memento=t,this.scope=r,this._onDidChange=new s.EventEmitter}get onDidChange(){return this._onDidChange.event}async get(t){const r=this.getScoped(t),n=new Qe(`MementoStorage.get(${t}): scopedKey=${r}`,{log:!0});try{return await Promise.resolve(this.memento.get(r))}finally{n.stop()}}async getKeys(t){const r=this.getScoped(t),n=new Qe(`MementoStorage.getKeys(${t}): scopedPrefix=${r}`,{log:!0});try{let i=this.getKeysCore(t);if(this.scope!==void 0){const o=this.scope.length+1;i=i.map(a=>a.substr(o))}return await Promise.resolve(i)}finally{n.stop()}}getKeysCore(t){let r=this.memento.keys;return t&&(r=r.filter(n=>n.startsWith(t))),r}async store(t,r){const n=this.getScoped(t),i=new Qe(`MementoStorage.store(${t}): scopedKey=${n}`,{log:!0});try{return await this.storeCore(t,n,r)}finally{i.stop()}}async storeCore(t,r,n){await this.memento.update(r,n),this._onDidChange.fire({key:t})}async delete(t){const r=this.getScoped(t),n=new Qe(`MementoStorage.delete(${t}): scopedKey=${r}`,{log:!0});try{return await this.storeCore(t,r,void 0)}finally{n.stop()}}async deleteKeys(t){const r=this.getScoped(t),n=new Qe(`MementoStorage.deleteKeys(${t}): scopedPrefix=${r}`,{log:!0});try{const i=[],o=this.scope!==void 0?this.scope.length+1:0,a=this.getKeysCore(r);for(const c of a){const w=o!==0?c.substr(o):c;he.debug(`MementoStorage.deleteKeys(${t}): Deleting key=${w}, scopedKey=${c}`);try{await this.storeCore(w,c,void 0)}catch(p){he.debug(`MementoStorage.deleteKeys(${t}): Failed to delete key=${w}, scopedKey=${c}`),i.push(w)}}if(i.length)throw new Error(`Failed to delete keys: ${i.join(", ")}`)}finally{n.stop()}}with(t){return new wc(this.memento,t)}getScoped(t){return`${this.scope!==void 0?`${this.scope}/`:""}${t!=null?t:""}`}}class bc{constructor(t,r){this.storageUri=t,this.scope=r,this._onDidChange=new s.EventEmitter}get onDidChange(){return this._onDidChange.event}async get(t){const r=this.getScoped(t),n=new Qe(`ExtFileStorageService.get(${t}): scopedKey=${r}`,{log:!0});try{return await s.workspace.fs.readFile(s.Uri.joinPath(this.storageUri,r))}catch(i){return}finally{n.stop()}}async store(t,r){const n=this.getScoped(t),i=new Qe(`ExtFileStorageService.store(${t}): scopedKey=${n}`,{log:!0});try{return await this.storeCore(t,n,r)}finally{i.stop()}}async storeCore(t,r,n){await s.workspace.fs.writeFile(s.Uri.joinPath(this.storageUri,r),n),this._onDidChange.fire({key:t})}async delete(t){const r=this.getScoped(t),n=new Qe(`ExtFileStorageService.delete(${t}): scopedKey=${r}`,{log:!0});try{return await s.workspace.fs.delete(s.Uri.joinPath(this.storageUri,r))}finally{n.stop()}}with(t){return new bc(this.storageUri,t)}getScoped(t){return`${this.scope!==void 0?`${this.scope}/`:""}${t}`}}const it=(0,E.LV)();class Or extends s.TimelineItem{static is(t){return t instanceof Or}constructor(t,r,n,i,{dateType:o,showAuthor:a,dateFormatter:c}){var w;const p=n.message.indexOf(`
`),S=p!==-1?`${n.message.substring(0,p)} \u2026`:n.message,P=o==="authored"?n.authorDate:n.commitDate;super(S,(w=P==null?void 0:P.getTime())!=null?w:0);this.id=n.hash,this.contextValue=`vscode-vfs:${r}:file:commit`,this.command=i,a&&(this.description=n.authorName),this.detail=it("timeline item detail",`{0} ({1}) \u2014 {2}
{3}

{4}`,n.authorName,n.authorEmail,wt(n.hash),c.format(P),n.message),this.iconPath=new s.ThemeIcon("git-commit"),this.rootUri=t,this.providerId=r,this.hash=n.hash,this.parents=n.parents,this.message=n.message}}class ai extends s.TimelineItem{static is(t){return t instanceof ai}constructor(t,r,n,i,o,{dateFormatter:a,staged:c}){const w=c?it("timeline staged changes","Staged Changes"):it("timeline uncommitted changes","Uncommitted Changes");super(w,n.timestamp);this.id=c?"index":"working",this.contextValue=`vscode-vfs:${r}:file:${this.id}`,this.command=o,this.iconPath=new s.ThemeIcon("git-commit"),c?this.detail=it("timeline index detail",`{0}  \u2014 {1}
{2}

{3}`,it("timeline you","You"),it("timeline index","Index"),a.format(new Date(n.timestamp)),ku(n.type)):this.detail=it("timeline working detail",`{0}  \u2014 {1}
{2}

{3}`,it("timeline you","You"),it("timeline working","Working Tree"),a.format(new Date(n.timestamp)),ku(n.type)),this.rootUri=t,this.providerId=r,this.hash=c?"~":"",this.parents=i,this.message=w}}class Ib{constructor(t,r){this.providerService=t,this.changeStore=r,this._onDidChange=new s.EventEmitter,this.id="github-file-history",this.label=it("timeline.source","GitHub File History"),this.debouncer=new as(500),this.disposable=s.Disposable.from(this.debouncer,t.onDidChangeProviders(this.onProvidersChanged,this),t.onDidChangeRepositories(this.onRepositoriesChanged,this),t.onDidChangeRepository(this.onRepositoryChanged,this),t.onDidRefresh(this.onRefresh,this),r.onDidChange(this.onUrisChanged,this),He.onDidChangeAny(this.onConfigurationChanged,this),...this.registerCommands()),t.hasProviders&&this.ensureProviderRegistration()}get onDidChange(){return this._onDidChange.event}dispose(){var t;(t=this.providerDisposable)==null||t.dispose(),this.disposable.dispose()}onConfigurationChanged(t){(t.affectsConfiguration("git.timeline.date")||t.affectsConfiguration("git.timeline.showAuthor"))&&this.fireChanged()}onProvidersChanged(t){this.ensureProviderRegistration(),this.fireChanged()}onRefresh(t){if(this.rootUri===void 0)return;const r=be(this.rootUri);!t.some(n=>be(n)===r)||this.fireChanged()}onRepositoriesChanged(t){if(this.rootUri===void 0)return;const r=be(this.rootUri);(t.added.some(n=>be(n.uri)===r)||t.removed.some(n=>be(n.uri)===r))&&this.fireChanged()}onRepositoryChanged(t){this.rootUri===void 0||be(this.rootUri)!==be(t.repository.uri)||this.fireChanged()}onUrisChanged(t){if(this.rootUri===void 0)return;const r=be(this.rootUri);t.some(n=>be(n.rootUri)===r)&&this.fireChanged()}async provideTimeline(t,r,n){var i;try{this.rootUri=this.providerService.getVirtualRootUri(t);for(const $ of this.providerService.repositories)if($.uri.path===this.rootUri.path){this.rootUri=$.uri;break}const o=this.providerService.getRelativeFilePath(this.rootUri,t),a=await this.providerService.getMetadata(this.rootUri);if(!a||n.isCancellationRequested)return{items:[]};const c=await this.providerService.getCommits(this.rootUri,{ref:a.HEAD.sha,path:o||void 0,cursor:r.cursor,limit:typeof r.limit=="number"?r.limit:void 0});if(c===void 0||c.commits.length===0||n.isCancellationRequested)return{items:[]};const w=((i=c.paging)==null?void 0:i.more)?{cursor:c.paging.cursor}:void 0,p=new Intl.DateTimeFormat(s.env.language,{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"}),S=He.getAny("git.timeline.date",void 0,"committed"),P=He.getAny("git.timeline.showAuthor",void 0,!0),k=c.commits.map($=>new Or(this.rootUri,a.provider.id,$,this.resolveDiffCommand($,a,t,o),{dateType:S,showAuthor:P,dateFormatter:p})),I=r.cursor===void 0?await this.changeStore.getChange(t):void 0;if(I){const $=Boolean(I.staged&&He.get("staging.enabled")),B=new ai(this.rootUri,a.provider.id,I,[c.commits[0].hash],await this.changeStore.resolveDiffCommand(I.uri,this.providerService.getProviderUri(I.uri),$?it("diff title index","{0} (Index)",Dt(I.uri)):it("diff title working","{0} (Working Tree)",Dt(I.uri))),{dateFormatter:p,staged:$});k.splice(0,0,B)}return{items:k,paging:w}}catch(o){return he.error(o),{items:[]}}}ensureProviderRegistration(){this.providerDisposable===void 0&&(this.providerDisposable=s.workspace.registerTimelineProvider([Je.scheme,...this.providerService.registeredProviders.map(t=>t.id)],this))}fireChanged(){this.debouncer.debounce(()=>this._onDidChange.fire(void 0))}registerCommands(){let t;return[s.commands.registerCommand("remoteHub.timeline.copyCommitId",(r,n,i)=>{!Or.is(r)||s.env.clipboard.writeText(r.hash)}),s.commands.registerCommand("remoteHub.timeline.copyCommitMessage",(r,n,i)=>{!Or.is(r)||s.env.clipboard.writeText(r.message)}),s.commands.registerCommand("remoteHub.timeline.openDiff",async(r,n,i)=>{var o;!Or.is(r)&&!ai.is(r)||r.command!==void 0&&await s.commands.executeCommand(r.command.command,...(o=r.command.arguments)!=null?o:[])}),s.commands.registerCommand("remoteHub.timeline.openOnGitHub",async(r,n,i)=>{if(!Or.is(r))return;const o=await this.providerService.getMetadata(r.rootUri);await us("remoteHub.openOnRemote",{provider:o.provider,repo:o.repo,sha:r.hash})}),s.commands.registerCommand("remoteHub.timeline.selectForCompare",async(r,n,i)=>{!n||!Or.is(r)&&!ai.is(r)||(t={uri:n,left:r},await s.commands.executeCommand("setContext","remoteHub.timeline.selectedForCompare",!0))}),s.commands.registerCommand("remoteHub.timeline.compareWithSelected",async(r,n,i)=>{if(!n||!t||!Or.is(r)&&!ai.is(r)||be(n)!==be(t.uri))return;const{left:o}=t,a=this.providerService.getRelativeFilePath(r.rootUri,n),c=await this.providerService.getMetadata(r.rootUri),w=Dt(n),p=o.parents[0];let S;p===void 0?S=it("timeline diff title ref","{0} ({1})",w,wt(r.hash)):o.hash===""?S=it("timeline diff title working","{0} (Working Tree)",w):o.hash==="~"?S=it("timeline diff title index","{0} (Index)",w):S=it("timeline diff title ref","{0} ({1})",w,wt(o.hash));let P=o.hash===""||o.hash==="~"?n:this.providerService.createProviderUri(n,{repo:c.repo,ref:{type:We.Commit,id:p!=null?p:"0000000000000000000000000000000000000000"}},a);p===void 0&&(P=P.with({query:"~"}));const k=r.parents[0];let I;k===void 0?I=it("timeline diff title ref","{0} ({1})",w,wt(r.hash)):k==="~"&&r.hash===""?I=it("timeline diff title working","{0} (Working Tree)",w):r.hash==="~"?I=it("timeline diff title index","{0} (Index)",w):I=it("timeline diff title ref","{0} ({1})",w,wt(r.hash));const $=it("timeline diff title","{0} \u27F7 {1}",S,I),B=r.hash===""||r.hash==="~"?n:this.providerService.createProviderUri(n,{repo:c.repo,ref:{type:We.Commit,id:r.hash}},a);await s.commands.executeCommand("vscode.diff",P,B,$)})]}resolveDiffCommand(t,r,n,i,o){const a=Dt(n),c=t.parents[0];let w;c===void 0?w=it("timeline diff title ref","{0} ({1})",a,wt(t.hash)):t.hash===""?w=it("timeline diff title working","{0} (Working Tree)",a):t.hash==="~"?w=it("timeline diff title index","{0} (Index)",a):w=it("timeline diff title refs","{0} ({1}) \u27F7  {0} ({2})",a,wt(c),wt(t.hash));let p=this.providerService.createProviderUri(n,{repo:r.repo,ref:{type:We.Commit,id:c!=null?c:"0000000000000000000000000000000000000000"}},i);c===void 0&&(p=p.with({query:"~"}));const S=t.hash===""||t.hash==="~"?n:this.providerService.createProviderUri(n,{repo:r.repo,ref:{type:We.Commit,id:t.hash}},i);return{command:"vscode.diff",title:"Open Comparison",arguments:[p,S,w,o]}}}class Ab{constructor(t,r){this.providerService=t,this.telemetryService=r,this.disposable=s.window.registerUriHandler(this)}dispose(){this.disposable.dispose()}async handleUri(t){switch(he.log(`RemoteUriHandler.handleUri: uri=${t.toString(!0)}`),t.path){case"/open":{this.telemetryService.sendEvent("handleUri.open");let r;for(const i of t.query.split("&")){const[o,a]=i.split("=");if(o==="url"){r=decodeURIComponent(a);break}}if(!r){he.warn(`RemoteUriHandler.handleUri: Unable to find url to open in uri=${t.toString(!0)}`),this.telemetryService.sendEvent("handleUri.open.abort",{reason:"aborted url not found"});return}r=r.trim(),he.warn(`RemoteUriHandler.handleUri: Opening url ${r}`);const n=await this.providerService.createWorkspaceForRemoteUrl(r,void 0,rt.NewWindow);if(!n){this.telemetryService.sendEvent("handleUri.open.abort",{reason:"aborted invalid url"});return}Vt(n);break}}}}const Ie=(0,E.LV)(),_c=60,Cc=_c*60,no=Cc*24,xf=no*7,Tf=no*30,Rf=no*365;function ua(e,t){typeof e!="number"&&(e=e.getTime());const r=Math.round((new Date().getTime()-e)/1e3);if(r<-30)return Ie("date.fromNow.in","in {0}",ua(new Date().getTime()+r*1e3,{ago:!1,short:t==null?void 0:t.short}));if(r<30)return(t==null?void 0:t.ago)?(t==null?void 0:t.short)?Ie("date.fromNow.seconds.short.ago","secs ago"):Ie("date.fromNow.seconds.ago","A few seconds ago"):(t==null?void 0:t.short)?Ie("date.fromNow.now.short","now"):Ie("date.fromNow.now","Just now");let n;return r<_c?(n=r,(t==null?void 0:t.ago)?n===1?(t==null?void 0:t.short)?Ie("date.fromNow.seconds.singular.short.ago","{0} sec ago",n):Ie("date.fromNow.seconds.singular.ago","{0} second ago",n):(t==null?void 0:t.short)?Ie("date.fromNow.seconds.plural.short.ago","{0} secs ago",n):Ie("date.fromNow.seconds.plural.ago","{0} seconds ago",n):n===1?(t==null?void 0:t.short)?Ie("date.fromNow.seconds.singular.short","{0} sec",n):Ie("date.fromNow.seconds.singular","{0} second",n):(t==null?void 0:t.short)?Ie("date.fromNow.seconds.plural.short","{0} secs",n):Ie("date.fromNow.seconds.plural","{0} seconds",n)):r<Cc?(n=Math.floor(r/_c),(t==null?void 0:t.ago)?n===1?(t==null?void 0:t.short)?Ie("date.fromNow.minutes.singular.short.ago","{0} min ago",n):Ie("date.fromNow.minutes.singular.ago","{0} minute ago",n):(t==null?void 0:t.short)?Ie("date.fromNow.minutes.plural.short.ago","{0} mins ago",n):Ie("date.fromNow.minutes.plural.ago","{0} minutes ago",n):n===1?(t==null?void 0:t.short)?Ie("date.fromNow.minutes.singular.short","{0} min",n):Ie("date.fromNow.minutes.singular","{0} minute",n):(t==null?void 0:t.short)?Ie("date.fromNow.minutes.plural.short","{0} mins",n):Ie("date.fromNow.minutes.plural","{0} minutes",n)):r<no?(n=Math.floor(r/Cc),(t==null?void 0:t.ago)?n===1?(t==null?void 0:t.short)?Ie("date.fromNow.hours.singular.short.ago","{0} hr ago",n):Ie("date.fromNow.hours.singular.ago","{0} hour ago",n):(t==null?void 0:t.short)?Ie("date.fromNow.hours.plural.short.ago","{0} hrs ago",n):Ie("date.fromNow.hours.plural.ago","{0} hours ago",n):n===1?(t==null?void 0:t.short)?Ie("date.fromNow.hours.singular.short","{0} hr",n):Ie("date.fromNow.hours.singular","{0} hour",n):(t==null?void 0:t.short)?Ie("date.fromNow.hours.plural.short","{0} hrs",n):Ie("date.fromNow.hours.plural","{0} hours",n)):r<xf?(n=Math.floor(r/no),(t==null?void 0:t.ago)?n===1?Ie("date.fromNow.days.singular.ago","{0} day ago",n):Ie("date.fromNow.days.plural.ago","{0} days ago",n):n===1?Ie("date.fromNow.days.singular","{0} day",n):Ie("date.fromNow.days.plural","{0} days",n)):r<Tf?(n=Math.floor(r/xf),(t==null?void 0:t.ago)?n===1?(t==null?void 0:t.short)?Ie("date.fromNow.weeks.singular.short.ago","{0} wk ago",n):Ie("date.fromNow.weeks.singular.ago","{0} week ago",n):(t==null?void 0:t.short)?Ie("date.fromNow.weeks.plural.short.ago","{0} wks ago",n):Ie("date.fromNow.weeks.plural.ago","{0} weeks ago",n):n===1?(t==null?void 0:t.short)?Ie("date.fromNow.weeks.singular.short","{0} wk",n):Ie("date.fromNow.weeks.singular","{0} week",n):(t==null?void 0:t.short)?Ie("date.fromNow.weeks.plural.short","{0} wks",n):Ie("date.fromNow.weeks.plural","{0} weeks",n)):r<Rf?(n=Math.floor(r/Tf),(t==null?void 0:t.ago)?n===1?(t==null?void 0:t.short)?Ie("date.fromNow.months.singular.short.ago","{0} mo ago",n):Ie("date.fromNow.months.singular.ago","{0} month ago",n):(t==null?void 0:t.short)?Ie("date.fromNow.months.plural.short.ago","{0} mos ago",n):Ie("date.fromNow.months.plural.ago","{0} months ago",n):n===1?(t==null?void 0:t.short)?Ie("date.fromNow.months.singular.short","{0} mo",n):Ie("date.fromNow.months.singular","{0} month",n):(t==null?void 0:t.short)?Ie("date.fromNow.months.plural.short","{0} mos",n):Ie("date.fromNow.months.plural","{0} months",n)):(n=Math.floor(r/Rf),(t==null?void 0:t.ago)?n===1?(t==null?void 0:t.short)?Ie("date.fromNow.years.singular.short.ago","{0} yr ago",n):Ie("date.fromNow.years.singular.ago","{0} year ago",n):(t==null?void 0:t.short)?Ie("date.fromNow.years.plural.short.ago","{0} yrs ago",n):Ie("date.fromNow.years.plural.ago","{0} years ago",n):n===1?(t==null?void 0:t.short)?Ie("date.fromNow.years.singular.short","{0} yr",n):Ie("date.fromNow.years.singular","{0} year",n):(t==null?void 0:t.short)?Ie("date.fromNow.years.plural.short","{0} yrs",n):Ie("date.fromNow.years.plural","{0} years",n))}const Xt=(0,E.LV)(),la=class{constructor(e,t,r,n){this.providerService=e,this.storageService=t,this.changeStore=r,this.workspaceId=n,this._onDidChange=new s.EventEmitter,this.cache=new Map,this.lock=new Co("WorkspaceRepositories"),this.disposable=s.Disposable.from(this.providerService.onDidChangeRepositories(this.onRepositoriesChanged,this),this.providerService.onDidChangeRepository(this.onRepositoryChanged,this),this.changeStore.onDidChange(this.onChangeStoreChanged,this))}get onDidChange(){return this._onDidChange.event}dispose(){this.disposable.dispose()}onChangeStoreChanged(e){const t=hc(e.map(r=>r.rootUri),r=>be(r)).map(r=>this.providerService.getRepository(r)).filter(r=>Boolean(r));this.addOrUpdate(t)}onRepositoriesChanged(e){this.addOrUpdate(e.added)}onRepositoryChanged(e){this.addOrUpdate([e.repository])}async get(e){let t=await this.lock.synchronizeRead(async()=>{let r=this.cache.get("workspaceRepositories");return r===void 0&&(r=[...(await this.getCore()).values()].sort((n,i)=>i.timestamp-n.timestamp),this.cache.set("workspaceRepositories",r)),r},"WorkspaceRepositories.get");if(e){const r=be(e);t=t.filter(n=>be(n.canonicalUri)===r)}return t}async getCore(){return this.fromStorage(await this.storageService.get(la.storageKey))}async getByCanonicalUri(){let e=this.cache.get("groupedWorkspaceRepositories");return e===void 0&&(e=hb(await this.get(),t=>be(t.canonicalUri)),this.cache.set("groupedWorkspaceRepositories",e)),e}async getRecents(e=10){return(await this.get()).slice(0,e)}async getRemoteWorkspaceSourceProvider(){const e=await this.getRecents();if(e.length!==0)return{name:"Recents",label:"Open Recent Repository",icon:"$(history)",placeholder:Xt("pick","Choose a recent repository"),provideSources:function(t,r){return e.map(n=>({name:n.name,icon:"$(repo)",description:ua(n.timestamp,{ago:!0}),detail:`${n.provider.name}${n.pullRequest?`\xA0\xA0\u2022\xA0\xA0$(git-pull-request) Pull Request #${n.pullRequest.id}`:""}${Je.isCanonicalUri(n.uri)?"":`\xA0\xA0\u2022\xA0\xA0${mc(n.ref.type)} ${n.ref.name}`}\xA0\xA0\u2022\xA0\xA0${kf(n.changes)}`,workspace:{uri:n.uri,name:n.name,location:rt.CurrentWindow}}))}}}refresh(){this.cache.clear()}async addOrUpdate(e){await this.lock.synchronizeWrite(async()=>{this.cache.clear();const t=await this.getCore();for(const r of e){const{HEAD:n,pullRequest:i}=await r.getMetadata(),o=await this.changeStore.getChanges(r.uri);t.set(`${this.workspaceId}/${be(r.uri)}`,{workspaceId:this.workspaceId,uri:r.uri,canonicalUri:r.canonicalUri,name:r.name,provider:r.provider,ref:{type:n.type,name:n.name},pullRequest:i?{id:i.id}:void 0,changes:Pb(o),timestamp:Date.now()})}try{await this.storageService.store(la.storageKey,this.toStorage(t))}catch(r){throw he.error(r,"Failed to save workspace repositories"),r}},"WorkspaceRepositories.addOrUpdate"),this._onDidChange.fire()}fromStorage(e){if(!e)return new Map;try{const t=JSON.parse(e,(r,n)=>(r==="uri"||r.endsWith("Uri"))&&n!==null?s.Uri.from(n):n);return new Map(t.workspaceRepositories)}catch(t){return he.error(t,"Failed to deserialize workspace repositories"),new Map}}toStorage(e){const t={schemaVersion:la.storageSchemaVersion,workspaceRepositories:[...e]};return JSON.stringify(t)}};let Sc=la;Sc.storageKey="workspaceRepositories",Sc.storageSchemaVersion=1;function Pb(e){let t=0,r=0,n=0;for(const i of e)switch(i.type){case Be.Created:t++;break;case Be.Changed:r++;break;case Be.Deleted:n++;break}return t||r||n?{added:t,changed:r,deleted:n,timestamp:Date.now()}:void 0}function kf(e,{compact:t=!0,preamble:r,separator:n=", ",short:i=!1,single:o=!1}={}){if(e===void 0)return Xt("no changes","No changes");const{added:a,changed:c,deleted:w}=e;if(a===0&&c===0&&w===0)return Xt("no changes","No changes");if(o){const S=a+c+w;return S===1?Xt("summary change","{0} change",S):Xt("changes changes","{0} changes",S)}let p=`${r!=null?r:""}`;return(a||!t)&&(p+=i?`+${a}`:a===1?Xt("file added","{0} file added",a):Xt("files added","{0} files added",a),(c||w||!t)&&(p+=n)),(c||!t)&&(p+=i?`~${c}`:c===1?Xt("file changed","{0} file changed",c):Xt("files changed","{0} files changed",c),(w||!t)&&(p+=n)),(w||!t)&&(p+=i?`-${w}`:w===1?Xt("file deleted","{0} file deleted",w):Xt("files deleted","{0} files deleted",w)),p}var Ob=Object.defineProperty,Nb=Object.getOwnPropertyDescriptor,Fb=(e,t,r,n)=>{for(var i=n>1?void 0:n?Nb(t,r):t,o=e.length-1,a;o>=0;o--)(a=e[o])&&(i=(n?a(t,r,i):a(i))||i);return n&&i&&Ob(t,r,i),i},si;(function(e){e.Change="remoteHub:viewItem:change",e.WorkspaceRepository="remoteHub:viewItem:workspaceRepository",e.WorkspaceRepositories="remoteHub:viewItem:workspaceRepositories",e.Message="remoteHub:viewItem:message"})(si||(si={}));const Df=class{constructor(e,t){this.view=e,this.parent=t,this.splatted=!1}static is(e){return e instanceof Df}get id(){}toString(){return`${he.toLoggableName(this)}${this.id!==void 0?`(${this.id})`:""}`}getParent(){var e,t;return((e=this.parent)==null?void 0:e.splatted)?(t=this.parent)==null?void 0:t.getParent():this.parent}triggerChange(e=!1,t=!1,r){return this.splatted&&this.parent!==void 0&&this.parent!==r?this.parent.triggerChange(e,t):this.view.refreshNode(this,e,t)}};let ci=Df;Fb([nr((e=!1,t=!1,r)=>JSON.stringify([e,t,r==null?void 0:r.toString()]))],ci.prototype,"triggerChange",1);class Lb{constructor(t,r,n,i){this.id=t,this.name=r,this.providerService=n,this.telemetryService=i,this._onDidChangeTreeData=new s.EventEmitter,this.disposables=[];const o=!1;if(he.isDebugging&&o){const a=this.getTreeItem;this.getTreeItem=async function(c){var w;const p=await a.apply(this,[c]),S=c.getParent();return p.tooltip===void 0&&(p.tooltip=new s.MarkdownString(p.label!==void 0&&typeof p.label!="string"?p.label.label:(w=p.label)!=null?w:"")),typeof p.tooltip=="string"?p.tooltip=`${p.tooltip}

---
context: ${p.contextValue}
node: ${c.toString()}${S!==void 0?`
parent: ${S.toString()}`:""}`:p.tooltip.appendMarkdown(`

---

context: \`${p.contextValue}\`\\
node: \`${c.toString()}\`${S!==void 0?`\\
parent: \`${S.toString()}\``:""}`),p}}this.disposables.push(...this.registerCommands()),this.initialize({showCollapseAll:this.showCollapseAll}),setTimeout(()=>this.onConfigurationChanged(),0)}get onDidChangeTreeData(){return this._onDidChangeTreeData.event}get showCollapseAll(){return!0}filterConfigurationChanged(t){return!!He.changed(t,`views.${this.configKey}`)}dispose(){s.Disposable.from(...this.disposables).dispose()}get title(){return this._title}set title(t){this._title=t,this.tree!==void 0&&(this.tree.title=t)}get description(){return this._description}set description(t){this._description=t,this.tree!==void 0&&(this.tree.description=t)}get message(){return this._message}set message(t){this._message=t,this.tree!==void 0&&(this.tree.message=t)}getQualifiedCommand(t){return`${this.id}.${t}`}onConfigurationChanged(t){t!==void 0&&this.root!==void 0&&this.refresh(!0)}initialize(t={}){this.tree=s.window.createTreeView(this.id,{...t,treeDataProvider:this}),this.disposables.push(He.onDidChange(r=>{!this.filterConfigurationChanged(r)||(this._config=void 0,this.onConfigurationChanged(r))},this),this.tree),this._title=this.tree.title}ensureRoot(t=!1){return(this.root===void 0||t)&&(this.telemetryService.sendEvent("view.open",{view:this.id}),this.root=this.getRoot()),this.root}getChildren(t){return t!==void 0?t.getChildren():this.ensureRoot().getChildren()}getParent(t){return t.getParent()}getTreeItem(t){return t.getTreeItem()}get selection(){return this.tree===void 0||this.root===void 0?[]:this.tree.selection}get visible(){return this.tree!==void 0?this.tree.visible:!1}async refresh(t=!1){var r,n;await((n=(r=this.root)==null?void 0:r.refresh)==null?void 0:n.call(r,t)),this.triggerNodeChange()}async refreshNode(t,r=!1,n=!1){var i;const o=await((i=t.refresh)==null?void 0:i.call(t,r));!n&&o===!0||this.triggerNodeChange(t)}async reveal(t,r){if(this.tree!==void 0)try{await this.tree.reveal(t,r)}catch(n){he.error(n)}}async show(){try{await s.commands.executeCommand(`${this.id}.focus`)}catch(t){he.error(t)}}triggerNodeChange(t){this._onDidChangeTreeData.fire(t!==void 0&&t!==this.root?t:void 0)}get config(){return this._config===void 0&&(this._config=He.get("views")[this.configKey]),this._config}}class $b extends ci{constructor(t,r,n,i,o,a,c){super(t,r);this._message=n,this._description=i,this._tooltip=o,this._iconPath=a,this._contextValue=c}getChildren(){return[]}getTreeItem(){var t;const r=new s.TreeItem(this._message,s.TreeItemCollapsibleState.None);return r.contextValue=(t=this._contextValue)!=null?t:si.Message,r.description=this._description,r.tooltip=this._tooltip,r.iconPath=this._iconPath,r}}var Mb=Object.defineProperty,Ub=Object.getOwnPropertyDescriptor,Ec=(e,t,r,n)=>{for(var i=n>1?void 0:n?Ub(t,r):t,o=e.length-1,a;o>=0;o--)(a=e[o])&&(i=(n?a(t,r,i):a(i))||i);return n&&i&&Mb(t,r,i),i};const Ct=(0,E.LV)(),If=class extends ci{constructor(e,t,r,n,i,o,a){super(e,t);this.changeStore=r,this.canonical=n,this.workspaceRepository=i,this.operation=o,this.canApplyChanges=a}static getId(e,t,r){return`${io.getId(e,t)}:${this.key}(${r.uri.toString()})`}get id(){return If.getId(this.canonical.uri,this.workspaceRepository,this.operation)}getChildren(){return[]}async getTreeItem(){const e=this.view.providerService.getRelativeFilePath(this.workspaceRepository.uri,this.operation.uri),t=new s.TreeItem(e,s.TreeItemCollapsibleState.None);return t.id=this.id,t.contextValue=`${si.Change}${this.canApplyChanges?"+apply":""}`,t.resourceUri=this.view.changeStore.getScopedUri(this.operation.uri,this.workspaceRepository),t.command=await this.getDiffCommand(e,!0),t}async getDiffCommand(e,t=!1){if(t||this._command===void 0){const r=Boolean(this.operation.staged&&He.get("staging.enabled"));if(this.workspaceRepository.workspaceId===this.view.workspaceId){const n=this.view.providerService.getProviderUri(this.operation.uri);this._command=await this.changeStore.resolveDiffCommand(this.operation.uri,n,r?Ct("diff title index","{0} (Index)",Dt(this.operation.uri),this.workspaceRepository.ref.name):Ct("diff title working","{0} (Working Tree)",Dt(this.operation.uri),this.workspaceRepository.ref.name))}else{const n=await this.view.providerService.getMetadata(this.workspaceRepository.uri),i=this.view.providerService.createProviderUri(this.operation.uri,{repo:n.repo,ref:{type:We.Commit,id:this.operation.revision}},e);this._command=await this.changeStore.resolveDiffCommand(this.operation.uri,i,r?Ct("diff title changeset index","{0} (Index of {1})",Dt(this.operation.uri),this.workspaceRepository.ref.name):Ct("diff title changeset working","{0} (Working Tree of {1})",Dt(this.operation.uri),this.workspaceRepository.ref.name))}}return this._command}async openChanges(){var e;const t=await this.getDiffCommand(this.view.providerService.getRelativeFilePath(this.workspaceRepository.uri,this.operation.uri));await s.commands.executeCommand(t.command,...(e=t.arguments)!=null?e:[])}async openFile(){const e=this.view.changeStore.getScopedUri(this.operation.uri,this.workspaceRepository.workspaceId);await s.window.showTextDocument(e)}async applyChanges(){const e=await this.view.getRepositoryToApplyChangesetTo(this.workspaceRepository);if(e!==void 0)try{await this.view.changeStore.applyChangeset(e.uri,this.workspaceRepository,this.operation)}catch(t){s.window.showErrorMessage(t.toString())}}};let Af=If;Af.key=":changes";const Pf=class extends ci{constructor(e,t,r,n,i){super(e,t);this.canonical=r,this.workspaceRepository=n,this.root=i}static getId(e,t){return`${da.getId(e)}:${this.key}(${t.workspaceId}/${t.uri.toString()})`}get id(){return Pf.getId(this.canonical.uri,this.workspaceRepository)}get name(){return this.workspaceRepository.name}get uri(){return this.workspaceRepository.uri}canApplyChanges(){if(!this.canonical.hasActive||s.workspace.getWorkspaceFolder(this.workspaceRepository.uri)!==void 0)return!1;const{changes:t}=this.workspaceRepository;return t!==void 0&&(t.added!==0||t.changed!==0||t.deleted!==0)}async getChildren(){if(this._children===void 0){const e=this.view.changeStore.getScopedChangeStore(this.workspaceRepository),t=await e.getChanges(this.workspaceRepository.uri);this._children=t.map(r=>new Af(this.view,this,e,this.canonical,this.workspaceRepository,r,this.canApplyChanges()))}return this._children}getTreeItem(){const e=this.workspaceRepository.workspaceId===this.view.workspaceId,{changes:t}=this.workspaceRepository,r=t!==void 0&&(t.added!==0||t.changed!==0||t.deleted!==0),n=Je.isCanonicalUri(this.workspaceRepository.uri)?Ct("repositories view repository default ref","{0} (default)",this.workspaceRepository.ref.name):this.workspaceRepository.ref.name,i=new s.TreeItem(this.root?this.canonical.name:n,this.workspaceRepository.changes?s.TreeItemCollapsibleState.Collapsed:s.TreeItemCollapsibleState.None);return i.id=this.id,i.contextValue=`${si.WorkspaceRepository}${this.canApplyChanges()?"+apply":""}`,i.description=`${this.root?`${this.workspaceRepository.ref.name}\xA0\xA0\u2022\xA0\xA0`:""}${ua(this.workspaceRepository.timestamp,{ago:!0})}`,i.iconPath=e?new s.ThemeIcon("check"):this.root?Ff(this.canonical.provider.id):Tb(this.workspaceRepository.ref.type),i.tooltip=new s.MarkdownString(void 0,!0).appendMarkdown(Ct("repositories view repository tooltip",`{0}\\
{1} {2} {3}{4}\\
Last accessed {5}

{6}
`,this.canonical.name,Bb(this.workspaceRepository.ref.type),mc(this.workspaceRepository.ref.type),n,e?` \u2014 _${Ct("repositories view repository tooltip active","Active")}_ `:"",ua(this.workspaceRepository.timestamp,{ago:!0}),kf(this.workspaceRepository.changes,{preamble:`${Ct("repositories view has changes","Has Uncommitted Changes")}\\
`}))),r&&(i.resourceUri=s.Uri.parse("remotehub-view://wsrepo/changes")),i}refresh(e=!1){e&&(this._children=void 0)}async applyAllChanges(){const e=await this.view.getRepositoryToApplyChangesetTo(this.workspaceRepository);if(e!==void 0)try{await this.view.changeStore.applyChangeset(e.uri,this.workspaceRepository)}catch(t){s.window.showErrorMessage(t.toString())}}};let io=Pf;io.key=":wsrepo",Ec([nr()],io.prototype,"refresh",1);const Of=class extends ci{constructor(e,t,r,n){super(e,t);this.canonical=r,this.workspaceRepositories=n}static getId(e){return`remoteHub${this.key}(${e.toString()})`}get id(){return Of.getId(this.canonical.uri)}get name(){return this.canonical.name}get uri(){return this.canonical.uri}getChildren(){if(this.children===void 0){const e=this.workspaceRepositories;if(e.length===0)return this.view.message=void 0,[new $b(this.view,this,Ct("repositories view message empty","No remote repositories could be found."))];this.view.message=void 0,this.children=e.map(t=>new io(this.view,this,this.canonical,t,!1))}return this.children}getTreeItem(){const e=this.workspaceRepositories.some(r=>r.workspaceId===this.view.workspaceId),t=new s.TreeItem(this.canonical.name,e?s.TreeItemCollapsibleState.Expanded:s.TreeItemCollapsibleState.Collapsed);return t.contextValue=si.WorkspaceRepositories,t.iconPath=Ff(this.canonical.provider.id),t}refresh(e=!1){e&&(this.children=void 0)}};let da=Of;da.key=":wsrepos",Ec([nr()],da.prototype,"refresh",1);class Nf extends ci{constructor(t){super(t);this.splatted=!0}async getChildren(){if(this.children===void 0){const t=await this.view.workspaceRepositories.getByCanonicalUri();if(t.size===0)return this.view.message=Ct("repositories view message empty","No remote repositories could be found."),[];this.view.message=void 0;const r=[];for(const[n,i]of t){const o=s.Uri.parse(n),a=await this.view.providerService.getMetadata(o),c={uri:o,name:a.name,provider:a.provider,hasActive:i.some(w=>w.workspaceId===this.view.workspaceId)};i.length===1?r.push(new io(this.view,this,c,i[0],!0)):r.push(new da(this.view,this,c,i))}this.children=r}return this.children}getTreeItem(){return new s.TreeItem("Repositories",s.TreeItemCollapsibleState.Expanded)}refresh(t=!1){t&&(this.children=void 0)}}Ec([nr()],Nf.prototype,"refresh",1);class Hb extends Lb{constructor(t,r,n,i,o){super("remoteHub.views.workspaceRepositories",Ct("remote view title","Remote Repositories"),t,o);this.workspaceRepositories=r,this.changeStore=n,this.workspaceId=i,this.configKey="workspaceRepositories",this.disposables.push(this.workspaceRepositories.onDidChange(this.onRepositoriesChanged,this),s.window.registerFileDecorationProvider({provideFileDecoration:(a,c)=>{if(!(a.scheme!=="remotehub-view"||a.authority!=="wsrepo"||!a.path.includes("/changes")))return{badge:"\u25CF",color:new s.ThemeColor("remoteHub.decorations.workspaceRepositoriesView.hasUncommittedChangesForegroundColor"),tooltip:Ct("repositories view decoration has changes","Has Uncommitted Changes")}}}))}getRoot(){return new Nf(this)}onRepositoriesChanged(){this.refresh(!0)}registerCommands(){return[s.commands.registerCommand(this.getQualifiedCommand("refresh"),()=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.refresh"),this.workspaceRepositories.refresh(),void this.refresh(!0)),this),s.commands.registerCommand(this.getQualifiedCommand("open"),t=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.open"),Vt({name:t.name,uri:t.uri,location:rt.CurrentWindow})),this),s.commands.registerCommand(this.getQualifiedCommand("openInNewWindow"),t=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.openInNewWindow"),Vt({name:t.name,uri:t.uri,location:rt.NewWindow})),this),s.commands.registerCommand(this.getQualifiedCommand("applyAllChanges"),t=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.applyAllChanges"),t.applyAllChanges()),this),s.commands.registerCommand(this.getQualifiedCommand("openChanges"),t=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.openChanges"),t.openChanges()),this),s.commands.registerCommand(this.getQualifiedCommand("openFile"),t=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.openFile"),t.openFile()),this),s.commands.registerCommand(this.getQualifiedCommand("applyChanges"),t=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.applyChanges"),t.applyChanges()),this)]}async getRepositoryToApplyChangesetTo(t){const r=be(this.providerService.getVirtualCanonicalRootUri(t.uri)),n=this.providerService.repositories.filter(o=>be(o.canonicalUri)===r);return await jb(n,Ct("apply changeset pick repository placeholder","Choose a repository to apply the changeset to"))}}function Bb(e){switch(e){case nt.Branch:return Ct("type branch","Branch");case nt.Tag:return Ct("type tag","Tag");case nt.Commit:return Ct("type commit","Commit")}}function Ff(e){switch(e){case"github":return new s.ThemeIcon("github");default:return}}async function jb(e,t){if(e.length!==0){if(e.length>1){const r=await s.window.showQuickPick(e.map(n=>({label:n.name,description:n.provider.name,repository:n})),{placeHolder:t});return r?r.repository:void 0}return e[0]}}const fa=(0,E.LV)();let ha;function Lf(){return ha}async function zb(e){var t;he.configure(e,Ke.Warn);const r=e.extension.packageJSON.displayName,n=(t=s.extensions.getExtension("ms-vscode.remotehub"))!=null?t:s.extensions.getExtension("ms-vscode.remotehub-insiders");if(n!==void 0){const c=n.packageJSON.displayName;he.warn(`${r} was NOT activated because ${c} is also installed`),s.window.showErrorMessage(fa("deprecated version installed warning","{0} cannot be used while {1} is also installed. Please ensure that only {0} is installed.",r,c));return}if(e.extension.id==="GitHub.remotehub-insiders"){const c=s.extensions.getExtension("GitHub.remotehub");if(c!==void 0){const w=c.packageJSON.displayName;he.warn(`${r} was NOT activated because ${w} is also installed`),s.window.showErrorMessage(fa("stable version installed warning","{0} cannot be used while {1} is also installed. Please ensure that only one version is installed.",r,w));return}}const i=ns.configure(e);nu.configure(e),he.logLevel=He.get("logLevel");const o=new Fn(e),a=e.extension.packageJSON.version;await e.globalState.update("version",a),await e.workspaceState.update("version",a);try{const c=new wc(e.globalState),w=c.with(i),p=new bc(e.globalStorageUri,i),S=new ji(w),P=new Je(S,o),k=new bi(P,w,p,i);ha=new Cf(P,c,k);const I=new kb(P,k,ha,o),$=new F0(e.globalStorageUri),B=new bw(P),q=new Z0(P),Z=new Sc(P,c,k,i);return e.subscriptions.push(He.onDidChange(K=>{!He.changed(K,"logLevel")||(he.logLevel=He.get("logLevel"))}),P.onDidChangeRepositories(async K=>{var re;for(const ee of K.added)try{const{HEAD:se,defaultBranch:Se,name:me,provider:Te}=await ee.getMetadata(),Oe=((re=se.branch)==null?void 0:re.name)!==Se.name?` (${se.name}) `:" ",Re={uri:ee.uri,type:"folder",label:`${me}${Oe}[${Te.name}]`};s.commands.executeCommand("_workbench.addToRecentlyOpened",Re)}catch(se){he.error(se,"Failed to add repository to recently opened")}}),new xb(P,k),new Nm,new ra(P,k),new Ib(P,k),new Ab(P,o),...Om(P,k,Z,e.extension.id,o),...Gb(q),...qb(P,k,I,$),new Hb(P,Z,k,i,o),q,$,Z,I,ha,k,P,o),o.sendEvent("activate"),Promise.resolve(B)}catch(c){he.error(c),c instanceof Pn&&xc(c.name);return}}async function xc(e){const t=fa("repository not found open","Open Repository");await s.window.showErrorMessage(fa("repository not found","Unable to find repository named '{0}'. Would you like to open another repository?",e),t)===t&&s.commands.executeCommand("remoteHub.openRepository")}function qb(e,t,r,n){return[Wb(e,t,r,n),...He.get("insiders")?[Vb(e,t,r,n)]:[]]}function Wb(e,t,r,n){const i=new yf(e),o=new Vd(e,i,t,n),a=new Wd;async function c(){var p,S;const P=(p=s.extensions.getExtension("GitHub.vscode-pull-request-github"))!=null?p:s.extensions.getExtension("GitHub.vscode-pull-request-github-insiders"),k=(S=await(P==null?void 0:P.activate()))==null?void 0:S.registerGitProvider(r),I=e.repositories.filter($=>$.provider.id==="github");for(const $ of I){const B=await e.getBestExternalUri($.uri,yr.PullRequest);if(!!B){s.commands.executeCommand("github.api.preloadPullRequest",B);break}}return k}const w=c();return s.Disposable.from(e.register("github","GitHub",i,o,a),i,o,{dispose:async()=>{var p;return void((p=await w)==null?void 0:p.dispose())}})}function Vb(e,t,r,n){const i=new G0(e),o=new od(e,i,t,n),a=new Wd;return s.Disposable.from(e.register("azdo","AzureDevOps",i,o,a),i,o)}function Gb(e){return[e.register(new ww)]}})(),module.exports=ga})();
